"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[9304],{299772:(e,t,o)=>{o.d(t,{AP:()=>$,Ay:()=>le,By:()=>ne,DX:()=>Z,JK:()=>Y,Mi:()=>ke,NS:()=>be,Qs:()=>de,T1:()=>ee,Wj:()=>ce,Y4:()=>J,dp:()=>oe,g1:()=>he,nu:()=>ye,rK:()=>Pe,uD:()=>ie,y_:()=>re,zs:()=>G});o(944114),o(898992),o(672577);var n=o(296540),r=()=>o(662303),i=()=>o(484714),a=()=>o(847249),s=()=>o(721908),l=()=>o(757695),d=()=>o(519831),c=()=>o(959013),u=()=>o(496603),g=()=>o(534177),p=()=>o(284371),m=()=>o(934839),S=()=>o(473227),f=()=>o(915086),v=()=>o(778417),b=()=>o(725614),y=()=>o(662453),h=()=>o(766081),P=()=>o(175116),k=()=>o(964345),C=()=>o(135552),A=()=>o(458366),_=()=>o(478726),B=()=>o(108944),K=()=>o(747100),M=()=>o(470928),x=()=>o(891078),w=()=>o(696746),R=()=>o(106628),I=()=>o(792415),T=()=>o(351360),E=()=>o(463830),D=()=>o(353643),O=()=>o(77246),F=()=>o(508496),V=()=>o(150193),j=()=>o(732770),L=()=>o(375447),H=()=>o(205682),z=()=>o(548821),U=()=>o(612587),N=()=>o(77238),q=()=>o(712505),W=()=>o(93658),Q=()=>o(502438),X=o(474848);const G=p().vc(r().locale).sans,$={serif:p().vc(r().locale).serif,mono:p().vc(r().locale).mono,comic:p().vc(r().locale).comic},Y={serif:1.6,mono:1.6},Z={serif:0,mono:.055},J={serif:15,mono:14},ee={serif:17,mono:15},te={width:"100%",display:"flex",flexDirection:"column",position:"relative",alignItems:"center",flexGrow:1},oe=14,ne=17,re=16,ie=16,ae=30;function se(e,t){var r,p;const w=(0,n.useRef)();w.current=performance.now();const{store:V,context:H,disabled:U,onTitleEsc:N,styleOverrides:Q,disableTopControls:G}=e,$=(0,a().K8)((()=>{var e;return null===(e=V.getSpaceStore())||void 0===e?void 0:e.getFreezeSettings()}),[V]),Y=(0,o(973454).p)($),Z=U||"active"===Y,J=(0,i().v3)(),ee=(0,i().Y0)(),oe=(0,o(792485).S)(),ne=(0,x().bx)(V,Z),re=(0,x().HX)(V,Z),ie=(0,a().K8)((()=>V.isReady()&&re&&!V.isNonEditableState()&&!(0,_().sV)(V)&&!(0,_().fc)(V)),[re,V]),ae=(0,a().O$)(o(227440).e),se=(0,a().K8)((()=>V.isCollectionView()),[V]),le=(0,a().K8)((()=>Boolean((0,o(851941).X2)(V.id))?"v8":"v4"),[V]),ce=(0,a().K8)((()=>V.isCollectionViewPageWithContent()),[V]),ke=(0,a().K8)((()=>"workflow"===V.getType()),[V]),Ce=(0,a().K8)((()=>{const e=V.getAssociatedCollectionStore(),t=null==e?void 0:e.getLayoutStore();return Boolean(t)}),[V]),Ae=(0,o(551619).no)(V),_e=(0,a().K8)((()=>({layout:{translateX:-1*Ae},layoutFull:{translateX:Ae}})),[Ae]),Be=(0,a().K8)((()=>l().default.createValue(!1,{name:"headerFocusStore"})),[]),Ke=(0,a().O$)(Be),{isInPeek:Me,isInsideSidePeek:xe}=(0,a().K8)((()=>({isInPeek:(0,K().cq)(V),isInsideSidePeek:(0,_().mb)(V)})),[V]),we=(0,n.useMemo)((()=>new(z().Ay)),[]),Re=(0,n.useMemo)((()=>new(E().A)),[]),Ie=(0,n.useMemo)((()=>new(E().A)),[]),Te=(0,n.useMemo)((()=>new(o(970585).A)),[]),Ee=(0,a().K8)((()=>l().default.createValue(!1,{name:"forceControlHoverVisibleStore"})),[]),De=(0,a().O$)(Ee),Oe=(0,n.useMemo)((()=>({headerFocusStore:Be,pageViewBlockStore:we,resolvedDiscussionButtonPopupStore:Re,backlinksButtonPopupStore:Ie,templatePickerMenuListStore:Te,forceControlHoverVisibleStore:Ee})),[Be,we,Re,Ie,Te,Ee]),[Fe,Ve]=(0,n.useState)(!1),[je,Le]=(0,n.useState)(!1),[He,ze]=(0,n.useState)(""),Ue=(0,n.useCallback)((()=>{Re.setState({open:!0}),we.setState({...we.state,forceDiscussionOpen:!0})}),[we,Re]),Ne=(0,n.useCallback)((()=>{const e=We.current;if(e){if(function(e){if(!e.isIOS)return!1;return!0}(ee))return{paddingLeft:0,paddingRight:0};const t=getComputedStyle(e),o=parseFloat(t.getPropertyValue("padding-left")),n=parseFloat(t.getPropertyValue("padding-right"));return{paddingLeft:u().yr(o)?0:o,paddingRight:u().yr(n)?0:n}}}),[ee]),qe=(0,n.useCallback)((()=>{const e=We.current;if(e){const t=e.getBoundingClientRect().width,o=Ne()??{paddingLeft:0,paddingRight:0};return t-o.paddingLeft-o.paddingRight}}),[Ne]),We=(0,n.useRef)(null),Qe=(0,n.useRef)(null),Xe=(0,n.useRef)(null),Ge=(0,n.useCallback)((()=>We.current),[]),$e=(0,n.useCallback)((()=>Qe.current),[]),Ye=(0,n.useMemo)((()=>new(o(889097).A)(J)),[]);(0,o(790748).b)(o(489348).A,(()=>({store:V,blockContext:H,openResolvedDiscussionPopup:Ue,getContentInnerWidth:qe,getContentWrapEl:Ge,getLayoutEl:$e,collectionContextStore:Ye,headerFocusStore:Be,pageViewBlockStore:we,resolvedDiscussionButtonPopupStore:Re,backlinksButtonPopupStore:Ie,templatePickerMenuListStore:Te,forceControlHoverVisibleStore:Ee,headerMouseStore:void 0,detailsFocusStore:void 0,detailsMouseStore:void 0,renderedType:"page",getBlockStore:()=>V,getNode:()=>Xe.current})),[V,H,Ue,qe,Ne,Ge,$e,Ye,Oe]);const Ze=(0,n.useRef)(!1),Je=(0,a().K8)((()=>V.getTitleStore()),[V]),et=(0,a().K8)((()=>V.isInsideFactoryOrDuplicateBlocksAction()),[V]),tt=(0,a().K8)((()=>{const e=I().A.state.publicPageData;return Boolean(null==e?void 0:e.isDLSViewer)}),[]),ot=(0,a().K8)((()=>(0,o(600871).LX)({device:ee})),[ee]),nt=(0,n.useCallback)((()=>!!Je&&(!!e.forceSelectTitleOnMount||!se&&(!(ee.isMobile&&ee.isPhone&&o(210737).A.hasOpenMobileSlideUps())&&(!o(919709).q4_(Je.getValue())||(0,_().In)(V)&&!ee.isMobile)))),[ee.isMobile,ee.isPhone,se,e.forceSelectTitleOnMount,V,Je]),rt=(0,a().K8)((()=>V.isFormBlock()),[V]),[it,at]=(0,a().K8)((()=>[Boolean(V.getIcon()),Boolean(V.getCover())]),[V]),st=(0,a().K8)((()=>{const e=o(21735).A.state.shouldUseEdgeCache,t=F().default.checkGate({gateName:"edge_cache_mentions"});return e&&t}),[]);(0,o(67141).v)(),(0,n.useEffect)((()=>{if(F().default.checkGate({gateName:"dont_load_users"})||async function(e){const{environment:t,shouldUseEdgeCache:o}=e;o||L().A.state.emptyQueryUserRequestStore.setState({...L().A.state.emptyQueryUserRequestStore.state,ready:!1,loading:!0});await T().default.waitUntil((()=>Boolean(T().default.state.currentSpaceStore&&T().default.state.mainEditorCurrentBlockStore)));const n=await R().T.searchActions.load(),r=await n.searchVisibleSpaceUsers({environment:t,query:"",membersOnly:!1,minFuzzyScore:25,placeSelfFirst:!1});o||L().A.state.emptyQueryUserRequestStore.setState({ready:!0,loading:!1,result:r})}({environment:J,shouldUseEdgeCache:st}),(0,o(63467).y)(),ee.isPhone&&!ot){const{PageScroller:e}=o(347199).A;if(e){const t=e.getNode();if(t&&ne&&!at){const e=ye(H,J);t.scrollTo({top:e})}}}if(Je&&nt()&&(v().hc({environment:J,store:V}),b().setSelectionAtEnd({store:Je})),f().updateMetricDataWithIsPushTag(J),H!==z().Rr.Frame||se||rt||(w.current&&o(606932).A.markPageViewBlockRender(w.current),f().measurePageRenderMetrics({environment:J,isEditable:ie,isHomePage:!1,isWikiHome:!1,isPageWithCustomLayout:Ce,idSchema:le}),function(e,t){var o;ve(e,t)&&(null===(o=t.mobileNative)||void 0===o||o.markTransitionReady({type:"new_page",id:e.id,sendImmediately:!0}))}(V,J)),Ye){const e=(0,o(476492).kz)(Ye);o(406792).default.DO_NOT_USE_measureLegacy("collections.open_item_page_lag",{environment:J,data:{...e,peek_mode:q().default.getPeekMode()}})}!async function(e,t){const{aiOnboardingActions:o}=await y().aiDependency.load(),{getAiOnboardingPhase:n,AiOnboardingQueuedSelectedStore:r}=o;if("space_for_ai"!==n())return;const i=e.getContentStores()[0],a=r.state;if(!i||i.id!==a)return;v().hc({environment:t,store:i}),b().setSelectionAtEnd({store:i.getBlockTitleStore()})}(V,J)}),[]);const lt=(0,a().K8)((()=>V.getFormat()),[V]),dt=(0,a().K8)((()=>{var e;return null===(e=O().Uv.getStateForBlock(V.id))||void 0===e?void 0:e.mode}),[V.id]),ct=(0,a().K8)((()=>{var e;const t=k().ei.state,n=(0,g().O9)(t)&&(null===(e=B().Nq(t))||void 0===e?void 0:e.id)===V.id;return k().gZ.state&&n&&"disconnected"===o(165121).A.state}),[V.id]),ut=(0,a().K8)((()=>{var e;return B().ze(V)||Boolean(null===(e=I().A.state.publicPageData)||void 0===e?void 0:e.isDeleted)&&pe(H)}),[V,H]),gt=(0,a().K8)((()=>oe&&oe.publicEditModeStore.state),[oe]),pt=(0,a().K8)((()=>V.isTemplate()),[V]),mt=(0,a().K8)((()=>V.isPost()&&!V.isPublishedPost()),[V]),St=(0,a().K8)((()=>Pe(J)),[J]);(0,n.useEffect)((()=>{if(H===z().Rr.Frame){const e=Se(H);null==gt||!gt.hasPublicPermission||"edit"!==gt.permission||pt||(0,o(326589).g)()?m().zA({bannerStore:e,id:"EditingPageBanner"}):m().HQ({bannerStore:e,id:"EditingPageBanner",contentKey:"editing_page",styleKey:C().q.White});o(864260).A.state.pageMap[V.id]?m().HQ({bannerStore:e,id:"ImportingEvernotePage",contentKey:"importing_evernote",styleKey:C().q.Blue,blockStore:V}):m().zA({bannerStore:e,id:"ImportingEvernotePage"})}if(fe(H)){const e=Se(H),t=B().Gg(V),n=B().Cf(V);if((0,o(322769).vW)(t))m().HQ({bannerStore:e,id:"SpaceContentDuplicationPage",contentKey:"space_content_duplication",styleKey:C().q.Red,blockStore:V});else if(!ut||rt||ve(V,J))if(n)m().HQ({bannerStore:e,id:"ArchivedTeamPage",contentKey:"page_in_archived_team",styleKey:C().q.Red});else for(const o of["SpaceContentDuplicationPage","DeletedPage","ArchivedTeamPage"])m().zA({bannerStore:e,id:o});else m().HQ({bannerStore:e,id:"DeletedPage",contentKey:"deleted_or_moved_page",blockStore:V,styleKey:C().q.Red});mt&&St?m().HQ({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner",contentKey:"draft_post_in_expanded_feed_composer",styleKey:C().q.Blue,blockStore:V}):m().zA({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner"}),ct?m().HQ({bannerStore:e,id:"DictationConnectionBanner",styleKey:C().q.Yellow,contentKey:"dictation_connection",blockStore:V}):m().zA({bannerStore:e,id:"DictationConnectionBanner"}),dt&&(0,O().Or)(dt)?m().HQ({bannerStore:e,id:"TranslateBanner",styleKey:C().q.Blue,contentKey:"translate",blockStore:V}):m().zA({bannerStore:e,id:"TranslateBanner"}),tt&&!(0,K().cq)(V)?m().HQ({bannerStore:e,id:"TrustedDomainPageBanner",styleKey:C().q.LightGray,contentKey:"trusted_domain_page",blockStore:V}):m().zA({bannerStore:e,id:"TrustedDomainPageBanner"}),pt?m().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_page",styleKey:C().q.Beige,blockStore:V,context:H,disabled:Z}):et?m().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_button",styleKey:C().q.Beige,blockStore:V,context:H,disabled:Z}):m().zA({bannerStore:e,id:"CollectionTemplatePage"}),(null!=lt&&lt.is_asana_imported_project||null!=lt&&lt.is_asana_imported_task)&&(null!=lt&&lt.dismissed_asana_import_banner?m().zA({bannerStore:e,id:"AsanaImporterBanner"}):m().HQ({bannerStore:e,id:"AsanaImporterBanner",contentKey:"asana_importer_banner",blockStore:V,styleKey:C().q.ImportNotification}))}return()=>{fe(H)&&(m().zA({bannerStore:Se(H),id:"DeletedPage"}),m().zA({bannerStore:Se(H),id:"CollectionTemplatePage"}),m().zA({bannerStore:Se(H),id:"Site"}),m().zA({bannerStore:Se(H),id:"CrdtPage"}),m().zA({bannerStore:Se(H),id:"TrustedDomainPageBanner"}),m().zA({bannerStore:Se(H),id:"TranslateBanner"}),m().zA({bannerStore:Se(H),id:"AsanaImporterBanner"}),m().zA({bannerStore:Se(H),id:"DraftPostInExpandedFeedComposerBanner"}))}}),[J,gt,H,Z,V,ut,rt,et,null==lt?void 0:lt.is_asana_imported_project,null==lt?void 0:lt.is_asana_imported_task,null==lt?void 0:lt.dismissed_asana_import_banner,dt,ct,tt,pt,mt,St]),(0,o(852507).l)((()=>{"suggest"===O().Uv.getMode(V,!0)?S().Nz({environment:J,location:"page_navigation",navigableBlockStore:V}):ee.isMobile||V.canEdit()||!V.canComment()||V.isLocked()||se&&!ce||O().Uv.hasModeSet(V)||V.useCrdt()||V.isFormBlock()||V.isPost()||(0,o(142748).ot)(B().E(V))||S().PD({environment:J,navigableBlockStore:V,mode:"suggest",location:"default_on_for_comment_only_user"})})),(0,o(892008).Bs)({pageId:V.id,isFrameContext:pe(H)}),(0,n.useEffect)((()=>()=>{"suggest"===O().Uv.getMode(V,!0)&&S().eB({environment:J,location:"page_navigation",navigableBlockStore:V})}),[J,V]);const ft=(0,a().K8)((()=>ge(V)),[V]),vt=(0,a().K8)((()=>null==ft?void 0:ft.getParentBlockStore()),[ft]),bt=(0,a().K8)((()=>null==Ye?void 0:Ye.collectionStore()),[Ye]);ft&&ft!==bt&&Ye.setContext({type:"collectionPage",collectionViewBlockStore:vt,collectionStore:ft});const yt=(0,a().K8)((()=>{const e=(0,o(110750).Xz)(J.TabbedRouterStore.state);if("web"===e.type){var t,n;if("page"===(null===(t=e.redirectedTo)||void 0===t?void 0:t.route.name))return null===(n=e.redirectedTo)||void 0===n?void 0:n.route.blockId;if("page"===e.route.name)return e.route.blockId}}),[J]);(0,n.useEffect)((()=>{var e;J.mobileNative&&He===yt&&(null===(e=J.mobileNative)||void 0===e||e.markTransitionReady({type:"page",id:V.id,sendImmediately:!0}))}),[J.mobileNative,yt,He,V.id]),(0,n.useEffect)((()=>{ze(V.id)}),[V]);const ht=(0,n.useCallback)((()=>{Me||D().A.state.isDragging||W().default.state.isActive||Ve(!0)}),[Me]),Pt=(0,n.useCallback)((()=>{Me||D().A.state.isDragging||W().default.state.isActive||Ve(!1)}),[Me]),kt=(0,n.useCallback)((()=>{D().A.state.isDragging||W().default.state.isActive||Le(!0)}),[]),Ct=(0,n.useCallback)((()=>{D().A.state.isDragging||W().default.state.isActive||Le(!1)}),[]),At=(0,s().d)(kt,100),_t=(0,s().d)(Ct,100),Bt=(0,n.useCallback)((e=>{Je&&(v().hc({environment:J,store:V}),e.isAtStartOfLine?b().setSelectionAtStart({store:Je}):b().setSelectionAtEnd({store:Je}))}),[J,V,Je]),Kt=(0,n.useCallback)((e=>{b().clear({environment:J}),v().IU({environment:J}),N&&N(e)}),[J,N]),Mt=(0,n.useCallback)((e=>{if(se)return!0;if(e.preventDefault(),function(e){return Boolean(ge(e))}(V)){const e=(0,_().gV)(V);if(e&&e.collection_page_properties){const t=e.collection_page_properties.find(((e,t)=>function(e,t){const o=ge(t);if(!o)return!1;const n=function(e){return e.getSchema()}(t);return(0,A().B2)(n[e])}(e.property,V)));t&&o(908006).default.afterNextFlush((()=>{o(522986).ho({environment:J,blockPropertyValueOverlayStore:me(H),collectionContextStore:Ye,store:V,property:t.property,format:o(41459).j.Page})}))}}}),[Ye,H,J,se,V]),xt=(0,n.useCallback)((e=>{if(se)return!0;Kt(e)}),[Kt,se]),wt=(0,n.useCallback)((()=>{Te.reset()}),[Te]),Rt=(0,n.useCallback)((e=>{e.target===Xe.current&&null===e.relatedTarget&&document.hasFocus()&&v().IU({environment:J})}),[J]),It=(0,a().K8)((()=>be((0,o(835066).dC)(J,V),V,H,J)),[J,H,V]),Tt=(0,a().K8)((()=>{const e=V.isPost(),t=e&&!V.isPublishedPost();return H===z().Rr.DraftPostInInlineComposer?z().Rr.DraftPostInInlineComposer:e&&!t?z().Rr.PostInFullPageOrPeek:e&&t?z().Rr.DraftPostInFullPageComposer:void 0}),[V,H]),Et=(0,o(933951).sS)({pageStore:V,postContext:Tt,collectionStore:ft,pageViewBlockStore:Oe.pageViewBlockStore}),Dt=(0,a().K8)((()=>q().default.state.topHoverAreaEntered),[]),Ot=(0,n.useCallback)((e=>{const{isBottomControl:t,forceVisible:o}=e??{},n=Me?Dt:Fe;let r;return r=!!ee.isMobile||(!!o||(!!De||(t?je&&!j().A.state.isKeyboardMode:n&&!j().A.state.isKeyboardMode||Ke))),he(r)}),[je,ee.isMobile,Ke,Fe,Me,Dt,De]),Ft=(0,a().K8)((()=>Ot({isBottomControl:!1})),[Ot]),Vt=(0,a().K8)((()=>"suggest"===O().Uv.getMode(V)),[V]),jt=(0,a().K8)((()=>(0,M().$3)({environment:J,collectionStore:V.getAssociatedCollectionStore()})),[J,V]),Lt=(0,a().K8)((()=>(0,M().xE)(J)),[J]),Ht=(0,a().K8)((()=>(0,M().Wk)({environment:J,blockStore:V,showUpsell:jt})),[J,V,jt]),zt=(0,o(400851).X)({environment:J,blockStore:V,from:"topControls",blockContext:H}),Ut=(0,n.useCallback)((e=>{let{from:t}=e;const n=se?V.getCollectionStore():ge(V);n&&(0,o(447934).nh)({environment:J,blockStore:V,collectionStore:n,from:t})}),[J,se,V]),Nt=(0,n.useMemo)((()=>{if(G||ot)return[];const e=[];return!ie||it||Vt||e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(790324).A,{store:V,afterOnClick:()=>{Ze.current=!0},style:Ft,label:ee.isSmallPhone?(0,X.jsx)(c().sA,{id:"PageViewBlock.icon.pageIconMobile",defaultMessage:"Icon"}):(0,X.jsx)(c().sA,{id:"PageViewBlock.icon.pageIcon",defaultMessage:"Add icon"})})},"add-icon")),!ae||!ie||at||Vt||Tt||e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(605243).A,{store:V,style:Ft,label:ee.isSmallPhone?(0,X.jsx)(c().sA,{id:"PageViewBlock.cover.pageCoverMobile",defaultMessage:"Cover"}):(0,X.jsx)(c().sA,{id:"PageViewBlock.cover.pageCover",defaultMessage:"Add cover"})})},"add-cover")),Ht&&e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(527580).ui,{store:V,style:Ft,showUpsell:jt,showNewBadge:Lt})},"verify-page")),zt&&!Tt&&e.push((0,X.jsx)(o(941112).E,{blockStore:V,onClick:()=>Ut({from:"customize_page_button_above_title"}),style:Ft},"customize-layout")),ie&&!ee.isMobile&&e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(538776).l,{store:V})},"generate-preview-image")),e}),[G,ot,ie,it,Vt,ae,at,Tt,Ht,zt,ee.isMobile,ee.isSmallPhone,V,Ft,jt,Lt,Ut]),qt=(0,a().K8)((()=>{const{WindowSizeStore:e}=J,t=se?"20vh":(null==Q?void 0:Q.pageCoverHeight)??de(J),n=(null==Q?void 0:Q.paddingX)??(0,_().OU)(H,J);return(0,X.jsx)(o(155004).s,{allowSelectionWithin:!1,style:(0,o(601726).E)(V,J),children:(0,X.jsx)(o(544862).A,{height:t,store:V,disabled:!ie,paddingLeft:e.getSafePaddingLeftCSS(n),paddingRight:e.getSafePaddingRightCSS(n),proxyWidth:e.state.width})})}),[J,se,ie,Q,V,H]),Wt=(0,a().K8)((()=>{const e=J.currentUser.isLoggedIn(),t=oe&&oe.publicEditModeStore.state;let n;return H===z().Rr.Frame?n=T().default.state.currentLoadingContainerStore:H===z().Rr.PeekView&&q().default.state.open&&(n=q().default.state.loadingContainerStore),Boolean(V&&n&&V.isDefined()&&!V.isNonEditableState()&&V.canEdit()&&!V.hasContent()&&e&&(!(null!=t&&t.hasPublicPermission)||"edit"===(null==t?void 0:t.permission))&&!(Boolean(o(302022).A.state.pageMap[V.id])||o(66496).A.state.pages.has(V.id))&&n.state.ready&&!(0,_().sV)(V)&&!(0,_().fc)(V)&&(!(0,o(68465).ZE)(t)||"completionPopup"!==o(525569).default.state.type))}),[J.currentUser,oe,V,H]),Qt=(0,n.useMemo)((()=>({store:V,isEditable:ie,hasCover:at,isInSidePeek:xe,openMenuOnMountCallback:()=>{Ze.current=!1}})),[at,ie,xe,V]),Xt=(0,a().K8)((()=>function(e){return Boolean(e.getAssociatedCollectionStore())}(V)),[V]),Gt=(0,a().K8)((()=>ee.isMobile&&!ee.isTablet&&ee.isIOS&&!Xt&&"on"===F().default.getEligibleGroup({experimentId:"mobile_lightweight_editor_prompt",defaultGroup:"control"})),[ee.isMobile,ee.isTablet,ee.isIOS,Xt]),$t=(0,a().K8)((()=>{var t;const o=(null===(t=e.styleOverrides)||void 0===t?void 0:t.paddingX)??(0,_().OU)(H,J);let n=e.titlePlaceholder;return Gt&&(n=""),{store:V,disabled:!ne,isInSidePeek:xe,paddingLeft:o,paddingRight:o,extraStyles:e.titleStyle,titlePlaceholder:n,collectionContextStore:Ye,shouldShowTemplatePicker:Wt,onTitleChange:wt,onTitleEditText:Bt,onTitleEsc:Kt,onTitleUntab:xt,onTitleTab:Mt}}),[null===(r=e.styleOverrides)||void 0===r?void 0:r.paddingX,e.titleStyle,e.titlePlaceholder,H,J,V,ne,Ye,Wt,wt,Bt,Kt,xt,Mt,xe,Gt]),Yt=(0,n.useCallback)((e=>{"page"===e&&f().measurePageRenderMetrics({environment:J,isEditable:ie,isHomePage:!1,isWikiHome:!0,isPageWithCustomLayout:!1,idSchema:le})}),[J,ie,le]),Zt=(0,a().K8)((()=>{var t,n;const r=(0,X.jsx)(o(155129).X.Provider,{value:Ae,children:(0,X.jsx)(o(145214).A,{tag:o(817942).Mx,animate:_e.layout,type:It,withBottomPadding:H!==z().Rr.DraftPostInInlineComposer&&H!==z().Rr.Presentation,ref:Qe,children:(0,X.jsx)(o(259140).A,{context:H,postContext:Tt,onHeaderMouseEnter:ht,onHeaderMouseLeave:Pt,onDetailMouseEnter:At,onDetailMouseLeave:_t,pageCoverHeight:(null===(t=e.styleOverrides)||void 0===t?void 0:t.pageCoverHeight)??de(J),modules:(null===(n=e.layoutModulesByArea)||void 0===n?void 0:n.page_main)??Et.page_main,styleOverrides:e.styleOverrides,templatePickerMenuListStore:Oe.templatePickerMenuListStore,topControls:Nt,getControlHoverStyle:Ot,pageViewBlockStores:Oe,...Qt,openMenuOnMount:Ze.current,...$t,disabled:Z,pageViewBlockAccessor:$e,editorContentContainerRef:We,layoutRef:Qe})})});return Ye&&Ye.contextType?(0,X.jsx)(P().RI,{value:Ye,children:r}):r}),[Ae,_e.layout,It,H,ht,Pt,At,_t,e.styleOverrides,null===(p=e.layoutModulesByArea)||void 0===p?void 0:p.page_main,J,Et.page_main,Oe,Nt,Ot,Qt,$t,Z,$e,Ye,Tt]),Jt=(0,a().K8)((()=>V.getType()===o(700500).xd.copyIndicator&&(V.getParentTable()!==d().Vl||V.getParentTable()===d().Vl&&0===Object.keys(V.getProperties()).length)?(0,X.jsx)(o(388139).F,{}):o(777932).A.state.isDuplicating?(0,X.jsx)(h().R,{store:V,peekMode:void 0,forceShowIcon:!0}):se?(0,X.jsx)(P().RI,{value:Ye,children:(0,X.jsx)(o(167780).O,{canEdit:ne,context:z().Rr.CollectionViewBlockFullScreen,controlHoverStyle:Ft,handleHeaderMouseEnter:ht,handleHeaderMouseLeave:Pt,headerFocusStore:Oe.headerFocusStore,pageCover:qt,topControls:Nt,...Qt,openMenuOnMount:Ze.current,...$t,store:V,productUseCase:"full_page",onCollectionViewBlockMount:Yt,editorContentContainerRef:We,pageViewBlockStore:we})}):rt?(0,X.jsx)(o(620137).e,{renderLoading:()=>(0,X.jsx)(h().R,{store:V,peekMode:void 0}),innerRenderLoading:()=>(0,X.jsx)(h().R,{store:V,peekMode:void 0}),store:V}):ke?(0,X.jsx)(o(563615).eN,{store:V}):(0,X.jsx)(o(261237).c,{displayName:"PageContent",style:{...te,...e.style},disabled:!ne||V.isNonEditableState(),onBlur:Rt,shouldSelectOnEnter:ue,ref:Xe,children:(0,X.jsx)(o(11048).A,{name:"PageContent",children:Zt})})),[V,se,rt,ke,e.style,ne,Rt,Zt,Ye,Ft,ht,Pt,Oe.headerFocusStore,qt,Nt,Qt,$t,Yt,we]);return(0,x().NW)(V,t,(0,n.useMemo)((()=>({store:V,blockContext:H,openResolvedDiscussionPopup:Ue,getContentInnerWidth:qe,getContentWrapEl:Ge,getLayoutEl:$e,collectionContextStore:Ye,...Oe,renderedType:"page",getBlockStore:()=>V,getNode:()=>Xe.current})),[V,H,Ye,qe,Ge,$e,Ue,Oe]),Jt)}const le=n.memo(n.forwardRef(se),o(821062).A);function de(e){return e.device.isMobile?200:`${ae}vh`}function ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{device:o}=e;return o.isTablet?380:o.isIOS?Math.max(350,t):o.isMobile?400:"30vh"}function ue(){return 0===Q().default.state.stores.length}function ge(e){return e.getAssociatedCollectionStore()}function pe(e){return e===z().Rr.Frame}function me(e){return(0,_().L5)(e)?N().A:H().A}function Se(e){return(0,_().L5)(e)?U().A:pe(e)?V().A:(0,g().HB)(e)}function fe(e){return pe(e)||(0,_().L5)(e)}function ve(e,t){const{device:o,RouterStore:n}=t,{route:r}=n.state,i=e;return o.isMobileNative&&"page"===r.name&&r.showMoveTo&&i.isEmptyTitle()&&i.isEmptyPage()}function be(e,t,o,n){return o===z().Rr.DraftPostInInlineComposer?"create-post":o===z().Rr.Presentation?"presentation-mode":n.device.isPhone?"phone":n.device.isTablet?(0,_().Ck)(t,o,n)?"wide":"tablet":(0,_().L5)(o)?(0,_().mb)(t)?"side-peek":"center-peek":function(e){return e===z().Rr.InAppTemplatePreview}(o)||function(e){return e===z().Rr.InPageSnapShot}(o)?"template-preview":(0,_().Ck)(t,o,n)?e?"wide-right-margin-expanded":"wide":"default"}function ye(e,t){return 28+(0,_().XD)(e,t)}function he(e){return{opacity:e?1:0,pointerEvents:e?"auto":"none",transition:"opacity 100ms ease"}}function Pe(e){if(!q().default.isSidePeekOpen()&&!q().default.isCenterPeekOpen())return!1;const t=T().default.state.mainEditorCurrentBlockStore;return(0,w().lU)(t)}function ke(e){return!!e&&(e===z().Rr.PostInFullPageOrPeek||e===z().Rr.DraftPostInFullPageComposer)}}}]);