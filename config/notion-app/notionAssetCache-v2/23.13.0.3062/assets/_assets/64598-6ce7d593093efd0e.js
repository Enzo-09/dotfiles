"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[64598],{79275:(e,t,r)=>{r.d(t,{X:()=>n});r(296540);var s=r(474848);const n=(0,r(340498).wt)("newSidebarHome",{viewBox:"0 0 20 20",svg:(0,s.jsx)("path",{d:"M10.1416 3.77299C10.0563 3.71434 9.94368 3.71434 9.85837 3.77299L3.60837 8.06989C3.54053 8.11653 3.5 8.19357 3.5 8.2759V14.2499C3.5 14.9402 4.05964 15.4999 4.75 15.4999H7.5L7.5 10.7499C7.5 10.0595 8.05964 9.49987 8.75 9.49987H11.25C11.9404 9.49987 12.5 10.0595 12.5 10.7499L12.5 15.4999H15.25C15.9404 15.4999 16.5 14.9402 16.5 14.2499V8.2759C16.5 8.19357 16.4595 8.11653 16.3916 8.06989L10.1416 3.77299ZM9.00857 2.53693C9.60576 2.12636 10.3942 2.12636 10.9914 2.53693L17.2414 6.83383C17.7163 7.1603 18 7.69963 18 8.2759V14.2499C18 15.7687 16.7688 16.9999 15.25 16.9999H12.25C11.5596 16.9999 11 16.4402 11 15.7499L11 10.9999H9L9 15.7499C9 16.4402 8.44036 16.9999 7.75 16.9999H4.75C3.23122 16.9999 2 15.7687 2 14.2499V8.2759C2 7.69963 2.2837 7.1603 2.75857 6.83383L9.00857 2.53693Z"})})},135599:(e,t,r)=>{r.d(t,{W:()=>O});r(944114),r(517642),r(658004),r(733853),r(845876),r(432475),r(515024),r(731698),r(898992),r(354520),r(581454),r(737550);var s=r(296540),n=()=>r(395361),o=()=>r(484714),a=()=>r(847249),i=()=>r(721908),l=()=>r(474424),c=()=>r(591779),u=()=>r(206267),d=()=>r(207289),m=()=>r(519831),p=()=>r(245241),v=()=>r(959013),h=()=>r(496603),S=()=>r(973647),g=()=>r(534177),f=()=>r(720665),y=()=>r(449506),b=()=>r(518362),C=()=>r(989423),I=()=>r(148777),_=()=>r(825972),R=()=>r(71304),L=()=>r(780865),k=()=>r(470928),w=()=>r(722038),A=()=>r(406792),P=()=>r(106628),M=()=>r(361330),x=()=>r(109054),T=()=>r(351360),q=()=>r(227440),B=()=>r(508496),H=()=>r(968172),K=()=>r(20199),V=()=>r(558407),E=()=>r(630116),U=()=>r(645873),j=()=>r(963589),N=()=>r(64736);function O(e){var t;const{options:r,...u}=e,{overrideSearchSessionId:O,overrideSpaceStore:G,usePrefetch_EXPERIMENTAL:X,disable:D}=r,{type:J,query:Z="",source:Q,limit:$}=u,ee=(0,o().v3)(),te=(0,v().tz)(),re=(0,c().ZC)(Z),se=(0,c().ZC)(e.filters),ne=(0,s.useRef)({number:0,query:""}),oe=(0,s.useCallback)((e=>{const t=ne.current.query.trim(),r=e.trim();""!==r&&t!==r&&(ne.current.number+=1,ne.current.query=r)}),[]),ae=(0,n().Y)(oe,M().ab),ie=(0,s.useRef)(!0),le=(0,a().O$)(q().e),ce=(0,a().K8)((()=>r.isLocalOnlyMode||!le),[le,r.isLocalOnlyMode]),ue=(0,w().y)(),[de,me]=(0,s.useState)(z()),pe=(0,a().K8)((()=>O&&O!==de.searchSessionId?(me((e=>({...e,searchSessionId:O}))),O):de.searchSessionId),[de,O]),ve=(0,j().X)("quick_find_highlights_enabled"),{searchLocalResults:he,searchServerResults:Se,isResultsLoading:ge,numTotalLocalResults:fe,numTotalServerResults:ye}=(0,a().K8)((()=>({searchLocalResults:de.localResults,searchServerResults:de.serverResults,isResultsLoading:de.isResultsLoading,numTotalLocalResults:de.numTotalLocalResults,numTotalServerResults:de.numTotalServerResults})),[de]),be=(0,a().K8)((()=>{if(ce||ge&&ie.current)return he;let e=function(e){const{localResults:t,serverResults:r}=e,s=t.map((e=>e.store.id)),n=new Set(s),o=r.filter((e=>!n.has(e.store.id)));return[...t,...o]}({localResults:he,serverResults:Se});return J===p().Vz.CollectionsInSpace&&(e=Y(e)),e}),[ce,ge,he,J,Se]),Ce=(0,a().K8)((()=>G||T().default.state.currentSpaceStore),[G]),Ie=(0,a().K8)((()=>"on"===B().default.getEligibleGroup({experimentId:"search-use-local-reranker-layered",parameter:"shouldUseLocalReranker",defaultGroup:"control"})),[]),_e=(0,a().K8)((()=>ce&&le&&Boolean(X)),[ce,le,X]),Re=(0,s.useMemo)((()=>e.sort?e.sort:{field:"relevance"}),[e.sort]),Le="relevance"!==Re.field,ke=(0,s.useMemo)((()=>{const t=(t=>{switch(e.type){case p().Vz.BlocksInCollection:return e.collectionId;case p().Vz.BlocksInParent:return e.parentId;default:return null===(t=e.filters)||void 0===t?void 0:t.parentId}})(),s={...e.filters,navigableBlockContentOnly:!1!==r.isTitleOnly,parentId:t};return(0,p().N2)(s)}),[r.isTitleOnly,e]),we=(0,s.useCallback)(((e,t)=>{const{isSuccess:r,totalResultsCount:s,localCacheMetadata:n,query:o}=t;A().default.measure(e,{environment:ee,data:{start_time:e.startTime,success:r,surface:Q,num_results:s,search_session_id:pe,local_cache_metadata:n,local_cache_readiness_timings:(0,I().Yp)(),query_length:o.length}})}),[ee,Q,pe]),Ae=(0,s.useCallback)(((e,t)=>{const{isSuccess:r,totalResultsCount:s,query:n}=t;A().default.measure(e,{environment:ee,data:{start_time:e.startTime,success:r,surface:Q,num_results:s,search_session_id:pe,search_session_flow_number:ne.current.number,query_length:n.length}})}),[ee,Q,pe]),Pe=(0,a().K8)((()=>K().A.state.localSearchableBlocksCache),[]),Me=(0,U().fJ)(P().T.searchActions),xe=(0,s.useCallback)((t=>{var r;if(Le)return;const s=A().default.mark("rum.local_quick_search_query"),{query:n,spaceStore:o}=t,a=ue&&!le&&(0,g().Xk)(p().Iy,Q);if("resolved"!==Me.status)return;const i=J===p().Vz.CollectionsInSpace,l=i&&0===n.length?function(e){const{spaceStore:t,environment:r}=e,s=(0,b().F)({currentUserId:r.currentUser.id,spaceId:t.id}).map((e=>{const r=E().md.createChildStore(t,{table:m().Vl,id:e}).getParentBlockStore();if(null==r?void 0:r.pathIsAccessibleAndAlive())return r}));return(0,h().oE)(s)}({environment:ee,spaceStore:o}).map(((e,t)=>({store:e,originalPosition:t,id:e.id,score:0,spaceId:e.getSpaceId(),sources:[p().Ni.Local],featureGroups:[],serverEventProperties:void 0}))):[],c=(0,I().PE)({environment:ee,overrideCurrentUserId:ee.currentUser.id,overrideSpaceId:o.id,overrideLocalSearchableBlocksCache:Pe}),u=(0,L().Er)(ee).hasPublicAccessPermission,d=(0,N().S6)({environment:ee,parentStore:o,isOnline:le,requestInput:{query:{text:n,filters:{...ke,blockTypes:W({blockTypes:null===(r=e.filters)||void 0===r?void 0:r.blockTypes,queryType:J}),isOfflineOnly:a},sort:{field:"relevance"}},limit:ce?$:Math.min($,5)},localSearchCache:Pe,shouldUseNewRerankerDebugOverrideEnabled:Ie,shouldLimitLocalResultsWhenOnline:!ce,hasPublicAccessPermission:u}),v=_e?F({query:n,serverResults:ze.current}):[],f=d&&S().Q.unwrapOr(d,void 0),y=(null==f?void 0:f.results)??[],C=(null==f?void 0:f.total)??0;let _=h().hS([...l,...y,...v],(e=>e.id));_=i?Y(_):_,me((e=>e.query!==n?e:(We.current=_.map((e=>e.id)),we(s,{query:n,isSuccess:Boolean(f),totalResultsCount:C,localCacheMetadata:c}),ae(n),{...e,localResults:_,isResultsLoading:!ce&&e.isResultsLoading,numTotalLocalResults:C})))}),[ue,le,Q,Me.status,J,ee,Pe,ke,null===(t=e.filters)||void 0===t?void 0:t.blockTypes,ce,$,Ie,_e,we,ae,Le]),Te="mini_quick_find"===Q?40:M().GR,qe=(0,n().Y)(xe,Te),Be=(0,s.useCallback)((e=>{const{result:t,isMetaClick:r,context:s}=e,n=(0,R().Qe)(t.store,te,ee,!1),o=(0,x().u)({query:Z,resultText:n??"",isLastQueryTermPartialMatchOK:!0}),a=T().default.state.currentSpaceStore,i=Boolean(null==a?void 0:a.getSettings().enable_ai_training);(0,C().u4)({environment:ee,event:{eventName:"select_search_item",eventProperties:{...t.serverEventProperties&&t.serverEventProperties["server-query"]?{"server-query":t.serverEventProperties["server-query"]}:{},queryText:t.serverEventProperties&&t.serverEventProperties["server-query"]&&t.serverEventProperties["server-query"].query?t.serverEventProperties["server-query"].query:Z,sources:t.sources,localSources:Array.from(t.localSource||new Set),searchSessionId:pe,aiSessionId:void 0,traceId:void 0,searchSessionFlowNumber:ne.current.number,context:s,queryStringLength:Z.length,isTitleMatch:o,queryIfLeap:i?Z:void 0,totalSearchResultCount:fe+ye,numLocalResults:he.length,numTotalLocalResults:fe,isMobile:ee.device.isMobile,isMetaClick:r,hasFilters:Boolean(ke),originalPosition:t.originalPosition,selectedItemIndex:t.originalPosition,selectedSearchResultMetadata:{blockId:t.id,blockType:t.store.getModel().type},searchSource:Q,verificationState:(0,k().i1)(t.store)}}})}),[ee,fe,ye,he,Z,pe,ne,ke,Q,te]),He=re===Z,Ke=h().n4(se,e.filters),Ve=Boolean(re&&!Z),Ee=Ke&&He,Ue=!D&&Ce&&!Ee,je=Ve||!Ke,Ne=(0,s.useRef)(!1),Oe=(0,s.useRef)([]),ze=(0,s.useRef)([]),Fe=(0,s.useRef)([]),We=(0,s.useRef)([]),Ye=(0,a().K8)((()=>{if("mention_menu"!==Q)return;return V().A.getMentionedIds(ee.currentUser.id)}),[ee.currentUser.id,Q]),Ge=(0,s.useCallback)((async e=>{const t=A().default.mark("rum.server_quick_search_query"),{query:r,spaceStore:s,size:n}=e,o=s.id;if(ce&&!_e)return;Le&&me((e=>({...e,isResultsLoading:!0})));const a=!ie.current&&Ke?Oe.current:[],i=_e?F({query:r,serverResults:ze.current}):[];if(_e&&(r.length<=1||i.length>=5||Fe.current.some((e=>e===r))))return;Fe.current.push(r),u.excludedBlockIds=h().sb([...u.excludedBlockIds??[],...a.map((e=>e.id)),...We.current||[],...ze.current.map((e=>e.id))]);const c={...u,query:r,sort:Re,filters:ke,recentlyMentionedPageIds:Ye,spaceId:o,searchSessionFlowNumber:ne.current.number,searchSessionId:pe,limit:"mini_quick_find"===Q?10:n,recentPagesForBoosting:(0,_().cs)(H().A.getWithoutSubscribing(o)),ignoresHighlight:!ve||"mini_quick_find"!==Q},m=await y().callApi({eventName:"search",environment:ee,data:c});if(!m||"failed"===m.type)return void(Le&&me((e=>({...e,isResultsLoading:!1}))));const p=m.data.total,v=(0,f().MU)((0,g().WP)(m.data.trackEventProperties).map((e=>{let[t,r]=e;return[`server-${t}`,r]}))),S=m.data.results.slice(0,n).map(((e,t)=>{const r=E().Bv.createChildStore(s,{id:e.id,spaceId:e.spaceId,table:"block"}),n=_e?function(e){const{result:t,store:r,environment:s}=e;if(t.terms)return t.terms;const n=r.getModel();if(!n)return[];const o=s.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(s.currentUser.id),a=(0,d().KM)((0,l().g)({blockValue:n,getRecordValue:o}).text);if(!a)return[];return(0,x().N)(a)}({environment:ee,store:r,result:e}):e.terms;return{store:r,originalPosition:t,...e,serverEventProperties:v,terms:n}}));Ne.current=!(p<n);const b=[...a,...S];Oe.current=b,ze.current=h().hS([..._e?S:[],...ze.current],(e=>e.id)),_e||(me((e=>e.query!==r?e:(Ae(t,{query:r,isSuccess:"success"===m.type,totalResultsCount:p}),{...e,serverResults:b,isResultsLoading:!1,numTotalServerResults:p}))),ae(r))}),[ce,_e,Le,Ke,u,Re,ke,Ye,pe,Q,ve,ee,ae,Ae]),Xe=(0,s.useCallback)((e=>{!D&&Ce&&Ne.current&&!ge&&le&&(me((e=>({...e,isResultsLoading:!0}))),Ne.current=!1,ie.current=!1,Ge({query:Z,spaceStore:Ce,size:e??20}))}),[Ce,D,Ge,le,ge,Z]),De="mini_quick_find"===Q?100:M().ab,Je=(0,i().d)(Xe,De),Ze=(0,n().Y)(Ge,_e?0:M().ab),Qe=(0,s.useRef)(!1);return(0,s.useEffect)((()=>{!Qe.current&&null!=Ce&&Ce.id&&"mini_quick_find"!==Q&&(Qe.current=!0,y().callApi({eventName:"warmSearchCache",environment:ee,data:{spaceId:Ce.id}}))}),[null==Ce?void 0:Ce.id,ee,Q]),(0,s.useEffect)((()=>{je&&(me((e=>({...z(),searchSessionId:e.searchSessionId}))),ze.current=[],Fe.current=[]),Ue&&(ie.current=!0,Le||me((e=>({...e,isResultsLoading:!0,query:Z}))),qe({query:Z,spaceStore:Ce}),Ze({query:Z,spaceStore:Ce,size:$}))}),[Ce,qe,Ze,$,Z,Ue,je,Q,Le]),{results:be,isResultsLoading:ge,searchSessionId:pe,fetchAdditionalServerResultsOnChange:!D&&!ce&&Ne.current&&Ee?Je:void 0,searchSessionFlowNumber:ne.current.number,hasMoreResults:Ne.current,searchAnalytics:{trackSelectSearchItem:Be}}}function z(){return{query:void 0,localResults:[],numTotalLocalResults:0,serverResults:[],numTotalServerResults:0,searchSessionId:(0,u().JW)(),isResultsLoading:!1}}function F(e){const{query:t,serverResults:r}=e;return t?r.filter((e=>(0,x().u)({query:t,resultText:(e.terms??[]).join(" "),isLastQueryTermPartialMatchOK:!0}))):[]}function W(e){const{blockTypes:t,queryType:r}=e;switch(r){case p().Vz.CollectionsInSpace:return["collection_view","collection_view_page"];case p().Vz.BlocksInCollection:return["page","collection_view_page"];case p().Vz.BlocksInSpace:default:return t??[]}}function Y(e){const t=new Set;return e.filter((e=>{const r=e.store.getCollectionViewSourceCollectionStore();return!(!r||t.has(r.id))&&(t.add(r.id),!0)}))}},303742:(e,t,r)=>{r.d(t,{o:()=>o});var s=()=>r(640653),n=()=>r(508496);function o(e){return!!e&&Boolean((0,s().IL)(e)&&"external_pages_sidebar"===n().default.getEligibleGroup({experimentId:"sharing_collaboration_sidebar_guest_aggregation"}))}},694874:(e,t,r)=>{r.d(t,{Oh:()=>y,Qs:()=>f,Wy:()=>v,aX:()=>S,it:()=>g,tL:()=>h});r(898992),r(354520),r(430670);var s=()=>r(244641),n=()=>r(994310),o=()=>r(534177),a=()=>r(246826),i=()=>r(751156),l=()=>r(755199),c=()=>r(638146),u=()=>r(351360),d=()=>r(846955),m=()=>r(696746),p=()=>r(705059);function v(e){const{currentUserSettingsStore:t}=u().default.state;t&&i().createAndCommit({userAction:"SidebarPersonalHomeButton.markAsSeen",environment:e,canUndo:!0,perform:e=>{l().mJ({userSettingsStore:t,transaction:e,data:{seen_personal_home:!0}})}})}function h(e){const{currentUserSettingsStore:t}=u().default.state;t&&(d().default.setState({type:"inactive"}),i().createAndCommit({userAction:"SidebarPersonalHomeButton.markHomeTooltipAsSeen",environment:e,canUndo:!0,perform:e=>{l().mJ({userSettingsStore:t,transaction:e,data:{personal_home_delayed_tooltip_dismissed_at:s().c9.now().toMillis()}})}}))}function S(e){const{environment:t,newSeenWelcomeHomeValue:r}=e,s=u().default.state.currentSpaceViewStore;s&&i().createAndCommit({userAction:"SidebarPersonalHomeSettings.markWelcomeAnimationAsSeen",environment:t,canUndo:!0,perform:e=>{const t=s.getSettingsStore().getKeyStore("personal_home").getKeyStore("seen_welcome_animation");a().KY({store:t,transaction:e,value:r})}})}function g(e){const{environment:t,tipType:r,completed:s}=e,{currentUserSettingsStore:n}=u().default.state;if(!n)return;const o=n.getPersonalHomeTipsSettings(),a={...o,progress_data:{...o.progress_data,[r]:{completed:s}}};i().createAndCommit({userAction:"LearnHomePanel.updateProgress",environment:t,canUndo:!0,perform:e=>{l().mJ({userSettingsStore:n,transaction:e,data:{personal_home_tips_settings:a}})}})}function f(e){const{environment:t,hide:r}=e,{currentUserSettingsStore:s}=u().default.state;if(!s)return;const n={...s.getPersonalHomeTipsSettings(),hide_completed:r};i().createAndCommit({userAction:"LearnHomePanel.hideCompleted",environment:t,canUndo:!0,perform:e=>{l().mJ({userSettingsStore:s,transaction:e,data:{personal_home_tips_settings:n}})}})}function y(e){const{blockId:t,enabledFeatures:r,userId:s}=e,a=(0,o().WP)(r).flatMap((e=>{let[t,r]=e;if(!r)return[];switch(t){case"tasks":return[(0,m().NY)("myTasksAssignedToMeCollectionView")];case"customDb":const e=(0,m().NY)("customDb");return[e&&(0,c().cf)({userId:s,viewBlockId:e})].filter(o().O9);case"similarUsersAndTrending":return[(0,m().NY)("similarUsersCollectionView"),(0,m().NY)("trendingCollectionView")];case"unifiedFeed":return[(0,m().NY)("postsCollectionView")];case"recents":case"updates":case"templates":case"tips":case"calendar":case"aiChatModule":return[];default:(0,o().HB)(t)}})),{isHomeKey:i,homeCollectionViewIdsKey:l,unifiedFeedEnabledKey:u}=(0,p().h)(t);n().A.set(i,!0),n().A.set(l,a),n().A.set(u,r.unifiedFeed)}},799384:(e,t,r)=>{r.d(t,{o:()=>n});r(296540);var s=r(474848);const n=(0,r(340498).wt)("newSidebarSearch",{viewBox:"0 0 20 20",svg:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 8.75C4 6.12665 6.12665 4 8.75 4C11.3734 4 13.5 6.12665 13.5 8.75C13.5 11.3734 11.3734 13.5 8.75 13.5C6.12665 13.5 4 11.3734 4 8.75ZM8.75 2.5C5.29822 2.5 2.5 5.29822 2.5 8.75C2.5 12.2018 5.29822 15 8.75 15C10.2056 15 11.545 14.5024 12.6073 13.668L16.7197 17.7803C17.0126 18.0732 17.4874 18.0732 17.7803 17.7803C18.0732 17.4874 18.0732 17.0126 17.7803 16.7197L13.668 12.6073C14.5024 11.545 15 10.2056 15 8.75C15 5.29822 12.2018 2.5 8.75 2.5Z"})})},916096:(e,t,r)=>{r.d(t,{ke:()=>E,Ay:()=>N,aQ:()=>j});var s=r(296540),n=()=>r(484714),o=()=>r(847249),a=()=>r(401497),i=()=>r(79275),l=()=>r(959013),c=()=>r(35392),u=()=>r(296798),d=()=>r(859428),m=()=>r(490044),p=()=>r(694874),v=()=>r(696746),h=(r(898992),r(354520),r(672577),r(803949),r(581454),()=>r(187174)),S=()=>r(921997),g=()=>r(519831),f=()=>r(763824),y=()=>r(449506),b=()=>r(941541),C=()=>r(351360),I=()=>r(630116),_=()=>r(634157),R=()=>r(578136);const L=new(r(299919).Y)((e=>new k(e)));class k extends(()=>r(757695))().default{constructor(e){super(),this.collectionStore=void 0,this.debouncedRefresh=void 0,this.collectionStore=e,this.debouncedRefresh=(0,r(496603).sg)(this.unthrottledRefresh.bind(this),2e3)}getInitialState(){return{createdTime:-1/0,createdById:void 0}}getLatestPostCreatedTime(){return this.state.createdTime}getLatestPostCreatedById(){return this.state.createdById}async refresh(e){return this.debouncedRefresh(e)}async unthrottledRefresh(e){const{environment:t}=e;if(!t.currentUser.id)return;if(await this.collectionStore.load(),!this.collectionStore.isDefined())return;const r=await y().callApi({eventName:"getLatestPostCreated",environment:t,data:{spaceId:this.collectionStore.getSpaceId(),collectionIds:[this.collectionStore.id]}});if("success"===r.type&&r.data){const e=r.data[0];this.setState(e)}}}function w(e){const t=(0,n().v3)(),r=(0,o().K8)((()=>{var t;return null==e||null===(t=e[0])||void 0===t?void 0:t.getSpaceId()}),[e]),a=(0,s.useMemo)((()=>e.filter((e=>!L.has(e)))),[e]);(0,h().Yb)((async()=>{await async function(e){const{environment:t,collectionStores:r}=e,s=await f().dS(r,10,(async e=>(await e.load(),e.isDefined())));if(0===s.length)return;const n=s[0].getSpaceId(),o=await y().callApi({eventName:"getLatestPostCreated",environment:t,data:{spaceId:n,collectionIds:s.map((e=>e.id))}});if("success"===o.type&&o.data)for(let a=0;a<s.length;a++){const e=s[a],t=o.data[a];t.collectionId===e.id&&L.get(e).setState(t)}}({environment:t,collectionStores:a})}),[a,t]);const i=(0,s.useMemo)((()=>e.map((e=>L.get(e)))),[e]);return(0,s.useEffect)((()=>{if(!r)return;const e=i.map((e=>b().Ay.addListener((0,S().eG)(e.collectionStore.id),void 0,(0,b().AY)((async()=>await e.refresh({environment:t}))),void 0,t)));return()=>{e.forEach((e=>{e&&b().Ay.removeListener(e,t)}))}}),[i,r,t]),i}var A=()=>r(962730),P=()=>r(551694),M=()=>r(487941),x=()=>r(846955),T=()=>r(644914),q=()=>r(645873);const B={LazyAiLandingPageExperimentSwitcher:new(q().O2)("LazyAiLandingPageExperimentSwitcher",(()=>r.e(66169).then(r.bind(r,981440))))},H=(0,q()._h)(B.LazyAiLandingPageExperimentSwitcher,(e=>e.AiLandingPageExperimentSwitcher));var K=r(474848);function V(e){const{styles:t}=e,h=(0,n().v3)(),S=(0,l().tz)(),f=(0,o().K8)((()=>{const{currentSpaceViewStore:e}=C().default.state;if(e)return v().x$(e)}),[]),y=(0,o().K8)((()=>{const e=C().default.state.mainEditorCurrentBlockStore;return!!e&&v().Nh(e.id)}),[]),b=(0,o().K8)((()=>"home_available"===x().default.getState().type),[]),L=(0,o().K8)((()=>{var e;return null==f||null===(e=f.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==f?void 0:f.getRecordModel,pageVisitSource:r(584262).y8.SidebarHome})}),[f]),k=function(){const e=(0,n().v3)(),t=(0,o().K8)((()=>(0,R().D)({isMobileNative:e.device.isMobileNative,disableExposureLogging:!0})),[e]),r=(0,o().K8)((()=>{var e;return null===(e=C().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),s=w((0,o().K8)((()=>{if(!t)return[];const e=C().default.state.currentSpaceStore;return r&&e?_().A.getJoinedTeamStores({userId:r,spaceStore:e}).map((t=>I().md.createChildStore(t,{table:g().Vl,id:t.id,spaceId:e.id}))):[]}),[t,r]));return(0,o().K8)((()=>{var e;if(!C().default.state.currentSpaceStore)return!1;const t=(null===(e=C().default.state.currentSpaceViewStore)||void 0===e?void 0:e.getKeyStore("settings").getKeyStore("last_opened_aggregated_feed").getValue())??0;return s.find((e=>!(!e.getLatestPostCreatedById()||e.getLatestPostCreatedTime()<=t||e.getLatestPostCreatedById()===r)))}),[s,r])}(),P=(0,r(327300).w4)(),q=(0,o().O$)(r(430483).ts),[B,V]=(0,s.useState)(!1),[E,N]=(0,s.useState)(!1),O=(0,s.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,r(819121).p)(t)&&N(!0)}),[]),z=(0,s.useCallback)((()=>{N(!1)}),[]),F=(0,s.useCallback)((()=>{r(353643).A.state.isDragging||V(!0)}),[]),W=(0,s.useCallback)((()=>{V(!1)}),[]),Y=(0,o().uB)(void 0,M().A),G=(0,o().uB)(void 0,M().A),X=(0,o().K8)((()=>G.state.focused||G.state.hovered),[G]),D=(0,s.useCallback)((()=>{(0,p().Wy)(h),(0,r(162674).ZL)({environment:h,from:"sidebar"}),b&&(0,p().tL)(h),r(441199).default.isVisible()&&(0,r(770906).VI)({environment:h})}),[h,b]),J=(0,T().ab)(),Z=(0,a().IS)((e=>({tooltip:{width:200},leftContainer:{position:"relative"},shortcutLabel:{color:e.text.contrastSecondary},linkBoxStyle:{...J.baseSidebarItem,...y&&J.currentSelectedSidebarItem},homeIconStyle:{...J.topButtonIcon,...y&&J.currentSelectedSidebarIcon}})),[y,J]),Q=(0,s.useMemo)((()=>P.showAiFaceInHomeIcon?q?(0,r(366295).L)(J.topButtonIcon):(0,r(654601).X)({width:16}):(0,i().X)(Z.homeIconStyle)),[P.showAiFaceInHomeIcon,q,Z.homeIconStyle,J.topButtonIcon]),$=(0,s.useCallback)((()=>X?"":(0,K.jsxs)("div",{style:Z.tooltip,children:[(0,K.jsx)("div",{children:S.formatMessage(j.tooltip)}),(0,K.jsx)(c().A,{style:Z.shortcutLabel,name:"openHome"})]})),[X,S,Z.shortcutLabel,Z.tooltip]);return(0,K.jsx)(d().A,{store:Y,renderTooltip:$,disableTooltip:b,originGap:6,textWrap:!0,placement:A().W.Right,render:e=>(0,K.jsx)(u().A,{...e,style:Z.linkBoxStyle,hoveredStyle:null==t?void 0:t.buttonHoveredStyle,href:L,onClick:D,"aria-current":y?"page":void 0,children:(0,K.jsx)(m().A,{left:(0,K.jsxs)("div",{style:Z.leftContainer,children:[Q,k&&(0,K.jsx)(U,{})]}),disableMobileBorder:!0,right:(0,K.jsx)(H,{isHovered:B,isFocused:E,tooltipStore:G,parentTooltipStore:Y}),onMouseMove:F,onMouseLeave:W,onFocus:O,onBlur:z,children:S.formatMessage(j.label)})})})}function E(e){const{styles:t}=e,r=(0,o().K8)((()=>"home_available"===x().default.getState().type),[]),s=(0,T().ab)(),n=(0,a().IS)((e=>({tooltip:{width:200},shortcutLabel:{color:e.text.contrastSecondary}})),[]);return(0,K.jsx)(d().A,{renderTooltip:()=>(0,K.jsxs)("div",{style:n.tooltip,children:[(0,K.jsx)("div",{children:(0,K.jsx)(l().sA,{id:"sidebarPersonalHomeButton.tooltip",defaultMessage:"View recent pages and more"})}),(0,K.jsx)(c().A,{style:n.shortcutLabel,name:"openHome"})]}),disableTooltip:r,originGap:6,textWrap:!0,placement:A().W.Right,render:e=>(0,K.jsx)(u().A,{...e,style:s.baseSidebarItem,hoveredStyle:null==t?void 0:t.buttonHoveredStyle,onClick:()=>{P().A.open()},children:(0,K.jsx)(m().A,{left:(0,i().X)(s.topButtonIcon),disableMobileBorder:!0,children:(0,K.jsx)(l().sA,{id:"sidebarPersonalHomeButton.label",defaultMessage:"Home"})})})})}function U(e){const{top:t=0,right:r=-3}=e,s=(0,a().IS)((e=>({unreadBadge:{backgroundColor:e.redBadgeBackground,position:"absolute",top:t,right:r,width:8,height:8,borderRadius:4,border:`1px solid ${e.surface.wash}`}})),[t,r]);return(0,K.jsx)("div",{style:s.unreadBadge})}const j=(0,l().YK)({tooltip:{id:"sidebarPersonalHomeButton.tooltip",defaultMessage:"View recent pages and more"},label:{id:"sidebarPersonalHomeButton.label",defaultMessage:"Home"}}),N=s.memo(V)}}]);