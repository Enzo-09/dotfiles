"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[15498,99171],{28965:(e,t,n)=>{n.d(t,{lowPriActionsWithKeyboardShortcuts:()=>M});var o=n.n(n(36545)),r=()=>n(899963),a=()=>n(426116),i=()=>n(878377),s=()=>n(869562),c=()=>n(737230),l=()=>n(351360),d=()=>n(404141),u=()=>n(416726),m=()=>n(921385);const p=(0,n(959013).YK)({createEquationName:{id:"action.createEquation.name",defaultMessage:"Mark as equation"},openAllTogglesName:{id:"action.openAllToggles.name",defaultMessage:"Open all toggles"},toggleRecordingInputLatencyName:{id:"action.toggleRecordingInputLatency.name",defaultMessage:"Toggle recording input latency"}}),v=(0,u().Fw)({key:"toggle all teams",displayName:void 0,analyticsName:"toggleAllTeams",validators:[i().M3g,i().y2w],shortcuts:["toggleAllTeams"],closeParentMenu:!0,action:e=>{let{environment:t}=e;(0,n(770906).ZT)({environment:t,contentType:"teams"})}}),f=(0,u().Fw)({key:"toggle favorite",analyticsName:"Toggle favorite",displayName:void 0,validators:[i().M3g,i().AU6(i().Pnk),i().AU6(i().dUO)],shortcuts:["toggleFavorite"],closeParentMenu:!0,action:e=>{let{environment:t}=e;const{currentSpaceViewStore:o}=l().default.state,r=(0,m().dr)();if(!o||!r)return;const a=(0,n(245128).A)({spaceViewStore:o,pageId:r.id})?s().unbookmarkPage:s().bookmarkPage;n(751156).createAndCommit({userAction:"actionRegistry.toggleFavorite",environment:t,canUndo:!0,perform:e=>a({spaceViewStore:o,store:r,transaction:e})})}}),g=(0,u().Fw)({key:"open comments tab in update sidebar",analyticsName:"Open comments tab in update sidebar",displayName:void 0,validators:[],shortcuts:["openCommentsTabInUpdateSidebar"],closeParentMenu:!0,action:e=>{let{environment:t}=e;s().setUpdateExpand({environment:t,isExpanded:!0,from:"keyboard_comments",saveDetailsSidebarPreference:!0}),s().setUpdateSidebarTab(c().tF.Comments)}}),y=(0,u().Fw)({key:"open equation annotation menu",displayName:p.createEquationName,analyticsName:p.createEquationName.defaultMessage,validators:[i().c5w,i().AU6(i().or([i().JPf,i().wx,i().jc4,i().M7S]))],shortcuts:["openEquationMenu"],closeParentMenu:!0,action:e=>n(448619).Wx({environment:e.environment,analyticsFrom:"input_keyboard_shortcut"})}),k=(0,u().Fw)({key:"open updates tab in update sidebar",analyticsName:"Open updates tab in update sidebar",displayName:void 0,validators:[],shortcuts:["openUpdatesTabInUpdateSidebar"],closeParentMenu:!0,action:e=>{let{environment:t}=e;s().setUpdateExpand({environment:t,isExpanded:!0,from:"keyboard_updates",saveDetailsSidebarPreference:!0}),s().setUpdateSidebarTab(c().tF.Updates)}}),b=(0,u().Fw)({key:"open experiment settings",displayName:void 0,analyticsName:"openExperimentSettings",validators:[n(141966).l],shortcuts:["openExperimentSettings"],closeParentMenu:!0,action:()=>{d().A.setState({...d().A.state,open:!0,currentTab:"experiments",defaultSubtab:void 0})}}),h=(0,u().Fw)({key:"toggle all toggles",displayName:p.openAllTogglesName,analyticsName:p.openAllTogglesName.defaultMessage,validators:[],shortcuts:["toggleAllToggles"],closeParentMenu:!0,action:e=>{let{environment:t}=e;const o=n(186445).ao();o&&n(324089).In({environment:t,blockStore:o,includeSubitems:!0})}}),_=(0,u().Fw)({key:"toggle both sidebars",analyticsName:"Toggle both sidebars",displayName:void 0,validators:[],shortcuts:["toggleBothSidebars"],closeParentMenu:!0,action:e=>{let{environment:t}=e;s().toggleBothSidebars(t)}}),S=(0,u().Fw)({key:"toggle AI sidebar",displayName:void 0,analyticsName:"toggleAISidebar",validators:[],shortcuts:["toggleAISidebar"],closeParentMenu:!0,action:e=>{let{environment:t}=e;s().toggleAISidebar(t)}}),w=(0,u().Fw)({key:"create new AI sidebar chat thread",displayName:void 0,analyticsName:"createAIChatThread",validators:[],shortcuts:["createAIChatThread"],closeParentMenu:!0,action:e=>{let{environment:t}=e;n(118078).createNewChatThread(t)}}),A=(0,u().Fw)({key:"toggle recording input latency",displayName:p.toggleRecordingInputLatencyName,analyticsName:p.toggleRecordingInputLatencyName.defaultMessage,validators:[],shortcuts:["toggleRecordingInputLatency"],closeParentMenu:!0,action:()=>{n(992202).toggleRecordingInputLatency()}}),T=(0,u().Fw)({key:"switch spaces pre tabs",analyticsName:"Switch spaces pre tabs",displayName:void 0,validators:[i().b8R,i().AU6(i().ld1)],shortcuts:["switchSpacesPreTabs"],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;if(!t||!(0,m().kx)(t))return;t.preventDefault();const i=parseInt(o()(t.keyCode)),{currentUserRootStore:s,currentUserSettingsStore:c}=l().default.state;s&&c&&(a().IO({environment:n,index:i-1,userRootStore:s,userSettingsStore:c}),r().Bw(n))}}),M=[w,g,b,y,k,(0,u().Fw)({key:"switch spaces post tabs",analyticsName:"Switch spaces post tabs",displayName:void 0,validators:[i().b8R,i().ld1],shortcuts:["switchSpacesPostTabs"],closeParentMenu:!0,action:(e,t)=>{let{environment:n}=e;if(!t||!(0,m().kx)(t))return;t.preventDefault();const i=parseInt(o()(t.keyCode)),{currentUserRootStore:s,currentUserSettingsStore:c}=l().default.state;s&&c&&(a().IO({environment:n,index:i-1,userRootStore:s,userSettingsStore:c}),r().Bw(n))}}),T,v,h,_,S,f,A,(0,u().Fw)({key:"start transcription",displayName:void 0,analyticsName:"Start transcription global shortcut",validators:[i().AU6(i().Zmr),i().xIn],shortcuts:["transcription"],closeParentMenu:!0,action:e=>{let{environment:t}=e;(0,n(391532).createTranscriptionBlockInNewPage)({environment:t,from:"transcription_shortcut"})}})]},87017:(e,t,n)=>{n.r(t),n.d(t,{duplicateBlocks:()=>N,duplicateBlocksWithMaybeConfirmation:()=>M,insertBlockAbove:()=>E,insertBlockAndEdit:()=>C,insertBlockBelow:()=>R,insertTextAbove:()=>U,insertTextBelow:()=>I});n(18107),n(944114),n(967357);var o=()=>n(908006),r=()=>n(206267),a=()=>n(161479),i=()=>n(496603),s=()=>n(855801),c=()=>n(466614),l=()=>n(60867),d=()=>n(171718),u=()=>n(901389),m=()=>n(620689),p=()=>n(797265),v=()=>n(751156),f=()=>n(838256),g=()=>n(521358),y=()=>n(799832),k=()=>n(413962),b=()=>n(405417),h=()=>n(328732),_=()=>n(53664),S=()=>n(393255),w=()=>n(77246),A=()=>n(502438),T=()=>n(611371);async function M(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:r,callback:a}=e;if(!(0,T().EF)(t))return;const i=await s().VI.duplicateActions.load();let c=n;if(1===n.length){const e=await g().rW({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return void(null==a||a());c=e}const d=c.at(0);if(!d)return;const u=(0,y().U)(d);if(u&&(0,b().ls)(d,u))await l().un({blocks:c,environment:t,analyticsFrom:"subitem_duplication",callback:a,collectionContextStore:u});else{const{serverCommitResult:e}=v().createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,canUndo:!0,perform:e=>{N({environment:t,blocks:c,transaction:e,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:r,duplicateActions:i})},transactionTooBigFallback:e=>{N({environment:t,blocks:c,transaction:e,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:r,duplicateActions:i})}});e.then(a)}o().default.afterNextFlush((()=>{m().BM({environment:t})}))}function N(e){const{environment:t,blocks:n,transaction:o,preferDuplicateLocation:r,lastTopLevelBlockStore:s,preventSetSelection:l,duplicateOnlyCollectionSchema:d,duplicateActions:m}=e,v=i().$z(n,(e=>e.getFormat().app_id??e.id)),f=[];return i().jJ(v,(e=>{const n=e[0],i=!n.isTransclusionType(),{blockStores:s,onComplete:l}=m.duplicateBlock({environment:t,stores:e,transaction:o,targetSpaceId:(0,a().e)(n.pointer.spaceId),preferDuplicateLocation:r,options:{addCopyName:(0,_().A)(n),deepCopyTransclusionContainers:i,resolveTemplateVariables:!(n.isInsideTemplate()||n.isInsideFactoryOrDuplicateBlocksAction()),duplicateOnlyCollectionSchema:d}});f.push(...s),l.then((e=>{if("error"===e.status){const n=e.error;c().Rk(n)?c().UK(t,{product:n.clientData.metadata.product}):u().f1(e.errorMessage)}}))})),p().LE({blocksToInsert:f,target:s?[s]:n,environment:t,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:l}),f}function R(e){const{environment:t,createBlockItem:n,selection:o,transaction:r,analyticsFrom:a,preventSetSelection:i}=e,s=A().default.getCurrentRecordCache(),c=new(f().UF)({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let l;if((0,T().EF)(t)&&n&&s){const e=d().w({environment:t,createBlockItem:n,transaction:r,inMemoryRecordCache:s,from:a,selection:o});c.track(e.pointer,r),l=p().LE({environment:t,blocksToInsert:[e],target:o,transaction:r,replaceEmptyTextBlock:!1,preventSetSelection:i})[0]}else c.fail("invalid_state");return l}function E(e){const{environment:t,createBlockItem:n,selection:o,transaction:r,analyticsFrom:a,preventSetSelection:i}=e,s=A().default.getCurrentRecordCache();let c;if((0,T().EF)(t)&&n&&s){const e=d().w({environment:t,createBlockItem:n,transaction:r,inMemoryRecordCache:s,from:a,selection:o});c=p().t1({environment:t,blocks:[e],selection:o,transaction:r,preventSetSelection:i})[0]}return c}function C(e){const{environment:t,selection:n,transaction:o}=e,a=R({...e,preventSetSelection:!0});if(a){var i;p().x5({environment:t,insertedStores:[a],isCreated:!0});const e=w().Uv.getMode(a);if("suggest"===e){const e=k().RR(t,o,a);k().tM(o,a,{id:r().JW(),type:"insert",discussionId:e.id}),k().c3({environment:t,transaction:o,discussionStore:e,addModifiedBlockIdsAfter:[a.id]})}"suggest"===e&&null!==(i=a.getNavigableBlockStore({skipCurrent:!0}))&&void 0!==i&&i.isCommentOnly()||p().um({transaction:o,blocks:n})}return a}function I(e){const{blocks:t,transaction:n,environment:r,skipAnalytics:a}=e,i=a?void 0:"text_insert_below",s=R({environment:r,selection:t,createBlockItem:h().ry.text,analyticsFrom:i,transaction:n});return s&&o().default.afterNextFlush((()=>{S().zz({environment:r,blockStore:s,insertedTextBlockLocation:"below"})})),s}function U(e){const{blocks:t,transaction:n,environment:r,skipAnalytics:a}=e,i=a?void 0:"text_insert_below",s=E({environment:r,selection:t,createBlockItem:h().ry.text,analyticsFrom:i,transaction:n});return s&&o().default.afterNextFlush((()=>{S().zz({environment:r,blockStore:s,insertedTextBlockLocation:"above"})})),s}},141966:(e,t,n)=>{n.d(t,{H:()=>i,l:()=>s});var o=()=>n(842599),r=()=>n(351360),a=()=>n(508496);function i(e,t){return t?48:e?32:18}function s(){var e;if(a().default.checkGate({gateName:"ks_dev_settings"}))return!1;const t=null===(e=r().default.state.currentUserStore)||void 0===e?void 0:e.getEmail();return"makenotion.com"===(0,o().zN)(t??"")}},390527:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>I,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>w,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>S,MAX_RECURRENCE_INTERVAL:()=>y,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>k,RRULE_WEEKDAYS_MAP:()=>g,adjustedStartDateIfPossible:()=>T,areRecurrenceSchedulesEqual:()=>x,convertFromUnpersistedRecurrenceConfig:()=>P,convertToUnpersistedRecurrenceConfig:()=>U,getFormattedEndCondition:()=>C,getFormattedNextRecurrenceTime:()=>E,getNewEndTimestamp:()=>B,getNextDateUtc:()=>R,getRecurrenceAfter:()=>M,isRunningBetweenMidnightAnd3AM:()=>N,isValidRecurrenceInterval:()=>b,isValidRecurrenceNumberOfRuns:()=>h,rruleFromRecurrence:()=>_,templateAncestorsViolateRecurrenceNesting:()=>A});n(898992),n(354520),n(581454);var o=()=>n(244641);n(944114);function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(0===n.length)return e.map((e=>[e]));const a=[];for(const i of e)a.push(...r(n[0],...n.slice(1)).map((e=>[i,...e])));return a}var a=()=>n(496603),i=()=>n(534177),s=()=>n(720665),c=()=>n(597777),l=()=>n(869190),d=()=>n(416504),u=()=>n(402390);class m extends(()=>n(896346))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var p=()=>n(912720);const v=(0,n(959013).YK)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),f={day:m.DAILY,week:m.WEEKLY,month:m.MONTHLY,year:m.YEARLY},g={MO:m.MO,TU:m.TU,WE:m.WE,TH:m.TH,FR:m.FR,SA:m.SA,SU:m.SU},y=99,k=999;function b(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=y}function h(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=k}function _(e){const{start_date:t,frequency:n,interval:o,weekdays:a,timezone:s,hour:l,minute:d}=e,u="week"===n&&a?a.map((e=>g[e])):void 0,p={};return(0,i().O9)(e.end_condition)&&("date"===e.end_condition.type?p.until=(0,c().eU)(e.end_condition.end_at):"number"===e.end_condition.type?p.count=e.end_condition.number_of_occurrences:(0,i().HB)(e.end_condition)),"month"===e.frequency&&(0,i().O9)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?p.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?p.byweekday=r(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return g[t].nth(n)})):(0,i().HB)(e.monthly_restriction)),new m({freq:f[n],dtstart:(0,c().eU)(t),interval:o,byweekday:u,tzid:s,byhour:l??0,byminute:d??0,bysecond:0,...p})}const S=1,w=1;function A(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),o=e.length,r=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,a=o>S,i=n.length>=w;return{violatesConstraint:a||i,templateNestingExceedsMaxDepth:a,ancestorHasDailyTemplate:i,nestedDepthOfAutomationAncestors:o,immediateAncestorRecurrenceType:r}}function T(e){var t;const{recurrence:n,afterDate:r}=e;if("number"===(null===(t=n.end_condition)||void 0===t?void 0:t.type)||n.start_date>=r)return n;let a=o().c9.fromMillis(n.start_date,{zone:"utc"});const i=o().c9.fromMillis(r,{zone:"utc"});switch(n.frequency){case"year":{const e=Math.floor(i.diff(a,"years").years/n.interval);a=a.plus({years:e*n.interval});break}case"month":{const e=Math.floor(i.diff(a,"months").months/n.interval);a=a.plus({months:e*n.interval});break}case"week":{const e=Math.floor(i.diff(a,"weeks").weeks/n.interval);a=a.plus({weeks:e*n.interval});break}case"day":{const e=Math.floor(i.diff(a,"days").days/n.interval);a=a.plus({days:e*n.interval});break}}return{...n,start_date:(0,c().DH)(a.toMillis())}}function M(e){const{recurrence:t,afterDate:n}=e;if((0,p().wt)(t)){const e=(0,c().l1)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=_(T({recurrence:t,afterDate:n})).after((0,c().eU)(n));if(!e)return;return(0,c().h1)(e)}}function N(e){return 0===e.hour||1===e.hour||2===e.hour}function R(e){return _(e).after((0,c().eU)((0,c().Rz)()))||void 0}function E(e){const{recurrence:t,intl:n}=e,r=R(P(t));if(!r)return;const a=N(t),i=o().c9.fromJSDate(r).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,u().H)(n)).setZone(t.timezone),s=(0,l().Yq)({date:i,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(a)return n.formatMessage(v.dateBetweenMidnightAnd3AM,{date:s});{let e=i.toLocaleString(o().c9.TIME_SIMPLE);return t.timezone!==(0,d().P)()&&(e+=` ${i.toFormat("ZZZZ")}`),n.formatMessage(v.dateAtTime,{date:s,time:e})}}function C(e,t){return(0,i().O9)(e)?"number"===e.type?t.formatMessage(v.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,l().Yq)({date:o().c9.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,i().HB)(e):t.formatMessage(v.noEndCondition)}const I=100;function U(e){return{...e,start_date:(0,c().l1)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,c().l1)(e.end_condition.end_at)}:(0,i().HB)(e.end_condition):void 0}}function B(e,t,n){return e.plus(n-t)}function F(e,t){const n=o().c9.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,c().Rz)(n.toJSDate())}}function P(e){return{...e,start_date:(0,c().Rz)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?F(e,e.end_condition):(0,i().HB)(e.end_condition):void 0}}function x(e,t){const n=a().fN(e,(e=>void 0!==e)),o=a().fN(t,(e=>void 0!==e));return a().n4(n,o)}},391532:(e,t,n)=>{n.r(t),n.d(t,{appendTranscriptionBlockToPage:()=>_,createTranscriptionBlockInNewPage:()=>S});var o=()=>n(244641),r=()=>n(584262),a=()=>n(700500),i=()=>n(597777),s=()=>n(604995),c=()=>n(416504),l=()=>n(919709),d=()=>n(171718),u=()=>n(44729),m=()=>n(857783),p=()=>n(185544),v=()=>n(319975),f=()=>n(751156),g=()=>n(87017),y=()=>n(328732),k=()=>n(211716),b=()=>n(351360),h=()=>n(502438);function _(e){const{environment:t}=e;f().createAndCommit({userAction:"transcriptionNewPageActions.appendTranscriptionBlock",environment:t,canUndo:!0,perform:e=>{(0,g().insertBlockBelow)({environment:t,createBlockItem:y().ry[a().xd.transcription],analyticsFrom:"quick_templates",selection:[],transaction:e})}})}function S(e){const{environment:t,from:n}=e,g=b().default.state.currentSpaceStore,_=b().default.state.currentSpaceViewStore,S=h().default.getCurrentRecordCache();if(!S)return;if(!g||!_)return;const{performResult:{createdPage:w}}=f().createAndCommit({userAction:"transcriptionNewPageActions.createTranscriptionBlockInNewPage",environment:t,canUndo:!0,perform:e=>{const r=p().IT({environment:t,spaceStore:g,spaceViewStore:_,isPrivate:!0,transaction:e});if(r.isType(a().xd.page)){const n=r.getBlockTitleStore(),a=o().c9.now(),d=[l().wmz(l().Ww9({type:"datetime",start_date:a.toFormat(s().tr),start_time:a.toFormat(i().GE),time_zone:(0,c().P)(),date_format:"relative"}),[[l().BQP.Bold]])];v().yr({environment:t,store:n,tokens:d,transaction:e,index:0})}const m=y().ry[a().xd.transcription],f=d().w({environment:t,transaction:e,inMemoryRecordCache:S,from:n,selection:[],createBlockItem:m});return u().NI({childStore:f,parentStore:r,transaction:e}),{createdPage:r}}});m().uK({environment:t,store:w,visitType:k().ig.Link,pageVisitSource:r().y8.Create})}},725649:(e,t,n)=>{function o(e){return!(!e||"askUserToPick"in e)}function r(e){if(!e||!("askUserToPick"in e))return e}function a(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}n.d(t,{DK:()=>r,K$:()=>o,j6:()=>a})}}]);