"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[209],{149257:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(296540),s=()=>a(959013),o=a(474848);const r=(0,s().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const i=function(e){const{teamStore:t,teamName:i,teamId:l,isModalOpen:u,onDismiss:m}=e,[c,d]=(0,n.useState)(""),g=(0,a(484714).v3)(),p=(0,s().tz)(),v=async()=>{await a(350648).Ip({environment:g,teamId:l,message:c}),m()},S=(0,a(401497).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,o.jsx)(a(676007).A,{open:u,onDismiss:m,innerStyle:S.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:S.requestTitle,children:(0,o.jsx)(s().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:i,icon:(0,o.jsx)(a(898808).x,{style:S.icon,store:t,disabled:!0,size:22})}})}),(0,o.jsx)(a(623580).A,{textarea:!0,style:S.input,value:c,onChange:e=>{d(e.target.value)},placeholder:p.formatMessage(r.message_placeholder)}),(0,o.jsxs)("div",{style:S.footer,children:[(0,o.jsx)(a(125565).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,o.jsx)(s().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,o.jsx)(a(204063).A,{size:"lg",style:S.requestInvitesButton,onClick:v,children:(0,o.jsx)(s().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},211825:(e,t,a)=>{a.d(t,{G:()=>r});var n=()=>a(484714),s=()=>a(847249),o=()=>a(486130);function r(e){const t=(0,n().v3)().currentUser.id;return(0,s().K8)((()=>Boolean(void 0!==t&&e.isNonGuestMember(t,o()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()})))),[t,e])}},341974:(e,t,a)=>{a.r(t),a.d(t,{TeamJoinLeaveButton:()=>y});var n=a(296540),s=()=>a(484714),o=()=>a(847249),r=()=>a(401497),i=()=>a(284371),l=()=>a(640653),u=()=>a(37433),m=()=>a(515512),c=()=>a(211825),d=()=>a(959013),g=()=>a(493823),p=a(474848);const v=function(e){const{teamStore:t,from:r,navigateToTeamHomeOnJoin:i,style:l,hoveredStyle:u,icon:m,isRed:c}=e,v=(0,s().v3)(),S=(0,o().O$)(a(351360).AppStoreCurrentSpaceStore),f=(0,n.useCallback)((async()=>{S&&await a(848237).e2({environment:v,teamStore:t,currentSpaceStore:S,from:r,andNavigateToTeamHome:i??!1})}),[S,v,t,r,i]);return(0,p.jsx)(g().p,{style:l,hoveredStyle:u,onClick:f,icon:m,isRed:c,children:(0,p.jsx)(d().sA,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var S=()=>a(655784);const f=function(e){const{teamStore:t,style:s,hoveredStyle:r}=e,[i,l]=(0,n.useState)(!1),u=(0,o().K8)((()=>t.getName()),[t]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(g().p,{style:s,hoveredStyle:r,onClick:()=>l(!0),children:(0,p.jsx)(d().sA,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,p.jsx)(a(149257).A,{teamStore:t,teamName:u,teamId:t.id,isModalOpen:i,onDismiss:()=>l(!1)})]})};function y(e){const{teamStore:t,style:a,hoveredStyle:n}=e,d=(0,s().v3)(),g=(0,m().Q)(),y=(0,c().G)(t),T=(0,o().K8)((()=>t.getTeamAccessLevel()),[t]),h=(0,r().IS)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:i().Wy.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...a},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...n}})),[a,n]),I=(0,o().K8)((()=>(0,u().isUnownedTeam)({membership:t.getRawMembership()})&&(0,l().s7)(d)),[d,t]),b=!y&&"open"===T||I,w=!y&&"closed"===T;return g?null:y?(0,p.jsx)(S().A,{...e,style:h.joinTeamButton,hoveredStyle:h.joinTeamButtonHoveredStyle}):b?(0,p.jsx)(v,{...e,style:h.joinTeamButton,hoveredStyle:h.joinTeamButtonHoveredStyle}):w?(0,p.jsx)(f,{teamStore:t,style:h.joinTeamButton,hoveredStyle:h.joinTeamButtonHoveredStyle}):null}},350648:(e,t,a)=>{a.d(t,{D2:()=>b,Ip:()=>T,Jk:()=>h,YT:()=>I,e2:()=>f,g:()=>y});a(898992),a(354520);var n=()=>a(584262),s=()=>a(798880),o=()=>a(946141),r=()=>a(449506),i=()=>a(246826),l=()=>a(436572),u=()=>a(426116),m=()=>a(751156),c=()=>a(972435),d=()=>a(640653),g=()=>a(351360),p=()=>a(848237),v=()=>a(263928);const S=(0,a(959013).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function f(e){let{environment:t,userId:a,teamStore:n,user:s}=e;const r=n.getSpaceId();if(!r)return;await p().rU({environment:t,teamId:n.id,spaceId:r,teamUserInfo:s,isSettingDefaultTeam:!1,inviterId:a})&&(o().vo(t,{store:n,joined_role:"member",from:"team_invite_link"}),await y({environment:t,userId:a,teamStore:n}),l().D6({label:c().A.formatMessage(S.joinTeamSuccessMessage,{teamName:n.getName()})}))}async function y(e){let{environment:t,userId:a,teamStore:s}=e;const o=g().default.state.currentUserRootStore,r=s.getSpaceId();if(!r||!o)return;const i=o.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];await u().tR({environment:t,spaceViewStore:i,userSettingsStore:void 0,userRootStore:o,pageVisitSource:n().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await v().J({environment:t,spaceId:r,userId:a}),p().L0({environment:t,teamStore:s,shouldScroll:!0})}async function T(e){let{environment:t,teamId:a,message:n}=e;if(!t.currentUser.id)return;"success"===(await r().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:a,message:n}})).type?(o().XQ(t,{teamId:a}),await I({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{l().D6({label:c().A.formatMessage(S.requestTeamSuccessMessage)})}))):l().D6({label:c().A.formatMessage(S.requestTeamFailureMessage)})}async function h(e){let{environment:t,teamStore:a,accessRequestStore:n,status:r}=e;const l=n.getForActorId();if(!l)return;const u=n.getRecordModel({table:s().oo,id:l});if(u){if("approved"===r){const e=[{type:"member",entity_type:"user",user_id:u.id}];if(!(await p().Zd({environment:t,teamStore:a,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}m().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{i().zv({store:n,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:s().oo,resolved_by_id:t.currentUser.id,status:r}})}}),o().GW(t,{store:a,resolution:r})}}async function I(e){let{environment:t}=e;const{lastVisitedSpaceView:a,userRootStore:s,userSettingsStore:o}=await(0,d().ex)({environment:t,disableRedirectUrl:!1});a?await u().tR({environment:t,spaceViewStore:a,userRootStore:s,userSettingsStore:o,pageVisitSource:n().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await u().t9({environment:t,userRootStore:s,userSettingsStore:o,pageVisitSource:n().y8.BackForward})}async function b(e){let{environment:t,teamId:a}=e;const n=await r().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:a}});if("success"===n.type)return n.data}},418426:(e,t,a)=>{a.d(t,{$:()=>l});a(898992),a(354520),a(581454);var n=()=>a(484714),s=()=>a(847249),o=()=>a(468006),r=()=>a(605402),i=()=>a(486130);function l(e){const t=(0,n().v3)().currentUser.id;return(0,s().K8)((()=>{if(!e.isDefined())return[];return(0,o().ri)({rawMembers:e.getRawMembership(),groupsInSpace:r().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))}).filter((a=>i()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()}).has(a.getGroupId())))}),[t,e])}},515512:(e,t,a)=>{a.d(t,{Q:()=>l});var n=()=>a(484714),s=()=>a(847249),o=()=>a(640653),r=()=>a(351360),i=()=>a(749240);function l(){const e=function(){const e=(0,n().v3)();return(0,s().K8)((()=>{const t=r().default.state.currentSpaceStore,a=i().subscriptionDataStoreInstance.state;return t?o().IL(t)?a?{loading:!1,isUserTeamGuestOfSpace:o().Qx(e,a)}:{loading:!0}:{loading:!1,isUserTeamGuestOfSpace:!1}:{loading:!0}}),[e])}();return(0,s().K8)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},655784:(e,t,a)=>{a.d(t,{A:()=>m});a(581454);var n=a(296540),s=()=>a(484714),o=()=>a(847249),r=()=>a(959013),i=()=>a(496603),l=()=>a(418426),u=a(474848);const m=function(e){const{teamStore:t,from:m,onLeavingTeam:c,style:d,hoveredStyle:g,icon:p,isRed:v,placement:S,alignment:f,buttonInternals:y}=e,T=(0,s().v3)(),h=(0,o().O$)(a(351360).AppStoreCurrentSpaceStore),I=(0,l().$)(t),b=(0,n.useCallback)((async()=>{if(!h)return;await a(848237).JC({environment:T,teamStore:t,from:m,userGroupsInTeam:I})&&(null==c||c())}),[h,T,t,m,I,c]),w=(0,u.jsx)(r().sA,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),j=function(e){let{teamStore:t}=e;const a=(0,s().v3)(),n=a.currentUser.id,{isDefaultTeam:m}=(0,o().K8)((()=>({isDefaultTeam:t.isDefault()})),[t]),c=(0,l().$)(t),d=(0,o().K8)((()=>{if(!t.isReady())return!1;const{ownerUserIds:e,ownerGroupIds:a}=t.getAllOwnerIds();return Boolean(n&&t.isOwner(n)&&e.length+a.length===1)}),[t,n]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:a,userGroupsInTeam:n}=e;if(t)return(0,u.jsx)(r().sA,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You canâ€™t leave this teamspace because everyone in the workspace must be a member"});if(a)return(0,u.jsx)(r().sA,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(n.length>0)return(0,u.jsx)(r().sA,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:i().oE(n.map((e=>e.name))).join()}})}({isDefaultTeam:m,isOnlyTeamOwner:d,userGroupsInTeam:c})}({teamStore:t}),A=Boolean(j),M=A?j:w;return(0,u.jsx)(a(859428).A,{style:A?{width:240}:void 0,disableTooltip:!Boolean(M),renderTooltip:e=>(0,u.jsx)("div",{...e,children:M}),textWrap:A,placement:S,alignment:f,render:e=>(0,u.jsx)(a(493823).p,{...e,style:d,hoveredStyle:g,onClick:b,disabled:A,disabledFeedback:A,icon:p,isRed:v,children:y||(0,u.jsxs)(u.Fragment,{children:[(0,a(831310).o)({width:12.5,marginRight:4}),(0,u.jsx)(r().sA,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}}}]);