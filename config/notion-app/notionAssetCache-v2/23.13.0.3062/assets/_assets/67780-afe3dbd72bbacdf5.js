"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[67780],{158574:(e,t,n)=>{n.d(t,{Bq:()=>g,K$:()=>p,OW:()=>a,de:()=>c,o:()=>u});var i=()=>n(908006),o=()=>n(919709),r=()=>n(725614),s=()=>n(751156);const l=1e3;function a(e){if(e){const t=(0,o().q4_)(e.getValue());return Boolean(t)}return!1}function d(e){if(e){const t=e.getSettings();if(t&&t.hidden_collection_descriptions)return t.hidden_collection_descriptions}return[]}function c(e){const{environment:t,descriptionStore:n}=e;u(e),i().default.afterNextFlush((()=>{n&&!t.device.isMobileBrowser&&r().setSelectionAtEnd({store:n})}))}function g(e){const{toggleStore:t,pageId:n,descriptionStore:i,environment:o,userSettingsStore:r}=e;u({environment:o,pageId:n,isExpanded:!t.state.isPageDescriptionExpanded,store:t,userSettingsStore:r,descriptionStore:i})}function u(e){const{environment:t,pageId:n,isExpanded:i,store:o,userSettingsStore:r,descriptionStore:c}=e,g=o.state.isPageDescriptionExpanded;o.setState({...o.state,isPageDescriptionExpanded:i});a(c)&&r&&g!==i&&s().createAndCommit({userAction:"pageDescriptionActions.setExpanded",environment:t,canUndo:!0,perform:e=>{if(i){const t={pointer:{table:"user_settings",id:r.id},path:["settings","hidden_collection_descriptions"],command:"listRemove",args:{id:n}};s().applyOperation({store:r,transaction:e,operation:t})}else{const t={pointer:{table:"user_settings",id:r.id},path:["settings","hidden_collection_descriptions"],command:"listAfter",args:{id:n}};s().applyOperation({store:r,transaction:e,operation:t});let i=d(r);for(;i.length>l;){const t=i[0],n={pointer:{table:"user_settings",id:r.id},path:["settings","hidden_collection_descriptions"],command:"listRemove",args:{id:t}};s().applyOperation({store:r,transaction:e,operation:n}),i=d(r)}}}})}function p(e){const{pageId:t,store:n,userSettingsStore:i,descriptionHasText:o}=e;let r=o;d(i).includes(t)&&(r=!1),n.setState({...n.state,isPageDescriptionExpanded:r})}},167780:(e,t,n)=>{n.d(t,{O:()=>ue,A:()=>pe});var i=n(296540),o=()=>n(484714),r=()=>n(819121),s=()=>n(847249),l=()=>n(835755),a=()=>n(263931),d=()=>n(861017),c=()=>n(919709),g=()=>n(959013),u=()=>n(158574),p=()=>n(778417),S=()=>n(725614),f=()=>n(186445),x=()=>n(600871),m=()=>n(478726),h=()=>n(836251),v=()=>n(792002),y=()=>n(645873),b=()=>n(551619),j=()=>n(817942),C=()=>n(792485),I=()=>n(315564),w=()=>n(220719),M=()=>n(496603),A=()=>n(284371),K=()=>n(319975),E=()=>n(751156),k=()=>n(614505),T=()=>n(16006),P=()=>n(859428),_=()=>n(524702),B=()=>n(792540),D=()=>n(231722),R=()=>n(731320),L=()=>n(969197),U=()=>n(77246),F=()=>n(24157),V=n(474848);function W(e){let{descriptionStore:t,disabled:n,toggleStore:i,pageId:o,userSettingsStore:r,collectionStore:s,locked:l,canEdit:a}=e;return(0,V.jsx)("div",{style:{maxWidth:"100%",borderRadius:4,overflow:"hidden",marginBottom:12},children:(0,V.jsx)(Y,{descriptionStore:t,disabled:n,toggleStore:i,pageId:o,userSettingsStore:r,collectionStore:s,locked:l,canEdit:a})})}const O=i.memo(W);function z(e){return e.state.isPageDescriptionExpanded}function H(e){let{collectionStore:t}=e;const n=(0,s().K8)((()=>t&&t.getIcon()),[t]);return(0,V.jsxs)("div",{style:{display:"flex",alignItems:"start"},children:[(0,V.jsx)("div",{style:{paddingTop:4,paddingRight:6},children:(0,I().S)({width:12})}),(0,V.jsx)("div",{children:(0,V.jsx)("div",{children:(0,V.jsx)(g().sA,{defaultMessage:"Please unlock {pageTitleWithIcon} to edit the description.",id:"pageDescription.lockedTooltip.message",values:{pageTitleWithIcon:(0,V.jsxs)("span",{style:{whiteSpace:"nowrap",fontWeight:A().Wy.bold},children:[n&&(0,V.jsx)(k().B,{disabled:!0,icon:n,isEmptyPage:!1,size:12,style:{marginRight:4,display:"inline-block"}}),t&&(0,V.jsx)(T().A,{store:t,style:{display:"inline"}})]})}})})})]})}function N(e){return!0}function Q(e){return!0}function $(e,t,n,i,o,r){if(!function(e,t,n){const i=n&&n.publicEditModeStore.state,o=(0,w().o9)((0,L().T)(e));return!t&&!(0,R().QT)(i)&&"suggest"!==U().Uv.getMode(o)&&e.canEdit()}(n,i,r))return;if(e.preventDefault(),o&&o.isComposing())return;const s=F().default.state;if("editing"===s.mode){const e=(0,D().H7)(s.multiSelection);if(!e)return;const i=null!=r&&r.pageStore?U().Uv.getMode(r.pageStore):"default";E().createAndCommit({userAction:"PageDescription.handleEnter",environment:t,canUndo:!0,perform:o=>{K().$D({environment:t,editorMode:i,store:n,string:"\n",selection:e.selection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}})}}const G={fontSize:14,paddingLeft:6,paddingBottom:4,paddingTop:3,width:780};function q(e){let{descriptionStore:t,disabled:n,toggleStore:r,pageId:l,userSettingsStore:a}=e;const d=(0,o().v3)(),c=(0,g().tz)(),{device:p}=d,S=(0,C().S)(),f=(0,i.useRef)(null),x=(0,i.useCallback)((e=>$(e,d,t,n,f.current,S)),[d,t,n,S,f]),m=(0,s().K8)((()=>z(r)),[r]);return t?(0,V.jsx)(_().A,{ref:f,store:t,style:G,disabled:n,placeholder:c.formatMessage({defaultMessage:"Add a descriptionâ€¦",id:"pageDescription.emptyPlaceholder"}),disableSlashCommands:!0,disableEmbedMenu:!0,disableMentions:!0,onTab:N,onUntab:Q,onEnter:x,onClick:m?M().lQ:e=>function(e,t,n,i,o,r){z(t)||e.preventDefault(),u().Bq({toggleStore:t,pageId:n,descriptionStore:i,environment:o,userSettingsStore:r})}(e,r,l,t,d,a),disableStyleAnnotations:p.isMobileBrowser,disableInsertedDeletedAnnotations:p.isMobileBrowser,disableHorizontalEdgeScroll:!0,pasteBehavior:"inline",inPageFind:B().Os.none}):null}function Y(e){let{descriptionStore:t,disabled:n,toggleStore:i,pageId:r,userSettingsStore:s,collectionStore:l,locked:a,canEdit:d}=e;return(0,o().v3)().device.isMobile?(0,V.jsx)(q,{descriptionStore:t,disabled:n,toggleStore:i,pageId:r,userSettingsStore:s}):(0,V.jsx)(P().A,{renderTooltip:()=>(0,V.jsx)(H,{collectionStore:l}),disableTooltip:!a||!d,render:e=>(0,V.jsx)("div",{children:(0,V.jsx)("div",{style:{display:"flex",cursor:"text"},...e,children:(0,V.jsx)(q,{descriptionStore:t,disabled:n,toggleStore:i,pageId:r,userSettingsStore:s})})})})}var J=()=>n(603616),Z=()=>n(793282),X=()=>n(441301),ee=()=>n(644914),te=()=>n(578872),ne=()=>n(351360),ie=()=>n(661179),oe=()=>n(548821),re=()=>n(563615),se=()=>n(938090),le=()=>n(145214),ae=()=>n(493823),de=()=>n(774524),ce=()=>n(556048);function ge(e){const{canEdit:t,context:n,controlHoverStyle:y,disabled:C,handleHeaderMouseEnter:I,handleHeaderMouseLeave:w,headerFocusStore:M,isEditable:A,paddingLeft:K,paddingRight:E,pageCover:k,store:T,topControls:P,onCollectionViewBlockMount:_,editorContentContainerRef:B,forceLocalQueryCollection:D,productUseCase:R,pageViewBlockStore:L}=e,F=(0,o().v3)(),W=(0,o().Y0)(),[z,H]=(0,i.useState)(!!W.isAndroid);(0,i.useEffect)((()=>{(async()=>{if((0,h().w6)(F)){const e=F.RouterStore.getState();if((0,d().bh)(e.route)){const e=(0,te().GN)(T),t=null==e?void 0:e.getSiteStore();await(null==t?void 0:t.load());const n=null==t?void 0:t.getSettings(),i=null==n?void 0:n.embedSettings;return void H(Boolean(!(null!=i&&i.hideTitle)))}}H(!0)})()}),[F,T]);const N=(0,s().K8)((()=>T.getCollectionViewSourceDescriptionStoreIfSingleSource()),[T]),Q=(0,s().K8)((()=>T.getCollectionStoreIfSingleSource()),[T]),$=(0,s().K8)((()=>1===T.getAllSourceCollectionStores().length&&0===T.getAllLinkedCollectionStores().length),[T]),G=(0,s().K8)((()=>u().OW(N)),[N]),q=(0,s().K8)((()=>T.getTitleStore()),[T]),Y=(0,s().K8)((()=>U().Uv.getMode(T)),[T]),re=i.useRef(!1);(0,i.useEffect)((()=>{if(!re.current){re.current=!0;const{currentUserSettingsStore:e}=ne().default.state;u().K$({pageId:T.id,store:L,userSettingsStore:e,descriptionHasText:G})}}),[G,T.id,L]);const ge=(0,s().K8)((()=>c().q4_(null==q?void 0:q.getValue())),[q]),ue=(0,s().K8)((()=>!(0!==T.getCollectionViewStores().length)||(!!$||!!q&&(!!ge||!!(0,v().j_)(q)))),[T,q,ge,$]),pe=(0,s().K8)((()=>f().sj(T.id)||f().Wu(T.id)),[T]),Se=(0,s().K8)((()=>(0,m().NR)(T,F)),[T,F]),fe=(0,s().K8)((()=>(0,m().uf)(T,n,F)),[T,n,F]),xe=(0,b().dK)(T),me=(0,b().l8)(T),he=xe||me,ve=()=>{const{currentUserSettingsStore:e}=ne().default.state,t=T.id;u().o({environment:F,pageId:t,isExpanded:!1,store:L,userSettingsStore:e,descriptionStore:N})},ye=()=>{const{currentUserSettingsStore:e}=ne().default.state,t=T.id;u().o({environment:F,pageId:t,isExpanded:!0,store:L,userSettingsStore:e,descriptionStore:N})},be=(0,s().K8)((()=>{const e=L.state.isPageDescriptionExpanded;return(u().OW(N)||A)&&e}),[N,A,L]),je=(0,s().K8)((()=>{if(!be)return{type:"hidden"};if(!N)return{type:"hidden"};if(!L.state.isPageDescriptionExpanded)return{type:"hidden"};const{currentUserSettingsStore:e}=ne().default.state;return{type:"visible",descriptionStore:N,currentUserSettingsStore:e,collectionStore:Q}}),[N,Q,L,be]),Ce=(0,s().K8)((()=>T.isNonEditableState()),[T]),Ie=e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,r().p)(t)&&M.setState(!0)},we=()=>{const{currentUserSettingsStore:e}=ne().default.state,t=N;u().de({environment:F,pageId:T.id,store:L,userSettingsStore:e,isExpanded:!0,descriptionStore:t})},Me=()=>{M.setState(!1)},Ae=()=>{q&&(p().IU({environment:F}),S().setSelectionAtEnd({store:q}))},Ke=()=>{if(!$&&A&&!ge)return(0,V.jsx)(ae().p,{style:y,isLightGray:!0,onClick:Ae,icon:a().D,children:W.isSmallPhone?(0,V.jsx)(g().sA,{id:"pageViewBlock.add.pageTitleMobile",defaultMessage:"Title"}):(0,V.jsx)(g().sA,{id:"pageViewBlock.add.pageTitle",defaultMessage:"Add title"})},"add-title")},Ee=()=>{if(Q)return be?(0,V.jsx)(ae().p,{isLightGray:!0,style:y,onClick:ve,icon:l().p,children:(0,V.jsx)(g().sA,{defaultMessage:"Hide description",id:"pageViewBlock.hideDescription.button"})}):A&&!G&&"suggest"!==Y?(0,V.jsx)(ae().p,{isLightGray:!0,style:y,onClick:we,icon:l().p,children:W.isSmallPhone?(0,V.jsx)(g().sA,{defaultMessage:"Description",id:"pageViewBlock.addDescription.mobileButton"}):(0,V.jsx)(g().sA,{defaultMessage:"Add description",id:"pageViewBlock.addDescription.button"})}):G?(0,V.jsx)(ae().p,{isLightGray:!0,style:y,onClick:ye,icon:l().p,children:W.isSmallPhone?(0,V.jsx)(g().sA,{defaultMessage:"Description",id:"pageViewBlock.showDescription.mobileButton"}):(0,V.jsx)(g().sA,{defaultMessage:"Show description",id:"pageViewBlock.showDescription.button"})}):void 0},ke=!(0,x().my)({device:W}),Te=(0,s().K8)((()=>(0,ee().Uh)(F)+(0,ee().zo)(F,!1)-ie().A.state-K),[F,K]),Pe=(0,s().K8)((()=>{const{WindowSizeStore:e}=F;return{paddingLeft:e.getSafePaddingLeftCSS(K),paddingRight:e.getSafePaddingRightCSS(E)}}),[F,K,E]);const _e=(0,s().K8)((()=>function(e,t){if(!function(e){var t;return e.id===(null===(t=ne().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id)}(t))return;const{RouterStore:n}=e,i=n.state.route;if("page"===i.name)return i.collectionViewId}(F,T)),[T,F]);return(0,V.jsxs)(V.Fragment,{children:[z&&function(){const i=pe?null:(0,V.jsxs)("div",{style:{display:"flex",alignItems:"flex-start"},children:[(0,V.jsx)(J().A,{...e}),ue&&(0,V.jsx)(X().s,{...e})]});return(0,V.jsxs)("div",{style:Se,onMouseEnter:I,onMouseLeave:w,children:[k,(0,V.jsxs)(le().A,{animate:{width:fe},style:{maxWidth:"100%",paddingLeft:Pe.paddingLeft},children:[(0,V.jsxs)(de().A,{store:T,context:e.context,onFocus:Ie,onBlur:Me,children:[(0,V.jsx)(se().h3,{store:T,style:y}),P,Ke(),ke&&Ee()]}),(0,V.jsxs)("div",{style:{paddingRight:Pe.paddingRight,marginBottom:8,width:Te},children:[i,he&&(0,V.jsx)(ce().GL,{store:T}),"visible"===je.type&&(0,V.jsx)(O,{disabled:!A,canEdit:t,locked:Ce,pageId:T.id,toggleStore:L,descriptionStore:je.descriptionStore,collectionStore:je.collectionStore,userSettingsStore:je.currentUserSettingsStore}),(0,V.jsx)(Z().h,{store:T,context:n,layoutModule:void 0,disabled:C||"suggest"===Y,wrapper:e=>(0,V.jsx)(j().vV,{className:"layout-content-with-divider",children:e})},T.id)]})]})]})}(),(0,V.jsx)(se().dN,{editorContentContainerRef:B,overridePaddingLeft:K,overridePaddingRight:E,store:T,isFullScreen:!0,productUseCase:R||"full_page",viewId:_e,disabled:C,headerActionsBehavior:n===oe().Rr.InAppTemplatePreview?"hidden":"default",onMount:_,forceLocalQueryCollection:D})]})}function ue(e){const t=(0,o().v3)(),{value:n}=(0,y().fJ)(re().oQ.workflowNavigationHelpers);return(0,s().K8)((()=>null==n?void 0:n.getIsWorkflowEditorOpen(t)),[t,n])?(0,V.jsx)(re().$b,{...e,renderLoading:()=>(0,V.jsx)(ge,{...e})}):(0,V.jsx)(ge,{...e})}const pe=i.memo(ge,n(821062).A)},441301:(e,t,n)=>{n.d(t,{s:()=>S});var i=n(296540),o=()=>n(662303),r=()=>n(484714),s=()=>n(847249),l=()=>n(799954),a=()=>n(284371),d=()=>n(11048),c=()=>n(155004),g=()=>n(548821),u=()=>n(551619),p=n(474848);const S=i.memo((function(e){let{store:t,context:S,disabled:x,isInSidePeek:m,extraStyles:h,titlePlaceholder:v,collectionContextStore:y,shouldShowTemplatePicker:b,onTitleChange:j,onTitleEditText:C,onTitleEsc:I,onTitleUntab:w,onTitleTab:M,onMoveUp:A,onMoveDown:K,hideText:E,disableEnter:k}=e;const T=(0,n(959013).tz)(),P=(0,r().v3)(),_=(0,r().Y0)(),B=(0,n(792485).S)(),D=(0,s().K8)((()=>t.getTitleStore()),[t]),R=(0,s().K8)((()=>{if(t.isCollectionView()){const e=t.getCollectionStoreIfSingleSource();return!!e&&e.isSyncedCollection()}return t.isType(n(700500).xd.externalObjectInstancePage)}),[t]),L=(0,u().Sm)(t),U=(0,s().K8)((()=>{if(x)return!1;if(n(620149).l.state)return!1;const e=B&&B.publicEditModeStore.state;return!(0,n(731320).QT)(e)&&t.canEditCollection()}),[x,B,t]),F=(0,s().K8)((()=>{if(!t.isCollectionView())return!1;const e=t.getCollectionStoreIfSingleSource();return!!e&&(0,n(107041).Qu)(e.getValue())}),[t]),V=(0,s().K8)((()=>{const e=t.getModel();return v??(null==e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:t.getRecordModel,userTimeZone:(0,n(416504).P)(),intl:n(972435).A.getIntl()}))}),[t,v]),W=!P.device.isMobile&&m,O=(0,s().K8)((()=>U&&!t.isNonEditableState()&&!R&&!L&&!(0,n(696746).Nh)(t.id)&&!("suggest"===n(77246).Uv.getMode(t))),[U,R,L,t]),z=(0,s().K8)((()=>t.isEmptyPage()),[t]),H=(0,s().K8)((()=>t.isTemplate()),[t]),N=(0,s().K8)((()=>t.getAssociatedCollectionTemplateStores()),[t]),Q=(0,s().K8)((()=>t.getSyncedUri()),[t]),$=function(e){const{store:t,isInSidePeek:i,context:d,extraStyles:c}=e,u=(0,r().v3)(),p=(0,s().K8)((()=>t.getFormat()),[t]),S=(0,s().K8)((()=>t.isCollectionView()),[t]),f=(0,s().K8)((()=>t.isExternalObjectInstancePageBlockStore()),[t]),x=(0,r().Y0)(),m=(0,n(600871).cV)({device:x});return(0,n(401497).IS)((e=>{const t=Boolean(p.page_small_text)||S||i;let n;n=u.device.isMobile?m?34:28:t?32:d===g().Rr.DraftPostInInlineComposer?26:40;const r=d===g().Rr.DraftPostInInlineComposer?a().Wy.semibold:a().Wy.bold,s=u.device.isMobile?"0px":`${l().nE}px`;return{title:{...l().nE,paddingBottom:s,width:f?"fit-content":"100%",fontSize:"1em",fontWeight:"inherit",margin:0,...d===g().Rr.DraftPostInInlineComposer&&{fontSize:24}},selectable:{color:e.text.primary,fontWeight:r,lineHeight:1.2,fontSize:n,fontFamily:a().xf({pageFont:p.page_font,locale:o().locale}),cursor:"text",display:"flex",alignItems:"center",textRendering:u.device.isSafari?"optimizeSpeed":void 0,...c},link:{width:16,fill:e.mediumIconColor},placeholder:{...l().nE,paddingBottom:s,WebkitTextFillColor:e.pageTitlePlaceholderTextColor,cursor:"text",...d===g().Rr.DraftPostInInlineComposer&&{color:e.text.tertiary,WebkitTextFillColor:e.text.tertiary}}}}),[m,u.device.isMobile,u.device.isSafari,c,p.page_font,p.page_small_text,S,f,i,d])}({store:t,isInSidePeek:m,context:S,extraStyles:h}),G=(0,s().K8)((()=>t.isExternalObjectInstancePageBlockStore()),[t]),q=(0,s().K8)((()=>t.isExternalCollectionBlockStore()?t:void 0),[t]),Y=(0,s().K8)((()=>(null==q?void 0:q.canEdit())??!1),[q]),J=(0,s().K8)((()=>Q?(0,n(493208).e)(Q,t.pointer.spaceId):void 0),[t.pointer.spaceId,Q]),Z=(0,s().K8)((()=>n(430483).zD.shouldEnablePageTitleDiffs(_)),[_]),X=N&&0===N.length,ee=(0,u().O9)(t,S),te=(0,s().K8)((()=>!!k||!ee&&(!(!b||H||X||P.device.isMobile)&&z)),[ee,k,b,H,X,P.device.isMobile,z]),ne=(0,i.useRef)(null),ie=(0,i.useCallback)((()=>{t&&n(751156).createAndCommit({userAction:"TourTutorial.createEmptyTextBlock",environment:P,canUndo:!0,perform:e=>{n(324089)._N({environment:P,store:t,transaction:e})}})}),[t,P]);if(F)return(0,p.jsx)(d().A,{name:"PageTitle",children:null});if(!D)return(0,p.jsx)(d().A,{name:"PageTitle",children:null});const oe=n(630116).Bv.createChildStore(D,t.pointer),re=P.device.isIOS||P.device.isSafari,se=(0,p.jsx)(n(998109).n,{step:"create_page_start_with_title",showSidebarOverlays:!1,onNextButtonClick:ie,children:E?(0,p.jsx)(p.Fragment,{}):(0,p.jsx)(n(524702).A,{tagName:"h1",style:$.title,store:D,placeholderStyle:$.placeholder,disabled:!O,placeholder:V,disableSlashCommands:!0,disableSelectAllBlocks:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!Z,disableMobileActionBar:!1,disableShiftEnter:!0,disableEmbedMenu:!0,onEsc:I,onUntab:w,onTab:M,onMoveDown:K,onMoveUp:A,disableUpDownArrows:!(!b||H||X||P.device.isMobile)&&z,disableEnter:te,onChange:j,disableHorizontalEdgeScroll:!0,pasteBehavior:"block",trackEditsToUserFlow:"user_flow_edit_page_title",inPageFind:n(792540).Os.block_match},D.id)}),le=T.formatMessage({id:"PageTitle.syncedBlock.original",defaultMessage:"Link to original url"});return(0,p.jsx)(d().A,{name:"PageTitle",children:(0,p.jsxs)("div",{style:W?{flex:1}:void 0,ref:ne,children:[(0,p.jsxs)(n(199896).A,{canSelect:!1,canDrag:!1,canEditText:O,onEditText:C,store:oe,style:$.selectable,analyticsName:"page_content",shouldShowDropZone:!0,children:[re?(0,p.jsx)(c().s,{allowSelectionWithin:!0,style:{width:"100%",maxWidth:"100%"},children:se}):se,(0,p.jsxs)(c().s,{allowSelectionWithin:!0,children:[(0,p.jsx)(n(964447).vE,{origin:ne??void 0}),G&&(0,p.jsx)(n(859428).A,{placement:n(962730).W.Bottom,renderTooltip:()=>le,render:e=>(0,p.jsx)(n(296798).A,{href:J,ignoreLocalHoverState:!0,hovered:!1,children:(0,p.jsx)(n(285790).A,{ariaLabel:le,...e,icon:()=>(0,n(657222).w)($.link),style:{marginLeft:4},onClick:()=>{J&&n(755636).f({url:J,environment:P})}})})}),q&&!P.device.isMobile&&(0,p.jsx)(n(66858).A,{store:q,canEdit:Y,buttonStyle:{fontWeight:"normal",margin:0}})]})]}),(0,p.jsx)(c().s,{allowSelectionWithin:!0,style:{marginLeft:4},children:(0,p.jsx)(f,{store:t,collectionContextStore:y})})]})})}));function f(e){const{store:t,collectionContextStore:i}=e,o=(0,s().K8)((()=>t.isCollectionView()),[t]),r=(0,s().K8)((()=>t.getCollectionStoreIfSingleSource()),[t]);return o&&i&&r?(0,p.jsx)(n(948049).A,{collectionStore:r,collectionContextStore:i}):null}},603616:(e,t,n)=>{n.d(t,{A:()=>c});var i=n(296540),o=()=>n(847249),r=()=>n(700500),s=()=>n(614505),l=()=>n(780054),a=()=>n(186445),d=n(474848);const c=i.memo((function(e){let{store:t,isEditable:c,hasCover:g,isInSidePeek:u,openMenuOnMount:p,openMenuOnMountCallback:S,isInPageLayoutModuleEditor:f,isInlinePostTitle:x}=e;const m=(0,n(484714).v3)(),h=(0,n(959013).tz)(),v=(0,n(401497).DP)(),y=(0,o().K8)((()=>t.isPersonProfile()),[t]),b=(0,o().K8)((()=>y?t.getPersonProfileUserStore():void 0),[y,t]),j=(0,o().K8)((()=>t.getIcon()),[t]),C=(0,o().K8)((()=>t.getIconStore()),[t]),I=(0,o().K8)((()=>t.getType()),[t]),w=(0,o().K8)((()=>{if(t.isCollectionView()){const e=t.getCollectionStoreIfSingleSource();return!!e&&e.isSyncedCollection()}return t.isType(r().xd.externalObjectInstancePage)}),[t]),M=(0,o().K8)((()=>t.isType(r().xd.form)),[t]),A=(0,o().K8)((()=>t.isCollectionView()),[t])||u,K=x,E=(0,o().K8)((()=>t.isEmptyPage()),[t]),k=(0,o().K8)((()=>n(77246).Uv.getMode(t)),[t]),T=(0,i.useCallback)((async e=>{const i=t.getIconStore();if(i){const t=(0,n(522419).pc)({source:e,secureFileConfigRootpath:l().A.secureFileConfig.rootPath,secureFileConfigHostname:l().A.secureFileConfig.hostname}),o=t?t.link:e,{serverCommitResult:r}=n(751156).createAndCommit({userAction:"PageIcon.handleChange",environment:m,canUndo:!0,perform:e=>{n(246826).KY({store:i,value:o,transaction:e})}});await r}}),[m,t]),P={position:"relative",zIndex:1,marginLeft:3,marginBottom:m.device.isMobile?8:0,marginTop:4,pointerEvents:"auto"};let _,B,D;if(K?P.marginRight=4:A?P.marginRight=6:P.marginTop=g&&!f?-80:m.device.isMobile||f?0:(0,a().Ws)(m)-(M?32:0),_=K?{marginTop:4,marginRight:2}:A?{marginTop:4,marginRight:8}:{marginTop:g&&!f?-42:m.device.isMobile||f?0:(0,a().Ws)(m)-(M?32:0)},B=K?26:A?36:w?74:140,y)return P.borderRadius="50%",P.background=v.contentBackground,P.overflow="hidden",P.width=B,P.border="2px solid white",(0,d.jsx)("div",{style:P,children:(0,d.jsx)(n(453697).A,{userStore:b,size:B})});if(D=K?26:A?36:78,!j&&!x)return null;if(c&&"suggest"!==k){const e=null==C?void 0:C.table;return(0,d.jsx)(s().B,{disabled:!1,bucket:"secure",icon:j,store:t,isEmptyPage:E,onChange:T,size:B,emojiSize:D,style:P,emojiStyle:_,largeIcon:!0,openMenuOnMount:p,openMenuOnMountCallback:S,isInlinePostTitle:x,iconLoggingData:{recordTable:e,source:"page_header",block_type:I,collection_id:"collection"===e?null==C?void 0:C.id:void 0},label:h.formatMessage({id:"layout.pageIcon.label",defaultMessage:"Change page icon"}),testId:"pageIcon"})}return(0,d.jsx)(s().B,{disabled:!0,icon:j,isEmptyPage:E,size:B,emojiSize:D,style:P,emojiStyle:_,largeIcon:!0,label:h.formatMessage({id:"layout.pageIcon.disabledLabel",defaultMessage:"Page icon"}),testId:"pageIcon"})}))},774524:(e,t,n)=>{n.d(t,{A:()=>c});n(296540);var i=()=>n(662303),o=()=>n(484714),r=()=>n(847249),s=()=>n(401497),l=()=>n(284371),a=()=>n(478726),d=n(474848);function c(e){const{store:t,context:n,onFocus:c,onBlur:g,children:u}=e,p=(0,o().v3)(),S=(0,r().K8)((()=>{const{device:e}=p,{isMobile:i}=e,o=(0,a().XD)(n,p);let r,s,l;return i?t.getCover()?(t.getIcon(),l="block",r=o,s=4):(l="flex",r=o,s=(0,a().$n)(p)):t.isCollectionView()||(0,a().mb)(t)?(l="flex",t.getCover()?(r=16,s=4):(r=4,s=4)):(l="flex",t.getIcon()?(r=8,s=4):t.getCover()?(r=16,s=4):(r=o,s=(0,a().$n)(p))),{display:l,paddingTop:r,paddingBottom:s}}),[n,p,t]),f=(0,s().IS)((e=>({container:{...S,justifyContent:"flex-start",flexWrap:"wrap",marginLeft:-1,color:e.text.tertiary,fontFamily:l().vc(i().locale).sans,pointerEvents:"auto"}})),[S]);return(0,d.jsx)("div",{onFocus:c,onBlur:g,style:f.container,className:"notion-page-controls",children:u})}},948049:(e,t,n)=>{n.d(t,{A:()=>b});n(296540);var i=()=>n(484714),o=()=>n(847249),r=()=>n(401497),s=()=>n(651124),l=()=>n(796073),a=()=>n(693954),d=()=>n(959013),c=()=>n(100622),g=()=>n(686526),u=()=>n(664133),p=()=>n(989423),S=()=>n(493208),f=()=>n(504836),x=()=>n(252833),m=()=>n(907514),h=()=>n(666803),v=()=>n(296798),y=n(474848);const b=function(e){let{collectionStore:t,collectionContextStore:n}=e;return(0,o().K8)((()=>t.isSyncedCollection()),[t])?(0,y.jsx)(w,{collectionStore:t,collectionContextStore:n}):null};function j(e){return{color:e.text.secondary,fontSize:12,lineHeight:1.2}}function C(e){let{collectionStore:t,collectionContextStore:n}=e;const s=(0,r().DP)(),u=(0,i().v3)(),p=(0,o().K8)((()=>t.getFormatStore().getKeyStore("sync_state").getKeyStore("syncing").getValue()),[t]),S=(0,o().K8)((()=>t.getFormatStore().getKeyStore("sync_state").getKeyStore("last_synced_at").getValue()),[t]),f=(0,o().K8)((()=>null==n?void 0:n.numberChildrenUnfurledStore.state),[n]),x=(0,o().K8)((()=>null==n?void 0:n.numberChildrenReceivedStore.state),[n]),h=f&&x&&f/x<1&&!u.device.isMobile,b=p&&u.device.isMobile;let C;return S&&(C=(0,y.jsx)(d().sA,{defaultMessage:"Synced {lastSyncedAt}",id:"synced.lastSyncedAt.label",values:{lastSyncedAt:(0,m().nl)(S,{useLowercase:!0})}})),"row_limit_exceeded"===p?(0,y.jsx)(v().A,{style:{display:"inline-flex",...j(s)},onClick:()=>function(e){e&&(g().Ow({collectionContextStore:e,collectionSettingsStore:e.settingsStore}),g().a2({collectionSettingsStore:e.settingsStore,item:{type:"source"}}))}(n),children:(0,y.jsxs)("span",{style:{marginLeft:5,marginRight:5,display:"inline-flex",...j(s)},children:[(0,a().Q)({fill:(0,c().k5)("orange",s).fill,marginLeft:4,marginRight:4,width:12,alignSelf:"center"}),(0,y.jsx)(d().sA,{defaultMessage:"Partial Sync",id:"synced.partial_sync.label"})]})}):h||b?(0,y.jsxs)("span",{style:{marginLeft:5,marginRight:5,display:"inline-flex",...j(s)},children:[(0,y.jsx)(d().sA,{defaultMessage:"Syncing",id:"synced.syncing.label"}),(0,l().$)({marginLeft:4,marginRight:4,width:12,alignSelf:"center"},"sync-spinner")]}):(0,y.jsx)("span",{style:{marginLeft:5,marginRight:5,display:"inline-flex",...j(s)},children:C})}function I(){const e=(0,i().v3)(),t=(0,r().IS)((e=>({span:{color:e.text.secondary},linkBox:{fontSize:"14px",lineHeight:1.2,color:e.blueColor,marginLeft:"5px",marginRight:"5px"}})),[]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{style:t.span,children:"â€¢"}),(0,y.jsx)(v().A,{inline:!0,onClick:async()=>{await u().jh({environment:e,from:"collection_header"});const t=h().Ay.createNewFlowId();(0,p().u4)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",from:"database_sync",flowId:t}}})},style:t.linkBox,hoveredStyle:{background:"none",textDecoration:"underline"},children:(0,y.jsx)(d().sA,{defaultMessage:"Improve your Jira sync",id:"synced.improve_jira_sync.label"})})]})}function w(e){let{collectionStore:t,collectionContextStore:n}=e;const i=(0,r().DP)(),l=(0,o().K8)((()=>t.getFormatStore().getKeyStore("original_url").getValue()),[t]),a=(0,o().K8)((()=>t.getSpaceId()),[t]),d=(0,o().K8)((()=>Boolean(t.getFormatStore().getKeyStore("sync_state").getValue())),[t]),c=(0,o().K8)((()=>l&&(0,S().e)(l,a)),[a,l]),g=(0,o().K8)((()=>(0,x().fH)(l,a)),[a,l]),u=(0,o().K8)((()=>{if(!(0,f().pB)())return!1;const e=t.getFormat().uri;return!!e&&(t.getFormat().external_collection_type!==s().uO.Jira&&(0,x().Ip)(e))}),[t]);return(0,y.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[c&&(0,y.jsx)(v().A,{href:c,style:{display:"inline-flex"},hoveredStyle:{background:"none",textDecoration:"underline"},innerStyle:{flexShrink:1,width:"none",padding:"2px 0px",marginRight:5,borderRadius:4,display:"flex",alignItems:"center",alignSelf:"center",...j(i)},external:!0,children:g}),d?(0,y.jsx)("span",{style:{color:i.text.secondary},children:"â€¢"}):null,d?(0,y.jsx)(C,{collectionStore:t,collectionContextStore:n}):null,u&&(0,y.jsx)(I,{})]})}}}]);