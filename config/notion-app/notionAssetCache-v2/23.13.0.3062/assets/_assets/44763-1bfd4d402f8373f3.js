"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[44763],{47582:(e,t,s)=>{s.d(t,{V:()=>A});s(898992),s(354520);var n=s(296540),r=()=>s(847249),i=()=>s(534177),a=()=>s(722872),o=()=>s(962730),l=()=>s(377586),d=()=>s(463830),c=()=>s(406699),m=()=>s(928600),u=()=>s(939740),p=()=>s(221844),h=()=>s(484714),g=()=>s(179034),S=()=>s(496603),b=()=>s(751156),f=()=>s(6731),v=()=>s(630116),y=()=>s(89924),C=()=>s(604484),x=()=>s(944850),T=s(474848);function P(e){let{blockStore:t,filterDeletedPermissions:s}=e;const{mockBlockStore:i}=function(e){let{blockStore:t,filterDeletedPermissions:s}=e;const i=(0,h().v3)(),a=(0,r().K8)((()=>(0,S().mg)(t.inMemoryRecordCache.data)),[t]),o=(0,n.useMemo)((()=>new(p().A)({name:"adminContentSearch.deletedFromTrashPermissionsView",data:a,isTemporaryData:!0})),[a]),l=(0,f().D)({unpersistedInMemoryRecordCache:o}),{mockBlockStore:d}=(0,r().K8)((()=>{const e=s?s(t):[],n=new(v().Bv)(i,{table:g().ev,id:t.id},{inMemoryRecordCache:o});return l.createAndCommit({userAction:"adminContentSearch.restoreDeletedFromTrashPermissionsOptimistically",perform:t=>{b().applyOperation({store:n,operation:{pointer:n,command:"set",path:["permissions"],args:e},transaction:t})}}),{inMemoryRecordCache:o,mockBlockStore:n}}),[i,t,o,l,s]);return{mockBlockStore:d}}({blockStore:t,filterDeletedPermissions:s}),o=(0,x().d)(i),l=(0,C().x)({permissionItems:o});return(0,T.jsx)(m().A,{menuType:a().gu.Popup,width:248,children:(0,T.jsx)(u().Ay,{type:u().Oh.Vertical,initialFocus:void 0,sections:[{key:"deletedFromTrashPermissions",render:e=>(0,T.jsx)(y().A,{...e}),items:l}]})})}var M=()=>s(824176),k=()=>s(451830);function A(e){let{blockStore:t,getValidDeletedPermissions:s,placementToOrigin:p,renderPopupOrigin:h,environment:g,includeNonRestoreActions:S,onRestoreOrDeletePage:b,from:f}=e;const v=(0,r().uB)(void 0,d().A),y=(0,k().o)(),[C,x]=(0,n.useState)(!1),A=(0,M().QV)({blockStore:t,getValidDeletedPermissions:s}),I=[(0,M().j9)({environment:g,pageStatus:"deleted_from_trash",popupStore:v,blockStore:t,from:f,handleOpenDeletedPermissionsMenu:()=>x(!0),includeNonRestoreActions:S,onRestoreOrDeletePage:b,...A}),(0,M().CT)({environment:g,from:f,pageStatus:"deleted_from_trash",popupStore:v,blockStore:t,includeNonRestoreActions:S,onRestoreOrDeletePage:b,...A})].filter(i().O9);return(0,T.jsx)(c().Ay,{popupType:l().n.Popup,alignmentToOrigin:o().C.Start,placementToOrigin:p,style:y.popupMenu,render:()=>C?(0,T.jsx)(P,{blockStore:t,filterDeletedPermissions:s}):(0,T.jsx)(m().A,{menuType:a().gu.Popup,width:248,children:(0,T.jsx)(u().Ay,{type:u().Oh.Vertical,initialFocus:void 0,sections:I})}),onClose:()=>{x(!1)},buttonPopupStore:v,renderOrigin:h})}},126553:(e,t,s)=>{s.d(t,{x:()=>r});s(296540);var n=s(474848);const r=(0,s(340498).wt)("settingsSecurity",{viewBox:"0 0 11 20",svg:(0,n.jsx)("path",{d:"M4.92129 19.3231C5.26719 19.627 5.74092 19.6649 6.07178 19.3383L8.38779 16.9913C8.71865 16.6571 8.70361 16.1558 8.38027 15.8292L7.2749 14.7127L8.92168 13.0569C9.2375 12.7379 9.22998 12.229 8.90664 11.8948L7.41026 10.3757C9.44805 9.35026 10.5985 7.64127 10.5985 5.62847C10.5985 2.78016 8.32012 0.486328 5.49277 0.486328C2.66543 0.486328 0.394531 2.77257 0.394531 5.62847C0.394531 7.67166 1.54502 9.50217 3.37979 10.3301V17.4622C3.37979 17.7357 3.4625 18.0471 3.69561 18.2446L4.92129 19.3231ZM5.49277 17.9863L4.68066 17.166V9.34266C2.95869 8.9629 1.73301 7.4438 1.73301 5.62847C1.73301 3.53972 3.40986 1.84592 5.49277 1.84592C7.57569 1.84592 9.24502 3.53212 9.24502 5.62847C9.24502 7.42101 8.01181 8.96289 6.13194 9.38824V11.0289L7.57569 12.4872L6.03418 14.0214V15.3887L7.04931 16.3989L5.49277 17.9863ZM5.49277 5.67405C6.23721 5.67405 6.83877 5.06641 6.83877 4.32205C6.83877 3.5777 6.23721 2.97005 5.49277 2.97005C4.74834 2.97005 4.1543 3.5701 4.1543 4.32205C4.1543 5.06641 4.75586 5.67405 5.49277 5.67405Z"})})},245981:(e,t,s)=>{s.d(t,{L:()=>r});var n=()=>s(989423);function r(e,t){(0,n().u4)({environment:e,event:{eventName:"cdrr_page_delete_permanently",eventProperties:{page_id:t.pageId,from:t.from}}})}},451830:(e,t,s)=>{s.d(t,{o:()=>o});var n=()=>s(847249),r=()=>s(401497),i=()=>s(663590),a=()=>s(623275);function o(){const e=(0,n().K8)((()=>(0,i().FI)()),[]);return(0,r().IS)((t=>({changePermissionsIcon:{height:18,width:18,fill:"currentColor"},icon:{marginRight:3,height:15,width:15,fill:"currentColor"},destructiveMenuItemHover:{background:t.tint.uiRedHover},destructiveMenuItemPressed:{background:t.tint.uiRedPressed},openLinkIcon:{marginRight:3,height:15,width:15,fill:"currentColor",transform:"rotate(-45deg)"},popupMenu:{width:248},popupShareModal:{width:a().$D,...e&&{borderRadius:a().Sg}}})),[e])}},454354:(e,t,s)=>{s.d(t,{A:()=>a});var n=()=>s(351360),r=()=>s(630116);class i extends(()=>s(757695))().default{getInitialState(){return{changePermissionsEnabled:!1,privatePageStore:void 0,loading:!1,error:void 0}}shouldSaveTransactionWithSudoMode(e){const t=e===this.state.privatePageStore,s=this.doesUserAlreadyHaveEditorAccess(e.pointer);return t&&this.state.changePermissionsEnabled&&!s}shouldUserHaveAccessToPrivatePageBlock(){var e,t;const s=null===(e=n().default.state.currentSpaceStore)||void 0===e?void 0:e.canAdmin(),r="enterprise"===(null===(t=n().default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier());return this.state.privatePageStore&&s&&r}doesUserAlreadyHaveEditorAccess(e){const t=n().default.state.currentSpaceStore;if(!t)return!1;return(e.table===s(179034).ev?r().Bv.createChildStore(t,e):r().md.createChildStore(t,e)).canAdmin()}}const a=i},482707:(e,t,s)=>{s.d(t,{k:()=>i});var n=()=>s(645873);const r=new(n().O2)("shareMenuContainer",(async()=>await Promise.all([s.e(75134),s.e(43380),s.e(9304),s.e(96346),s.e(55373),s.e(36192),s.e(44711),s.e(62475),s.e(3151),s.e(16471),s.e(53321),s.e(58550),s.e(98629),s.e(90825),s.e(37353),s.e(29151),s.e(31895),s.e(83647),s.e(22900),s.e(49889),s.e(97727),s.e(85128),s.e(83700),s.e(95555),s.e(58823),s.e(85864),s.e(92845),s.e(71718),s.e(83324),s.e(74562),s.e(38744),s.e(63077),s.e(28271),s.e(17254),s.e(41870),s.e(90966),s.e(42120),s.e(7114),s.e(67435),s.e(92012),s.e(22462),s.e(8184),s.e(4422),s.e(28721),s.e(28866),s.e(21194),s.e(6463),s.e(71993),s.e(1213),s.e(17989),s.e(90625),s.e(59794),s.e(78846),s.e(26483),s.e(43741),s.e(81768),s.e(94387),s.e(82850),s.e(52393),s.e(77692),s.e(75601),s.e(11341),s.e(7060),s.e(82136),s.e(12739),s.e(26090),s.e(73594),s.e(93282),s.e(12341),s.e(50984),s.e(66984),s.e(40828),s.e(26199),s.e(18057),s.e(90978),s.e(56264),s.e(5023),s.e(55927),s.e(61151),s.e(72226),s.e(48199),s.e(67780),s.e(96933),s.e(87598),s.e(23063),s.e(3965),s.e(84341),s.e(80533),s.e(45620),s.e(58221),s.e(44763),s.e(8081),s.e(67183),s.e(64598),s.e(82720),s.e(4253),s.e(86787),s.e(77465),s.e(24593),s.e(80896),s.e(1440),s.e(67378),s.e(58504),s.e(97308),s.e(63996),s.e(20636),s.e(66268),s.e(55717),s.e(7005),s.e(40186),s.e(22585),s.e(73206),s.e(43020),s.e(33235),s.e(91957),s.e(84176),s.e(16357),s.e(75681)]).then(s.bind(s,698085)))),i=(0,n()._h)(r,(e=>e.ShareMenuContainer))},604484:(e,t,s)=>{s.d(t,{o:()=>G,x:()=>D});s(944114),s(581454);var n=s(296540),r=()=>s(738418),i=()=>s(959013),a=()=>s(859428),o=()=>s(484714),l=()=>s(847249),d=()=>s(401497),c=()=>s(824862),m=()=>s(630116),u=()=>s(710149),p=()=>s(678553),h=()=>s(256863),g=s(474848);function S(e){let{botId:t}=e;const s=(0,i().tz)(),n=(0,o().v3)(),r=(0,l().K8)((()=>m().sk.createUniqueRootStore(n,{table:c().GP,id:t})),[t,n]),a=(0,l().K8)((()=>r.getDisplayName(s)),[r,s]),u=(0,l().K8)((()=>r.getParentStore()),[r]),S=(0,l().K8)((()=>{if(u){if(u instanceof m().LU)return u.getDisplayName(s);if(u instanceof m().SL)return u.getName()}}),[u,s]),f=(0,d().IS)((()=>({desktopIconStyle:{alignSelf:"center",width:24,fontSize:18}})),[]);return a?(0,g.jsx)(p().Ay,{desktopIconStyle:f.desktopIconStyle,icon:(0,g.jsx)(h().A,{botStore:r,size:24}),title:a,caption:(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.botMenuItem.createdBy",defaultMessage:"Created by {creatorName}",values:{creatorName:S}})}):(0,g.jsx)(b,{})}function b(){const e=(0,d().IS)((e=>({container:{userSelect:"none",minHeight:45,fontSize:14,padding:"4px 8px",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},textContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",gap:6},icon:{flexGrow:0,flexShrink:0,width:24,height:24,borderRadius:"0.25em",marginRight:4,marginTop:1},title:{flexGrow:0,flexShrink:0,width:80,height:14,borderRadius:"0.25em",marginLeft:4},byline:{flexGrow:0,flexShrink:0,width:150,height:10,borderRadius:"0.25em",marginLeft:4}})),[]);return(0,g.jsxs)("div",{style:e.container,children:[(0,g.jsx)(u().A,{style:e.icon}),(0,g.jsxs)("div",{style:e.textContainer,children:[(0,g.jsx)(u().A,{emphasized:!1,style:e.title}),(0,g.jsx)(u().A,{emphasized:!1,style:e.byline})]})]})}var f=()=>s(234194),v=()=>s(351360),y=()=>s(614505);const C=(0,i().YK)({editor:{id:"adminContentSearchTab.sharedWith.permissions.editor",defaultMessage:"Full access"},readAndWrite:{id:"adminContentSearchTab.sharedWith.permissions.readAndWrite",defaultMessage:"Can edit"},commentOnly:{id:"adminContentSearchTab.sharedWith.permissions.commentOnly",defaultMessage:"Can comment"},reader:{id:"adminContentSearchTab.sharedWith.permissions.reader",defaultMessage:"Can view"},none:{id:"adminContentSearchTab.sharedWith.permissions.none",defaultMessage:"None"}});function x(e,t){switch(t){case"editor":return e.formatMessage(C.editor);case"read_and_write":return e.formatMessage(C.readAndWrite);case"comment_only":return e.formatMessage(C.commentOnly);case"reader":return e.formatMessage(C.reader);case"none":return e.formatMessage(C.none)}}function T(e){let{name:t,icon:s,role:n}=e;const r=(0,i().tz)(),a=(0,l().O$)(v().AppStoreCurrentSpaceStore),o=x(r,n),c=(0,d().IS)((e=>({defaultGroupIcon:{height:20,width:20,color:e.text.tertiary,fill:"currentColor"}})),[]);return(0,g.jsx)(p().Ay,{desktopIconStyle:{alignSelf:"center",width:24,fontSize:18},icon:(0,g.jsx)(y().B,{disabled:!0,icon:s&&a?{pointer:a.pointer,icon:s}:void 0,size:20,isEmptyPage:!1,title:t,defaultIcon:(0,f().M)(c.defaultGroupIcon)}),title:t||(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.untitledPage",defaultMessage:"Untitled{maybeRoleString}",values:{maybeRoleString:o?` · ${o}`:""}}),caption:(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.group",defaultMessage:"Group{maybeRoleString}",values:{maybeRoleString:o?` · ${o}`:""}})})}var P=()=>s(68263),M=()=>s(898808);function k(e){let{permissionItem:t}=e;const s=(0,i().tz)(),n=(0,l().O$)(v().AppStoreCurrentSpaceStore),r=(0,l().K8)((()=>{var e;return null===(e=v().default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),a=null==t?void 0:t.role,o=(0,P().PW)(a)?x(s,a):void 0;return(0,g.jsx)(p().Ay,{desktopIconStyle:{alignSelf:"center",width:24},icon:n?(0,g.jsx)(M().x,{disabled:!0,store:n,size:24}):void 0,title:r,caption:(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.spaceMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:o?` · ${o}`:""}})})}var A=()=>s(425736),I=()=>s(854150);function w(e){let{teamId:t,role:s,onlyOwners:n}=e;const r=(0,o().v3)(),a=(0,i().tz)(),d=(0,l().K8)((()=>new(m().h4)(r,{table:I().yK,id:t})),[r,t]),c=x(a,s),u=(0,l().K8)((()=>d.getName()),[d]),h=u||(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.unknownTeamName",defaultMessage:"Private teamspace"});return(0,g.jsx)(p().Ay,{desktopIconStyle:{alignSelf:"center",width:24},icon:u?(0,g.jsx)(M().x,{disabled:!0,store:d,size:24}):(0,A().s)(),title:h,caption:n?(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamOwners",defaultMessage:"Owners{maybeRoleString}",values:{maybeRoleString:c?` · ${c}`:""}}):(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:c?` · ${c}`:""}})})}var j=()=>s(798880),_=()=>s(695608),R=()=>s(453697);function W(e){let{userId:t,role:s,isGuest:n}=e;const r=(0,i().tz)(),a=(0,o().v3)(),{userStore:d,userName:c}=(0,l().K8)((()=>{const e=new(m().LU)(a,{table:j().oo,id:t}),s=(0,_().c6)(r,e.getModel());return{userStore:e,userName:s}}),[a,t,r]),u=x(r,s);return(0,g.jsx)(p().Ay,{desktopIconStyle:{alignSelf:"center",width:24},icon:(0,g.jsx)(R().A,{userStore:d,size:24}),title:c,caption:n?(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.guest",defaultMessage:"Guest{maybeRoleString}",values:{maybeRoleString:u?` · ${u}`:""}}):(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.member",defaultMessage:"Member{maybeRoleString}",values:{maybeRoleString:u?` · ${u}`:""}})})}const O=(0,i().YK)({sharedWithWorkspaceMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWorkspaceMembers",defaultMessage:"Workspace members"},sharedWithTeamOwners:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamOwners",defaultMessage:"Teamspace owners"},sharedWithTeamMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamMembers",defaultMessage:"Teamspace members"},sharedWithMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithMembers",defaultMessage:"{numMembers, plural, one {# member} other {# members}}"},sharedWithGroups:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGroups",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"},sharedWithGuests:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGuests",defaultMessage:"{numGuests, plural, one {# guest} other {# guests}}"},sharedWithBots:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithBots",defaultMessage:"{numBots, plural, one {# connection} other {# connections}}"},separator:{defaultMessage:", ",id:"adminContentSearchTab.pagesTable.sharedWithCell.separator"}});function B(e){let{blockStore:t}=e;const n=(0,s(944850).d)(t),o=function(e,t){const{mostPermissivePublicItem:s,spacePermission:n,groupPermissions:o,guestUserPermissions:l,memberUserPermissions:d,teamSharePermissions:c,teamOwnerSharePermissions:m,botPermissions:u}=e,p=n&&"none"!==n.permissionItem.role;if(s&&"none"!==s.permissionItem.role)return(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWeb",defaultMessage:"Shared to web"});if(!p&&0===o.length&&0===l.length&&0===d.length&&0===c.length&&0===m.length&&0===u.length)return(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage",defaultMessage:"Nobody"}),(0,g.jsx)(a().A,{render:e=>(0,g.jsx)("div",{...e,children:(0,r().G)({marginLeft:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,g.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage.tooltip",defaultMessage:"No person, group, or teamspace has any access to this page."})})]});const h=[];p?h.push(t.formatMessage(O.sharedWithWorkspaceMembers)):(m.length>0&&0===c.length?h.push(t.formatMessage(O.sharedWithTeamOwners)):c.length>0&&h.push(t.formatMessage(O.sharedWithTeamMembers)),d.length>0&&h.push(t.formatMessage(O.sharedWithMembers,{numMembers:d.length})),o.length>0&&h.push(t.formatMessage(O.sharedWithGroups,{numGroups:o.length})));l.length>0&&h.push(t.formatMessage(O.sharedWithGuests,{numGuests:l.length}));u.length>0&&h.push(t.formatMessage(O.sharedWithBots,{numBots:u.length}));return h.join(t.formatMessage(O.separator))}(n,(0,i().tz)()),l=D({permissionItems:n});return(0,g.jsx)(s(75491).ED,{title:o,items:l,disabled:0===l.length})}function D(e){let{permissionItems:t}=e;return[...t.spacePermission?[{key:"space-permission",render:e=>{var s;return(0,g.jsx)(k,{...e,permissionItem:null===(s=t.spacePermission)||void 0===s?void 0:s.permissionItem})},action:()=>{}}]:[],...t.teamOwnerSharePermissions.map((e=>({key:`${e.team_id}-owners`,render:t=>(0,g.jsx)(w,{...t,onlyOwners:!0,teamId:e.team_id,role:e.role}),action:()=>{}}))),...t.teamSharePermissions.map((e=>({key:`${e.team_id}-members`,render:t=>(0,g.jsx)(w,{...t,teamId:e.team_id,role:e.role}),action:()=>{}}))),...t.groupPermissions.map((e=>({key:e.id,render:()=>(0,g.jsx)(T,{name:e.name,icon:e.icon,role:e.role}),action:()=>{}}))),...t.memberUserPermissions.map((e=>({key:e.user_id,render:t=>(0,g.jsx)(W,{...t,userId:e.user_id,role:e.role}),action:()=>{}}))),...t.guestUserPermissions.map((e=>({key:e.user_id,render:t=>(0,g.jsx)(W,{...t,isGuest:!0,userId:e.user_id,role:e.role}),action:()=>{}}))),...t.botPermissions.map((e=>({key:e.bot_id,render:t=>(0,g.jsx)(S,{...t,botId:e.bot_id}),action:()=>{}})))]}const G=n.memo(B)},824176:(e,t,s)=>{s.d(t,{CT:()=>w,QV:()=>A,j9:()=>I});s(944114),s(581454),s(296540);var n=()=>s(847249),r=()=>s(401497),i=()=>s(584262),a=()=>s(857639),o=()=>s(452951),l=()=>s(657222),d=()=>s(126553),c=()=>s(735384),m=()=>s(112452),u=()=>s(959013),p=()=>s(534177),h=()=>s(245981),g=()=>s(884107),S=()=>s(755636),b=()=>s(345913),f=()=>s(492414),v=()=>s(108944),y=()=>s(962730),C=()=>s(351360),x=()=>s(760217),T=()=>s(89924),P=()=>s(859428),M=()=>s(451830),k=s(474848);function A(e){const{getValidDeletedPermissions:t,blockStore:s}=e;return(0,n().K8)((()=>{var e;const n=v().$l(v().g7(s));if(Boolean((null==n?void 0:n.id)!==s.id))return{ancestorBlockStore:n,canRestoreAncestor:!0,canRestoreOriginalAccess:!1};const r=t?t(s):[],i=Boolean(s.getParentSpaceStore()&&0===r.length);return{ancestorBlockStore:n,canRestoreAncestor:!1,canRestoreOriginalAccess:!Boolean(null===(e=s.getParentBlockStore())||void 0===e?void 0:e.pathHasDeletedPermission())&&!i}}),[s,t])}function I(e){const t=(0,M().o)(),{environment:s,pageStatus:n,popupStore:r,blockStore:a}=e;async function l(){const e=(0,f().Ay)({store:a,pageVisitSource:i().y8.CopyLink}),t=await g().R.clipboardActions.load();await t.copyString({environment:s,stringValue:e,copiedMessage:t.clipboardMessages.copiedLinkToClipboard}),r.setState({open:!1})}const c=[];switch(n){case"alive":case"in_trash":{const{handleOpenPermissionsMenu:s}=e;c.push(function(e){let{iconStyle:t,action:s}=e;return{key:"change-permissions",render:e=>(0,k.jsx)(x().A,{...e,icon:(0,d().x)(t),title:(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.changePermissions",defaultMessage:"Change permissions"})}),action:s}}({iconStyle:t.changePermissionsIcon,action:s}),R({iconStyle:t.icon,action:l}));break}case"deleted_from_trash":{const{ancestorBlockStore:n,canRestoreAncestor:a,canRestoreOriginalAccess:m,handleOpenDeletedPermissionsMenu:p,includeNonRestoreActions:h}=e;if(n&&a){const e=()=>{const e=(0,f().Ay)({store:n,pageVisitSource:i().y8.DeletedFromTrashPageActions});S().f({environment:s,url:e}),r.setState({open:!1})};c.push(function(e){let{iconStyle:t,action:s}=e;return{key:"go-to-parent-page",render:e=>(0,k.jsx)(x().A,{...e,icon:(0,o().Z)(t),title:(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.navigateToParent",defaultMessage:"Open parent in new tab"})}),action:s}}({iconStyle:t.openLinkIcon,action:e}))}m&&c.push(function(e){let{iconStyle:t,action:s}=e;return{key:"view-original-permissions",render:e=>(0,k.jsx)(x().A,{...e,icon:(0,d().x)(t),title:(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.viewOriginalPermissions",defaultMessage:"View original permissions"})}),action:s}}({iconStyle:t.changePermissionsIcon,action:p})),h&&c.push(R({iconStyle:t.icon,action:l}));break}default:(0,p().HB)(n)}if(0!==c.length)return{key:"actions",render:e=>(0,k.jsx)(T().A,{...e}),items:c}}function w(e){const{from:t,pageStatus:s,environment:r,blockStore:i,popupStore:o,onRestoreOrDeletePage:l}=e,d=(0,M().o)(),g=[],S=(0,n().K8)((()=>{var e;return(null===(e=C().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.id)===i.id}),[i]);switch(s){case"alive":return;case"in_trash":{async function f(){await b().iN({environment:r,block:i,spaceId:i.getSpaceId(),from:"adminContentSearch.restorePage",restoreWithoutNavigation:!0}),null==l||l(i.id),o.setState({open:!1})}function v(){const e=l?e=>{e.length>1&&a().log({level:"warning",from:"usePageCellActions",type:"multipleBlocksDeletedFromTrash",data:{blockIds:e.map((e=>e.id))}}),e.length>0&&l(e[0].id)}:void 0;b().Ne({environment:r,blocks:[i],from:"adminContentSearch",handleSuccess:e}),o.setState({open:!1})}g.push(_({iconStyle:d.icon,action:f,disable:!1}),function(e){let{iconStyle:t,action:s}=e;return{key:"delete-from-trash",render:e=>(0,k.jsx)(j,{...e,icon:(0,c().I)(t),title:(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.deleteFromTrash",defaultMessage:"Delete from Trash"})}),action:s}}({iconStyle:d.icon,action:v}));break}case"deleted_from_trash":{const{canRestoreAncestor:y,canRestoreOriginalAccess:P,includeNonRestoreActions:A}=e,I=y||!P,w=y?(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.restore.tooltip.restoreParent",defaultMessage:"Restore the parent page to restore the original permissions."}):P?void 0:(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.restore.tooltip.pageCannotBeRestored",defaultMessage:"This page cannot have its original permissions restored."});g.push(_({iconStyle:d.icon,action:async()=>{await b().tP({environment:r,blockStore:i,spaceId:i.getSpaceId(),from:`${t}.restoreRetainedPage`}),null==l||l(i.id),o.setState({open:!1})},disable:I,tooltip:w}),function(e){let{iconStyle:t,action:s}=e;return{key:"restore-to-private",render:e=>(0,k.jsx)(x().A,{...e,icon:(0,m()._)(t),shouldWrapCaption:!0,title:(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.restoreToPrivate",defaultMessage:"Restore to Private pages"})}),action:s}}({iconStyle:d.icon,action:async()=>{await b().Ys({environment:r,blockStore:i,spaceId:i.getSpaceId(),navigateToPage:S,from:`${t}.restoreRetainedPage`}),null==l||l(i.id),o.setState({open:!1})}})),A&&g.push(function(e){let{iconStyle:t,action:s}=e;return{key:"purge",render:e=>(0,k.jsx)(j,{...e,icon:(0,c().I)(t),title:(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.purge",defaultMessage:"Permanently delete"})}),action:s}}({iconStyle:d.icon,action:()=>{b().tz({environment:r,blockStore:i,handleSuccess:e=>{null==l||l(e),h().L(r,{pageId:i.id,from:"content_search"})}}),o.setState({open:!1})}}));break}default:(0,p().HB)(s)}return{key:"inactive-page-actions",render:e=>(0,k.jsx)(T().A,{...e,topBorder:!0}),items:g}}function j(e){const t=(0,r().IS)((e=>({destructiveMenuItemHover:{background:e.tint.uiRedHover},destructiveMenuItemPressed:{background:e.tint.uiRedPressed}})),[]);return(0,k.jsx)(x().A,{...e,isRedOnHover:!0,hoveredStyle:t.destructiveMenuItemHover,pressedStyle:t.destructiveMenuItemPressed})}function _(e){let{iconStyle:t,action:s,disable:n,tooltip:r}=e;const i=e=>(0,k.jsx)(x().A,{...e,disabled:n,disallowTabbing:n,disabledFeedback:!0,icon:(0,m()._)(t),shouldWrapCaption:!0,title:(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.restore",defaultMessage:"Restore to original location"})});return{key:"restore",render:e=>r?(0,k.jsx)(P().A,{textWrap:!0,renderTooltip:()=>r??null,placement:y().W.Right,render:t=>(0,k.jsx)("div",{...t,children:i(e)})}):i(e),action:s}}function R(e){let{iconStyle:t,action:s}=e;return{key:"copy-link",render:e=>(0,k.jsx)(x().A,{...e,icon:(0,l().w)(t),title:(0,k.jsx)(u().sA,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page"})}),action:s}}},904671:(e,t,s)=>{s.d(t,{$:()=>m,B:()=>c});var n=()=>s(221844),r=()=>s(223116),i=()=>s(179034),a=()=>s(508496),o=()=>s(630116),l=()=>s(577437),d=()=>s(449506);async function c(e){const{environment:t,sudoModeStore:s,pageBlockId:n,currentSpaceStore:i}=e,o=s.state.privatePageStore&&s.state.privatePageStore.id===n;if(t.device.isMobile||o||s.state.loading||s.state.error)return;await a().default.waitUntilStatsigReady();const c=(null==i?void 0:i.isReady())&&(null==i?void 0:i.canAdmin()),u=await function(e,t){return(0,l().Se)(e,{name:"sudo_mode",spaceId:t,userId:e.currentUser.id})}(t,null==i?void 0:i.id);if(!(n&&c&&i&&u))return;s.setState({...s.state,privatePageStore:void 0,loading:!0});const p=i.id,h=await d().callApi({eventName:"getPrivatePageInfo",environment:t,data:{id:n}});if("failed"===h.type)return void s.setState({...s.state,loading:!1,error:h.error});const g=h.data,S=m({environment:t,blockId:n,privateRecordCacheName:r().Rb,ancestorData:g,spaceId:p});s.setState({...s.state,privatePageStore:S,loading:!1,error:void 0})}function m(e){const{environment:t,privateRecordCacheName:s,ancestorData:r,spaceId:a,blockId:l}=e,d=new(n().A)({name:s});for(const n of r)switch(n.table){case"block":case"collection":case"team":d.setRecord({pointer:{spaceId:a,table:n.table,id:n.value.id},userId:t.currentUser.id},{role:"editor",value:n.value})}const c=new(o().Bv)(t,{table:i().ev,id:l},{inMemoryRecordCache:d});return c.inMemoryRecordCache.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),c}},944850:(e,t,s)=>{s.d(t,{d:()=>u});s(944114),s(898992),s(354520),s(672577),s(581454),s(908872);var n=()=>s(847249),r=()=>s(68263),i=()=>s(437607),a=()=>s(468006),o=()=>s(108944),l=()=>s(731320),d=()=>s(605402),c=()=>s(134217),m=()=>s(749240);function u(e){return(0,n().K8)((()=>{const t=m().subscriptionDataStoreInstance.state,s=t?(0,c().Be)(t):[],n=(0,l().i0)(e),u=d().A.state.permissionGroupsAndMemberCounts.map((e=>e.group)),p=(0,o().Uo)(e),h=n.find((e=>{let{permissionItem:t}=e;return r().FP(t)})),g=n.find((e=>{let{permissionItem:t}=e;return r().Lg(t)})),S=p?n.find((e=>{let{permissionItem:t}=e;return(0,a().O1)(t,p.id)})):void 0,b=n.map((e=>{let{permissionItem:t}=e;return t})).filter(r().gl),f=n.map((e=>{let{permissionItem:t}=e;return t})).filter(r().nl),v=n.map((e=>{let{permissionItem:t}=e;return t})).filter(r().Ds).reduce(((e,t)=>{const s=t.group_id,n=t.role,r=u.find((e=>e.group_id===s));if(r){const t={group_id:r.group_id,id:(0,i().T1)({spacePermissionGroupId:r.group_id,spaceId:r.space_id}),name:r.name,space_id:r.space_id,icon:r.icon,version:r.getVersion(),role:n};e.push(t)}return e}),[]),[y,C]=n.map((e=>{let{permissionItem:t}=e;return t})).filter(r().B2).reduce(((e,t)=>{const n=s.find((e=>e.userId===t.user_id));return Boolean(n&&!r().Km(n.role)&&!r().p2(n.role))?[e[0].concat(t),e[1]]:[e[0],e[1].concat(t)]}),[[],[]]);return{groupPermissions:v,mostPermissivePublicItem:h,spacePermission:g,teamPermission:S,teamSharePermissions:b,teamOwnerSharePermissions:f,guestUserPermissions:y,memberUserPermissions:C,botPermissions:n.map((e=>{let{permissionItem:t}=e;return t})).filter((e=>(0,r().P3)(e)))}}),[e])}},991221:(e,t,s)=>{s.d(t,{T:()=>m});s(517642),s(658004),s(733853),s(845876),s(432475),s(515024),s(731698),s(898992),s(672577),s(803949);var n=s(296540),r=()=>s(847249),i=(s(354520),()=>s(534177)),a=()=>s(142748);var o=()=>s(68263),l=()=>s(108944),d=()=>s(605402),c=()=>s(134217);function m(e){let{subscriptionData:t}=e;const{userIsMember:s,permissionGroupExists:m}=(0,r().K8)((()=>{if(!t)return{userIsMember:()=>!1,permissionGroupExists:()=>!1};const e=new Set;c().Ye(t).forEach((t=>{e.add(t.userId)}));const s=new Set;d().A.state.permissionGroupsAndMemberCounts.forEach((e=>{s.add(e.group.group_id)}));return{userIsMember:t=>e.has(t),permissionGroupExists:e=>s.has(e)}}),[t]);return(0,n.useCallback)((e=>{var t;const n=null===(t=e.getPermissionItems().find(o().Ny))||void 0===t?void 0:t.previous_permissions;return n?function(e){var t;let{deletedPermissions:s,ancestorPath:n,userIsMember:r,permissionGroupExists:o}=e;const l=null===(t=(0,a().vv)(n))||void 0===t?void 0:t.id;return s.filter((e=>{const t=e.type;switch(t){case"trusted_domain_permission":case"public_permission":case"deleted_permission":case"bot_permission":return!1;case"exclusive_user_permission":case"user_permission":return r(e.user_id);case"explicit_team_guest_permission":case"explicit_team_owner_permission":case"explicit_team_permission":return e.team_id===l;case"group_permission":return o(e.group_id);case"team_owner_permission":case"team_permission":case"restricted_permission":case"collection_property_permission":case"space_permission":case"space_owner_permission":return!0;default:(0,i().HB)(t)}}))}({deletedPermissions:n,ancestorPath:(0,l().E)(e),userIsMember:s,permissionGroupExists:m}):[]}),[s,m])}}}]);