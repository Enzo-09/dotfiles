"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[43396],{70423:(e,t,o)=>{o.d(t,{L:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("bellDisabled",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7 15.2285C6.48047 15.2285 6.02246 15.11 5.62598 14.873C5.23405 14.6406 4.92188 14.333 4.68945 13.9502C4.46159 13.5719 4.33854 13.1618 4.32031 12.7197H1.51074C1.15072 12.7197 0.868164 12.6331 0.663086 12.46C0.462565 12.2822 0.362305 12.0475 0.362305 11.7559C0.362305 11.5143 0.426107 11.2842 0.553711 11.0654C0.681315 10.8421 0.843099 10.6279 1.03906 10.4229C1.23958 10.2178 1.44466 10.015 1.6543 9.81445C1.8138 9.65951 1.93685 9.45671 2.02344 9.20605C2.11003 8.9554 2.17611 8.67969 2.22168 8.37891C2.26725 8.07812 2.30371 7.77051 2.33105 7.45605C2.34017 7.08691 2.36296 6.73828 2.39941 6.41016C2.44043 6.08203 2.49512 5.77669 2.56348 5.49414L3.73926 6.66992C3.71647 6.8431 3.69596 7.02539 3.67773 7.2168C3.66406 7.4082 3.65495 7.60872 3.65039 7.81836C3.63216 8.12826 3.60482 8.41536 3.56836 8.67969C3.5319 8.94401 3.48405 9.18555 3.4248 9.4043C3.36556 9.62305 3.29264 9.81901 3.20605 9.99219C3.12402 10.1654 3.02604 10.3158 2.91211 10.4434C2.80273 10.571 2.68652 10.6963 2.56348 10.8193C2.44499 10.9378 2.33561 11.0472 2.23535 11.1475C2.13965 11.2477 2.06217 11.3275 2.00293 11.3867V11.4688H8.54492L10.0078 12.9385H9.64551C9.59538 13.3532 9.45182 13.7337 9.21484 14.0801C8.98242 14.4264 8.6748 14.7044 8.29199 14.9141C7.91374 15.1237 7.48307 15.2285 7 15.2285ZM7 14.1348C7.38737 14.1348 7.70866 14.0072 7.96387 13.752C8.21908 13.4967 8.35807 13.1527 8.38086 12.7197H5.6123C5.63965 13.1527 5.78092 13.4967 6.03613 13.752C6.29134 14.0072 6.61263 14.1348 7 14.1348ZM4.01953 2.99902C4.15625 2.89421 4.30208 2.7985 4.45703 2.71191C4.61654 2.62533 4.78516 2.55241 4.96289 2.49316C5.09049 2.04199 5.33431 1.66374 5.69434 1.3584C6.05436 1.05306 6.48958 0.900391 7 0.900391C7.50586 0.900391 7.9388 1.05306 8.29883 1.3584C8.65885 1.66374 8.90495 2.04199 9.03711 2.49316C9.9349 2.81673 10.5889 3.41146 10.999 4.27734C11.4137 5.14323 11.6416 6.2666 11.6826 7.64746C11.7008 7.9209 11.7282 8.17383 11.7646 8.40625C11.8011 8.63411 11.849 8.84603 11.9082 9.04199C11.972 9.2334 12.0518 9.41113 12.1475 9.5752C12.2477 9.73926 12.3685 9.89648 12.5098 10.0469C12.7786 10.3021 13.0293 10.5664 13.2617 10.8398C13.4941 11.1133 13.6104 11.4027 13.6104 11.708C13.6104 11.9587 13.5329 12.166 13.3779 12.3301L10.6641 9.55469C10.5911 9.39518 10.5342 9.22884 10.4932 9.05566C10.4567 8.87793 10.4271 8.68424 10.4043 8.47461C10.3815 8.26497 10.361 8.03027 10.3428 7.77051C10.3245 6.80892 10.222 6.04557 10.0352 5.48047C9.84831 4.91081 9.60449 4.4847 9.30371 4.20215C9.00293 3.9196 8.66569 3.72819 8.29199 3.62793C8.20996 3.6097 8.14616 3.5778 8.10059 3.53223C8.05501 3.4821 8.02767 3.41146 8.01855 3.32031C8.00033 2.97396 7.90007 2.69368 7.71777 2.47949C7.54004 2.2653 7.30078 2.1582 7 2.1582C6.69922 2.1582 6.45768 2.2653 6.27539 2.47949C6.0931 2.69368 5.99284 2.97396 5.97461 3.32031C5.97005 3.41146 5.94271 3.4821 5.89258 3.53223C5.84701 3.5778 5.78548 3.6097 5.70801 3.62793C5.57585 3.66439 5.44824 3.70996 5.3252 3.76465C5.20671 3.81934 5.09277 3.88542 4.9834 3.96289L4.01953 2.99902ZM0.615234 2.35645C0.514974 2.25163 0.464844 2.12402 0.464844 1.97363C0.464844 1.81868 0.514974 1.6888 0.615234 1.58398C0.724609 1.47917 0.854492 1.42676 1.00488 1.42676C1.15983 1.42676 1.28971 1.47917 1.39453 1.58398L13.8086 13.9912C13.9134 14.096 13.9658 14.2236 13.9658 14.374C13.9658 14.5244 13.9134 14.6543 13.8086 14.7637C13.7038 14.8685 13.5739 14.9209 13.4189 14.9209C13.2686 14.9209 13.141 14.8685 13.0361 14.7637L0.615234 2.35645Z"})})},75544:(e,t,o)=>{o.d(t,{A:()=>m});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520);var n=o(296540),i=()=>o(908006),r=()=>o(847249),s=()=>o(737658),a=()=>o(336811),l=()=>o(496603),d=()=>o(183558),c=()=>o(921598);function u(e){const{reducerId:t,instanceId:o,reducer:n,collectionContextStore:i,groupsPointer:r}=e,s=i.reducersStore.state,a=s[t];let d,u;if(r&&r.length>0&&(d=(0,c().Hm)(r)),n){if(u={instanceIds:l().sb([...(null==a?void 0:a.instanceIds)||[],o]),reducer:n},d){i.reducerDependencies.has(d)||i.reducerDependencies.set(d,new Set);const e=i.reducerDependencies.get(d);null==e||e.add(t)}}else{if(d){const e=i.reducerDependencies.get(d);e&&(e.delete(t),0===e.size&&i.reducerDependencies.delete(d))}const e=l().FF((null==a?void 0:a.instanceIds)||[],o);u=a&&e.length>0?{instanceIds:e,reducer:a.reducer}:void 0}l().n4(a,u)||i.reducersStore.setState({...s,[t]:u})}function m(e){const{id:t,reducer:o,collectionContextStore:c,groupsPointer:m,debounceWait:p}=e,g=(0,r().K8)((()=>m),[m],{useDeepEqual:!0}),f=(0,r().K8)((()=>o),[o],{useDeepEqual:!0}),h=(0,r().K8)((()=>c.collectionViewStore()),[c]),v=(0,r().K8)((()=>c.normalizedFormatStore.state.collection_pointer),[c.normalizedFormatStore]),y=(0,r().K8)((()=>{var e;return null==h||null===(e=h.getFormatStore())||void 0===e?void 0:e.getKeyStore("collection_view_source").getValue()}),[h]),S=(0,n.useRef)(!1),b=(0,a().O)(),[x,C]=(0,n.useReducer)(((e,t)=>l().n4(e,t)?e:t),void 0),I=(0,n.useCallback)((()=>{const e=c.localResultStore.state,o=c.remoteResultStore.state,n=e&&"reducer"===e.type?e.reducerResults[t]:void 0,i=o&&"reducer"===o.type?o.reducerResults[t]:void 0;return function(e){const{reducerId:t,localReducerResult:o,remoteReducerResult:n,collectionContextStore:i,reducer:r}=e,a=i.reducersStore.state,d=i.remoteResultStore.state,c=i.isClientModeEnabledStore.state;if(c)return o;const u=i.isCreatingNewChartCollectionStore.state,m=i.wasCreatedThisSessionStore.state;if("aggregation"===r.type){if(u&&m){return Boolean(n&&"aggregation"===n.type&&"number"===n.aggregationResult.type&&0!==n.aggregationResult.value)&&i.isCreatingNewChartCollectionStore.setState(!1),o}if(n)return n;const e=Boolean(d&&"reducer"===d.type&&l().I6(d.reducerResults,((e,t)=>{const o=a[t];return!!o&&Boolean("results"===o.reducer.type&&!o.reducer.searchQuery&&"results"===e.type&&e.hasMore&&l().n4(r.filter,o.reducer.filter))})));return e?o:n}if("groups"===r.type){if(u&&m){return Boolean(n&&"groups"===n.type&&("v2"===n.version?n.hasMore:0!==n.total))&&i.isCreatingNewChartCollectionStore.setState(!1),o}if("v2"===r.version){var p;let e,t,a;if(r.aggregation&&(n&&"groups"===n.type&&"v2"===n.version?e=n.aggregationResults:o&&"groups"===o.type&&"v2"===o.version&&(e=o.aggregationResults)),r.blockResults){var g;const e=Boolean(n&&"groups"===n.type&&"v2"===n.version&&n.blockResults),r=null===(g=i.collectionViewStore())||void 0===g?void 0:g.getCollectionSource(),a=(0,s().TR)(r)||(0,s().hJ)(r);if((e||m)&&!a&&o&&"groups"===o.type&&"v2"===o.version&&o.blockResults){const e=o.blockResults,i="groups"===(null==n?void 0:n.type)&&"v2"===n.version&&n.blockResults?n.blockResults:{},r=new Set([...Object.keys(e),...Object.keys(i)]),s={};for(const t of r){const o=e[t],n=i[t];let r=[];o?r=o.blockIds:n&&(r=n.blockIds);let a=!1;n?a=n.hasMore:o&&(a=o.hasMore),s[t]={blockIds:r,hasMore:a}}t=s}}o&&"groups"===o.type&&"v2"===o.version&&o.pinnedResults&&(a=o.pinnedResults),n&&"groups"===n.type&&"v2"===n.version&&n.pinnedResults&&(a={groupResults:n.pinnedResults.groupResults,...a,aggregationResults:n.pinnedResults.aggregationResults});let l,d=!1;n&&"groups"===n.type&&"v2"===n.version?(d=n.hasMore,l=n.hasMoreSubGroups):o&&"groups"===o.type&&"v2"===o.version&&(d=o.hasMore,l=o.hasMoreSubGroups);let c=o??n;return i.forceLocalQueryCollection&&(c=n??o),"groups"===(null===(p=c)||void 0===p?void 0:p.type)&&"v2"===c.version?{...c,pinnedResults:a,hasMore:d,hasMoreSubGroups:l,blockResults:t??c.blockResults,aggregationResults:e}:void 0}return n||o}if("results"===r.type){var f;const e=i.wasCreatedThisSessionStore.state,r=Boolean(d&&"reducer"===d.type&&d.reducerResults[t]),a=null===(f=i.collectionViewStore())||void 0===f?void 0:f.getCollectionSource(),l=(0,s().TR)(a)||(0,s().hJ)(a);if((r||e)&&!l&&o&&"results"===o.type){return{...o,hasMore:n&&"results"===n.type?n.hasMore:o.hasMore}}return n}}({reducerId:t,collectionContextStore:c,reducer:f,localReducerResult:n,remoteReducerResult:i})}),[c,f,t]),w=(0,n.useCallback)((()=>{S.current=!1,b.current||C(I())}),[I,b]),M=(0,n.useCallback)((()=>{S.current||(S.current=!0,i().default.afterNextFlush(w))}),[w]),[k]=(0,n.useState)((()=>(0,d().Ay)()));return(0,n.useEffect)((()=>{const e=p?(0,l().sg)(M,p,{leading:!0}):M;return c.remoteResultStore.addListener(M),c.localResultStore.addListener(e),()=>{c.remoteResultStore.removeListener(M),c.localResultStore.removeListener(e)}}),[c,M,p]),(0,n.useEffect)((()=>(u({reducerId:t,instanceId:k,reducer:f,collectionContextStore:c,groupsPointer:g}),()=>{u({reducerId:t,instanceId:k,reducer:void 0,collectionContextStore:c,groupsPointer:g})})),[c,h,v,y,g,f,t,k]),(0,n.useEffect)((()=>{M()}),[]),(0,n.useEffect)((()=>(c.timingTracker.mountCollectionReducerRequest(t,f.type),()=>{c.timingTracker.unmountCollectionReducerRequest(t)})),[c,t,f]),x}},87854:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(757695))().default{getInitialState(){return{stores:{}}}getStore(e){return this.state.stores[e]||(this.state.stores[e]=new(o(178624).R)({key:`recentEmojis:${e}`,namespace:o(419494).Bq,important:!0,trackingType:"necessary"})),this.state.stores[e]}}const i=new n},104077:(e,t,o)=>{o.d(t,{r:()=>i});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M10 2.355a2.35 2.35 0 0 0-2.253 1.686 5.06 5.06 0 0 0-2.803 4.527v1.189c0 .919-.334 1.806-.939 2.498l-.818.935c-.881 1.007-.166 2.583 1.173 2.583h3.02a2.65 2.65 0 0 0 5.24 0h3.02c1.339 0 2.054-1.576 1.173-2.583l-.818-.935a3.8 3.8 0 0 1-.939-2.498v-1.19a5.06 5.06 0 0 0-2.803-4.526A2.35 2.35 0 0 0 10 2.355m1.5 13.418a1.55 1.55 0 0 1-2.998 0zM8.909 4.564A1.104 1.104 0 0 1 10 3.605c.556 0 1.017.415 1.091.96l.049.353.329.138a3.81 3.81 0 0 1 2.337 3.512v1.189c0 1.221.444 2.401 1.248 3.32l.818.936a.307.307 0 0 1-.232.51H4.36a.308.308 0 0 1-.232-.51l.818-.935a5.04 5.04 0 0 0 1.248-3.321v-1.19c0-1.58.963-2.936 2.337-3.511l.33-.138z"})},i=(0,o(340498).wt)("bell",n)},114641:(e,t,o)=>{o.d(t,{H:()=>i});var n=()=>o(989423);function i(e){const{collectionContextStore:t,environment:o,incrementLimitArgs:i}=e;t.groupsStore.incrementLimit(e.incrementLimitArgs),t.loadingDetailsStore.setState({type:"load_more_blocks",group:i.groupsPointer}),n().vd(o,"collection_load_more_blocks")}},124311:(e,t,o)=>{o.d(t,{K:()=>i});var n=()=>o(989423);function i(e){n().vd(e,"inline_collection_load_more_click")}},126158:(e,t,o)=>{o.d(t,{m:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("arrowDownSmall",{viewBox:"0 0 12 12",svg:(0,n.jsx)("path",{d:"M5.99756 0.850098C5.53564 0.850098 5.21875 1.17236 5.21875 1.65576V7.61768L5.27246 8.7832L4.19287 7.53711L2.98438 6.33398C2.84473 6.18896 2.66211 6.09229 2.42578 6.09229C2.00684 6.09229 1.68994 6.40381 1.68994 6.84424C1.68994 7.04834 1.77051 7.23633 1.93164 7.40283L5.42285 10.8994C5.56787 11.0498 5.78809 11.1357 5.99756 11.1357C6.2124 11.1357 6.42725 11.0498 6.57227 10.8994L10.0688 7.40283C10.23 7.23633 10.3105 7.04834 10.3105 6.84424C10.3105 6.40381 9.99365 6.09229 9.57471 6.09229C9.34375 6.09229 9.16113 6.18896 9.01611 6.33398L7.80762 7.53711L6.72803 8.7832L6.77637 7.61768V1.65576C6.77637 1.17236 6.46484 0.850098 5.99756 0.850098Z"})})},143650:(e,t,o)=>{o.d(t,{e:()=>a});var n=o(296540),i=()=>o(484714),r=()=>o(751156),s=()=>o(351360);function a(){const[e,t]=(0,n.useState)(!0),o=(0,i().v3)();(0,n.useEffect)((()=>{if(e){const{currentSpaceViewStore:e}=s().default.state;if(!e)return;r().createAndCommit({userAction:"PostsHomePanel.updateLastOpened",environment:o,canUndo:!0,perform:t=>{r().applyOperation({store:e,operation:{pointer:e.pointer,path:["settings","last_opened_aggregated_feed"],command:"set",args:Date.now()},transaction:t})}})}}),[e,o])}},316369:(e,t,o)=>{o.d(t,{w:()=>C});o(581454),o(296540);var n=()=>o(484714),i=()=>o(651124),r=()=>o(30626),s=()=>o(959013),a=()=>o(496603),l=()=>o(436696),d=()=>o(896628),c=()=>o(751156),u=()=>o(722872),m=()=>o(760217),p=()=>o(406699),g=()=>o(285790),f=()=>o(928600),h=()=>o(939740),v=()=>o(897119),y=()=>o(89924),S=o(474848);const b=(0,s().j4)((function(e){const{limit:t}=e;return(0,S.jsx)(s().sA,{defaultMessage:"{limit} pages",values:{limit:t.limit},id:"database.FirstLoadLimitSelectOption.limitPagesTitle"})})),x=(0,s().YK)({firstLoadLimitActionButtonAriaLabel:{defaultMessage:"Load limit settings menu",id:"database.firstLoadLimitActionButton.ariaLabel"}});function C(e){let{format:t,collectionContextStore:o}=e;const i=(0,n().v3)(),{device:a}=i,u=(0,s().tz)();return a.isMobile?null:(0,S.jsx)(p().Ay,{popupType:v().nl.Popup,renderOrigin:e=>(0,S.jsx)(g().A,{icon:r()._,style:{marginLeft:4,marginRight:4},ariaLabel:u.formatMessage(x.firstLoadLimitActionButtonAriaLabel),...e}),alignmentToOrigin:p().yP.End,placementToOrigin:p().sx.Bottom,originGap:8,render:e=>(0,S.jsx)(w,{currentLimit:I(t),onAccept:e=>function(e,t,o){const n=t.collectionViewStore();if(!n)return;if(!n.getType())return;c().createAndCommit({userAction:"FirstLoadLimitActionButton.handleFirstLoadLimitAccept",environment:o,canUndo:!0,perform:t=>{d().zA({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),t.groupsStore.resetAllLimits(),(0,l().X)({environment:o,collectionContextStore:t,action:"set_first_load_limit"})}(e,o,i),onClose:e.close,showTitle:!0})})}function I(e){return(0,i().i3)(e.inline_collection_first_load_limit,Boolean(e.collection_group_by))}function w(e){const t=(0,n().v3)(),{device:o}=t,{currentLimit:r,onAccept:l,onClose:d,showTitle:c}=e,p=(0,a().oE)(i().X9.map(((e,t)=>{const o={key:t,render:t=>(0,S.jsx)(m().A,{...t,disabled:!1,title:(0,S.jsx)(b,{limit:e}),isChecked:(0,a().n4)(r,e)}),action:()=>l(e)};return o}))),g=[{key:0,render:e=>(0,S.jsx)(y().A,{enableActionSheetTitle:!0,title:c&&(0,S.jsx)(s().sA,{defaultMessage:"Show on first load",id:"database.firstLoadLimitSelectMenu.firstLoadLimitSetting"}),...e}),items:p}];let v;return v=o.isMobile?{menuType:u().gu.ActionSheet}:{menuType:u().gu.Popup,width:200},(0,S.jsx)(f().A,{...v,children:(0,S.jsx)(h().Ay,{type:h().Oh.Vertical,sections:g,onAccept:d,initialFocus:void 0})})}},334306:(e,t,o)=>{o.r(t),o.d(t,{MobileUnifiedFeed:()=>Ot,PostChannelCollectionView:()=>Rt,PostPresence:()=>yo});o(944114),o(898992),o(354520),o(672577),o(908872);var n=o(296540),i=()=>o(17022),r=()=>o(484714),s=()=>o(847249),a=()=>o(401497),l=()=>o(187174),d=()=>o(68263),c=()=>o(854150),u=()=>o(116225),m=()=>o(449506),p=()=>o(661920),g=()=>o(519839),f=()=>o(75544),h=()=>o(645099),v=()=>o(186445),y=()=>o(351360),S=()=>o(630116),b=()=>o(486130),x=()=>o(184966),C=()=>o(906571),I=()=>o(952412),w=()=>o(636090),M=()=>o(959013),k=()=>o(100622),j=()=>o(284371),T=()=>o(246826),A=()=>o(751156),P=()=>o(437768),_=()=>o(180762),R=()=>o(297872),B=()=>o(928600),L=()=>o(864943),U=()=>o(897119),K=()=>o(299772),D=()=>o(989423),F=()=>o(722872),E=()=>o(377586),W=()=>o(548821),O=()=>o(623241),z=()=>o(659915),V=()=>o(118884);var N=()=>o(661945);class H extends(()=>o(757695))().default{getInitialState(){return{type:"closed"}}open(e){this.setState({type:"open",storeId:e})}close(){this.setState({type:"closed"})}}const G=new H;var Y=()=>o(732800),$=()=>o(439929),q=(o(581454),()=>o(690825)),J=()=>o(403315),X=()=>o(559653),Z=()=>o(496603),Q=()=>o(763824),ee=()=>o(460292),te=()=>o(789550),oe=()=>o(336588),ne=()=>o(584262),ie=()=>o(452939),re=()=>o(466721),se=()=>o(851240),ae=()=>o(436683),le=()=>o(499512),de=()=>o(577814),ce=()=>o(406699),ue=()=>o(187485),me=()=>o(614505),pe=()=>o(457510),ge=()=>o(493733),fe=()=>o(524702),he=()=>o(27654),ve=()=>o(828634),ye=()=>o(492414),Se=()=>o(792540),be=()=>o(108944),xe=()=>o(963589),Ce=()=>o(683097),Ie=()=>o(575301),we=()=>o(257502),Me=()=>o(168500),ke=()=>o(25680),je=()=>o(104077),Te=()=>o(70423),Ae=()=>o(30626),Pe=()=>o(742852),_e=()=>o(105819),Re=()=>o(350124),Be=()=>o(236262),Le=()=>o(534177),Ue=()=>o(741496),Ke=()=>o(884107),De=()=>o(457190),Fe=()=>o(435009),Ee=()=>o(345913),We=()=>o(441467),Oe=()=>o(517288),ze=()=>o(528787),Ve=()=>o(116008),Ne=()=>o(760217),He=()=>o(285790),Ge=()=>o(939740),Ye=()=>o(8980),$e=()=>o(89924),qe=()=>o(859428),Je=()=>o(125565),Xe=()=>o(56086),Ze=()=>o(668577),Qe=()=>o(87854),et=()=>o(862292),tt=()=>o(299545),ot=()=>o(645873),nt=()=>o(518773),it=()=>o(101930),rt=o(474848);const st=(0,M().YK)({addReaction:{id:"postActions.react.tooltip",defaultMessage:"React"},moreActions:{id:"postActions.more.tooltip",defaultMessage:"More actions"}}),at=["👍","🎉","❤️"],lt=16;function dt(e){const{show:t,blockStore:o,feedType:n}=e,i=(0,r().v3)(),{value:l}=(0,ot().fJ)(et().T.formulas),d=(0,r().Y0)(),c=(0,M().tz)(),u=(0,xe().X)("emoji_frecency"),m=(0,xe().X)("suggested_reactions"),p=(0,s().K8)((()=>{if(u){const e=Ze().o.getEmojiFrecencyMap(),t=Object.keys(e).sort(((t,o)=>e[o].f-e[t].f)).slice(0,3);return[...t,...at.slice(t.length)]}{var e,t;const o=(null===(e=y().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId())||"",n=(null===(t=Qe().A.getStore(o).state)||void 0===t?void 0:t.split(",").filter(Boolean))||[];return[...n.slice(0,3),...at.slice(n.slice(0,3).length)]}}),[u]),g=(0,a().IS)((e=>({container:{position:"absolute",zIndex:1,right:16,opacity:t?1:0,transition:"opacity 100ms ease-out",display:"flex",padding:"2px",boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)",borderWidth:1,borderStyle:"solid",borderColor:e.stroke.secondary,borderRadius:6,backgroundColor:e.buttonGroupBackground,gap:1},reactIcon:{width:21,height:21,fill:e.icon.secondary}})),[t]),f=(0,Ie().T4)();return(0,rt.jsxs)("div",{style:g.container,children:[m&&p.map((e=>(0,rt.jsx)("div",{children:(0,rt.jsx)(He().A,{ariaLabel:c.formatMessage(st.addReaction),hasBackground:!1,showShadow:!1,icon:()=>(0,rt.jsx)(Xe().A,{char:e,size:lt}),onClick:()=>(e=>{const t=(0,tt().O3)(o,{recursivelyLoadAllDiscussions:!1,includePropertyDiscussions:!1,excludeSelf:!1}).find((e=>e.getReactions().length>0));t?A().createAndCommit({environment:i,userAction:"Comment.toggleReactionFromMenu",canUndo:!0,perform:o=>{ze().toggleReaction({environment:i,transaction:o,store:t,icon:e,discussionLocation:"post_top_level_discussion"})}}):(Ve().A.setState({open:!0,type:"block",content:"reaction",blockStore:o,blockId:o.id,emoji:e,rect:new DOMRect}),We().i5({environment:i,skipOpeningDiscussion:!0,formulasModule:l}))})(e)})},e))),(0,rt.jsx)(qe().A,{renderTooltip:()=>(0,rt.jsx)(M().sA,{...st.addReaction}),render:e=>(0,rt.jsx)(He().A,{ariaLabel:c.formatMessage(st.addReaction),hasBackground:!1,showShadow:!1,icon:()=>(0,Re().s)(g.reactIcon),onClick:e=>{(0,Oe().O)({environment:i,blockStore:o,rect:e.currentTarget.getBoundingClientRect(),skipOpeningDiscussionOnSubmit:!0,formulasModule:l})},...e})}),(0,rt.jsx)(ce().Ay,{style:f.popup,popupType:d.isMobile?ce().z7.SlideUp:ce().z7.Popup,placementToOrigin:ce().sx.Right,stopClickPropagation:!0,renderOrigin:e=>(0,rt.jsx)(qe().A,{renderTooltip:()=>(0,rt.jsx)(M().sA,{...st.moreActions}),render:t=>(0,rt.jsx)(He().A,{...e,...t,hasBackground:!1,showShadow:!1,icon:Ae()._,ariaLabel:c.formatMessage(st.moreActions)})}),render:e=>(0,rt.jsx)(ct,{blockStore:o,closeMenu:e.close,feedType:n})})]})}function ct(e){const{blockStore:t,closeMenu:o,feedType:n}=e,i=(0,r().v3)(),l=(0,r().Y0)(),{value:d}=(0,ot().fJ)(et().T.formulas),c=(0,it().x)(t),u=(0,it().A)(t),m=(0,s().K8)((()=>{var e;return"all"===(null===(e=t.getFollowStore())||void 0===e||null===(e=e.getFollowSettings())||void 0===e?void 0:e.comments)}),[t]),p=(0,s().K8)((()=>[...l.isPhone&&t.canComment()?["addReaction"]:[],"copyLink","toggleNotifications",...t.canEdit()?["edit","delete"]:[]]),[t,l.isPhone]),g=(0,a().IS)((()=>({icon:{height:16,width:16}})),[]),f=(0,Ie().T4)(),h=p.map(((e,r)=>{const s=r===p.length-1&&l.isMobile;switch(e){case"addReaction":return{key:e,render:e=>(0,rt.jsx)(Ne().A,{...e,icon:(0,Re().s)(g.icon),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,rt.jsx)(M().sA,{id:"postActions.addReaction.button",defaultMessage:"React"}),onClick:e=>{(0,Oe().O)({environment:i,blockStore:t,rect:e.currentTarget.getBoundingClientRect(),skipOpeningDiscussionOnSubmit:!0,formulasModule:d}),o()}}),action:()=>{}};case"copyLink":return{key:e,render:e=>(0,rt.jsx)(Ne().A,{...e,icon:(0,rt.jsx)(Ye().I,{icon:Pe().w}),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,rt.jsx)(M().sA,{id:"postActions.copyLink.button",defaultMessage:"Copy link"})}),action:async()=>{const e=await Ke().R.clipboardActions.load();u&&e.copyString({environment:i,stringValue:u,copiedMessage:e.clipboardMessages.copiedLinkToClipboard})}};case"toggleNotifications":return{key:e,render:e=>m?(0,rt.jsx)(Ne().A,{...e,icon:(0,Te().L)(g.icon),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,rt.jsx)(M().sA,{id:"postActions.disableNotifications.button",defaultMessage:"Turn off reply notifications"})}):(0,rt.jsx)(Ne().A,{...e,icon:(0,rt.jsx)(Ye().I,{icon:je().r}),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,rt.jsx)(M().sA,{id:"postActions.enableNotifications.button",defaultMessage:"Get notifications for replies"})}),action:()=>{const e=t.getModel(),{currentUserStore:o}=y().default.state;if(!e||!o)return;const{following:n,followSettings:r}=(0,nt().A)(m?"none":"comments");De().v({environment:i,followSettings:r,following:n,navigableBlockId:t.id,userId:o.id,spaceId:t.getSpaceId(),key:"comments",selectedKey:"comments",from:"more_menu"})}};case"edit":return{key:e,render:e=>(0,rt.jsx)(Ne().A,{...e,icon:(0,rt.jsx)(Ye().I,{icon:_e().pencilLineIcon}),style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,rt.jsx)(M().sA,{id:"postActions.edit.button",defaultMessage:"Edit"})}),action:()=>c&&Fe().oo({environment:i,url:c})};case"delete":return{key:e,render:e=>(0,rt.jsx)(Ne().A,{...e,icon:(0,rt.jsx)(Ye().I,{icon:Be().trashIcon}),isRedOnHover:!0,style:{...f.buttonMenuItem,...s&&f.transparentButtonMenuItemBorder},pressedStyle:f.buttonMenuItemPressed,titleStyle:f.title,title:(0,rt.jsx)(M().sA,{id:"postActions.delete.button",defaultMessage:"Delete"})}),action:()=>{A().createAndCommit({userAction:"PostActions.delete",environment:i,canUndo:!0,perform:e=>{Ee().oD({environment:i,blocks:[t],transaction:e}),e.postSubmitCallbacks.push((e=>{e||(0,Ue().N)(i,{analyticsName:"delete",from:"block_more_menu",block_id:t.id,block_type:t.getType(),collection_id:t.getParentId()})}))}}),(0,D().u4)({environment:i,event:{eventName:"post_deleted",eventProperties:{block_id:t.id,from:n}}})}}}})).filter(Le().O9);return(0,rt.jsx)(B().A,{menuType:F().gu.Popup,height:l.isMobile?"50vh":void 0,minWidth:250,maxWidth:l.isMobile?"100vw":void 0,scrollerStyle:f.menuScroller,header:l.isMobile&&(0,rt.jsx)(Je().A,{style:f.header,children:(0,rt.jsx)(M().sA,{id:"postActions.moreActions",defaultMessage:"More actions"})}),children:(0,rt.jsx)(Ge().Ay,{type:Ge().Oh.Vertical,initialFocus:void 0,onAccept:o,sections:[{key:0,render:e=>(0,rt.jsx)($e().A,{...e,style:f.sectionMenuItem}),items:h}]})})}const ut=6;function mt(e){const{store:t,inUnifiedFeed:o,index:i,onShowMoreClicked:l,disableInteraction:d}=e,c=(0,r().v3)(),u=(0,r().Y0)(),m=u.isPhone,p=(0,xe().X)("ken_new_home_design"),g=u.isMobile?150:500,[f,h]=(0,n.useState)(!1),[v,S]=(0,n.useState)(!1),[b,x]=(0,n.useState)(!1),C=(0,n.useRef)(null),I=(0,n.useRef)(null),w=(0,Ce().A)({onLongPress:()=>{var e;return null===(e=I.current)||void 0===e?void 0:e.setOpen(!0)}}),M=(0,s().K8)((()=>t.getTitleStore()),[t]),k=(0,s().K8)((()=>t.getIcon()),[t]),T=(0,s().K8)((()=>t.getContentStore()),[t]),A=(0,s().K8)((()=>t.getCreatedByStore()),[t]),P=(0,s().K8)((()=>({lastEditedTime:t.getLastEditedTime(),createdTime:t.getCreatedTime()})),[t]),_=(0,s().K8)((()=>{const e=y().default.state.mainEditorCurrentBlockStore;return o&&e?(0,ye().Ay)({store:e,peekViewBlockId:t.id,peekMode:"c",fullyQualified:!1,pageVisitSource:ne().y8.UnifiedFeed}):(0,ye().Ay)({store:t,fullyQualified:!1,pageVisitSource:ne().y8.TeamFeed})}),[t,o]),R=(0,s().K8)((()=>!t.isEmptyTitle()),[t]),B=(0,s().K8)((()=>(0,be().Uo)(t)),[t]),{pageVisitStore:L,presenceStore:U}=(0,ke().S)({store:t,environment:c,postContext:W().Rr.PostInFeed}),{ready:K}=(0,se().A)({pageStore:t,pageVisitStore:L,disableSideEffects:!0}),F=(0,n.useCallback)((()=>{const e=c.currentUser.id;if(!K||!e)return;const n=(0,X().$5)({parent_id:t.id,user_id:e});d||re().FZ(c,{blockStore:t,fromPageRefresh:!1,pageVisitStore:L,timestamp:Date.now(),type:"passive"}),ie().yP(c,{query:"",page_id:t.id,is_peek:!1,peek_mode:void 0,page_visit_source_override:o?ne().y8.UnifiedFeedScroll:ne().y8.TeamFeedScroll,rank:i,type:"page",page_visit_id:n,previous_page_visit_id:void 0})}),[c,L,K,t,o,i,d]);(0,n.useEffect)((()=>{Me().u.onResults({environment:c})}),[c]),(0,n.useEffect)((()=>{if(!C.current)return;const e=new IntersectionObserver((e=>{let[t]=e;t.isIntersecting&&F()}),{threshold:1});return e.observe(C.current),()=>e.disconnect()}),[C,F]);const E=(0,n.useCallback)((()=>x(!0)),[]),O=(0,n.useCallback)((()=>x(!1)),[]),z=(0,n.useCallback)((e=>{const t=(null==e?void 0:e.height)??0;S(t>=g&&!f)}),[f,g]),V=(0,n.useCallback)((()=>{u.isPhone?G.open(t.id):(h(!0),F()),null==l||l(),(0,D().u4)({environment:c,event:{eventName:"post_see_more_clicked",eventProperties:{block_id:t.id,rank:i,from:o?"unified_feed":"team_feed"}}})}),[h,F,c,t,i,o,l,u.isPhone]),N=(0,Ie().T4)(),H=(0,s().K8)((()=>(0,de().A)({environment:c,store:t,pageViewBlockStore:void 0})),[c,t]),Y=(0,a().IS)((t=>{const{unhoveredBoxShadow:n,hoveredBoxShadow:i}=(0,oe().vy)({isPhone:m,theme:t}),r="dark"===t.mode;return{container:{position:"relative",padding:(0,oe().OD)(u),..."card"===e.mode&&{boxShadow:b?i:n,borderRadius:"12px",background:r?t.surface.wash:t.surface.page},..."minimal"===e.mode&&{borderBottomColor:t.regularDividerColor,borderBottomWidth:1,borderBottomStyle:"solid",background:t.surface.page}},titleRow:{display:"flex",alignItems:"baseline"},postIcon:{marginTop:2,marginRight:4},postSubject:{fontSize:26,marginBottom:8,fontWeight:j().Wy.semibold,...u.isMobile&&{fontSize:20,lineHeight:"130%"}},authorRow:{marginTop:2,marginBottom:2},postContent:{fontSize:14,overflowY:"hidden",maxHeight:f?void 0:g,position:"relative",...u.isPhone&&{pointerEvents:"none"}},commentContainer:{display:"flex",gap:ut,alignItems:"center",paddingTop:12},postIsReadCheckpoint:{position:"absolute",bottom:0,right:0,width:"100%"},mobileGradient:{position:"absolute",zIndex:1,left:0,right:0,height:30,background:`linear-gradient(to bottom, ${t.contentBackgroundTransparent} 0px, ${t.selectedMarginDiscussionBackground} 30px)`,marginTop:-28},contentContainer:{paddingLeft:30,paddingRight:"card"===e.mode?30:0,...p&&{paddingLeft:8,paddingRight:"card"===e.mode?8:0},...u.isMobile&&{paddingLeft:45},...u.isMobile&&!o&&{marginTop:-12}},contentWrapper:{position:"relative"},pageDiscussionsWrapper:{width:"100%"}}}),[m,u,e.mode,b,f,o,g,p]),$=(0,pe().i)();if(!A)return null;const q=M&&(0,rt.jsx)(fe().A,{style:Y.postSubject,store:M,disabled:!0,disableEquationInteraction:!0,disableComment:!0,inPageFind:Se().Os.none,disableStyleAnnotations:d},t.id),J=u.isMobile?{tabIndex:0,onClick:V,style:Y.contentWrapper}:{style:Y.contentWrapper};return(0,rt.jsx)(ce().Ay,{ref:I,style:N.popup,popupType:u.isMobile?ce().z7.SlideUp:ce().z7.Popup,bottomSheetInitialState:"half",stopClickPropagation:!0,render:e=>(0,rt.jsx)(ct,{blockStore:t,closeMenu:e.close,feedType:o?"unified_feed":"team_feed"}),renderOrigin:()=>(0,rt.jsxs)("div",{style:Y.container,onMouseEnter:E,onMouseLeave:O,...w,children:[!u.isPhone&&!d&&(0,rt.jsx)(dt,{show:b,blockStore:t,feedType:o?"unified_feed":"team_feed"}),(0,rt.jsx)("div",{style:Y.authorRow,children:m?(0,rt.jsx)(ae().e,{lastEditedTime:P.lastEditedTime,createdTime:P.createdTime,location:"mobile_post_creator",teamStore:o?B:void 0,authorStore:A}):(0,rt.jsx)(ae().Y,{lastEditedTime:P.lastEditedTime,createdTime:P.createdTime,location:"post_creator",teamStore:o?B:void 0,authorStore:A})}),(0,rt.jsxs)("div",{style:Y.contentContainer,children:[(0,rt.jsxs)("div",{style:Y.titleRow,children:[k&&(0,rt.jsx)(me().B,{icon:k,isEmptyPage:!1,size:26,largeIcon:!0,disabled:!0,style:Y.postIcon}),R&&M&&(d?q:u.isMobile?(0,rt.jsx)("div",{onClick:()=>G.open(t.id),role:"button",tabIndex:-1,style:$,children:q}):(0,rt.jsx)("span",{style:k?$:void 0,children:(0,rt.jsx)(ue().A,{href:_,children:q})}))]}),(0,rt.jsx)(ve().EE,{onSizeChange:z,children:(0,rt.jsxs)("div",{...J,children:[(0,rt.jsx)("div",{style:Y.postContent,children:(0,rt.jsx)(he().c.Provider,{value:!0,children:(0,rt.jsx)(ge().A,{store:T,forceIsInsideMarginCollapseContainer:!0,disabled:!0,disableHoverMenu:!0,disableCommentMenu:!0,disableSuggestEdit:!0})})}),v&&!f&&(u.isPhone?(0,rt.jsx)("div",{style:Y.mobileGradient}):(0,rt.jsx)(le().d,{enableIcon:!u.isPhone,onClick:V})),(0,rt.jsx)("div",{ref:C,style:Y.postIsReadCheckpoint})]})}),!d&&(0,rt.jsx)("div",{style:Y.commentContainer,children:(0,rt.jsx)(we().d,{store:t,pageViewBlockContext:W().Rr.PostInFeed,pageDiscussionsRenderState:H,wrapper:e=>(0,rt.jsx)("div",{style:Y.pageDiscussionsWrapper,children:e}),collapsed:!0,discussionLocation:"post_top_level_discussion",pageVisitStore:L,presenceStore:U})})]})]})})}function pt(e){const{posts:t,inUnifiedFeed:o,renderCaughtUpAction:i,welcomePost:s,currentLimit:l}=e,[d,c]=(0,n.useState)(void 0),u=(0,r().v3)(),m=(0,r().Y0)(),p=u.currentUser.id,g=(0,n.useMemo)((()=>{const e=t.map(((e,t)=>({type:"user-created",store:e,index:t,inUnifiedFeed:o,renderCaughtUpAction:i,renderCaughtUpPostId:d})));return t.length<l&&e.push({type:"welcome",component:s}),e}),[t,s,l,o,i,d]),f=(0,n.useRef)(null),h=(0,n.useContext)(te().R),v=null==h?void 0:h.verticalScroller,y=(0,n.useCallback)((()=>(null==v?void 0:v.getNode())??null),[v]),[b,x]=(0,n.useState)(0);(0,n.useLayoutEffect)((()=>{function e(){var e,t;x(Math.floor(((null===(e=f.current)||void 0===e?void 0:e.getBoundingClientRect().top)??0)+((null===(t=y())||void 0===t?void 0:t.scrollTop)??0)))}e();const t=requestAnimationFrame(e),o=new ResizeObserver((t=>{t[0]&&e()})),n=y();return n&&o.observe(n),()=>{o.disconnect(),cancelAnimationFrame(t)}}),[f,y]);const C=(0,q().Te)({count:g.length,getItemKey:e=>"user-created"===g[e].type?g[e].store.id:"welcome",getScrollElement:y,estimateSize:()=>200,overscan:1,gap:(0,oe().iq)(m),scrollMargin:b,useAnimationFrameWithResizeObserver:!0,rangeExtractor:e=>{const t=Math.max(0,e.startIndex-10);return Z().y1(t,e.endIndex+e.overscan)}}),I=(0,n.useCallback)((()=>{C.shouldAdjustScrollPositionOnItemSizeChange=()=>(C.shouldAdjustScrollPositionOnItemSizeChange=void 0,!1)}),[C]);(0,n.useEffect)((()=>{if(!p||d)return;(async()=>{const e=await(0,Q().lX)(t,10,(async e=>{const t=e.getCreatedById()===p,o=e.pointer.spaceId;if(t||!o)return{id:e.id,read:!0};const n=(0,X().$5)({parent_id:e.id,user_id:p}),i=(0,S().Oo)(e,{table:X().F9,id:n,spaceId:o});await i.load();const r=i.getKeyStore("visited_at").getValue();return{id:e.id,read:Boolean(r)}})),o=null==e?void 0:e.findIndex((e=>e.read)),n=o>0?e[o]:null;c(null==n?void 0:n.id)})()}),[d,t,p]);const w=C.getTotalSize(),M=(0,a().IS)((e=>({container:{height:w,position:"relative"},item:{position:"absolute",top:0,left:0,width:"100%"}})),[w]);return(0,rt.jsx)("div",{ref:f,style:M.container,children:C.getVirtualItems().map((e=>(0,rt.jsx)("div",{"data-index":e.index,ref:C.measureElement,style:{...M.item,transform:`translateY(${e.start-C.options.scrollMargin}px)`},children:(0,rt.jsx)(gt,{item:g[e.index],renderCaughtUpPostId:d,renderCaughtUpAction:i,onShowMoreClicked:I})},"string"==typeof e.key?e.key:"unknown")))})}function gt(e){const{item:t,renderCaughtUpPostId:o,renderCaughtUpAction:i,onShowMoreClicked:s}=e,a=(0,r().v3)();return"user-created"===t.type?(0,rt.jsxs)(n.Fragment,{children:[t.store.id===o&&(0,rt.jsx)(ft,{renderCaughtUpAction:i}),(0,rt.jsx)(mt,{store:t.store,index:t.index,inUnifiedFeed:t.inUnifiedFeed,onShowMoreClicked:s,mode:a.device.isMobile?"minimal":"card"})]}):t.component}function ft(e){const{renderCaughtUpAction:t}=e,o=(0,a().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:12,paddingTop:24,paddingBottom:24,alignItems:"center"},textWrapper:{display:"flex",flexDirection:"column",gap:2,alignItems:"center"},primaryText:{fontSize:j().J.UIRegular.desktop,fontWeight:j().Wy.medium,color:k().Ay.mediumTextColor}})),[]);return(0,rt.jsxs)("div",{style:o.container,children:[(0,rt.jsx)(ee().Q,{iconGroup:J().a,variantName:"fill",colorName:"tertiary"}),(0,rt.jsxs)("div",{style:o.textWrapper,children:[(0,rt.jsx)("div",{style:o.primaryText,children:(0,rt.jsx)(M().sA,{defaultMessage:"You’re all caught up",id:"posts.discoverCTA.caughtUp"})}),t]})]})}o(430670),o(803949);var ht=()=>o(798880),vt=()=>o(919709),yt=()=>o(44729),St=()=>o(47170),bt=()=>o(246125);function xt(e){return"__SEGMENTED__"===e.messageKey}function Ct(e){let{cacheName:t,inUnifiedFeed:o,messages:i,contentLines:s}=e;const a=(0,r().v3)(),l=(0,bt().l)(t,{overrideDefaultRecordCache:!1,isTemporaryData:!0});l.addCacheFallback(a.defaultRecordCache.inMemoryRecordCache);const d=(0,M().tz)(),c=(0,St().O)(),u=(0,n.useMemo)((()=>({table:ht().oo,id:ht().EP.id})),[]),m=(0,n.useMemo)((()=>{if(!u||!c)return null;const{performResult:e}=A().createAndCommit({userAction:"BaseWelcomePost.createWelcomePost",environment:a,canUndo:!0,skipUpdatingEditedMetadata:!0,perform:e=>{const t=T().Wv({environment:a,type:"text",properties:{title:[vt().Ey_(d.formatMessage(i.welcomeTitle))]},inMemoryRecordCache:l,transaction:e,spaceId:c,createdTime:Date.now()-288e5,createdByTable:u.table,createdById:u.id,lastEditedTime:Date.now()-288e5,lastEditedByTable:u.table,lastEditedById:u.id});return s.forEach((o=>{const n=T().Wv({environment:a,type:"bulleted_list"===o.type?"bulleted_list":"header"===o.type?"header":"sub_header"===o.type?"sub_header":"text",properties:{title:xt(o)?o.segments.flatMap((e=>function(e,t,o,n){var i;if(e.pageMention)return[vt().Ey_(e.pageMention.id,[["p",e.pageMention.id]])];const r=n.formatMessage(t[e.messageKey]),s=[];return null!==(i=e.formatting)&&void 0!==i&&i.bold&&s.push(["b"]),e.link&&s.push(["a",e.link]),[vt().Ey_(r,s)]}(e,i,0,d))):[vt().Ey_(d.formatMessage(i[o.messageKey]))]},inMemoryRecordCache:l,transaction:e,spaceId:c,createdTime:Date.now()-288e5,createdByTable:u.table,createdById:u.id,lastEditedTime:Date.now()-288e5,lastEditedByTable:u.table,lastEditedById:u.id});yt().NI({parentStore:t.getContentStore(),childStore:S().Bv.createChildStore(t.getContentStore(),n.pointer),transaction:e})})),t}});return new(S().Bv)(a,e.pointer,{inMemoryRecordCache:l})}),[a,i,s,u,l,d,c]);return m?(0,rt.jsx)(mt,{store:m,disableInteraction:!0,inUnifiedFeed:o,index:-1,mode:a.device.isMobile?"minimal":"card"}):null}const It=(0,M().YK)({welcomeTitle:{id:"TeamHomeWelcomePage.welcomeTitle",defaultMessage:"👋 Welcome to your teamspace"},intro:{id:"TeamHomeWelcomePage.intro",defaultMessage:"Your central hub to share announcements, manage members, and find key docs in your team."},aboutSpaceHeader:{id:"TeamHomeWelcomePage.aboutSpaceHeader",defaultMessage:"About the space"},feedItem:{id:"TeamHomeWelcomePage.feedItem",defaultMessage:"Feed — Read and share project updates, team announcements, and more"},aboutItem:{id:"TeamHomeWelcomePage.aboutItem",defaultMessage:"About — Learn what the teamspace is for and how it should be used"},membersItem:{id:"TeamHomeWelcomePage.membersItem",defaultMessage:"Members — See who is a part of this teamspace today"},docsItem:{id:"TeamHomeWelcomePage.docsItem",defaultMessage:"Docs — Access your team’s documents"},moreHeader:{id:"TeamHomeWelcomePage.moreHeader",defaultMessage:"Looking for more?"},moreInfoPrefix:{id:"TeamHomeWelcomePage.moreInfoPrefix",defaultMessage:"Check out this “Intro to Teamspaces” guide "},moreInfoLink:{id:"TeamHomeWelcomePage.moreInfoLink",defaultMessage:"here"},moreInfoSuffix:{id:"TeamHomeWelcomePage.moreInfoSuffix",defaultMessage:"."}}),wt=[{type:"text",messageKey:"intro"},{type:"sub_header",messageKey:"aboutSpaceHeader"},{type:"bulleted_list",messageKey:"feedItem"},{type:"bulleted_list",messageKey:"aboutItem"},{type:"bulleted_list",messageKey:"membersItem"},{type:"bulleted_list",messageKey:"docsItem"},{type:"sub_header",messageKey:"moreHeader"},{type:"text",messageKey:"__SEGMENTED__",segments:[{messageKey:"moreInfoPrefix"},{messageKey:"moreInfoLink",link:"https://www.notion.com/help/intro-to-teamspaces"},{messageKey:"moreInfoSuffix"}]}];function Mt(){return(0,rt.jsx)(Ct,{cacheName:"TeamHomeWelcomePost.cache",inUnifiedFeed:!1,messages:It,contentLines:wt})}const kt=(0,M().YK)({welcomeTitle:{id:"UnifiedFeedWelcomePage.welcomeTitle",defaultMessage:"👋 Welcome to Notion"},tipsHeader:{id:"UnifiedFeedWelcomePage.tipsHeader",defaultMessage:"Tips for starting"},inviteTeamPrefix:{id:"UnifiedFeedWelcomePage.inviteTeamPrefix",defaultMessage:"Invite teammates by clicking on the "},inviteTeamBold1:{id:"UnifiedFeedWelcomePage.inviteTeamBold1",defaultMessage:"name of your workspace"},inviteTeamMiddle:{id:"UnifiedFeedWelcomePage.inviteTeamMiddle",defaultMessage:" in the upper left, and going to "},inviteTeamBold2:{id:"UnifiedFeedWelcomePage.inviteTeamBold2",defaultMessage:"Members"},importDocsPrefix:{id:"UnifiedFeedWelcomePage.importDocsPrefix",defaultMessage:"Import any existing documents by clicking on the name of your workspace, going to "},importDocsBold1:{id:"UnifiedFeedWelcomePage.importDocsBold1",defaultMessage:"Settings"},importDocsMiddle:{id:"UnifiedFeedWelcomePage.importDocsMiddle",defaultMessage:", then "},importDocsBold2:{id:"UnifiedFeedWelcomePage.importDocsBold2",defaultMessage:"Import"},templatesPrefix:{id:"UnifiedFeedWelcomePage.templatesPrefix",defaultMessage:"Explore our template gallery by clicking "},templatesBold:{id:"UnifiedFeedWelcomePage.templatesBold",defaultMessage:"Templates"},templatesSuffix:{id:"UnifiedFeedWelcomePage.templatesSuffix",defaultMessage:" in the sidebar and start writing whatever you like!"},moreInfoPrefix:{id:"UnifiedFeedWelcomePage.moreInfoPrefix",defaultMessage:"👉 Want more tips or ideas? Check out our guides "},moreInfoLink:{id:"UnifiedFeedWelcomePage.moreInfoLink",defaultMessage:"here"},moreInfoMiddle:{id:"UnifiedFeedWelcomePage.moreInfoMiddle",defaultMessage:" or "},moreInfoBold:{id:"UnifiedFeedWelcomePage.moreInfoBold",defaultMessage:"ask AI"},moreInfoSuffix:{id:"UnifiedFeedWelcomePage.moreInfoSuffix",defaultMessage:" in Search or clicking on the face in the bottom right!"}}),jt=[{type:"sub_header",messageKey:"tipsHeader"},{type:"bulleted_list",messageKey:"__SEGMENTED__",segments:[{messageKey:"inviteTeamPrefix"},{messageKey:"inviteTeamBold1",formatting:{bold:!0}},{messageKey:"inviteTeamMiddle"},{messageKey:"inviteTeamBold2",formatting:{bold:!0}}]},{type:"bulleted_list",messageKey:"__SEGMENTED__",segments:[{messageKey:"importDocsPrefix"},{messageKey:"importDocsBold1",formatting:{bold:!0}},{messageKey:"importDocsMiddle"},{messageKey:"importDocsBold2",formatting:{bold:!0}}]},{type:"bulleted_list",messageKey:"__SEGMENTED__",segments:[{messageKey:"templatesPrefix"},{messageKey:"templatesBold",formatting:{bold:!0}},{messageKey:"templatesSuffix"}]},{type:"text",messageKey:"__SEGMENTED__",segments:[{messageKey:"moreInfoPrefix"},{messageKey:"moreInfoLink",link:"https://www.notion.com/help/guides"},{messageKey:"moreInfoMiddle"},{messageKey:"moreInfoBold",formatting:{bold:!0}},{messageKey:"moreInfoSuffix"}]}];function Tt(){return(0,rt.jsx)(Ct,{cacheName:"UnifiedFeedWelcomePost.cache",inUnifiedFeed:!0,messages:kt,contentLines:jt})}function At(e){const{posts:t,draftPostStore:o,createDraft:i,composerStyle:l,setComposerStyle:d,inUnifiedFeed:c,canWritePosts:m,teamStore:p,collectionContextStore:g,subscribedUserTeamStores:f,currentLimit:h}=e,v=(0,r().v3)(),{isMobile:y}=(0,r().Y0)(),{WindowSizeStore:S}=v,{canJoinTeam:b,postingRestricted:C}=(0,O().i)({teamStore:p}),I=(0,s().K8)((()=>N().A.state.isOpen),[]),M=function(){const[e,t]=(0,n.useState)(void 0),o=(0,s().K8)((()=>e&&!e.pathIsDead()),[e]),[i,r]=(0,n.useState)(!1),a=(0,n.useCallback)((()=>{r(!0)}),[]),l=(0,n.useCallback)((e=>{t(e),r(!1)}),[]),d=(0,n.useRef)(!1);return(0,n.useEffect)((()=>{d.current=Boolean(o&&!i)}),[o,i]),(0,V().X)((()=>{d.current&&u().u4({name:"abandon_draft_post"})})),{handleCreatedDraft:l,handleComposerFullScreenClick:a,handleComposerDraftDiscarded:(0,n.useCallback)((()=>{u().u4({name:"abandon_draft_post"})}),[])}}(),k=(0,n.useCallback)((()=>{const e=i();return M.handleCreatedDraft(e),e}),[i,M]),j=(0,n.useCallback)((()=>{x().tt({environment:v,draftPostStore:o,from:c?"unified_feed":"team_home"}),null==d||d("preview")}),[o,v,d,c]),_=(0,n.useCallback)((()=>{o&&(0,z().s)(o)?N().A.setState({isOpen:!0}):j()}),[o,j]),L=(0,n.useCallback)((()=>{o&&(A().createAndCommit({environment:v,perform:e=>{T().zv({store:o,data:{alive:!1,permissions:[]},transaction:e})},userAction:"PostChannel.discardDraft",canUndo:!1}),M.handleComposerDraftDiscarded())}),[o,v,M]),D=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:16,paddingTop:2,paddingLeft:0}})),[]),H=c&&(!f||0===f.length),q=!c&&(m||b||C),J=(0,s().K8)((()=>c&&(null==g?void 0:g.databaseType)===w().SC),[g,c])||q,X=(0,s().K8)((()=>"open"===G.state.type),[]),Z=(0,s().K8)((()=>(0,P().gj)(v,S.state.height)),[v,S]),Q=(0,s().K8)((()=>{if("open"!==G.state.type)return;const e=G.state.storeId;return t.find((t=>t.id===e))}),[t]);return(0,rt.jsxs)("div",{style:D.container,children:[J&&(0,rt.jsx)($().pM,{collectionContextStore:g,showEmptyComposerInUnifiedFeed:H,teamStore:p,postStore:o,isEditing:!1,onSubmit:_,createDraft:k,onFullScreenClick:M.handleComposerFullScreenClick,discardDraft:L,composerStyle:l,setComposerStyle:d}),(0,rt.jsx)(pt,{posts:t,inUnifiedFeed:c,welcomePost:c?(0,rt.jsx)(Tt,{}):(0,rt.jsx)(Mt,{}),renderCaughtUpAction:(0,rt.jsx)(Pt,{collectionContextStore:g}),currentLimit:h}),y&&Q&&(0,rt.jsx)(U().Ay,{popupType:E().n.BottomSheet,open:X,onDismiss:()=>G.close(),bottomSheetInitialState:"full",trapFocus:!0,render:()=>(0,rt.jsx)(B().A,{menuType:F().gu.Modal,hideMobileTopbar:!0,children:(0,rt.jsx)(R().A,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,rt.jsx)(K().Ay,{store:Q,context:W().Rr.Frame,paddingBottom:Z,disabled:!0})})})}),(0,rt.jsx)(Y().A,{postStore:o,isOpen:I,onDismiss:()=>N().A.setState({isOpen:!1}),onConfirm:()=>{N().A.setState({isOpen:!1}),j()}})]})}function Pt(e){const t=(0,r().v3)(),{collectionContextStore:o}=e,n=(0,a().IS)((e=>({secondaryText:{fontSize:j().J.UIRegular.desktop,fontWeight:j().Wy.regular,color:k().Ay.mediumTextColor},container:{display:"flex",flexDirection:"column",gap:12,alignItems:"center"}})),[]),i=(0,s().K8)((()=>{var e,n;const i=null==o||null===(e=o.collectionViewStore())||void 0===e?void 0:e.getCollectionSource(),r="typed"===(null==i?void 0:i.type)&&"notion://posts_collection_discover"===(null==i?void 0:i.databaseType);if(!o||r)return;const s=null==o||null===(n=o.collectionViewBlockStore())||void 0===n?void 0:n.getCollectionViewStores().find((e=>{const t=e.getCollectionSource();return"typed"===(null==t?void 0:t.type)&&"notion://posts_collection_discover"===t.databaseType}));return s?()=>{(0,_().t)({environment:t,collectionContextStore:o,collectionViewId:s.id,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state}),(0,D().u4)({environment:t,event:{eventName:"posts_discover_upsell_clicked",eventProperties:{}}})}:void 0}),[o,t]);return i?(0,rt.jsxs)("div",{style:n.container,children:[(0,rt.jsx)("div",{style:n.secondaryText,children:(0,rt.jsx)(M().sA,{defaultMessage:"Discover posts across the workspace",id:"posts.discoverCTA.discoverText"})}),(0,rt.jsx)(L().A,{size:"md",onClick:i,children:(0,rt.jsx)(M().sA,{defaultMessage:"Discover More",id:"posts.discoverCTA.discoverMore"})})]}):null}const _t=[];function Rt(e){const{collectionViewStore:t,collectionContextStore:o,paddingLeft:w,paddingRight:M}=e,[k,j]=(0,n.useState)("preview"),T=(0,r().v3)(),A=(0,s().K8)((()=>{var e;return null===(e=(0,v()._m)(T))||void 0===e?void 0:e.id}),[T]),P=(0,s().K8)((()=>t.getCollectionStore()),[t]),_=(0,s().K8)((()=>o.collectionViewBlockStore()),[o]),R=(0,s().K8)((()=>null==_?void 0:_.getParentStore()),[_]),B=(0,s().K8)((()=>o.groupsStore.getGroupState(_t)),[o]),L=(0,s().K8)((()=>{var e;return(null==B||null===(e=B.currentLimit)||void 0===e?void 0:e.state)??10}),[null==B?void 0:B.currentLimit]),U=void 0===P,K={type:"results",filter:{operator:"and",filters:[]},limit:L},D=(0,f().A)({id:"default_posts_collection_key",reducer:K,collectionContextStore:o,groupsPointer:_t}),[F,E]=(0,n.useState)(!1);(0,n.useEffect)((()=>{null==B||B.reducerResultStore.setState(D),D&&E(!0)}),[D,null==B?void 0:B.reducerResultStore]),(0,n.useEffect)((()=>{u().u4({name:"open_feed",args:{feed_type:U?"unified":"team"}})}),[U]);const{draftPosts:W,allPosts:O}=(0,s().K8)((()=>{if(null==B||!B.resultsStore||!F)return{draftPosts:void 0,allPosts:void 0};return((null==B?void 0:B.resultsStore.state)??[]).reduce(((e,t)=>{t.uiLocation.removeParent();const o=t.getModel();return"draft"===(null==o?void 0:o.getDraftStatus())?e.draftPosts.push(t):e.allPosts.push(t),e}),{draftPosts:[],allPosts:[]})}),[null==B?void 0:B.resultsStore,F]),z=(0,s().K8)((()=>g().XQ({collectionContextStore:o,reducerResult:D,isFullScreen:!1})),[o,D]),V=(0,s().K8)((()=>_?(0,rt.jsx)(h().jJ,{groupsPointer:_t,store:_,collectionContextStore:o,format:t.getFormat(),isFullScreen:o.isFullScreenStore.state,incrementLimitsInRelatedGroups:!1}):void 0),[_,o,t]),N=(0,s().K8)((()=>{if(!(R instanceof S().ZI))return;const e=R.getTeamId(),t=y().default.state.currentSpaceStore;return t&&e?S().sk.createChildStore(t,{table:"team",id:e,spaceId:t.id}):void 0}),[R]),H=(0,s().K8)((()=>Boolean(A)&&(d().p2((null==P?void 0:P.getRole())??"none")??!1)),[A,P]),G=(0,s().O$)(o.isLoadedStore),{currentSpaceViewStore:Y,currentSpaceStore:$}=(0,s().K8)((()=>({currentSpaceViewStore:y().default.state.currentSpaceViewStore,currentSpaceStore:y().default.state.currentSpaceStore})),[]),[{value:q}]=(0,l().Yb)((async()=>{if(!$)return{unsubscribedTeamIds:void 0};const e=await m().callApi({eventName:"getSubscribedAndUnsubscribedTeams",environment:T,data:{spaceId:$.id}});if("failed"===e.type)throw e.error;return"success"===e.type?{unsubscribedTeamIds:e.data.unsubscribedTeamIds}:e}),[$,T]),{unsubscribedTeamIds:J}=q??{unsubscribedTeamIds:void 0},X=(0,n.useMemo)((()=>i().A.withListenerIgnored((()=>null==Y?void 0:Y.getTeamsStores()))),[Y]),Z=(0,s().K8)((()=>{if(X&&J)return null==X?void 0:X.filter((e=>!(null!=J&&J.includes(e.id))&&e.allowsUserToPost()))}),[X,J]),Q=(0,s().K8)((()=>{const e=t.getCollectionSource();if("typed"===(null==e?void 0:e.type))return e.teamId}),[t]),ee=(0,s().K8)((()=>{if(Q&&$)return S().h4.createChildStore($,{table:c().yK,id:Q,spaceId:$.id})}),[Q,$]),te=(0,s().K8)((()=>{if(!ee||!A)return!1;return ee.isMemberOrGuest(A,b()._.getSpacePermissionGroupIds({userId:A,spaceId:ee.getSpaceId()}))}),[ee,A]),oe=(0,s().K8)((()=>!!ee&&ee.allowsUserToPost()),[ee]);(0,n.useEffect)((()=>{if(Z&&Q&&J&&(J.includes(Q)||!te||!oe)){const e=Z[0];e&&(0,C().z)({environment:T,collectionContextStore:o,currentSpaceViewStore:Y,selectedStore:e,postStore:void 0}),p().YH(),j("preview")}}),[J,Q,T,o,Y,Z,te,oe]);const ne=(0,s().K8)((()=>{const e=t.getCollectionSource();if("typed"===(null==e?void 0:e.type)){var o;return(null==e?void 0:e.teamId)??(null==Z||null===(o=Z[0])||void 0===o?void 0:o.id)}}),[t,Z]),ie=null==Z?void 0:Z.find((e=>e.id===ne));(0,n.useEffect)((()=>{ie&&Z&&o&&G&&I().u.setState({selectedTeamStore:ie,subscribedUserTeamStores:Z,collectionContextStore:o,isPostsCollectionLoaded:G,setComposerStyle:j,teamTargetMobilePopupOpen:I().u.state.teamTargetMobilePopupOpen})}),[ie,Z,o,G]);const re=(0,s().K8)((()=>null==ie?void 0:ie.getChannelStore()),[ie]),se=(0,s().K8)((()=>{if(W){if(U){return W.find((e=>e.getPostTeamId()===(null==re?void 0:re.id)))}return W[0]}}),[W,re,U]),ae=(0,s().K8)((()=>{if(!$||!re)return;const e=S().sk.createUniqueRootStore(T,{table:"block",id:re.id,spaceId:$.id});return e.isCollectionView()?e:void 0}),[T,$,re]),le=(0,s().K8)((()=>null==ae?void 0:ae.getCollectionStore()),[ae]),de=(0,n.useCallback)((()=>{const e=U?le:P;if((H||U)&&e)return(0,x().Nm)({environment:T,collectionStore:e,selectedTeamCollectionStore:le})}),[T,P,H,le,U]),ce=(0,a().IS)((()=>({padding:{paddingLeft:w,paddingRight:M},loadMore:{paddingTop:24,paddingBottom:24}})),[w,M]);return G&&void 0!==O&&R?(0,rt.jsxs)("div",{style:ce.padding,children:[(0,rt.jsx)(At,{collectionContextStore:U?o:void 0,posts:O,draftPostStore:se,composerStyle:k,setComposerStyle:j,createDraft:de,inUnifiedFeed:U,canWritePosts:H,teamStore:N,subscribedUserTeamStores:Z,currentLimit:L}),z&&(0,rt.jsx)("div",{style:ce.loadMore,children:V})]}):null}var Bt=()=>o(938090),Lt=()=>o(2143),Ut=()=>o(347199),Kt=()=>o(817942),Dt=()=>o(696746),Ft=()=>o(756279),Et=()=>o(855685),Wt=()=>o(143650);function Ot(){const e=(0,r().v3)(),[t,o]=(0,n.useState)(void 0),i=(0,s().K8)((()=>{const e=null==t?void 0:t.isLoadedStore.state;return Boolean(e)}),[t]);(0,n.useEffect)((()=>{var t;null===(t=e.mobileNative)||void 0===t||t.markTransitionReady({type:"posts"})}));const l=(0,s().K8)((()=>({top:e.WindowSizeStore.getSafePaddingBottomPx(0),bottom:e.WindowSizeStore.getSafePaddingBottomPx(0)})),[e.WindowSizeStore]),d=(0,a().IS)((e=>{const t=l.bottom+70;return{pageLayout:{paddingTop:24,order:3,display:"flex",flexDirection:"column",width:"100%",backgroundColor:e.contentBackground},scroller:{marginBottom:l.bottom,width:"100%",paddingBottom:t+44},layoutContent:{flex:1,height:"100%"},header:{fontSize:36,fontFamily:j().Tf.sans,fontWeight:j().Wy.bold,marginLeft:22,marginBottom:8},container:{width:"100%",height:"100%",display:"flex"}}}),[l.bottom]);(0,Wt().e)();const c=(0,n.useCallback)((e=>{Ut().A.PageScroller=e}),[]),u=(0,s().K8)((()=>{const e=(0,Dt().XH)("posts");if(null!=e&&e.isCollectionView())return e}),[]);return u?(0,rt.jsx)("div",{id:$().d_,className:"home-content",style:d.container,children:(0,rt.jsx)(Lt().H,{type:Ft().A.Y,ref:c,style:d.scroller,children:(0,rt.jsx)(Kt().Mx,{type:"home-phone",style:d.pageLayout,children:(0,rt.jsxs)(Kt().vV,{style:d.layoutContent,children:[(0,rt.jsx)("div",{style:d.header,children:(0,rt.jsx)(M().sA,{id:"posts.mobile.header",defaultMessage:"Feed"})}),(0,rt.jsx)(Bt().dN,{setCollectionContextStore:o,store:u,disabled:!1,isFullScreen:!0,productUseCase:"mobile_feed",overrideViewType:"feed",isFirstItem:!0,isLastItem:!0,hideViewTabBar:!1,headerAllowedActions:[]}),!i&&(0,rt.jsx)(Et().SU,{hasComposer:!1})]})})})}):null}o(823215);var zt=()=>o(662303),Vt=()=>o(869190),Nt=()=>o(641007);const Ht=(0,o(340498).xh)("eye",{default:{loader:()=>o.e(64632).then(o.bind(o,89849))},small:{loader:()=>o.e(64632).then(o.bind(o,670371))},fill:{loader:()=>o.e(64632).then(o.bind(o,187881))},fillSmall:{loader:()=>o.e(64632).then(o.bind(o,514608))}},["eye","vision","see","look","observe"]);var Gt=()=>o(695608),Yt=()=>o(620689),$t=()=>o(102172),qt=()=>o(138873),Jt=()=>o(704152),Xt=()=>o(994006),Zt=()=>o(453697),Qt=()=>o(549500),eo=()=>o(673657),to=()=>o(745766),oo=()=>o(680026),no=()=>o(227440),io=()=>o(948914);const ro=5,so=25,ao=20,lo=2;function co(e){return Z().Ul(e,(e=>e.activityTimestampNearestMinuteMs))}function uo(e,t){return S().LU.createChildStore(t,{table:ht().oo,id:e})}function mo(e){return{color:e.text.contrastSecondary,fontSize:12}}function po(e){let{userData:t,isPresent:o,rootStore:n,isShowingInPostFeed:i}=e;const l=(0,a().DP)(),d=(0,r().v3)(),c=(0,M().tz)(),u=d.currentUser.id,m=(0,s().K8)((()=>uo(t.userId,n)),[t,n]),p=(0,s().K8)((()=>m.isDefined()),[m]),g=(0,s().K8)((()=>(0,Gt().c6)(c,m.getModel())),[c,m]),f=(0,s().K8)((()=>m.getEmail()),[m]);if(!p)return null;let h;return o?u!==m.id&&(h=t.blockId&&!i?(0,rt.jsx)(M().sA,{defaultMessage:"Viewing now. Click to see where they are.",id:"post.presenceIndicator.viewingNowWithLocation.tooltip"}):(0,rt.jsx)(M().sA,{defaultMessage:"Viewing now",id:"post.presenceIndicator.viewingNow.tooltip"})):u!==m.id&&t.activityTimestampNearestMinuteMs&&(h=(0,rt.jsx)(M().sA,{defaultMessage:"Last viewed {timeFromNow}",id:"post.presenceIndicator.lastViewedTime.tooltip",values:{timeFromNow:(0,Vt().v9)(Math.min(t.activityTimestampNearestMinuteMs,Date.now()),zt().locale)}})),(0,rt.jsxs)("div",{children:[(0,rt.jsx)("div",{className:"notranslate",children:g}),(0,rt.jsx)("div",{style:{fontWeight:400},children:f}),h&&(0,rt.jsx)("div",{style:{color:l.text.contrastSecondary,minWidth:150,paddingTop:2,paddingBottom:2,lineHeight:1.3},children:h})]})}function go(e){let{userData:t,index:o,rootStore:n}=e;const i=(0,a().DP)(),l=(0,r().v3)(),d=(0,oo().dp)(l,t),c=(0,s().K8)((()=>uo(t.userId,n)),[t,n]);if(!(0,s().K8)((()=>c.isDefined()),[c]))return null;let u;!d&&t.activityTimestampNearestMinuteMs&&(u=(0,Vt().v9)(t.activityTimestampNearestMinuteMs,zt().locale));const m=(0,rt.jsxs)("div",{style:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},children:[(0,rt.jsx)(Xt().A,{userStore:c,avatarSize:18,style:{flexGrow:1}}),(0,rt.jsx)("div",{style:{marginLeft:"auto",paddingLeft:12,textAlign:"right",flexShrink:1,color:i.text.contrastSecondary},children:u})]});if(d&&t.blockId){const e=t.blockId;return(0,rt.jsx)(Jt().A,{onClick:()=>Yt().BL([e],!0,l),style:{display:"flex",alignItems:"center"},children:m})}return(0,rt.jsx)("div",{style:{display:"flex",alignItems:"center"},children:m})}function fo(e){let{hiddenUsers:t,hiddenUsersCount:o,hasMore:n,rootStore:i,events:s}=e;const l=(0,a().DP)(),d=(0,r().v3)(),c=[],u=[];for(const r of t)(0,oo().dp)(d,r)?c.push(r):u.push(r);const m=u.slice(0,so-c.length),p=o-(c.length+m.length);return(0,rt.jsxs)("div",{...s,children:[c.length>0&&(0,rt.jsxs)("div",{style:{marginBottom:4},children:[(0,rt.jsx)(Je().A,{style:mo(l),children:(0,rt.jsx)(M().sA,{defaultMessage:"Viewing now",id:"post.presenceIndicator.hiddenUsers.viewingNow.tooltip"})}),c.map(((e,t)=>(0,rt.jsx)(go,{userData:e,index:t,rootStore:i},t)))]}),m.length>0&&(0,rt.jsxs)("div",{style:{marginBottom:4},children:[(0,rt.jsx)(Je().A,{style:{...mo(l)},children:(0,rt.jsx)(M().sA,{defaultMessage:"Last viewed by",id:"post.presenceIndicator.hiddenUsers.lastViewedBy.tooltip"})}),m.map(((e,t)=>(0,rt.jsx)(go,{userData:e,index:t,rootStore:i},t)))]}),(0,rt.jsx)(ho,{remainingHiddenUsersCount:p,hasMore:n})]})}function ho(e){let{hasMore:t,remainingHiddenUsersCount:o}=e;const n=(0,a().IS)((e=>({message:{marginLeft:2,marginTop:2,color:e.text.contrastSecondary}})),[]);return o>0?(0,rt.jsx)("div",{style:n.message,children:t?(0,rt.jsx)(M().sA,{defaultMessage:"{remainingVisitorsCount}+ more…",id:"topbarPresence.presenceIndicator.hiddenUsers.evenMoreUsersNotViewing.tooltip",values:{remainingVisitorsCount:o}}):(0,rt.jsx)(M().sA,{defaultMessage:"{remainingVisitorsCount} more…",id:"topbarPresence.presenceIndicator.hiddenUsers.moreUsersNotViewing.tooltip",values:{remainingVisitorsCount:o}})}):null}function vo(e){const{userData:t,rootStore:o,isShowingInPostFeed:i=!1}=e,l=(0,r().v3)(),{userId:d}=t,c=(0,oo().dp)(l,t),{userStore:u,showAvatar:m}=(0,s().K8)((()=>{if((0,ht().MF)(d))return{userStore:Nt().px,showAvatar:!0};const e=uo(d,o);return{userStore:e,showAvatar:(e.isDefined()||(0,ht().MF)(e.id))&&!e.getIsSuspended()}}),[d,o]),p=function(e,t){return(0,a().IS)((o=>{const n={width:ao,height:ao,borderRadius:ao},i=e(o);return{button:{transition:"all 0.2s ease",transform:"scale(1)"},buttonHovered:{transform:"scale(1.15)",background:"none"},buttonPressed:{transform:"scale(0.9)",background:"none"},uiUserAvatarStyles:{...n},avatarInnerOutline:{...n,outlineStyle:"solid",outlineColor:o.UIUserAvatarInnerOutline,outlineWidth:.5,outlineOffset:-.5},avatarBorder:t?{...n,outlineStyle:"solid",outlineColor:i,outlineWidth:1.5,outlineOffset:-.5}:n,avatarOuterOutline:{...n,outlineStyle:"solid",outlineColor:t?o.UIUserAvatarOuterOutline:o.UIUserAvatarIdleOutline,outlineWidth:.5,outlineOffset:t?1:0,marginRight:-6,position:"relative"},initialColor:{color:t?i:o.icon.secondary}}}),[e,t])}((0,n.useCallback)((e=>d===l.currentUser.id?e.UIUserAvatarSelfBorder:(0,k().Nq)(d,e)),[l.currentUser.id,d]),c);return m?(0,rt.jsx)(qe().A,{disableTooltip:i,textWrap:!0,renderTooltip:()=>(0,rt.jsx)(po,{rootStore:o,userData:t,isPresent:c,isShowingInPostFeed:i}),render:e=>{const o=(0,rt.jsx)("div",{style:p.avatarOuterOutline,children:(0,rt.jsx)("div",{style:p.avatarBorder,children:(0,rt.jsx)(Zt().A,{iconStyle:p.avatarInnerOutline,userStore:u,style:p.uiUserAvatarStyles,size:ao,avatarShouldShowShadow:!1,initialOverrideStyle:p.initialColor})})});if(c&&t.blockId){const n=t.blockId;return(0,rt.jsx)(Jt().A,{...e,onClick:()=>Yt().BL([n],!0,l),style:p.button,hoveredStyle:p.buttonHovered,pressedStyle:p.buttonPressed,children:o})}return(0,rt.jsx)("div",{...e,children:o})}}):null}function yo(e){const{rootStore:t,pageVisitStore:o,presenceStore:n,maxUsers:i,isShowingInPostFeed:l,enableFacepile:d=!0}=e,c=(0,r().v3)(),u=(0,r().Y0)(),m=c.currentUser.id,p=(0,s().K8)((()=>{const e=c.currentUser.id;if(!e)return;const r=(0,oo().PZ)({pageVisitStore:o,presenceStore:n}),s=(null==o?void 0:o.state.totalCount)??r.length,a=[],l=[];for(const t of r)t.userId!==e&&((0,oo().dp)(c,t)?a.push(t):l.push(t));t.isNavigableBlock()&&(0,$t().BP)(t,c,c.device)&&a.push({userId:Nt().px.id,present:!0});const d=[...co(a).reverse(),...co(l).reverse()],u=function(e){return e??ro}(i)-1;return{visibleUsers:d.slice(0,u),hiddenUsers:d.slice(u),totalCount:s,hasMore:Boolean(null==o?void 0:o.state.hasMore)}}),[o,n,c,i,t],{useDeepEqual:!0}),{visibleUsers:g,hiddenUsers:f,hiddenUsersCount:h,hasMoreHiddenUsers:v,isEveryUserStoreReady:y}=(0,s().K8)((()=>{if(!m)return{};const{visibleUsers:e=[],hiddenUsers:o=[]}=p??{},n=[m,...e.map((e=>e.userId)),...o.map((e=>e.userId))].map((e=>uo(e,t)));return{visibleUsers:e,hiddenUsers:o,hiddenUsersCount:Number(null==p?void 0:p.totalCount)-e.length,hasMoreHiddenUsers:Boolean(null==p?void 0:p.hasMore),isEveryUserStoreReady:n.every((e=>e.isReady()||(0,ht().MF)(e.id)))}}),[m,p,t]),S=(0,s().O$)(io().b),b=(0,eo().useIsDictatingToPage)(t),x=!(0,s().O$)(no().e),C=(0,a().IS)((e=>({presenceContainer:{...(0,to().g)({noDrag:c.device.isElectron&&!S}),display:"flex",gap:d?12:4,alignItems:"center",position:"relative",...qt().Of,width:"fit-content",padding:lo,borderRadius:18,transform:"translateZ(0)",...u.isMobile?{...qt().ZR,padding:"1px 4px"}:{}},totalCount:{color:e.text.secondary,fontSize:13,marginRight:8},avatarsContainer:{display:"flex",flexDirection:"row-reverse",alignItems:"center"},eyeIcon:{color:e.text.secondary}})),[c.device.isElectron,S,d,u.isMobile]);if(!m||!p||!y||x)return null;if(0===g.length&&0===f.length)return b?(0,rt.jsx)("div",{style:C.presenceContainer,children:(0,rt.jsx)(Qt().hq,{enableClickToScroll:!0,rootStore:t})}):null;if(!d)return(0,rt.jsxs)("div",{style:C.presenceContainer,children:[(0,rt.jsx)(ee().Q,{style:C.eyeIcon,iconGroup:Ht,variantName:"small"}),(0,rt.jsx)("span",{style:C.totalCount,children:p.totalCount})]});const I=[...g];return I.reverse(),(0,rt.jsx)(qe().A,{disableTooltip:!(null==p||!p.totalCount)&&p.totalCount<5,allowHover:!0,originGap:7,renderTooltip:e=>(0,rt.jsx)(fo,{hiddenUsers:f,hiddenUsersCount:h,hasMore:v,rootStore:t,events:e}),render:e=>(0,rt.jsxs)(Jt().A,{style:C.presenceContainer,children:[(0,rt.jsxs)("div",{style:C.avatarsContainer,children:[I.map((e=>(0,rt.jsx)(vo,{userData:e,rootStore:t},e.userId))),!l&&(0,rt.jsxs)(rt.Fragment,{children:[(0,rt.jsx)(vo,{rootStore:t,userData:{userId:m,present:!0}}),(0,rt.jsx)(Qt().hq,{enableClickToScroll:!0,rootStore:t})]})]}),(0,rt.jsx)("div",{style:C.totalCount,...e,children:null==p?void 0:p.totalCount})]})})}},403315:(e,t,o)=>{o.d(t,{a:()=>n});const n=(0,o(340498).xh)("checkmark",{default:{loader:()=>o.e(96772).then(o.bind(o,29037))},small:{loader:()=>o.e(96772).then(o.bind(o,349679))},fill:{loader:()=>o.e(96772).then(o.bind(o,94701))},fillSmall:{loader:()=>o.e(96772).then(o.bind(o,73956))}},["check","tick","confirm","approve","success"])},403733:(e,t,o)=>{o.d(t,{g:()=>i});o(296540);const n={viewBox:"0 0 16 16",svg:(0,o(474848).jsx)("path",{d:"M8 2.125a.61.61 0 0 0-.625.599v9.017L4.122 8.488a.625.625 0 1 0-.884.884l4.32 4.32c.244.244.64.244.884 0l4.32-4.32a.625.625 0 0 0-.884-.884l-3.253 3.253V2.724A.61.61 0 0 0 8 2.125"})},i=(0,o(340498).wt)("arrowStraightDownSmall",n)},457190:(e,t,o)=>{o.d(t,{v:()=>a});var n=()=>o(835338),i=()=>o(848259),r=()=>o(246826),s=()=>o(751156);function a(e){const{environment:t,key:o,selectedKey:a,following:l,followSettings:d,navigableBlockId:c,userId:u,spaceId:m,from:p}=e;s().createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{r().vt({environment:e.environment,table:n().Cy,args:{following:l,followSettings:d,navigableBlockId:c,userId:u,spaceId:m},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),l?i().KN(t,{from:"page_updates"}):i().tm(t,{from:"page_updates"}),a!==o&&i().EV(t,{from:p,navigableBlockId:c,oldSetting:a,newSetting:o})}},484595:(e,t,o)=>{o.d(t,{A:()=>a,p:()=>r});var n=o(296540),i=o(474848);const r=8;function s(e,t){let{isSelected:n}=e;const{radioButtonStyle:s,dotStyle:a}=(0,o(401497).IS)((e=>({radioButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,borderRadius:16,marginRight:r,background:n?e.blueColor:e.whiteButtonBackground,border:n?"none":`1px solid ${e.radioButtonBorder}`,transition:"background 100ms ease-out"},dotStyle:{width:6,height:6,borderRadius:6,background:e.text.contrastPrimary,transition:"opacity 100ms ease-out",opacity:n?1:0}})),[n]);return(0,i.jsx)("div",{ref:t,style:s,children:(0,i.jsx)("div",{style:a})})}const a=n.forwardRef(s)},508398:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var n=()=>o(125565),i=o(474848);const r=function(e){const{type:t,emoji:r,customEmojiStore:s,text:a,deletedText:l,subText:d}=e,c=(0,o(847249).K8)((()=>"custom"===t&&s.isDefined()&&s.getAlive()),[s,t]),u=(0,o(401497).IS)((e=>({container:{alignItems:"center"},label:{color:e.text.contrastPrimary,fontWeight:o(284371).Wy.medium,textAlign:"center",overflowWrap:"anywhere"},emojiContainer:{background:"white",borderRadius:4,padding:4,display:"flex",lineHeight:1,marginTop:2}})),[]);return(0,i.jsxs)(o(21140).wt,{gap:4,style:u.container,children:["custom"===t&&c?(0,i.jsx)("div",{style:u.emojiContainer,children:(0,i.jsx)(o(448664).A,{emojiStore:s,size:40})}):"unicode"===t?(0,i.jsx)("div",{style:u.emojiContainer,children:(0,i.jsx)(o(56086).A,{size:40,char:r})}):null,(0,i.jsx)(n().A,{isSmall:!0,isMultiline:!0,style:u.label,children:"unicode"===t||c?a:l}),d&&(0,i.jsx)(n().A,{isSmall:!0,isMultiline:!0,style:u.label,children:d})]})}},518773:(e,t,o)=>{o.d(t,{A:()=>r});var n=()=>o(835338),i=()=>o(534177);function r(e,t){switch(e){case"all":return{following:!0,followSettings:{...(0,n().JY)({explicitly_set_by_user:!0}),feed_setting:t}};case"important":return{following:!0,followSettings:{...(0,n().gK)({explicitly_set_by_user:!0}),feed_setting:t}};case"comments":return{following:!0,followSettings:{...(0,n().lx)({explicitly_set_by_user:!0}),feed_setting:t}};case"none":return{following:!1,followSettings:{...(0,n().gU)({explicitly_set_by_user:!0}),feed_setting:t}};default:(0,i().HB)(e)}}},645099:(e,t,o)=>{o.d(t,{LA:()=>C,jJ:()=>I});o(296540);var n=()=>o(484714),i=()=>o(847249),r=()=>o(401497),s=()=>o(584262),a=()=>o(403733),l=()=>o(340498),d=()=>o(959013),c=()=>o(124311),u=()=>o(114641),m=()=>o(857783),p=()=>o(778417),g=()=>o(186445),f=()=>o(325383),h=()=>o(753199),v=()=>o(704152),y=()=>o(331542),S=()=>o(316369),b=o(474848);const x=30,C=33;function I(e){const{style:t,iconStyle:o,store:C,format:I,collectionContextStore:w,groupsPointer:M,incrementLimitsInRelatedGroups:k,isFullScreen:j}=e,T=(0,n().v3)(),A=(0,i().K8)((()=>w.groupsStore.getGroupState(M)),[w,M]),P=(0,i().K8)((()=>(0,f().Kk)({collectionContextStore:w,groupsPointer:M})),[w,M]),_=(0,i().O$)(w.isInHomeWidgetStore),R=(0,r().IS)((e=>({homeContainer:{display:"flex",alignItems:"center",justifyContent:"center"},button:{display:"flex",alignItems:"center",justifyContent:"center",height:x,borderRadius:6,whiteSpace:"break-spaces",fontSize:14,..._?{textAlign:"center",width:"fit-content",marginLeft:12,marginBottom:0,padding:4}:{},...t},loadingContainer:{marginTop:1,marginLeft:8,marginRight:8},icon:{width:l().Ev.sm,height:l().Ev.sm,marginRight:6,fill:e.icon.tertiary,...o},text:{color:e.text.tertiary,width:"100%",fontSize:_?14:void 0},hoveredStyle:{...P?{background:e.whiteButtonBackground}:{background:e.tableRowHoveredBackground}}})),[_,t,P,o]),B=(0,i().K8)((()=>C.canEdit()),[C]);return A?_?(0,b.jsx)("div",{style:R.homeContainer,children:(0,b.jsx)(v().A,{onClick:e=>function(e,t,o){const n=e.metaKey||e.ctrlKey?"tab":void 0,i=(0,g().sj)(o.id)?s().y8.PersonalHomeTileTasks:s().y8.PersonalHomeTileCustomDb;m().uK({environment:t,store:o,pageVisitSource:i,openInNew:n})}(e,T,C),onMouseDown:h().tr,style:R.button,children:(0,b.jsx)("div",{style:R.text,children:(0,b.jsx)(d().sA,{id:"database.viewAllButtonTitle",defaultMessage:"View all"})})})}):(0,b.jsxs)(v().A,{onClick:e=>function(e,t,o,n,i,r){const s=o.groupsStore.getGroupState(n);if(!s)return;const a=s.reducerResultStore.state;(0,h().kV)(e),p().IU({environment:t}),a&&(0,u().H)({collectionContextStore:o,environment:t,incrementLimitArgs:{isFullScreen:r,currentResultCount:a.blockIds.length,groupsPointer:s.groupsPointer,incrementLimitsInRelatedGroups:i}});(0,c().K)(t)}(e,T,w,M,k,j),onMouseDown:h().tr,disabled:P,hoveredStyle:R.hoveredStyle,style:R.button,children:[(0,a().g)(R.icon),(0,b.jsx)("div",{style:R.text,children:(0,b.jsx)(d().sA,{id:"database.loadMoreButtonTitle",defaultMessage:"Load more"})}),P?(0,b.jsx)("div",{style:R.loadingContainer,children:(0,b.jsx)(y().A,{size:"sm"})}):B&&(0,b.jsx)(S().w,{collectionContextStore:w,format:I})]}):null}},668577:(e,t,o)=>{o.d(t,{Z:()=>n,o:()=>r});const n=100;class i extends(()=>o(757695))().default{getInitialState(){return{stores:{}}}getStore(e){if(e)return this.state.stores[e]||(this.state.stores[e]=new(o(178624).R)({key:`emojiFrecency:${e}`,namespace:o(419494).Bq,important:!0,trackingType:"necessary"})),this.state.stores[e]}getEmojiFrecencyMap(){var e;const t=this.getStore(null===(e=o(351360).default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId());if(!t)return{};return t.state??{}}}const r=new i},683097:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(296540),i=()=>o(484714);function r(e){const t=(0,i().v3)(),{onLongPress:o,hapticsEnabled:r=!0,timeout:s=300}=e,a=(0,n.useCallback)((()=>{var e,n,i;r&&(null!==(e=t.mobileNative)&&void 0!==e&&e.buzz?t.mobileNative.buzz():null===(n=(i=window.navigator).vibrate)||void 0===n||n.call(i,20));o()}),[t.mobileNative,r,o]),l=(0,n.useRef)(),d=(0,n.useRef)(0),c=(0,n.useRef)(0),u=(0,n.useCallback)((()=>clearTimeout(l.current)),[]);(0,n.useEffect)((()=>u),[u]);return{onTouchStart:(0,n.useCallback)((()=>{clearTimeout(l.current),l.current=setTimeout(a,s)}),[s,a]),onTouchMove:(0,n.useCallback)((e=>{const t=e.touches[0].clientX,o=e.touches[0].clientY;(Math.abs(t-d.current)>50||Math.abs(o-c.current)>50)&&clearTimeout(l.current)}),[]),onTouchEnd:u,onTouchCancel:u}}},811879:(e,t,o)=>{o.d(t,{E:()=>p});o(296540);var n=()=>o(847249),i=()=>o(401497),r=()=>o(310442),s=()=>o(824862),a=()=>o(798880),l=()=>o(534177),d=()=>o(256863),c=()=>o(453697),u=()=>o(777092),m=o(474848);function p(e){let{authorStore:t,avatarSize:o,avatarStyle:p,hasTooltip:g=!0}=e;const f=(0,n().K8)((()=>(0,u().d5)(t)),[t]),h=(0,i().IS)((e=>({placeholder:{width:o,height:o,background:e.lightDividerColor,borderRadius:o/2,flexShrink:0,...p}})),[o,p]);return f.asActor?f.table===a().oo?(0,m.jsx)(c().A,{hasTooltip:g,userValue:f.asActor,style:p,size:o,avatarShouldShowShadow:!1}):f.table===s().GP?(0,m.jsx)(d().A,{botValue:f,size:o,style:p}):f.table===r().yj?(0,m.jsx)("div",{style:h.placeholder}):void(0,l().HB)(f):(0,m.jsx)("div",{style:h.placeholder})}},824160:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(484714),i=()=>o(401497),r=()=>o(704152),s=o(474848);function a(e){const t=(0,n().Y0)(),o=(0,i().IS)((e=>({sharedStyle:{display:"flex",alignItems:"center",borderRadius:4},innerStyle:{padding:"2px 6px",borderRadius:4,color:e.text.secondary,background:e.defaultBadgeBackground,fontSize:t.isMobile?11:9,lineHeight:t.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[t.isAndroid,t.isMobile]);return t.isMobile?(0,s.jsx)(r().A,{style:{...o.sharedStyle,...e.mobileStyle},disabled:void 0===e.onClick,children:(0,s.jsx)("div",{style:{...o.innerStyle,...e.innerStyle},children:e.children})}):(0,s.jsx)(r().A,{style:{...o.sharedStyle,...e.desktopStyle},disabled:void 0===e.onClick,...e,children:(0,s.jsx)("div",{style:{...o.innerStyle,...e.innerStyle},children:e.children})})}},987017:(e,t,o)=>{o.d(t,{Ay:()=>d,Jy:()=>l,vU:()=>a});o(581454);var n=o(296540),i=()=>o(722872),r=o(474848);function s(e){let{tabs:t,selectedIndex:s,onChange:d,separatorIndexes:c,right:u,style:m,rightStyle:p,tabStyle:g,tabTitleStyle:f,selectedTabTitleStyle:h,tabBorderStyle:v,selectedTabStyle:y,readOnly:S,hideTabBorder:b,idPrefix:x,hideTabIndexes:C}=e;const I=(0,n.useContext)(i().xu),{device:w,WindowSizeStore:M}=(0,o(484714).v3)(),{safePaddingLeft:k,safePaddingRight:j}=(0,o(847249).K8)((()=>({safePaddingLeft:M.getSafePaddingLeftCSS(16),safePaddingRight:M.getSafePaddingRightCSS(16)})),[M]),T=(0,o(401497).IS)((e=>{const t={paddingTop:6,paddingBottom:6,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.text.secondary,...g},o=`inset 0 -1px 0 ${e.regularDividerColor}`,n=I.menuType===i().gu.Popup,r={fontSize:16,paddingTop:2,paddingLeft:n?16:k,paddingRight:n?16:j,zIndex:2,height:44,background:e.popoverBackground};return{container:{overflowY:"visible",overflowX:"auto",display:"flex",width:"100%",position:"relative",boxShadow:b?void 0:o,...w.isMobile?r:{fontSize:14,paddingLeft:8,paddingRight:8,zIndex:1},...m},separator:{display:"inline-flex",alignItems:"center",margin:"0 4px",paddingBottom:4,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.regularDividerColor},tab:t,selectedTab:{...t,position:"relative",color:e.text.primary,...y},border:{borderBottom:`2px solid ${e.text.primary}`,position:"absolute",bottom:0,left:8,right:8,...v},rightContainer:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"flex-end",color:e.text.secondary,...p}}}),[I.menuType,w.isMobile,p,k,j,y,m,v,g,b]);return(0,r.jsxs)("div",{className:"hide-scrollbar",style:T.container,role:"tablist",children:[t.map(((e,t)=>{if(null!=C&&C.includes(t))return null;const i=t===s;return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsxs)("div",{style:i?T.selectedTab:T.tab,children:[(0,r.jsx)(o(493823).p,{style:{...f,...i?h:{}},onClick:()=>d(t),disabled:S,mobileFeedback:w.isMobile,isLightGray:!Boolean(i),role:"tab","aria-selected":i,id:a(x,t),"aria-controls":l(x,t),children:e}),i&&(0,r.jsx)("div",{style:T.border})]},`tabButton-${t}`),c&&c.includes(t)&&(0,r.jsx)("div",{style:T.separator,className:"notranslate",children:"|"},`${t}-separator`)]},t)})),u&&(0,r.jsx)("div",{style:T.rightContainer,children:u})]})}function a(e,t){if(e)return`${e}-tab-${t}`}function l(e,t){if(e)return`${e}-tabpanel-${t}`}const d=n.memo(s)}}]);