"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[41870],{46657:(e,t,n)=>{n.d(t,{W:()=>a});class s extends(()=>n(757695))().default{getInitialState(){return{currentScreen:"none",status:"not_started",sessionId:n(206267).JW(),analyticsFrom:"unknown",authUrl:void 0,isConnected:!1,isDisconnecting:!1,isLoaded:!1}}}const a=new s},92383:(e,t,n)=>{n.d(t,{E:()=>i,F:()=>a});var s=()=>n(206267);function a(){return{currentScreen:"none",selection:{allSelected:!0,selectedDrives:[],excludedDrives:[],ingestNewDrives:!0},status:"not_started",sessionId:s().JW(),analyticsFrom:"unknown",authUrl:void 0,isConnected:!1,isPersonalAuthComplete:!1,isDisconnecting:!1,isSyncComplete:!1,isLoaded:!1,connectionDetails:void 0}}class o extends(()=>n(757695))().default{getInitialState(){return a()}}const i=new o;(0,n(604341).exposeDebugValue)("sharepointAiConnectorStore",i)},229533:(e,t,n)=>{n.d(t,{$t:()=>S,G9:()=>p,HF:()=>f,LT:()=>m,_1:()=>g});n(18107),n(944114),n(967357);var s=()=>n(534177),a=()=>n(634877),o=()=>n(174636),i=()=>n(291075),r=()=>n(963702),c=()=>n(92383),d=()=>n(508496),l=()=>n(756315),u=()=>n(99254);const g=["slack_select_channels","slack_re_auth","github_re_auth","jira_connection_pending","sharepoint_select_sites"];function p(e,t){const n=[];if("slack"===e){const{noChannelsSelected:e,ingestionProgress:s,canQuery:a,isSyncCompleted:i,isSlackGridAiConnectorEnabled:r}=o().R.state;e&&void 0===s&&t&&n.push({type:"slack_select_channels"}),r||!i||void 0!==s||a||n.push({type:"slack_re_auth"})}else if("google_drive"===e);else if("jira"===e){const{jiraSyncState:e}=u().y.state;d().default.checkGate({gateName:"install_from_jira_marketplace"})&&"pending_connection"===e&&n.push({type:"jira_connection_pending"})}else if("sharepoint"===e){const{connectionDetails:e}=c().E.state;"pending_selection"===(null==e?void 0:e.status)&&n.push({type:"sharepoint_select_sites"})}else if("microsoftTeams"===e);else if("gmail"===e);else if("linear"===e);else{if("github"!==e)return(0,s().HB)(e);{const{githubOrg:e,isPersonalAuthComplete:t,isDisconnecting:s,forceShowGithubAuthNotificationTriggeredAt:a}=i().o.state;(a||null!=e&&e.isSyncComplete&&!t&&!s)&&n.push({type:"github_re_auth"})}}return n}function m(e){if("slack"===e){const{inProgress:e,ingestionProgress:t,isSlackGridAiConnectorEnabled:n}=o().R.state;return n?{isInProgress:!1}:e?{isInProgress:!0,ingestionProgress:t??0}:{isInProgress:!1}}if("google_drive"===e){const{ingestionProgress:e}=l().d.state;return void 0!==e?{isInProgress:!0,ingestionProgress:e}:{isInProgress:!1}}if("github"===e){const{status:e}=i().o.state;return"in_progress"===e?{isInProgress:!0,ingestionProgress:void 0}:{isInProgress:!1}}if("jira"===e){const{jiraSyncState:e,jiraSyncProgress:t}=u().y.state;return"in_progress"===e||"editing"===e?{isInProgress:!0,ingestionProgress:t}:{isInProgress:!1}}if("sharepoint"===e){const{connectionDetails:e}=c().E.state;return"in_progress"===(null==e?void 0:e.status)?{isInProgress:!0,ingestionProgress:null==e?void 0:e.progress}:{isInProgress:!1}}if("microsoftTeams"===e){const{connectionStatus:e,syncProgressPercentage:t}=r().F.state;return"in_progress"===e?{isInProgress:!0,ingestionProgress:t}:{isInProgress:!1}}return"gmail"===e||"linear"===e?{isInProgress:!1}:(0,s().HB)(e)}function S(e){if("sharepoint"===e){const{connectionDetails:e}=c().E.state;return"disconnecting"===(null==e?void 0:e.status)}return Boolean(a().NT[e].state.isDisconnecting)}function f(e,t){const n=p(e,t).at(0);if(n)return{type:"action_required",action:n.type};const s=m(e);return s.isInProgress?{type:"in_progress",ingestionProgress:s.ingestionProgress}:S(e)?{type:"disconnecting"}:{type:"connected"}}},235195:(e,t,n)=>{n.d(t,{A:()=>o});class s extends(()=>n(757695))().default{getInitialState(){return{connectorTriggeringUpsell:void 0,upsellTriggeredAt:void 0,appsConnectionData:[]}}updateAppsConnectionData(e){this.setState({...this.state,appsConnectionData:e})}}const a=new s;(0,n(604341).exposeDebugValue)("aiConnectorsStore",a);const o=a},295118:(e,t,n)=>{n.d(t,{Wh:()=>f,ZC:()=>S,jx:()=>h});n(16280);var s=()=>n(972261),a=()=>n(763824),o=()=>n(534177),i=()=>n(174636),r=()=>n(291075),c=()=>n(771624),d=()=>n(963702),l=()=>n(92383),u=()=>n(351360),g=()=>n(756315),p=()=>n(99254),m=()=>n(751156);const S=new(n(178624).R)({key:"use_mock_connector_status",namespace:n(419494).cd,important:!1,trackingType:"preference"});function f(e,t,n){const s=u().default.state.currentSpaceViewStore;s&&m().createAndCommit({userAction:"mockConnectorStatusActions.setDebuggingConnectorStatus",environment:e,canUndo:!1,perform:e=>{s&&m().applyOperation({store:s,operation:{pointer:s.pointer,path:["settings"],command:"update",args:{...s.getSettings(),dismissed_slack_personal_auth_prompt:!1,dismissed_github_personal_auth_prompt:!1}},transaction:e})}}),"slack"===t?M(t,n)&&i().R.setState(y[n]):"google_drive"===t?M(t,n)&&g().d.setState(I[n]):"github"===t?M(t,n)&&r().o.setState(b[n]):"jira"===t?M(t,n)&&p().y.setState(T[n]):"sharepoint"===t?M(t,n)&&l().E.setState(j[n]):"microsoftTeams"===t?M(t,n)&&d().F.setState(k[n]):"gmail"===t?M(t,n)&&c().X.setState(P[n]):"linear"===t||(0,o().HB)(t)}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500;for(const n of Object.values(s().fl))for(const s of Object.keys(F[n]))console.log("Setting mock connector status for",n,s),f(e,n,s),await(0,a().wR)(t)}const v=(0,i().Q)(),y={not_connected:v,no_channels_selected:{...v,noChannelsSelected:!0},cant_query_connection:{...v,canQuery:!1,isSyncCompleted:!0},in_progress:{...v,inProgress:!0,isSyncCompleted:!1,ingestionProgress:50},disconnecting:{...v,isSyncCompleted:!0,inProgress:!1,connectedApps:["slack-admin"],isDisconnecting:!0},connected:{...v,isSyncCompleted:!0,inProgress:!1,connectedApps:["slack-admin"]}},_=(0,g().s)(),I={not_connected:{..._},in_progress:{..._,initialSyncState:"in_progress",syncProgress:"initial_file_sync_in_progress",syncCurrent:50,syncTotal:100,ingestionProgress:50},disconnecting:{..._,syncProgress:"completed",initialSyncState:"completed",isDisconnecting:!0},connected:{..._,syncProgress:"completed",initialSyncState:"completed"}},A=(0,r().F)(),b={not_started:A,not_authenticated:{...A,isConnected:!0,isPersonalAuthComplete:!1,githubOrg:{id:1,installationId:1,isSyncComplete:!0,lastSyncedAt:1,name:"Test Org"}},in_progress:{...A,status:"in_progress"},disconnecting:{...A,isPersonalAuthComplete:!0,isConnected:!0,isDisconnecting:!0},connected:{...A,isPersonalAuthComplete:!0,isConnected:!0}},C=(0,p().L)(),T={not_started:{...C},in_progress:{...C,jiraSyncState:"in_progress",jiraSyncProgress:50},disconnecting:{...C,jiraSyncState:"completed",isDisconnecting:!0},connected:{...C,jiraSyncState:"completed"}},D=(0,d().G)(),k={not_started:D,in_progress:{...D,connectionStatus:"in_progress",syncProgressPercentage:50},disconnecting:{...D,connectionStatus:"completed",isDisconnecting:!0},connected:{...D,connectionStatus:"completed"}},w=(0,l().F)(),j={not_started:w,in_progress:{...w,connectionDetails:{status:"in_progress",progress:50}},disconnecting:{...w,isConnected:!0,connectionDetails:{status:"completed",progress:100},isDisconnecting:!0},connected:{...w,isConnected:!0,connectionDetails:{status:"completed",progress:100}}},P={not_started:(0,c().A)()},N=n(46657).W.getInitialState(),F={slack:y,google_drive:I,github:b,jira:T,sharepoint:j,microsoftTeams:k,gmail:P,linear:{not_started:N}};function M(e,t){const n=F[e];if(!(0,o().O)(n,t))throw new Error(`Invalid status: ${t}, valid statuses are: ${Object.keys(n).join(", ")}`);return t}},453202:(e,t,n)=>{n.d(t,{O:()=>a});class s extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const a=new s;(0,n(604341).exposeDebugValue)("AssistantConnectorProgressModalStore",a)},460383:(e,t,n)=>{n.d(t,{i:()=>s});const s=(0,n(340498).xh)("sharePoint",{default:{loader:()=>n.e(9280).then(n.bind(n,411737))},darkMode:{loader:()=>n.e(9280).then(n.bind(n,782863))}})},474998:(e,t,n)=>{n.d(t,{l:()=>s});const s=(0,n(340498).xh)("gmail",{default:{loader:()=>n.e(78389).then(n.bind(n,407444))},darkMode:{loader:()=>n.e(78389).then(n.bind(n,797632))}})},576590:(e,t,n)=>{n.r(t),n.d(t,{connectSpaceToJiraSite:()=>me,disconnectConnector:()=>pe,getGithubStatus:()=>z,getJiraAIConnectionStatusAction:()=>q,getJiraSyncControlAction:()=>$,getLinearConnectorStatus:()=>ge,getMicrosoftTeamsAIConnectorStatusAction:()=>se,getMicrosoftTeamsSyncControlsAction:()=>ae,getMicrosoftTeamsTeamsAction:()=>oe,getSharepointConnectorStatus:()=>le,navigateToAIConnectorOnboarding:()=>L,navigateToAIConnectorSettingsScreen:()=>x,navigateToGithubAIConnectorOnboarding:()=>J,navigateToGmailAIConnectorOnboarding:()=>G,navigateToGoogleDriveUniversalScreen:()=>F,navigateToJiraUniversalScreen:()=>M,navigateToLinearAIConnectorOnboarding:()=>W,navigateToLinearUniversalScreen:()=>ue,navigateToMicrosoftTeamsUniversalScreen:()=>U,navigateToSharepointAIConnectorOnboarding:()=>E,navigateToSharepointUniversalScreen:()=>de,navigateToSlackUniversalQnAOnboarding:()=>N,openConnectorInProgressModal:()=>te,resetAiConnectorStatus:()=>R,resetAllAiConnectors:()=>B,setAssistantOnboardingPhase:()=>w,setLastExposedToQnaAtToCurrentTimestamp:()=>j,setLastUsedAIWriterAtToCurrentTimestamp:()=>P,setMicrosoftTeamsSyncControlsAction:()=>ie,setQnaOnboardingPhase:()=>k,startJiraBulkIngestionAction:()=>Z,startJiraEditFlow:()=>Y,startMicrosoftTeamsBulkIngestionAction:()=>re,updateGithubAIConnectorStatus:()=>X,updateGmailAIConnectorStatus:()=>H,updateGoogleDriveQnAConnectionState:()=>ee,updateJiraAIConnectionStatus:()=>V,updateLinearAIConnectorStatus:()=>K,updateMicrosoftTeamsAIConnectorStatusAction:()=>ne,updateSharepointAiConnectorStatus:()=>ce,updateSlackQnAConnectionState:()=>Q});n(898992),n(354520),n(672577),n(803949),n(581454),n(737550);var s=()=>n(972261),a=()=>n(206267),o=()=>n(386164),i=()=>n(534177),r=()=>n(449506),c=()=>n(436572),d=()=>n(751156),l=()=>n(755199),u=()=>n(140022),g=()=>n(604018),p=()=>n(235195),m=()=>n(174636),S=()=>n(972435),f=()=>n(291075),h=()=>n(771624),v=()=>n(46657),y=()=>n(963702),_=()=>n(92383),I=()=>n(351360),A=()=>n(453202),b=()=>n(756315),C=()=>n(99254),T=()=>n(987267),D=()=>n(634877);function k(e,t){const{phase:n,transactionUserAction:s,userSettingsStore:a}=t;d().createAndCommit({environment:e,userAction:s,canUndo:!0,perform:e=>{l().mJ({userSettingsStore:a,transaction:e,data:{ai_qna_intro_onboarding_phase:n}})}})}function w(e,t){const{phase:n,transactionUserAction:s,userSettingsStore:a}=t;d().createAndCommit({environment:e,userAction:s,canUndo:!0,perform:e=>{l().mJ({userSettingsStore:a,transaction:e,data:{ai_assistant_onboarding_phase:n,ai_assistant_onboarding_phase_last_set_at:Date.now()}})}})}function j(e,t){const{userSettingsStore:n}=t;d().createAndCommit({environment:e,userAction:"aiQnaActions.setLastExposedToQnaAtToCurrentTimestamp",canUndo:!0,perform:e=>{l().mJ({userSettingsStore:n,transaction:e,data:{last_exposed_to_ai_qna_at:Date.now()}})}})}function P(e,t){const{userSettingsStore:n}=t;d().createAndCommit({environment:e,userAction:"aiQnaActions.setLastUsedAIWriterAtToCurrentTimestamp",canUndo:!0,perform:e=>{l().mJ({userSettingsStore:n,transaction:e,data:{last_used_ai_writer_at:Date.now()}})}})}function N(e){const{analyticsFrom:t}=e,n=e.sessionId??a().JW();m().R.setState({...m().R.state,currentScreen:"introduction",analyticsFrom:t,sessionId:n})}function F(e){const{screenToShow:t,analyticsFrom:n}=e,s=e.sessionId??a().JW();b().d.setState({...b().d.state,analyticsFrom:n,sessionId:s,currentScreen:t})}function M(e){const{analyticsFrom:t,screenToShow:n}=e,s=e.sessionId??a().JW();C().y.setState({...C().y.state,analyticsFrom:t,currentScreen:n,sessionId:s})}function U(e){const{currentScreen:t,analyticsFrom:n,sessionId:s}=e;y().F.setState({...y().F.state,currentScreen:t,analyticsFrom:n??y().F.state.analyticsFrom,sessionId:s??y().F.state.sessionId})}function x(e){const{connector:t,...n}=e;"slack"===t?m().R.setState({...m().R.state,...n,currentScreen:"settings"}):"jira"===t?M({...n,screenToShow:"settings_screen"}):"google_drive"===t?F({...n,screenToShow:"settings_screen"}):"github"===t?f().o.setState({...f().o.state,...n,currentScreen:"settings"}):"gmail"===t?h().X.setState({...h().X.state,...n,currentScreen:"settings_screen"}):"sharepoint"===t?_().E.setState({..._().E.state,...n,currentScreen:"settings"}):"microsoftTeams"===t?y().F.setState({...y().F.state,...n,currentScreen:"settings_screen"}):"linear"===t?v().W.setState({...v().W.state,...n,currentScreen:"settings"}):(0,i().HB)(t)}function L(e){const{connector:t,...n}=e;if("slack"===t)N(n);else if("jira"===t){const e=C().y.state;if("not_started"===e.jiraSyncState)M({...n,screenToShow:"info_screen"});else if("pending_connection"===e.jiraSyncState)M({...n,screenToShow:"connection_pending_screen"});else{if("pending_selection"!==e.jiraSyncState)return;M({...n,screenToShow:"connection_complete_screen"})}}else if("google_drive"===t){"not_started"===b().d.state.initialSyncState&&F({...n,screenToShow:"info_screen"})}else if("github"===t)J(n);else if("gmail"===t)G(n);else if("sharepoint"===t)E(n);else if("microsoftTeams"===t){if(["not_started","pending_selection"].includes(y().F.state.connectionStatus))return void U({...n,currentScreen:"not_started"===y().F.state.connectionStatus?"info_screen":"connection_complete_screen"})}else{if("linear"===t)return void W(n);(0,i().HB)(t)}}function E(e){_().E.setState({..._().E.state,currentScreen:"introduction"})}function W(e){v().W.setState({...v().W.state,currentScreen:"introduction"})}function G(e){const{analyticsFrom:t}=e,n=e.sessionId??a().JW();h().X.setState({...h().X.state,currentScreen:"info_screen",analyticsFrom:t,sessionId:n})}function J(e){const{analyticsFrom:t}=e,n=e.sessionId??a().JW();f().o.setState({...f().o.state,currentScreen:"introduction",analyticsFrom:t,sessionId:n})}const O={slack:()=>m().R.reset(),google_drive:()=>b().d.reset(),jira:()=>C().y.reset(),github:()=>f().o.reset(),sharepoint:()=>_().E.reset(),microsoftTeams:()=>y().F.reset(),gmail:()=>h().X.reset(),linear:()=>v().W.reset()};function R(e){(0,O[e])()}function B(){Object.values(O).forEach((e=>e()))}async function Q(e){const{environment:t,spaceId:n}=e;let s=!1;const a=await r().callApi({eventName:"getSlackBulkIngestionStatus",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});"success"===a.type?m().R.setState({...m().R.state,...a.data,ingestionProgress:a.data.isPublicSync?a.data.ingestionProgress||1:void 0}):s=!0;const i=await r().callApi({eventName:"canUserQuerySlack",environment:t,data:{spaceId:n}});"success"===i.type?m().R.setState({...m().R.state,canQuery:i.data.canQuery}):s=!0;const c=await r().callApi({eventName:"getConnectedAppsForUniversalQna",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});return"success"===c.type?(m().R.setState({...m().R.state,connectedApps:c.data.connectedApps,isLoaded:!0}),p().A.updateAppsConnectionData(c.data.appsData??[])):s=!0,{status:s?"failed":"success"}}function z(e){var t;return null!==(t=e.githubOrg)&&void 0!==t&&t.isSyncComplete?"completed":e.isConnected?"in_progress":"not_started"}async function X(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"getGithubAIConnectorStatus",environment:t,data:{spaceId:n}});return"success"!==s.type?{status:"failed"}:(f().o.setState({...f().o.state,status:z(s.data),isConnected:s.data.isConnected,githubOrg:s.data.githubOrg,isPersonalAuthComplete:s.data.isPersonalAuthComplete,isDisconnecting:s.data.isDisconnecting,isLoaded:!0}),{status:"success"})}async function H(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"getConnectedAppsForUniversalQna",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});if("success"!==s.type)return{status:"failed"};const a=s.data.connectedApps.includes("gmail-individual")||s.data.connectedApps.includes("gmail-workspace");return h().X.setState({...h().X.state,status:a?"authenticated":"not_started",isConnected:a,isPersonalAuthComplete:a,isLoaded:!0}),{status:"success"}}async function K(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"listAIConnectors",environment:t,data:{spaceId:n}});if("success"!==s.type)return{status:"failed"};const a=s.data.connectedConnectors.some((e=>"linear"===e.id));return v().W.setState({...v().W.state,status:a?"completed":"not_started",isConnected:a,isLoaded:!0}),{status:"success"}}async function V(e){return q(e).then((e=>e?{status:"success"}:{status:"failed"}))}async function q(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"getJiraAIConnectionStatus",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});if("success"===s.type)return C().y.setState({...C().y.state,jiraSiteId:s.data.jiraSiteId??"",jiraSyncState:s.data.connectionState.status,jiraSyncProgress:s.data.connectionState.percentageComplete,jiraSiteUrl:s.data.jiraSiteUrl??"",isDisconnecting:"disconnecting"===s.data.connectionState.status,isLoaded:!0}),s.data}async function $(e){const{environment:t,spaceId:n,jiraSiteId:s}=e,a=await r().callApi({eventName:"getSyncControlsForJiraConnector",environment:t,data:{spaceId:n,jiraSiteId:s}});if("success"===a.type)return C().y.setState({...C().y.state,syncControl:a.data.syncControl}),a}async function Z(e){const{environment:t,spaceId:n,jiraSiteId:s,sessionId:a,exclusionList:o,inclusionList:i}=e,d=await r().callApi({eventName:"startJiraBulkIngestion",environment:t,data:{spaceId:n,jiraSiteId:s,sessionId:a,exclusionList:o,inclusionList:i}});if("success"===d.type)return c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Jira sync started. This can take up to 36 hours.",id:"jira.sync.started"}),position:"bottom"}),C().y.setState({...C().y.state,jiraSyncState:"in_progress",jiraSyncProgress:1}),d;c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Something went wrong. Please try again.",id:"jira.sync.failed"}),position:"bottom"})}async function Y(e){const{environment:t,spaceId:n,jiraSiteId:s,exclusionList:a,inclusionList:o}=e,i=await r().callApi({eventName:"startJiraEditBulkIngestion",environment:t,data:{spaceId:n,jiraSiteId:s,inclusionList:o,exclusionList:a}});if("success"===i.type)return i.data.patchSuccess?(C().y.setState({...C().y.state,jiraSyncState:"editing",jiraSyncProgress:100}),c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Project sync list updated, sync started in background.",id:"jira.edit.success"}),position:"bottom"})):c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"No changes were detected.",id:"jira.edit.noChanges"}),position:"bottom"}),i;c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Something went wrong. Please try again.",id:"jira.edit.failed"}),position:"bottom"})}async function ee(e){const{environment:t,spaceId:n,showSnackbarOnError:s}=e,a=await r().callApi({eventName:"getGoogleDriveSyncProgress",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});return"success"!==a.type?s?a.status>=400&&a.status<500?((0,D().Rl)(),{status:"failed"}):((0,D().NK)(),{status:"failed"}):{status:"failed"}:(b().d.setState({...b().d.state,initialSyncState:(0,g().HB)(a.data.status),isDisconnecting:"disconnecting"===a.data.status,isEditing:"editing"===a.data.status,syncProgress:a.data.status,syncCurrent:a.data.current,syncTotal:a.data.total,ingestionProgress:a.data.ingestionProgress,isLoaded:!0}),{status:"success"})}function te(e){const{environment:t,connector:n,from:s}=e;A().O.setState({...A().O.state,open:!0,modal:"progress",connector:n}),(0,u().trackConnectorInProgressModalOpened)({environment:t,connector:n,from:s})}async function ne(e){return se(e).then((e=>e?{status:"success"}:{status:"failed"}))}async function se(e){const{environment:t,spaceId:n,sessionId:s=y().F.state.sessionId}=e,a=await r().callApi({eventName:"getMicrosoftTeamsAIConnectorStatus",environment:t,data:{spaceId:n,sessionId:s},headers:(0,o().WS)({spaceId:n})});if("success"!==a.type)return;const i=a.data;if("error"===i.status)return y().F.setState({...y().F.state,error:i}),y().F.getState();const{microsoftTenantId:c,connectionDetails:d}=i;return y().F.setState({...y().F.state,microsoftTenantId:c,connectionStatus:(null==d?void 0:d.status)??"not_started",syncProgressPercentage:(null==d?void 0:d.progress_percentage)??0,isLoaded:!0,isDisconnecting:"disconnecting"===(null==d?void 0:d.status),error:void 0}),y().F.getState()}async function ae(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"getMicrosoftTeamsSyncControls",environment:t,data:{spaceId:n},headers:(0,o().WS)({spaceId:n})});if("success"===s.type)return s.data}async function oe(e){const{environment:t,spaceId:n,cursor:s}=e,a=await r().callApi({eventName:"getMicrosoftTeamsTeams",environment:t,data:{spaceId:n,cursor:s}});if("success"===a.type)return a.data}async function ie(e){const{environment:t,spaceId:n,syncControls:s}=e,a=await r().callApi({eventName:"setMicrosoftTeamsSyncControls",environment:t,data:{spaceId:n,syncControls:s},headers:(0,o().WS)({spaceId:n})});if("success"===a.type)return a.data}async function re(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"startMicrosoftTeamsBulkIngestion",environment:t,data:{spaceId:n}});if("success"===s.type)return c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Microsoft Teams sync started. This can take up to 36 hours.",id:"microsoftTeams.sync.started"}),position:"bottom"}),await se({environment:t,spaceId:n}),s;c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Something went wrong. Please try again.",id:"microsoftTeams.sync.failed"}),position:"bottom"})}async function ce(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"listAIConnectors",environment:t,data:{spaceId:n}});if("success"!==s.type)return{status:"failed"};const a=s.data.connectedConnectors.find((e=>"sharepoint"===e.id));if(!a)return _().E.setState({..._().E.state,isConnected:!1,isLoaded:!0,connectionDetails:void 0}),{status:"success"};const o=null==a?void 0:a.details.connectionDetails;return _().E.setState({..._().E.state,isConnected:void 0!==a,isLoaded:!0,connectionDetails:{status:null==o?void 0:o.status,progress:null==o?void 0:o.progress}}),{status:"success"}}function de(e){const{currentScreen:t}=e;_().E.setState({..._().E.state,currentScreen:t})}async function le(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"listAIConnectors",environment:t,data:{spaceId:n}});if("success"!==s.type)return"not_started";const a=s.data.connectedConnectors.find((e=>"sharepoint"===e.id));if(!a)return"not_started";return a.details.connectionDetails.status}function ue(e){const{currentScreen:t}=e;v().W.setState({...v().W.state,currentScreen:t})}async function ge(e){const{environment:t,spaceId:n}=e,s=await r().callApi({eventName:"listAIConnectors",environment:t,data:{spaceId:n}});if("success"!==s.type)return"not_started";const a=s.data.connectedConnectors.find((e=>"linear"===e.id));if(!a)return"not_started";return a.details.connectionDetails.status}async function pe(e){const{connector:t,spaceId:n,environment:a,disconnectReason:o,showToast:d}=e;let l,u,g;if("google_drive"===t)l=await r().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:a,data:{spaceId:n,disconnectReason:o}}),u=s()._u,g=["google-drive"];else if("github"===t)l=await r().callApi({eventName:"disconnectGithub",environment:a,data:{spaceId:n}}),u=s().Fl,g=["github"];else if("gmail"===t)l=await r().callApi({eventName:"disconnectAiConnector",environment:a,data:{spaceId:n,connector:"gmail"}}),l={type:"success"},u=s().KI,g=["gmail-workspace"];else if("jira"===t)l=await r().callApi({eventName:"disconnectJiraConnector",environment:a,data:{spaceId:n,jiraSiteId:C().y.state.jiraSiteId}}),u=s().S,g=["jira"];else if("sharepoint"===t)l=await r().callApi({eventName:"disconnectAiConnector",environment:a,data:{spaceId:n,connector:"sharepoint"}}),u=s().fK,g=[];else if("microsoftTeams"===t)l=await r().callApi({eventName:"disconnectMicrosoftTeams",environment:a,data:{spaceId:n,microsoftTenantId:y().F.state.microsoftTenantId??""}}),u=s().lF,g=["microsoftTeams"];else if("slack"===t)l=await r().callApi({eventName:"disconnectSlackIngestion",environment:a,data:{spaceId:n,disconnectForWorkspace:!1}}),u=s().e5,g=["slack-admin"];else{if("linear"===t)return{type:"success"};(0,i().HB)(t)}const m=D().NT[t];m.setState({...m.state,isDisconnecting:!0});const f=p().A.state.appsConnectionData.filter((e=>e.id!==u));p().A.setState({...p().A.state,appsConnectionData:[...f,...g.map((e=>{var t,n;return{connectionStatus:"disconnecting",connectionLastEditedTimestamp:Date.now(),connectionType:e,connectorEmail:(null===(t=I().default.state.currentUserStore)||void 0===t?void 0:t.getEmail())||"",id:u,connectorNotionId:null===(n=I().default.state.currentUserStore)||void 0===n||null===(n=n.getModel())||void 0===n?void 0:n.id}}))]});const h=T().w0[t];if(d){const t=e.hoursOverride??"3",n={position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"}};"success"===l.type?c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"{displayName} disconnected. This can take up to {hours} hours.",id:"aiConnector.confirmation.disconnected"},{displayName:h,hours:t}),...n}):c().D6({label:S().A.getIntl().formatMessage({defaultMessage:"Failed to disconnect {displayName}. Please try again later.",id:"aiConnector.confirmation.disconnectError"},{displayName:h}),...n})}return l}async function me(e){const{environment:t,spaceId:n}=e,{currentSpaceViewStore:s}=I().default.getState();if(void 0===s)return!1;const a=await r().callApi({eventName:"connectJiraSiteToSpace",environment:t,data:{spaceId:n,siteId:C().y.state.jiraSiteId}});return!("success"!==a.type||!a.data.connectionSuccess)&&(C().y.setState({...C().y.state,currentScreen:"connection_complete_screen",jiraSiteId:a.data.siteData.siteId,jiraSiteUrl:a.data.siteData.siteUrl,jiraSyncState:"pending_selection"}),d().createAndCommit({userAction:"jiraAIConnector.onboarding.dismissPersonalAuthPrompt",environment:t,canUndo:!0,perform:e=>{d().applyOperation({store:s,operation:{pointer:s.pointer,path:["settings"],command:"update",args:{...s.getSettings(),dismissed_jira_installation_pending_prompt:null}},transaction:e})}}),!0)}},604018:(e,t,n)=>{n.d(t,{A7:()=>T,HB:()=>y,Nr:()=>I,XY:()=>_,bp:()=>D,kB:()=>A,uM:()=>C,wd:()=>b});n(898992),n(354520);var s=()=>n(484714),a=()=>n(847249),o=()=>n(972261),i=()=>n(534177),r=()=>n(229533),c=()=>n(291075),d=()=>n(771624),l=()=>n(46657),u=()=>n(963702),g=()=>n(92383),p=()=>n(351360),m=()=>n(430483),S=()=>n(756315),f=()=>n(99254),h=()=>n(577437),v=()=>n(174636);function y(e){return"completed"===e?"completed":"not_started"===e||"pending_selection"===e?"not_started":"in_progress"}function _(e){if("google_drive"===e)return S().d.state.initialSyncState;if("jira"===e){const e=f().y.state.jiraSyncState;return"not_started"===e||"pending_connection"===e?"not_started":"in_progress"===e||"pending_selection"===e?"in_progress":"completed"}if("github"===e)return"authenticated"===c().o.state.status?"in_progress":c().o.state.status;if("gmail"===e)return"authenticated"===d().X.state.status?"completed":"not_started";if("microsoftTeams"===e){const e=u().F.state.connectionStatus;return"not_started"===e?"not_started":"in_progress"===e||"pending_selection"===e?"in_progress":"completed"}if("slack"===e)return v().R.state.noChannelsSelected?"not_started":v().R.state.isSyncCompleted?"completed":"in_progress";var t;if("sharepoint"===e)switch(null===(t=g().E.state.connectionDetails)||void 0===t?void 0:t.status){case"completed":return"completed";case"in_progress":return"in_progress";default:return"not_started"}return"linear"===e?"not_started":(0,i().HB)(e)}function I(){return A().filter((e=>{if("slack"===e){return!(v().R.state.connectedApps||[]).includes("slack-admin")}return"google_drive"===e?"none"===S().d.state.initialSyncState||"not_started"===S().d.state.initialSyncState:"github"===e?"not_started"===c().o.state.status:"jira"===e?"not_started"===f().y.state.jiraSyncState:"sharepoint"===e?!g().E.state.connectionDetails:"gmail"===e?"not_started"===d().X.state.status:"microsoftTeams"===e?"not_started"===u().F.state.connectionStatus:"linear"!==e&&(0,i().HB)(e)}))}function A(){return o().fl.filter((e=>"slack"===e?m().zD.canUseUniversalSlackSearchScope():"google_drive"===e?m().zD.canUseUniversalGoogleDriveSearchScope():"github"===e?m().zD.canUseUniversalGithubSearchScope():"jira"===e?m().zD.canUseUniversalJiraSearchScope():"sharepoint"===e?m().zD.canUseUniversalSharepointSearchScope():"microsoftTeams"===e?m().zD.canUseUniversalMicrosoftTeamsSearchScope():"gmail"===e?m().zD.canUseUniversalGmailSearchScope():"linear"===e?m().zD.canUseUniversalLinearSearchScope():(0,i().HB)(e)))}function b(){return o().fl.filter((e=>"slack"===e?m().zD.isConnectedToSlackUniversalQnA(v().R.state):"google_drive"===e?m().zD.isConnectedToGoogleDriveUniversalQnA(v().R.state):"github"===e?m().zD.isConnectedToGithubUniversalQnA(c().o.state):"jira"===e?m().zD.isConnectedToJiraUniversalQnA(f().y.state):"gmail"===e?m().zD.isConnectedToGmailUniversalQnA(d().X.state):"sharepoint"===e?m().zD.isConnectedIsSharepointAiConnector(g().E.state):"microsoftTeams"===e?m().zD.isConnectedToMicrosoftTeamsUniversalQnA(u().F.state):"linear"!==e&&(0,i().HB)(e)))}function C(){return b().filter((e=>(0,r().LT)(e).isInProgress))}function T(e){return{slack:v().R,google_drive:S().d,jira:f().y,github:c().o,sharepoint:g().E,microsoftTeams:u().F,gmail:d().X,linear:l().W}[e].state.isLoaded}function D(){const e=(0,s().v3)(),t=(0,a().O$)(p().AppStoreCurrentSpaceStore),n=(0,h().P9)({name:"ai_connectors",spaceId:null==t?void 0:t.id,userId:e.currentUser.id})??!1;return(0,a().K8)((()=>{var e;return!(!t||!n)&&!Boolean(null===(e=t.getSettings())||void 0===e?void 0:e.embedding_index_is_live)}),[t,n])}},627437:(e,t,n)=>{n.d(t,{s:()=>s});const s=(0,n(340498).xh)("googleDrive",{default:{loader:()=>n.e(33168).then(n.bind(n,74007))},darkMode:{loader:()=>n.e(33168).then(n.bind(n,771737))}})},634877:(e,t,n)=>{n.d(t,{NK:()=>C,NT:()=>_,Rl:()=>b,Vn:()=>y,hP:()=>I,ts:()=>A});n(898992),n(354520),n(581454),n(737550);var s=n(296540),a=()=>n(484714),o=()=>n(847249),i=()=>n(187174),r=()=>n(959013),c=()=>n(763824),d=()=>n(534177),l=()=>n(295118),u=()=>n(436572),g=()=>n(604018),p=()=>n(704152),m=()=>n(47170),S=()=>n(508496),f=()=>n(576590),h=n(474848);const v={slack:f().updateSlackQnAConnectionState,google_drive:f().updateGoogleDriveQnAConnectionState,jira:f().updateJiraAIConnectionStatus,github:f().updateGithubAIConnectorStatus,sharepoint:f().updateSharepointAiConnectorStatus,microsoftTeams:f().updateMicrosoftTeamsAIConnectorStatusAction,gmail:f().updateGmailAIConnectorStatus,linear:f().updateLinearAIConnectorStatus};function y(e){return async t=>l().ZC.state?{status:"success"}:v[e](t)}const _={slack:n(174636).R,google_drive:n(756315).d,jira:n(99254).y,github:n(291075).o,sharepoint:n(92383).E,microsoftTeams:n(963702).F,gmail:n(771624).X,linear:n(46657).W};function I(e){return(0,o().K8)((()=>S().default.getConfigKey("ingestion",e)),[e])}function A(e){const t=(0,a().v3)(),n=(0,m().O)(),r=(0,o().K8)(g().kB,[]),l=(0,s.useRef)(!1),u=(0,o().K8)((()=>r.filter((e=>!(0,g().A7)(e))).filter((t=>!(0,d().O9)(e)||e.includes(t)))),[r,e]);(0,i().Yb)((async()=>{if(!n||l.current||0===u.length)return;const e=u.map((e=>y(e)));l.current=!0,await(0,c().lX)(e,10,(e=>e({environment:t,spaceId:n}))),l.current=!1}),[t,n,u]);return{isLoading:(0,o().K8)((()=>u.some((e=>!(0,g().A7)(e)))),[u])}}function b(){u().D6({label:(0,h.jsx)(r().sA,{id:"universalSearch.googleDriveIngestion.googleDriveButton.accessDeniedSnackbar",defaultMessage:"You do not have access to Google Drive Universal QnA."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,h.jsx)(p().A,{onClick:u().N2,children:(0,h.jsx)(r().sA,{id:"universalSearch.googleDriveIngestion.googleDriveButton.closeErrorSnackbar",defaultMessage:"Close"})})})}function C(){u().D6({label:(0,h.jsx)(r().sA,{id:"universalSearch.googleDriveIngestion.googleDriveButton.showTryAgainSnackbar",defaultMessage:"There was problem processing your request. Please try again."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,h.jsx)(p().A,{onClick:u().N2,children:(0,h.jsx)(r().sA,{id:"universalSearch.googleDriveIngestion.googleDriveButton.closeErrorSnackbar",defaultMessage:"Close"})})})}},658861:(e,t,n)=>{n.d(t,{u:()=>s});const s=(0,n(340498).xh)("linear",{default:{loader:()=>n.e(69390).then(n.bind(n,648023))},darkMode:{loader:()=>n.e(69390).then(n.bind(n,470041))}})},703888:(e,t,n)=>{n.d(t,{j:()=>s});const s=(0,n(340498).xh)("slack",{default:{loader:()=>n.e(15891).then(n.bind(n,888382))},darkMode:{loader:()=>n.e(15891).then(n.bind(n,868662))}})},731006:(e,t,n)=>{n.d(t,{z:()=>s});const s=(0,n(340498).xh)("teams",{default:{loader:()=>n.e(21437).then(n.bind(n,888364))},darkMode:{loader:()=>n.e(21437).then(n.bind(n,677640))}})},771624:(e,t,n)=>{n.d(t,{A:()=>a,X:()=>i});var s=()=>n(206267);function a(){return{currentScreen:"none",status:"not_started",sessionId:s().JW(),analyticsFrom:"unknown",isConnected:!1,isPersonalAuthComplete:!1,isDisconnecting:!1,isLoaded:!1}}class o extends(()=>n(757695))().default{getInitialState(){return a()}}const i=new o;(0,n(604341).exposeDebugValue)("gmailAIConnectorStore",i)},856988:(e,t,n)=>{n.d(t,{N:()=>s});const s=(0,n(340498).xh)("jira",{default:{loader:()=>n.e(39953).then(n.bind(n,280746))},darkMode:{loader:()=>n.e(39953).then(n.bind(n,614882))}})},941115:(e,t,n)=>{n.d(t,{A:()=>s});const s=(0,n(340498).xh)("gitHub",{default:{loader:()=>n.e(51276).then(n.bind(n,564613))},darkMode:{loader:()=>n.e(51276).then(n.bind(n,939195))}})},963702:(e,t,n)=>{n.d(t,{F:()=>i,G:()=>a});var s=()=>n(206267);function a(){return{currentScreen:"none",connectionStatus:"not_started",sessionId:s().JW(),analyticsFrom:"unknown",microsoftTenantId:void 0,syncProgressPercentage:0,isLoaded:!1,isDisconnecting:!1,error:void 0}}class o extends(()=>n(757695))().default{getInitialState(){return a()}}const i=new o},972261:(e,t,n)=>{n.d(t,{Fl:()=>r,KI:()=>l,PI:()=>a,S:()=>c,Tq:()=>p,_u:()=>o,e5:()=>i,fK:()=>u,fl:()=>s,lF:()=>d});n(898992),n(672577);const s=["slack","google_drive","github","jira","sharepoint","microsoftTeams","gmail","linear"],a=["slack","googleDrive","github","jira","microsoftTeams","sharepoint","gmail","linear","web","githubCode"],o="7c57d10c-00cc-48bc-a552-fb3911dd7745",i="1031cb6c-4935-4cc1-9c08-c9a4ecaae323",r="65683ef9-c923-4a14-8c5b-bfcf591cf5a1",c="c1f230b1-6635-4ab0-a3f5-f7eb105a87c3",d="c91548d4-25d0-44a2-ab2e-19f6f0b11d96",l="1724f2a1-f543-43a7-82af-8a0f85bda112",u="07351274-83bb-4118-9f5b-9d75f0453999",g=[{regex:/https:\/\/(?<workspace>[\w-]+)\.slack\.com\/archives\/(?<channel>[^\/]+)\/p(?<timestamp>\d+)(\?thread_ts=(?<thread_ts>\d+\.\d+)&cid=(?<cid>[^\/]+))?/,type:"slack"},{regex:/https:\/\/docs\.google\.com\/(?<fileType>document|spreadsheets|presentation)\/d\/(?<fileId>[a-zA-Z0-9_-]+)(?:\/\S*)?/,type:"googleDrive"},{regex:/https:\/\/github\.com\/(?<orgName>[^\/]+)\/(?<repoName>[^\/]+)\/(?:blob|tree|blame)\/(?<branchName>[^\/]+)\/(?<codePath>[^#]+)(#(?<lineNumber>L\d+(?:C\d+)?(?:-L\d+)?))?/,type:"githubCode"},{regex:/https:\/\/github\.com\/(?<orgName>[^\/]+)\/(?<repoName>[^\/]+)\/pull\/(?<prNumber>\d+)(\/(files|commits|checks)?)?/,type:"github"},{regex:/https:\/\/app\.graphite\.dev\/github\/pr\/(?<orgName>[^\/]+)\/(?<repoName>[^\/]+)\/(?<prNumber>\d+)(?:\/\S*)?/,type:"github"},{regex:/https:\/\/(?:[^\.]+)\.sourcegraphcloud\.com\/github\.com\/(?<orgName>[^\/]+)\/(?<repoName>[^\/@]+)(?:@(?<branchName>[a-f0-9]+))?\/-\/blob\/(?<codePath>[^?]+)\?(?<lineNumbers>L\d+|l\d+)?/,type:"githubCode"},{regex:/https:\/\/(?<site>[^/]+\.atlassian\.net).*?(?:browse\/|[?&]selectedIssue=)(?<issueKey>[A-Z0-9]+-\d+).*?/,type:"jira"}];function p(e){const t=g.find((t=>t.regex.test(e)));return(null==t?void 0:t.type)??"web"}},987267:(e,t,n)=>{n.d(t,{FJ:()=>o,GK:()=>s,l$:()=>i,w0:()=>a});const s={slack:n(703888).j,github:n(941115).A,google_drive:n(627437).s,jira:n(856988).N,microsoftTeams:n(731006).z,sharepoint:n(460383).i,gmail:n(474998).l,linear:n(658861).u},a={slack:"Slack",github:"GitHub",google_drive:"Google Drive",jira:"Jira",microsoftTeams:"Microsoft Teams",sharepoint:"SharePoint",gmail:"Gmail",linear:"Linear"},o={slack:{name:a.slack,icon:s.slack},github:{name:a.github,icon:s.github},google_drive:{name:a.google_drive,icon:s.google_drive},jira:{name:a.jira,icon:s.jira},microsoftTeams:{name:a.microsoftTeams,icon:s.microsoftTeams},sharepoint:{name:a.sharepoint,icon:s.sharepoint},gmail:{name:a.gmail,icon:s.gmail},linear:{name:a.linear,icon:s.linear}},i="Microsoft"}}]);