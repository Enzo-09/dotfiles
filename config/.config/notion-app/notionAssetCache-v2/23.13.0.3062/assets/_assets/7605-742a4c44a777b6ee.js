"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[7605],{35091:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var n=o(474848);const r=function(e){let{switcherProps:t,...r}=e;return(0,n.jsx)(o(497222).A,{right:(0,n.jsx)(o(946548).A,{onClick:r.onClick,disabled:r.disabled,...t}),...r})}},513349:(e,t,o)=>{o.d(t,{Sj:()=>s,UD:()=>a});o(16280);var n=()=>o(686526),r=()=>o(180762),i=()=>o(204067);const l={property:function(e){let{template:t,collectionStore:r,collectionViewStore:l,collectionSettingsStore:a}=e;const s=(0,i().S1)({collectionStore:r,templateId:t.templateId,instancePointerType:"property"});if(!s)throw new Error(`No property instance found for property template ${t.templateId}`);const c=l.getType();n().a2({collectionSettingsStore:a,item:{type:"property",property:s.id,formatKey:c?o(651124).u9(c):void 0}})},collection_view:function(e){let{template:t,environment:o,collectionStore:n,collectionContextStore:r}=e;const l=(0,i().S1)({collectionStore:n,templateId:t.templateId,instancePointerType:"collection_view"});if(!l)throw new Error(`No collection view instance found for property template ${t.templateId}`);s({environment:o,collectionContextStore:r,collectionViewId:l.id})},compound:function(e){}};function a(e){l[e.template.type](e)}function s(e){var t;let{environment:o,collectionContextStore:i,collectionViewId:l}=e;(null===(t=i.collectionViewStore())||void 0===t?void 0:t.id)!==l&&(0,r().t)({environment:o,collectionContextStore:i,collectionViewId:l,isFullScreen:i.isFullScreenStore.state,isRootChild:i.isRootChildStore.state,isInPeekRenderer:i.isInPeekRendererStore.state}),n().a2({collectionSettingsStore:i.settingsStore,item:{type:"main"}})}},603815:(e,t,o)=>{o.d(t,{A$:()=>A,JQ:()=>_,Vn:()=>C,s4:()=>k});o(16280),o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(803949),o(581454);var n=()=>o(857639),r=()=>o(585515),i=()=>o(577449),l=()=>o(388821),a=()=>o(179034),s=()=>o(545285),c=()=>o(534177),d=()=>o(449506),p=()=>o(780054),u=()=>o(989423),m=()=>o(870618),f=()=>o(303626),g=()=>o(14307),h=()=>o(245865),v=()=>o(540758),y=()=>o(670631),S=()=>o(508496),w=()=>o(571963),b=()=>o(603815),x=()=>o(108944);async function C(e){const{environment:t,request:o,abortSignal:n,prefetchCacheKey:r,headers:i}=e;return(0,w().updateLoadCachedPageChunkCalledAt)(),g().isConnected()||g().isConnecting()?d().callApi({eventName:"loadCachedPageChunkV2",environment:t,data:o,abortSignal:n,prefetchCacheKey:r,headers:i}):d().callApi({eventName:"loadPageChunkV2",environment:t,data:o,abortSignal:n,prefetchCacheKey:r,headers:i})}async function k(e){const{mode:t,environment:o,request:c,isFirstChunk:d,abortSignal:g}=e,h={...c,limit:30,cursor:c.cursor||{stack:[]},baseUrl:p().A.domainBaseUrl,publicDomainName:p().A.publicDomainName};if("inMemoryAndDiskCacheWithInexactPreload"===t&&(await b().A$(o,{id:c.page.id,table:a().ev}),null!=g&&g.aborted))throw new Error("Abort signal received");const S=l().RecordMapWithRole.create(),w=[];let x=!1;const C=new Set,k=await r().T(h,i().h.fromMonomorphicFunctionUnsafe((async e=>{const n=await m().h7({environment:o,pointer:e,abortSignal:g,useInMemoryCacheOnly:"inMemoryOnly"===t});if(null!=g&&g.aborted)throw new Error("Abort signal received");if(n)return S.setModelAndRole(e,n.model,n.role),n.model;if("inMemoryOnly"===t)throw new Error(`Record not found: ${e.table},${e.id}`);if((0,s().u)(e)&&!C.has(e.id)&&d){if(void 0===y().A.state.offlinePages)return w.push(e),void(x=!0);if(void 0===y().A.state.offlinePages||!v().Bd(c.page.id))throw new Error(`Record not found: ${e.table},${e.id}`);w.push(e)}})),((e,t,o,n)=>{f().N.enableLogging&&console.log(`Spidering from ${e.table}:${e.id} to ${t.table}:${t.id} (${o})`),null!=n&&n.suppressErrorOnClient&&C.add(t.id)}));if(x&&(await y().A.waitUntil((()=>void 0!==y().A.state.offlinePages)),!v().Bd(c.page.id))){const[e]=w;throw new Error(`Record not found: ${e.table},${e.id}`)}if(w.length>0&&(0,u().LM)({eventName:"offline_page_was_missing_records_in_cache",sampling:{behavior:"statsig",fallbackBehavior:"statsig",statsigNotAvailableBehavior:"drop"}}).then((e=>{(0,u().u4)({environment:o,event:{eventName:"offline_page_was_missing_records_in_cache",eventProperties:{}},opts:{sampling:{behavior:"decided",sampleDecision:e}}}),e&&n().log({level:"error",from:"loadingHelpers",type:"offlinePageWasMissingRecordsInCache",data:{pageId:c.page.id,missingRecords:w}})})),null!=g&&g.aborted)throw new Error("Abort signal received");return{recordMap:S.toJson(),cursor:k.cursorValue}}async function A(e,t){const o=e.currentUser.id;if(!o||!e.defaultRecordCache.persistedRecordCache)return Promise.resolve(void 0);(await e.defaultRecordCache.persistedRecordCache.getPageBlocksByParent({page:t,userId:o})).forEach((t=>{e.defaultRecordCache.inMemoryRecordCache.setRecord({pointer:t.pointer,userId:t.userId},t.value),e.defaultRecordCache.inMemoryRecordCache.emitRecord(t.pointer,[]),h().unsubscribeAfterDelay({environment:e,pointer:t.pointer,userId:t.userId})}))}function _(e){if(!S().default.checkGate({gateName:"load_page_chunk_omit_existing_record_versions"}))return;const t=l().RecordMapPolymorphic.create();let o=0;const n=()=>o>=50,r=e=>{"space"!==(null==e?void 0:e.table)&&(n()||e&&void 0===t.get(e.pointer)&&(t.set(e.pointer,e.getVersion()),o++))};if(e.isReady())for(const l of(0,x().E)(e))r(l);if(e.userId){const t=e.environment.defaultRecordCache.inMemoryRecordCache.data.getUserRecordMap(e.userId);r(t.getModel({table:"notion_user",id:e.userId}));let o=0;for(const e of t.getPointersByTable("notion_user")){if(n()||o>=10)break;o++,r(t.getModel(e))}}const i=Array.from(t).map((e=>{let{pointer:t,value:o}=e;if(void 0!==o)return{pointer:t,version:o}})).filter(c().O9);return i.length?i:void 0}},926329:(e,t,o)=>{o.d(t,{b:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("templates",{viewBox:"0 0 20 20",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M6.39733 5.67853C5.89764 5.50234 5.36002 5.40649 4.8 5.40649C2.14904 5.40649 0 7.55432 0 10.2038C0 12.8533 2.14904 15.0011 4.8 15.0011C6.52165 15.0011 8.0316 14.0952 8.87867 12.7343L5.26487 12.0975L6.39733 5.67853Z"}),(0,n.jsx)("path",{d:"M17.3126 3.66609L7.85843 2L6.19141 11.4489L10.6545 12.2354L14.3998 5.81854L16.3449 9.15116L17.3126 3.66609Z"}),(0,n.jsx)("path",{d:"M8.80078 17L14.4008 7.4054L20.0008 17H8.80078Z"})]})})},960127:(e,t,o)=>{o.r(t),o.d(t,{WorkflowSettingsConfirmAddTemplate:()=>j,isWorkflowTemplateWithConfirmStep:()=>T});o(16280);var n=o(296540),r=()=>o(484714),i=()=>o(401497),l=()=>o(663077),a=()=>o(959013),s=()=>o(496603),c=()=>o(686526),d=()=>o(751156),p=()=>o(735695),u=()=>o(35091),m=()=>o(678553),f=()=>o(204063),g=()=>o(89924),h=()=>o(175116),v=()=>o(989423),y=()=>o(101926),S=()=>o(513349),w=()=>o(913454),b=(o(581454),()=>o(784892)),x=()=>o(399762),C=o(474848);function k(e){let{template:t,style:o}=e;const n=(0,i().IS)((e=>({container:{...o,padding:12,border:`1px solid ${e.regularDividerColor}`,borderRadius:6}})),[o]),r=function(e){if((0,l().Xq)(e,"property")&&(0,l().Io)(e)){const{options:t=[]}=e.value;if(0===t.length)return;return(0,C.jsx)(A,{options:t})}}(t);return r?(0,C.jsx)("div",{style:n.container,children:r}):null}function A(e){let{options:t}=e;const o=(0,i().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:8}})),[]);return(0,C.jsx)("div",{style:o.container,children:t.map((e=>(0,C.jsx)("div",{children:(0,C.jsx)(x().O,{format:b().NY.Medium,isSingle:!0,value:e.value,color:e.color,showRemoveButton:!1})},e.id)))})}var _=()=>o(902842);function j(e){let{template:t,collectionSettingsStore:o}=e;const[l,s]=(0,n.useState)("sample"===t.propertyOptionsType),{device:{isMobile:c}}=(0,r().v3)(),d=(0,i().IS)((e=>{const t={display:"flex",flexDirection:"column",minHeight:0};return{shrinkableHeight:t,noShrink:{flexShrink:0},featurePreviewWrapper:{...t,width:"-webkit-fill-available"},featurePreviewBody:{...t,gap:16,...c?{margin:"16px 0"}:{margin:0}},featurePreview:{...t,overflow:"auto"},addButtonContainer:{...c?{margin:"12px 0"}:{marginBottom:6}}}}),[c]),f=(0,w().getWorkflowTemplateName)(t);return(0,C.jsxs)(p().Ay,{collectionSettingsStore:o,title:(0,C.jsx)(a().sA,{id:"workflowTemplateSettings.confirmAddTemplate.title",defaultMessage:"Turn on {templateName}",values:{templateName:f}}),disableScroller:!0,menuScrollerStyle:d.shrinkableHeight,innerContentWrapperStyle:d.shrinkableHeight,children:[(0,C.jsx)(g().A,{style:d.shrinkableHeight,children:(0,C.jsx)(m().Ay,{style:d.shrinkableHeight,textWrapperStyle:d.featurePreviewWrapper,bodyStyle:d.featurePreviewBody,body:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(I,{template:t,style:d.noShrink}),(0,C.jsx)(k,{template:t,style:d.featurePreview})]})})}),(0,C.jsx)(g().A,{style:d.noShrink,children:t.value.options&&t.value.options.length>0&&(0,C.jsx)(u().A,{title:(0,C.jsx)(a().sA,{id:"workflowTemplateSettings.confirmAddTemplate.propertyOptionsToggle",defaultMessage:"Set my own options"}),switcherProps:{on:l,disallowTabbing:!0},onClick:()=>{s(!l)}})}),(0,C.jsx)(g().A,{style:d.noShrink,children:(0,C.jsx)(m().Ay,{body:(0,C.jsx)(R,{template:t,startEmpty:l}),bodyStyle:d.addButtonContainer})})]})}function I(e){let{template:t,style:o}=e;const n=(0,r().Y0)(),a=(0,i().IS)((()=>({container:{...o,display:"flex",alignItems:"center",gap:12},textWrapper:{lineHeight:n.isMobile?"20px":"18px"},title:{fontSize:n.isMobile?16:13},caption:{fontSize:n.isMobile?14:12,overflow:"hidden",color:"gray",whiteSpace:"nowrap",textOverflow:"ellipsis"}})),[n,o]),s=(0,w().getWorkflowTemplateName)(t),c=(0,l().Uy)(t);return(0,C.jsxs)("div",{style:a.container,children:[(0,C.jsx)(_().n,{template:t,backgroundSize:32}),(0,C.jsxs)("div",{style:a.textWrapper,children:[(0,C.jsx)("div",{style:a.title,children:s}),c&&(0,C.jsx)("div",{style:a.caption,children:c})]})]})}function R(e){let{template:t,startEmpty:o}=e;const n=(0,i().IS)((()=>({button:{width:"100%"}})),[]),l=(0,r().v3)(),p=(0,h().ET)(),u=(0,w().getWorkflowTemplateName)(t),m=s().mg(t);return o&&delete m.value.options,(0,C.jsx)(f().A,{style:n.button,size:"lg",onClick:()=>{d().createAndCommit({userAction:"WorkflowSettingsConfirmAddTemplate.addFeatureTemplateToTarget",environment:l,canUndo:!0,perform:e=>{const o=p.collectionStore();if(!o)throw new Error("collectionStore not found");y().ai({environment:l,transaction:e,collectionStore:o,template:m,logger:new(w().WorkflowTemplateLogger),origin:"suggested_feature"});const n=p.settingsStore;c().yl({collectionSettingsStore:n});const r=o.getWorkflowTemplateId();(0,v().u4)({environment:l,event:{eventName:"suggested_feature_template_added",eventProperties:{origin:"suggested_properties",template_id_added:t.templateId,collection_template_id:r}}});const i=p.collectionViewStore();i&&(0,S().UD)({template:t,environment:l,collectionStore:o,collectionViewStore:i,collectionSettingsStore:n,collectionContextStore:p})}})},children:(0,C.jsx)(a().sA,{id:"workflowTemplateSettings.confirmAddTemplate.button",defaultMessage:"Add {templateName}",values:{templateName:u}})})}function T(e){return"property"===e.type&&("select"===e.value.type||"multi_select"===e.value.type)}}}]);