"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[10815],{196131:(e,t,n)=>{n.d(t,{C7:()=>o,CH:()=>s,JD:()=>r});n(898992),n(672577);var a=()=>n(842599);function r(e,t){return!!e&&o(e.getEmail(),t)}function o(e,t){return void 0!==s(e,t)}function s(e,t){if(!e)return;const n=(0,a().zN)(e);return t.find((e=>e.url===n))}},366858:(e,t,n)=>{n.d(t,{A:()=>s});n(581454);var a=()=>n(484714),r=()=>n(847249),o=()=>n(592674);function s(e){const t=(0,a().v3)();return(0,r().K8)((()=>{var n;const a=null==e?void 0:e.id;if(a)return null===(n=o().A.getData(t,{spaceId:a}))||void 0===n?void 0:n.map((e=>e.domain))}),[t,e])}},492720:(e,t,n)=>{n.d(t,{p:()=>o});var a=()=>n(762433),r=()=>n(57605);function o(e,t){if(!t)return;const n=r().A.getData(e,{spaceId:t});if(!n)return;const o=(0,a().AI)(n),s=(0,a().q8)(n);if(o&&s&&"year"!==s)switch(o){case"plus":return"team_three_months";case"business":return"business_three_months";case"enterprise":return"enterprise_three_months";default:return}}},572143:(e,t,n)=>{n.r(t),n.d(t,{DowngradeModal:()=>oe});n(16280),n(581454);var a=n(296540),r=()=>n(662303),o=()=>n(484714),s=()=>n(847249),i=()=>n(401497),d=()=>n(869190),l=()=>n(206267),u=()=>n(762433),c=()=>n(47273),p=()=>n(786508),m=()=>n(166386),g=()=>n(622963),f=()=>n(979340),v=()=>n(959013),h=()=>n(496603),w=()=>n(252105),S=()=>n(436572),y=()=>n(554509),b=()=>n(634201),x=()=>n(835470),I=()=>n(84817),_=()=>n(493823),D=()=>n(7674),M=()=>n(864943),C=n(474848);function P(e){const{downgradeProduct:t,excessGuests:n,formattedPeriodEndDate:a,internalDomains:r,spaceStore:o,onClickContinue:i,onClickManageGuests:d}=e,l=(0,v().tz)(),u=(0,s().K8)((()=>o.getName()),[o]),c=l.formatMessage(T[t]);return u&&n.length?(0,C.jsx)(D().tf,{header:(0,C.jsx)(D().YA,{iconAndTitle:(0,C.jsx)(D().ZQ,{iconGroup:x().F,iconColorName:"redPrimary",title:l.formatMessage(G.title,{planName:c,spaceName:u})}),description:l.formatMessage(G.description,{domain:r[0].url,number:n.length,date:a})}),footer:(0,C.jsx)(N,{onClickContinue:i,onClickManageGuests:d}),children:(0,C.jsx)(j,{excessGuests:n,spaceName:u})}):null}function j(e){const{excessGuests:t,spaceName:n}=e,a=(0,v().tz)(),r=(0,i().IS)((()=>({wrapper:{background:"#FDF5F3",textAlign:"center"}})),[]),o=(0,s().K8)((()=>t.map((e=>e.getKeyStore("given_name").getValue()??e.getDisplayName(a)))),[t,a]);return(0,C.jsx)(I().Y1,{align:"top-center",borderRadius:6,direction:"vertical",gap:10,padding:"14px 12px",style:r.wrapper,width:"fill",children:(0,C.jsxs)(I().Y1,{direction:"vertical",gap:8,align:"top-center",children:[(0,C.jsx)(I().Y1,{direction:"horizontal",align:"center",style:{paddingLeft:4},children:o.slice(0,3).map(((e,t)=>(0,C.jsx)(R,{givenName:e},t)))}),(0,C.jsxs)(I().Y1,{direction:"vertical",gap:4,align:"center",children:[(0,C.jsx)(y().D,{colorName:"uiRedPrimary",styleName:"Body-14px/Medium",children:(0,C.jsx)(k,{givenNames:o,spaceName:n})}),(0,C.jsx)(y().D,{colorName:"redPrimary",styleName:"Caption-12px/Regular",children:a.formatMessage(G.recommendation)})]})]})})}function k(e){const{givenNames:t,spaceName:n}=e,a=(0,v().tz)();return 1===t.length?(0,C.jsx)(C.Fragment,{children:a.formatMessage(G.oneRemovedGuest,{name1:t[0],spaceName:n})}):2===t.length?(0,C.jsx)(C.Fragment,{children:a.formatMessage(G.twoRemovedGuests,{name1:t[0],name2:t[1],spaceName:n})}):(0,C.jsx)(C.Fragment,{children:a.formatMessage(G.manyRemovedGuests,{name1:t[0],name2:t[1],count:t.length-2,spaceName:n})})}function R(e){const{givenName:t}=e,n=(0,i().IS)((e=>({circle:{borderRadius:14,border:`1px dashed ${e.stroke.uiRedSecondary}`,background:e.surface.elevated,marginLeft:-4}})),[]);return(0,C.jsx)(I().Y1,{style:n.circle,width:28,height:28,align:"center",children:(0,C.jsx)(y().D,{styleName:"Body-14px/Semibold",colorName:"uiRedPrimary",children:(0,b().PE)(t)[0].toUpperCase()})})}function N(e){const{onClickContinue:t,onClickManageGuests:n}=e,a=(0,v().tz)();return(0,C.jsx)(I().Y1,{gap:16,children:(0,C.jsxs)(I().Y1,{gap:8,align:"center",children:[(0,C.jsx)(M().A,{size:"lg","aria-label":a.formatMessage(G.manageGuests),onClick:n,style:{width:"100%"},children:a.formatMessage(G.manageGuests)}),(0,C.jsx)(_().p,{"aria-label":a.formatMessage(G.continueWithDowngrade),onClick:t,style:{justifyContent:"center"},children:(0,C.jsx)(y().D,{colorName:"secondary",children:a.formatMessage(G.continueWithDowngrade)})})]})})}const G=(0,v().YK)({title:{id:"DowngradeWillRemoveGuestsModal.title",defaultMessage:"Downgrading to {planName} will remove guests from {spaceName}"},description:{id:"DowngradeWillRemoveGuestsModal.description",defaultMessage:"{number} of your guests with the email domain ‘@{domain}’ will be removed on {date} to align with your new plan's guest limit"},continueWithDowngrade:{id:"DowngradeWillRemoveGuestsModal.continueWithDowngrade",defaultMessage:"Continue with downgrade"},manageGuests:{id:"DowngradeWillRemoveGuestsModal.manageGuests",defaultMessage:"Manage guests"},manyRemovedGuests:{id:"DowngradeWillRemoveGuestsModal.manyRemovedGuests",defaultMessage:"{name1}, {name2}, and {count, plural, one {1 more guest} other {{count} more guests}} will be removed from {spaceName}"},twoRemovedGuests:{id:"DowngradeWillRemoveGuestsModal.twoRemovedGuests",defaultMessage:"{name1} and {name2} will be removed from {spaceName}"},oneRemovedGuest:{id:"DowngradeWillRemoveGuestsModal.oneRemovedGuest",defaultMessage:"{name1} will be removed from {spaceName}"},recommendation:{id:"DowngradeWillRemoveGuestsModal.recommendation",defaultMessage:"If you want them to retain access, we recommend upgrading them to members."}}),T={business:f().v0.business,enterprise:f().v0.enterprise,free:f().v0.free,personal:f().v0.personal,plus:f().v0.plus,student:f().v0.educationPlus};var A=()=>n(366858),W=()=>n(58293),B=()=>n(646736),E=()=>n(749356),L=()=>n(348779),Y=()=>n(807778),F=()=>n(492720),K=()=>n(10984),O=()=>n(798880),V=(n(898992),n(354520),()=>n(196131));var z=()=>n(134217);var U=()=>n(592674);const H=new(n(848776).U)((e=>{let{spaceId:t,inviteeIds:n}=e;return`${t}:${n.sort().join(",")}`}),(async function(e,t){const a=await Promise.resolve().then(n.bind(n,449506)),r=await a.callApi({eventName:"getInvitesForInvitees",environment:e,data:t});return"success"===r.type?r.data.invites.map((e=>n(792071).Bj6.fromValue(n(426302).Yx,e))):void 0}));n(604341).exposeDebugValue("InvitesForInviteesStore",H);const $=H;var q=()=>n(870092),Q=()=>n(577437),J=()=>n(749240);function Z(e){let{space:t,spaceUser:n,desiredState:a}=e;const r=(0,o().v3)(),i=(d=J().subscriptionDataStoreInstance,(0,s().K8)((()=>{const e=d.state;if(e)return(0,z().oe)(e)}),[d]));var d;const l=(0,s().K8)((()=>n.getUserId()),[n]),u=(0,Q().Mc)({name:"internal_guests",spaceId:t.id,userId:l,amount:0,state:a});return(0,s().K8)((()=>{var e;const n=t.getModel();if(!n||!u)return[];const a=(i??[]).map((e=>function(e,t){return new(q().L)(e,{table:O().oo,id:t})}(r,e.userId))).map((e=>e.getModel())),o=(0,h().oE)(a),s=n.id,d=o.map((e=>e.id)),l=$.getData(r,{spaceId:s,inviteeIds:d}),c=null===(e=U().A.getData(r,{spaceId:s}))||void 0===e?void 0:e.map((e=>e.domain));return function(e){let{featureAvailability:t,guests:n,invites:a,domains:r}=e;const o=(0,h().$z)(a,(e=>e.invitee_id)),s=n.filter((e=>(0,V().C7)(e.email,r))),i=(0,h().Ul)(s,(e=>{const t=o[e.id]??[],n=(0,h().Sk)(t,(e=>e.created_time));return null==n?void 0:n.created_time})),d=n.length,l=t.limit.total,u="unlimited"===l?0:Math.max(d-l,0);return i.slice(0,u)}({featureAvailability:u,guests:o,invites:l??[],domains:c??[]}).map((e=>new(q().L)(r,{table:O().oo,id:e.id})))}),[r,t,u,i])}var X=()=>n(697959),ee=()=>n(755195),te=()=>n(981046),ne=()=>n(231127),ae=()=>n(156262),re=()=>n(30265);function oe(e){let{billingInterval:t,billingData:n,currentPeriodEnd:h,salesStatus:b,isOpen:x,onClose:I,onRequestDowngrade:_,onRequestUpgrade:D,onClickManageGuests:M}=e;const j=(0,g()._y)((0,u().AI)(n)),k=(0,ee().H4)({billingInterval:t,priceStore:te().A,products:X().$m}),R=(0,o().v3)(),N=(0,v().tz)(),G=(0,u().Rz)(n),T=(0,W().r)(),O=(0,s().K8)((()=>Boolean(null==T?void 0:T.canAdmin())),[T]),V=(0,u().qd)({billingData:n,canUpdateBilling:O}),z=(0,s().K8)((()=>(0,Y().Le)()),[]),U=(0,K().RL)({salesStatus:b,packagingChangesEnabled:z}),[H,$]=a.useState("plan_select"),[q,Q]=a.useState({newProduct:j,reasons:[],reasonOther:void 0,reasonOtherTools:void 0}),[J]=a.useState(l().JW()),[ne,oe]=a.useState(void 0);(0,a.useEffect)((()=>w().u4(R,{name:"churn_survey",args:{newProduct:q.newProduct,churnType:j,reasons:q.reasons,reasonOther:q.reasonOther,reasonOtherTools:q.reasonOtherTools,stage:H,churnSurveyId:J}})),[R,H,q,J,j]);const ie=(0,B().HI)(),de=(0,A().A)(T),le=Z({space:T,spaceUser:ie,desiredState:(0,u().ek)(q.newProduct)}),ue=(0,i().DP)(),ce=(0,s().K8)((()=>{const e=(0,Y().Le)(),t=q.newProduct?(0,L().j)({highlightStyle:{color:ue.text.uiRedPrimary},intl:N,isMay13PackagingChangesEnabled:e})[j][q.newProduct]:void 0;return null==t?void 0:t.map((e=>({icon:e.icon,beforeMessage:e.beforeDowngrade,message:e.afterDowngrade?(0,C.jsx)(y().D,{styleName:"Body-14px/Regular",colorName:"primary",customStyles:{display:"inline"},children:e.afterDowngrade}):null,messageIcons:e.afterDowngradeIcons,tooltip:e.tooltip})))}),[j,q.newProduct,N,ue]),pe=a.useCallback((()=>{w().u4(R,{name:"churn_survey_close",args:{churnSurveyId:J}}),I()}),[J,R,I]),me=a.useCallback((e=>{T&&("upgrade"===(0,f().qR)({oldTier:j,newTier:e})&&"free"!==e?(w().QP(R,{from:"downgrade_modal",for_subscription_tier:e}),D({environment:R,spaceStore:T,billingData:n,product:e,pageSection:"downgrade_modal",from:"downgrade_modal"}),pe()):(Q((t=>({...t,newProduct:e}))),$("survey")))}),[n,j,R,pe,D,T]),ge=h?(0,d().W_)(h,"long",r().locale):void 0;return(0,C.jsx)(re().W,{step:H,isOpen:x,onClose:pe,children:(()=>{switch(H){case"plan_select":return(0,C.jsx)(ae().K2,{initialPlan:q.newProduct,asyncPriceByProduct:k,salesStatus:b,onSubmit:me});case"survey":return(0,C.jsx)(ae().lU,{options:se(),onSubmit:async e=>{w().u4(R,{name:"churn_survey_submitted",args:{newProduct:q.newProduct,churnType:j,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0,stage:H,churnSurveyId:J}}),Q((t=>({...t,reasons:e.reasons,reasonOther:e.customTextByReason.other??void 0,reasonOtherTools:e.customTextByReason.switching??void 0})));const t=await E().z6(R,{spaceId:null==T?void 0:T.id,offerCampaign:(0,F().p)(R,null==T?void 0:T.id)}),n=(0,p().RS)(t);if(n&&(0,m().OJ)(n))return oe(n),void $("offer");$("remove_guests")}});case"offer":return ne?(0,C.jsx)(ae().hL,{currentProduct:j,coupon:ne,newProduct:q.newProduct,onSubmit:async e=>{if(e){w().u4(R,{name:"offer_accepted",args:{coupon:ne}});const e=null==T?void 0:T.id,t=(0,F().p)(R,e);G&&e&&V&&(0,m().OJ)(ne)&&((0,Y().S7)()&&t?await E().VY({environment:R,spaceId:e,offerCampaign:t,entrypoint:"downgrade_flow"}):await E().Qm(R,{customerId:G,offerType:"downgrade_flow",newPlan:j,coupon:ne}),S().D6({label:(0,C.jsx)(v().sA,{id:"applyCoupon.success",defaultMessage:"Coupon successfully applied"})})),pe()}else $("remove_guests")}}):void $("remove_guests");case"remove_guests":const e=le&&le.length>0,t=de&&de.length>0;return e&&t&&ge&&T?(0,C.jsx)(P,{downgradeProduct:q.newProduct,excessGuests:le,formattedPeriodEndDate:ge,internalDomains:de,spaceStore:T,onClickContinue:()=>$("downgrade"),onClickManageGuests:M}):void $("downgrade");case"downgrade":return(0,C.jsx)(ae().kv,{newProduct:q.newProduct,title:(0,C.jsx)(v().sA,{id:"downgradeModal.header.downgrade.title",defaultMessage:"Continue downgrading to {planMessage}?",values:{planMessage:(0,f().u2)({product:q.newProduct,intl:N,useEnterpriseLimitedName:U})}}),description:ge?(0,C.jsx)(v().sA,{id:"downgradeFlow.restrictionStep.description",defaultMessage:"You can still utilize all the features of your current plan until {date}. You can resubscribe or switch to another plan anytime.",values:{date:(0,C.jsx)("span",{style:{fontWeight:590},children:ge})}}):null,restrictionList:ce,onSubmit:async e=>{if(w().u4(R,{name:"continue_downgrade_button_clicked"}),T&&n){if(!(await _({billingData:n,environment:R,product:q.newProduct,spaceStore:T,from:"billing_page",churnState:null!=e&&e.churnImmediately?"churn_immediately":"churn_by_end_of_billing_period"})))return}$("confirmation")}});case"confirmation":if(n){if((0,c().Gf)((0,u().lQ)(n))!==q.newProduct)throw new Error("Subscription tier has not changed and is not scheduled to be changed.")}return(0,C.jsx)(ae().Qe,{title:(0,C.jsx)(v().sA,{id:"downgradeFlow.confirmationStep.title",defaultMessage:"Your workspace is now on {plan}",values:{plan:(0,f().u2)({product:q.newProduct,intl:N,useEnterpriseLimitedName:U})}}),formattedPeriodEndDate:ge})}})()})}function se(){return[...(0,h().k4)([ne().V.notUsingEnough,ne().V.switching,ne().V.tooExpensive,ne().V.tooDifficult,ne().V.missingFeatures,ne().V.upgradedByMistake,ne().V.consolidatingWorkspaces]),ne().V.other]}},592674:(e,t,n)=>{n.d(t,{A:()=>r});const a=new(n(848776).U)((e=>{let{spaceId:t}=e;return t}),(async function(e,t){var a;let{spaceId:r}=t;const o=await Promise.resolve().then(n.bind(n,449506)),s=await o.callApi({eventName:"getInternalDomains",environment:e,data:{spaceId:r}});return"success"===s.type?null===(a=s.data)||void 0===a?void 0:a.internalDomainsWithInfo:void 0}));n(604341).exposeDebugValue("InternalDomainsStore",a);const r=a},651390:(e,t,n)=>{n.d(t,{H:()=>o});var a=()=>n(484714),r=()=>n(847249);function o(e){const{billingInterval:t,priceStore:n,products:o}=e,s=(0,a().v3)();return(0,r().K8)((()=>{const e={};for(const a of o)e[a]=n.getPrice(s,(e=>e.product===a&&e.billingInterval===t));return e}),[t,s,n,o])}},674579:(e,t,n)=>{n.d(t,{Y:()=>r});var a=()=>n(401497);function r(){return(0,a().IS)((e=>({bulletList:{paddingInlineStart:0,marginBlock:"0px 0px",listStyleType:"none"},bulletItem:{display:"flex",minHeight:24,alignItems:"center"},bulletItemContent:{display:"flex",gap:4},bulletItemContentMultiLineExtra:{paddingTop:4,paddingBottom:4},bulletItemCheckmarkContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},bulletItemCheckmarkContainerMultiLineExtra:{alignItems:"flex-start",paddingTop:2,justifyContent:void 0},bulletItemCheckmark:{width:12,height:12,color:e.icon.secondary},coloredRow:{display:"flex",flexDirection:"row",gap:12,backgroundColor:e.surface.wash,borderRadius:2},column:{width:"100%",minWidth:150,paddingTop:10,paddingBottom:12},featureDetailsStyle:{paddingTop:12},gridSectionTitle:{paddingLeft:12},gridSection:{display:"flex",flexDirection:"column",gap:42},row:{display:"flex",flexDirection:"row",gap:12},tooltip:{width:156},tooltipWithImageExtra:{paddingLeft:8,paddingRight:8,paddingTop:8,paddingBottom:6},lastRow:{borderBottom:`1px solid ${e.stroke.secondary}`},sidebar:{width:"100%",paddingTop:12,paddingBottom:12,maxWidth:118},titleSection:{paddingLeft:12}})),[])}},755195:(e,t,n)=>{n.d(t,{H4:()=>a().H,_7:()=>r()._});var a=()=>n(651390),r=()=>n(931783)},835470:(e,t,n)=>{n.d(t,{F:()=>a});const a=(0,n(340498).xh)("exclamationMarkCircle",{default:{loader:()=>n.e(64087).then(n.bind(n,129852))},small:{loader:()=>n.e(64087).then(n.bind(n,621594))},fill:{loader:()=>n.e(64087).then(n.bind(n,428390))},fillSmall:{loader:()=>n.e(64087).then(n.bind(n,297173))}},["exclamation","circle","alert","warning","attention"])},909306:(e,t,n)=>{n.d(t,{Mb:()=>o,ze:()=>s});var a=()=>n(715256),r=()=>n(762433);function o(e){let{billingData:t,experimentService:n,spaceId:o}=e;const s=(0,r().YF)(t),i=(0,r().N8)(null==t?void 0:t.subscription),d=n.checkGate({gateName:"packaging_changes_05_13_2025",actor:a().S3,customIDs:{spaceId:o}}),l=(0,r().eh)(t,"plus"),u=(0,r().eh)(t,"business"),c=(0,r().eh)(t,"enterprise"),p=(0,r().eh)(t,"ai"),m=(0,r().eh)(t,"student"),g=(0,r().eh)(t,"personal");return d?i?p&&(l||u||c)?{currentState:{featureSet:"advanced",reason:"ai_product"},upsell:void 0}:{currentState:{featureSet:"none"},upsell:{product:"ai",featureSet:"advanced"}}:s?p&&g?{currentState:{featureSet:"advanced",reason:"personal_ai"},upsell:void 0}:g&&!p?{currentState:{featureSet:"none"},upsell:{product:"ai",featureSet:"advanced"}}:p&&!g?{currentState:{featureSet:"core",reason:"ai_product"},upsell:{product:"personal",featureSet:"advanced"}}:{currentState:{featureSet:"none"},upsell:{product:"ai",featureSet:"core"}}:m?p?{currentState:{featureSet:"core",reason:"ai_product"},upsell:{product:"business",featureSet:"advanced"}}:{currentState:{featureSet:"none"},upsell:{product:"ai",featureSet:"core"}}:u?p?{currentState:{featureSet:"advanced",reason:"ai_product"},upsell:void 0}:{currentState:{featureSet:"advanced",reason:"business"},upsell:void 0}:c?p?{currentState:{featureSet:"advanced",reason:"ai_product"},upsell:void 0}:{currentState:{featureSet:"advanced",reason:"enterprise"},upsell:void 0}:p?{currentState:{featureSet:"core",reason:"ai_product"},upsell:{product:"business",featureSet:"advanced"}}:{currentState:{featureSet:"none"},upsell:{product:"business",featureSet:"advanced"}}:p?{currentState:{featureSet:"core",reason:"ai_product"},upsell:void 0}:{currentState:{featureSet:"none"},upsell:{product:"ai",featureSet:"core"}}}function s(e){var t;let{billingData:n,experimentService:a,spaceId:r}=e;return"ai"===(null===(t=o({billingData:n,experimentService:a,spaceId:r}))||void 0===t||null===(t=t.upsell)||void 0===t?void 0:t.product)}},931783:(e,t,n)=>{n.d(t,{_:()=>s});var a=()=>n(484714),r=()=>n(847249),o=()=>n(252105);function s(e){const{asyncPrice:t}=e,n=(0,a().v3)();return(0,r().K8)((()=>{if(t&&t.isLoaded&&t.result)return o().m4(n,{externalId:t.result.externalId}),t.result.getMonthlyUnitCost().toMoneyValue()}),[t,n])}}}]);