"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[85825],{184966:(e,t,n)=>{n.d(t,{Nm:()=>R,TM:()=>A,tt:()=>C});n(16280),n(944114),n(809678),n(898992),n(581454),n(737550);var o=()=>n(134025),i=()=>n(142748),r=()=>n(433847),a=()=>n(68263),s=()=>n(96689),c=()=>n(116225),d=()=>n(896628),l=()=>n(722101),u=()=>n(44729),p=()=>n(246826),m=()=>n(751156),f=()=>n(183324),h=()=>n(989423),y=()=>n(186445),g=()=>n(351360),v=()=>n(630116),b=()=>n(659915),_=()=>n(747444);function A(e){const{environment:t,collectionStore:n,publishingEnabled:o,transaction:i}=e;m().createAndCommitOrAppend({environment:t,perform:e=>{d().zA({stores:[n],update:{publishing_enabled:o},transaction:e})},userAction:"Posts.setPublishingEnabled",canUndo:!0,transaction:i})}function C(e){const{environment:t,draftPostStore:n,onSubmitPost:a,from:l}=e,p=t.currentUser.id;n&&p&&(n.isPublishedPost()||(!function(e){const{environment:t,postStore:n}=e;m().createAndCommit({environment:t,perform:e=>(n.getContentStores().toReversed().some((t=>{if(!(0,b().o)(t))return!0;u().zz({childStore:t,parentStore:n,transaction:e})})),n),userAction:"PostChannel.trimPostDraft",canUndo:!1})}({environment:t,postStore:n}),function(e){const{environment:t,blockToDuplicateStore:n,userId:a}=e;if(!n.isDefined())return;const c=(0,i().Yn)(n.getParentPointer(),n.getRecordModel),l=(0,r().wD)(c).map((e=>({...e,role:x(e.role,"comment_only")})));l.push({type:"restricted_permission"}),l.push({type:"user_permission",user_id:a,role:"editor"}),m().createAndCommit({environment:t,perform:e=>{const{blockStores:[i],onComplete:r}=f().duplicateBlock({environment:t,stores:[n],transaction:e,targetSpaceId:n.getSpaceId(),preferDuplicateLocation:"local",options:{addCopyName:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,createActivities:!0}});m().applyOperation({store:i,operation:o().op.update({pointer:i.pointer,path:[],args:{alive:!0,permissions:l,created_time:Date.now(),last_edited_time:Date.now()}}),transaction:e});const a=n.getParentStore();if(!a||"collection"!==a.table)throw new Error("Expected parent store to be a collection");return m().applyOperation({store:i,operation:{pointer:i.pointer,path:[],command:"setParent",args:{parentId:a.id,parentTable:a.table}},transaction:e}),d().zA({stores:[i],update:{draft_status:"published"},transaction:e}),m().applyOperation({store:n,operation:o().op.update({pointer:n.pointer,path:[],args:{alive:!1}}),transaction:e}),e.postSubmitCallbacks.push((()=>r.then((()=>m().createAndCommit({environment:t,perform:e=>(d().zA({stores:[i],update:{draft_status:"published"},transaction:e}),u().s8({blockStore:n,transaction:e}),m().applyOperation({store:n,operation:o().op.update({pointer:n.pointer,path:[],args:{parent_id:n.getSpaceId(),parent_table:s().NX,permissions:[{type:"restricted_permission"}]}}),transaction:e}),n),userAction:"PostChannel.cleanupDraft",canUndo:!1}))))),i},userAction:"PostChannel.publishDraft",canUndo:!1}).performResult}({environment:t,blockToDuplicateStore:n,userId:p}),null==a||a(),_().A.setState({isOpen:!1}),(0,h().u4)({environment:t,event:{eventName:"post_created",eventProperties:{block_id:n.id,parent_collection_id:n.getParentId(),from:l}}}),c().u4({name:"post_created"})))}function x(e,t){if(!e)return e;const n="string"==typeof e&&e in a().TE?a().TE[e]:void 0;if(!n)return e;return n>a().TE[t]?t:e}function R(e){var t,n;const{environment:o,collectionStore:i}=e,r=null===(t=(0,y()._m)(o))||void 0===t?void 0:t.id,a=null===(n=g().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!r||!a||!i)return;return m().createAndCommit({environment:o,perform:e=>{null!=i&&i.isPublishingEnabled()||A({environment:o,collectionStore:i,publishingEnabled:!0,transaction:e});const t=p().Wv({environment:o,transaction:e,type:"page",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache});u().X$({childStore:t,parentStore:i,transaction:e});const n=p().Wv({environment:o,transaction:e,type:"text",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache}),r=v().Bv.createChildStore(t,n.pointer);return p().zv({store:r,transaction:e,data:{alive:!0,parent_id:t.id,parent_table:t.table}}),l().BC({parentStore:t.getContentStore(),appendStore:r,transaction:e}),t},userAction:"PostChannel.createEmptyPostStore",canUndo:!1}).performResult}},390527:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>w,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>x,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>C,MAX_RECURRENCE_INTERVAL:()=>g,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>v,RRULE_WEEKDAYS_MAP:()=>y,adjustedStartDateIfPossible:()=>S,areRecurrenceSchedulesEqual:()=>B,convertFromUnpersistedRecurrenceConfig:()=>P,convertToUnpersistedRecurrenceConfig:()=>j,getFormattedEndCondition:()=>D,getFormattedNextRecurrenceTime:()=>k,getNewEndTimestamp:()=>U,getNextDateUtc:()=>E,getRecurrenceAfter:()=>M,isRunningBetweenMidnightAnd3AM:()=>T,isValidRecurrenceInterval:()=>b,isValidRecurrenceNumberOfRuns:()=>_,rruleFromRecurrence:()=>A,templateAncestorsViolateRecurrenceNesting:()=>R});n(898992),n(354520),n(581454);var o=()=>n(244641);n(944114);function i(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(0===n.length)return e.map((e=>[e]));const r=[];for(const a of e)r.push(...i(n[0],...n.slice(1)).map((e=>[a,...e])));return r}var r=()=>n(496603),a=()=>n(534177),s=()=>n(720665),c=()=>n(597777),d=()=>n(869190),l=()=>n(416504),u=()=>n(402390);class p extends(()=>n(896346))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var m=()=>n(912720);const f=(0,n(959013).YK)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12â€“3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),h={day:p.DAILY,week:p.WEEKLY,month:p.MONTHLY,year:p.YEARLY},y={MO:p.MO,TU:p.TU,WE:p.WE,TH:p.TH,FR:p.FR,SA:p.SA,SU:p.SU},g=99,v=999;function b(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=g}function _(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=v}function A(e){const{start_date:t,frequency:n,interval:o,weekdays:r,timezone:s,hour:d,minute:l}=e,u="week"===n&&r?r.map((e=>y[e])):void 0,m={};return(0,a().O9)(e.end_condition)&&("date"===e.end_condition.type?m.until=(0,c().eU)(e.end_condition.end_at):"number"===e.end_condition.type?m.count=e.end_condition.number_of_occurrences:(0,a().HB)(e.end_condition)),"month"===e.frequency&&(0,a().O9)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?m.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?m.byweekday=i(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return y[t].nth(n)})):(0,a().HB)(e.monthly_restriction)),new p({freq:h[n],dtstart:(0,c().eU)(t),interval:o,byweekday:u,tzid:s,byhour:d??0,byminute:l??0,bysecond:0,...m})}const C=1,x=1;function R(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),o=e.length,i=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,r=o>C,a=n.length>=x;return{violatesConstraint:r||a,templateNestingExceedsMaxDepth:r,ancestorHasDailyTemplate:a,nestedDepthOfAutomationAncestors:o,immediateAncestorRecurrenceType:i}}function S(e){var t;const{recurrence:n,afterDate:i}=e;if("number"===(null===(t=n.end_condition)||void 0===t?void 0:t.type)||n.start_date>=i)return n;let r=o().c9.fromMillis(n.start_date,{zone:"utc"});const a=o().c9.fromMillis(i,{zone:"utc"});switch(n.frequency){case"year":{const e=Math.floor(a.diff(r,"years").years/n.interval);r=r.plus({years:e*n.interval});break}case"month":{const e=Math.floor(a.diff(r,"months").months/n.interval);r=r.plus({months:e*n.interval});break}case"week":{const e=Math.floor(a.diff(r,"weeks").weeks/n.interval);r=r.plus({weeks:e*n.interval});break}case"day":{const e=Math.floor(a.diff(r,"days").days/n.interval);r=r.plus({days:e*n.interval});break}}return{...n,start_date:(0,c().DH)(r.toMillis())}}function M(e){const{recurrence:t,afterDate:n}=e;if((0,m().wt)(t)){const e=(0,c().l1)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=A(S({recurrence:t,afterDate:n})).after((0,c().eU)(n));if(!e)return;return(0,c().h1)(e)}}function T(e){return 0===e.hour||1===e.hour||2===e.hour}function E(e){return A(e).after((0,c().eU)((0,c().Rz)()))||void 0}function k(e){const{recurrence:t,intl:n}=e,i=E(P(t));if(!i)return;const r=T(t),a=o().c9.fromJSDate(i).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,u().H)(n)).setZone(t.timezone),s=(0,d().Yq)({date:a,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(r)return n.formatMessage(f.dateBetweenMidnightAnd3AM,{date:s});{let e=a.toLocaleString(o().c9.TIME_SIMPLE);return t.timezone!==(0,l().P)()&&(e+=` ${a.toFormat("ZZZZ")}`),n.formatMessage(f.dateAtTime,{date:s,time:e})}}function D(e,t){return(0,a().O9)(e)?"number"===e.type?t.formatMessage(f.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,d().Yq)({date:o().c9.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,a().HB)(e):t.formatMessage(f.noEndCondition)}const w=100;function j(e){return{...e,start_date:(0,c().l1)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,c().l1)(e.end_condition.end_at)}:(0,a().HB)(e.end_condition):void 0}}function U(e,t,n){return e.plus(n-t)}function I(e,t){const n=o().c9.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,c().Rz)(n.toJSDate())}}function P(e){return{...e,start_date:(0,c().Rz)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?I(e,e.end_condition):(0,a().HB)(e.end_condition):void 0}}function B(e,t){const n=r().fN(e,(e=>void 0!==e)),o=r().fN(t,(e=>void 0!==e));return r().n4(n,o)}},522500:(e,t,n)=>{n.d(t,{q:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("megaphone",{viewBox:"0 0 64 64",svg:(0,o.jsx)("path",{d:"m54,10v40h-4l-20-10h-4l4,16h-10l-4-16c-4.94,0-8-3.06-8-8v-4c0-4.94,3.06-8,8-8h14l20-10h4Z"})})},659915:(e,t,n)=>{n.d(t,{o:()=>i,s:()=>r});n(898992),n(430670);var o=()=>n(919709);function i(e){return!e.isTransclusionType()&&!e.isCollectionView()&&!e.hasContent()&&e.isEmptyTitle()}function r(e){const t=(0,o().tyK)(e.getTitleValue()),n=e.getContentStores().flatMap((e=>(0,o().tyK)(e.getTitleValue())));return t.length>0||n&&n.length>0}},661945:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{isOpen:!1}}}const i=new o},725649:(e,t,n)=>{function o(e){return!(!e||"askUserToPick"in e)}function i(e){if(!e||!("askUserToPick"in e))return e}function r(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}n.d(t,{DK:()=>i,K$:()=>o,j6:()=>r})},732800:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(296540),i=()=>n(959013),r=n(474848);function a(e){const t=(0,n(847249).K8)((()=>{if(!e.postStore)return 0;const t=(0,n(108944).yQ)(e.postStore);return t?null==t?void 0:t.getRawMembership().length:0}),[e.postStore]);return(0,r.jsx)(n(676007).A,{open:e.isOpen,onDismiss:e.onDismiss,render:()=>(0,r.jsx)(n(887480).Ay,{icon:n(522500).q,title:(0,r.jsx)(i().sA,{id:"posts.confirmMentionEveryoneModal.title",defaultMessage:"Notify {sizeOfTeam} people?",values:{sizeOfTeam:t}}),subtitle:(0,r.jsx)(i().sA,{id:"posts.confirmMentionEveryoneModal.subtitle",defaultMessage:"Using @everyone notifies everyone in the teamspace. Are you sure you want to send this?"}),confirmText:(0,r.jsx)(i().sA,{id:"posts.confirmMentionEveryoneModal.confirmText",defaultMessage:"Send"}),cancelText:(0,r.jsx)(i().sA,{id:"posts.confirmMentionEveryoneModal.cancelText",defaultMessage:"Edit message"}),confirmTextStyle:"red",radioOptions:[],onDismiss:e.onDismiss,onConfirm:e.onConfirm})})}const s=o.memo(a)},747444:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{isOpen:!1,blockStore:void 0}}}const i=new o},809678:(e,t,n)=>{var o=n(746518),i=n(437628),r=n(225397),a=n(206469),s=Array;o({target:"Array",proto:!0},{toReversed:function(){return i(r(this),s)}}),a("toReversed")},853306:(e,t,n)=>{n.d(t,{A:()=>C});n(581454);var o=n(296540),i=()=>n(662303),r=()=>n(847249),a=()=>n(401497),s=()=>n(66913),c=()=>n(284371),d=()=>n(115512),l=()=>n(141333),u=()=>n(265665),p=()=>n(484595),m=()=>n(704152),f=()=>n(864943),h=()=>n(204063),y=()=>n(125565),g=n(474848);const v=20;function b(e){var t;let{icon:s,iconStyle:u,title:p,subtitle:m,confirmText:b,confirmTextStyle:C="blue",confirmTextPerRadioOption:x,cancelText:R,radioOptions:S,defaultSelectedRadioOption:M,onDismiss:T,onSelectRadio:E,onConfirm:k,width:D,footer:w}=e;const j=(0,n(484714).v3)(),[U,I]=(0,o.useState)(M??(null===(t=S[0])||void 0===t?void 0:t.key)),P=(0,r().uB)(void 0,n(17090).A),B=(0,r().K8)((()=>null==P?void 0:P.state.elementRef),[P]),N=(0,l().CR)(B),O=(0,l().yE)(B),z=(0,l().o7)(B),H=O>0,L=Math.ceil(O+z)<Math.floor(N),F=(0,o.useCallback)((e=>{e!==U&&(I(e),null==E||E(e))}),[E,U]),W=(0,o.useCallback)((()=>{k(U)}),[k,U]),Y=(0,a().IS)((e=>{const t={marginLeft:-20,marginRight:-20,height:1,borderTop:`1px solid ${e.regularDividerColor}`,transition:"opacity 200ms"};return{container:{display:"flex",position:"relative",flexDirection:"column",justifyContent:"center",overflow:"hidden",width:`min(${D??400}px, calc(100vw - 40px))`,maxHeight:"80vh",padding:v,borderRadius:6,alignItems:"stretch"},icon:{width:36,height:36,fill:e.icon.secondary,marginBottom:6,...u},iconContainer:{width:"100%",display:"flex",justifyContent:"center"},title:{fontFamily:c().vc(i().locale).sans,fontSize:17,lineHeight:"22px",fontWeight:c().Wy.medium,textAlign:"center",marginBottom:14},subtitle:{fontFamily:c().vc(i().locale).sans,fontSize:(0,d().ny)(j,"UIRegular"),lineHeight:(0,d().ks)(j,"UIRegular"),fontWeight:c().Wy.regular,marginTop:6,marginBottom:6,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column",gap:8},topDivider:{...t,opacity:H?1:0},bottomDivider:{...t,opacity:L?1:0},scroller:{marginLeft:-20,marginRight:-20,paddingLeft:v,paddingRight:v},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{marginTop:8,justifyContent:"center"},dismissButton:{position:"absolute",top:10,right:10,zIndex:1}}}),[j,u,L,H,D]),q=(null==x?void 0:x[U])??b;return(0,g.jsxs)("div",{style:Y.container,children:[(0,g.jsx)("div",{style:Y.dismissButton,children:(0,g.jsx)(_,{onClick:T})}),s&&(0,g.jsx)("div",{style:Y.iconContainer,children:s(Y.icon)}),(0,g.jsx)(y().A,{isMultiline:!0,style:Y.title,children:p}),m&&(0,g.jsx)(y().A,{isSmall:!0,style:Y.subtitle,isMultiline:!0,children:m}),S.length>0&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:Y.topDivider}),(0,g.jsx)(n(2143).H,{type:n(756279).A.Y,style:Y.scroller,store:P,children:(0,g.jsx)("div",{style:Y.radioContainer,children:S.map((e=>(0,g.jsx)(A,{radioItem:e,isSelected:e.key===U,onSelectRadio:F},e.key)))})}),(0,g.jsx)("div",{style:Y.bottomDivider})]}),(0,g.jsxs)("div",{style:Y.actionButtonsContainer,children:["blue"===C?(0,g.jsx)(h().A,{size:"lg",onClick:W,children:q}):"red"===C?(0,g.jsx)(h().A,{size:"lg",onClick:W,isRed:!0,children:q}):(0,g.jsx)(f().A,{size:"lg",onClick:W,children:q}),(0,g.jsx)(f().A,{size:"lg",onClick:T,style:Y.cancelButton,children:R??(0,g.jsx)(n(959013).sA,{id:"radioModal.cancel",defaultMessage:"Cancel"})})]}),w]})}function _(e){let{onClick:t}=e;const n=(0,a().IS)((e=>({button:{display:"flex",justifyContent:"center",alignItems:"center",width:24,height:24,borderRadius:"100%",background:e.lightGrayButtonBackground},buttonHovered:{background:e.lightGrayButtonHoveredBackground},buttonPressed:{background:e.lightGrayButtonPressedBackground},closeIcon:{width:16,height:16,fill:e.icon.secondary}})),[]);return(0,g.jsx)(m().A,{style:n.button,hoveredStyle:n.buttonHovered,pressedStyle:n.buttonPressed,onClick:t,children:(0,s().V)(n.closeIcon)})}function A(e){let{radioItem:t,isSelected:n,onSelectRadio:o}=e;const i=(0,a().IS)((e=>({button:{display:"flex",justifyContent:"space-between",gap:10,height:"auto",minHeight:70,borderRadius:8,paddingTop:12,paddingBottom:12,paddingLeft:14,paddingRight:14-p().p,border:void 0,boxShadow:n?`inset 0 0 0 1px ${e.icon.uiBluePrimary}`:`inset 0 0 0 1px ${e.stroke.primary}`},buttonText:{display:"flex",flexDirection:"column",gap:2,...c().RC},optionTitle:{fontWeight:c().Wy.medium},optionSubtitle:{whiteSpace:"break-spaces"}})),[n]);return(0,g.jsxs)(f().A,{size:"lg",onClick:()=>o(t.key),style:i.button,children:[(0,g.jsxs)("div",{style:i.buttonText,children:[(0,g.jsx)(y().A,{style:i.optionTitle,children:(0,g.jsx)(u().j,{children:t.title})}),t.subtitle&&(0,g.jsx)(y().A,{isSmall:!0,isMultiline:!0,style:i.optionSubtitle,children:t.subtitle})]}),(0,g.jsx)(p().A,{isSelected:n})]})}const C=o.memo(b)},887480:(e,t,n)=>{n.d(t,{Ay:()=>i().A,yQ:()=>a});var o=()=>n(645873),i=()=>n(853306);const r=new(o().O2)("radioModalRenderer",(()=>n.e(35818).then(n.bind(n,415995)))),a=(0,o()._h)(r,(e=>e.default))}}]);