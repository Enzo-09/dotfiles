"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[21088,78217],{10289:(e,t,n)=>{n.d(t,{Y:()=>i});var o=()=>n(645873);const r=new(o().O2)("invoice",(async()=>await n.e(60896).then(n.bind(n,430600)))),i=(0,o()._h)(r,(e=>e.Invoice))},69447:(e,t,n)=>{n.d(t,{Lq:()=>o,WK:()=>i,nh:()=>r});const o=40,r=48,i=60},75600:(e,t,n)=>{n.d(t,{O:()=>i,t:()=>r});var o=()=>n(645873);const r=(0,o()._h)(new(o().O2)("PeekRenderer",(async()=>{const{default:e}=await Promise.all([n.e(16471),n.e(28866),n.e(21194),n.e(60499),n.e(13402),n.e(44632),n.e(43151)]).then(n.bind(n,334111));return{PeekRenderer:e}})),(e=>e.PeekRenderer)),i=(0,o()._h)(new(o().O2)("RestrictedAccess",(async()=>{const{RestrictedAccessComponent:e}=await n.e(57314).then(n.bind(n,260775));return{RestrictedAccessComponent:e}})),(e=>e.RestrictedAccessComponent))},137493:(e,t,n)=>{n.d(t,{j:()=>o});const o=new(n(178624).R)({key:"SimulateOffline",namespace:"Offline",important:!0,trackingType:"necessary"})},149257:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(296540),r=()=>n(959013),i=n(474848);const a=(0,r().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const s=function(e){const{teamStore:t,teamName:s,teamId:c,isModalOpen:l,onDismiss:d}=e,[u,p]=(0,o.useState)(""),m=(0,n(484714).v3)(),f=(0,r().tz)(),g=async()=>{await n(350648).Ip({environment:m,teamId:c,message:u}),d()},v=(0,n(401497).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,i.jsx)(n(676007).A,{open:l,onDismiss:d,innerStyle:v.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:v.requestTitle,children:(0,i.jsx)(r().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:s,icon:(0,i.jsx)(n(898808).x,{style:v.icon,store:t,disabled:!0,size:22})}})}),(0,i.jsx)(n(623580).A,{textarea:!0,style:v.input,value:u,onChange:e=>{p(e.target.value)},placeholder:f.formatMessage(a.message_placeholder)}),(0,i.jsxs)("div",{style:v.footer,children:[(0,i.jsx)(n(125565).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,i.jsx)(r().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,i.jsx)(n(204063).A,{size:"lg",style:v.requestInvitesButton,onClick:g,children:(0,i.jsx)(r().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},171510:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>b});n(898992),n(354520);var o=n(296540),r=()=>n(484714),i=()=>n(847249);const a="initial_handshake";var s=()=>n(798880),c=()=>n(959013),l=()=>n(496603),d=()=>n(763824),u=()=>n(498212),p=()=>n(780054),m=()=>n(630116),f=()=>n(179534),g=()=>n(214006),v=n(474848);const h=1;function b(){const e=(0,r().v3)(),t=(0,c().tz)(),n=`${p().A.identity.domainBaseUrl}/authSync`,b=e.currentUser.isLoggedIn(),[S,y]=(0,o.useState)(null),[w,A]=(0,o.useState)({value:!1,count:0}),I=(0,i().K8)((()=>f().A.getTotalUnreadMentionsCount()),[]),k=(0,i().K8)((()=>g().A.getAllSpaceViewStores(e)),[e]);(0,o.useEffect)((()=>{const e=t=>{const n=p().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(y(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,o.useEffect)((()=>{b&&(w.value||0===w.count||null==S||S.postMessage({version:h,name:"unreadCount",source:"notion",unreadCount:I}))}),[b,w.count,w.value,S,I]);const C=(0,o.useCallback)((async()=>{const e=l().hS(k,"userId"),n=await(0,d().lX)(e,10,(async e=>{if(!e.userId)return;const n=m().LU.createChildStore(e,{table:s().oo,id:e.userId});await n.load();const o=n.getEmail()??"",r=n.getDisplayName(t)??"";return{id:e.userId,displayName:r,emailAddress:o}}));null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,S,k]);(0,o.useEffect)((()=>{b&&S&&(w.value||0===w.count)&&C()}),[b,C,w.count,w.value,S]),(0,o.useEffect)((()=>{e.currentUser.id&&!(0,u().uj)(e.currentUser.id)||null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id?e.currentUser.id:"",type:"mutation"})}),[e.currentUser.id,S]),(0,o.useEffect)((()=>{b||(null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"}),null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:[],persistCookie:!0}))}),[b,S]);const x=(0,o.useCallback)((e=>{if(e.data.version!==h)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)A((e=>({value:!0,count:e.count+1})))}),[]);return(0,o.useEffect)((()=>(y((e=>(e&&(e.onmessage=x),e))),()=>{y((e=>(e&&(e.onmessage=null),e)))})),[x,S]),(0,v.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(a,p().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},245500:(e,t,n)=>{var o=()=>n(645873);const r={WorkflowTemplatesBuilderNotInProd:new(o().O2)("WorkflowTemplateBuilderNotInProd",(async()=>await Promise.all([n.e(92845),n.e(48486),n.e(63077),n.e(90966),n.e(94611)]).then(n.bind(n,228474)))),CollectionItemNameConfigMenuItemNotInProd:new(o().O2)("CollectionItemNameConfigMenuItemNotInProd",(async()=>await n.e(12062).then(n.bind(n,120364))))};(0,o()._h)(r.WorkflowTemplatesBuilderNotInProd,(e=>e.WorkflowTemplatesBuilderNotInProd)),(0,o()._h)(r.CollectionItemNameConfigMenuItemNotInProd,(e=>e.CollectionItemNameConfigMenuItemNotInProd))},249696:(e,t,n)=>{n.d(t,{W:()=>i});var o=()=>n(847249),r=()=>n(540144);function i(){return(0,o().K8)((()=>(0,r().M5)()),[])}},253849:(e,t,n)=>{n.d(t,{S:()=>i});var o=()=>n(645873);const r=new(o().O2)("AppComponents",(async()=>Promise.all([n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(3965),n.e(84341),n.e(80533),n.e(45620),n.e(58221),n.e(44763),n.e(8081),n.e(67183),n.e(64598),n.e(82720),n.e(4253),n.e(86787),n.e(77465),n.e(24593),n.e(80896),n.e(1440),n.e(67378),n.e(58504),n.e(97308),n.e(63996),n.e(20636),n.e(66268),n.e(55717),n.e(7005),n.e(40186),n.e(22585),n.e(73206),n.e(11037),n.e(33235),n.e(91957),n.e(84176),n.e(16357),n.e(75681)]).then(n.bind(n,592680)))),i=(0,o()._h)(r,(e=>e.AppComponents))},256863:(e,t,n)=>{n.d(t,{A:()=>a});n(296540);var o=()=>n(847249),r=()=>n(824862),i=n(474848);const a=function(e){const{botValue:t,botStore:a,showActiveDot:s,style:c,size:l}=e,d=(0,n(959013).tz)(),u=(0,o().K8)((()=>{if(a){const e=a.getIcon();if(e)return{pointer:{table:r().GP,id:a.id,spaceId:a.getSpaceId()},icon:e}}else if(null!=t&&t.icon)return{pointer:{table:r().GP,id:t.id,spaceId:t.space_id},icon:t.icon}}),[a,t]),p=(0,o().K8)((()=>(null==a?void 0:a.getDisplayName(d))??(0,n(799288).Hg)(t)),[a,t,d]),{activeDotStyle:m}=(0,n(401497).IS)((e=>({activeDotStyle:{height:10,width:10,backgroundColor:e.accentColors.green[400],border:"2px solid white",borderRadius:"50%",position:"absolute",left:11,top:11}})),[]);return(0,i.jsxs)("div",{style:c,children:[(0,i.jsx)(n(614505).B,{icon:u,title:p,size:l||18,disabled:!0,isEmptyPage:!1,useInvertedColors:!0}),s?(0,i.jsx)("div",{style:m}):void 0]})}},276324:(e,t,n)=>{n.r(t),n.d(t,{mainApp:()=>o});n(16280);async function o(e){const{minimalEnvironment:t,mainStartTime:o,prefetchInitiatedTime:r,prefetchCache:i,initializeStatsigResult:a,currentUserId:s}=e,{device:c}=t,[{setupOnBeforeUnload:l},d,{createClientEnvironment:u},{setupTransactionQueue:p},{default:m},f]=await Promise.all([Promise.resolve().then(n.bind(n,840125)),Promise.resolve().then(n.bind(n,857639)),Promise.resolve().then(n.bind(n,316145)),Promise.resolve().then(n.bind(n,589994)),Promise.resolve().then(n.bind(n,518888)),Promise.resolve().then(n.bind(n,907828))]);let g=await u({minimalEnvironment:t,prefetchCache:i,currentUserId:s});const{ElectronSqlite:v,RouterStore:h}=g;f.setupRecordCacheDebugging(c);const b=await p(g);l({device:c,TransactionQueue:b,AppUpdateStore:g.AppUpdateStore,GlobalFileUploadStore:m});const[S,{default:y}]=await Promise.all([Promise.resolve().then(n.bind(n,652393)),Promise.resolve().then(n.bind(n,406792))]);if(S.initialize(g),c.isMobileNative){const e=y.DO_NOT_USE_markLegacy("mobilenative.initialize_from_js"),[t,o,r]=await Promise.all([Promise.resolve().then(n.bind(n,324234)),Promise.resolve().then(n.bind(n,475133)),Promise.resolve().then(n.bind(n,79059))]);await t.initializeMobileNativeApp(g),Object.assign(d.clientLogglyEnvironmentData,o.getMobileNativeDeviceInfo(),r.getMobileNativeSessionInfo()),y.DO_NOT_USE_measureLegacy(e,{environment:g,data:{}})}if(c.isElectron){const e=y.mark("desktop.initialize_from_js"),t=await Promise.resolve().then(n.bind(n,705540));await t.initializeElectron({device:c,electronSqlite:v,routerStore:h});const o=await Promise.resolve().then(n.bind(n,250182)),r=await o.getDesktopDeviceInfo();Object.assign(d.clientLogglyEnvironmentData,r,{desktopVersion:c.desktopAppVersion}),y.measure(e,{environment:g})}const[w,A,I,k,C,x]=await Promise.all([Promise.resolve().then(n.bind(n,719431)),Promise.resolve().then(n.bind(n,869562)),Promise.resolve().then(n.bind(n,906537)),Promise.resolve().then(n.bind(n,604643)),Promise.resolve().then(n.bind(n,751156)),Promise.resolve().then(n.bind(n,344300))]),{setupTransactionLoadGenerator:T}=await Promise.resolve().then(n.bind(n,993893));T(g);const[{default:_},P,E,U,{CurrentUser:L},{getGhostAdminUserId:M},{default:R}]=await Promise.all([Promise.resolve().then(n.bind(n,669944)),Promise.resolve().then(n.t.bind(n,296540,19)),Promise.resolve().then(n.t.bind(n,440961,19)),Promise.resolve().then(n.t.bind(n,205338,19)),Promise.resolve().then(n.bind(n,590966)),Promise.resolve().then(n.bind(n,529543)),Promise.resolve().then(n.bind(n,508496))]);I.startListeners(c),g=await w.initialize(g),g.currentUser.id&&g.defaultRecordCache.persistedRecordCache&&x.readAndCacheOfflinePagesMemo({userId:g.currentUser.id,persistedRecordCache:g.defaultRecordCache.persistedRecordCache,tellOtherTabsToUpdate:!1}),g.updateCurrentUserId=async e=>{const t=await M(g),n={...e.environment,currentUser:new L({id:e.currentUserId,loggedInUserIds:e.userIds,adminUserId:t})};await Y(n),n.idCreator.updateCurrentUserId(e.currentUserId)},k.initialize(g),b.startLoop();const[{maybeClearCookies:j,refreshNotionCookies:N,validateHasPermissionArgs:B,clearNotionCookiesWithNoPermission:D,clearThirdPartyCookiesAndLocalStorageWithNoPermission:O},{clearNotionLocalStorageWithNoPermission:q},z,W,K,V,{default:$},F]=await Promise.all([Promise.resolve().then(n.bind(n,529543)),Promise.resolve().then(n.bind(n,422920)),Promise.resolve().then(n.bind(n,14307)),Promise.resolve().then(n.bind(n,915086)),Promise.resolve().then(n.bind(n,410690)),Promise.resolve().then(n.bind(n,571963)),Promise.resolve().then(n.bind(n,567417)),Promise.resolve().then(n.bind(n,842677))]);j(),Promise.all([D(g),O(g)]).then((()=>N(g))),q(),B(g);const[{TransactionQueueDependenciesImpl:G},{waitForStatsigInitialization:H},{isPrewarmedTabInitialRender:J}]=await Promise.all([Promise.resolve().then(n.bind(n,866184)),Promise.resolve().then(n.bind(n,546369)),Promise.resolve().then(n.bind(n,571963))]);let Z,X;async function Y(e){const t=performance.now(),{didStatsigBootupTimeout:n}=await H({environment:g,initializeStatsigResult:a});Z??=R.checkGate({gateName:"react_18_concurrent_rendering"});const i=performance.now(),s=document.querySelector("#notion-app");if(!s)throw new Error('Could not find element with id "notion-app"');b.updateDependencies(new G(e)),C.updateConnectionState(e),z.updateEnvironment(e),d.clientLogglyEnvironmentData.userId=e.currentUser.id;const c=()=>{const e=document.getElementById("initial-loading-spinner"),a=document.getElementById("skeleton");e&&e.remove(),a&&a.remove();const s=performance.now();W.setSubMetricsAtRenderCallback({mainStartTime:o,prefetchInitiatedTime:r,statsigBootupBlockingStartTime:t,renderStartTime:i,renderEndTime:s});const c=K.getAppStartTime();c&&y.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_app_start",startTime:0,endTime:c},{environment:g,data:{sub_metrics:V.getTimeOriginToAppStartSubMetrics()}}),y.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_prefetch_initiated",startTime:0,endTime:r},{environment:g}),$.state&&y.measure({metricName:"client.migrate_sqlite",startTime:$.state.startTime,endTime:$.state.endTime},{environment:g}),y.measure({metricName:"statsig_bootup_blocking",startTime:t,endTime:i},{environment:g,data:{timed_out:n,is_prewarmed_tab:J(g)}})},l=P.createElement(_,{environment:e,onMount:Z?c:void 0});Z?(X??=U.createRoot(s),X.render(l)):E.render(l,s,c)}A.initialize(g),await Y(g);const{startFlushing:Q}=await Promise.resolve().then(n.bind(n,459225));return Q(((e,t)=>{y.measure(e,{environment:g,preboot:!0,shouldSendIfStatsigNotInitialized:!0,shouldExcludeFromTimeline:!0,data:t})})),{transactionQueue:b,environment:g}}},291606:(e,t,n)=>{n.d(t,{AC:()=>i,dE:()=>s,Nw:()=>c,tn:()=>a});var o=()=>n(989423);const r=new(n(178624).R)({key:"offline_autosync_setting",namespace:n(419494).cd,important:!0,trackingType:"necessary"});function i(){return"on"===r.getState()}function a(e){let{environment:t}=e;const n=i()?"off":"on";(0,o().u4)({environment:t,event:{eventName:"offline_autosyncing_toggled",eventProperties:{toggle_status:n}}}),r.setState(n)}function s(){return r.getState()}function c(e){r.setState(e)}},309770:(e,t,n)=>{n.d(t,{P:()=>m,U:()=>p});var o=()=>n(847249),r=()=>n(231722),i=()=>n(792002),a=()=>n(301421),s=()=>n(351360),c=()=>n(24157),l=()=>n(751156),d=()=>n(755199);function u(){const e=c().default.state;if("editing"===e.mode){const t=(0,r().H7)(e.multiSelection);if(t&&(0,i().gE)(t.selection)){const e=t.store,n=a().n.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function p(){return(0,o().K8)(u,[])}function m(e){const{currentUserSettingsStore:t}=s().default.state;t&&l().createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{d().mJ({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},canUndo:!0,userId:t.id})}},313633:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var o=()=>n(401497),r=()=>n(66913),i=()=>n(197190),a=n(474848);function s(e){const{top:t,right:n,onClick:s}=e,c=(0,o().IS)((e=>({buttonBackground:{position:"absolute",top:t??12,right:n??12,width:22,height:22,borderRadius:"100%",background:e.buttonBackground},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},buttonHovered:{background:e.buttonHoveredBackground},icon:{width:14,fill:e.icon.secondary}})),[t,n]);return(0,a.jsx)("div",{style:c.buttonBackground,children:(0,a.jsx)(i().A,{style:c.button,hoveredStyle:c.buttonHovered,onClick:s,children:(0,r().V)(c.icon)})})}},316145:(e,t,n)=>{n.r(t),n.d(t,{createClientEnvironment:()=>ae});var o=()=>n(221844),r=()=>n(711740),i=()=>n(590966),a=()=>n(396487),s=()=>n(609990),c=()=>n(299972),l=()=>n(110750),d=()=>n(721338),u=()=>n(138418),p=()=>n(628182),m=()=>n(745875),f=()=>n(705540),g=()=>n(851650);class v extends(()=>n(573442))().K{constructor(e){super({...e,mapSpaceIdToShortId:t=>e.mapSpaceIdToShortId(this.currentUserId,t)}),this.currentUserId=void 0,this.currentUserId=e.currentUserId}updateCurrentUserId(e){this.currentUserId=e}}var h=()=>n(529543),b=()=>n(520348),S=()=>n(245865),y=()=>n(165162),w=(n(16280),n(944114),n(898992),n(430670),n(803949),n(581454),()=>n(857639)),A=()=>n(388821),I=()=>n(179034),k=()=>n(651170),C=()=>n(445120),x=()=>n(359391),T=()=>n(496603),_=()=>n(502800),P=()=>n(989423),E=()=>n(406792);let U=1;class L{constructor(e){this.connection=void 0,this.maxSize=void 0,this.getEnvironment=void 0,this.getLatency=new(n(293596).B),this.batchReadWorkers=15,this.queuedGetErrors=[],this.pendingWrites=A().RecordMapPolymorphic.create(),this.getManyFromDisk=async e=>{const t=A().RecordMapPolymorphic.create();e.forEach(((e,n)=>{let{pointer:o}=e;t.set(o,n)}));const n=await x().tB(this.connection,e),o=A().RecordMapPolymorphic.create();for(const r of n)this.setCachedRecordMap(o,r);return e.map((e=>{let{pointer:t,userId:n}=e;const r=this.getInMemory(t,n);if(r)return r;const i=o.get(t);return i&&i[n]}))},this.diskReadQueue=new(n(56322).A)({batchSize:Math.floor(n(430476).Zj/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=A().RecordMapPolymorphic.create();const t=Array.from(e).flatMap((e=>{let{value:t}=e;return t?Object.values(t):[]})),o=E().default.DO_NOT_USE_markLegacy("sqlite_record_cache.flush_writes.duration");try{await x()._D(this.connection,t);const e={status:"success"};P().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),E().default.DO_NOT_USE_measureLegacy(o,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}catch(r){w().log({level:"warning",from:"SqliteRecordCache",type:"applyRecordCacheOperationsError",error:(0,_().convertErrorToLog)(r),data:(0,k().CS)(r,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error"};P().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),E().default.DO_NOT_USE_measureLegacy(o,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}n(508496).default.checkGate({gateName:"download_for_offline"})||navigator.locks.request("sqliteRecordCacheEviction",{mode:"exclusive",ifAvailable:!0},(async e=>{if(!e)return;const t=await this.getTablesThatNeedEviction();if(0===t.length)return;const o=await(0,n(97059).w)({environment:this.getEnvironment()});await this.evictTables({tables:t,offlineRecordIds:o})}))},this.debouncedFlushWrites=T().sg(this.flushWrites,500,{maxWait:3e3}),this.throttledLogGetErrorBatched=T().nF(this.logGetErrorBatched,3e3,{leading:!1,trailing:!0}),this.connection=e.connection,this.maxSize=e.maxSize,this.getEnvironment=e.getEnvironment}getDedicatedWorkerConnection_DEBUG_ONLY(){var e,t;return null===(e=(t=this.connection).getDedicatedWorkerConnection_DEBUG_ONLY)||void 0===e?void 0:e.call(t)}set(e){const{pointer:t,value:o,importance:r,maybeStaleRecordMap:i}=e;if(void 0===t||void 0===t.id){const e=new Error("Attempting to set a record with an invalid pointer.");return w().log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:e.stack},data:{pointer:t}}),void n(449412).Fg(e)}const a=e.userId||C().m,s={pointer:t,userId:a,value:o,timestamp:Date.now(),importance:r};this.removePendingWrite(t,a,"delete"),this.enqueueWrite({type:"set",record:s,maybeStaleRecord:i})}async get(e){const{pointer:t,skipAccessWrites:n}=e,o=`get ${U}`,r=e.userId||C().m;let i;U++,this.getLatency.start(o);try{const e=this.getInMemory(t,r);if(e)return n||this.enqueueWrite({type:"access",record:e}),this.getLatency.end(o,"memory"),e.value;i=E().default.DO_NOT_USE_markLegacy("sqlite_record_cache.get_record.duration");const a=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:t,userId:r}):this.getFromDiskUnbatched(t,r));if(a){n||this.enqueueWrite({type:"access",record:a}),this.getLatency.end(o,"disk");const e={status:"success"};return P().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),E().default.DO_NOT_USE_measureLegacy(i,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}),a.value}}catch(a){a instanceof k().PW||a instanceof k().lh?(this.queuedGetErrors.push(a),this.throttledLogGetErrorBatched(),this.getEnvironment().defaultRecordCache.disablePersistedRecordCache()):w().log({level:"warning",from:"SqliteRecordCache",type:"getError",error:(0,_().convertErrorToLog)(a),data:(0,k().CS)(a,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error"};return P().cX({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),void(i&&E().default.DO_NOT_USE_measureLegacy(i,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}))}finally{this.getLatency.end(o,"miss")}}deleteRecord(e,t){t=t||C().m,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}async getBlocksWithParent(e){const t=Date.now(),n=e.userId||C().m,o=await x().rH(this.connection,{...e,timestamp:t,userId:n}),r=A().RecordMapPolymorphic.create(),i=T().oE(Array.from(this.pendingWrites).map((o=>{const i=o&&o.value&&n&&o.value[n];if(!i||"set"!==i.type)return;const a=i.record.value?i.record.value.value:void 0;if(!a)return;if(i.record.pointer.table!==I().ev)return;const s=a;return s.parent_id===e.parent.id&&s.parent_table===e.parent.table?(r.set(i.record.pointer,!0),i.record.timestamp<t&&(i.record.timestamp=t),i.record.value):void 0})));for(const a of o)r.get(a.pointer)||this.getInMemory(a.pointer,a.userId)||i.push(a.value);return i}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||C().m,o=await x().NJ(this.connection,{...e,timestamp:t,userId:n});return o.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),o}async getOfflinePages(e){const{userId:t,orderBy:n}=e;return await x().W9({connection:this.connection,userId:t,orderBy:n})}async getOfflineOriginPages(e){const{userId:t}=e;return await x().Kg({connection:this.connection,userId:t})}async getOfflineAutosyncedOrigins(e){const{userId:t}=e;return await x().M2({connection:this.connection,userId:t})}async isPageAvailableOffline(e){const{pageId:t,userId:n}=e;return await x().gh({connection:this.connection,pageId:t,userId:n})}async getOfflineActions(e){const{impactedPageId:t,userId:n}=e;return await x().Pf({connection:this.connection,impactedPageId:t,userId:n})}async getOfflineLastDownloadedVersion(e){return await x().d6({...e,connection:this.connection})}async getOfflinePageMetadata(e){return await x().cz({...e,connection:this.connection})}async addOfflinePage(e){const{userId:t,pageId:n}=e;await x().i4({connection:this.connection,userId:t,pageId:n})}async addOfflineAction(e){const{userId:t,originPageId:n,impactedPageId:o,autosyncTypes:r}=e;await x().Fo({connection:this.connection,userId:t,originPageId:n,impactedPageId:o,autosyncTypes:r})}async deleteOfflineActionsAndCleanUp(e){const{userId:t,impactedPageIds:n,originPageId:o}=e;await x().JP({connection:this.connection,userId:t,originPageId:o,impactedPageIds:n})}async addOfflinePageAndOfflineAction(e){const{userId:t,impactedPageId:n,originPageId:o,autosyncTypes:r,downloadStatus:i}=e;await x().OR({connection:this.connection,userId:t,impactedPageId:n,originPageId:o,autosyncTypes:r,downloadStatus:i})}async updateOfflinePageLastDownloadedMetadata(e){const{pageId:t,userId:n,lastDownloadedAt:o,lastDownloadedVersion:r}=e;await x().qM({connection:this.connection,pageId:t,userId:n,lastDownloadedAt:o,lastDownloadedVersion:r})}async getPageIdsToGarbageCollect(e){const{originPageId:t,userId:n,visitedBlockIds:o,skippedCollectionIds:r}=e;return await x().An({connection:this.connection,originPageId:t,userId:n,visitedBlockIds:o,skippedCollectionIds:r})}async getTeams(e){const{spaceId:t,userId:n,includeArchived:o=!1}=e;return await x().ZN({connection:this.connection,spaceId:t,userId:n,includeArchived:o})}async deleteOfflineActionsWithOriginPageIdAndCleanUp(e){const{originPageId:t,userId:n,autosyncType:o}=e;return await x().Li({connection:this.connection,originPageId:t,userId:n,autosyncType:o})}async removeAllOfflineAutosyncedOrigins(e){const{userId:t}=e;return await x().zv({connection:this.connection,userId:t})}async isPageExplicitlyToggledOffline(e){const{pageId:t,userId:n}=e;return await x().OL({connection:this.connection,pageId:t,userId:n})}async getInlineCollectionsInOfflinePage(e){const{pageId:t,userId:n}=e;return x().ew({connection:this.connection,pageId:t,userId:n})}async getPageDownloadStatus(e){const{pageId:t,userId:n}=e;return await x().sm({connection:this.connection,pageId:t,userId:n})}async setPageDownloadStatus(e){const{pageId:t,userId:n,downloadStatus:o}=e;await x().g8({connection:this.connection,pageId:t,userId:n,downloadStatus:o})}async getOfflineLastDownloadedAt(e){const{pageId:t,userId:n}=e;return await x().g_({connection:this.connection,pageId:t,userId:n})}async updateOfflineMetadataLastExecutedAt(e){const{userId:t,taskType:n,lastExecutedAt:o}=e;await x().I6({connection:this.connection,userId:t,taskType:n,lastExecutedAt:o})}async getOfflineMetadataLastExecutedAt(e){const{userId:t,taskType:n}=e;return await x().TI({connection:this.connection,userId:t,taskType:n})}async reset(){this.pendingWrites=A().RecordMapPolymorphic.create(),await x().tV(this.connection)}async deleteAllRecordTables(){try{await x().ry(this.connection),await x().lg(this.connection),await x().Wr(this.connection)}catch(e){w().log({level:"error",from:"SqliteRecordCache",type:"deleteAllRecordTablesError",error:(0,_().convertErrorToLog)(e)})}}setEnvironment(e){this.getEnvironment=()=>e}async flushPendingWrites(){await this.flushWrites()}async getCorruptTables(){return await x().ZU({connection:this.connection})}async completelyRebuildSqliteDb(){this.pendingWrites=A().RecordMapPolymorphic.create(),await this.connection.completelyRebuildSqliteDb()}async backupOfflineTables(){return await x().Nt({connection:this.connection})}async restoreOfflineTablesBackup(e){return await x().Rr({connection:this.connection,backup:e})}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,o=this.pendingWrites.get(t),r=o&&o[n];if(r){if("set"===r.type&&"access"===e.type){const t={type:"set",record:{...r.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===r.type&&!r.maybeStaleRecord&&r.record.value&&r.record.value.value?r.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),o=n&&n[t];if(o&&"set"===o.type)return o.record}setCacheOperationMap(e,t){const n=t,{pointer:o,userId:r}=n.record,i=e.get(o)||{};e.set(o,{...i,[r]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:o}=t,r=e.get(n)||{};e.set(n,{...r,[o]:t})}removePendingWrite(e,t,n){const o=this.pendingWrites.get(e);o&&o[t]&&o[t].type===n&&this.pendingWrites.delete(e)}logGetErrorBatched(){const e=this.getEnvironment(),t=T().$z(this.queuedGetErrors,(e=>(0,_().convertErrorToLog)(e).message));for(const[n,o]of Object.entries(t)){if(!n)break;w().log({level:"warning",from:"SqliteRecordCache",type:"getErrorBatched",error:(0,_().convertErrorToLog)(o[0]),data:{batchedData:o.map((t=>(0,k().CS)(t,{isBrowser:e.device.isBrowser})))}},{forceSuppressConsoleLog:!0})}this.queuedGetErrors=[]}async getTablesThatNeedEviction(){try{return await x().W3({connection:this.connection,maxSize:this.maxSize})}catch(e){return P().u4({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"get_tables_failed"}},opts:{preboot:!0}}),w().log({level:"warning",from:"SqliteRecordCache",type:"getTablesThatNeedEvictionFailed",error:(0,_().convertErrorToLog)(e)}),[]}}async evictTables(e){const{tables:t,offlineRecordIds:n}=e;try{await x().$c({connection:this.connection,tables:t,maxSize:this.maxSize,offlineRecordIds:n}),P().u4({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction",eventProperties:{}},opts:{preboot:!0}})}catch(o){P().u4({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"eviction_failed"}},opts:{preboot:!0}}),w().log({level:"warning",from:"SqliteRecordCache",type:"evictionFailed",error:(0,_().convertErrorToLog)(o)})}}}var M=()=>n(206267),R=()=>n(866540),j=()=>n(735270);const N=[WebSocket.OPEN,WebSocket.CONNECTING];class B{constructor(){this.sqliteConnection=void 0,this.requests=new Map}async initialize(){"message-ports"===await this.getConnectionType()?await this.initializeMessagePort():await this.initializeWebSocket()}async getConnectionType(){var e;const{preferences:t}=await f().electronAppFeatures.get()||{};if("message-ports"===(null==t?void 0:t.sqliteConnectionType))return"message-ports";const n=f().getDesktopVersion();if(n&&n[0]>=4)return"message-ports";const o=navigator.userAgent.match(/Notion\/(\d+\.\d+\.\d+)/);if(o){const[,e]=o,[t]=e.split(".").map(Number);if(t>=4)return"message-ports"}return null!==(e=f().electronApi)&&void 0!==e&&e.sqliteServerEnabled?"web-sockets":null}async initializeMessagePort(){await this.initializeMessagePortConnection();const e={execSqliteBatchV2:async e=>{let{batch:t,precondition:n}=e;return this.execSqliteBatchInnerMessagePort({id:M().JW(),batch:t,precondition:n})},execSqliteBatch:async e=>this.execSqliteBatchInnerMessagePort({id:M().JW(),batch:e}),completelyRebuildSqliteDb:async()=>this.completelyRebuildSqliteDbInnerMessagePort(M().JW())};this.sqliteConnection=new(j().i)({connection:e,type:"v2",migrations:await(0,R().G)(e)})}async initializeWebSocket(){await this.initializeWebSocketConnection();const e={execSqliteBatchV2:async e=>{const t=M().JW(),{batch:n,precondition:o}=e,r=JSON.stringify({id:t,batch:n,precondition:o,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,r)},execSqliteBatch:async e=>{const t=M().JW(),n=JSON.stringify({id:t,batch:e,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,n)},completelyRebuildSqliteDb:async()=>{}};this.sqliteConnection=new(j().i)({connection:e,type:"v2",migrations:await(0,R().G)(e)})}async execSqliteBatchInnerWebSockets(e,t){const n=new Promise((t=>{this.requests.set(e,t)}));this.ws.readyState===WebSocket.CLOSED&&await this.initializeWebSocket();try{this.ws.send(t)}catch(r){const e=this.ws;this.ws.onopen=function(n){e.send(t)}}const o=await n;if(o.error)throw new Error("Received SQLite error.");return o.value}async execSqliteBatchInnerMessagePort(e){const t=new Promise((t=>{this.requests.set(e.id,t)}));this.messagePort||await this.initializeMessagePortConnection(),this.messagePort.postMessage(e);const n=await t;if(n.error)throw new Error("Received SQLite error.");return n.value}async completelyRebuildSqliteDbInnerMessagePort(e){const t={id:e,command:"completelyRebuildSqliteDb",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));this.messagePort||await this.initializeMessagePortConnection(),this.messagePort.postMessage(t);if((await n).error)throw new Error("completelyRebuildSqliteDb error.")}async initializeMessagePortConnection(){return new Promise((async e=>{var t;if(null===(t=f().electronApi)||void 0===t||!t.getSqliteMeta)return;if(this.messagePort)return;const n=t=>{try{if(!t.ports.length||t.source!==window)return;this.messagePort=t.ports[0],this.messagePort.onclose=()=>{this.messagePort=void 0},this.messagePort.onmessage=e=>{const{id:t,result:n}=e.data,o=this.requests.get(t);o&&(this.requests.delete(t),o({value:n}))},window.removeEventListener("message",n),e()}catch(o){w().log({level:"error",from:"electronSqlite",type:"messagePortError",error:(0,_().convertErrorToLog)(o)})}};window.addEventListener("message",n);(await f().electronApi.getSqliteMeta()).error}))}async initializeWebSocketConnection(){var e;if(null===(e=f().electronApi)||void 0===e||!e.getSqliteMeta)return;const t=await f().electronApi.getSqliteMeta();if(t.error)return;if(this.ws&&N.includes(this.ws.readyState))return;const{serverProcessPort:n,authToken:o}=t.value;this.authToken=o;const r=`ws://127.0.0.1:${n}`;this.ws=new WebSocket(r),this.ws.onclose=()=>{w().log({level:"warning",from:"electronSqlite",type:"reinitializingWebsocket"}),this.initializeWebSocketConnection()},this.ws.addEventListener("message",(e=>{const t=e.data.toString(),{id:n,result:o}=JSON.parse(t),r=this.requests.get(n);r&&(this.requests.delete(n),r({value:o}))})),await new Promise((e=>{this.ws.onopen=()=>{e()}}))}}n(814603),n(147566),n(198721);var D=()=>n(681335);Error;class O{constructor(e){this.initializePromise=void 0,this.dedicatedWorkerConnection=void 0,this.initializePromise=this.initialize(e)}async waitForInitialize(){await this.initializePromise}async execSqliteBatch(e){return(await this.initializePromise).execSqliteBatch(e)}async completelyRebuildSqliteDb(){return(await this.initializePromise).completelyRebuildSqliteDb()}getDedicatedWorkerConnection_DEBUG_ONLY(){return this.dedicatedWorkerConnection}async initialize(e){const{loadWorker:t,loadSharedWorker:o}=e,r=M().JW(),i=t(),a=o(),s=D().LV(a.port);var c;this.dedicatedWorkerConnection=D().LV(i),D().p(this.dedicatedWorkerConnection,a.port),await(c=n(714681).S(r),new Promise(((e,t)=>{navigator.locks.request(c,(()=>(e(),new Promise((()=>{}))))).catch(t)}))),await s.initializeNewTab({tabId:r});const l={execSqliteBatch:e=>s.execSqliteBatch(e),execSqliteBatchV2:e=>s.execSqliteBatchV2(e),completelyRebuildSqliteDb:()=>s.completelyRebuildSqliteDb()},d=new(j().i)({connection:l,type:"v2",migrations:await(0,R().G)(l)});try{await d.ensureMigrated()}catch(u){w().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionEnsureMigratedError",error:(0,_().convertErrorToLog)(u),data:(0,k().CS)(u,{isBrowser:!0})})}return d.optimize().catch((e=>{w().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionOptimizeError",error:(0,_().convertErrorToLog)(e),data:(0,k().CS)(e,{isBrowser:!0})})})),d}}class q{constructor(e){this.sqliteConnection=void 0,this.sqliteConnection=new O({loadWorker:()=>new Worker(new URL(n.p+n.u(75528),n.b)),loadSharedWorker:()=>new SharedWorker(new URL(n.p+n.u(33429),n.b)),currentUserId:e.currentUserId})}static maybeCreateInstance(e){const{device:t,currentUserId:n}=e;if(function(e){var t;return!(!e.isBrowser||"undefined"==typeof navigator||void 0===(null===(t=navigator.locks)||void 0===t?void 0:t.request)||"undefined"==typeof SharedWorker||"localhost"===window.location.hostname&&"3003"!==window.location.port||e.isAndroid)}(t)){z("loading");const e=new q({currentUserId:n});return e.waitForInitialize().then((()=>{z("success")}),(e=>{z("error"),w().log({level:"error",from:"clientEnvironment",type:"wasmSqliteInitializeError",error:(0,_().convertErrorToLog)(e),data:{...(0,k().CS)(e,{isBrowser:!0}),userId:n}})})),e}z("skipped-unsupported-device")}async waitForInitialize(){return await this.sqliteConnection.waitForInitialize()}}function z(e){n(961581).A.state.metricDataStore.update((t=>({...t,wasm_sqlite_initialized:e})))}var W=()=>n(757695);class K extends W().default{getInitialState(){return{loading:!1,loaded:!1}}async loadIfNeeded(e){if(this.state.loaded||this.state.loading)return;const t=e();if(!t)return;if(0===n(919709).IcF(t).length)return;const o=n(771467).V.load();this.setState({loading:!0,loaded:!1,result:o}),this.setState({loading:!1,loaded:!0,result:await o})}getKatex(){if(this.state.loaded)return this.state.result}}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(354520),n(908872),n(737550);var V=()=>n(763884),$=()=>n(720665),F=()=>n(941541),G=()=>n(589994);class H extends W().default{static getCacheKey(e){return`LocalBacklinkStore2:${e}`}getInitialState(){return{}}initializeBacklinks(e){let{block:t,currentUserId:n,environment:o}=e;if(this.instanceState[t.id])return;const r=this.getCachedBacklinkState({blockId:t.id,currentUserId:n});r?this.setState({...this.instanceState,[t.id]:{state:r,loaded:!0}}):this.setState({...this.instanceState,[t.id]:{state:{backlinks:[],inaccessibleBacklinkCount:0},loaded:!1}}),J(o,t),this.startMessageListeners(t,o)}awaitLoaded(e){return this.waitUntil((()=>{const t=this.state[e];return Boolean(t&&t.loaded)}))}destroyBacklinks(e,t){this.stopMessageListeners(e,t),delete this.instanceState[e]}getBacklinkState(e){let{blockId:t,currentUserId:n}=e;const o=this.state[t];return o?o.state:this.getCachedBacklinkState({blockId:t,currentUserId:n})||{backlinks:[],inaccessibleBacklinkCount:0}}setBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;this.setCachedBacklinkState({blockId:t,state:n,currentUserId:o});const r=this.state[t];r&&this.setState({...this.state,[t]:{...r,state:n,loaded:!0}})}updateBacklinks(e){const{createdBacklinks:t,deletedBacklinks:n,currentUserId:o}=e,r=(0,$().qt)(t),i=(0,$().qt)(n),a=r.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),s=i.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),c=new Set([...Object.keys(a),...Object.keys(s)]);return c.forEach((e=>{const t=a[e]||[],n=s[e]||[],r=this.getBacklinkState({blockId:e,currentUserId:o}),i=t.filter((e=>!r.backlinks.some((t=>T().n4(e,t))))),c=[...r.backlinks,...i].filter((e=>!n.some((t=>T().n4(e,t)))));this.setBacklinkState({blockId:e,state:{...r,backlinks:c},currentUserId:o})})),Array.from(c)}resetBacklinkState(e){let{blockIds:t,currentUserId:n}=e;for(const o of t)this.setCachedBacklinkState({blockId:o,state:{backlinks:[],inaccessibleBacklinkCount:0},currentUserId:n})}getCachedBacklinkState(e){let{blockId:t,currentUserId:n}=e;return V().K.get({userId:n,key:H.getCacheKey(t)})}setCachedBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;return V().K.set({userId:o,key:H.getCacheKey(t),value:n})}async startMessageListeners(e,t){const o=n(696706).L3.fromSpaceShardRecordId(e,I().ev);G().transactionQueue.isPendingTransactionForRecord(o)&&await G().transactionQueue.drain();const r=this.instanceState[o.id];if(!r)return;let i,a=!1;const s=T().nF((n=>{let{value:o}=n;const r=i,s=o||void 0;i=s,a?r!==s&&J(t,e):a=!0}),1e3),c=(0,n(921997).U)(o.id);r.messageStoreListenerReference=F().Ay.addListener(c,void 0,s,void 0,t)}stopMessageListeners(e,t){const n=this.instanceState[e];n&&n.messageStoreListenerReference&&(F().Ay.removeListener(n.messageStoreListenerReference,t),n.messageStoreListenerReference=void 0)}}async function J(e,t){await G().transactionQueue.awaitRecordTransaction({id:t.id,table:I().ev});const o=(0,n(851941).dR)(t.id),r=o?{"x-notion-space-short-id":o.toString()}:t.spaceId?{"x-notion-space-id":t.spaceId}:{},i=n(449506).callMultiCellApi({eventName:"getPageBacklinks",environment:e,data:{block:t},headers:r}),a=[];let s=0;for await(const n of i)"failed"!==n.type&&(a.push(...n.data.backlinks),s+=n.data.inaccessibleBacklinkCount,e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:a,inaccessibleBacklinkCount:s},currentUserId:e.currentUser.id}))}class Z extends W().default{getInitialState(){return{isOpen:!1,isSubMenuOverridden:!1,subMenu:void 0,menu:void 0,shouldRestoreSelectionForMenu:!0,enableShouldShowDebugging:!1,session:void 0}}clear(e){this.update((t=>({...t,menu:void 0,shouldRestoreSelectionForMenu:e})))}async clearNativeActionMenuAndRestoreSelectionIfNecessary(){var e;void 0!==(null===(e=this.state.menu)||void 0===e?void 0:e.type)&&(this.clear(!0),await n(763824).wR(10))}}function X(e){return`PageDetailsStore:${e.type}:${e.id}`}class Y extends W().default{getInitialState(){return{}}static getDefaultToggleState(e){return"discussion"===e.type||"backlinks"!==e.type&&void(0,n(534177).HB)(e)}getToggleState(e){const t=X(e);if(t in this.state)return this.state[t]}setToggleState(e,t){const n=X(e);this.setState({...this.state,[n]:t})}}var Q=()=>n(994310);const ee="spellcheckEnabled";class te{constructor(){this.enabled=void 0,this.currentLanguages=void 0;const e=Q().A.get(ee);this.setEnabled(void 0===e||e)}setEnabled(e){var t,n;(this.enabled=e,Q().A.set(ee,e),null!==(t=f().electronApi)&&void 0!==t&&t.setSpellCheckerEnabled)&&(null===(n=f().electronApi)||void 0===n||n.setSpellCheckerEnabled(e))}isEnabled(){return this.enabled}getCorrections(e){return e.dictionarySuggestions}addToDictionary(e){var t;null!==(t=f().electronApi)&&void 0!==t&&t.addToDictionary&&f().electronApi.addToDictionary(e)}setLanguages(e){var t;T().n4(this.currentLanguages,e)||(this.currentLanguages=e,null!==(t=f().electronApi)&&void 0!==t&&t.setSpellCheckerLanguages&&f().electronApi.setSpellCheckerLanguages(0===e.length?[navigator.language]:e))}async getLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=f().electronApi)&&void 0!==e&&e.getSpellCheckerLanguages){const e=await f().electronApi.getSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}async getAvailableLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=f().electronApi)&&void 0!==e&&e.getAvailableSpellCheckerLanguages){const e=await f().electronApi.getAvailableSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}}class ne extends(()=>n(496506))().default{}const oe=["nativeRedirect","page","space","nativeTab","onboarding","unsubscribe","unknown","uiDoc","desktopEmailConfirm","root","chat","posts","marketplace","team","gallery","settingsConsoleOrganization"],re=[...oe,"login","login/calendar","signup","quickSearch"];let ie=0;async function ae(e){var t;const{minimalEnvironment:n,prefetchCache:w,currentUserId:A}=e,{device:I,deviceStore:k,mobileNative:C,cookieService:x}=n,T=""+ie++,_=I.isElectron&&Boolean(null===(t=f().electronApi)||void 0===t?void 0:t.sqliteServerEnabled)?await async function(e){var t;if(!e.device.isElectron||null===(t=f().electronApi)||void 0===t||!t.sqliteServerEnabled)return;const n=new B;return await n.initialize(),n}({device:I}):void 0,P=q.maybeCreateInstance({device:I,currentUserId:A}),E=new(c().A),U=new(l().Bd),M=new(u().A),R=new te,j=(null==C?void 0:C.sqliteConnection)||(null==_?void 0:_.sqliteConnection)||(null==P?void 0:P.sqliteConnection),N=j?new L({connection:j,maxSize:I.isDesktop?1e6:1e5,getEnvironment:function(){return F}}):void 0,D=new(r().L)({inMemoryRecordCache:new(o().A)({name:"default"}),persistedRecordCache:N});P&&P.waitForInitialize().catch((()=>{D.disablePersistedRecordCache()}));const O=function(e){const{device:t,RouterStore:n,ThemeStore:o}=e;let r=oe;return(t.isElectron||t.isElectronCalendar||t.isMobileNative)&&(r=re),new ne((()=>{const e=n.state.route;return e&&r.includes(e.name)?o.state.mode:"light"}),{debugName:"ThemeModeStore"})}({device:I,RouterStore:E,ThemeStore:M}),z=I.isMobile?new Z:void 0,W=await h().getPublicDomainUserId({device:I,deviceStore:k,mobileNative:C,cookieService:x}),V=new(i().CurrentUser),$=new v({environmentName:"production",getSettings:()=>{const e=(0,y().Pr)("id_schema_dynamic_config_v3"),t=(null==e?void 0:e.get("percent",0))??0;return{enableTestDateOffset:!((null==e?void 0:e.get("real_id",!1))??!1),enableIdSchema:(0,m().rQ)(t)}},isServerOriginated:!1,currentUserId:A,mapSpaceIdToShortId:(e,t)=>{const n=(0,b().Jn)({defaultRecordCache:D,userId:e,spaceId:t});if(n&&n.short_id_str)return Number(n.short_id_str)}}),F={key:T,AppUpdateStore:new(a().I),device:I,deviceStore:k,WindowSizeStore:new(p().nJ)({device:I},window),KeyboardShortcutStackStore:new(s().X),defaultRecordCache:D,mobileNative:C,RouterStore:E,ThemeStore:M,ThemeModeStore:O,ElectronSqlite:_,KatexStore:new K,LocalBacklinkStore:new H,PageDetailsStore:new Y,updateCurrentUserId:void 0,currentUser:V,SpellCheckStore:R,NativeMobileActionBarStore:z,TextSelectionCompositionStore:new(d().P),recordSubscriptionActions:S(),prefetchCache:w,TabbedRouterStore:U,cookieService:x,publicDomainUserId:W,idCreator:$};return g().uh(F),F}},316437:(e,t,n)=>{n.d(t,{A:()=>P});var o=n(296540),r=()=>n(484714),i=()=>n(819121),a=()=>n(847249),s=()=>n(401497),c=()=>n(133033),l=()=>n(959013),d=()=>n(662303),u=()=>n(857639),p=()=>n(235280),m=()=>n(994877),f=()=>n(989423),g=()=>n(95286),v=()=>n(875856);var h=()=>n(38337),b=()=>n(553965),S=()=>n(732797),y=()=>n(172079),w=()=>n(665638),A=()=>n(704152),I=()=>n(406699),k=()=>n(859428),C=()=>n(490044),x=n(474848);const T="?";function _(e){const t=(0,r().v3)(),{isMobile:n}=t.device,d=(0,l().tz)(),u=(0,a().K8)((()=>S().A.state.open),[]),{roundButtonStyle:p,buttonPositionStyle:m}=(0,w().$)({environment:t,rightEdgeDistance:16,isInPeekRenderer:!1}),f={...p,...m,zIndex:111},g=(0,s().IS)((e=>({helpIcon:{fill:e.mediumIconColor,width:16,height:16},hoveredStyle:{background:e.whiteButtonHoveredBackground},pressedStyle:{background:e.whiteButtonPressedBackground}})),[]),v=(0,o.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,i().p)(t)&&y().A.setState(!0)}),[]),I=(0,o.useCallback)((()=>{y().A.setState(!1)}),[]);if(n)return(0,x.jsx)(A().A,{hovered:u,testId:h().prN,mobileFeedback:n,...e,children:(0,x.jsx)(C().A,{left:(0,c().$)(g.helpIcon),disableMobileBorder:!0,children:(0,x.jsx)(l().sA,{defaultMessage:"Help & support",id:"helpButton.mobileHelpSupportButton.label"})})});const _=d.formatMessage({defaultMessage:"Help, feedback, and keyboard shortcuts",id:"helpButton.desktopHelpButton.ariaLabel"}),P=(0,b().A)(e,{onFocus:v,onBlur:I});return(0,x.jsx)(k().A,{renderTooltip:()=>(0,x.jsx)("span",{children:(0,x.jsx)(l().sA,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:(0,x.jsx)("br",{})}})}),render:e=>(0,x.jsx)(A().A,{ariaLabel:_,className:h().prN,testId:h().prN,style:f,hoveredStyle:g.hoveredStyle,pressedStyle:g.pressedStyle,...(0,b().A)(P,e),children:T})})}const P=function(){const e=(0,r().v3)(),{isMobile:t}=e.device,i=(0,a().K8)((()=>{var t;return(null===(t=e.mobileNative)||void 0===t?void 0:t.supportsNativeHomeOnPhone())||!1}),[e]),s=(0,o.useCallback)((()=>{n(148024).VX(e,{from:"corner"}),async function(e){const t=v().default.state;if((0,f().kb)()&&t.isZendeskEnabled){const{userHighestPlanType:n,isSalesAssistedPlan:o}=(0,g().N1)(e),r=await m().be({environment:e,isSalesAssistedPlan:o});p().n({type:"decagon",locale:d().locale,analyticsSettings:t,decagonInitializeArgs:r,onError:e=>{u().log({level:"error",from:"decagonHelpers",type:"initializeDecagon",error:{message:e.message}})},userHighestPlanType:n,isSalesAssistedPlan:o,cookieService:e.cookieService})}}(e)}),[e]);return(0,x.jsx)(I().Ay,{popupType:t?I().z7.SlideUp:I().z7.Popup,hidesMobileNativeBottomBar:i,preventSlideUpTransition:i,renderOrigin:e=>(0,x.jsx)(_,{...e}),originGap:t?0:12,placementToOrigin:t?I().sx.Right:I().sx.Top,alignmentToOrigin:t?I().yP.Center:I().yP.End,buttonPopupStore:S().A,onClick:s,render:()=>(0,x.jsx)(n(240562).p,{})})}},323914:(e,t,n)=>{n.d(t,{c:()=>i,y:()=>r});var o=()=>n(463830);const r=new(o().A),i=new(o().A)},350648:(e,t,n)=>{n.d(t,{D2:()=>A,Ip:()=>S,Jk:()=>y,YT:()=>w,e2:()=>h,g:()=>b});n(898992),n(354520);var o=()=>n(584262),r=()=>n(798880),i=()=>n(946141),a=()=>n(449506),s=()=>n(246826),c=()=>n(436572),l=()=>n(426116),d=()=>n(751156),u=()=>n(972435),p=()=>n(640653),m=()=>n(351360),f=()=>n(848237),g=()=>n(263928);const v=(0,n(959013).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function h(e){let{environment:t,userId:n,teamStore:o,user:r}=e;const a=o.getSpaceId();if(!a)return;await f().rU({environment:t,teamId:o.id,spaceId:a,teamUserInfo:r,isSettingDefaultTeam:!1,inviterId:n})&&(i().vo(t,{store:o,joined_role:"member",from:"team_invite_link"}),await b({environment:t,userId:n,teamStore:o}),c().D6({label:u().A.formatMessage(v.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function b(e){let{environment:t,userId:n,teamStore:r}=e;const i=m().default.state.currentUserRootStore,a=r.getSpaceId();if(!a||!i)return;const s=i.getSpaceViewStores().filter((e=>e.getSpaceId()===a))[0];await l().tR({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:i,pageVisitSource:o().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await g().J({environment:t,spaceId:a,userId:n}),f().L0({environment:t,teamStore:r,shouldScroll:!0})}async function S(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await a().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:o}})).type?(i().XQ(t,{teamId:n}),await w({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{c().D6({label:u().A.formatMessage(v.requestTeamSuccessMessage)})}))):c().D6({label:u().A.formatMessage(v.requestTeamFailureMessage)})}async function y(e){let{environment:t,teamStore:n,accessRequestStore:o,status:a}=e;const c=o.getForActorId();if(!c)return;const l=o.getRecordModel({table:r().oo,id:c});if(l){if("approved"===a){const e=[{type:"member",entity_type:"user",user_id:l.id}];if(!(await f().Zd({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}d().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().zv({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:r().oo,resolved_by_id:t.currentUser.id,status:a}})}}),i().GW(t,{store:n,resolution:a})}}async function w(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:r,userSettingsStore:i}=await(0,p().ex)({environment:t,disableRedirectUrl:!1});n?await l().tR({environment:t,spaceViewStore:n,userRootStore:r,userSettingsStore:i,pageVisitSource:o().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await l().t9({environment:t,userRootStore:r,userSettingsStore:i,pageVisitSource:o().y8.BackForward})}async function A(e){let{environment:t,teamId:n}=e;const o=await a().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===o.type)return o.data}},422920:(e,t,n)=>{n.r(t),n.d(t,{clearNotionLocalStorageWithNoPermission:()=>i});var o=()=>n(901801),r=()=>n(948450);function i(){o().A.removeAllIfNoPermission(),r().A.removeAllIfNoPermission()}},427636:(e,t,n)=>{n.d(t,{A:()=>r});n(296540);var o=n(474848);const r=function(e){const{botStore:t,avatarSize:r,shouldShowBadge:i,style:a,inline:s}=e,c=(0,n(959013).tz)(),l=(0,n(484714).Y0)(),d=(0,n(847249).K8)((()=>null==t?void 0:t.getDisplayName(c)),[t,c]),{outerStyle:u,avatarWrapStyle:p,badgeStyle:m}=(0,n(401497).IS)((e=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0,...a},avatarWrapStyle:s?{width:"none",minHeight:"none",marginRight:6}:{marginRight:6},badgeStyle:{padding:"2px 6px",borderRadius:4,color:e.text.secondary,background:e.legacyDefaultSelectColor,fontSize:l.isMobile?11:9,lineHeight:l.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",marginLeft:8,marginTop:1}})),[a,s,l]);return(0,o.jsxs)("div",{style:u,children:[(0,o.jsx)("div",{style:p,children:(0,o.jsx)(n(256863).A,{botStore:t,size:r})}),(0,o.jsx)("div",{style:{...n(284371).RC},children:d}),i&&(0,o.jsx)("div",{style:m,children:"Bot"})]})}},517592:(e,t,n)=>{n.d(t,{A:()=>r});n(296540);var o=n(474848);const r=(0,n(340498).wt)("notionLogoStroked",{viewBox:"0 0 41 42",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M4.253 2.903h0-.01c-1.02.09-1.806.481-2.322 1.142-.5.642-.671 1.441-.671 2.21v23.228c0 1.267.47 2.316 1.416 3.577h0l.006.008 4.99 6.477h0l.005.005c.465.593.963 1.017 1.617 1.256.63.23 1.33.26 2.138.221h.01l24.652-1.49h.008c1.137-.08 2.038-.396 2.632-1.071.588-.668.746-1.543.746-2.431V9.904c0-.584-.133-1.05-.508-1.486-.27-.311-.669-.602-1.113-.925a54.305 54.305 0 01-.176-.13l-.007-.004-.005-.004-6.772-4.761c-.838-.609-1.516-1.017-2.365-1.21-.824-.187-1.75-.156-3.047-.044L4.253 2.903z",fill:"#fff",stroke:"#fff",strokeWidth:"1.5"}),(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.257 3.158L5.176 4.637c-1.62.14-2.184 1.197-2.184 2.464v21.971c0 .987.352 1.83 1.198 2.959l4.72 6.126c.776.987 1.48 1.198 2.96 1.127l23.32-1.408c1.973-.14 2.537-1.057 2.537-2.606V10.552c0-.801-.316-1.032-1.25-1.714l-.16-.117-6.41-4.507c-1.55-1.126-2.184-1.268-4.65-1.056zM12.4 10.146c-1.904.129-2.337.158-3.418-.72l-2.75-2.183c-.28-.283-.14-.635.565-.705L26.102 5.13c1.62-.141 2.466.423 3.1.916l3.311 2.394c.141.07.493.492.07.492L12.645 10.13l-.245.016zM10.179 35.06V14.074c0-.916.281-1.338 1.126-1.41l22.898-1.337c.777-.07 1.128.423 1.128 1.338v20.844c0 .916-.14 1.691-1.41 1.761l-21.91 1.268c-1.269.07-1.832-.352-1.832-1.48zm21.63-19.86c.141.635 0 1.268-.635 1.34l-1.056.21v15.492c-.916.493-1.761.775-2.466.775-1.128 0-1.41-.352-2.255-1.408l-6.905-10.845v10.493l2.185.493s0 1.267-1.763 1.267l-4.86.282c-.142-.282 0-.986.492-1.127l1.269-.351V17.947l-1.761-.142c-.141-.634.21-1.549 1.197-1.62l5.214-.351 7.187 10.986V17.1l-1.832-.21c-.14-.776.422-1.339 1.127-1.409l4.863-.283z",fill:"#222"})]})})},518627:(e,t,n)=>{n.d(t,{A:()=>Or});var o=n(296540),r=()=>n(662303),i=()=>n(484714),a=()=>n(852507),s=()=>n(554279),c=()=>n(885443),l=()=>n(402390),d=()=>n(541258),u=()=>n(824772),p=()=>n(206267),m=()=>n(351360),f=()=>n(329418),g=()=>n(763884);function v(e){g().K.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}const h=6e4;async function b(e){var t,n;void 0!==m().default.state.currentUserStore&&void 0!==m().default.state.currentSpaceStore||await m().default.waitUntil((()=>void 0!==m().default.state.currentUserStore&&void 0!==m().default.state.currentSpaceStore));const o=null===(t=m().default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(n=m().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!document.hasFocus())return;if(!o||!r)return;const i=(0,f().g)({userId:o,spaceId:r}),a=Date.now();v(i?{userId:o,spaceId:r,session:{...i,lastFocusedTime:a}}:{userId:o,spaceId:r,session:{id:p().JW(),sessionStartTime:a,lastFocusedTime:a}})}var S=()=>n(780054),y=()=>n(645873);const w=new(y().O2)("thirdPartyScripts",(()=>n.e(1978).then(n.bind(n,63620)))),A=(0,y()._h)(w,(e=>e.InjectThirdPartyScripts));var I=()=>n(989423),k=()=>n(38337),C=()=>n(963589);const x={GlobalInAppMessageListener:new(y().O2)("GlobalInAppMessageListener",(()=>n.e(94869).then(n.bind(n,793383))))},T=(0,y()._h)(x.GlobalInAppMessageListener,(e=>e.GlobalInAppMessageListener));var _=()=>n(722038),P=()=>n(554894),E=()=>n(847249),U=()=>n(401497),L=()=>n(959013),M=()=>n(284371),R=()=>n(436572),j=()=>n(186445),N=()=>n(227440),B=()=>n(508496),D=()=>n(540758),O=()=>n(670631),q=n(474848);function z(){const e=(0,L().tz)(),t=(0,U().DP)(),n=!(0,E().O$)(N().e),r=(0,E().K8)((()=>(0,j().s0)()),[]),i=(0,o.useRef)(n),a=(0,o.useRef)(r);(0,o.useEffect)((()=>{!n||i.current&&r===a.current||function(e){var t;const{isOffline:n,currentPageId:o,intl:r,theme:i}=e;if(!(O().A.state.offlinePages&&B().default.checkGate({gateName:"download_for_offline"})&&n&&o&&(0,D().Bd)(o)))return;const a=null===(t=O().A.state.offlinePages[o])||void 0===t?void 0:t.lastDownloadedAt,s=a?r.formatDate(a,{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}):void 0;R().D6({label:(0,q.jsxs)("div",{children:[(0,q.jsx)("div",{style:{fontWeight:M().Wy.medium},children:(0,q.jsx)(L().sA,{defaultMessage:"Working offline",id:"offlinePages.snackbar.title"})}),a&&(0,q.jsx)("div",{style:{color:i.text.secondary},children:(0,q.jsx)(L().sA,{defaultMessage:"Last sync on {lastDownloadedAtFormatted}.",id:"offlinePages.snackbar.description",values:{lastDownloadedAtFormatted:s}})})]})})}({isOffline:n,currentPageId:r,intl:e,theme:t}),i.current=n,a.current=r}),[n,r,e,t])}var W=()=>n(537972),K=(n(16280),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(581454),()=>n(591779)),V=()=>n(496603),$=()=>n(763824),F=()=>n(825972),G=()=>n(291606),H=()=>n(961581),J=()=>n(532338),Z=()=>n(344300);const X=1e3;class Y extends Error{constructor(e){super(e),this.name="OfflineAutosyncAbortedError"}}async function Q(e){const{environment:{currentUser:{id:t},defaultRecordCache:{persistedRecordCache:n}},recentPageIds:o}=e;if(!n||!t)return{pagesToAdd:[],pagesToRemove:[]};return function(e){const{recentPageIds:t,existingAutosyncedPageIds:n}=e,o=new Set(t),r=new Set(n);return{pagesToAdd:t.filter((e=>!r.has(e))),pagesToRemove:Array.from(n).filter((e=>!o.has(e)))}}({recentPageIds:o,existingAutosyncedPageIds:(await n.getOfflineAutosyncedOrigins({userId:t})).map((e=>{let[t]=e;return t}))})}async function ee(e){const{environment:t,abortSignal:n,autosyncIntervalMs:o}=e,{currentUser:{id:r},defaultRecordCache:{persistedRecordCache:i}}=t;if(!i||!r)return;const a=function(e){var t;let{limit:n}=e;return null===(t=F().wI.state)||void 0===t?void 0:t.slice(0,n).map((e=>e.pageId))}({limit:B().default.getConfigKey("offline_mode_settings","autosynced_pages_limit")});if(void 0===a)return;const{pagesToAdd:s,pagesToRemove:c}=await Q({environment:t,recentPageIds:a});n.throwIfAborted(),await navigator.locks.request(`download_autosynced_pages_${t.currentUser.id}`,{ifAvailable:!0},(async e=>{if(!e)return;const a=await i.getOfflineMetadataLastExecutedAt({userId:r,taskType:"autosync"});if(a){if(Date.now()-a<.95*o)return}const c=Date.now(),l=new Set;await(0,$().lX)(s,5,(async e=>{await(0,J().og)({from:"addAutosyncedPage",autosyncTypes:["frecent"],pageId:e,environment:t,originPageId:e,visitedBlockIds:{forThisOriginPage:new Set,forThisInterval:l},stats:{imageCount:0,loadCachedPageChunkV2ForOfflineCount:0,queryCollectionCount:0},downloadAbortSignal:n,skippedCollectionIds:new Set}),n.throwIfAborted()})),await i.updateOfflineMetadataLastExecutedAt({userId:r,taskType:"autosync",lastExecutedAt:c})}));for(const l of c)await(0,J().zB)({from:"removeAutosyncedPage",pageId:l,environment:t}),n.throwIfAborted()}function te(){const e=(0,i().v3)(),t=(0,_().y)(),n=(0,C().X)("offline_autosync"),r=(0,E().K8)((()=>function(){const e=(0,G().dE)();if(void 0===e)return(0,G().Nw)("on"),"on";return e}()),[]),a=(0,K().ZC)(r)??"off",s=(0,E().K8)((()=>H().A.state.initialRenderCompleted&&N().A.state.online&&t&&n),[t,n]),c=(0,E().K8)((()=>B().default.getConfigKey("offline_mode_settings","autosync_interval_ms")),[]);(0,o.useEffect)((()=>{const t=new AbortController,n=V().sg((()=>{if(s)if("on"!==a||"off"!==r){if("on"===r){ee({environment:e,abortSignal:t.signal,autosyncIntervalMs:c}).catch((e=>{if(!(e instanceof Y))throw e}));const n=.05*c,o=c+Math.random()*n*2-n;return setInterval((()=>{ee({environment:e,abortSignal:t.signal,autosyncIntervalMs:o}).catch((e=>{if(!(e instanceof Y))throw e}))}),o)}}else(async function(e){const{defaultRecordCache:{persistedRecordCache:t},currentUser:{id:n}}=e;t&&n&&(await t.removeAllOfflineAutosyncedOrigins({userId:n}),await t.updateOfflineMetadataLastExecutedAt({userId:n,taskType:"autosync",lastExecutedAt:0}),(0,Z().readAndCacheOfflinePages)({userId:n,persistedRecordCache:t,tellOtherTabsToUpdate:!0}))})(e).catch((e=>{if(!(e instanceof Y))throw e}))}),X),o=n();return()=>{t.abort(new Y("Autosync aborted because hook deps changed")),n.cancel(),o&&clearInterval(o)}}),[e,s,r,a,c])}var ne=()=>n(346),oe=()=>n(534177),re=()=>n(705540),ie=()=>n(137493);async function ae(e,t){var n;return"undefined"==typeof navigator||void 0===(null===(n=navigator.locks)||void 0===n?void 0:n.request)?t():await navigator.locks.request(e,{ifAvailable:!0},(async e=>{if(e)return t()}))}const se=(0,n(583835).Dv)("extractWebClipperContent");var ce=()=>n(578194),le=()=>n(449506),de=()=>n(787172),ue=()=>n(357625),pe=()=>n(864260),me=()=>n(302022);const fe=new(n(752196).A);var ge=()=>n(851650),ve=()=>n(20822);var he=()=>n(457395),be=()=>n(640653),Se=()=>n(151059);function ye(){const e=(0,i().v3)(),t=(0,E().K8)((()=>m().default.state.currentUserRootStore),[]);(0,o.useEffect)((()=>{t&&async function(e,t){await he().y();const n=t.getSpaceViewStores();for(const o of n){const t=o.getBookmarkedPageStores();for(const e of t)we(e);const n=o.getSharedPages();if(n)for(const e of n)we(e);const r=o.getTeamsStores();for(const e of r){const t=e.getTeamPagesStores();for(const e of t)we(e)}const i=o.getSpaceStore();if(i){Se().A.getData(e,{spaceId:i.id});const t=(0,be().I0)(e,i);for(const e of t)we(e)}}}(e,t)}),[t,e])}function we(e){e.load();const t=e.getCollectionViewSourceOrLinkCollectionStores();for(const n of t)n.load()}var Ae=()=>n(857639),Ie=()=>n(994310),ke=()=>n(711059),Ce=()=>n(502626),xe=()=>n(934839),Te=()=>n(901389),_e=()=>n(135552),Pe=()=>n(731320),Ee=()=>n(150193),Ue=()=>n(865241);const Le=6e4;function Me(){const e=(0,i().v3)(),t=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"checking"}})}(e)),[e]),n=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n;o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"error",error:t}})}(0,n,e)),[e]),r=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),a=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n,r=(0,ke().parseVersion)(t.version),i=re().getDesktopVersion(),a=(0,ke().getUpdateType)({currentVersion:i,nextVersion:r,app:"desktop"});o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"downloading",type:a,version:r,timestamp:Date.now(),progress:0}})}(0,n,e)),[e]),s=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n,r=o.state;r.electronUpdate&&"downloading"===r.electronUpdate.state&&o.setState({appUpdate:r.appUpdate,electronUpdate:{...r.electronUpdate,progress:t.transferred/t.total}})}(0,n,e)),[e]),c=(0,o.useCallback)(((t,n)=>function(e,t,n){const{device:o}=n,{AppUpdateStore:r}=n,i=Ie().A.get(Ce().wp),a=t.version;if(i===a){if(o.isMac)return r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"ready",type:ke().UpdateType.Major,version:void 0,versionCreatedTime:0}}),void Te().ui({message:(0,q.jsx)(L().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.prompt",defaultMessage:"Please move the Notion app into the Applications folder for the auto-updater to work."}),showCancel:!1,keepFocus:!1,handleCancel:()=>Ce().K0(n),items:[{label:(0,q.jsx)(L().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.dismissButton.label",defaultMessage:"OK"}),onAccept:()=>Ce().K0(n)}]});Ae().log({level:"error",from:"AppUpdateListener",type:"electronUpdateFailed",data:{miscDataToConvertToString:{previousUpdateReady:i,nextUpdateReady:a}}})}const s=re().getDesktopVersion(),c=(0,ke().parseVersion)(t.version),l=(0,ke().getUpdateType)({currentVersion:s,nextVersion:c,app:"desktop"});r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"ready",type:l,version:c,versionCreatedTime:0}})}(0,n,e)),[e]),l=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"checking"}})}(e)),[e]),d=(0,o.useCallback)(((t,n)=>Ne(n,e)),[e]),u=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),p=(0,o.useCallback)(((t,n)=>Be(n,e)),[e]),m=(0,o.useCallback)(((t,n)=>De(n,e)),[e]),f=(0,o.useCallback)(((t,n)=>Oe(n,e)),[e]),g=(0,o.useCallback)((()=>function(e){const t=e.AppUpdateStore;if(N().A.getState().online&&t.isSilentUpdate()){const n=t.state.appUpdate;Ce().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}(e)),[e]);(0,o.useEffect)((()=>{const{device:o}=e;if(o.isElectron){const e=re().electronUpdateReady.addListener(c),o=re().electronUpdateError.addListener(n),i=re().electronUpdateChecking.addListener(t),v=re().electronUpdateAvailable.addListener(a),h=re().electronUpdateProgress.addListener(s),b=re().electronUpdateNotAvailable.addListener(r),S=re().appUpdateReady.addListener(f),y=re().appUpdateError.addListener(d),w=re().appUpdateChecking.addListener(l),A=re().appUpdateAvailable.addListener(p),I=re().appUpdateInstall.addListener(g),k=re().appUpdateProgress.addListener(m),C=re().appUpdateNotAvailable.addListener(u);return()=>{null==e||e(),null==o||o(),null==i||i(),null==v||v(),null==h||h(),null==b||b(),null==S||S(),null==y||y(),null==w||w(),null==A||A(),null==I||I(),null==k||k(),null==C||C()}}}),[e,l,u,p,d,g,m,f,a,t,n,r,s,c]),(0,o.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(n&&n.updateReceiveApiHandlers({appUpdateReady:t=>Oe(t,e),appUpdateError:t=>Ne(t,e),appUpdateChecking:l,appUpdateAvailable:t=>Be(t,e),appUpdateProgress:t=>De(t,e),appUpdateNotAvailable:u}),function(e){const t=Ce().Cv(),n=Ce().B0();if(!(0,ke().isEqualVersion)(t,n)){0;je((0,ke().getUpdateType)({currentVersion:t,nextVersion:n,app:"client"}),n,Ce().bg(),e)}}(e),t.isMobileNative&&n&&n.api.openUpdateSettings){const n=t.osVersion,o=t.isAndroid&&(0,ke().isLessThanVersion)(n,[7,0]),r=t.isIOS&&(0,ke().isLessThanVersion)(n,[16,0]);(o||r)&&function(e){const{mobileNative:t}=e;if(!t)return;xe().HQ({bannerStore:Ee().A,id:"PlatformUpdateWarning",contentKey:"mobile_platform_unsupported",styleKey:_e().q.Red})}(e)}}),[e,l,u]);const v=(0,o.useRef)("");(0,o.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(!n&&!t.isElectron&&!S().A.isAdminMode&&(!S().A.isLocalhost||S().A.offline)){async function o(){if(Ue().A.state.isVisible)try{const t=Ce().Cv(),n=await le().callApi({eventName:"getAssetsJsonV2",environment:e,data:{hash:v.current}});if("success"===n.type){const o=n.data;if("version"in o){const n=o,r=(0,ke().parseVersion)(n.version);r&&((0,ke().isEqualVersion)(r,t)||Oe(n,e))}"hash"in o&&(v.current=o.hash||"")}}catch(t){}}const r=setInterval(o,Le);return()=>clearInterval(r)}}),[e])}async function Re(e,t){const n=await async function(e){await m().default.waitUntilRendered();const{mainEditorCurrentBlockStore:t,currentUserStore:n}=m().default.state;return!(!n||!t||(0,Pe().qb)(e,t))}(e);n&&(Ce().Dv(e,t,"banner"),xe().HQ({bannerStore:Ee().A,id:"AppUpdate",contentKey:"minor_app_update",styleKey:_e().q.Blue}))}function je(e,t,n,o){e===ke().UpdateType.Major||e===ke().UpdateType.Minor||Ce().wT()?(t&&Ce().fC(t)&&Ce().qr(t,n),Re(o,e)):Ce().KD()?function(e,t){Ce().Dv(e,t,"modal"),Te().ui({message:(0,q.jsx)(L().sA,{defaultMessage:"We just launched new features!",id:"breakingUpdateDialog.title"}),showCancel:!1,keepFocus:!1,handleCancel:()=>Ce().K0(e),items:[{label:(0,q.jsx)(L().sA,{defaultMessage:"Update and see what's new",id:"breakingUpdateDialog.updateButtonTitle"}),color:"blue",onAccept:()=>Ce().K0(e)}],innerStyle:{width:380}})}(o,e):t&&Ce().fC(t)&&Ce().qr(t,n)}function Ne(e,t){const{AppUpdateStore:n}=t;n.state.appUpdate&&"ready"===n.state.appUpdate.state||n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"error",error:e}})}function Be(e,t){const{AppUpdateStore:n}=t;if(n.state.appUpdate&&"ready"===n.state.appUpdate.state)return;const o=(0,ke().parseVersion)(e.version),r=Ce().Cv(),i=(0,ke().getUpdateType)({currentVersion:r,nextVersion:o,app:"client"});n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"downloading",type:i,version:o,timestamp:Date.now(),progress:0}})}function De(e,t){const{AppUpdateStore:n}=t,o=n.state;o.appUpdate&&"downloading"===o.appUpdate.state&&n.setState({electronUpdate:o.electronUpdate,appUpdate:{...o.appUpdate,progress:e.downloaded/e.total}})}function Oe(e,t){const{AppUpdateStore:n}=t,o=(0,ke().parseVersion)(e.version),r=Ce().Cv(),i=(0,ke().getUpdateType)({currentVersion:r,nextVersion:o,app:"client"}),a=e.createdTime;if(!Ce().fC(o)){const e={state:"ready",type:i,version:o,versionCreatedTime:a};n.setState({electronUpdate:n.state.electronUpdate,appUpdate:e})}je(i,o,a,t)}var qe=()=>n(861017),ze=()=>n(939768);var We=()=>n(14307);async function Ke(e){if(e.device.isBrowser&&document.hidden)return;if(e.device.isElectron&&!(await re().isWindowVisible()))return;if(We().isConnected())return void Ve(!0);if(!1===navigator.onLine&&!S().A.isLocalhost)return void Ve(!1);"success"===(await le().callApi({eventName:"ping",environment:e,data:{}})).type?Ve(!0):Ve(!1)}function Ve(e){N().A.setState({...N().A.state,online:e,lastOfflineTimestamp:e?N().A.state.lastOfflineTimestamp:Date.now()})}const $e=5e3;var Fe=()=>n(466103);n(672577),n(430670);var Ge=()=>n(955825),He=()=>n(919709),Je=()=>n(191772),Ze=()=>n(751735),Xe=()=>n(100622),Ye=()=>n(667019),Qe=()=>n(94953),et=()=>n(555776),tt=()=>n(116008),nt=()=>n(786074),ot=()=>n(372154),rt=()=>n(141465),it=()=>n(871399);function at(e){const{discussionId:t,level:n}=e;return`\n\t\t.${(0,Ge().EJ)({level:n})}.${(0,Ge().wV)({discussionId:t})}.${Je().Do} {\n\t\t\tbackground: ${(0,Xe().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,Xe().JG)(e)} !important;\n\t\t}\n\t`}function st(e){const{level:t}=e;return`\n\t\t.${(0,Ge().EJ)({level:t})}.${Je().uU}.${Je().Do} {\n\t\t\tbackground: ${(0,Xe().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,Xe().JG)(e)} !important;\n\t\t}\n\t`}function ct(e){const t=(0,Xe().aO)({level:1,mode:e.mode,hovered:!1,selected:!1}),n=(0,Ze().Mj)(t).alpha()/2,o=(0,Ze().Mj)(t).alpha(n).toRgbString(),r=(0,Xe().JG)({level:1,mode:e.mode,hovered:!1,selected:!1}),i=(0,Ze().Mj)(r).alpha()/2,a=(0,Ze().Mj)(r).alpha(i).toRgbString();return`\n\t\t.${Je().K6}.${Je().Do} {\n\t\t\tbox-shadow: unset !important;\n\t\t\tpadding-bottom: 2px;\n\t\t\tbackground: ${o} !important;\n\t\t\tborder-bottom: 2px solid ${a} !important;\n\t\t\tanimation: commentFadeIn 500ms ease-in;\n\t\t}\n\t`}function lt(e){const{theme:t,selected:n,hovered:o}=e;return`background: ${(0,Xe().FK)({annotationType:"update",type:"background",selected:n,hovered:o,overlapping:!1,mode:t.mode})} !important;\n\t\t\tborder-bottom: 2px solid ${(0,Xe().FK)({annotationType:"update",type:"underline",selected:!1,hovered:!0,overlapping:!1,mode:t.mode})} !important;`}function dt(e){const{discussionId:t,theme:n,selected:o,hovered:r}=e;return`\n\t\t.${(0,Ge().ED)({type:"update"})}.${(0,Ge().wV)({discussionId:t})}.${Je().Do} {\n\t\t\t${lt({theme:n,selected:o,hovered:r})}\n\t\t}\n\t\t.${(0,Ge().ED)({type:"remove"})}.${(0,Ge().wV)({discussionId:t})}.${Je().Do} {\n\t\t\t${function(e){const{theme:t,selected:n,hovered:o}=e,r=(0,Xe().FK)({annotationType:"remove",type:"background",selected:n,hovered:o,overlapping:!1,mode:t.mode}),i=(0,Xe().FK)({annotationType:"remove",type:"underline",selected:n,hovered:o,overlapping:!1,mode:t.mode});return`background: ${r} !important;\n\t\t\tcolor: ${t.text.secondary} !important;\n\t\t\ttext-decoration: none !important;\n\t\t\tborder-bottom: 2px solid ${i} !important;`}({theme:n,selected:o,hovered:r})}\n\t\t}\n\t`}function ut(e){var t,n,o;const r=(null===(t=Qe().A.state)||void 0===t?void 0:t.discussionIds)||[],i=null!==(n=ot().A.state)&&void 0!==n&&n.open&&(null===(o=ot().A.state)||void 0===o?void 0:o.discussionIds)||[];return[...r.flatMap((t=>V().Hn(Ge().DS).map((n=>at({discussionId:t,level:n+1,hovered:!0,selected:!1,mode:e.mode}))))),...i.flatMap((t=>V().Hn(Ge().DS).map((n=>at({discussionId:t,level:n+1,hovered:!1,selected:!0,mode:e.mode})))))].join("\n")}function pt(e){var t,n,o;const r=(null===(t=Qe().A.state)||void 0===t?void 0:t.discussionIds)||[],i=null!==(n=ot().A.state)&&void 0!==n&&n.open&&(null===(o=ot().A.state)||void 0===o?void 0:o.discussionIds)||[];return[...r.map((t=>dt({theme:e,discussionId:t,selected:!1,hovered:!0}))),...i.map((t=>dt({theme:e,discussionId:t,selected:!0,hovered:!1})))].join("\n")}function mt(e){let t="";const n=nt().A.getHoveredEdit();n&&(t=`\n\t\t\t.${(0,Ge().K3)({type:"insert",editId:n.editId})} {\n\t\t\t\t${lt({theme:e,selected:!1,hovered:!0})}\n\t\t\t}\n\t\t\t.${(0,Ge().K3)({type:"remove",editId:n.editId})} {\n\t\t\t\t${function(e){return`background: ${(0,Xe().FK)({annotationType:"remove",type:"background",selected:!1,hovered:!0,overlapping:!1,mode:e.mode})} !important;\n\t\t\tcolor: ${e.text.secondary} !important;\n\t\t\ttext-decoration-color: rgba(0, 0, 0, 0) !important;`}(e)}\n\t\t\t}\n\t\t`);return`\n\t\t${t}\n\t\t${`\n\t\t.${k()._Qb} .${(0,Ge().h_)("insert")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.text.primary} !important;\n\t\t}\n\n\t\t.${k()._Qb} .${(0,Ge().h_)("remove")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.text.quaternary} !important;\n\t\t}\n\t`}\n\t`}function ft(e){const t=Ye().W.getHoveredEditId();return t?function(e){const{editId:t,theme:n,selected:o,hovered:r}=e;return`\n\t\t.${(0,Ge().rI)({editId:t})}.${Je().Do} {\n\t\t\t${lt({theme:n,selected:o,hovered:r})}\n\t\t}\n\t`}({editId:t,theme:e,selected:!1,hovered:!0}):""}function gt(){const e=(0,U().DP)(),t=(0,E().K8)((()=>[ut(e),pt(e)].join("\n")),[e]),n=(0,E().K8)((()=>function(){var e,t,n;const o=null===(e=rt().A.state)||void 0===e?void 0:e.store,r="token"===(null===(t=rt().A.state)||void 0===t?void 0:t.type)?null===(n=rt().A.state)||void 0===n||null===(n=n.annotations)||void 0===n?void 0:n.find(He().sh$):void 0;if(!r)return"";const i=(0,He().cQR)(r);return"block"!==(null==o?void 0:o.table)?"":`\n\t\t\t.${(0,Ge().re)({href:i,blockId:o.id})}.${Je().Do} {\n\t\t\t\ttransition: border-color 100ms ease-in, opacity 100ms ease-in;\n\t\t\t\tborder-color: currentColor !important;\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`}()),[]),r=(0,E().K8)((()=>mt(e)),[e]),i=(0,E().K8)((()=>function(e){var t,n,o;if(!(null===(t=tt().A.state)||void 0===t?void 0:t.open))return"";let r=[],i=[];return null!==(n=et().A.state)&&void 0!==n&&n.isHovered&&(r=V().Hn(Ge().DS).map((t=>st({level:t+1,hovered:!0,selected:!1,mode:e.mode})))),null!==(o=et().A.state)&&void 0!==o&&o.isActivelyComposing&&(i=V().Hn(Ge().DS).map((t=>st({level:t+1,hovered:!1,selected:!0,mode:e.mode})))),[...r,...i].join("\n")}(e)),[e]),a=(0,E().K8)((()=>function(e){return it().default.isRightMarginCommentHovered()?[ct(e)].join("\n"):""}(e)),[e]),s=(0,E().K8)((()=>ft(e)),[e]),c=(0,o.useMemo)((()=>[t,n,r,i,a,s].filter(Boolean).join("\n")),[r,t,n,i,a,s]),l=(0,o.useRef)(null);(0,o.useLayoutEffect)((()=>{if(!l.current){const e=document.createElement("style");l.current=e,document.head.appendChild(e)}l.current.innerHTML=c}),[c])}var vt=()=>n(764880),ht=()=>n(148307),bt=()=>n(634201),St=()=>n(522419),yt=()=>n(825237),wt=()=>n(416504),At=()=>n(278238),It=()=>n(945778),kt=()=>n(450648),Ct=()=>n(854150),xt=()=>n(435009),Tt=()=>n(712030),_t=()=>n(267419),Pt=()=>n(878377),Et=()=>n(669729),Ut=()=>n(903972);const Lt=32;const Mt=32;async function Rt(e){const t=document.createElement("canvas");t.width=Mt,t.height=Mt;const n=t.getContext("2d"),o=document.createElement("img");return o.src=e,o.crossOrigin="anonymous",new Promise((e=>{o.onload=()=>{n.drawImage(o,0,0,Mt,Mt),e(t.toDataURL("image/png"))},o.onerror=()=>{e("")}}))}var jt=()=>n(492414),Nt=()=>n(571963),Bt=()=>n(972435),Dt=()=>n(696746),Ot=()=>n(179534),qt=()=>n(562800),zt=()=>n(578872),Wt=()=>n(430483),Kt=()=>n(278715),Vt=()=>n(589994),$t=()=>n(977390),Ft=()=>n(630116);const Gt=(0,L().YK)({notionAiDocTitle:{id:"documentTitleListener.notionAi.title",defaultMessage:"Notion AI"},homeLabelTitle:{id:"DocumentTitleListener.personalHomeLabel",defaultMessage:"Home"}});function Ht(){const e=(0,i().v3)(),t=(0,L().tz)(),n=(0,U().DP)(),r=(0,o.useRef)(),a=(0,E().O$)(Wt().ts),s=(0,E().r6)((()=>{var n,o;const{RouterStore:r,device:i}=e,s=r.state.route,c=("space"===s.name||"page"===s.name)&&Boolean(s.requestedOnPublicDomain);if("chat"===s.name){return{assetPath:a?ht().A.images.assistantStaticFaceFaviconPng:ht().A.images.sparklesFavicon2Png,title:t.formatMessage(Gt.notionAiDocTitle)}}if("marketplace"===s.name)return{assetPath:ht().A.images.templates.faviconIco};if("settingsConsoleOrganization"===s.name)return{title:"Organization settings"};if("team"===s.name){const t=new(Ft().h4)(e,{table:Ct().yK,id:s.teamId});if(!t.isReady())return;return{title:t.getName(),icon:t.getIcon()}}const l=m().default.state.mainEditorCurrentBlockStore;if(!l||!l.isReady())return;const d="page"===s.name&&s.blockId===l.id,u=l.getSpaceStore()??m().default.state.currentSpaceStore;let p=!1;if("space"===s.name&&s.requestedOnPublicDomain){const e=qt().NG(u,l.id);p=(null==e?void 0:e.getDomainName())===s.spaceDomain}if(!d&&!p)return;const f=Ot().A.getUnreadCountForCurrentSpace().mentions,g=l.getModel(),v=function(e){const{store:t,spaceStore:n,environment:o,device:r,intl:i,unreadCountInCurrentSpace:a,isPublicSite:s}=e,c=t.getTitleStore(),l=t.getModel(),d=t.getCollectionViewIds(),u=null==c?void 0:c.getRecordModel(c.pointer);if(s&&l){const e=l.getFormat();if(null!=e&&e.seo_title)return e.seo_title}if(!c||!u)return;let p=(0,kt().r4)({intl:Bt().A.getIntl(),textValue:c.getValue(),userTimeZone:(0,wt().P)(),getRecordModel:t.getRecordModel})||u.getEmptyTitlePlaceholder({getRecordModel:c.getRecordModel,userTimeZone:(0,wt().P)(),intl:i});if("block"===c.table&&(0,Dt().lU)(t)&&n){p=`${n.getName()} - ${i.formatMessage(Gt.homeLabelTitle)}`}if("collection"===c.table&&l&&l.isCollectionView()&&d.length>1){const e=m().default.state.currentCollectionViewStore;e&&e.getName()&&(p=`${p} | ${e.getName()}`)}r.isElectron||(p=(0,bt().sd)(p.slice(0,100),_t().A.state));Pe().qb(o,t)||o.device.isElectron||o.device.isMobileNative||(a>9?p=`(9+) ${p}`:a>0&&(p=`(${a}) ${p}`));return p}({store:l,spaceStore:u,environment:e,device:i,intl:t,unreadCountInCurrentSpace:f,isPublicSite:c}),h=function(e){const{store:t,spaceStore:n,route:o}=e;if(null==n||!n.getPublicSpaceData())return;return"page"===o.name?(0,jt().Ay)({store:t,fullyQualified:!1,scrollToBlockId:null==o?void 0:o.scrollToBlockId,peekViewBlockId:o.peekViewBlockId,peekMode:o.peekMode,collectionViewId:o.collectionViewId,discussionId:o.discussionId,showMoveTo:o.showMoveTo,saveParent:o.saveParent,templateGalleryItem:o.templateGalleryItem,projectManagementLaunch:o.projectManagementLaunch,pageVisitSource:void 0,embedded:o.embedded,...(0,qe().Fy)(o)}):(0,jt().Ay)({store:t,fullyQualified:!1,pageVisitSource:void 0})}({store:l,spaceStore:u,route:s}),{isNonverified:b,hasBypassedContentClassification:S}=function(e){const{blockModel:t,store:n}=e,o=Boolean(null==t?void 0:t.isNonverifiedContentClassification()),r=o&&t&&Kt().A.bypassedPage(n.id);return{isNonverified:o,hasBypassedContentClassification:Boolean(r)}}({blockModel:g,store:l}),y=(0,Pt().TMT)(),w=function(e,t,n){if("space"!==e.name&&"page"!==e.name||!e.requestedOnPublicDomain||!t)return n.getIcon();{const e=zt().GN(n);if(null==e||!e.getSiteId())return n.getIcon();const t=null==e?void 0:e.getSiteStore();if(e&&t&&t.isDefined()){const o=t.getFaviconUrl();return o?{pointer:e.pointer,icon:o}:n.getIcon()}}}(s,u,l),A=!(null!==(n=(0,zt().GN)(l))&&void 0!==n&&null!==(n=n.getSiteStore())&&void 0!==n&&n.isSearchEngineIndexingEnabled()),I=c&&s.spaceDomain?t.formatMessage({id:"seo.SiteNameMetaTitle",defaultMessage:"{spaceDomainName} on Notion"},{spaceDomainName:s.spaceDomain}):t.formatMessage({id:"seo.defaultMetaTitle",defaultMessage:"Default notion title meta tag"}),k=null==g?void 0:g.getSeoDescription(),C=null==g||null===(o=g.getRenderCover(l.getRecordModel))||void 0===o?void 0:o.cover,x=null==g?void 0:g.getLastEditedByPointer(),T=null==g?void 0:g.getCreatedByPointer();let _;if(T){const e=l.getRecordModel(T);e&&(_=(0,vt().lR)(t,e))}if(!_&&x){const e=l.getRecordModel(x);e&&(_=(0,vt().lR)(t,e))}return{title:v,url:h,icon:w,isNonverified:b,isPublicSite:c,hasBypassedContentClassification:S,isMemberOfSpace:y,shouldNoIndex:A,spaceNameForMetaTag:I,description:k,coverImage:C,authorName:_}}),[e,t,a],{useDeepEqual:!0});(0,E().O$)(s),(0,o.useEffect)((()=>{const o=V().sg((function(){const{device:o}=e,i=s.state;if(!i)return;const{url:a,title:c,icon:l,assetPath:d,isNonverified:u,hasBypassedContentClassification:p,isMemberOfSpace:m,description:f,shouldNoIndex:g,spaceNameForMetaTag:v,authorName:h,coverImage:b,isPublicSite:y}=i;let w,A,I,k;l&&(0,At().T8)(l.icon)?I=l.icon:l&&(0,It().A)(l.icon)?w=l.icon:l&&St().GM(l.icon)?A=l.icon:d&&St().Du(d)&&(k=d);const C=u&&!p&&!m;c&&document.title!==c&&(C?document.title=t.formatMessage({id:"pageTitle.flaggedContent",defaultMessage:"Flagged Content"}):o.isSafari&&w?document.title=`${w} ${c}`:document.title=c),a&&ze().ZO(a)!==ze().ZO(window.location.href)&&(window.history.replaceState(window.history.state,void 0,a),xt().Mu({environment:e,url:window.location.href}));const x=document.querySelector("link[rel='shortcut icon']");if(x){const t={linkEl:x,environment:e,device:o,theme:n,config:S().A,lastSetIconStringRef:r},i="local"===(T="production")?ht().A.images.faviconLocalIco:"development"===T?ht().A.images.faviconDevIco:ht().A.images.faviconIco;C?(x.href=i,r.current=i):w?function(e,t){const{linkEl:n,environment:o,lastSetIconStringRef:r}=e;if(t===r.current)return;r.current=t,async function(e,t){const n=document.createElement("canvas");n.width=Lt,n.height=Lt;const o=n.getContext("2d");if(o.font="normal normal normal 32px/32px sans",o.textAlign="center",o.textBaseline="middle","raw"===t)return o.fillText(e,n.width/2,n.height/2+4),n;const r=await Ut().w.load(),i=(0,Et().$)(e,r);if(!i)return;const a=document.createElement("img");a.src=(0,bt().bz)(t);const s=(0,bt().LJ)(i);return new Promise((e=>{a.onload=()=>{o.drawImage(a,s.x,s.y,s.size,s.size,0,0,Lt,Lt),e(n)},a.onerror=()=>{e(void 0)}}))}(t,(0,Tt().FN)(o)).then((async e=>{await Nt().waitForInitialPageRenderToComplete(),await $t().A.waitUntil((()=>!$t().A.state.isMeasuring)),n.href=(null==e?void 0:e.toDataURL("image/png"))||""}))}(t,w):I?function(e,t){const{linkEl:n,device:o,theme:r,lastSetIconStringRef:i}=e;if(t===i.current)return;i.current=t;const a=`${t}?mode=${r.mode}`;o.isFirefox?n.href=a:Rt(a).then((e=>{n.href=e}))}(t,I):l&&A?function(e,t,n){const{linkEl:o,environment:r,config:i,lastSetIconStringRef:a}=e,{...s}=t,c=window.location.origin!==i.domainBaseUrl,l=yt().wY({url:n,permissionRecord:s.pointer,baseUrl:i.domainBaseUrl,fullyQualified:!1,userId:r.currentUser.id,...c?{favicon:!0}:{width:100}});if(l===a.current)return;a.current=l,Vt().transactionQueue.awaitRecordTransaction(s.pointer).then((()=>{if(!c)return Rt(l);o.href=l})).then((e=>{!c&&e&&(o.href=e)}))}(t,l,A):k?function(e,t){const{linkEl:n,environment:o,config:r,lastSetIconStringRef:i}=e,a=yt().x8({url:t,width:100,baseUrl:r.domainBaseUrl,fullyQualified:!1,userId:o.currentUser.id});if(a===i.current)return;i.current=a,Rt(a).then((e=>{n.href=e}))}(t,k):i!==r.current&&(x.href=i,r.current=i)}var T;re().electronApi&&re().electronApi.setWindowTitle&&c&&re().electronApi.setWindowTitle(c),y&&function(e){let{title:t,description:n,url:o,icon:r,image:i,shouldNoIndex:a,author:s,spaceName:c}=e;function l(e,t){const n=`meta[property="${t}"], meta[name="${e}"]`,o=document.querySelector(n);if(o&&o instanceof HTMLMetaElement)return o;const r=document.createElement("meta");return t?r.setAttribute("property",t):r.setAttribute("name",e),document.head.appendChild(r),r}function d(e){const t=document.querySelector(`link[rel="${e}"]`);if(t&&t instanceof HTMLLinkElement)return t;const n=document.createElement("link");return n.setAttribute("rel",e),document.head.appendChild(n),n}['meta[name="twitter:site"]'].forEach((e=>{const t=document.querySelector(e);t&&t instanceof HTMLMetaElement&&t.remove()}));l("twitter:title").setAttribute("content",t);if(l("og:title","og:title").setAttribute("content",t),n){l("description").setAttribute("content",n);l("twitter:description").setAttribute("content",n);l("og:description","og:description").setAttribute("content",n)}if(o){l("twitter:url").setAttribute("content",o);l("og:url","og:url").setAttribute("content",o);d("canonical").setAttribute("href",o)}if(i){l("twitter:image").setAttribute("content",i);l("og:image","og:image").setAttribute("content",i)}if(s){l("article:author","article:author").setAttribute("content",s)}if(c){l("og:site_name","og:site_name").setAttribute("content",c)}if(r){d("shortcut icon").setAttribute("href",r)}if(a){l("robots").setAttribute("content","noindex")}else{const e=document.querySelector('meta[name="robots"]');e&&e instanceof HTMLMetaElement&&e.remove()}}({title:c??"",description:f,url:a,icon:null==x?void 0:x.href,image:b,shouldNoIndex:g,author:h,spaceName:v})}),500,{leading:!0}),i=document.title;return s.state&&o(),s.addListener(o),()=>{s.removeListener(o),document.title=i}}),[e,t,s,n])}n(803949);var Jt=()=>n(185991),Zt=()=>n(549500);const Xt={transcription_idle:async(e,t)=>{(await Zt().$O.load()).idleTranscriptionActions.showIdleTranscriptionToast(e,t)}};var Yt=()=>n(831872),Qt=()=>n(857783),en=()=>n(982254);const tn=["us.zoom.xos"];(0,L().YK)({zoom:{id:"audioProcessDetectionHelpers.audioProcess.zoom",defaultMessage:"Zoom"}});function nn(e){return tn.includes(e)}var on=()=>n(249696);var rn=()=>n(964345),an=()=>n(840125);const sn=(0,L().YK)({have_local_draft_unsaved_changes:{defaultMessage:"Changes you made to the layout may not be saved.",id:"closeConfirmationMessages.haveLocalDraftUnsavedChanges"},dictation_in_progress:{defaultMessage:"Transcription is in progress.",id:"closeConfirmationMessages.dictationInProgress"}});var cn=()=>n(869562),ln=()=>n(749687),dn=()=>n(948914),un=()=>n(730591),pn=()=>n(148832);function mn(){const e=(0,i().v3)(),t=(0,L().tz)(),n=(0,E().K8)((()=>({observedWidth:ln().sidebarSizeObserver.rect.state.width,targetWidth:ln().sidebarWidthStore.state,isExpanded:ln().sidebarExpandedStore.state,resizing:ln().sidebarResizingStore.state,isMouseEntered:ln().sidebarMouseEnteredStore.state})),[]),r=(0,E().K8)((()=>un().A.state.open),[]),a=(0,E().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]),[s,c]=(0,o.useState)(!1),l=e.currentUser.isLoggedIn(),d=(0,ke().formatVersion)(re().getDesktopVersion()),[u,p]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{u&&s&&re().windowSidebarState.set({isLoggedIn:l,...n})}),[n,l,u,s]);const f=(0,E().K8)((()=>{var e,t;const n="transcription"===(null===(e=rn().Ay.state.rootBlock)||void 0===e?void 0:e.getType())?null===(t=rn().Ay.state.rootBlock)||void 0===t?void 0:t.pointer:void 0;return n?[{type:"transcription",pointer:n}]:[]}),[]);(0,o.useEffect)((()=>{re().setActiveBlocks(f)}),[f]);const g=(0,E().K8)((()=>rn().Ay.getState().enabled),[]);(0,o.useEffect)((()=>{re().setIsRecording(g)}),[g]);const v=(0,on().W)(),h=(0,i().Y0)();(0,o.useEffect)((()=>{if(v){var e;const t=(null===(e=dn().A.state.preferences)||void 0===e?void 0:e.transcriptionShortcut)??(0,Jt().C)(h.isMac);re().electronAppFeatures.setPreference("transcriptionShortcut",t)}}),[v,h.isMac]),(0,o.useEffect)((()=>{let e;e=l?n.isExpanded?"expanded":"collapsed":"disabled",re().sidebarState.set(e)}),[n.isExpanded,l]);const b=(0,E().K8)((()=>{var e,t,n;return{currentUserId:null===(e=m().default.state.currentUserStore)||void 0===e?void 0:e.id,currentSpaceId:null===(t=m().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId(),currentPageId:null===(n=m().default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.id}}),[]);(0,o.useEffect)((()=>{re().setAppStoreState(b)}),[b]);const y=(0,C().X)("tab_groups_beta_launch");(0,o.useEffect)((()=>{re().tabSpacesState.setIsTabSpacesBetaEnabled(y)}),[y]),function(e){const t=(0,i().v3)(),n=(0,on().W)(),r=(0,E().K8)((()=>t.device.isElectron&&e&&n&&B().default.checkGate({gateName:"meeting_notes_audio_process_detection"})),[t.device.isElectron,n,e]),a=(0,E().O$)(m().AppStoreCurrentSpaceStore),s=(0,E().K8)((()=>{if(a)return en().A.state.tabs.flatMap((e=>e.activeBlocks)).flatMap((e=>{if(!e)return[];const t=Ft().Bv.createChildStore(a,e.pointer);return t.isTranscriptionBlock()?t:[]}))[0]}),[a]),c=(0,o.useCallback)((async(e,n,o)=>{if(!r)return;const i=o.filter(nn),a=n.filter(nn);for(const r of i){if(s)break;if(!a.includes(r)){(await Zt().$O.load()).audioProcessDetectionActions.sendNotificationForRunningAudioProcess(t,r);break}}for(const r of a)if(!i.includes(r)&&s){(await Zt().$O.load()).transcriptionBlockActions.stopTranscription({environment:t,blockStore:s,from:"audio_process_detection"});break}}),[t,r,s]);(0,o.useEffect)((()=>re().runningInputAudioProcessesChanged.addListener(c)),[c]),(0,o.useEffect)((()=>{r&&re().initializeRunningInputAudioProcessDetection(1e3)}),[r])}(Boolean(u));const w=(0,o.useCallback)(((t,n,o)=>{I().vd(e,n,o)}),[e]);(0,o.useEffect)((()=>re().track.addListener(w)),[w]);const A=(0,o.useCallback)(((t,n)=>{n.forEach((t=>{I().u4({environment:e,event:t})}))}),[e]);(0,o.useEffect)((()=>re().trackBatched.addListener(A)),[A]);const k=(0,o.useCallback)(((e,t)=>{a||p(t)}),[a]),x=(0,o.useCallback)(((e,t)=>{!async function(){const e=await Zt().$O.load();await e.dictationActions.updateActiveBlocks(t)}()}),[]),T=(0,E().K8)((()=>{const{tabs:e}=en().A.state;return e.flatMap((e=>e.activeBlocks??[]))}),[]);(0,o.useEffect)((()=>{T.length>0&&x(void 0,T)}),[x,T]),(0,o.useEffect)((()=>{if(void 0===u||a)return;const e=()=>{Ue().A.update((e=>({...e,isVisible:!document.hidden&&u})))};return e(),document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[u,a]),(0,o.useEffect)((()=>{if(!a)return re().isActiveTab.get().then((e=>{p(e)})),re().isActiveTab.addListener(k)}),[k,a]);const _=(0,o.useCallback)(((e,t)=>{void 0===t.isShowingTabBar&&(t.isShowingTabBar=!0),dn().A.setState(t)}),[]);(0,o.useEffect)((()=>{var e;return null===(e=re().electronAppFeatures.get())||void 0===e||e.then((e=>{dn().A.setState(e)})),re().electronAppFeatures.addListener(_)}),[_]);const P=(0,o.useCallback)(((e,t)=>{en().A.update((e=>({...e,tabs:t})))}),[]);(0,o.useEffect)((()=>re().electronTabs.addListener(P)),[P]);const U=(0,o.useCallback)(((e,t)=>{en().A.update((e=>({...e,currentTab:t})))}),[]);(0,o.useEffect)((()=>re().electronCurrentTab.addListener(U)),[U]);const M=(0,o.useCallback)(((e,t)=>{en().A.update((e=>{const n=new Set(e.unauthorizedIframeUrls??[]);n.add(t);const o=Array.from(n);return{...e,unauthorizedIframeUrls:o}}))}),[]);(0,o.useEffect)((()=>re().setUnauthorizedIframeUrls.addListener(M)),[M]);const j=(0,o.useCallback)((t=>{cn().setExpand({environment:e,isExpanded:!n.isExpanded,from:"electron_listener",saveDetailsSidebarPreference:!1})}),[e,n.isExpanded]);(0,o.useEffect)((()=>re().sidebarState.addToggleListener(j)),[j]);const N=(0,o.useCallback)(((e,t)=>{t?cn().open({fromElectron:!0}):cn().close()}),[]);(0,o.useEffect)((()=>re().sidebarState.addSetSidebarOpenListener(N)),[N]);const D=(0,o.useCallback)(((e,t)=>{ln().sidebarExpandedStore.setState(t.isExpanded),ln().sidebarWidthStore.setState(t.targetWidth)}),[]),O=(0,o.useCallback)((e=>{un().A.update((e=>({...e,open:!e.open})))}),[]);(0,o.useEffect)((()=>re().tabSpacesState.addToggleMenuListener(O)),[O]);const q=(0,o.useCallback)(((e,t)=>{un().A.update((e=>({...e,tabSpacesState:{...e.tabSpacesState,...t}})))}),[]);(0,o.useEffect)((()=>re().tabSpacesState.addListener(q)),[q]),(0,o.useEffect)((()=>{!u&&r&&un().A.update((e=>({...e,open:!1})))}),[u,r]);const z=(0,o.useCallback)(((e,t)=>{R().D6({label:t})}),[]);(0,o.useEffect)((()=>re().tabSpacesState.addSnackBarMessageListener(z)),[z]),(0,o.useEffect)((()=>(re().windowSidebarState.get().then((e=>{e&&(ln().sidebarExpandedStore.setState(e.isExpanded),ln().sidebarWidthStore.setState(e.targetWidth)),c(!0)})),re().windowSidebarState.addListener(D))),[D]),(0,o.useEffect)((()=>{!async function(){if(void 0===d)return;const t=await le().callApi({eventName:"isDesktopVersionCompatible",environment:e,data:{desktopVersion:d}});"success"!==t.type||t.data.compatible||window.location.replace(S().A.domainBaseUrl+t.data.redirect)}()}),[d,e]),(0,o.useEffect)((()=>re().performShortcut.addListener(((t,n)=>{Yt().N6(e,n)}))),[e]);const W=(0,E().K8)((()=>{if(B().default.checkGate({gateName:"desktop_close_confirmation_dialog"})){const e=(0,an().getUserControlledCloseConfirmationDialogReason)();if(e){return{analytics_id:e,localized_message:t.formatMessage(sn[e])}}}}),[t]);(0,o.useEffect)((()=>{re().setCloseConfirmationDialogReason(W)}),[W]);const K=(0,E().O$)(m().AppStoreCurrentSpaceStore),V=(0,o.useCallback)(((t,n)=>{if(!K)return;const o=pn().B.createChildStore(K,n.pointer);Qt().uK({environment:e,store:o,pageVisitSource:n.source})}),[e,K]);(0,o.useEffect)((()=>re().navigateToBlock.addListener(V)),[V]);const $=(0,o.useCallback)(((t,n)=>{Xt[n.toastId](e,n)}),[e]);(0,o.useEffect)((()=>{var e;return null===(e=re().pushToast)||void 0===e?void 0:e.addListener($)}),[$])}var fn=()=>n(720665),gn=()=>n(974233);function vn(e){(0,gn().default)({url:`${S().A.secureFileConfig.rootPath}/refresh`,environment:e,method:"GET",format:"text"})}n(823215),n(737550);var hn=()=>n(979340),bn=()=>n(749240);function Sn(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,E().K8)((()=>{const{currentUserStore:n,currentUserSettingsStore:o,currentUserRootStore:r}=m().default.state;if(!(e.currentUser.id&&n&&o&&r))return e.publicDomainUserId?{user_id:e.publicDomainUserId}:void 0;const i=r.getSpaceViewStores(),a=i.length>0&&i.every((e=>e.isReady()));if(!n.isDefined()||!o.isDefined()||!a)return;const s=V().oE(i.map((e=>e.getSpaceId()))).map((t=>Se().A.getData(e,{spaceId:t})));if(!s.every((e=>Boolean(e)||null===e)))return;const c=function(e){const t=e.map((e=>(0,be().Gb)(e))),n=new Set(V().oE(t));if(n.has("enterprise"))return"enterprise";if(n.has("business"))return"business";if(n.has("plus"))return"plus";if(n.has("personal"))return"personal_pro";if(n.has("team_free"))return"team_free";if(n.has("personal_free"))return"personal_free";if(n.has("free"))return"free";return"none"}(s),l=o.getSettings();if(!l)return;if(void 0===bn().subscriptionDataStoreInstance.state)return;const d={user_id:n.id,email:n.getEmail(),user_persona:l.persona,user_team_role:l.team_role,user_use_cases:l.use_cases,user_company_size:l.company_size,user_source:l.source,user_plan_type:c,user_subscription_tier:bn().subscriptionDataStoreInstance.state.subscriptionTier,user_has_at_least_one_free_tier_space:wn(s),time_zone:l.time_zone,locale:l.locale,preferred_locale:l.preferred_locale,signup_time:l.signup_time,app_version:t.version};return l.signup_time&&(d.created_at=Math.floor(l.signup_time/1e3)),t.desktopAppVersion&&(d.desktop_app_version=t.desktopAppVersion),t.mobileAppVersion&&(d.mobile_app_version=t.mobileAppVersion),l.used_desktop_web_app&&(d.used_desktop_web_app=l.used_desktop_web_app),l.used_mobile_web_app&&(d.used_mobile_web_app=l.used_mobile_web_app),l.used_mac_app&&(d.used_mac_app=l.used_mac_app),l.used_windows_app&&(d.used_windows_app=l.used_windows_app),l.used_ios_app&&(d.used_ios_app=l.used_ios_app),l.used_android_app&&(d.used_android_app=l.used_android_app),d}),[e,t],{useDeepEqual:!0});(0,o.useEffect)((()=>{n&&"none"!==n.user_plan_type&&yn(e,n)}),[e,n]);const r=void 0!==n;(0,o.useEffect)((()=>{const t=window.setTimeout((()=>{!r&&e.currentUser.id&&yn(e,{user_id:e.currentUser.id})}),5e3);return()=>{window.clearTimeout(t)}}),[e,r])}const yn=V().nF(n(444196).k,5e3);function wn(e){return e.map((e=>(0,be().Gb)(e))).filter(oe().Vq).some((e=>hn().dL(e)))}var An=()=>n(893820),In=()=>n(875856);var kn=()=>n(588165),Cn=()=>n(621979);var xn=()=>n(987201),Tn=()=>n(410690),_n=()=>n(711771),Pn=()=>n(148777),En=()=>n(20199);const Un={recentPagesActions:new(y().O2)("recentPagesActions",(async()=>Promise.resolve().then(n.bind(n,824188)))),userSignalsHelpers:new(y().O2)("userSignalsHelpers",(async()=>n.e(84084).then(n.bind(n,954220)))),broadcastChannel:new(y().O2)("broadcastChannel",(async()=>Promise.resolve().then(n.bind(n,467135)))),minisearchDependency:_n().f};function Ln(e){const{elector:t,broadcastChannel:n}=e.state;e.setState(e.getInitialState());(async()=>{await(null==t?void 0:t.die()),await(null==n?void 0:n.close())})()}function Mn(){(0,o.useEffect)((()=>{(0,Pn().So)((()=>({appStart:(0,Tn().getAppStartTime)(),hookStart:performance.now()})))}),[]);const e=(0,i().v3)(),{currentUserId:t,currentSpaceId:n}=(0,E().K8)((()=>{var e,t;return{currentUserId:null===(e=m().default.state.currentUserStore)||void 0===e?void 0:e.id,currentSpaceId:null===(t=m().default.state.currentSpaceStore)||void 0===t?void 0:t.id}}),[]),r=(0,K().ZC)(t),a=(0,K().ZC)(n);(0,o.useEffect)((()=>{t&&n&&(t!==r||n!==a)&&(Ln(En().A),async function(e){const{spaceId:t,userId:n,environment:o}=e;Ln(En().A),(0,Pn().So)((e=>({appStart:e.appStart,hookStart:e.hookStart,setupLocalSearchStart:performance.now()})));const r=Un.recentPagesActions.load().then((async e=>{await e.reinitializeGlobalRecentPagesStoreState(o,n,t)})),i=Un.userSignalsHelpers.load(),a=Un.broadcastChannel.load(),s=(async()=>{const{BroadcastChannel:e,createLeaderElection:o}=await a,r=new e(`local_search_${t}_${n}`),i=o(r);En().A.update((e=>({...e,elector:i,broadcastChannel:r})))})(),c=(await i).initializeAndLoadAllUserSignals({spaceId:t,userId:n,environment:o});await Promise.all([_n().f,r,c,s])}({spaceId:n,userId:t,environment:e}))}),[e,t,n,r,a])}var Rn=()=>n(673998);var jn=()=>n(908006),Nn=()=>n(620689),Bn=()=>n(574012),Dn=()=>n(24157);const On=new(n(496506).default)((()=>{const e=Bn().A.state;return e.phase===Bn().i.willShow?0:e.estimatedKeyboardWebViewOverlap}),{debugName:"estimatedKeyboardWebViewOverlapStore"});var qn=()=>n(852477),zn=()=>n(522945),Wn=()=>n(406792);function Kn(){const e=(0,i().v3)();(0,o.useEffect)((()=>{function t(t){!function(e,t){I().vd(e,"show_page_reload_confirmation_dialog",t)}(e,{reason:t})}return an().showConfirmationDialogEventEmitter.addListener(t),()=>{an().showConfirmationDialogEventEmitter.removeListener(t)}}),[e])}var Vn=()=>n(477293);const $n=300;var Fn=()=>n(187174),Gn=()=>n(165162);var Hn=()=>n(502800);var Jn=()=>n(250454);const Zn=5e3,Xn=Math.random()<.01,Yn=!S().A.isLocalhost,Qn=Xn&&Yn;Jn().I.setShouldCollect(Qn);var eo=()=>n(725614),to=()=>n(906537),no=()=>n(649642);const oo=window.matchMedia("(prefers-color-scheme: dark)");n(944114);var ro=()=>n(677338),io=()=>n(196286);const ao=!1,so=(ao?1:10)*fn().TD,co=5*so;function lo(){ao&&console.log(...arguments)}function uo(){(0,o.useEffect)((()=>{if(!window.BroadcastChannel)return;const e=(0,ro().x0)(),t=new Map,n=new BroadcastChannel("notion_tab_tracker");n.onmessage=e=>{const n=e.data;"string"==typeof n&&t.set(n,Date.now())};const o=window.setInterval((()=>{(()=>{const e=[],n=Date.now();for(const[o,r]of t.entries())n-r>co&&e.push(o);e.length&&lo("Removing tab ids:",e);for(const o of e)t.delete(o)})(),n.postMessage(e);const o=t.size+1;lo("Tab count is",o),(0,io().g)(o)}),so);return()=>{n.close(),window.clearInterval(o)}}),[])}var po=()=>n(919878),mo=()=>n(980914);const fo="loadCachedPageChunk";const go=function(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{(0,I().u4)({environment:e,event:{eventName:"statsig_client_init_error",eventProperties:{statsig_init_method:"bootstrap"}}}),Ae().log({level:"error",from:"statsig",type:"initialize",error:(0,Hn().convertErrorToLog)(t),data:{userId:e.currentUser.id}})}),[e]);(0,a().l)((()=>{Gn().StatsigInitializer.initializePromise?Gn().StatsigInitializer.error?t(Gn().StatsigInitializer.error):Gn().StatsigInitializer.isComplete||t(new Error("`statsig.initialize` was not awaited on app bootstrap")):t(new Error("`statsig.initialize` was not called on app bootstrap"))}))};var vo=()=>n(751156);var ho=()=>n(529543);const bo=function(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{(0,I().u4)({environment:e,event:{eventName:"statsig_client_update_user_error",eventProperties:{statsig_init_method:"bootstrap"}}}),Ae().log({level:"error",from:"statsig",type:"updateUser",error:(0,Hn().convertErrorToLog)(t),data:{nextUserId:e.currentUser.id,err:(0,n(319625).A)(t).message}})}),[e]),[a]=(0,Fn().Yb)((async()=>await ho().getExperimentDeviceId(e)),[e]),[s]=(0,Fn().Yb)((async()=>await ho().getBrowserId(e)),[e]),c=(0,E().K8)((()=>{var e,t;return!(null===(e=m().default.state.currentUserStore)||void 0===e||!e.isDefined())&&!(null!==(t=m().default.state.currentUserStore)&&void 0!==t&&t.getOnboardingCompleted())}),[]),l=(0,E().K8)((()=>{var e;return null===(e=m().default.state.currentSpaceStore)||void 0===e?void 0:e.isDefined()}),[]),d=(0,E().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]),u=(0,o.useRef)(Gn().StatsigInitializer.statsigStageTwoUser),p=(0,E().K8)((()=>{if("resolved"===a.status&&"resolved"===s.status&&(H().A.state.initialRenderCompleted||d)&&(!e.currentUser.id||l||c||d)){const o=n(546369).getDataForStatsigUser({environment:e,deviceId:a.value,browserId:s.value});if(void 0===o.subscriptionTier){var t;const e=null===(t=u.current)||void 0===t||null===(t=t.custom)||void 0===t?void 0:t.spaceSubscriptionTier;n(326215).nb.find((t=>t===e))&&(o.subscriptionTier=e)}return(0,Gn().tX)(o)}}),[e,a,s,l,c,d],{useDeepEqual:!0}),f=(0,o.useRef)(0),g=!(0,E().O$)(N().e);(0,o.useEffect)((()=>{!async function(){if(Gn().StatsigInitializer.isComplete&&p&&!V().n4(p,u.current)&&!g){u.current=p,f.current++;try{const t=await Gn().statsigClientLoader.getClient()||Gn().statsigClientLoader.getUninitializedStatsigClient({statsigUser:p,initialValues:void 0,overrideStableID:(0,Gn().getOrCreateStableID)()}),o=async function(){var o;const i=(0,n(754704).createApiHttpJsonRequestOptions)({environment:e,eventName:"getStatsigResults",data:{...p.customIDs,device:(0,Gn().getDeviceAttributesForStatsigUser)(e.device),locale:r().locale,clientSdkApiKey:S().A.statsig.apiKey,spaceId:null===(o=m().default.state.currentSpaceStore)||void 0===o?void 0:o.id},activeUserId:e.currentUser.id,tracking:void 0,eventListeners:(0,n(459225).getPerformanceEventListeners)({eventName:"getStatsigResults",isPrefetchRequest:!0})}),a=await(0,gn().default)(i);"success"===a.type?(t.dataAdapter.setData(JSON.stringify(a.data.initialValues)),t.updateUserSync(a.data.statsigUser)):Ae().log({level:"error",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsigAndServer",data:{message:"Unable to reach statsig and fallback failed",err:(0,gn().V)(a),nextUserId:e.currentUser.id}})},i=async function(n){t.off("initialization_failure",i),Ae().log({level:"info",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsig",data:{message:"Unable to reach statsig, trying to get latest values from server.",nextUserId:e.currentUser.id}}),await o()};t.dataAdapter.getDataSync(p)?(t.on("initialization_failure",i),await t.updateUserAsync(p)):await o()}catch(o){t(o)}f.current--,0===f.current&&B().default.recomputeAllGroupStores()}}()}),[t,p,e,g])};var So=()=>n(331542);var yo=()=>n(110750),wo=()=>n(628182),Ao=()=>n(584262),Io=()=>n(243020),ko=()=>n(427704),Co=()=>n(179034),xo=()=>n(245241);const To=["compact","regular","unknown"];var _o=()=>n(498212),Po=()=>n(671593),Eo=()=>n(638681),Uo=()=>n(328523),Lo=()=>n(95313),Mo=()=>n(518646),Ro=()=>n(324234),jo=()=>n(750660),No=()=>n(495262),Bo=()=>n(5705),Do=()=>n(867201),Oo=()=>n(537941),qo=()=>n(260488),zo=()=>n(778417),Wo=()=>n(426116),Ko=()=>n(840153),Vo=()=>n(994877),$o=()=>n(24611);var Fo=()=>n(357307);var Go=()=>n(962845),Ho=()=>n(155959),Jo=()=>n(210737);var Zo=()=>n(644914);var Xo=()=>n(756279),Yo=()=>n(313790),Qo=()=>n(595985);var er=()=>n(183558);function tr(e){const t=(0,yo().Xz)(e);switch(t.type){case"native":return;case"web":const e=t.route;switch(e.name){case"page":return e.collectionViewId?"collection":"page";case"nativeTab":switch(e.tab){case"updates":return"updates";case"assistant":return"assistant";case"trash":return"trash";case"members":return"members";case"help":return"help";case"templates":return"templates";case"offline":return"offline_settings"}break;default:return}}}var nr=()=>n(862292),or=()=>n(986260),rr=()=>n(372657),ir=()=>n(836251),ar=()=>n(347199),sr=()=>n(780865),cr=()=>n(719431),lr=()=>n(575301),dr=()=>n(1130);const ur={MobileNativePerformanceListener:new(y().O2)("MobileNativePerformanceListener",(async()=>await n.e(62058).then(n.bind(n,227731))))},pr=(0,y()._h)(ur.MobileNativePerformanceListener,(e=>e.MobileNativePerformanceListener));var mr=()=>n(179266),fr=()=>n(129522),gr=()=>n(106628),vr=()=>n(690978),hr=()=>n(624307),br=()=>n(323914),Sr=()=>n(496067),yr=()=>n(718807),wr=()=>n(524450),Ar=()=>n(518888),Ir=()=>n(732797),kr=()=>n(529649),Cr=()=>n(933371),xr=()=>n(75368),Tr=()=>n(606932),_r=()=>n(466872),Pr=()=>n(224701);const Er=(0,L().YK)({failedToMovePageGeneric:{id:"MobileNativeListener.failedToMovePage",defaultMessage:"Failed to move page"}}),Ur=V().Bj((async(e,t)=>(await gr().T.searchActions.load()).getLocalCacheFromAppState(e)),((e,t)=>{var n;return`${e.currentUser.id}-${(null===(n=m().default.state.currentSpaceViewStore)||void 0===n?void 0:n.id)??"none"}-${t??"none"}`}));function Lr(e){const{mobileNative:t,TabbedRouterStore:o,device:r}=e();if(r.isMobileNative&&t){var i;t.updateReceiveApiHandlers({nativeToWebRenderStart:e=>{if("number"==typeof e)Tr().A.markNativeToWebRenderStart(e);else{const{startTime:t,parameters:n}=e;Tr().A.markNativeToWebRenderStart(t,n)}},connectivityTypeChanged:e=>{N().A.setState({...N().A.state,mobileConnectivityType:e})},toggleAvailableOffline:t=>{const{pageId:n}=t;J().lX({store:new(Ft().Bv)(e(),{table:Co().ev,id:n}),environment:e(),analyticsFrom:"mobile_home"})},statusBarTap:Rr,backButtonPress:()=>Yt().N6(e(),{type:"backbutton"}),keyboardWillShow:t=>{Bn().A.updateKeyboardPhase(e(),Bn().i.willShow,t??0)},keyboardDidShow:t=>{Bn().A.updateKeyboardPhase(e(),Bn().i.shown,t??0)},keyboardWillHide:()=>{Bn().A.updateKeyboardPhase(e(),Bn().i.willHide,0)},keyboardDidHide:()=>{var t;(Bn().A.updateKeyboardPhase(e(),Bn().i.hidden,0),r.isIpad)&&(zo().IU({environment:e()}),null===(t=e().NativeMobileActionBarStore)||void 0===t||t.clear(!0))},keyboardConfigChanged:e=>{Bn().A.updateKeyboardConfig(e.packageName,e.activeLocale)},safeAreaConfigChanged:t=>{(0,Ho().T)("supportsNativeSafeAreaConfig")?(wo().U4.update((e=>({...e,supportsNativeSafeAreaConfig:!0,top:t.top,bottom:t.bottom,left:t.left,right:t.right}))),e().WindowSizeStore.updateWindowSize()):wo().U4.reset()},keyboardShortcut:t=>Yt().N6(e(),t),nativeBottomBarDidChange:e=>{void 0!==e.height&&Bn().A.update((t=>t.lastUpdatedTimestamp&&e.timestamp&&e.timestamp<t.lastUpdatedTimestamp?t:{...t,nativeBottomBarHeight:e.height,lastUpdatedTimestamp:e.timestamp}))},pushNotificationTokenRefresh:t=>Ro().handleTokenRefresh(e(),t,"refresh"),resume:wr().A.resume,pause:async()=>{wr().A.pause();const{stopDictation:t}=await Promise.all([n.e(75134),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(17989),n.e(90625),n.e(59794),n.e(26483),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(48199),n.e(45620),n.e(2681),n.e(48438),n.e(30733)]).then(n.bind(n,749514));await t({environment:e(),from:"native_action"})},refreshSubscriptionData:async t=>{await le().callApi({eventName:"invalidateSubscriptionData",environment:e(),data:{spaceId:t,provider:"revenue_cat"}}),await Pr().Ow(e())},refreshSubscriptionDataV2:async()=>{await Pr().Ow(e())},processMobileActionBarAction:e=>{const{componentId:n,action:o}=e;t.componentEvents.dispatch("MobileActionBar",n,"onAction",{action:o})},logout:t=>{cr().logoutSingleAccount({environment:e(),userId:t,logoutOrigin:Io().d.MobileNativeListener})},logoutV2:t=>{const{userId:n,fcmToken:o}=t;cr().logoutSingleAccount({environment:e(),userId:n,logoutOrigin:Io().d.MobileNativeListener,fcmToken:o})},logoutAll:()=>{cr().logout(e())},openDestinationV2:t=>{Jo().A.closeAll();const n=e(),o=(0,yo().Xz)(n.TabbedRouterStore.state),{activeTab:r,tabs:i}=n.TabbedRouterStore.state,a=o===i[r].rootPage,s="native"===o.type,c=a&&s;switch((0,ir().Al)(n)&&Oo().s({environment:n,tab:n.TabbedRouterStore.state.activeTab,nativeRootPageOverrideEnabled:!1}),t.type){case"moveTo":!function(e,t){const n=new(Ft().Bv)(t,{table:Co().ev,id:e});jo().ho({environment:t,blocks:[n],moveToContext:"home_tab",onAccept:e=>{Do().Y({store:n,environment:t,pageVisitSource:Ao().y8.Move})}})}(t.blockId,n);break;case"trash":Br({query:t.query});break;case"webSearch":!function(e,t){qo()._N({environment:e,analyticsFrom:"mobile-bottom-bar",query:t}),Uo().Mq(e,{itemName:"search",logging_source:"mobile_native"})}(n,t.query);break;case"templates":!function(e,t){Dr(e),xr().A.setState({open:!0,isFromNativeHome:!0,source:t.source})}(n,{source:t.source});break;case"AIAssistant":!function(e,t,n){Cr().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)}))),xt().oo({environment:e,url:`${ko().GJ.nativeTab}/assistant`,redirect:t})}(n,c,{query:t.query,searchSessionId:t.searchSessionId,from:t.from});break;case"createOrJoinWorkspace":return Nr(n,t.userId)}},openDestination:t=>{Jo().A.closeAll();const n=e();switch("closePopup"!==t&&(0,ir().Al)(n)&&Boolean(n.TabbedRouterStore.state.tabs[n.TabbedRouterStore.state.activeTab].nativeRootPageOverrideEnabled)&&Oo().s({environment:n,tab:o.state.activeTab,nativeRootPageOverrideEnabled:!1}),t){case"addPage":Dr(n);break;case"allUpdates":!function(e){(0,Ho().T)("supportsNativeHome")&&e.device.isPhone?(Bo().TC({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),xt().oo({environment:e,url:`${ko().GJ.nativeTab}/updates`,redirect:!0})):_r().A.setState({..._r().A.state,open:!0})}(n);break;case"addAccount":br().c.setState({...br().c.state,open:!0});break;case"createOrJoinWorkspace":return Nr(n);case"notificationAndSettings":hr().A.setState({open:!0,source:hr().C.Home});break;case"trash":Br({});break;case"memberSettings":kr().A.setState({...kr().A.state,open:!0});break;case"help":Ir().A.setState({...Ir().A.state,open:!0});break;case"intercom_messages":!function(e){Vo().SI({environment:e,from:"help_button"})}(n);break;case"aiWriter":!function(e){or().hW(e)}(n)}},updateFileUploadProgress:e=>{const{uploadKey:t,progressPercent:n}=e,o=Ar().default.getKeyState(t);o&&Ar().default.setKeyState(t,{...o,progressPercent:n})},setCurrentUserId:async t=>{await jr(t,e())},setCurrentSpace:async t=>{await async function(e,t,n){const o=await Ko().T({environment:n,newCurrentUserId:e}),{currentUserRootStore:r,currentUserSettingsStore:i}=m().default.state;if(!r)return;await r.load();const a=(0,be().km)(t);a&&await Wo().tR({environment:o,spaceViewStore:a,userSettingsStore:i,userRootStore:r,pageVisitSource:Ao().y8.SwitchSpace,navigationType:"switchingToOrLoadingSpace"})}(t.userId,t.spaceId,e())},updateHorizontalSizeClass:e=>{const n=(0,Po().tf)(Eo().literals(...To),e)?"unknown":e;n!==t.horizontalSizeClass.state&&t.horizontalSizeClass.setState(n)},updateTabbedRouterState:t=>{var n;const o=e(),{TabbedRouterStore:r}=o,i=r.state;if(t.tab!==i.activeTab||null!==(n=t.pages)&&void 0!==n&&n.length||!V().n4(t.modal,i.modal)||i.tabs[i.activeTab].pages.length){const n=t.navigationEffect;if(n&&"AIAssistant"===n.type)Cr().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)})));Oo().s({environment:e(),tab:t.tab,queryParams:t.queryParams,pages:t.pages,modal:t.modal,nativeRootPageOverrideEnabled:t.nativeRootPageOverrideEnabled,navigationAction:t.navigationAction,navigationSource:t.navigationSource})}else Rr();const a=r.state;return[{state:a,topPage:(0,yo().Xz)(a),webTransitionType:tr(a),updateId:t.updateId??(0,_o().Ay)()}]},getLocalSearchResults:async t=>{const n=await Ur(e(),t.searchSessionId);if(!n)return[{error:"Local cache does not exist"}];const o=(0,Po().tf)(xo().gG,t.sort);if(o)return[{error:`old sort type is unsupported! ${o}`}];const r=t.sort,i=!N().A.state.online&&B().default.checkGate({gateName:"download_for_offline"}),a={...t.filters,isOfflineOnly:i},s=(0,vr().k)({query:{query:{text:t.query??"",filters:a,sort:r},limit:t.limit},localCachedPages:n,includeRecordMap:!1,userId:e().currentUser.id,environment:e()}),c=[{value:{total:0,results:[],recordMap:{},trackEventProperties:void 0}}];if(!s||0===s.results.length)return c;const l=N().A.state.online?sr().kZ(e(),s.results):s.results;return[{value:{results:l,total:l.length,recordMap:{},trackEventProperties:{}}}]},customAddCommentMenuItemTapped:async()=>{const t=await nr().T.formulas.load();(0,or().aI)(e(),"custom_add_comment_menu_item",t)},filterValidMoveToBlocks:t=>{const n=t.targets.map((t=>new(Ft().Bv)(e(),{table:Co().ev,id:t}))),o=t.blocks.filter((t=>{const o=new(Ft().Bv)(e(),{table:Co().ev,id:t});return o.canEdit()&&(0,rr().zO)(o,n)}));return[{value:{targets:t.targets,blocks:o}}]},completeMoveToTransaction:async t=>{const{targets:n,destination:o,moveToContext:r,timeToSelectMs:i,isSearchResult:a,flowId:s}=t,c=n.map((t=>new(Ft().Bv)(e(),{table:Co().ev,id:t}))),l=jo().zs(e(),n,o);if(c&&c.length>0&&!l)try{return await vo().createAndCommitAsync({userAction:"MobileNativeListener.completeMoveTo",environment:e(),waitForServerCommit:!1,perform:async t=>{await jo().Ju({targets:c,value:o,transaction:t,environment:e(),moveToContext:r,renderType:"native",timeToSelectMs:i,disableSuccessToast:!0,isSearchResult:a,flowId:s})}}),[{value:t}]}catch(d){}return Lo().qN(e(),{type:"moved_to_subpage"}),[{error:Bt().A.formatMessage(Er.failedToMovePageGeneric)}]},undoRevision:()=>{No().tN({environment:e(),preventSelectText:!0})},searchTeams:async e=>{const{query:t}=e,n=m().default.state.currentSpaceStore,o=m().default.state.currentSpaceViewStore;if(!n||!o)return[{error:"SpaceStore or SpaceViewStore was undefined"}];const r=await gr().T.searchActions.load();return[{value:{ids:(await r.searchTeams({spaceViewStore:o,query:t,teamStores:o.getTeamsStores()})).map((e=>e.id))}}]},getImageBlockUrls:async t=>{var n;const{blockId:o,renderWidth:r}=t,i=null===(n=fr().K.findBlockFromId(o))||void 0===n?void 0:n.getBlockStore();if(!i||"image"!==i.getType())return[{error:"blockId points to a non-image block"}];const a=i,s=(0,$o().x7)(a),c={isAuthenticated:!0,url:s,width:r,permissionRecord:a.pointer},l=e(),d=await(0,mr().L)(c,l);if(!d)return[{error:"could not get proxied image url"}];const u=0===d.indexOf("https:")?d:`${S().A.domainBaseUrl}${d}`;let p;return St()._J(s)&&(p=await(0,Mo().k)(l,{url:s,download:!1,downloadName:"image",permissionRecord:a.pointer},!1,!1)),[{value:{previewUrl:u,originalUrl:p}}]}});const s=e().mobileNative;var a;if(null!=s&&null!==(i=s.api)&&void 0!==i&&i.ready)null==s||null===(a=s.api)||void 0===a||a.ready()}}function Mr(){const e=(0,i().v3)(),t=(0,C().X)("tablet_refresh_gate"),{device:n}=e;(0,o.useEffect)((()=>Lr((()=>e))),[e]),function(){const e=(0,i().v3)(),t=(0,E().K8)((()=>(0,Fo().Y)(e)),[e]);(0,o.useEffect)((()=>{var n;null===(n=e.mobileNative)||void 0===n||n.toggleBottomBar(t)}),[e.mobileNative,t])}(),function(){const{mobileNative:e}=(0,i().v3)(),t=(0,E().K8)((()=>{const{currentUserStore:e,currentSpaceStore:t}=m().default.state;if(!e||!t)return;const n=Wt().zD.isShowingQNAOnMobile(),o=Wt().zD.shouldShowAssistantFace();return{userId:e.id,spaceId:t.id,enabled:n,showAssistantFace:o}}),[]);(0,o.useEffect)((()=>{t&&(null==e||e.updateAiAssistantEnabledState(t))}),[e,t])}(),function(){const{mobileNative:e}=(0,i().v3)();(0,o.useEffect)((()=>{null==e||e.updateAiAssistantVisibilityState({enabled:!1})}),[e])}(),function(){const e=(0,i().v3)(),{mobileNative:t,WindowSizeStore:n}=e,r=(0,E().O$)(n),a=(0,E().K8)((()=>({visible:ln().sidebarExpandedStore.state&&!(0,Zo().o1)(e),width:(0,Zo().r6)(e)})),[e]);(0,o.useEffect)((()=>{null==t||t.sidebarVisibility(a.visible,a.width)}),[e,t,r,a])}(),function(){const e=(0,i().v3)(),{mobileNative:t,TabbedRouterStore:n}=e,{state:r,previousState:a}=(0,E().K8)((()=>({state:n.state,previousState:n.getPreviousState()})),[n]);(0,o.useEffect)((()=>{const n=null==t?void 0:t.api.handleTabbedRouterStateUpdate;if(n){if(n({state:r,topPage:(0,yo().Xz)(r),webTransitionType:tr(r),updateId:(0,er().Ay)()}),!a)return;const t=(0,yo().WP)(a),o=(0,yo().WP)(r);V().n4(t,o)||Uo().yY(e,{origin:t,destination:o,from:r.navigationSource,action:r.navigationAction,logging_source:"mobile_native"})}}),[e,t,r,a])}(),function(){const{mobileNative:e,RouterStore:t}=(0,i().v3)(),{isIOS:n}=(0,i().Y0)(),r=(0,o.useRef)(!1),a=(0,E().O$)(Yo().A),s=(0,E().K8)((()=>"onboarding"===t.state.route.name),[t]);(0,o.useEffect)((()=>{n&&null!=e&&e.setWebViewAllowsNavigationGestures&&(s||ln().sidebarOpenStore.state||Qo().A.getPreventScrollType()!==Xo().A.None?!1!==r.current&&(r.current=!1,e.setWebViewAllowsNavigationGestures(!1)):!0!==r.current&&(r.current=!0,e.setWebViewAllowsNavigationGestures(!0)))}),[n,s,e,a])}(),function(){const{mobileNative:e,TabbedRouterStore:t}=(0,i().v3)(),n=(0,E().K8)((()=>{var e;if(!(0,Ho().T)("supportsCustomAddCommentMenuItem"))return!1;const{currentUserStore:n}=m().default.state;if(!Boolean(null==n?void 0:n.id))return!1;if((0,Ho().T)("supportsNativeBottomBarOverlappingWebView")?Jo().A.hasOpenMobileSlideUps():Jo().A.hasOpenPopups())return!1;const o=(0,yo().Xz)(t.state),r="web"===o.type&&((null===(e=o.redirectedTo)||void 0===e?void 0:e.route)||o.route);if(!r||"page"!==r.name)return!1;const i=Dn().default.state;if("empty"===i.mode)return!1;const a=(0,Go().ZS)({multiSelection:i.multiSelection,filterCommonAncestors:!0,focus:void 0});return!(!a||0===a.stores.length)&&a.stores.every((e=>e.canComment()))}),[t]);(0,o.useEffect)((()=>{(0,Ho().T)("supportsCustomAddCommentMenuItem")&&(null==e||e.updateCustomAddCommentMenuItemEnabled(n))}),[e,n])}(),(0,lr().qh)(),(0,o.useEffect)((()=>{n.isTablet&&t&&ln().sidebarWidthStore.setState(300)}),[n,t]);const r=(0,o.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(e.tabs).forEach((n=>{const o=n;t&&(e.tabs[o].nativeRootPageOverrideEnabled=void 0),o!==e.activeTab?e.tabs[o].pages=[]:e.tabs[o].pages=e.tabs[o].pages.slice(-1)}))}),[]),a=(0,o.useCallback)(((t,n)=>{var o;const{mobileNative:i,TabbedRouterStore:a,currentUser:s}=e,c=m().default.state.currentSpaceStore,l=null==c?void 0:c.id;if(null!=i&&null!==(o=i.api)&&void 0!==o&&o.setCurrentSpaceInfo&&(Ae().log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"Web calling nativeAPI setCurrentSpaceInfo",spaceId:l}}),i.api.setCurrentSpaceInfo({spaceId:l,spaceViewId:null==t?void 0:t.id,userId:s.id,editable:(null==c?void 0:c.canEdit())??!0})),(0,ir().Al)(e)){const e=e=>{if("web"!==e.type)return;const t={...e.queryParams},n=l&&(0,_o().Xw)(l);t.spaceId=n,e.queryParams=t,e.route.spaceId=n},t=V().mg(a.state);e(t.tabs.updates.rootPage),e(t.tabs.addPage.rootPage),void 0!==(null==n?void 0:n.id)&&r(t),a.setState(t)}Ur(e,void 0)}),[r,e]),s=(0,o.useCallback)((t=>{var n;null!==(n=e.mobileNative)&&void 0!==n&&null!==(n=n.api)&&void 0!==n&&n.setCurrentUserInfo&&e.mobileNative.api.setCurrentUserInfo({userId:null==t?void 0:t.id,loggedInUserIds:e.currentUser.loggedInUserIds});const o=!(0,ir().Al)(e)||void 0===e.currentUser.id,{TabbedRouterStore:i}=e,a=V().mg(i.state);r(a,o),i.setState(a)}),[r,e]),c=(0,E().K8)((()=>m().default.state.currentUserStore),[]),l=(0,K().ZC)(c);(0,o.useEffect)((()=>{(null==c?void 0:c.id)!==(null==l?void 0:l.id)&&s(c)}),[s,c,l,n.isMobileNative,e.mobileNative]);const d=(0,E().O$)(m().AppStoreCurrentSpaceViewStore),u=(0,K().ZC)(d);(0,o.useEffect)((()=>{(null==d?void 0:d.id)!==(null==u?void 0:u.id)&&a(d,u)}),[a,d,u,n.isMobileNative,e.mobileNative]);const p=(0,C().X)("mab_debugging");return(0,o.useEffect)((()=>{or().tu(p)}),[p]),(0,q.jsx)(pr,{})}function Rr(){var e;if(Qo().A.getPreventScrollType()===Xo().A.None)if(ln().sidebarOpenStore.state)ar().A.SidebarMobileScroller&&(null===(e=ar().A.SidebarMobileScroller.getNode())||void 0===e||e.scrollTo({top:0,behavior:"auto"}));else if(ar().A.MenuScroller){var t;null===(t=ar().A.MenuScroller.getNode())||void 0===t||t.scrollTo({top:0,behavior:"auto"})}else if(ar().A.MenuPageScroller){var n;null===(n=ar().A.MenuPageScroller.getNode())||void 0===n||n.scrollTo({top:0,behavior:"auto"})}else if(ar().A.PageScroller){var o;null===(o=ar().A.PageScroller.getNode())||void 0===o||o.scrollTo({top:0,behavior:"auto"})}}async function jr(e,t){return t.currentUser.id===e?t:await Ko().T({environment:t,newCurrentUserId:e})}async function Nr(e,t){let n=e;t&&(n=await jr(t,e)),await dr().Ig(n,"mobile_native_listener")}function Br(e){Sr().A.setState({open:!0});const{query:t}=e;t&&yr().Ay.setState({...yr().Ay.state,currentTab:"all_pages",filter:t,limit:yr().Ay.startLimit})}function Dr(e){(0,Ho().T)("supportsNativeHome")&&e.device.isPhone?(Bo().TC({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),cn().quickAddPage({environment:e,from:"mobile_bottom_bar",redirect:!0,quickAddParentOverride:{type:"space-private-pages"}})):cn().quickAddPage({environment:e,from:"mobile_bottom_bar"}),Uo().Mq(e,{itemName:"add_page"})}function Or(e){const t=(0,i().v3)();(0,a().l)((()=>{const{device:e,mobileNative:n}=t;if(d().cL(t),u().fD(t),n&&n.hideSplashscreen(),e.isMobile){const e=document.body.parentElement;e&&e.classList.add(k().Hw6)}(0,I().ET)(t),s().hR({device:e,config:S().A,cookieService:t.cookieService}),l().g5(r().locale),(0,c().O8)(window.location.href)})),function(){const e=(0,i().v3)(),t=(0,i().Y0)();(0,o.useEffect)((()=>{if(t.isMobileNative)return;let e;document.hasFocus()&&(e=setInterval((()=>{b()}),h),b());const n=()=>{e&&clearInterval(e),e=setInterval((()=>{b()}),h),b()},o=()=>{e&&clearInterval(e),e=void 0};return window.addEventListener("focus",n),window.addEventListener("blur",o),()=>{e&&clearInterval(e),window.removeEventListener("focus",n),window.removeEventListener("blur",o)}}),[t.isMobileNative,e])}(),function(){const e=(0,o.useRef)(!1),t=(0,i().v3)(),n=(0,o.useCallback)((async e=>{if(e.currentUser.id&&ue().fJ.size>0){const t=await le().callApi({eventName:"getTasks",environment:e,data:{taskIds:Array.from(ue().fJ.values())}});if("success"===t.type){const{results:n}=t.data,o=new Set(ue().fJ);for(const t of n)o.delete(t.id),t.status&&(0,de().s)({environment:e,eventName:t.eventName,response:t.status,userId:e.currentUser.id}),ue().u_.emit(t.id,t),fe.emit(t.eventName,t),"failure"!==t.state&&"success"!==t.state&&"dead"!==t.state&&"timeout_before_execution"!==t.state||ue().fJ.delete(t.id);if(o.size>0)for(const e of o.values())ue().fJ.delete(e)}}}),[]),r=(0,E().K8)((()=>{var e;return null===(e=m().default.state)||void 0===e||null===(e=e.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),a=(0,o.useCallback)((async e=>{if(e.currentUser.id&&r){const t=await le().callApi({eventName:"getUserTasks",environment:e,data:{spaceId:r}});if("success"===t.type){for(const e of t.data.taskIds)ue().fJ.add(e);t.data.taskIds.length>0&&n(e)}}}),[n,r]),s=(0,o.useCallback)((()=>{const n=N().A.state.online;n&&!e.current&&a(t),e.current=n}),[t,a]);function c(e){"success"===e.state?pe().A.setStatus(e.request.blockId,void 0):"in_progress"===e.state||"not_started"===e.state?pe().A.setStatus(e.request.blockId,e.status):pe().A.setStatus(e.request.blockId,void 0)}function l(e){"success"===e.state?me().A.setStatus(e.request.blockId,!1):"in_progress"===e.state||"not_started"===e.state?me().A.setStatus(e.request.blockId,!0):me().A.setStatus(e.request.blockId,!1)}(0,o.useEffect)((()=>{e.current=N().A.state.online;const o=setInterval((()=>n(t)),2e3);return a(t),N().A.addListener(s),fe.addListener(ce().r,c),fe.addListener(se,l),()=>{clearInterval(o),N().A.removeListener(s),fe.removeListener(ce().r,c),fe.removeListener(se,l)}}),[t,n,s,a])}(),function(){const e=(0,i().v3)(),t=(0,o.useCallback)((()=>{ge().uh(e)}),[e]);(0,o.useEffect)((()=>(t(),ve().A.addListener(t),()=>{ve().A.removeListener(t)})),[t])}(),ye(),Me(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const{device:t}=e;"external"===(0,qe().parseRoute)({url:window.location.href,isMobile:t.isMobile,baseUrl:S().A.domainBaseUrl,publicDomainName:S().A.publicDomainName,protocol:S().A.protocol,currentUrl:window.location.href}).name&&Te().ui({message:"Mismatch between origin and baseUrl (dev).",showCancel:!1,keepFocus:!1,items:[{label:(0,q.jsx)(L().sA,{defaultMessage:"OK",id:"notionAppContainer.dialog.mismatchedOriginURL.okayButton.label"}),onAccept:()=>{const e=ze().pf({relativeUrl:ze().ZO(window.location.href),baseUrl:S().A.domainBaseUrl}),t=ze().qg(e);t.protocol=ze().qg(window.location.href).protocol,window.location.href=ze().GP(t)}}]})}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{Ke(e);const t=window.setInterval((()=>Ke(e)),$e);return()=>window.clearInterval(t)}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{(0,Fe().setEnvironment)(e)}),[e])}(),gt(),Ht(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{vn(e);const t=window.setInterval((()=>vn(e)),fn().pT);return()=>window.clearInterval(t)}),[e])}(),Sn(),function(){const e=(0,i().v3)(),t=(0,E().K8)((()=>In().default.state.isLoaded),[]),n=(0,E().K8)((()=>In().default.state.isLoggingEnabled),[]);(0,o.useEffect)((()=>{t&&async function(){const t=await(0,I().TZ)(e);await An().n_({config:S().A,isEnabled:n,deviceId:t,cookieService:e.cookieService,endpoint:In().default.state.endpoint})}()}),[e,t,n])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const t=t=>{Yt().N6(e,t)},n=t=>{const n=(0,kn().a)(e.device),o=V().Tj(n,((n,o)=>(0,Cn().A)(e,t,n)));o&&!{cut:!0,copy:!0,paste:!0}[o]&&Yt().uj(e,t,o)};return window.addEventListener("keydown",n),window.addEventListener("cut",t),window.addEventListener("copy",t),window.addEventListener("paste",t),window.addEventListener("keypress",t),()=>{window.removeEventListener("keydown",n),window.removeEventListener("cut",t),window.removeEventListener("copy",t),window.removeEventListener("paste",t),window.removeEventListener("keypress",t)}}))}(),(0,xn().A)(),Mn(),function(){const e=(0,i().v3)(),t=(0,i().Y0)();(0,o.useEffect)((()=>{t.isElectron&&re().setLogglyData(Ae().clientLogglyEnvironmentData),e.mobileNative&&e.mobileNative.setLogglyData(Ae().clientLogglyEnvironmentData)}),[t.isElectron,e.mobileNative])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{Rn().GB({environment:e})}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{if(e.device.isMobile){function t(){jn().default.afterNextFlush((()=>{Nn().pS(e)}))}return Dn().default.addListener(t),On.addListener(t),Bn().A.addListener(t),()=>{Dn().default.removeListener(t),On.removeListener(t),Bn().A.addListener(t)}}}),[e])}(),(0,qn().A)(),(0,zn().Ay)(),function(){const[{value:e}]=(0,Fn().Yb)((()=>Gn().statsigClientLoader.getClient()),[]),t=(0,E().O$)(N().e);(0,o.useEffect)((()=>{e&&(t?e.updateRuntimeOptions({disableLogging:!1}):e.updateRuntimeOptions({disableLogging:!0}))}),[e,t])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{if(!Jn().I.getShouldCollect())return;const t=setInterval((()=>{Jn().I.getLongEventMetrics().forEach((t=>{(0,I().u4)({environment:e,event:t})})),Jn().I.resetMetrics()}),Zn);return()=>clearInterval(t)}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const{mobileNative:t}=e;t&&t.enableBridgeMetricsCollection(e,Wn().default,B().default)}),[e])}(),Kn(),function(){const e=(0,i().v3)(),t=(0,E().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]),n="on"===(0,Vn().r)("preload_prewarm_tab_v2");(0,o.useEffect)((()=>{if(n&&t)return;let o,r=!document.hidden;function i(){e.device.isElectron||Ue().A.setState({...Ue().A.state,isVisible:!document.hidden});const t=!document.hidden;t!==r&&(r=t,Ue().P.setState(t),clearTimeout(o),t&&(o=setTimeout((()=>{Ue().P.setState(!1)}),$n)));const n=Ce().K7(),i=n&&(Date.now()-n)/fn().nD>=7;if(e.device.isBrowser&&!document.hidden&&(!n||i)&&N().A.getState().online){const t=e.AppUpdateStore;if(t.isSilentUpdate()){const n=t.state.appUpdate;Ce().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}}return document.addEventListener("visibilitychange",i),i(),()=>{document.removeEventListener("visibilitychange",i)}}),[e,t,n])}(),function(){const{defaultRecordCache:{persistedRecordCache:e}}=(0,i().v3)(),t=(0,C().X)("recover_from_sqlite_corruption"),n=(0,C().X)("recover_from_sqlite_corruption_log_integrity_check_results");(0,o.useEffect)((()=>{const o=new AbortController;if(t||n)return async function(){if(e)for(;!o.signal.aborted;){try{const{corruptRecordCacheResults:o,corruptOfflineResults:i}=await e.getCorruptTables();if(n&&Ae().log({level:"info",from:"useRecoverFromSqliteCorruption",type:"corruptTablesFound",data:{corruptRecordCacheResults:o,corruptOfflineResults:i}}),t&&(o.length>0||i.length>0)){let t;try{t=await e.backupOfflineTables()}catch(r){}await e.completelyRebuildSqliteDb(),t&&await e.restoreOfflineTablesBackup(t)}}catch(r){Ae().log({level:"error",from:"useRecoverFromSqliteCorruption",type:"unexpectedError",error:(0,Hn().convertErrorToLog)(r)});break}await(0,$().wR)(5e3)}}(),()=>{o.abort()}}),[e,t,n])}(),function(){const{deviceType:e}=(0,i().Y0)(),t=(0,i().v3)(),n=t.currentUser.isLoggedIn();(0,o.useEffect)((()=>{if(!n)return;if("windows-desktop"!==e&&"mac-desktop"!==e)return;const o=async()=>{await re().isMainTabOrWindow()&&le().callApi({eventName:"registerDesktopApp",environment:t,data:{deviceType:e}})};o();const r=window.setInterval((()=>{o()}),5*fn().Xb);return()=>{window.clearInterval(r)}}),[n,e,t])}(),uo(),function(){const e=(0,i().v3)(),t=(0,o.useRef)(),n=(0,o.useRef)();(0,o.useEffect)((()=>{function o(){const o=Dn().default.state,r="empty"===o.mode?void 0:o.multiSelection.start.store,i="empty"===o.mode?void 0:o.multiSelection.end.store;if(t.current===r&&n.current===i)return;if(t.current=r,n.current=i,t.current!==n.current)return;const a=mo().wg();if(!a)return;const{rowIndex:s,columnIndex:c,simpleTableStore:l}=a.getProps();po().VC({environment:e,rowIndex:s,columnIndex:c,simpleTableStore:l})}return Dn().default.addListener(o),()=>{Dn().default.removeListener(o),t.current=void 0,n.current=void 0}}))}(),function(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{var n,o;const r={compressed:t.decodedBodySize!==t.encodedBodySize,local_cache_hit:0===t.transferSize,next_hop_protocol:t.nextHopProtocol,did_prefetch:"hit-match"===(null===(n=e.prefetchCache.getPrefetchAnalytic(`loadCachedPageChunk(${null===(o=m().default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.id})`))||void 0===n?void 0:n.type)},i={dns_lookup:{startTime:t.domainLookupStart,endTime:t.domainLookupEnd},connection_establish:{startTime:t.connectStart,endTime:t.connectEnd},request_queued:{startTime:t.connectEnd,endTime:t.requestStart},response_wait:{startTime:t.requestStart,endTime:t.responseStart},response_download:{startTime:t.responseStart,endTime:t.responseEnd}};Wn().default.DO_NOT_USE_measureLegacy({metricName:"load_cached_page_chunk.fetch",startTime:t.fetchStart,endTime:t.responseEnd},{environment:e,data:{...r,sub_metrics:{dns_lookup:i.dns_lookup.endTime-i.dns_lookup.startTime,connection_establish:i.connection_establish.endTime-i.connection_establish.startTime,request_queued:i.request_queued.endTime-i.request_queued.startTime,response_wait:i.response_wait.endTime-i.response_wait.startTime,response_download:i.response_download.endTime-i.response_download.startTime}}});for(const[a,{startTime:s,endTime:c}]of Object.entries(i))Wn().default.DO_NOT_USE_measureLegacy({metricName:`load_cached_page_chunk.fetch.${a}`,startTime:s,endTime:c},{environment:e,data:r})}),[e]);(0,o.useEffect)((()=>{const e=new PerformanceObserver((n=>{const o=n.getEntries().find((e=>e.name.includes(`${S().A.api.http}/${fo}`)&&!e.name.endsWith("s")));o&&("resource"===o.entryType&&t(o),null==e||e.disconnect())}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[t])}(),go(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const t=()=>vo().updateConnectionState(e);return t(),N().A.addListener(t),()=>{N().A.removeListener(t)}}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{e.defaultRecordCache.persistedRecordCache&&e.defaultRecordCache.persistedRecordCache.setEnvironment(e)}),[e])}(),function(){const e=(0,i().v3)(),t=(0,o.useRef)("none"),n=(0,o.useCallback)((e=>{const n=t.current;e!==n&&(t.current=e,"dragging"===e?no().A.setState({isDragging:!0}):"dragging"===n&&no().A.setState({isDragging:!1}))}),[]),r=(0,o.useCallback)((()=>{"none"===t.current&&n("touching")}),[n]),a=(0,o.useCallback)((()=>{n("none")}),[n]),s=(0,o.useCallback)((()=>{"touching"===t.current&&to().isExpanded(to().get())&&n("dragging")}),[n]);(0,o.useEffect)((()=>{if(e.device.isIOS)return window.addEventListener("touchstart",r),window.addEventListener("touchend",a),window.addEventListener("touchcancel",a),document.addEventListener("selectionchange",s),()=>{window.removeEventListener("touchstart",r),window.removeEventListener("touchend",a),window.removeEventListener("touchcancel",a),document.removeEventListener("selectionchange",s)}}),[e.device.isIOS,r,a,s]);const c=(0,o.useCallback)((()=>{jn().default.afterNextFlush((()=>{eo().clearSavedSelectionXPosition()}))}),[]),l=(0,o.useCallback)((()=>{setTimeout((()=>{to().get()||eo().clear({environment:e})}),0)}),[e]);(0,o.useEffect)((()=>(window.addEventListener("mousedown",c),e.device.isMobileBrowser&&document.addEventListener("focusout",l),()=>{window.removeEventListener("mousedown",c),document.removeEventListener("focusout",l)})),[e,c,l])}(),function(){const e=(0,E().O$)(ie().j),t=(0,C().X)("simulate_offline");(0,o.useEffect)((()=>{ae("simulate_offline_set_value_in_local_storage",(()=>{t&&void 0===e&&ie().j.setState({shouldSimulateOffline:!1,lastUpdatedTime:Date.now()})}))}),[t,e]);const n=(0,E().K8)((()=>{var e;return null===(e=ie().j.state)||void 0===e?void 0:e.shouldSimulateOffline}),[]),r=(0,K().ZC)(n);(0,o.useEffect)((()=>{ae("simulate_offline_update_electron_with_new_value",(async()=>{t&&void 0!==n&&("boolean"==typeof r&&n!==r||void 0===r&&!0===n)&&(n?await re().setNetworkEmulation({title:"Offline",requestsAllowed:"none"}):await re().setNetworkEmulation({title:"Online (No throttling)",requestsAllowed:"all",latency:0,downloadThroughput:-1,uploadThroughput:-1}))}))}),[t,n,r]),(0,o.useEffect)((()=>{}),[])}(),(0,P().o_)(),(0,W().Ay)(),te(),z(),function(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,o.useRef)(!1),r=(0,o.useCallback)((()=>{"system"===ge().lv(e)&&ve().A.emit()}),[e]),a=(0,E().K8)((()=>{var e;return null===(e=m().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.isReady()}),[]);(0,o.useLayoutEffect)((()=>{!n.current&&a&&(r(),n.current=!0)}),[a,r]),(0,o.useEffect)((()=>{if(t.isAndroid&&e.mobileNative)e.mobileNative.updateReceiveApiHandlers({themeChanged:e=>r()});else{if(oo.addEventListener&&oo.removeEventListener)return oo.addEventListener("change",r),()=>{oo.removeEventListener("change",r)};if(oo.addListener&&oo.removeListener)return oo.addListener(r),()=>{oo.removeListener(r)}}}),[t.isAndroid,e,r])}(),bo(),function(){const e=S().A.isLocalhost||!1;(0,o.useEffect)((()=>{function t(t){if(!e)return;if(!t.data||"string"!=typeof t.data.type)return;const n=t.data.type;"webpackInvalid"===n?R().D6({label:(0,q.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,q.jsx)("span",{style:{paddingRight:10},children:"Webpack Compiling"}),(0,q.jsx)(So().A,{size:"md",onDarkBackground:!0})]}),position:"top",durationMs:"keep"}):"webpackOk"!==n&&"webpackStillOk\t"!==n&&"webpackWarnings"!==n||R().N2()}return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}}),[e])}();const n=(0,ne().kg)();return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Mr,{}),t.device.isElectron&&(0,q.jsx)(Vr,{}),n&&(0,q.jsx)($r,{}),(0,q.jsx)(qr,{}),(0,q.jsx)(A,{}),(0,q.jsx)(T,{})]})}function qr(){const e=(0,_().y)(),t=(0,C().X)("offline_push_updates");return e&&t?(0,q.jsx)(Wr,{}):null}const zr=new(y().O2)("usePageSubscriptionManager",(()=>n.e(25556).then(n.bind(n,245549))));function Wr(){const{value:e}=(0,y().fJ)(zr);return e?(0,q.jsx)(Kr,{usePageSubscriptionManager:e.usePageSubscriptionManager}):null}function Kr(e){return e.usePageSubscriptionManager(),null}function Vr(){return mn(),null}function $r(){return(0,ne().a1)(),null}},529649:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(463830).A)},532688:(e,t,n)=>{n.d(t,{RK:()=>i,uC:()=>a});var o=()=>n(645873);const r={Toaster:new(o().O2)("Toaster",(()=>Promise.all([n.e(94476),n.e(47381)]).then(n.bind(n,94476)))),PerfmarkTrialIneligibleToast:new(o().O2)("PerfmarkTrialIneligibleToast",(()=>Promise.all([n.e(75134),n.e(58790)]).then(n.bind(n,585731))))},i=(0,o()._h)(r.Toaster,(e=>e.Toaster)),a=(0,o()._h)(r.PerfmarkTrialIneligibleToast,(e=>e.PerfmarkTrialIneligibleToast))},537972:(e,t,n)=>{n.d(t,{Ay:()=>u,Gf:()=>m});var o=n(296540),r=()=>n(484714),i=()=>n(847249),a=()=>n(449412),s=()=>n(344300),c=()=>n(670631),l=()=>n(722038);const d=(0,n(498212).Ay)();function u(){!function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,r().v3)();(0,o.useEffect)((()=>{e&&t&&(0,s().readAndCacheOfflinePagesMemo)({userId:t,persistedRecordCache:e,tellOtherTabsToUpdate:!1})}),[e,t])}(),function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,r().v3)();m((0,o.useCallback)((()=>{e&&t&&(0,s().readAndCacheOfflinePages)({userId:t,persistedRecordCache:e,tellOtherTabsToUpdate:!1})}),[e,t]))}(),function(){const e=(0,i().K8)((()=>c().A.state.shouldPublishUpdate),[]),t=function(){const e=p();return(0,o.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.postMessage({type:"update",tabId:d})}),[e])}();(0,o.useEffect)((()=>{e&&(t(),c().A.setState({...c().A.state,shouldPublishUpdate:!1}))}),[e,t])}()}function p(){const{currentUser:{id:e},device:t}=(0,r().v3)(),n=(0,l().y)(),i=t.isElectron,s=(0,o.useRef)(void 0);return(0,o.useEffect)((()=>{if(n&&i&&e)try{const t=new BroadcastChannel(`offlinePageUpdates-${e}`);return s.current=t,()=>{t.close(),s.current=void 0}}catch(t){a().Fg(t,{tags:{event:"useOfflinePageUpdatesChannel"}})}}),[n,i,e]),s}function m(e){const t=p();(0,o.useEffect)((()=>{const n=t.current;if(!n)return;const o=t=>{var n;"update"===(null===(n=t.data)||void 0===n?void 0:n.type)&&t.data.tabId!==d&&e()};return n.addEventListener("message",o),()=>{n.removeEventListener("message",o)}}),[t,e])}},574506:(e,t,n)=>{n.d(t,{t:()=>a});var o=()=>n(351360),r=()=>n(508496),i=()=>n(680074);function a(e){const{currentUserSettingsStore:t}=o().default.state;if(!t)return!1;const n=(0,i().iZ)(t);return!("number"==typeof n&&n>7)&&(!e.device.isMobile&&"on"===r().default.getEligibleGroup({experimentId:"slash_menu_tooltip",defaultGroup:"control"}))}},577009:(e,t,n)=>{n.d(t,{rU:()=>p,QB:()=>i,hR:()=>l,pT:()=>c,JN:()=>u,i8:()=>a,Wt:()=>d,Sx:()=>s});var o=()=>n(645873);const r=new(o().O2)("notifications",(()=>Promise.all([n.e(75134),n.e(43380),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(49889),n.e(97727),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(85515),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(60499),n.e(24593),n.e(89686),n.e(85314),n.e(23844),n.e(19632),n.e(6893)]).then(n.bind(n,241637)))),i=(0,o()._h)(r,(e=>e.GetNotifiedFor)),a=(0,o()._h)(r,(e=>e.TopbarUpdatesMenu)),s=(0,o()._h)(r,(e=>e.UpdateSidebar)),c=(0,o()._h)(r,(e=>e.MobileInboxPopup)),l=(0,o()._h)(r,(e=>e.InboxActionsMenu)),d=((0,o()._h)(r,(e=>e.InboxNotificationSettingsButton)),(0,o()._h)(r,(e=>e.UnreadMentionsBadge))),u=(0,o()._h)(r,(e=>e.NotificationInboxPanelContent)),p=(0,o()._h)(r,(e=>e.AnimatedEmojiBadge))},652393:(e,t,n)=>{n.r(t),n.d(t,{initialize:()=>s});var o=()=>n(857639),r=()=>n(780054),i=()=>n(508496),a=()=>n(161132);function s(e){"object"==typeof r().A&&r().A.version&&(o().clientLogglyEnvironmentData.version=r().A.version);const{device:t,currentUser:n}=e;t.isMobileNative&&(o().clientLogglyEnvironmentData.isMobileNative=!0),t.isMobile&&(o().clientLogglyEnvironmentData.isMobile=!0),t.isAndroid&&(o().clientLogglyEnvironmentData.isAndroid=!0),t.isIOS&&(o().clientLogglyEnvironmentData.isIOS=!0),t.isElectron&&(o().clientLogglyEnvironmentData.isElectron=!0),t.isChromeExtension&&(o().clientLogglyEnvironmentData.isChromeExtension=!0),o().clientLogglyEnvironmentData.os=t.os,o().clientLogglyEnvironmentData.platform=t.platform,window.navigator.userAgent&&(o().clientLogglyEnvironmentData.userAgent=window.navigator.userAgent),document.referrer&&(o().clientLogglyEnvironmentData.referrer=document.referrer),n.id&&(o().clientLogglyEnvironmentData.userId=n.id),o().clientLogglyEnvironmentData.is_experimental_build="clientExperimental"===r().A.buildTarget,o().clientLogglyEnvironmentData.experiments=i().default.getUsedNonControlExperimentsMap(),i().default.addListener((()=>{o().clientLogglyEnvironmentData.experiments=i().default.getUsedNonControlExperimentsMap()})),(0,a().xs)().then((e=>{e&&(o().clientLogglyEnvironmentData.storageUsageEstimate=e.usage,o().clientLogglyEnvironmentData.storageQuotaEstimate=e.quota)}))}},657924:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(296540),r=()=>n(38337),i=()=>n(753199),a=()=>n(313790),s=n(474848);function c(e){const{overlayContainerStore:t,zIndex:n}=e,c=(0,o.useCallback)((e=>{(t??a().A).containerDomNodeStore.setState(e)}),[t]);return(0,s.jsx)("div",{ref:c,className:`${r().MUV} ${r().H1c}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:n??999,pointerEvents:"none",overflow:"hidden"},onMouseMove:e=>{(0,i().SQ)({event:e,context:i().y$.SidebarMouseMove,callback:()=>{}})},children:(0,s.jsx)("div",{style:{position:"relative",zIndex:0}})})}},665579:(e,t,n)=>{n.d(t,{$E:()=>T,$L:()=>s,BZ:()=>d,EC:()=>f,EI:()=>y,E_:()=>x,Ed:()=>p,Fq:()=>h,Lu:()=>A,Mk:()=>m,O0:()=>C,UO:()=>_,V$:()=>k,VQ:()=>g,Xx:()=>w,Xy:()=>l,YS:()=>v,_g:()=>S,dd:()=>u,pW:()=>c,q3:()=>a,wH:()=>i});var o=()=>n(496603),r=()=>n(534177);const i=160,a=40,s=24,c=20,l=600,d=270,u=405,p=480,m=500,f=void 0,g=16,v=10,h=8,b=(n(69447).nh,{backdropFilter:"blur(48px)",WebkitBackdropFilter:"blur(48px)"}),S=4;function y(e){return{icon:e.mediumIconColor,text:e.text.secondary}}function w(e){return{width:48,height:48,fill:e.lightIconColor}}function A(e){let{theme:t,isPhone:n}=e;return n?t.personalHomeBackgroundPhone:t.surface.page}const I=1;function k(e){let{isPhone:t,theme:n}=e;return{zIndex:1,position:"relative",display:"flex",flexDirection:"column",borderRadius:12,background:n.home.tile.background,boxShadow:x({isPhone:t,theme:n}),...b}}function C(e){let{mode:t}=e;switch(t){case"dark":return 0;case"light":return I;default:return(0,r().ub)(t),0}}function x(e){let{isPhone:t,theme:n,borderOnly:r}=e;if("dark"===n.mode)return"unset";n.mode;const i=C({mode:n.mode});return(0,o().oE)([r||t?void 0:"0 12px 32px rgba(0, 0, 0, 0.02)",`0 0 0 ${i}px rgba(0, 0, 0, 0.05)`]).join(", ")}function T(e){return{display:"flex",flexDirection:"column",width:"100%",gap:24}}function _(e){const{isPhone:t,theme:n,borderOnly:o}=e;return{unhoveredBoxShadow:x({isPhone:t,theme:n,borderOnly:o}),hoveredBoxShadow:"light"===n.mode?["0 12px 32px rgba(0, 0, 0, 0.03)","0 0 0 1px rgba(0, 0, 0, 0.085)"].join(", "):n.homeShadow.card.hovered}}},669944:(e,t,n)=>{n.r(t),n.d(t,{default:()=>wo});var o=n(296540),r=()=>n(136590),i=()=>n(560198),a=()=>n(662303),s=()=>n(959013),c=(n(898992),n(354520),()=>n(591779)),l=()=>n(496603),d=()=>n(106959),u=n(474848);function p(e){const t=(0,o.useRef)(new Map),n=(0,o.useCallback)((()=>{const n=Array.from(t.current.values()).filter((e=>e.isSpawned)),o=n.length-e.maxPreferredIFrames;if(o<=0)return;const r=n.filter((e=>!e.isVisible));r.sort(((e,t)=>e.latestTimestamp-t.latestTimestamp));for(const e of r.slice(0,o))e.isSpawned=!1,e.onVisibilityChange(!1)}),[e.maxPreferredIFrames]),r=(0,o.useCallback)((e=>{for(const n of e){if(!(n.target instanceof HTMLElement))continue;const e=t.current.get(n.target);e&&(e.isVisible=n.isIntersecting,e.latestTimestamp=n.time,e.isVisible&&!e.isSpawned&&(e.isSpawned=!0,e.onVisibilityChange(!0)))}n()}),[n]),i=(0,o.useRef)(void 0!==window.IntersectionObserver?new IntersectionObserver(r):null);(0,o.useEffect)((()=>()=>{i.current&&(i.current.disconnect(),i.current=null)}),[]);const a=(0,c().ZC)(e.maxPreferredIFrames);(0,o.useEffect)((()=>{a&&e.maxPreferredIFrames<a&&n()}),[n,e.maxPreferredIFrames,a]);const s=(0,o.useMemo)((()=>({track:(e,n)=>{i.current?(t.current.set(e,{isVisible:!1,isSpawned:!1,latestTimestamp:0,onVisibilityChange:l().sg(n,50)}),i.current.observe(e)):d().mm.track(e,n)},untrack:e=>{i.current?(i.current.unobserve(e),t.current.delete(e)):d().mm.untrack(e)}})),[]);return(0,u.jsx)(d().jq.Provider,{value:s,children:e.children})}function m(e){let t=e.isMobile?10:50;return e.ramSizeInGB&&(t=Math.floor(2*e.ramSizeInGB)),{maxPreferredIFrames:t}}var f=()=>n(17022),g=()=>n(484714),v=()=>n(785082),h=()=>n(745875),b=()=>n(780054),S=()=>n(989423),y=()=>n(508496);function w(){return 1}function A(e){let{id:t,targetRenderPhase:n="all",samplePercent:r=w(),children:i}=e;const a=(0,g().v3)(),s=(0,o.useCallback)(((e,t,o,i,s,c)=>{(0,h().rQ)(r)&&("all"!==n&&t!==n||S().vd(a,`${v().PX}.${e}`,{time:o,render_phase:t}))}),[a,n,r]),[c]=(0,o.useState)(f().A.withListenerIgnored((()=>y().default.checkGate({gateName:"client-performance-profiler"}))));return c?(0,u.jsx)(o.Profiler,{id:t,onRender:s,children:i}):(0,u.jsx)(u.Fragment,{children:i})}var I=()=>n(958637),k=()=>n(112995),C=()=>n(186445),x=()=>n(346);function T(){return(0,x().kg)()?(0,u.jsx)(x().MG,{}):null}var _=()=>n(852507),P=()=>n(799954),E=()=>n(987264),U=()=>n(100622),L=()=>n(705540),M=()=>n(435009),R=()=>n(994877),j=()=>n(864943),N=()=>n(204063),B=()=>n(719147),D=()=>n(21140),O=()=>n(674276),q=()=>n(763071);function z(e){var t;let{clearErrorState:n,error:o,errorId:r}=e;const i=(0,g().v3)();(0,_().w)((()=>{L().navigationReady(!1)}));const a=()=>{R().SI({environment:i,from:"page_error"})};return(0,u.jsxs)("div",{style:W,children:[(0,E().s)({width:42,height:42}),(0,u.jsxs)("div",{style:K,children:[(0,u.jsx)("div",{children:(0,u.jsx)(s().sA,{defaultMessage:"Oops! Something went wrong.",id:"router.renderErrorPage.message.part1"})}),(0,u.jsx)("div",{children:(0,u.jsx)(s().sA,{defaultMessage:"Please refresh and try again or <textlink>message support</textlink>.",id:"router.renderErrorPage.message.part2",values:{textlink:e=>(0,u.jsx)(B().A,{onClick:a,children:e})}})}),r&&(0,u.jsx)("div",{style:V,children:(0,u.jsx)(O().b,{error:o,errorId:r,enablePopup:(0,q().o)(r)})})]}),(0,u.jsxs)(D().Ye,{gap:8,children:[null!==(t=i.currentUser)&&void 0!==t&&t.isLoggedIn()?(0,u.jsx)(j().A,{size:"lg",onClick:()=>{M().oo({environment:i,url:"/home",callback:n})},focused:!0,children:(0,u.jsx)(s().sA,{id:"router.renderErrorPage.homeButton.label",defaultMessage:"Back to my content"})}):null,(0,u.jsx)(N().A,{size:"lg",onClick:()=>window.location.reload(),children:(0,u.jsx)(s().sA,{defaultMessage:"Refresh",id:"router.renderErrorPage.reloadButton.label"})})]})]})}const W={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:100,...(0,P().xH)(a().locale)},K={fontSize:14,textAlign:"center",marginTop:6,marginBottom:12,color:U().Ay.uiGray},V={fontSize:10,marginTop:8};var $=()=>n(847249),F=()=>n(401497),G=(n(944114),n(803949),n(581454),()=>n(284371)),H=()=>n(901389),J=()=>n(597368),Z=()=>n(364280),X=()=>n(939740),Y=()=>n(676007),Q=()=>n(505108),ee=()=>n(132389);function te(e){let{items:t,selectType:n,selectAlignXAxis:o,selectedKeys:r,setSelectedKeys:i}=e;const a=t.map(((e,a)=>{const s=e.key;return(0,u.jsx)(ne,{text:e.text,description:e.description,selected:r[s]??!1,isBelowButtons:Boolean(e.showBelowButtons),isLastItem:a===t.length-1,onSelect:t=>{var o;null===(o=e.onSelect)||void 0===o||o.call(e,t),i("radio"===n?t=>{const n={...t};return Object.keys(n).forEach((t=>{n[t]=t===e.key})),n}:e=>({...e,[s]:t}))},selectType:n,selectAlignXAxis:o},s)}));return(0,u.jsxs)(Z().VP,{children:[(0,u.jsx)(ee().A,{size:5}),a]})}function ne(e){let{text:t,description:n,selected:r,onSelect:i,isBelowButtons:a,selectType:s="checkbox",selectAlignXAxis:c,isLastItem:l}=e;const d=(0,o.useCallback)((()=>{"radio"===s?null==i||i(!0):null==i||i(!r)}),[s,i,r]);return(0,u.jsx)(Q().a,{label:t,description:n,isSelected:r,value:"select_item",width:a?"hug":"fill",colorName:a?"secondary":"primary",style:{marginBottom:l?0:12,...a?{justifyContent:"center",border:"none"}:{}},selectType:s,selectAlignXAxis:c,onChange:d})}const oe=function(){const e=(0,o.useId)(),t=(0,o.useId)(),{open:r,innerStyle:i,keepFocus:a,mode:c,message:d,debugInfo:p,description:m,items:f,selectionItems:g,showCancel:v,showCloseButton:h,renderDraftCommentIcon:S,icon:y,allowCopy:w,selectType:A,selectAlignXAxis:I}=(0,$().K8)((()=>{const{open:e,innerStyle:t,keepFocus:n,mode:o,message:r,debugInfo:i,description:a,items:s,selectionItems:c,showCancel:l,showCloseButton:d,shouldRenderDraftCommentIcon:u,icon:p,allowCopy:m,selectType:f,selectAlignXAxis:g}=J().A.state;return{open:e,innerStyle:t,keepFocus:n,mode:o,message:r,debugInfo:i,description:a,items:s,selectionItems:c,showCancel:l,showCloseButton:d,renderDraftCommentIcon:u,icon:p,allowCopy:m,selectType:f,selectAlignXAxis:g}}),[]),k=(0,o.useCallback)((()=>{H().zw();const{handleCancel:e}=J().A.state;return e&&e(),!1}),[]),C=(0,o.useCallback)((()=>{const{disableBackgroundDismiss:e}=J().A.state;e||k()}),[k]),x=(0,F().IS)((e=>{const t={width:"100%",marginTop:8};return{plainButton:{...t,marginBottom:"-12px",justifyContent:"center",borderRadius:6},button:{...t,borderRadius:6},description:{color:e.text.secondary,paddingTop:6,paddingBottom:6,textWrap:"pretty"},debugMessage:{paddingTop:10,fontSize:12,color:e.text.tertiary,textAlign:m?"unset":"center"},overflowWrap:{overflowWrap:"break-word"},modal:{overflow:"hidden",width:"wide"===c?406:324,marginLeft:24,marginRight:24,padding:20,boxShadow:e.shadowLG,background:e.modalBackground,borderRadius:12,fontSize:16,alignItems:"center",justifyContents:"center",...i},message:{textAlign:m?"unset":"center",fontWeight:G().Wy.semibold,textWrap:"pretty"},iconContainer:{width:"100%",display:"flex",justifyContent:"center",marginBottom:10,fill:e.mediumIconColor},buttonContainer:{paddingBottom:0}}}),[m,i,c]),[T,_]=(0,o.useState)({});(0,o.useEffect)((()=>{const e={};null==g||g.forEach((t=>{e[t.key]=t.preSelected??!1})),_(e)}),[g]);const P=(0,o.useCallback)((()=>{const o=f.map(((e,t)=>({key:t,render:t=>"plain"===e.buttonType?(0,u.jsx)(n(493823).p,{size:"lg",hovered:t.focused,isRed:"red"===e.color,isBlue:"blue"===e.color,isGray:"gray"===e.color,style:x.plainButton,className:e.className,...t,children:e.label||"Label"}):"solid"===e.buttonType?"gray"===e.color?(0,u.jsx)(n(843189).E,{size:"lg",hovered:t.focused,style:x.button,className:e.className,...t,children:e.label||"Label"}):(0,u.jsx)(N().A,{size:"lg",hovered:t.focused,style:x.button,className:e.className,isRed:"red"===e.color,...t,children:e.label||"Label"}):(0,u.jsx)(j().A,{hovered:t.focused,style:x.button,size:e.isSmall?"sm":"lg",color:"red"===e.color?"uiRed":"blue"===e.color?"uiBlue":void 0,className:e.className,...t,children:e.label||"Label"}),action:()=>{e.onAccept&&(e.onAccept(g?T:void 0),H().zw())}})));v&&o.push({key:"cancel",render:e=>(0,u.jsx)(j().A,{size:"lg",hovered:e.focused,style:x.button,...e,children:(0,u.jsx)(s().sA,{id:"genericDialogModal.cancelButton.label",defaultMessage:"Cancel"})}),action:()=>{k()}});const r=(null==g?void 0:g.filter((e=>!e.showBelowButtons)))??[],i=r.length>0?(0,u.jsx)(te,{items:r,selectType:A,selectAlignXAxis:I,selectedKeys:T,setSelectedKeys:_}):void 0,a=(null==g?void 0:g.filter((e=>e.showBelowButtons)))??[],c=a.length>0?(0,u.jsx)(te,{items:a,selectType:A,selectAlignXAxis:I,selectedKeys:T,setSelectedKeys:_}):void 0;let P;return p&&(null!=p&&p.messagePrefix?P=`${p.messagePrefix}: ${p.message}`:b().A.isAdminMode&&(P=(0,u.jsx)(s().sA,{id:"dialogRenderer.debugMessage.messagePrefix",defaultMessage:"Debug message: {message}",values:{message:p.message}}))),(0,u.jsx)(n(700180).A,{capture:!0,preventType:n(756279).A.All,children:(0,u.jsxs)("div",{style:x.overflowWrap,children:[h&&(0,u.jsx)(n(313633).A,{onClick:C}),S&&(0,u.jsx)(n(359848).h,{}),y&&(0,u.jsx)("div",{style:x.iconContainer,children:y}),w&&(0,u.jsx)(n(527606).k,{enable:!0,shortcuts:{copy:l().D_},debugName:"DialogRenderer.allowCopy"}),d&&(0,u.jsx)("div",{style:x.message,id:e,children:d}),P&&(0,u.jsx)("div",{style:x.debugMessage,children:P}),m&&(0,u.jsx)("div",{style:x.description,id:t,children:m}),i&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(ee().A,{size:20}),i,(0,u.jsx)(ee().A,{size:8})]}),(0,u.jsx)(X().Ay,{type:X().Oh.Vertical,priority:1,initialFocus:0,sections:[{key:"dialog",render:e=>(0,u.jsx)(n(89924).A,{topBorder:!1,disableMobileBorders:!0,style:x.buttonContainer,...e}),items:o}]}),c&&(0,u.jsx)(u.Fragment,{children:c})]})})}),[f,v,g,A,I,T,p,x.overflowWrap,x.iconContainer,x.message,x.debugMessage,x.description,x.plainButton,x.button,x.buttonContainer,h,C,S,y,w,d,e,m,t,k]);return(0,u.jsx)(Y().A,{ariaLabelledBy:e,ariaDescribedBy:t,open:r,keepFocus:a,overlayZIndex:9999999,onDismiss:C,preventHideChildrenWhileOpening:!0,innerStyle:x.modal,render:P})};var re=()=>n(657924),ie=()=>n(575650),ae=()=>n(991699),se=()=>n(545206),ce=()=>n(331542);const le=function(){const e=(0,$().O$)(ae().A);return(0,u.jsx)(Y().A,{open:e.open,render:()=>(0,u.jsx)(pe,{}),overlayZIndex:9999})};function de(e){return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:180,padding:"18px 24px 20px",textAlign:"center",maxWidth:e.device.isMobile?"300px":"100%"}}function ue(e){return{display:"flex",alignItems:"center",fontSize:14,color:e.text.secondary}}function pe(){const e=(0,F().DP)(),t=(0,g().v3)(),n=(0,$().O$)(ae().A),{targetRecordId:o}=n,r=(0,$().K8)((()=>function(e){return void 0!==e&&Boolean(se().A.state[e])}(o)),[o]);return n.open?(0,u.jsxs)("div",{style:de(t),children:[(0,u.jsxs)("div",{style:ue(e),children:[n.message,(0,u.jsx)(ce().A,{style:{marginLeft:6}})]}),r&&o&&(0,u.jsx)(ie().A,{targetRecordId:o,style:{marginTop:10}})]}):null}var me=()=>n(49210),fe=()=>n(38337),ge=()=>n(567121),ve=()=>n(948914),he=()=>n(100584),be=()=>n(851650),Se=()=>n(661179);function ye(){const e=(0,o.useRef)(null),t=(0,F().DP)().mode,n=(0,F().IS)((()=>({container:{display:"block",position:"fixed",visibility:"hidden",overflowY:"scroll",width:20,height:20}})),[]);return(0,o.useEffect)((()=>{const n=e.current;if(!n)return;const o=new ResizeObserver((e=>{const[n]=e,o=20-n.contentRect.width;o!==Se().A.state&&(Se().A.setState(o),be().u7(t))}));return o.observe(n),()=>{o.unobserve(n)}}),[t]),(0,u.jsx)("div",{style:n.container,ref:e})}function we(e){let{children:t}=e;const n=(0,g().v3)(),r=(0,F().DP)();(0,o.useEffect)((()=>{const{mobileNative:e}=n;null==e||e.markTransitionReady({type:"mount"})}),[n]);const i="light"===r.mode?fe().fRh:fe().Rsl,s=(0,x().kg)(),c=(0,x().n_)(),l=(0,x().lC)(),d=(0,$().K8)((()=>{var e;return Boolean(null===(e=ve().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)}),[]),p={inert:(0,$().K8)((()=>!n.device.isMobile&&he().A.state.openModals.size>0),[n])?"true":null},m=(0,F().IS)((e=>({root:{...(0,P().xH)(a().locale),color:e.text.primary,WebkitFontSmoothing:"auto",backgroundColor:d?"rgba(0, 0, 0, 0)":e.contentBackground,transition:"height 0.1s ease",...s&&c&&l&&{height:`calc(100% - ${ge().ls}px)`}},content:{height:"100%"}})),[s,c,l,d]);return(0,u.jsxs)("div",{style:m.root,className:["notion-app-inner",i].join(" "),children:[(0,u.jsx)("div",{style:m.content,...p,children:t}),(0,u.jsx)(re().A,{}),(0,u.jsx)(oe,{}),(0,u.jsx)(le,{}),(0,u.jsx)(me().b,{}),(0,u.jsx)(ye,{})]})}var Ae=()=>n(518627),Ie=()=>n(554279),ke=()=>n(172385),Ce=()=>n(590265),xe=()=>n(861017),Te=()=>n(427704),_e=()=>n(854150),Pe=()=>n(677338),Ee=()=>n(734459),Ue=()=>n(183558),Le=()=>n(502492),Me=()=>n(939768),Re=()=>n(946141),je=()=>n(915086),Ne=()=>n(209660),Be=()=>n(5705),De=()=>n(836285),Oe=()=>n(151779),qe=()=>n(942906),ze=()=>n(840153),We=()=>n(755199),Ke=()=>n(555267),Ve=()=>n(534177),$e=()=>n(449506);var Fe=()=>n(296798);const Ge=function(e){const t=(0,F().DP)(),o={width:42,height:42,flexShrink:0,flexGrow:0};return(0,u.jsxs)("div",{style:{width:"100vw",height:"90vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[(0,u.jsx)(Fe().A,{href:Te().JZ.root,innerStyle:{padding:8,borderRadius:4,marginBottom:2},children:"light"===t.mode?(0,n(426388).S)(o):(0,n(517592).A)(o)}),(0,u.jsx)("div",{style:{maxWidth:320,paddingLeft:18,paddingRight:18},children:e.children})]})};function He(e){let{payload:t}=e;const n=(0,g().v3)(),[r,i]=(0,o.useState)(t?{type:"unconfirmed"}:{type:"error"}),a=(0,o.useCallback)((async()=>{if(!t)return void i({type:"error"});i({type:"loading"});const e=await async function(e){let{environment:t,payload:n}=e;const o=await $e().callApi({eventName:"unsubscribeFromEmails",environment:t,data:{payload:n}});return"success"===o.type?{type:"success",spaceName:o.data.spaceName}:{type:"error"}}({environment:n,payload:t});i("error"===e.type?{type:"error"}:{type:"confirmed",spaceName:e.spaceName})}),[n,t]),c=(0,F().IS)((()=>({confirmUnsubscribeDescription:{marginBottom:10}})),[]);switch(r.type){case"loading":return(0,u.jsx)(Ge,{children:(0,u.jsx)(s().sA,{defaultMessage:"Loading…",id:"confirmUnsubscribePage.loadingMessage"})});case"unconfirmed":return(0,u.jsxs)(Ge,{children:[(0,u.jsx)("div",{style:c.confirmUnsubscribeDescription,children:(0,u.jsx)(s().sA,{defaultMessage:"Are you sure you want to unsubscribe from this list?",id:"unsubscribeFromEmails.workspace.confirmUnsubscribeDescription"})}),(0,u.jsx)(N().A,{size:"lg",onClick:a,analyticsName:"unsubscribe_confirm",children:(0,u.jsx)(s().sA,{id:"confirmUnsubscribePage.confirmButton",defaultMessage:"Unsubscribe"})})]});case"confirmed":return(0,u.jsx)(Ge,{children:(0,u.jsx)(s().sA,{defaultMessage:"You have successfully unsubscribed from emails for {workspaceName}",values:{workspaceName:(0,u.jsx)("b",{children:r.spaceName})},id:"unsubscribeFromEmails.workspace.message"})});case"error":return(0,u.jsx)(Ge,{children:(0,u.jsx)(s().sA,{id:"confirmUnsubscribePage.errorMessage",defaultMessage:"Could not unsubscribe."})});default:(0,Ve().HB)(r)}}var Je=()=>n(645873);const Ze=new(Je().O2)("desktopEmailConfirmPage",(()=>n.e(32568).then(n.bind(n,822821)))),Xe=(0,Je()._h)(Ze,(e=>e.default));var Ye=()=>n(236005),Qe=()=>n(969339),et=()=>n(404482);function tt(e){const{preventFrontRedirect:t}=e,n=(0,g().v3)(),{pathname:o,search:r,hash:i}=window.location;if(!t&&(0,et().D8)(n,o)){const e=r.length>0?`${r}&${Ye().Kr}=1`:`?${Ye().Kr}=1`;return window.location.href=o+e+i,null}return(0,u.jsx)(Qe().C6,{isSignup:!n.currentUser.isLoggedIn()})}var nt=()=>n(437768);const ot=function(e){const t={position:"absolute",top:0,left:0,bottom:0,right:0};return(0,g().v3)().currentUser.isLoggedIn()?(0,u.jsx)("div",{style:t,children:(0,u.jsx)(n(378765).A,{style:{width:"100%",height:"100%"},legacySpinnerSize:nt().Kh,showSpinnerTimeout:500})}):null};var rt=()=>n(688149);const it=function(e){let{redirect:t,callbackType:n}=e;const r=(0,F().DP)(),i=(0,g().v3)();return(0,o.useEffect)((()=>{at({redirect:t,environment:i,callbackType:n})}),[i,t,n]),(0,u.jsxs)(Ge,{children:[(0,u.jsx)("div",{style:{color:r.text.primary},children:"nativemailredirect"===n?(0,u.jsx)(s().sA,{id:"webApp.redirectingToMailDesktop.message",defaultMessage:"Redirecting to your Notion Mail app…"}):"nativecalendarredirect"===n?(0,u.jsx)(s().sA,{id:"webApp.redirectingToCalendarDesktop.message",defaultMessage:"Redirecting to your Notion Calendar app…"}):(0,u.jsx)(s().sA,{defaultMessage:"Redirecting to your Notion app…",id:"webApp.redirectingToDesktop.message"})}),(0,u.jsx)(Fe().A,{onClick:()=>at({redirect:t,environment:i,callbackType:n}),style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:r.text.tertiary},children:(0,u.jsx)(s().sA,{defaultMessage:"If you weren't redirected, click here.",id:"webApp.redirectingToDesktop.directLink.message"})}),(0,u.jsx)(Fe().A,{href:t,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:U().Ay.uiGray},children:(0,u.jsx)(s().sA,{defaultMessage:"Or, continue in your browser",id:"webApp.redirectingToDesktop.continueInBrowser.message"})})]})};function at(e){let{redirect:t,environment:n,callbackType:o}=e;M().eG({url:t,environment:n,callbackType:o})}var st=()=>n(433052),ct=()=>n(755636);function lt(){const e=(0,g().v3)();return(0,_().l)((()=>{const t=Le().kb({schemeUrl:window.location.href,baseUrl:b().A.domainBaseUrl});ct().f({environment:e,url:t}),st().Aj(),M().oo({environment:e,url:Te().JZ.root,redirect:!0})})),null}var dt=()=>n(903659),ut=()=>n(696746),pt=()=>n(665579),mt=()=>n(351360);function ft(e){let{children:t}=e;const n=(0,g().v3)(),o=(0,F().DP)(),r=(0,$().K8)((()=>{var e;const{mainEditorCurrentBlockStore:t}=mt().default.state,r=(0,ut().lU)(t),i=n.device.isPhone;return{width:"100vw",height:"100%",position:"relative",display:"flex",flex:1,background:Boolean(null===(e=ve().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)?"rgba(0, 0, 0, 0)":r?(0,pt().Lu)({theme:o,isPhone:i}):o.contentBackground}}),[n,o]);return(0,u.jsx)(dt().A,{style:r,children:t})}var gt=()=>n(253849),vt=()=>n(901459);function ht(){const e=(0,g().v3)(),t=(0,$().K8)((()=>C().Qr(e)),[e]),n=(0,$().K8)((()=>C().X4(e).shouldShowError),[e]),o=(0,$().O$)(mt().default),r=C().tR(e);return(0,u.jsxs)(ft,{children:[t&&!n&&r&&(0,u.jsx)(vt().Z,{parentStore:t,quickSearchMode:!0}),"rendered"===o.renderPhase&&(0,u.jsx)(gt().S,{})]})}const bt=new(Je().O2)("CreatorProfile",(()=>Promise.all([n.e(75134),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(42838),n.e(27634),n.e(74728),n.e(78205),n.e(49353),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(17989),n.e(90625),n.e(59794),n.e(26483),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(48199),n.e(67183),n.e(71923),n.e(88372),n.e(40200)]).then(n.bind(n,850869)))),St=(0,Je()._h)(bt,(e=>e.CreatorProfile)),yt={CreatorProgram:new(Je().O2)("CreatorProgram",(()=>Promise.all([n.e(34709),n.e(58251)]).then(n.bind(n,115147))))},wt=(0,Je()._h)(yt.CreatorProgram,(e=>e.CreatorProgram)),At=new(Je().O2)("BlankPage",(async()=>Promise.all([n.e(44711),n.e(35837),n.e(23063),n.e(44763),n.e(25049),n.e(30873),n.e(88060),n.e(51702)]).then(n.bind(n,265134)))),It=(0,Je()._h)(At,(e=>e.BlankPage));var kt=()=>n(10289);const Ct=new(Je().O2)("Onboarding",(async()=>Promise.all([n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(53321),n.e(58550),n.e(22900),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(85515),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(87598),n.e(86787),n.e(45016)]).then(n.bind(n,220082)))),xt=(0,Je()._h)(Ct,(e=>e.Onboarding)),Tt=new(Je().O2)("settingsConsole",(async()=>await Promise.all([n.e(75134),n.e(96346),n.e(16471),n.e(58550),n.e(90825),n.e(49889),n.e(97727),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(41870),n.e(42120),n.e(4422),n.e(28866),n.e(21194),n.e(59794),n.e(52393),n.e(75601),n.e(11341),n.e(26090),n.e(26199),n.e(18057),n.e(56264),n.e(55927),n.e(3965),n.e(84341),n.e(80533),n.e(44763),n.e(67183),n.e(82720),n.e(19596)]).then(n.bind(n,506005)))),_t=(0,Je()._h)(Tt,(e=>e.OrganizationSettingsConsole));var Pt=()=>n(682497);const Et=new(Je().O2)("githubStudentPack",(()=>Promise.all([n.e(34709),n.e(54564)]).then(n.bind(n,875519)))),Ut=(0,Je()._h)(Et,(e=>e.default));var Lt=()=>n(477293);const Mt=new(Je().O2)("LocalizedTemplates",(async()=>{const{default:e}=await Promise.all([n.e(96346),n.e(58550),n.e(37353),n.e(74728),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(28271),n.e(97308),n.e(27991),n.e(72597),n.e(71923),n.e(69803),n.e(79239)]).then(n.bind(n,881532));return{LocalizedTemplates:e}})),Rt=(0,Je()._h)(Mt,(e=>e.LocalizedTemplates)),jt={AddAnotherAccountLoginPage:new(Je().O2)("AddAnotherAccountLoginPage",(async()=>await Promise.all([n.e(44711),n.e(35837),n.e(23063),n.e(25049),n.e(30873),n.e(20488)]).then(n.bind(n,918481))))},Nt=(0,Je()._h)(jt.AddAnotherAccountLoginPage,(e=>e.default));var Bt=()=>n(447934),Dt=()=>n(171510);const Ot=new(Je().O2)("StartupsApplication",(async()=>Promise.all([n.e(34709),n.e(47057)]).then(n.bind(n,346780)))),qt=(0,Je()._h)(Ot,(e=>e.default)),zt={LennyApplication:new(Je().O2)("LennyApplication",(()=>Promise.all([n.e(34709),n.e(86279)]).then(n.bind(n,254612))))},Wt=(0,Je()._h)(zt.LennyApplication,(e=>e.LennyApplication));var Kt=()=>n(630116);const Vt=new(Je().O2)("StudentGroupSignup",(async()=>Promise.all([n.e(34709),n.e(84969)]).then(n.bind(n,544719)))),$t=(0,Je()._h)(Vt,(e=>e.default));var Ft=()=>n(350648),Gt=()=>n(802790),Ht=()=>n(125565),Jt=()=>n(898808);const Zt=function(e){const{teamStore:t}=e,n=(0,g().v3)(),{teamName:o}=(0,$().K8)((()=>({teamName:t.getName()})),[t]),r=(0,F().IS)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:G().Wy.semibold,fontSize:20,margin:10},subtitle:{color:e.text.secondary,fontSize:18,padding:12},divider:{maxWidth:280},rightButton:{fontWeight:G().Wy.semibold,marginLeft:10}})),[]);return(0,u.jsxs)("div",{style:r.container,children:[(0,u.jsx)(Jt().x,{store:t,disabled:!0,size:55}),(0,u.jsx)("div",{style:r.title,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.page.title",defaultMessage:"You've been invited to join {teamName}",values:{teamName:o}})}),(0,u.jsx)("div",{style:r.subtitle,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.page.subtitle",defaultMessage:"You can access the content in the teamspace if you join the teamspace."})}),(0,u.jsxs)("div",{style:r.buttonContainer,children:[(0,u.jsx)(N().A,{size:"lg",onClick:async()=>{const e=n.currentUser.id;if(!e)return;const o={type:"member",entity_type:"user",user_id:e};await Ft().e2({environment:n,userId:e,teamStore:t,user:o}),Re().pi(n,{store:t,selection:"yes"})},children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.joinTeam.label",defaultMessage:"Join teamspace"})}),(0,u.jsx)(j().A,{size:"lg",style:r.rightButton,onClick:async()=>{Re().pi(n,{store:t,selection:"no"}),await Ft().YT({environment:n})},children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,u.jsx)(Gt().A,{size:48,innerStyle:r.divider}),(0,u.jsx)(Ht().A,{isSmall:!0,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkJoinPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})};function Xt(e){const{teamStore:t,teamName:n,onRequestClick:o}=e,r=(0,g().v3)(),i=(0,F().IS)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:G().Wy.semibold,fontSize:20,margin:10},subtitle:{color:e.text.secondary,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:G().Wy.semibold,marginLeft:10}})),[]);return(0,u.jsxs)("div",{style:i.container,children:[(0,u.jsx)(Jt().x,{store:t,disabled:!0,size:55}),(0,u.jsx)("div",{style:i.title,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.title",defaultMessage:"Request access to {teamName}",values:{teamName:n??Yt()}})}),(0,u.jsx)("div",{style:i.subtitle,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.subtitle",defaultMessage:"You can access this teamspace if a teamspace owner approves your request."})}),(0,u.jsxs)("div",{style:i.buttonContainer,children:[(0,u.jsx)(N().A,{size:"lg",onClick:o,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.label",defaultMessage:"Request access"})}),(0,u.jsx)(j().A,{size:"lg",style:i.rightButton,onClick:async()=>{await Ft().YT({environment:r})},children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,u.jsx)(Gt().A,{size:48,innerStyle:i.divider}),(0,u.jsx)(Ht().A,{isSmall:!0,children:(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})}function Yt(){return(0,u.jsx)(s().sA,{id:"teamInviteLinkRequestPage.privateTeamspace.label",defaultMessage:"Private Teamspace"})}const Qt=function(e){const{teamStore:t}=e,[r,i]=(0,o.useState)(!1),{teamName:a}=(0,$().K8)((()=>({teamName:t.getName()})),[t]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Xt,{teamStore:t,teamName:a,onRequestClick:()=>i(!0)}),(0,u.jsx)(n(149257).A,{teamStore:t,teamName:a??Yt(),teamId:t.id,isModalOpen:r,onDismiss:()=>i(!1)})]})};function en(e){const{teamAccessLevel:t,teamStore:n}=e;switch(t){case"open":return(0,u.jsx)(Zt,{teamStore:n});case"closed":case"private":return(0,u.jsx)(Qt,{teamStore:n})}}const tn=function(e){const{teamId:t}=e,r=(0,g().v3)(),i=(0,$().K8)((()=>new(Kt().h4)(r,{table:_e().yK,id:t})),[r,t]),[{value:a}]=(0,n(187174).Yb)((async()=>await Ft().D2({environment:r,teamId:t})),[r,t]);(0,o.useEffect)((()=>{!0===(null==a?void 0:a.isValidTeamRequest)&&null!=a&&a.isTeamMember&&(async()=>{var e;const t=null===(e=r.currentUser)||void 0===e?void 0:e.id;t&&i&&await Ft().g({environment:r,userId:t,teamStore:i})})()}),[r,i,a]);const s=(0,F().IS)((()=>({container:{display:"flex",justifyContent:"center",height:"100%"}})),[]);return a?(0,u.jsx)("div",{style:s.container,children:a.isValidTeamRequest?(0,u.jsx)(en,{teamStore:i,teamAccessLevel:a.teamAccessLevel}):"nonSpaceMember"===a.invalidRequestReason?(0,u.jsx)(Pt().o,{route:{name:"teamsInvite",teamId:t},publicPageData:void 0}):(0,u.jsx)(Pt().o,{route:{name:"notFound"},publicPageData:void 0})}):null};var nn=()=>n(662453),on=()=>n(650829);const rn={chatSidebar:new(Je().O2)("chatSidebar",(()=>Promise.all([n.e(96346),n.e(55373),n.e(36192),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(31611),n.e(2703)]).then(n.bind(n,942646)))),chatSidebarActions:new(Je().O2)("chatSidebarActions",(async()=>await n.e(87196).then(n.bind(n,118078)))),chatSidebarHelpers:new(Je().O2)("chatSidebarHelpers",(async()=>await Promise.resolve().then(n.bind(n,890754))))},an=(0,Je()._h)(rn.chatSidebar,(e=>e.ChatSidebar));var sn=()=>n(762014);function cn(e){return(0,u.jsx)("div",{id:"test-customer-io",style:{width:334,height:200,position:"absolute",bottom:64,right:21,zIndex:1,display:e?void 0:"none"}})}const ln=function(){const e=(0,g().v3)(),{currentUser:t}=e,n=(0,$().K8)((()=>t.isLoggedIn()),[t]),r=(0,$().K8)((()=>mt().default.state.inAppCalloutStore),[]),i=(0,$().K8)((()=>"dark"!==e.ThemeStore.state.mode),[e]);(0,o.useEffect)((()=>{n&&(r.getCalloutVisibility("customer_io").canShow?i?sn().A.state.suppressReason===sn().e.IN_APP_CALLOUT_CONFLICT?sn().A.setState({...sn().A.state,isVisible:!0,suppressReason:void 0}):sn().A.setState({...sn().A.state,suppressReason:void 0}):sn().A.setState({isVisible:!1,suppressReason:sn().e.DARK_MODE}):sn().A.setState({isVisible:!1,suppressReason:sn().e.IN_APP_CALLOUT_CONFLICT}))}),[r,n,i]);const a=(0,$().K8)((()=>sn().A.state.isVisible&&r.getCalloutVisibility("customer_io").canShow),[r]);return(0,o.useEffect)((()=>{if(a)return r.updateCalloutStatus({calloutId:"customer_io",visible:!0}),()=>{r.updateCalloutStatus({calloutId:"customer_io",visible:!1})}}),[r,a]),n?cn(!!a):null};var dn=()=>n(309770),un=()=>n(953006);const pn=(0,s().YK)({pressSlashHeader:{id:"EducationTooltips.pressSlash.header",defaultMessage:"Press {slashkey} for commands"}});function mn(e){return(0,u.jsx)("div",{style:{background:U().Ay.whiteWithAlpha(.1),padding:3,paddingRight:8,paddingLeft:8,marginRight:6,marginLeft:6,borderRadius:4},children:e.char})}function fn(){const e=(0,g().v3)(),t=dn().U();return(0,$().K8)((()=>{const{currentUserSettingsStore:e}=mt().default.state;var t;return!e||!e.isReady()||Boolean(null===(t=e.getSettings())||void 0===t?void 0:t.pressed_slash_tooltip)}),[])||e.device.isMobile||!t?null:(0,u.jsx)(un().k,{hideCloseButton:!0,origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,u.jsx)(s().sA,{...pn.pressSlashHeader,values:{slashkey:(0,u.jsx)(mn,{char:"/"})}}),content:null,onCloseClick:()=>dn().P(e)})}const gn=new(Je().O2)("InPageFind",(async()=>Promise.all([n.e(75134),n.e(28958)]).then(n.bind(n,452148)))),vn=(0,Je()._h)(gn,(e=>e.InPageFind));const hn=new(Je().O2)("ForkPageModalWrapper",(async()=>await Promise.all([n.e(95794),n.e(28271),n.e(27761)]).then(n.bind(n,325435)))),bn=(0,Je()._h)(hn,(e=>e.ForkPageModalWrapper)),Sn=new(Je().O2)("SecondarySidebar",(async()=>await Promise.all([n.e(75134),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(17989),n.e(90625),n.e(59794),n.e(26483),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(48199),n.e(33194),n.e(85314),n.e(19632),n.e(95281)]).then(n.bind(n,918048)))),yn=(0,Je()._h)(Sn,(e=>e.SecondarySidebar)),wn=new(Je().O2)("SpaceSettings",(async()=>Promise.all([n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(3965),n.e(84341),n.e(80533),n.e(45620),n.e(58221),n.e(44763),n.e(8081),n.e(67183),n.e(64598),n.e(82720),n.e(4253),n.e(86787),n.e(77465),n.e(24593),n.e(80896),n.e(1440),n.e(67378),n.e(58504),n.e(97308),n.e(63996),n.e(20636),n.e(66268),n.e(55717),n.e(7005),n.e(40186),n.e(22585),n.e(73206),n.e(11037),n.e(33235),n.e(91957),n.e(84176),n.e(16357),n.e(75681)]).then(n.bind(n,295227)))),An=(0,Je()._h)(wn,(e=>e.SpaceSettings));var In=()=>n(549500),kn=()=>n(753035),Cn=()=>n(731320);const xn=new(Je().O2)("Marketplace",(async()=>{const{default:e}=await Promise.all([n.e(96346),n.e(58550),n.e(37353),n.e(74728),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(28271),n.e(97308),n.e(27991),n.e(72597),n.e(71923),n.e(69803),n.e(79239)]).then(n.bind(n,203767));return{Marketplace:e}})),Tn=(0,Je()._h)(xn,(e=>e.Marketplace));var _n=()=>n(869562),Pn=()=>n(644914),En=()=>n(430483),Un=(n(16280),()=>n(244641)),Ln=()=>n(604341);async function Mn(e,t){const n=await $e().callApi({eventName:"stripeGetTestClock",environment:t,data:{spaceId:e}});if("success"===n.type){if("advancing"===n.data.status)throw new Error("Test clock is advancing. Please try again in a few seconds.");return n.data.epochSeconds}}async function Rn(e){const{environment:t,spaceId:n,advanceTestClockArgument:o}=e;if(o)return"number"==typeof o?o:"function"==typeof o?await async function(e){const{environment:t,spaceId:n,callback:o}=e,r=await Mn(n,t);if(r)return o(r)}({environment:t,spaceId:n,callback:o}):"object"==typeof o?await async function(e){const{environment:t,spaceId:n,durationLike:o}=e,r=await Mn(n,t);if(!r)return;const i=Un().c9.fromSeconds(r),a=Un().dw.fromDurationLike(o);return i.plus(a).toSeconds()}({environment:t,spaceId:n,durationLike:o}):void 0}var jn=()=>n(496506);const Nn=new(Je().O2)("PageLayoutEditor",(async()=>Promise.all([n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(3965),n.e(84341),n.e(80533),n.e(45620),n.e(58221),n.e(44763),n.e(8081),n.e(67183),n.e(64598),n.e(82720),n.e(4253),n.e(86787),n.e(77465),n.e(24593),n.e(80896),n.e(1440),n.e(67378),n.e(58504),n.e(97308),n.e(63996),n.e(20636),n.e(66268),n.e(55717),n.e(7005),n.e(40186),n.e(22585),n.e(73206),n.e(11037),n.e(33235),n.e(91957),n.e(84176),n.e(16357),n.e(75681)]).then(n.bind(n,975081)))),Bn=(0,Je()._h)(Nn,(e=>e.PageLayoutEditor)),Dn=new(Je().O2)("SiteSettingsLayoutEditor",(async()=>await Promise.all([n.e(75134),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(17989),n.e(90625),n.e(59794),n.e(26483),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(48199),n.e(77905),n.e(46204)]).then(n.bind(n,242565)))),On=(0,Je()._h)(Dn,(e=>e.SiteSettingsLayoutEditor));var qn=()=>n(263711);const zn={presentationMode:new(Je().O2)("PresentationMode",(async()=>await Promise.all([n.e(44711),n.e(53321),n.e(81330)]).then(n.bind(n,323928))))},Wn=(0,Je()._h)(zn.presentationMode,(e=>e.PresentationMode));function Kn(e){const{mainEditorCurrentBlockStore:t,currentCollectionViewStore:n}=(0,$().O$)(mt().default),o=(0,$().K8)((()=>{const o=e.routerState,r=o.route;if("team"===r.name)return{store:void 0,collectionViewStore:void 0,routerState:o};if("posts"===r.name)return{store:void 0,collectionViewStore:void 0,routerState:o};return t?{store:t,collectionViewStore:n,routerState:o}:void 0}),[n,t,e.routerState]),r=(0,$().K8)((()=>Vn.getState()),[]),i=(0,$().K8)((()=>$n.getState()),[]),a=(0,$().K8)((()=>Fn.getState()),[]);return r?(0,u.jsx)(Bn,{}):a?(0,u.jsx)(Wn,{}):o?i?(0,u.jsx)(On,{}):(0,u.jsx)(nt().Ay,{...o}):null}const Vn=new(jn().default)((()=>{const e=qn().g.getState();return e.isOpen&&"layout-editor"===e.mode}),{debugName:"isPageLayoutEditorOpenStore"}),$n=new(jn().default)((()=>{const e=qn().g.getState();return e.isOpen&&"site-settings-editor"===e.mode}),{debugName:"isSiteSettingsLayoutEditorOpenStore"}),Fn=new(jn().default)((()=>{const e=qn().g.getState();return e.isOpen&&"presentation"===e.mode}),{debugName:"isPresentationModeOpenStore"}),Gn={FullPageAIChatLoader:new(Je().O2)("FullPageAIChatLoader",(()=>n.e(58596).then(n.bind(n,116882))))},Hn=(0,Je()._h)(Gn.FullPageAIChatLoader,(e=>e.FullPageAIChatLoader));var Jn=()=>n(857639),Zn=()=>n(824622),Xn=()=>n(836251),Yn=()=>n(963589),Qn=()=>n(311337),eo=()=>n(26468),to=()=>n(362749),no=()=>n(817411),oo=()=>n(155959),ro=()=>n(227440);function io(){const e=(0,g().v3)(),{isPhone:t,isTablet:n}=(0,g().Y0)(),o=(0,$().K8)((()=>(0,Pn().KB)(e)),[e]),r=(0,oo().T)("supportsNativeHome"),i=(0,Yn().X)("tablet_refresh_gate"),a=(0,$().K8)((()=>(0,Qn().y)(e)),[e]);return t||n&&!i||n&&a?r?(0,u.jsx)(Zn().As,{}):(0,u.jsx)(to().Nd,{}):(0,u.jsx)(ao,{isExpanded:o})}function ao(e){let{isExpanded:t}=e;const n=(0,g().v3)(),r=n.device.isElectronMac,i=(0,$().K8)((()=>void 0!==C().rp(n).state),[n]),a=(0,$().K8)((()=>(0,Xn().w6)(n)),[n]),s=(0,$().K8)((()=>(0,eo().j)(n)),[n]);!function(e){const{isLoaded:t,isOnPublicPage:n,isOnPublicShareLinkPage:r}=e,i=(0,o.useRef)();(0,o.useEffect)((()=>(i.current=setTimeout((()=>{const e={level:"error",from:"SidebarContentContainer",type:"sidebarLoadingTimeout",error:{message:`Sidebar took longer than ${so/1e3} seconds to load.`},data:{miscDataToConvertToString:{isOnline:ro().A.state.online,hasCurrentSpaceStore:Boolean(mt().default.state.currentSpaceStore),hasCurrentSpaceViewStore:Boolean(mt().default.state.currentSpaceViewStore),hasCurrentUserRootStore:Boolean(mt().default.state.currentUserRootStore),hasCurrentUserSettingsStore:Boolean(mt().default.state.currentUserSettingsStore),documentVisibilityState:document.visibilityState,isOnPublicPage:n,isOnPublicShareLinkPage:r}}};L().electronApi?L().logErrorForOffline(e):Jn().log(e),i.current=void 0}),so),()=>{i.current&&(clearTimeout(i.current),i.current=void 0)})),[n,r]),(0,o.useEffect)((()=>{t&&i.current&&(clearTimeout(i.current),i.current=void 0)}),[t])}({isLoaded:i,isOnPublicPage:a,isOnPublicShareLinkPage:s});const c=(0,o.useCallback)((()=>(0,u.jsx)(no().A,{skipFadeinDelay:!0})),[]),{isTablet:l}=(0,g().Y0)();return(0,u.jsx)(to().YZ,{isElectronMac:r,isTablet:l,isExpanded:t,renderLoading:c,forceRenderLoading:!i&&!(a||s)})}const so=9e4;const co=(0,Je()._h)(new(Je().O2)("NotionBanners",(()=>Promise.all([n.e(64387),n.e(18724)]).then(n.bind(n,518724)))),(e=>e.default)),lo=new(Je().O2)("NotionModals",(()=>Promise.all([n.e(75134),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(16471),n.e(53321),n.e(58550),n.e(90825),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28866),n.e(21194),n.e(59794),n.e(52393),n.e(75601),n.e(11341),n.e(26090),n.e(12341),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(48199),n.e(87598),n.e(23063),n.e(3965),n.e(84341),n.e(80533),n.e(58221),n.e(44763),n.e(8081),n.e(67183),n.e(82720),n.e(77465),n.e(67378),n.e(97308),n.e(66268),n.e(46882)]).then(n.bind(n,199906)))),uo=(0,Je()._h)(lo,(e=>e.default));const po=function(e){let{routerState:t}=e;const r=(0,g().v3)();(0,o.useEffect)((()=>{var e;if(null!==(e=r.mobileNative)&&void 0!==e&&e.api.appComponentMountState)return r.mobileNative.api.appComponentMountState(!0),()=>{var e;null!==(e=r.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&r.mobileNative.api.appComponentMountState(!1)}}),[r]);const{route:i}=t,a="on"===(0,Lt().r)("preload_prewarm_tab_v2")&&"blank"===i.name;(0,o.useEffect)((()=>{a&&(0,n(740456).fX)()}),[a]);const s=(0,$().O$)(mt().AppStoreMainEditorCurrentBlockStore),c=(0,$().K8)((()=>n(792415).A.state.publicPageData),[]),{shouldShowSidebar:l,shouldShowFrame:d,shouldShowError:p,shouldRedirectFromHome:m}=(0,$().K8)((()=>C().X4(r)),[r]),f=(0,$().K8)((()=>"page"===i.name&&kn().A.state.open&&(0,Cn().K1)(kn().A.state.blockStore)),[i.name]),v=(0,n(539412).x9)(),{showAiChatModuleInHome:h}=(0,n(327300).w4)(),b=(0,$().K8)((()=>{const{device:e}=r;return"chat"!==i.name&&("marketplace"!==i.name&&(!Vn.state&&(!$n.state&&(!Fn.state&&(!v&&((!h||null==s||!s.isType(n(700500).xd.personalHomePage))&&En().zD.shouldShowAssistantInCorner(e)))))))}),[r,i.name,v,s,h]),S=(0,$().K8)((()=>!r.device.isMobile&&!Vn.state),[r.device.isMobile]),y=(0,$().K8)((()=>{if(!r.currentUser.isLoggedIn())return!1;if(r.device.isMobile)return!1;const{mainEditorCurrentBlockStore:e,currentSpaceStore:t}=mt().default.state;return!(!e||!t)&&(!(0,Cn().qb)(r,e)&&(!b&&(!Vn.state&&(!$n.state&&!Fn.state))))}),[r,b]),w=(0,$().K8)((()=>{const{device:e}=r;return!!e.isMobileNative&&("page"===i.name?En().zD.isXMLAssistantEnabled():void 0)}),[r,i.name]),A=(0,$().K8)((()=>l&&!(0,Pn().tv)(r)&&n(749687).sidebarOpenStore.state),[r,l]),I=(0,$().K8)((()=>(0,n(574506).t)(r)),[r]),k=(0,$().K8)((()=>(0,n(68465).ZE)(void 0)),[]),x=(0,$().K8)((()=>mt().default.state.renderPhase),[]),T=(0,n(255824).a)(),_=(0,n(877051).V)();return function(){const e=["local","staging","development"].includes("production"),t=(0,g().v3)();(0,o.useEffect)((()=>{e&&((0,Ln().exposeDebugValue)("refreshTestClock",(async()=>{var e;const n=null===(e=mt().default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(n){const e=await Mn(n,t);if(e){const t=Un().c9.fromSeconds(e);console.log(`Test clock time is ${t.toString()} (${e} seconds)`)}}})),(0,Ln().exposeDebugValue)("advanceTestClock",(async e=>{var n;if(!e)throw new Error("advanceTestClock requires an argument. You can pass an epoch timestamp in seconds, a relative DurationLike object like { months: 2 }, or a function that takes the current epoch seconds and returns the new epoch seconds.");const o=null===(n=mt().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!o)return;const r=await Rn({environment:t,spaceId:o,advanceTestClockArgument:e});r&&await $e().callApi({eventName:"stripeAdvanceTestClock",environment:t,data:{spaceId:o,epochSeconds:r}})})))}),[e,t])}(),(0,u.jsxs)(ft,{children:[l&&(0,u.jsx)(io,{}),d&&(s||T||"team"===i.name||"posts"===i.name)&&(0,u.jsx)(Kn,{routerState:t}),!T&&"chat"===i.name&&(0,u.jsx)(Hn,{route:i}),"marketplace"===i.name&&(0,u.jsx)(Tn,{}),!_&&l&&(0,u.jsx)(yn,{}),!_&&(0,u.jsx)(an,{}),f&&(0,u.jsx)(bn,{}),(p||m)&&!f&&(0,u.jsx)(Pt().o,{route:t.route,publicPageData:c,shouldRedirectFromHome:m}),A&&(0,u.jsx)(fo,{}),(0,u.jsx)(ln,{}),y&&(0,u.jsx)(n(316437).A,{}),!_&&b&&(0,u.jsx)(on().LazyAssistantMenuPopup,{}),!_&&r.device.isMobile&&(0,u.jsx)(In().IM,{}),!_&&w&&(0,u.jsx)(on().LazyMobileAssistantPendingOperationsCollapsedElement,{}),!_&&b&&(0,u.jsx)(on().LazyAssistantOriginElement,{}),!_&&(0,u.jsx)(vn,{}),!_&&k&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nn().eE,{}),(0,u.jsx)(nn().ZT,{})]}),I&&(0,u.jsx)(fn,{}),!r.device.isMobile&&"nativeTab"!==t.route.name&&(0,u.jsx)(n(75600).t,{}),"rendered"!==x||r.device.isMobile?null:(0,u.jsx)(n(532688).RK,{}),!_&&S&&s&&(0,u.jsx)(n(577009).Sx,{currentBlockStore:s,isElectronMac:r.device.isElectronMac}),!_&&(0,u.jsx)(In().i6,{}),!_&&(0,u.jsx)(co,{}),!_&&(0,u.jsx)(uo,{}),!1,(0,u.jsx)(go,{})]})};function mo(){_n().close()}function fo(){const e=(0,g().v3)(),t=(0,$().K8)((()=>function(e){return{position:"absolute",top:0,left:(0,Pn().r6)(e),right:0,bottom:0,zIndex:2}}(e)),[e]);return(0,u.jsx)("div",{style:t,onClick:mo})}function go(){const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=(0,$().K8)((()=>{const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=mt().default.state;return{currentSpaceStore:e,currentUserStore:t,renderPhase:n}}),[]);return e&&t&&"rendered"===n?(0,u.jsx)(An,{spaceStore:e,userStore:t},`${e.id}-${null==t?void 0:t.id}`):null}function vo(){const e=(0,g().v3)();(0,o.useEffect)((()=>{!b().A.isAdminMode&&e.currentUser.isLoggedIn()&&mt().default.waitUntil((()=>{const t=mt().default.state.currentUserSettingsStore,n=(null==t?void 0:t.isDefined())??!1;if(t&&n){const n=t.getSettings(),o=null==n?void 0:n.disable_auto_set_timezone;n&&!o&&qe().xw({environment:e,userSettingsStore:t})}return n}))}),[e]),(0,o.useEffect)((()=>{function t(){const{RouterStore:t,currentUser:n}=e,o=n.id;Be().zd({historyId:t.state.id,currentUserId:o}),L().navigationReady(!1)}return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)}),[e]),(0,o.useEffect)((()=>{async function t(t){const{RouterStore:n}=e,o=window.location.href,r=t.state?t.state.currentUserId:void 0;let i=e;(0,Bt().w8)({environment:e}),r&&r!==e.currentUser.id&&(i=await ze().T({environment:i,newCurrentUserId:r}));const a=n.state.route,s=xe().parseRoute({url:o,isMobile:i.device.isMobile,baseUrl:b().A.domainBaseUrl,publicDomainName:b().A.publicDomainName,protocol:b().A.protocol,currentUrl:window.location.href}),c="page"===a.name&&"page"===s.name&&a.blockId===s.blockId,l="onboarding"!==a.name&&"onboarding"===s.name;Be().zd({historyId:n.state.id,currentUserId:r}),await Oe().Yw({environment:i,id:t.state&&t.state.id||(0,Ue().Ay)(),action:"pop",href:o}),l&&!e.device.isMobileNative&&M().oo({environment:i,url:Te().JZ.root}),c&&M().qf(i)}return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)}),[e]),(0,_().l)((()=>{L().subscribeToProtocolUrl((t=>function(e,t){So("string"==typeof e?e:e.url,!1,!1,t)}(t,e))),L().subscribeToSettingsMenuItem(bo),L().navigationReady(!0),L().onNewWindow(((t,n)=>{M().oo({environment:e,url:n,openInNew:"tab"})}))})),(0,o.useEffect)((()=>{e.mobileNative&&e.mobileNative.subscribeToOpenLink(((t,n,o)=>So(t,n,o,e)))}),[e]);const t=(0,$().O$)(e.RouterStore);(0,o.useEffect)((()=>{var e;"root"===t.route.name||"page"===t.route.name||"space"===t.route.name||"blank"===t.route.name&&0===(null===(e=t.historyState)||void 0===e?void 0:e.index)||(je().setInitialRenderCompleted(),mt().default.setState({...mt().default.state,renderPhase:"rendered"}))}),[t]),(0,o.useEffect)((()=>{e.currentUser.isLoggedIn()||"page"===t.route.name||"space"===t.route.name||Ie().u4({device:e.device,event:{facebook:{eventName:"PageView",data:{content_name:window.location.href}},google:{eventName:"pageView",path:window.location.pathname}},cookieService:e.cookieService})}),[e.cookieService,e.currentUser,e.device,t.route.name]),(0,o.useEffect)((()=>{const t=mt().default.state.currentUserSettingsStore;e.currentUser.isLoggedIn()&&t&&We().Sz(e,t)}),[e]);const r="on"===(0,Lt().r)("preload_prewarm_tab_v2"),{device:i}=e;if(i.isNative&&xe().L7[t.route.name])return(0,u.jsx)(lt,{});if("front"===t.route.name)return(0,u.jsx)(tt,{preventFrontRedirect:t.route.alreadyRedirected});if("root"===t.route.name)return(0,u.jsx)(ot,{route:t.route});if("nativeRedirect"===t.route.name||"nativeMailRedirect"===t.route.name||"nativeCalendarRedirect"===t.route.name)return(0,u.jsx)(it,{redirect:t.route.redirect,callbackType:"nativeMailRedirect"===t.route.name?"nativemailredirect":"nativeCalendarRedirect"===t.route.name?"nativecalendarredirect":"nativeredirect"});if("login"===t.route.name)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Dt().AuthSyncListener,{}),(0,u.jsx)(Qe().HQ,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL})]});if("login/calendar"===t.route.name||"login/mail"===t.route.name)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Dt().AuthSyncListener,{}),(0,u.jsx)(Qe().HQ,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL,addAnotherAccount:Boolean(t.route.addAnotherAccount)})]});if("addAnotherAccount"===t.route.name)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Dt().AuthSyncListener,{}),(0,u.jsx)(Nt,{redirectURL:t.route.redirectURL})]});if("desktopEmailConfirm"===t.route.name)return(0,u.jsx)(Xe,{});if("teamsInvite"===t.route.name){const{teamId:n}=t.route;return Re().WO(e,{teamId:n}),(0,u.jsx)(rt().A,{fetch:async()=>{const t=new(Kt().h4)(e,{table:_e().yK,id:n});await t.load()},render:()=>(0,u.jsx)(tn,{teamId:n})})}if("signup"===t.route.name)return(0,u.jsx)(Qe().HQ,{isSignup:!0,email:t.route.email,referrer:t.route.referrer});if("signup/calendar"===t.route.name||"signup/mail"===t.route.name)return(0,u.jsx)(Qe().HQ,{isSignup:!0,email:t.route.email,referrer:t.route.referrer,redirectURL:t.route.redirectURL,addAnotherAccount:Boolean(t.route.addAnotherAccount)});if("unsubscribe"===t.route.name)return(0,u.jsx)(He,{payload:t.route.payload});if("make"===t.route.name)return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(96346),n.e(55373),n.e(36192),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(28387)]).then(n.bind(n,754606)),render:e=>{let{PublicAIBuilder:t}=e;return(0,u.jsx)(t,{})}});if("onboarding"===t.route.name)return(0,u.jsx)(xt,{});if("upcomingInvoice"===t.route.name)return(0,u.jsx)(kt().Y,{route:t.route});if("invoiceById"===t.route.name)return(0,u.jsx)(kt().Y,{route:t.route});if("settingsConsoleOrganization"===t.route.name){if(e.currentUser.isLoggedIn())return(0,u.jsx)(_t,{organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,params:t.route.params});{const e=(0,Ee().re)({organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,queryParams:t.route.params}),n=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(ho,{url:n})}}if(t.route.name,t.route.name,"admin"===t.route.name&&b().A.isAdminMode)return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(64038),n.e(4422),n.e(3965),n.e(23774),n.e(72008),n.e(19884)]).then(n.bind(n,472008)),render:e=>{let{Admin:t}=e;return(0,u.jsx)(t,{})}});if("adminListData"===t.route.name){const{category:e}=t.route;if(b().A.isAdminMode)return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(64038),n.e(4422),n.e(3965),n.e(23774),n.e(72008),n.e(19884)]).then(n.bind(n,844923)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{category:e})}})}if("adminSingleRecord"===t.route.name&&b().A.isAdminMode){const{id:e,table:o}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(64038),n.e(4422),n.e(3965),n.e(23774),n.e(72008),n.e(18303)]).then(n.bind(n,364233)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{table:o,id:e})}})}if("oauthAuthorization"===t.route.name){const{responseType:e,redirectUri:o,integrationId:r,state:i,owner:a,userId:s,spaceId:c}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(75134),n.e(58550),n.e(41870),n.e(4422),n.e(11341),n.e(26199),n.e(67378),n.e(63513),n.e(65999),n.e(9647)]).then(n.bind(n,773721)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{responseType:e,redirectUri:o,integrationId:r,state:i,owner:a,userId:s,spaceId:c})}})}if("passkeyAuthVerify"===t.route.name){const{callbackType:e}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(25049),n.e(66805)]).then(n.bind(n,471283)),render:t=>{let{VerifyPasskeyRedirectPage:n}=t;return(0,u.jsx)(n,{callbackType:e})}})}if("notionCalendarAuthorization"===t.route.name){const{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:i,state:a}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>n.e(58777).then(n.bind(n,215627)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:i,state:a})}})}if("globalOauthPostLogin"===t.route.name){const{clientId:e,redirectUri:o,state:r,responseType:i,scope:a}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>Promise.all([n.e(75134),n.e(63513),n.e(56353)]).then(n.bind(n,881489)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{clientId:e,redirectUri:o,csrfState:r,responseType:i,scope:a})}})}if("passkeyRegistrationVerification"===t.route.name){const{callbackType:o,csrfToken:r,attemptId:i,options:a}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>n.e(67045).then(n.bind(n,407485)),render:t=>{let{AddPasskeyRedirectPage:n}=t;return(0,u.jsx)(n,{environment:e,callbackType:o,csrfToken:r,attemptId:i,options:a})}})}if("initiateExternalAuthentication"===t.route.name){const{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,integration_id:c,redirectToAuth:l}=t.route;return(0,u.jsx)(rt().A,{fetch:()=>n.e(18071).then(n.bind(n,856425)),render:t=>{let{default:n}=t;return(0,u.jsx)(n,{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,integration_id:c,redirectToAuth:l})}})}if("initiateExternalAuthenticationFromDesktop"===t.route.name){const{redirectUri:o}=t.route;if(e.currentUser.isLoggedIn())return(0,u.jsx)(rt().A,{fetch:()=>n.e(58657).then(n.bind(n,465677)),render:e=>{let{default:t}=e;return(0,u.jsx)(t,{redirectUri:o})}});{const e=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:o}}),t=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return Pe().TR(),(0,u.jsx)(ho,{url:t})}}if("myIntegrations"===t.route.name)return(0,u.jsx)(ho,{url:Te().JZ.creatorProfileIntegrations});if("inAppTemplateSubmission"===t.route.name)return(0,u.jsx)(ho,{url:Te().JZ.creatorProfileTemplates});if("inAppTemplateCreatorSubmission"===t.route.name)return(0,u.jsx)(ho,{url:Te().JZ.creatorProfile});if("creatorProfile"===t.route.name||"creatorProfileTemplates"===t.route.name||"creatorProfileIntegrations"===t.route.name||"creatorProfileAnalytics"===t.route.name||"creatorProfileCoupons"===t.route.name){if(e.currentUser.isLoggedIn())return"pointer"in t.route?(0,u.jsx)(St,{publish:Boolean(t.route.publish),lab:Boolean(t.route.lab),botOrIntegrationPointer:t.route.pointer}):(0,u.jsx)(St,{publish:!1,lab:!1,botOrIntegrationPointer:void 0});{const e=Me().Gm({url:`${Te().JZ[t.route.name]}`}),n=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(ho,{url:n})}}if("localizedTemplates"===t.route.name){if(e.currentUser.isLoggedIn())return(0,u.jsx)(Rt,{});{const e=Me().Gm({url:`${Te().JZ[t.route.name]}`}),n=Me().Gm({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(ho,{url:n})}}if("studentGroupSignup"===t.route.name)return(0,u.jsx)($t,{});if("startupsApplication"===t.route.name)return(0,u.jsx)(qt,{formType:"startups"});if("smbsApplication"===t.route.name)return(0,u.jsx)(qt,{formType:"smb"});if("lennyApplication"===t.route.name)return(0,u.jsx)(Wt,{});if("creatorProgramApplication"===t.route.name)return(0,u.jsx)(wt,{});if("githubStudentPackHome"===t.route.name)return(0,u.jsx)(Ut,{});if("notFound"===t.route.name)return(0,u.jsx)(Pt().o,{route:t.route,publicPageData:void 0});if("blank"===t.route.name&&!r)return(0,u.jsx)(It,{});if("modal"===t.route.name&&!e.currentUser.isLoggedIn()&&(t.route.templateGalleryItem||t.route.projectManagementLaunch)){const e={};return t.route.projectManagementLaunch?e.tg="gallery":t.route.templateGalleryItem&&(e.tg=t.route.templateGalleryItem),(0,u.jsx)(ho,{url:Te().JZ.login,queryParams:e})}if("chat"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,ke().X_)(t.route),n=(0,Me().Gm)({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(ho,{url:n})}if("marketplace"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,Ce().YD)(b().A,t.route),n=(0,Me().Gm)({url:`${b().A.domainBaseUrl}${Te().JZ.login}`,query:{redirectURL:e}});return(0,u.jsx)(ho,{url:n})}return"quickSearch"===t.route.name?(0,u.jsx)(ht,{}):"page"===t.route.name||"space"===t.route.name||"nativeTab"===t.route.name||"modal"===t.route.name||"chat"===t.route.name||"marketplace"===t.route.name||"team"===t.route.name||"posts"===t.route.name||"blank"===t.route.name&&r?(0,u.jsx)(po,{routerState:t}):(0,u.jsx)(Ke().A,{})}function ho(e){let{url:t,queryParams:n}=e;const r=(0,g().v3)(),i=(0,o.useRef)(!1);return(0,o.useEffect)((()=>{i.current||(i.current=!0,n&&De().I({currentUserId:void 0,params:n}),M().oo({environment:r,url:t,redirect:!0}))}),[r,n,t]),(0,u.jsx)(Ke().A,{})}function bo(e){Ne().Ow({currentTab:e})}function So(e,t,n,o){const{RouterStore:r}=o,i=Le().Q1({url:e,protocol:b().A.protocol,baseUrl:b().A.domainBaseUrl}),a=Le().kb({schemeUrl:i,baseUrl:b().A.domainBaseUrl}),s=xe().parseRoute({url:a,baseUrl:b().A.domainBaseUrl,publicDomainName:b().A.publicDomainName,isMobile:o.device.isMobile,protocol:b().A.protocol,currentUrl:window.location.href});(o.device.isAndroid||t)&&Be().TC({RouterStore:r,currentUserId:o.currentUser.id}),o.mobileNative&&o.mobileNative.closeInAppBrowser(),"googleAuthCallback"!==s.name&&"samlAuthCallback"!==s.name&&"passkeyAuthCallback"!==s.name?M().oo({environment:o,url:a,redirect:t,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:n},queryId:"page"===s.name?s.queryId:void 0}):M().oo({environment:o,url:a})}const yo=!1;function wo(e){let{environment:t,onMount:n}=e;const c=(0,o.useRef)(!1);(0,o.useEffect)((()=>{c.current||(c.current=!0,null==n||n())}),[n]),(0,o.useEffect)((()=>{C().jx()}),[]);const l=yo?o.StrictMode:o.Fragment;return(0,u.jsx)(l,{children:(0,u.jsx)(r().aw,{value:t,children:(0,u.jsx)(I().k,{children:(0,u.jsxs)(i().wX,{children:[(0,u.jsx)(s().Dk,{defaultLocale:"en-US",locale:a().locale,messages:a().D,children:(0,u.jsx)(p,{...m(t.device),children:(0,u.jsx)(k().K,{fallback:e=>(0,u.jsx)(z,{...e}),from:"Router",type:"AppCrash",children:(0,u.jsxs)(A,{id:"app",targetRenderPhase:"mount",children:[(0,u.jsx)(Ae().A,{}),(0,u.jsx)(we,{children:(0,u.jsx)(vo,{})})]})})})}),(0,u.jsx)(T,{})]})})})})}},682497:(e,t,n)=>{n.d(t,{o:()=>i});var o=()=>n(645873);const r=new(o().O2)("PageError",(async()=>Promise.all([n.e(44711),n.e(35837),n.e(23063),n.e(44763),n.e(25049),n.e(30873),n.e(88060),n.e(66960)]).then(n.bind(n,790452)))),i=(0,o()._h)(r,(e=>e.PageError))},748539:(e,t,n)=>{n.d(t,{f:()=>o});const o=new(n(645873).O2)("pageCovers",(async()=>{const{pageCovers:e}=await n.e(40198).then(n.bind(n,519737));return e}))},762014:(e,t,n)=>{n.d(t,{A:()=>i,e:()=>o});let o=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class r extends(()=>n(757695))().default{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const i=new r},817411:(e,t,n)=>{n.d(t,{A:()=>u});n(581454),n(296540);var o=()=>n(484714),r=()=>n(847249),i=()=>n(401497);const a=[[2,1,3,1],[1,0,2,0],[0,2,0,3],[3,3,0,2],[1,1,2,2]];var s=()=>n(710149),c=()=>n(948914),l=()=>n(749687),d=n(474848);function u(e){let{skipFadeinDelay:t}=e;const n=(0,o().v3)(),u=(0,r().K8)((()=>n.device.isElectronMac&&!Boolean(c().A.state.isShowingTabBar)),[n]),m=(0,r().O$)(l().sidebarExpandedStore),f=(0,r().K8)((()=>m?l().sidebarWidthStore.state:0),[m]),g=(0,i().IS)((e=>{const t={width:20,height:20,borderRadius:4},n={height:10,minHeight:10,borderRadius:10};return{sidebar:{backgroundColor:e.surface.wash,boxShadow:e.sidebarBoxShadow,display:m?"flex":"none",minWidth:f,flexDirection:"column",padding:"12px 14px",overflow:"hidden"},heroSection:{paddingTop:u?36:0,marginBottom:22,display:"flex",alignItems:"center"},heroSectionIcon:{padding:"1px",...t,width:22,height:22},heroSectionTitle:{width:177,marginLeft:8,...n},toplevelMenu:{marginBottom:20,width:78,...n},toplevelMenuLast:{marginBottom:36,width:135,...n},sectionHeader:{marginBottom:14,width:56,...n},pageRow:{display:"flex",alignItems:"center",marginBottom:11},pageIcon:{...t},pageTitle:{marginLeft:8,...n}}}),[m,f,u]),v=(0,d.jsxs)("div",{style:g.heroSection,children:[(0,d.jsx)(s().A,{style:g.heroSectionIcon,emphasized:!0}),(0,d.jsx)(s().A,{style:g.heroSectionTitle,emphasized:!0})]}),h=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s().A,{style:g.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().A,{style:g.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().A,{style:g.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().A,{style:g.toplevelMenuLast,emphasized:!0})]}),b=(0,d.jsx)(s().A,{style:g.sectionHeader,emphasized:!0}),S=a.map(((e,n)=>e.map(((e,o)=>(0,d.jsxs)("div",{style:{...!t&&p(n),...g.pageRow},children:[(0,d.jsx)(s().A,{style:g.pageIcon,emphasized:!0}),(0,d.jsx)(s().A,{style:{...g.pageTitle,width:80+20*e},emphasized:!0})]},`${n}-${o}`)))));return(0,d.jsxs)("div",{style:g.sidebar,children:[v,h,b,S]})}function p(e){return 0===e?{}:{animation:`1s ease-in ${e}s 1 normal both running fadein`}}},840125:(e,t,n)=>{n.r(t),n.d(t,{getCloseConfirmationDialogReason:()=>u,getUserControlledCloseConfirmationDialogReason:()=>d,setupOnBeforeUnload:()=>m,showConfirmationDialogEventEmitter:()=>c});n(16280);var o=()=>n(534177),r=()=>n(964345),i=()=>n(337567),a=()=>n(878423),s=()=>n(485634);const c=new(n(592328).A);let l;function d(){const e=u();switch(e){case"have_local_draft_unsaved_changes":case"dictation_in_progress":return e;case void 0:case"transaction_queue_has_tasks":case"uploading_files":case"generating_ai_completions":case"have_pending_ai_edits":case"have_pending_synced_collection_changes":return}(0,o().HB)(e)}function u(){if(!l)throw new Error("beforeUnloadHelpers.setupOnBeforeUnload() was not called!");return l()}const p="Changes you made may not be saved. Are you sure you want to quit?";function m(e){const{TransactionQueue:t,device:n,AppUpdateStore:o,GlobalFileUploadStore:d}=e;l=function(){return!t.hasTasks()||n.isMobileNative||n.isElectron||o.isMajorUpdate()?(0,i().A5)()?"have_pending_ai_edits":a().A.doesAnyCacheHaveUnsavedChanges()?"have_local_draft_unsaved_changes":d.isUploading()?"uploading_files":s().A.hasPendingSyncedCollectionChanges()?"have_pending_synced_collection_changes":r().gZ.state?"dictation_in_progress":void 0:"transaction_queue_has_tasks"},window.onbeforeunload=function(){const e=u();if(e)return c.emit(e),p}}},901459:(e,t,n)=>{n.d(t,{Z:()=>i});var o=()=>n(645873);const r=new(o().O2)("SearchModal",(async()=>Promise.all([n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(16471),n.e(53321),n.e(90825),n.e(37353),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(85515),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28866),n.e(71993),n.e(52393),n.e(7060),n.e(26090),n.e(12341),n.e(66984),n.e(40828),n.e(90978),n.e(5023),n.e(80187)]).then(n.bind(n,307060)))),i=(0,o()._h)(r,(e=>e.Search))},903659:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(296540),r=()=>n(847249),i=()=>n(93658),a=n(474848);const s=function(e){const t=(0,n(484714).Y0)(),s=(0,r().K8)((()=>({initiator:n(353643).A.state.initiator,isDragging:n(861841).Ay.state.isDragging})),[]),c=(0,r().K8)((()=>i().default.state.isActive),[]),l=(0,r().K8)((()=>!!i().default.state.isActive&&i().default.state.moved?"default":s.isDragging?"-webkit-grabbing":"text"),[s.isDragging]),d=(0,o.useMemo)((()=>{let e="notion-cursor-listener";return"-webkit-grabbing"===l&&(e+=" notion-disable-local-cursor"),e}),[l]);return(0,o.useEffect)((()=>{t.isIOS&&("touch"===s.initiator||s.isDragging||c?document.body.classList.add("notion-disable-webkit-user-select"):document.body.classList.remove("notion-disable-webkit-user-select"))}),[t.isIOS,s.initiator,s.isDragging,c]),(0,a.jsx)("div",{style:{...e.style,cursor:l},className:d,children:e.children})}},933371:(e,t,n)=>{n.d(t,{X:()=>o});const o=n(757695).default.createValue({shouldReset:!1},{name:"MobileAssistantMenuStore"})},942906:(e,t,n)=>{n.d(t,{Lj:()=>s,W2:()=>c,xw:()=>a});var o=()=>n(416504),r=()=>n(751156),i=()=>n(755199);function a(e){const{environment:t,userSettingsStore:n}=e,r=n.getSettings(),i=null==r?void 0:r.time_zone,a=(0,o().P)();i!==a&&s({environment:t,userSettingsStore:n,timeZone:a})}function s(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;r().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{i().mJ({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function c(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;r().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{i().mJ({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},987264:(e,t,n)=>{n.d(t,{s:()=>r});n(296540);var o=n(474848);const r=(0,n(340498).wt)("eyes",{viewBox:"0 0 72 72",svg:(0,o.jsx)("path",{d:"M17.0312 64.4375C26.25 64.4375 33.5625 52.9688 33.5625 36.4375C33.5625 19.9062 26.25 8.46875 17.0312 8.46875C7.8125 8.46875 0.5 19.9062 0.5 36.4375C0.5 52.9688 7.8125 64.4375 17.0312 64.4375ZM54.9688 64.4375C64.1875 64.4375 71.5 52.9688 71.5 36.4375C71.5 19.9062 64.1875 8.46875 54.9688 8.46875C45.75 8.46875 38.4375 19.9062 38.4375 36.4375C38.4375 52.9688 45.75 64.4375 54.9688 64.4375ZM10.0625 47.1875C15.125 47.1875 18.4688 43.6562 18.4688 38.3438C18.4688 33.0938 15.125 29.5625 10.0625 29.5625C7.6875 29.5625 5.71875 30.3125 4.25 31.6875C5.375 19.9375 10.6875 11.9375 17.0312 11.9062C24.25 11.875 30.125 22.0312 30.125 36.4375C30.125 50.7812 24.25 60.9688 17.0312 61C11.5312 61.0312 6.78125 54.9688 4.90625 45.5938C6.28125 46.625 8.03125 47.1875 10.0625 47.1875ZM47.9688 47.1875C53 47.1875 56.4062 43.6562 56.4062 38.3438C56.4062 33.0938 53 29.5625 47.9688 29.5625C45.5938 29.5625 43.5938 30.3438 42.1562 31.6875C43.2812 19.9375 48.5938 11.9375 54.9688 11.9375C62.1562 11.9062 68 22.0938 68 36.4375C68 50.7812 62.1562 60.9688 54.9688 60.9688C49.4375 61 44.6875 54.9375 42.7812 45.5938C44.1562 46.5938 45.9375 47.1875 47.9688 47.1875ZM45.5312 37.4062C44.4375 37.25 43.75 35.9688 44.0312 34.6562C44.3125 33.3125 45.3125 32.3438 46.375 32.5312C47.4688 32.75 48.0938 34.0312 47.8438 35.3125C47.5938 36.6562 46.5938 37.5938 45.5312 37.4062ZM7.625 37.4062C6.53125 37.25 5.84375 35.9688 6.09375 34.6562C6.375 33.3125 7.40625 32.3438 8.4375 32.5312C9.5625 32.7812 10.1875 34.0312 9.9375 35.3125C9.6875 36.6562 8.65625 37.5938 7.625 37.4062Z"})})},993893:(e,t,n)=>{n.d(t,{setupTransactionLoadGenerator:()=>c});var o=()=>n(604341),r=()=>n(319975),i=()=>n(751156),a=()=>n(351360),s=()=>n(24157);function c(e){(0,o().exposeDebugValue)("generateTransactionLoad",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const c=a().default.state.mainEditorCurrentBlockStore;if(!c)return void console.info("Cannot generateTransactionLoad: No current block");const l=c.getTitleStore();if(!l)return void console.info("Cannot generateTransactionLoad: block has no title");if("editing"!==s().default.state.mode)return void console.info("not editing anything. Click the page title.");const d=t=>{i().createAndCommit({userAction:"generateTransactionLoad.createTransaction",environment:e,canUndo:!0,perform:o=>{console.info("createAndCommit #",t);for(let i=0;i<n;i++){const n=`This is transaction #${t+1}, op ${i+1}, of load started at ${u}`;r().dw({environment:e,editorMode:"default",store:l,newValue:n,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}}})},u=new Date;if(0===o)for(let e=0;e<t;e++)d(e);else{let e=0;const n=setInterval((()=>{e<t?(d(e),e++):clearInterval(n)}),o)}}))}}}]);