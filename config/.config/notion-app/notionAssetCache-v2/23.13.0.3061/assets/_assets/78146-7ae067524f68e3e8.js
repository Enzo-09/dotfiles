"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[78146],{478146:(e,t,o)=>{o.d(t,{eO:()=>_});o(944114),o(898992),o(672577),o(581454);var n=o(296540),a=()=>o(484714),r=()=>o(847249),i=()=>o(401497),s=()=>o(668725),c=()=>o(863330),l=()=>o(959013),d=()=>o(284371),p=()=>o(704152),m=()=>o(760217),u=()=>o(8980),S=()=>o(933117),g=()=>o(299772),f=()=>o(115512),y=()=>o(37433),v=()=>o(351360),I=()=>o(848237),b=()=>o(898808),h=()=>o(906571),x=()=>o(952412),T=o(474848);const w=4;function _(e){let{postStore:t}=e;const o=(0,a().v3)(),s=(0,i().IS)((e=>({createTeamButton:{color:e.text.secondary}})),[]),{currentSpaceViewStore:d,currentSpaceStore:p}=(0,r().K8)((()=>{const{currentSpaceViewStore:e,currentSpaceStore:t}=v().default.state;return{currentSpaceViewStore:e,currentSpaceStore:t}}),[]),g=(0,r().K8)((()=>(0,y().canCreateTeam)({environment:o,spaceStore:p})),[p,o]),{selectedTeamStore:f,subscribedUserTeamStores:w,collectionContextStore:_,menuItems:M,selectedMenuItem:j}=(0,r().K8)((()=>{const{selectedTeamStore:e,subscribedUserTeamStores:t,collectionContextStore:o}=x().u.state,n=(t??[]).map((e=>({type:"store",store:e})));g&&n.push({type:"create-team-call-to-action"});const a=n.find((t=>"store"===t.type&&t.store.id===(null==e?void 0:e.id)));return{selectedTeamStore:e,subscribedUserTeamStores:t,collectionContextStore:o,menuItems:n,selectedMenuItem:a}}),[g]),V=(0,n.useCallback)((e=>{"create-team-call-to-action"===e.type?(0,I().vn)("post_composer"):(0,h().z)({environment:o,currentSpaceViewStore:d,selectedStore:e.store,collectionContextStore:_,postStore:t})}),[o,_,d,t]);return d&&p&&f&&w&&_?(0,T.jsx)(S().A,{items:M,getKey:e=>"store"===e.type?e.store.id:"create-team-call-to-action",selectedItem:j,onSelect:V,renderItem:e=>{const t=e.value;return"store"===t.type?(0,T.jsx)(m().A,{...e,title:t.store.getName(),icon:(0,T.jsx)(b().x,{store:t.store,size:16,disabled:!0})}):(0,T.jsx)(m().A,{...e,style:s.createTeamButton,title:(0,T.jsx)(l().sA,{id:"posts.teamTargetSelector.createTeamspace",defaultMessage:"New teamspace"}),icon:(0,T.jsx)(u().I,{icon:c().plusSmallIcon,size:"sm",color:"secondary"})})},renderOrigin:e=>(0,T.jsx)(C,{...e,selectedStore:f}),width:300}):null}function C(e){const t=(0,a().v3)(),{device:o}=t,{selectedStore:n,...r}=e,c=(0,i().IS)((e=>({dropdownButton:{padding:"6px 8px",color:e.text.secondary,fontSize:(0,f().ny)(t,"UISmall"),display:"inline-flex",justifyContent:"end",alignItems:"center",borderRadius:w},dropdownIcon:{width:10,marginLeft:4,fill:e.lightIconColor},dropdownText:{display:"inline-flex",alignItems:"center",fontWeight:d().Wy.medium,overflow:"hidden"}})),[t]);return(0,T.jsxs)(p().A,{mobileFeedback:o.isMobile,style:c.dropdownButton,...r,children:[(0,T.jsx)("div",{style:c.dropdownText,children:(0,T.jsx)(M,{selectedStore:n})}),(0,s().b)(c.dropdownIcon)]})}function M(e){let{selectedStore:t}=e;const o=(0,a().v3)(),n=(0,r().K8)((()=>null==t?void 0:t.getName()),[t]),s=(0,r().K8)((()=>(0,g().rK)(o)),[o]),c=(0,i().IS)((()=>({icon:{marginLeft:s?0:4,marginRight:4},teamName:{...d().RC}})),[s]),p=(0,T.jsx)(b().x,{store:t,size:16,disabled:!0,style:c.icon});return n?(0,T.jsxs)(T.Fragment,{children:[!s&&(0,T.jsx)(l().sA,{id:"postsComposer.teamDropdownTitle.in",defaultMessage:"In "}),(0,T.jsx)(l().sA,{id:"postsComposer.teamDropdownTitle.teamInfo",defaultMessage:"{teamIcon} {teamName}",values:{teamIcon:p,teamName:(0,T.jsx)("div",{style:c.teamName,children:n})}})]}):(0,T.jsx)(l().sA,{id:"postsComposer.teamDropdownTitle.withoutTeamName",defaultMessage:"In your teamspace"})}},709274:(e,t,o)=>{o.d(t,{D:()=>n});const n=(0,o(959013).YK)({postsCollectionViewPageTitle:{id:"posts.collectionViewPage.title",defaultMessage:"Posts"},postsCollectionTitle:{id:"posts.collection.title",defaultMessage:"Updates"},postHeadingName:{id:"posts.collection.headingName",defaultMessage:"Subject"},deleteDraftTooltip:{id:"posts.deleteDraftTooltip",defaultMessage:"Delete draft"},fullScreenTooltip:{id:"posts.fullScreenTooltip",defaultMessage:"Full screen"}})},863330:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,plusSmallIcon:()=>a});o(296540);const n={viewBox:"0 0 16 16",svg:(0,o(474848).jsx)("path",{d:"M8 2.3a.7.7 0 0 0-.7.7v4.3H3a.7.7 0 1 0 0 1.4h4.3V13a.7.7 0 1 0 1.4 0V8.7H13a.7.7 0 1 0 0-1.4H8.7V3a.7.7 0 0 0-.7-.7"})},a=(0,o(340498).wt)("plusSmall",n)},906571:(e,t,o)=>{o.d(t,{z:()=>j});var n=()=>o(519831),a=()=>o(869558),r=()=>o(854150),i=()=>o(44729),s=()=>o(751156),c=()=>o(559102),l=()=>o(972435),d=()=>o(351360),p=()=>o(630116),m=()=>o(134025);var u=()=>o(183558);const S=(0,o(959013).YK)({postHeadingName:{id:"posts.collection.headingName",defaultMessage:"Subject"},createdBy:{id:"database.propertyTypeName.posts.created_by",defaultMessage:"Created by"},createdTime:{id:"database.propertyTypeName.posts.created_time",defaultMessage:"Created time"}}),g="feed",f="descending",y={hide_linked_collection_name:!0,inline_collection_first_load_limit:{type:"load_limit",limit:10}};function v(e){return{property:e,direction:f}}function I(e){return{table:n().Vl,id:e.collectionId,spaceId:e.spaceId}}var b=()=>o(179034),h=()=>o(63128),x=()=>o(919709),T=()=>o(498212),w=()=>o(246826),_=()=>o(319975),C=()=>o(709274);function M(e){const{environment:t,transaction:o,channelStore:r,collectionStore:i,intl:c}=e,l=r.pointer,d=l.spaceId,f=l.id,M=f,j=f,{schema:V,createdTimeId:A}=function(e){const t=(0,u().Ay)();return{schema:{title:{type:"title",name:e.formatMessage(S.postHeadingName)},[(0,u().Ay)()]:{type:"created_by",name:e.formatMessage(S.createdBy)},[t]:{type:"created_time",name:e.formatMessage(S.createdTime)}},createdTimeId:t}}(c),N=m().op.update({pointer:{id:f,table:n().Vl,spaceId:d},path:[],args:{id:M,space_id:d,name:[[c.formatMessage(C().D.postsCollectionTitle)]],schema:V,parent_id:j,parent_table:b().ev,alive:!0,version:0}}),k=(0,T().Ay)();s().applyOperation({store:i,operation:N,transaction:o});const B={id:k,table:a().Gy,spaceId:d},D={id:j,table:b().ev,spaceId:d},K=m().op.update({pointer:B,path:[],args:{id:k,version:5,type:g,parent_id:j,parent_table:b().ev,space_id:d,alive:!0,name:void 0,query2:{sort:[v(A)]},format:{...y,collection_pointer:I({collectionId:M,spaceId:d})}}}),z=p().Bv.createChildStore(r,D),H=p().pS.createChildStore(z,B);s().applyOperation({store:H,operation:K,transaction:o});const O=m().op.update({pointer:z.pointer,path:[],args:{id:j,type:"collection_view_page",version:1,alive:!0,parent_id:f,parent_table:h().Ay,space_id:d,view_ids:[k]}});s().applyOperation({store:z,operation:O,transaction:o});const R=z.getTitleStore();R&&_().R9({environment:t,store:R,value:(0,x().x9d)(c.formatMessage(C().D.postsCollectionViewPageTitle)),transaction:o}),w().zv({store:z.getFormatStore(),data:{collection_pointer:I({collectionId:M,spaceId:d})},transaction:o})}function j(e){const{environment:t,selectedStore:o,currentSpaceViewStore:u,collectionContextStore:S,postStore:g}=e,f=l().A.getIntl();if(!S)return;const y=S.collectionViewStore(),v=S.collectionViewBlockStore();if(!y||!v||!u)return;const I=o.table===r().yK?o.id:void 0,b=d().default.state.currentSpaceStore;if(!b)return;const h=null==o?void 0:o.getChannelStore();if(!h)return;const x=p().sk.createUniqueRootStore(t,{table:"block",id:null==h?void 0:h.id,spaceId:b.id}),T=null==x?void 0:x.getCollectionStore();s().createAndCommit({environment:t,userAction:"PersonalHomeFeedTab.setCollectionViewSourceTeamId",canUndo:!0,perform:e=>{const r={id:h.id,table:n().Vl,spaceId:b.id},l=p().md.createChildStore(h,r);T||(!function(e){const{transaction:t,parent:o,channelStore:n}=e,a=m().op.update({pointer:n.pointer,path:[],args:{id:n.id,parent_id:o.id,parent_table:o.table,space_id:o.spaceId}});s().applyOperation({store:n,operation:a,transaction:t})}({transaction:e,parent:o.pointer,channelStore:h}),M({environment:t,transaction:e,collectionStore:l,channelStore:h,intl:f}),(0,c().d)({environment:t,collectionViewStore:y,collectionViewBlockStore:v,collectionStore:l,collectionContextStore:S,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1,viewsModuleContext:void 0})),g&&i().X$({childStore:g,parentStore:T??l,transaction:e}),s().applyOperation({store:y,operation:{pointer:{id:y.id,table:a().Gy},path:["format","collection_view_source","teamId"],command:"set",args:I},transaction:e})}})}}}]);