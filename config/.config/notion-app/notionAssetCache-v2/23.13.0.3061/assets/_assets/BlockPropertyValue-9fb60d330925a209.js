"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[43380],{29247:(e,t,o)=>{o.d(t,{m:()=>Kr});var n=o(296540),r=()=>o(847249),i=()=>o(175116),l=()=>o(458366),a=()=>o(484714),s=()=>o(401497),c=()=>o(716016),u=()=>o(713998),d=()=>o(705516),p=()=>o(494585),y=()=>o(234359),m=()=>o(41459),f=()=>o(828180),S=()=>o(512321),h=()=>o(88306),x=o(474848);const b=n.memo((0,n.forwardRef)((function(e,t){const{store:o,collectionStore:i,buttonStyle:l,onContextMenu:a,quickActionButtons:d,property:m}=e,{baseStyles:f}=(0,n.useContext)(y().L8),S=(0,r().K8)((()=>{var e;const t=o.getPropertyValue(m),n=null==i||null===(e=i.getRecordKeyStore())||void 0===e?void 0:e.getRecordKey(),r=(0,u().On)(t);return void 0===r?"...":(0,c().H4)(n,r)}),[i,m,o]),b=(0,s().IS)((()=>({buttonStyle:{...f.buttonStyle,...l},buttonPressedStyle:f.buttonPressedStyle??{},buttonHoveredStyle:f.buttonHoveredStyle??{}})),[f.buttonHoveredStyle,f.buttonPressedStyle,f.buttonStyle,l]);return(0,x.jsx)(p().P,{ref:t,style:b.buttonStyle,hoveredStyle:b.buttonHoveredStyle,pressedStyle:b.buttonPressedStyle,onContextMenu:a,quickActionButtons:d,editButtonClickProps:void 0,children:(0,x.jsx)(h().C,{fontColor:"light",children:S})})}))),v=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].text}})),[]),a=(0,n.useMemo)((()=>(0,x.jsx)(d().i,{store:o,property:r,format:i})),[i,r,o]),c=R(e,t,l);return(0,x.jsx)(b,{...c,quickActionButtons:a})})),g=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),c=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].text}})),[]),u=(0,n.useMemo)((()=>{if(!l)return(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")}),[i,l,r,o]),p=R(e,t,c);return(0,x.jsx)(b,{...p,quickActionButtons:u})})),k=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),c=R(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].text}})),[])),u=(0,n.useMemo)((()=>{if(!l)return(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")}),[i,l,r,o]);return(0,x.jsx)(b,{...c,quickActionButtons:u})})),C=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,x.jsx)(b,{...o})})),w=(0,n.forwardRef)((function(e,t){const o=R(e,t,(0,S().F)(t,e.collectionStore,e.property,"auto_increment_id"));return(0,x.jsx)(b,{...o})})),j=(0,n.forwardRef)((function(e,t){const o=R(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].text}})),[]));return(0,x.jsx)(b,{...o})})),P=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,x.jsx)(b,{...o})})),I=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,x.jsx)(b,{...o})})),_=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,x.jsx)(b,{...o})})),A=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,x.jsx)(b,{...o})})),B=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,x.jsx)(b,{...o})}));function R(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l}=e;return{ref:t,store:n,collectionStore:r,property:i,onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle}}var M=()=>o(959013),E=()=>o(973647),T=()=>o(534177),L=()=>o(813297),V=()=>o(862292),F=()=>o(157857),O=()=>o(972435),H=()=>o(645873),W=()=>o(630116),D=()=>o(19794),K=()=>o(864943),U=()=>o(859428);const N=n.memo((0,n.forwardRef)((function(e,t){const{store:i,property:l,collectionStore:c,buttonStyle:u,innerButtonStyle:d,onContextMenu:m,disabled:f}=e,[S,h]=(0,n.useState)(!1),b=(0,a().v3)(),{baseStyles:v,propertySchema:g,collectionContextStore:k}=(0,n.useContext)(y().L8),C=g,w=(null==v?void 0:v.sizing)??"default",{value:j}=(0,H().fJ)(V().T.formulas),{value:P}=(0,H().fJ)(L().QV.automationTypecheck),{value:I}=(0,H().fJ)(L().QV.automationActionRegistry),_=(0,r().K8)((()=>{if(null!=C&&C.automation_id)return W().dn.createChildStore(c,{table:o(912720).yB,id:C.automation_id,spaceId:c.getSpaceId()})}),[c,C]),A=(0,o(76190).n)(_),B=(0,r().K8)((()=>null==k?void 0:k.settingsStore),[k]),R=(0,r().K8)((()=>{const e=b.currentUser.id;if(j&&P&&I&&k&&"button"===(null==C?void 0:C.type)&&C.automation_id&&i.isPageBlock()&&_)return{type:"button_property",persisted:!0,automationStore:_,collectionContextStore:k,propertyId:l,propertySchema:C,intl:O().A.getIntl(),parentRecordStore:_,currentUserId:e,pageStore:i,formulasModule:j,isLoggedIn:b.currentUser.isLoggedIn(),automationTypecheckModule:P,automationActionRegistryModule:I}}),[b.currentUser,j,P,I,k,C,i,_,l]),N=!(0,r().O$)(o(227440).e),{isDisabled:z,hasError:Q}=(0,r().K8)((()=>{if(N||!R)return{isDisabled:!0,hasError:!1};const e=(0,F().lp)({environment:b,isSubscribed:A,...R}).state,t="sufficient"===e.executionPermissionStatus;return{isDisabled:f||!t||!i.canEdit()||S,hasError:(0,T().O9)(e.typecheckResult)&&E().Q.isSuccess(e.typecheckResult)&&(0,o(352271).x4)(e.typecheckResult.value)}}),[b,f,R,i,S,A,N]),J=(0,n.useCallback)((async()=>{if(R)if(Q)k&&B&&C&&o(837570).h({environment:b,mode:"edit_button_property",collectionSettingsStore:B,collectionContextStore:k,propertyId:l,propertySchema:C});else try{var e;h(!0);const{automationExecutionActions:t}=await L().QV.automations.load();await t.executeClientAutomation({environment:b,clientContext:R}),null!==(e=b.mobileNative)&&void 0!==e&&e.buzz?b.mobileNative.buzz():window.navigator.vibrate(20)}finally{h(!1)}}),[R,k,B,b,Q,l,C]),q=(0,r().K8)((()=>(null==R?void 0:R.automationStore.getNameStore().getValue())??(null==C?void 0:C.name)),[null==R?void 0:R.automationStore,null==C?void 0:C.name]),Y=(0,r().K8)((()=>{if(!b.device.isMobile)return(0,F().nD)(null==R?void 0:R.automationStore)}),[R,b]),$=!q||0===q.length,G=(0,s().IS)((e=>({buttonStyle:{...v.buttonStyle,...u},buttonPressedStyle:v.buttonPressedStyle??{},buttonHoveredStyle:v.buttonHoveredStyle??{},innerButtonStyle:{pointerEvents:"auto",overflow:"hidden",height:"small"===w?20:24,paddingLeft:6,paddingRight:6,...d},innerButtonLabelStyle:{overflow:"hidden",textOverflow:"ellipsis",color:$?e.text.tertiary:void 0},buttonColors:(0,o(100622).eA)("default",e)})),[v.buttonHoveredStyle,v.buttonPressedStyle,v.buttonStyle,u,d,$,w]),Z=e=>(0,x.jsx)(K().A,{backgroundColor:G.buttonColors.background,disabled:z,disabledFeedback:!0,hoveredBackgroundColor:G.buttonColors.hoveredBackground,size:"sm",onClick:J,pressedBackgroundColor:G.buttonColors.pressedBackground,style:G.innerButtonStyle,...e,children:(0,x.jsx)("span",{style:G.innerButtonLabelStyle,children:$?(0,x.jsx)(M().sA,{...D().y.buttonPlaceholder}):q})});return(0,x.jsx)(p().P,{ref:t,style:G.buttonStyle,hoveredStyle:G.buttonHoveredStyle,pressedStyle:G.buttonPressedStyle,editButtonClickProps:void 0,onContextMenu:m,tooltipHide:(0,T().O9)(Y),tooltipPropertyValue:N?(0,x.jsx)(M().sA,{...o(416726).AY.unavailableOfflineTooltip}):void 0,children:Q?(0,x.jsx)(U().A,{placement:o(962730).W.Right,renderTooltip:()=>(0,x.jsx)(L().Od,{content:(0,x.jsx)(M().sA,{...o(913687).A.buttonPropertyErrorTooltip}),subtitle:(0,x.jsx)(M().sA,{...D().y.clickToEdit})}),render:Z}):Y?(0,x.jsx)(L().Vp,{parentStore:i,urlToPreview:Y,renderOrigin:Z}):Z()})}))),z=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].button},innerButtonStyle:{maxWidth:"100%"}})),[]));return(0,x.jsx)(N,{...o})})),Q=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].button}})),[]));return(0,x.jsx)(N,{...o})})),J=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].button}})),[]));return(0,x.jsx)(N,{...o})})),q=(0,n.forwardRef)((function(e,t){const o=oe(e,t);return(0,x.jsx)(N,{...o})})),Y=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,S().F)(t,e.collectionStore,e.property,"button"));return(0,x.jsx)(N,{...o})})),$=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].button}})),[]));return(0,x.jsx)(N,{...o})})),G=(0,n.forwardRef)((function(e,t){const o=oe(e,t);return(0,x.jsx)(N,{...o})})),Z=(0,n.forwardRef)((function(e,t){const o=oe(e,t);return(0,x.jsx)(N,{...o})})),X=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,s().IS)((()=>({buttonStyle:{maxWidth:200}})),[]));return(0,x.jsx)(N,{...o})})),ee=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,s().IS)((()=>({buttonStyle:{height:void 0}})),[]));return(0,x.jsx)(N,{...o})})),te=(0,n.forwardRef)((function(e,t){const o=oe(e,t);return(0,x.jsx)(N,{...o})}));function oe(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,innerButtonStyle:null==o?void 0:o.innerButtonStyle}}var ne=()=>o(443239),re=()=>o(299709),ie=()=>o(522986),le=()=>o(751156),ae=()=>o(414712),se=()=>o(355594);const ce=n.memo(n.forwardRef((function(e,t){const{store:o,property:i,enablePointerEventsForInteractiveTypes:c,editButtonClickProps:d,onClick:m,onContextMenu:f,buttonStyle:S,showLabel:h,disabled:b}=e,v=(0,a().v3)(),g=(0,r().K8)((()=>u().wu(o.getPropertyValue(i))),[i,o]),{baseStyles:k,propertySchema:C,format:w,collectionContextStore:j}=(0,n.useContext)(y().L8),P=ue(o,i,b),I=C,_=(0,n.useCallback)((()=>{const e=o.getPropertyStore(i);e&&j&&(le().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:v,canUndo:!0,perform:e=>{ie().qS({stores:[o],property:i,transaction:e})}}),(0,re().E)({environment:v,collectionContextStore:j,block_id:e.id,property:i,property_type:"checkbox",from:(0,l().zP)(w),isFromBulkActionsToolbar:!1})),m&&m()}),[j,v,w,m,i,o]),A=(0,s().IS)((()=>({buttonStyle:{...k.buttonStyle,...S},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k,S]);return(0,x.jsx)(p().P,{ref:t,onContextMenu:f,editButtonClickProps:d,style:A.buttonStyle,hoveredStyle:A.buttonHoveredStyle,pressedStyle:A.buttonPressedStyle,children:(0,x.jsx)(se().o,{propertyLabel:h?null==I?void 0:I.name:void 0,checked:g,enablePointerEventsForInteractiveTypes:c,onClick:_,disabled:P,store:o,property:i})})})));function ue(e,t,o){return(0,r().K8)((()=>o||!e.canEdit()||(0,ne().u)(t)||e.isNonEditableState()),[o,t,e])}const de=n.forwardRef((function(e,t){const o=ke(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].checkbox}})),[]));return(0,x.jsx)(ce,{...o,showLabel:!1})})),pe=n.forwardRef((function(e,t){const o=ke(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].checkbox}})),[]));return(0,x.jsx)(ce,{...o,showLabel:!1,collectionStore:e.collectionStore})})),ye=n.forwardRef((function(e,t){const o=ke(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].checkbox}})),[]));return(0,x.jsx)(ce,{...o,showLabel:!1})})),me=n.forwardRef((function(e,t){const o=ke(e,t,(0,s().IS)((()=>({buttonStyle:{minWidth:"fit-content"}})),[]));return(0,x.jsx)(ce,{...o,showLabel:!1})})),fe=n.forwardRef((function(e,t){const o=ke(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].checkbox,width:"unset"}})),[]));return(0,x.jsx)(ce,{...o,showLabel:!0})})),Se=n.forwardRef((function(e,t){const o=ke(e,t);return(0,x.jsx)(ce,{...o,showLabel:!0})})),he=n.forwardRef((function(e,t){const o=ke(e,t,(0,s().IS)((()=>({buttonStyle:{width:"unset",minWidth:"unset"}})),[]));return(0,x.jsx)(ce,{...o,showLabel:!0})})),xe=n.forwardRef((function(e,t){const o=ke(e,t);return(0,x.jsx)(ce,{...o,showLabel:!1})})),be=n.forwardRef((function(e,t){const o=ke(e,t);return(0,x.jsx)(ce,{...o,showLabel:!1})})),ve=n.forwardRef((function(e,t){const o=ke(e,t);return(0,x.jsx)(ce,{...o,showLabel:!1})})),ge=n.forwardRef((function(e,t){const o=ke(e,t);return(0,x.jsx)(ce,{...o,showLabel:!1})}));function ke(e,t,o){const{store:n,disabled:r,collectionStore:i,property:l,enablePointerEventsForInteractiveTypes:a,onClick:s,onContextMenu:c}=e;return{ref:t,store:n,disabled:r,collectionStore:i,property:l,editButtonClickProps:(0,ae().QK)(e),enablePointerEventsForInteractiveTypes:a,onClick:s,onContextMenu:c,buttonStyle:null==o?void 0:o.buttonStyle}}var Ce=()=>o(477660);const we={contactVisitButton:new(H().O2)("contactVisitButton",(()=>Promise.all([o.e(43380),o.e(82970)]).then(o.bind(o,598598))))},je=(0,H()._h)(we.contactVisitButton,(e=>e.default));var Pe=()=>o(821300),Ie=()=>o(859118);const _e=n.memo(n.forwardRef((function(e,t){const{onContextMenu:i,editButtonClickProps:l,property:a,store:c,buttonStyle:u,EmptyComponent:d,quickActionButtons:m=[],showIfEmpty:f,width:S,disableLinkify:b,userExpandable:v}=e,{propertySchema:g,baseStyles:k}=(0,n.useContext)(y().L8),C=(0,Ce().z)(g),w=(0,r().K8)((()=>c.getPropertyValue(a)),[a,c]),j=(0,r().K8)((()=>!(!C||"url"!==C.type)&&!C.show_full_url),[C]),P=(0,s().IS)((()=>({buttonStyle:{...k.buttonStyle,...u},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,u]);return null!=w&&w.length||void 0!==d?(0,x.jsx)(p().P,{ref:t,editButtonClickProps:l,onContextMenu:i,style:P.buttonStyle,pressedStyle:P.buttonPressedStyle,hoveredStyle:P.buttonHoveredStyle,quickActionButtons:m,width:S,userExpandable:v,children:null!=w&&w.length||void 0===d?C?(0,x.jsx)(h().C,{children:(0,x.jsx)(o(768407).LE,{type:C.type,textValue:w,useShortenedUrl:j,disableLinkify:f||b,store:c,property:a})}):null:(0,x.jsx)(d,{})}):null}))),Ae=n.forwardRef((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),{shouldWrap:c}=(0,n.useContext)(y().L8),u=(0,n.useMemo)((()=>{if(!l)return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Pe().k,{},"comment"),(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})}),[i,l,r,o]),p=We(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].text}})),[]));return(0,x.jsx)(_e,{...p,EmptyComponent:Ie().rW,quickActionButtons:u,userExpandable:c})})),Be=n.forwardRef((function(e,t){const{store:o,property:r,format:i}=e,l=(0,n.useMemo)((()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Pe().k,{},"comment"),(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})),[i,r,o]),a=We(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].text}})),[]));return(0,x.jsx)(_e,{...a,EmptyComponent:Ie().ao,quickActionButtons:l})})),Re=n.forwardRef((function(e,t){const{store:o,property:r,format:i}=e,l=We(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].text}})),[])),a=(0,n.useMemo)((()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Pe().k,{},"comment"),(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy"),(0,x.jsx)(je,{},"visit")]})),[i,r,o]);return(0,x.jsx)(_e,{...l,EmptyComponent:Ie().ao,quickActionButtons:a,disableLinkify:!0})})),Me=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=We(e,t,(0,S().F)(t,e.collectionStore,e.property,"phone_number"));return(0,x.jsx)(_e,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Ee=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=We(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].text}})),[]));return(0,x.jsx)(_e,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Te=n.forwardRef((function(e,t){const o=We(e,t);return(0,x.jsx)(_e,{...o})})),Le=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=We(e,t);return(0,x.jsx)(_e,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Ve=n.forwardRef((function(e,t){const o=We(e,t);return(0,x.jsx)(_e,{...o})})),Fe=n.forwardRef((function(e,t){const o=We(e,t);return(0,x.jsx)(_e,{...o})})),Oe=n.forwardRef((function(e,t){const o=We(e,t);return(0,x.jsx)(_e,{...o})})),He=n.forwardRef((function(e,t){const o=We(e,t);return(0,x.jsx)(_e,{...o,EmptyComponent:Ie().Fe,showIfEmpty:!0})}));function We(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ae().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}var De=()=>o(712796),Ke=(o(581454),()=>o(191772)),Ue=()=>o(425497),Ne=()=>o(171722),ze=()=>o(167677);const Qe=n.memo(n.forwardRef((function(e,t){const{store:i,EmptyComponent:l,onContextMenu:c,buttonStyle:d,selectableStyle:m,property:f,editButtonClickProps:S,quickActionButtons:h,width:b,shouldDisableLinks:v,shouldTruncateToSingleLine:g,shouldLockImageAspectRatio:k,userExpandable:C}=e,w=(0,a().v3)(),{baseStyles:j,collectionContextStore:P,canEdit:I}=(0,n.useContext)(y().L8),[_,A]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{A(i.clone())}),[i]);const B=(0,n.useCallback)((e=>{ie().ho({environment:w,blockPropertyValueOverlayStore:S.blockPropertyValueOverlayStore,store:i,property:f,format:S.format,uploadFiles:e.files,disableHorizontalEdgeScroll:S.disableHorizontalEdgeScroll,collectionContextStore:P})}),[P,S.blockPropertyValueOverlayStore,S.disableHorizontalEdgeScroll,S.format,w,f,i]),R=(0,r().K8)((()=>{const e=i.getPropertyValue(f);return u().pJ(e)}),[i,f]),M=(0,s().IS)((()=>{var e;return{buttonStyle:{...j.buttonStyle,...d},buttonPressedStyle:j.buttonPressedStyle??{},buttonHoveredStyle:j.buttonHoveredStyle??{},selectableStyle:{display:"inherit",borderRadius:null===(e=j.buttonStyle)||void 0===e?void 0:e.borderRadius,...m}}}),[j.buttonHoveredStyle,j.buttonPressedStyle,j.buttonStyle,d,m]),E=!R||0===R.length,T=E&&void 0!==l,L=!E;return _&&(T||L)?(0,x.jsx)(o(199896).A,{store:_,canNativeDropOnto:I,onNativeDrop:B,analyticsName:"file_property",shouldShowDropZone:I,style:M.selectableStyle,children:(0,x.jsxs)(p().P,{ref:t,onContextMenu:c,editButtonClickProps:S,style:M.buttonStyle,pressedStyle:M.buttonPressedStyle,hoveredStyle:M.buttonHoveredStyle,quickActionButtons:h,width:b,forceEnableButton:g,userExpandable:C,children:[T&&(0,x.jsx)(l,{}),L&&(0,x.jsx)(Je,{store:i,links:R,property:f,shouldTruncateToSingleLine:g,shouldDisableLinks:v,shouldLockImageAspectRatio:k,tokenFormat:(0,Ue().Ug)(null==j?void 0:j.tokenFormat)})]})}):null}))),Je=n.memo((function(e){let{store:t,links:n,property:r,shouldTruncateToSingleLine:i=!1,shouldDisableLinks:l=!1,shouldLockImageAspectRatio:a=!1,tokenFormat:c}=e;const u=i?3:void 0,d=(0,Ne().s)({propertyId:r,store:t}),p=Boolean(d),y=(0,s().IS)((e=>({wrapperStyle:{...p?{...(0,Ke().sQ)(e),padding:4,lineHeight:2,...!i&&{flexWrap:"wrap",display:"inline-flex"}}:{}},moreToken:{margin:0,flexShrink:0}})),[p,i]),m=u&&n.length>u?n.slice(0,u):n,f=m.length<n.length?n.length-m.length:0;return(0,x.jsxs)(ze().h,{style:y.wrapperStyle,className:d,children:[m.map(((e,n)=>(0,x.jsx)(o(736433).X,{linkValue:e,store:t,shouldDisableLinks:l,shouldLockImageAspectRatio:a},e.url+n))),f>0&&(0,x.jsx)(o(317958).A,{count:f,format:c,style:y.moreToken,fixedHeight:!0,isCompact:!0})]})})),qe=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(y().L8),r=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].button,height:"100%"},selectableStyle:{width:"100%"}})),[]),i=(0,n.useMemo)((()=>(0,x.jsx)(Pe().k,{},"comment")),[]),l=lt(e,t,r);return(0,x.jsx)(Qe,{...l,EmptyComponent:Ie().rW,quickActionButtons:i,userExpandable:o})})),Ye=n.forwardRef((function(e,t){const o=lt(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].button,width:"100%"},selectableStyle:{width:"100%"}})),[])),r=(0,n.useMemo)((()=>(0,x.jsx)(Pe().k,{},"comment")),[]);return(0,x.jsx)(Qe,{...o,EmptyComponent:Ie().ao,quickActionButtons:r})})),$e=n.forwardRef((function(e,t){const o=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].button}})),[]),r=(0,n.useMemo)((()=>(0,x.jsx)(Pe().k,{},"comment")),[]),i=lt(e,t,o);return(0,x.jsx)(Qe,{...i,EmptyComponent:Ie().ao,quickActionButtons:r,shouldDisableLinks:!0,shouldLockImageAspectRatio:!0,shouldTruncateToSingleLine:!0})})),Ge=n.forwardRef((function(e,t){const o=lt(e,t);return(0,x.jsx)(Qe,{...o,EmptyComponent:Ie().Fe,shouldDisableLinks:!0})})),Ze=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=lt(e,t,(0,S().F)(t,e.collectionStore,e.property,"file"));return(0,x.jsx)(Qe,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Xe=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=lt(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].button,width:"100%"},selectableStyle:{width:"100%"}})),[]));return(0,x.jsx)(Qe,{...n,EmptyComponent:o?Ie().Jb:void 0})})),et=n.forwardRef((function(e,t){const o=lt(e,t);return(0,x.jsx)(Qe,{...o})})),tt=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=lt(e,t);return(0,x.jsx)(Qe,{...n,EmptyComponent:o?Ie().Jb:void 0})})),ot=n.forwardRef((function(e,t){const o=lt(e,t);return(0,x.jsx)(Qe,{...o})})),nt=n.forwardRef((function(e,t){const o=lt(e,t);return(0,x.jsx)(Qe,{...o})})),rt=n.forwardRef((function(e,t){const o=lt(e,t);return(0,x.jsx)(Qe,{...o})})),it=n.forwardRef((function(e,t){return(0,x.jsx)(o(3079).H,{...e,ref:t,children:(0,x.jsx)(o(555439)._,{...e})})}));function lt(e,t,o){const{store:n,onContextMenu:r,property:i,width:l}=e;return{ref:t,store:n,property:i,editButtonClickProps:(0,ae().QK)(e),onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle,selectableStyle:null==o?void 0:o.selectableStyle,width:l}}o(16280),o(898992),o(354520);var at=()=>o(852507),st=()=>o(708685),ct=()=>o(597777),ut=()=>o(869190),dt=()=>o(416504),pt=()=>o(284371),yt=()=>o(847743),mt=()=>o(508496),ft=(o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),()=>o(496506)),St=()=>o(247331),ht=()=>o(349835),xt=()=>o(319625),bt=()=>o(909470),vt=()=>o(991114),gt=()=>o(792415),kt=()=>o(792071),Ct=()=>o(813690);function wt(e,t){let o=!1;return[t(kt().b4_.fromMonomorphicFunctionUnsafe((t=>{const n=e.getRecordStore(e,t);return n.isReady()||(o=!0),n.getModel()}),Ct().xb.fromMonomorphicFunctionUnsafe((t=>{const n=e.getRecordStore(e,t);return n.isReady()||(o=!0),n.getValue()})))),o]}function jt(e){const t=function(e){const{blockStore:t,collectionStore:o,propertyId:n}=e,{value:l}=(0,H().fJ)(V().T.formulas),a=(0,vt().C)(),s=(0,M().tz)(),c=(0,i().Ks)(),[u,d]=(0,r().K8)((()=>{var e;return[t.getModel(),null===(e=o.getModel())||void 0===e?void 0:e.getVersion()]}),[t,o]);if(!l)return Pt;if((0,T().O9)(d)&&(0,T().O9)(u)){const e=l.getFormula2Thunk({blockModel:u,collectionVersion:d,propertyId:n});if(e)return e}const p=new(ft().default)((()=>{var e;const r=o.getSchema(),i=null==r?void 0:r[n];if(!i||"formula"!==i.type||"v2"!==i.version)return;const u=null===(e=i.formula2)||void 0===e?void 0:e.code;if(!u)return{value:{type:"undefined"}};if(!t.isDefined())return St().FORMULA_LOADING;const d=t.getModel(),p=gt().A.state.publicPageData,[y,m]=wt(t,(e=>l.evaluateCollectionFormula2WithoutCache({block:d,collectionFeatureGates:(0,bt().i)(),depth:0,formulaCode:u,formulaTimeoutTimestampMs:Date.now()+a,getRecordModel:e,intl:s,property:n,experimentService:mt().default,publicPageDataCollection:{id:null==p?void 0:p.collectionId,schema:null==p?void 0:p.collectionSchema},regExpCache:new Map,resultCache:new Map,userTimeZone:(0,dt().P)(),visitedProperties:new Set})));if(m){const e=It({collectionContextStore:c,blockId:t.id,propertyId:n,formulasModule:l});return e?{value:e}:St().FORMULA_LOADING}return(0,T().O9)(y)?E().Q.isFail(y)?{type:y.error.type,error:y.error}:{value:y.value}:{error:{type:ht().uW.UnexpectedError,error:(0,xt().A)(void 0)}}}),{debugName:`formula2Evaluation${t.id}`,useDeepEqual:!0}),y=()=>p.getState();(0,T().O9)(d)&&(0,T().O9)(u)&&l.setFormula2Thunk({blockModel:u,collectionVersion:d,propertyId:n,thunkCallback:y});return y}(e);return(0,r().K8)((()=>{if(!yt().Pe&&t)return t()}),[t],{debugName:`formula2Evaluation${e.blockStore.id}`,useDeepEqual:!0})}function Pt(){return St().FORMULA_LOADING}function It(e){const{collectionContextStore:t,blockId:o,propertyId:n,formulasModule:r}=e,i=null==t?void 0:t.resultSetStore.state.propertyResultCache;if(!(0,T().O9)(i))return;const l=r.getFormula2ResultCache({resultCache:i,blockId:o,property:n});return(0,T().O9)(l)?r.formulaValueToCollectionFormulaValue(l):void 0}var _t=()=>o(710149);function At(e){const t=(0,s().IS)((t=>({shimmer:{width:"60%",marginTop:6,height:10,flexShrink:0,borderRadius:12,backgroundColor:t.lightDividerColor,...e.style}})),[e.style]);return(0,x.jsx)(_t().A,{style:t.shimmer})}var Bt=()=>o(942504);var Rt=()=>o(886578);const Mt=[ht().uW.MaxEvaluationTimeExceeded,ht().uW.DepthExceeded,ht().uW.CycleDetected];function Et(e){const{blockStore:t,formula2Result:o,legacyFormulaResult:n,propertySchema:i}=e;return(0,r().K8)((()=>{if(!i)return[[],"empty"];var e,r;if("v2"!==i.version)return n?n===St().FORMULA_LOADING?[[],"loading"]:[Gt(n),(null===(e=i.formula)||void 0===e?void 0:e.result_type)??"text"]:[[],"empty"];if(void 0===o)return[[],"empty"];if(o===St().FORMULA_LOADING)return[[],"loading"];if(E().Q.isFail(o))return r=o.error,Mt.includes(r.type)?[[{id:"error",type:"error",value:o.error}],"error"]:[[],"formula"];if(E().Q.isSuccess(o)){var l;const e=(0,Rt().O)(o.value,t.getRecordModel,(0,dt().P)());return[e,(null===(l=e[0])||void 0===l?void 0:l.type)??"text"]}(0,T().HB)(o)}),[t,o,n,i])}const Tt=n.memo(n.forwardRef((function(e,t){var o,i;const{store:l,property:a,EmptyComponent:c,collectionStore:u,onContextMenu:d,editButtonClickProps:f,checkboxButtonStyle:S,textButtonStyle:b,quickActionButtons:v,checkboxShowLabel:g,userExpandable:k}=e,{baseStyles:C,propertySchema:w,format:j}=(0,n.useContext)(y().L8),P=w,I="v2"===(null==P?void 0:P.version)?null==P||null===(o=P.formula2)||void 0===o?void 0:o.result_type.type:null==P||null===(i=P.formula)||void 0===i?void 0:i.result_type,_=!0===e.numberRightAlign&&"number"===(0,st().getFormulaPropertySchemaBaseResultType)(P),[A,B]=function(e){const{store:t,collectionStore:o,property:i,checkboxShowLabel:l,numberRightAlign:a}=e,{propertySchema:s,format:c,collectionSchema:u}=(0,n.useContext)(y().L8);!function(e){if(void 0===e||"formula"===e.type)return;throw new Error(`Expected a formula property schema, got ${e.type}`)}(s);const d=function(e){const{blockStore:t,collectionSchema:o,propertyId:n,propertySchema:i}=e,{value:l}=(0,H().fJ)(V().T.formulas),a=(0,vt().C)(),s=(0,M().tz)();return(0,r().K8)((()=>{if(!i||"v2"===i.version)return;if(!l||!o||!t.isDefined())return St().FORMULA_LOADING;const e=(0,bt().i)(),r=(0,dt().P)(),[c,u]=wt(t,(i=>l.evaluateFormulaProperty({block:t.getModel(),collectionRequestContext:{collectionFeatureGates:e,depth:0,experimentService:mt().default,formulaTimeoutTimestampMs:Date.now()+a,intl:s,regExpCache:new Map,resultCache:new Map,userId:void 0,userTimeZone:r,visitedProperties:new Set},getRecordModel:i,property:n,schema:o})));return u?St().FORMULA_LOADING:c}),[i,l,o,t,a,s,n],{debugName:`legacyFormulaEvaluation${t.id}`})}({blockStore:t,collectionSchema:u,propertyId:i,propertySchema:s}),p=jt({blockStore:t,collectionStore:o,propertyId:i}),f=Et({blockStore:t,formula2Result:p,legacyFormulaResult:d,propertySchema:s}),S="loading"===f[1],h=function(e){const{blockStore:t,checkboxShowLabel:o,format:n,formulaTokenData:i,numberRightAlign:l,propertyId:a,propertySchema:s}=e;return(0,r().K8)((()=>{const[e,r]=i;if("loading"===r)return(0,x.jsx)(At,{style:{justifyContent:l?"flex-end":void 0}});if(0===e.length)return null;const c=o&&"checkbox"===(0,st().getFormulaPropertySchemaResultType)(s)&&1===e.length?null==s?void 0:s.name:void 0,u=!!s&&(0,Bt().GL)(r,s),d=1===e.length;return s&&(0,x.jsx)(Bt().Ye,{propertyType:r,rootPropertySchema:s,numberRightAlign:l,store:t,property_id:a,children:e.map(((o,r)=>(0,x.jsx)(Bt().yZ,{token:o,targetPropertySchema:s,blockStore:t,checkboxPropertyLabel:c,withComma:u&&r<e.length-1,numberRightAlign:l,shouldTruncate:d&&n===m().j.CompactPage,disableLinks:n===m().j.CompactPage},`${o.id}-${r}`)))})}),[i,o,s,l,t,a,n])}({blockStore:t,checkboxShowLabel:l,format:c,formulaTokenData:f,numberRightAlign:a,propertyId:i,propertySchema:s});return[h,S]}({checkboxShowLabel:Boolean(g),collectionStore:u,numberRightAlign:Boolean(_),property:a,store:l});!function(e){const{pageId:t,propertyId:o,isLoading:r}=e,{collectionContextStore:i}=(0,n.useContext)(y().L8);(0,at().w)((()=>{var e;null==i||null===(e=i.propertyResultDurationTracker)||void 0===e||e.trackMount({pageId:t,propertyId:o,propertyType:"formula"})})),(0,n.useEffect)((()=>{if(!r){const e=performance.now();async function n(){var n;const r=await V().T.formulas.load();null==i||null===(n=i.propertyResultDurationTracker)||void 0===n||n.trackResult({pageId:t,propertyId:o,propertyType:"formula",endTime:e,context:{formula_property_cache_result_available:(0,T().O9)(It({collectionContextStore:i,blockId:t,propertyId:o,formulasModule:r})),formula_property_cache_gate_enabled:mt().default.checkGate({gateName:"formulas_use_forwarded_property_cache_gate"})}})}n()}}),[i,r,t,o])}({pageId:l.id,propertyId:a,isLoading:B});const R=(0,s().IS)((e=>({buttonStyle:{...C.buttonStyle,..."checkbox"===I?S:{},..."number"===I||"date"===I||"text"===I?b:{}},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C.buttonHoveredStyle,C.buttonPressedStyle,C.buttonStyle,S,I,b]),E=(0,Ne().s)({propertyId:a,store:l});if(yt().Pe)return(0,x.jsx)("div",{style:{padding:"5px 8px"},children:(0,x.jsx)(h().C,{fontColor:"light",children:(0,x.jsx)(M().sA,{defaultMessage:"Disabled",id:"database.pageProperty.disableFormulas"})})});const L=null===A;return L&&void 0===c?null:(0,x.jsxs)(p().P,{ref:t,className:E,onContextMenu:d,editButtonClickProps:f,style:R.buttonStyle,pressedStyle:R.buttonPressedStyle,hoveredStyle:R.buttonHoveredStyle,quickActionButtons:!B&&v?(0,x.jsx)(Lt,{buttons:v,store:l,collectionStore:u,property:a,format:j,isEmpty:L}):void 0,quickActionButtonsAlign:_?"left":void 0,userExpandable:k,children:[L&&c&&(0,x.jsx)(c,{}),!L&&A]})})));function Lt(e){const{buttons:t,store:o,property:n,format:r,isEmpty:i}=e;if(i)return null;const l=t.map((e=>{switch(e){case"copy":return(0,x.jsx)(d().i,{store:o,property:n,format:r},"copy");case"comment":return(0,x.jsx)(Pe().k,{},"comment");default:(0,T().HB)(e)}})).filter(T().Pe);return l?(0,x.jsx)(x.Fragment,{children:l}):null}const Vt=["comment","copy"],Ft=n.forwardRef((function(e,t){const{isMobile:o}=(0,a().Y0)(),{shouldWrap:r}=(0,n.useContext)(y().L8),i=$t(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.Table].checkbox},textButtonStyle:{padding:f().QJ[m().j.Table].text}})),[]));return(0,x.jsx)(Tt,{...i,numberRightAlign:!0,EmptyComponent:Ie().rW,quickActionButtons:o?void 0:Vt,userExpandable:r})})),Ot=["comment","copy"],Ht=n.forwardRef((function(e,t){const o=$t(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.Page].checkbox},textButtonStyle:{padding:f().QJ[m().j.Page].text}})),[]));return(0,x.jsx)(Tt,{...o,EmptyComponent:Ie().ao,quickActionButtons:Ot})})),Wt=["comment","copy"],Dt=n.forwardRef((function(e,t){const{isMobile:o}=(0,a().Y0)(),n=$t(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.CompactPage].checkbox},textButtonStyle:{padding:f().QJ[m().j.CompactPage].text,width:"100%",...pt().RC}})),[]));return(0,x.jsx)(Tt,{...n,EmptyComponent:Ie().ao,quickActionButtons:o?void 0:Wt})})),Kt=n.forwardRef((function(e,t){const o=$t(e,t);return(0,x.jsx)(Tt,{...o,EmptyComponent:Ie().Fe})})),Ut=n.forwardRef((function(e,t){const o=$t(e,t,(0,S().F)(t,e.collectionStore,e.property,"formula"));return(0,x.jsx)(Tt,{...o})})),Nt=n.forwardRef((function(e,t){const o=$t(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.Board].checkbox},textButtonStyle:{padding:f().QJ[m().j.Board].text}})),[]));return(0,x.jsx)(Tt,{...o,checkboxShowLabel:!0})})),zt=n.forwardRef((function(e,t){const o=$t(e,t);return(0,x.jsx)(Tt,{...o,checkboxShowLabel:!0})})),Qt=n.forwardRef((function(e,t){const o=$t(e,t);return(0,x.jsx)(Tt,{...o,checkboxShowLabel:!0})})),Jt=n.forwardRef((function(e,t){const o=$t(e,t);return(0,x.jsx)(Tt,{...o})})),qt=n.forwardRef((function(e,t){const o=$t(e,t);return(0,x.jsx)(Tt,{...o})})),Yt=n.forwardRef((function(e,t){const o=$t(e,t);return(0,x.jsx)(Tt,{...o})}));function $t(e,t,o){const{store:n,onContextMenu:r,property:i,collectionStore:l}=e;return{ref:t,store:n,property:i,collectionStore:l,editButtonClickProps:(0,ae().QK)(e),onContextMenu:r,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,textButtonStyle:null==o?void 0:o.textButtonStyle}}function Gt(e){if(void 0===e)return[];if("string"==typeof e)return 0===e.length?[]:[{id:e,type:"text",value:[[e]]}];if("number"==typeof e)return[{id:e,type:"number",value:e}];if((0,ct().kC)(e)){return[{id:ut().ZF({allowRelativeDates:!1,value:e,userTimeZone:(0,dt().P)(),intl:O().A.getIntl()}),type:"date",value:e}]}if("boolean"==typeof e)return[{id:e,type:"checkbox",value:e}];(0,T().HB)(e)}var Zt=()=>o(271311),Xt=()=>o(161479),eo=()=>o(919709),to=()=>o(116008),oo=()=>o(712030),no=()=>o(921855),ro=()=>o(735372);const io=n.memo((function(e){const{parentStore:t,withComma:i,linkifyUrls:c,disableCommentHighlight:d,disableLinks:p,shouldTruncate:m,clampLines:f}=e,{textValue:S}=e,h=(0,a().v3)(),b=(0,s().DP)(),v=(0,oo().Ol)();(0,n.useEffect)((()=>{void 0!==S&&h.KatexStore.loadIfNeeded((()=>S))}),[h.KatexStore,S]);const{collectionContextStore:g,property:k}=(0,n.useContext)(y().L8),{collectionViewBlockId:C,collectionViewId:w}=(0,r().K8)((()=>{var e,t;return{collectionViewId:null==g||null===(e=g.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==g||null===(t=g.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[g]),j=(0,r().K8)((()=>h.KatexStore.getKatex()),[h.KatexStore]),P=(0,r().K8)((()=>{const e=ro().qu.state,o=ro().wb.state;if(!e||!k||!S)return S;return no().nu({textValue:S,blockId:t.id,textProps:{type:"page_property_value_match",collectionViewBlockId:C,collectionViewId:w,propertyId:k},find:e,currentFocusedResult:o})}),[k,S,t.id,C,w]),I=(0,r().K8)((()=>{if(to().A.getPropertyId()!==k||to().A.getBlockStore()!==t)return P;const e=to().A.getMultiSelection();return e?eo().Mwp({textValue:P,selection:{startIndex:e.start.index,endIndex:e.end.index},annotation:[eo().Ifu.TemporaryComment]}):S?eo().Mwp({textValue:P,selection:{startIndex:0,endIndex:eo().qAZ(S).length},annotation:[eo().Ifu.TemporaryComment]}):P}),[t,k,S,P]),_=(0,r().K8)((()=>void 0===I?null:no().S5({environment:h,textValue:I&&{value:I,spaceId:(0,Xt().e)(t.pointer.spaceId)},parentStore:t,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:d??!1,disabled:!0,theme:b,disableLinks:p??!1,emojiType:v,katex:j,formulaValueTypes:[],stopLinkPropagation:!0,linkTargetBlank:!0})),[I,h,t,d,b,p,v,j]),A=(0,n.useMemo)((()=>{if(!c||void 0===S)return null;const e=(0,eo().k4p)(S);return(0,o(735577).A)(e)?(0,u().MO)(S):null}),[c,S]),B=(0,s().IS)((e=>({text:{...m&&!f?pt().RC:void 0,...m&&f?{...(0,o(115512).pA)(f),overflow:"hidden",textOverflow:"ellipsis"}:{}}})),[m,f]);return(0,x.jsxs)("span",{style:B.text,children:[A?(0,x.jsx)(o(187485).A,{href:A,style:{display:"inline",pointerEvents:"auto",...(0,l().w_)(b)},external:!0,onClick:e=>e.stopPropagation(),children:_}):_,i?", ":null]})})),lo=n.memo((0,n.forwardRef)(((e,t)=>{const{store:o,buttonStyle:i,onContextMenu:l,editButtonClickProps:a,quickActionButtons:c=[],EmptyComponent:u,property:d,width:m,linkifyUrls:f,disableLinks:S,userExpandable:b,clampLines:v,forceBlockPropertyButtonEnable:g=!1}=e,{baseStyles:k}=(0,n.useContext)(y().L8),C=(0,r().K8)((()=>o.getPropertyValue(d)),[d,o]),w=(0,s().IS)((()=>({buttonStyle:{...k.buttonStyle,...i},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,i]);if((null==C||!C.length)&&void 0===u)return null;const j=Boolean(v);return(0,x.jsx)(p().P,{ref:t,style:w.buttonStyle,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,onContextMenu:l,editButtonClickProps:a,quickActionButtons:c,forceEnableButton:g,width:m,userExpandable:b,children:null!=C&&C.length||void 0===u?(0,x.jsx)(h().C,{children:(0,x.jsx)(io,{textValue:C,parentStore:o,linkifyUrls:f,disableLinks:S,shouldTruncate:j,clampLines:v})}):(0,x.jsx)(u,{})})}))),ao=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].text}})),[]),a=(0,n.useMemo)((()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Zt().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,x.jsx)(Pe().k,{},"comment"),(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})),[i,r,o]),c=bo(e,t,l);return(0,x.jsx)(lo,{...c,EmptyComponent:Ie().ao,quickActionButtons:a})})),so=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),c=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].text}})),[]),u=(0,n.useMemo)((()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Zt().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,x.jsx)(Pe().k,{},"comment"),l?void 0:(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),p=bo(e,t,c);return(0,x.jsx)(lo,{...p,EmptyComponent:Ie().rW,quickActionButtons:u,userExpandable:!0})})),co=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),c=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].text,maxWidth:"300px"}})),[]),u=(0,n.useMemo)((()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Pe().k,{},"comment"),l?void 0:(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),p=bo(e,t,c);return(0,x.jsx)(lo,{...p,EmptyComponent:Ie().ao,quickActionButtons:u,linkifyUrls:!1,disableLinks:!0})})),uo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=bo(e,t,(0,S().F)(t,e.collectionStore,e.property,"text"));return(0,x.jsx)(lo,{...n,EmptyComponent:o?Ie().Jb:void 0})})),po=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=bo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].text}})),[]));return(0,x.jsx)(lo,{...n,EmptyComponent:o?Ie().Jb:void 0})})),yo=(0,n.forwardRef)((function(e,t){const o=bo(e,t);return(0,x.jsx)(lo,{...o})})),mo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=bo(e,t);return(0,x.jsx)(lo,{...n,EmptyComponent:o?Ie().Jb:void 0})})),fo=(0,n.forwardRef)((function(e,t){const o=bo(e,t);return(0,x.jsx)(lo,{...o})})),So=(0,n.forwardRef)((function(e,t){const o=bo(e,t);return(0,x.jsx)(lo,{...o})})),ho=(0,n.forwardRef)((function(e,t){const o=bo(e,t);return(0,x.jsx)(lo,{...o})})),xo=(0,n.forwardRef)((function(e,t){const o=bo(e,t);return(0,x.jsx)(lo,{...o,EmptyComponent:Ie().Fe})}));function bo(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,width:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,ae().QK)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,width:s}}var vo=()=>o(963912);const go=n.memo(n.forwardRef((function(e,t){const{store:o,EmptyComponent:i,onContextMenu:l,buttonStyle:a}=e,{baseStyles:c,collectionContextStore:u}=(0,n.useContext)(y().L8),d=(0,r().K8)((()=>o.getAssociatedCollectionStore()),[o]),m=(0,s().IS)((()=>({buttonStyle:{...c.buttonStyle,minWidth:32,...a},buttonPressedStyle:c.buttonPressedStyle??{},buttonHoveredStyle:c.buttonHoveredStyle??{}})),[c.buttonHoveredStyle,c.buttonPressedStyle,c.buttonStyle,a]),f=!d||!u;return f&&void 0===i?null:(0,x.jsx)(p().P,{ref:t,onContextMenu:l,editButtonClickProps:void 0,style:m.buttonStyle,pressedStyle:m.buttonPressedStyle,hoveredStyle:m.buttonHoveredStyle,tooltipPropertyValue:(0,x.jsx)(vo().O,{collectionForLocationStore:d,collectionContextStore:u}),children:f&&void 0!==i?(0,x.jsx)(i,{}):(0,x.jsx)(vo().A,{collectionContextStore:u,collectionForLocationStore:d})})}))),ko=n.forwardRef((function(e,t){const o=Eo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].text}})),[]));return(0,x.jsx)(go,{...o,EmptyComponent:Ie().rW})})),Co=n.forwardRef((function(e,t){const o=Eo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].text}})),[]));return(0,x.jsx)(go,{...o,EmptyComponent:Ie().ao})})),wo=n.forwardRef((function(e,t){const o=Eo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].text}})),[]));return(0,x.jsx)(go,{...o,EmptyComponent:Ie().ao})})),jo=n.forwardRef((function(e,t){const o=Eo(e,t);return(0,x.jsx)(go,{...o,EmptyComponent:Ie().Fe})})),Po=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Eo(e,t,(0,S().F)(t,e.collectionStore,e.property,"location"));return(0,x.jsx)(go,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Io=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Eo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].text}})),[]));return(0,x.jsx)(go,{...n,EmptyComponent:o?Ie().Jb:void 0})})),_o=n.forwardRef((function(e,t){const o=Eo(e,t);return(0,x.jsx)(go,{...o})})),Ao=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Eo(e,t);return(0,x.jsx)(go,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Bo=n.forwardRef((function(e,t){const o=Eo(e,t);return(0,x.jsx)(go,{...o})})),Ro=n.forwardRef((function(e,t){const o=Eo(e,t);return(0,x.jsx)(go,{...o})})),Mo=n.forwardRef((function(e,t){const o=Eo(e,t);return(0,x.jsx)(go,{...o})}));function Eo(e,t,o){const{store:n,onContextMenu:r}=e;return{ref:t,store:n,onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle}}var To=()=>o(454155),Lo=()=>o(495930);const Vo=n.memo((0,n.forwardRef)((function(e,t){var o,i;const{store:a,buttonStyle:c,onContextMenu:d,editButtonClickProps:m,quickActionButtons:f,EmptyComponent:S,isRightAligned:b,property:v,width:g,userExpandable:k}=e,{baseStyles:C,propertySchema:w,shouldRenderTooltip:j}=(0,n.useContext)(y().L8),P=w,I=(0,r().K8)((()=>{const e=a.getPropertyValue(v);return u().Me(e)}),[v,a]),_=(0,l().lh)({numberValue:I,numberFormat:null==P?void 0:P.number_format,numberShowAs:null==P?void 0:P.show_as}),A=(0,s().IS)((()=>({buttonStyle:{...C.buttonStyle,...c},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C.buttonHoveredStyle,C.buttonPressedStyle,C.buttonStyle,c]);if(void 0===I&&void 0===S)return null;const B="bar"===(null==P||null===(o=P.show_as)||void 0===o?void 0:o.type)||"ring"===(null==P||null===(i=P.show_as)||void 0===i?void 0:i.type);return(0,x.jsx)(p().P,{ref:t,style:A.buttonStyle,hoveredStyle:A.buttonHoveredStyle,pressedStyle:A.buttonPressedStyle,onContextMenu:d,editButtonClickProps:m,quickActionButtons:f,quickActionButtonsAlign:b?"left":void 0,tooltipPropertyValue:j?_:void 0,width:g,userExpandable:k,children:void 0===I&&void 0!==S?(0,x.jsx)(S,{}):B?(0,x.jsx)(ze().h,{isRightAligned:b,children:(0,x.jsx)(Lo().E,{numberValue:I,isRightAligned:b,store:a,property:v})}):(0,x.jsx)(h().C,{isRightAligned:b,children:(0,x.jsx)(Lo().E,{numberValue:I,isRightAligned:b,store:a,property:v})})})}))),Fo=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=qo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].text}})),[])),a=(0,n.useMemo)((()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Pe().k,{},"comment"),(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})),[i,r,o]);return(0,x.jsx)(Vo,{...l,EmptyComponent:Ie().ao,quickActionButtons:a})})),Oo=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),{shouldWrap:c}=(0,n.useContext)(y().L8),u=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].text}})),[]),p=(0,n.useMemo)((()=>{if(!l)return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Pe().k,{},"comment"),(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})}),[i,l,r,o]),S=qo(e,t,u);return(0,x.jsx)(Vo,{...S,EmptyComponent:Ie().rW,quickActionButtons:p,isRightAligned:!0,userExpandable:c})})),Ho=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),c=qo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].text}})),[])),u=(0,n.useMemo)((()=>{if(!l)return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Pe().k,{},"comment"),(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})}),[i,l,r,o]);return(0,x.jsx)(Vo,{...c,EmptyComponent:Ie().ao,quickActionButtons:u})})),Wo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=qo(e,t,(0,S().F)(t,e.collectionStore,e.property,"number"));return(0,x.jsx)(Vo,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Do=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=qo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].text}})),[]));return(0,x.jsx)(Vo,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Ko=(0,n.forwardRef)((function(e,t){const o=qo(e,t);return(0,x.jsx)(Vo,{...o})})),Uo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=qo(e,t);return(0,x.jsx)(Vo,{...n,EmptyComponent:o?Ie().Jb:void 0})})),No=(0,n.forwardRef)((function(e,t){const o=qo(e,t);return(0,x.jsx)(Vo,{...o})})),zo=(0,n.forwardRef)((function(e,t){const o=qo(e,t);return(0,x.jsx)(Vo,{...o})})),Qo=(0,n.forwardRef)((function(e,t){const o=qo(e,t);return(0,x.jsx)(Vo,{...o})})),Jo=(0,n.forwardRef)((function(e,t){const o=qo(e,t);return(0,x.jsx)(Vo,{...o,EmptyComponent:Ie().Fe})}));function qo(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ae().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}var Yo=()=>o(268925),$o=()=>o(383852),Go=(o(944114),o(672577),()=>o(787626)),Zo=()=>o(970013),Xo=()=>o(568063),en=()=>o(604995),tn=()=>o(450648),on=()=>o(559653),nn=()=>o(722372),rn=()=>o(519745),ln=()=>o(173019),an=()=>o(548218),sn=()=>o(454305),cn=()=>o(963589),un=()=>o(761529);const dn=(0,M().YK)({rollup:{defaultMessage:"Configure rollup",id:"database.editButton.configureRollupTooltip"}});function pn(e){const{type:t,editButtonClickProps:o}=e,i=(0,a().v3)(),{isMobile:l}=(0,a().Y0)(),c=(0,cn().X)("db_ux_mobile"),{containerRef:u,collectionContextStore:d,canEdit:p}=(0,n.useContext)(y().L8),m=(0,r().uB)(void 0,sn().A),f=(0,n.useMemo)((()=>O().A.formatMessage(dn[t])),[t]),S=(0,s().IS)((e=>({iconStyle:{color:e.text.secondary,fill:e.text.secondary},button:{height:20,width:20}})),[]),h=(0,n.useCallback)((async e=>{if(void 0===o)return;const{onClick:t,store:n,property:r,format:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:p}=o,y=u&&"current"in u&&(null==u?void 0:u.current)||void 0;await an().V({element:y,environment:i,onClick:t,store:n,property:a.getMappedProperty(r),format:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:p,collectionContextStore:d,mouseStore:m,isDBUXMobileEnabled:c})}),[d,u,o,i,m,c]);return!p||l?null:(0,x.jsx)(un().A,{icon:ln().r,tooltip:f,onClick:h,style:S.button,iconStyle:S.iconStyle})}const yn=n.memo(n.forwardRef((function(e,t){const{store:i,property:l,EmptyComponent:c,collectionStore:d,onContextMenu:f,editButtonClickProps:S,checkboxButtonStyle:b,textButtonStyle:v,buttonButtonStyle:g,quickActionButtons:k,numberRightAlign:C,userExpandable:w}=e,{baseStyles:j,format:P,collectionSchema:I}=(0,n.useContext)(y().L8),_=(0,vt().C)(),A=(0,n.useMemo)((()=>{if(!I)return;const{relationPropertySchema:e}=(0,Xo().fS)({schema:I,property:l}),t=e?Zo().Nv(e):void 0;return t?W().md.createChildStore(i,t):void 0}),[l,I,i]),B=(0,r().K8)((()=>{if(void 0!==I)return(0,Xo().eY)({property:l,schema:I,preLoadedTargetCollectionModel:null==A?void 0:A.getModel(),getRecordModel:d.getRecordModel})}),[I,l,d.getRecordModel,A]),{propertySchema:R,targetPropertySchema:M}=B||{},[E,T]=function(e){var t;const{schema:o,property:i,store:l,propertySchema:a,targetPropertySchema:s,numberRightAlign:c,clientFormulaTimeoutMs:u}=e,{value:d}=(0,H().fJ)(V().T.formulas),p=(0,rn().n)(),y=(0,r().K8)((()=>{const e=l.getModel();if(!(null!=a&&a.aggregation&&"show_unique"!==a.aggregation&&e&&null!=s&&s.type&&o))return{rollupAggregationValue:void 0,numberFormat:void 0,numberPrecision:void 0};const t=(0,Xo().Pm)({block:e,property:i,schema:o,getRecordModel:l.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,dt().P)(),depth:0,intl:O().A.getIntl(),visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,formulaTimeoutTimestampMs:Date.now()+u,experimentService:mt().default,collectionFeatureGates:(0,bt().i)()},formulasModule:d});if(!t)return{rollupAggregationValue:void 0,numberFormat:void 0,numberPrecision:void 0};const n=(0,nn().o_)(a.aggregation,"formula"===(null==s?void 0:s.type)||"number"===(null==s?void 0:s.type)?s.number_format:void 0),r=(0,nn().zI)(a.aggregation,"formula"===(null==s?void 0:s.type)||"number"===(null==s?void 0:s.type)?s.number_precision:void 0);if(n){const e=void 0===(null==t?void 0:t.value)||null===(null==t?void 0:t.value)||"number"!=typeof t.value?void 0:Number(t.value);if(void 0!==e&&!isNaN(e))return{rollupAggregationValue:e,numberFormat:n,numberPrecision:r}}const c=(0,nn().Y9)({numberFormat:void 0,dateFormat:s&&"date_format"in s?s.date_format:void 0,aggregationType:a.aggregation,value:t,userTimeZone:(0,dt().P)(),numberPrecision:void 0});return void 0===c||""===c?{rollupAggregationValue:void 0,numberFormat:void 0}:{rollupAggregationValue:c,numberFormat:void 0}}),[l,a,s,o,i,u,d],p),m=y===rn().F,f=(0,n.useMemo)((()=>{if(y===rn().F){const e=!0===c&&(null==a?void 0:a.aggregation)&&void 0!==(0,nn().o_)(null==a?void 0:a.aggregation,"number");return(0,x.jsx)(At,{style:{justifyContent:e?"flex-end":void 0}})}const{rollupAggregationValue:e,numberFormat:t,numberPrecision:o}=y;if(void 0===e)return null;if(t){var n,r;return"bar"===(null==a||null===(n=a.show_as)||void 0===n?void 0:n.type)||"ring"===(null==a||null===(r=a.show_as)||void 0===r?void 0:r.type)?(0,x.jsx)(ze().h,{isRightAligned:c,children:(0,x.jsx)(Lo().E,{numberFormatOverride:t,numberPrecisionOverride:o,numberValue:e,isRightAligned:c})}):(0,x.jsx)(h().C,{isRightAligned:c,children:(0,x.jsx)(Lo().E,{numberFormatOverride:t,numberPrecisionOverride:o,numberValue:e,isRightAligned:c})})}return(0,x.jsx)(h().C,{children:e})}),[c,null==a?void 0:a.aggregation,null==a||null===(t=a.show_as)||void 0===t?void 0:t.type,y]);return[f,m]}({store:i,schema:I,property:l,propertySchema:R,targetPropertySchema:M,numberRightAlign:C,clientFormulaTimeoutMs:_}),L=function(e){const{store:t,rollupPropertyData:i,numberRightAlign:l,clientFormulaTimeoutMs:s,format:c,targetCollectionStore:d}=e,{value:p}=(0,H().fJ)(V().T.formulas),{propertySchema:y,relationPropertySchema:f,targetPropertySchema:S,targetProperty:h,targetCollectionModel:b}=i||{},v=(0,r().K8)((()=>{const e=t.getModel();if(void 0!==(null==y?void 0:y.aggregation)&&"show_unique"!==(null==y?void 0:y.aggregation)||!y||!f||!S||!b||!e||void 0===(null==y?void 0:y.relation_property))return[];return u().bG({relationValue:u().n(u().yQ(e,y.relation_property)),getRecordModel:t.getRecordModel,propertySchema:f,includeNoAccess:!0}).map((e=>W().Bv.createChildStore(t,e))).filter((e=>{var t;return(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===b.id}))}),[t,y,f,S,b]),g=(0,a().v3)(),k=(0,r().K8)((()=>{if(void 0===f||void 0===d||void 0===S||void 0===h||void 0===y)return[];const e=[],t=new Map,n=new Map;for(const o of v){const r=o.getPropertyValue(h);if(void 0===r&&!["status","person","checkbox","formula","last_edited_time","last_edited_by","created_time","created_by","title"].includes(S.type))continue;const i=fn({textValue:r,blockStore:o,targetCollectionStore:d,targetPropertySchema:S,targetProperty:h,currentUserId:g.currentUser.id,clientFormulaTimeoutMs:s,resultCache:t,regExpCache:n,formulasModule:p}).map((e=>[e,o]));e.push(...i)}return"show_unique"===y.aggregation?o(496603).hS(e,(e=>{let[t,o]=e;return t.id})):e}),[v,f,y,h,S,d,g.currentUser.id,s,p]);return(0,n.useMemo)((()=>{if(null==k||!k.length||!y)return null;const e=1===k.length,t=k[0][0].type,o=(0,Bt().GL)(t,y);return(0,x.jsx)(Bt().Ye,{propertyType:t,rootPropertySchema:y,numberRightAlign:l,children:k.map(((t,n)=>{let[r,i]=t;return(0,x.jsx)(Bt().yZ,{token:r,targetPropertySchema:S,blockStore:i,withComma:o&&n<k.length-1,numberRightAlign:l,shouldTruncate:e&&c===m().j.CompactPage,disableLinks:c===m().j.CompactPage},`${r.id}-${n}`)}))})}),[c,l,y,k,S])}({store:i,rollupPropertyData:B,numberRightAlign:C,clientFormulaTimeoutMs:_,targetCollectionStore:A,format:P}),F=!E&&!L;!function(e){const{store:t,property:o,isLoading:r}=e,{format:i,collectionContextStore:l}=(0,n.useContext)(y().L8);(0,at().w)((()=>{var e;i===m().j.Table&&(null==l||null===(e=l.propertyResultDurationTracker)||void 0===e||e.trackMount({pageId:t.id,propertyId:o,propertyType:"rollup"}))})),(0,n.useEffect)((()=>{var e;r||i!==m().j.Table||(null==l||null===(e=l.propertyResultDurationTracker)||void 0===e||e.trackResult({pageId:t.id,propertyId:o,propertyType:"rollup"}))}),[l,i,r,o,t])}({store:i,property:l,isLoading:T});const D=(0,r().K8)((()=>F||void 0===B?"text":void 0!==(null==R?void 0:R.aggregation)&&"show_unique"!==R.aggregation?void 0!==(0,nn().o_)(R.aggregation,"number")?"number":"text":null!=B&&B.targetPropertySchema?function(e){if("formula"===e.type){if(e.formula2){const t=(0,o(977345).pg)(e.formula2.result_type).type;return"block"===t?"relation":"unknown"===t||"array"===t?"text":t}return"text"}return"rollup"===e.type?"text":e.type}(B.targetPropertySchema):"text"),[F,null==R?void 0:R.aggregation,B]),K=(0,s().IS)((e=>({buttonStyle:{...j.buttonStyle,..."checkbox"===D?b:{},..."title"!==D&&(0,Ue().YX)(D)?v:{},...(0,Ue()._t)(D)?g:{}},buttonPressedStyle:j.buttonPressedStyle??{},buttonHoveredStyle:j.buttonHoveredStyle??{}})),[j.buttonHoveredStyle,j.buttonPressedStyle,j.buttonStyle,g,b,D,v]);if(F&&void 0===c)return null;const U=!0===C&&"number"===D;return(0,x.jsx)(p().P,{ref:t,onContextMenu:f,editButtonClickProps:S,style:K.buttonStyle,pressedStyle:K.buttonPressedStyle,hoveredStyle:K.buttonHoveredStyle,quickActionButtons:!T&&k?(0,x.jsx)(mn,{buttons:k,editButtonClickProps:S}):void 0,quickActionButtonsAlign:U?"left":void 0,userExpandable:w,children:F?c?(0,x.jsx)(c,{}):null:E??L})})));function mn(e){let{buttons:t,editButtonClickProps:o}=e;const n=t.map((e=>{if("edit"===e)return(0,x.jsx)(pn,{type:"rollup",editButtonClickProps:o},e);(0,T().HB)(e)})).filter(T().Pe);return n?(0,x.jsx)(x.Fragment,{children:n}):null}function fn(e){var t;const{textValue:o,blockStore:n,targetCollectionStore:r,targetPropertySchema:i,targetProperty:l,clientFormulaTimeoutMs:a,resultCache:s,regExpCache:d,formulasModule:p}=e,{type:y}=i;switch(y){case"auto_increment_id":if(void 0===o)return[];const f=null===(t=r.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),S=(0,c().H4)(f,u().On(o));return S?[{id:S,type:"text",value:[[S]]}]:[];case"button":case"rollup":case"location":case"verification":case"geo_point":return[];case"checkbox":{const e=u().wu(o);return[{id:e,type:"checkbox",value:e}]}case"date":{const e=(0,Go().b)(o);if(void 0===e)return[];return[{id:ut().ZF({allowRelativeDates:!1,value:e,userTimeZone:(0,dt().P)(),intl:O().A.getIntl()}),type:"date",value:e}]}case"email":case"phone_number":case"url":return void 0===o?[]:[{id:(0,eo().k4p)(o),type:y,value:o}];case"file":return u().pJ(o).map((e=>({id:e.url,type:"file",value:e})));case"formula":{const e=n.getModel();if(void 0===e)return[];if(!p)return[];const t=O().A.getIntl(),o=(0,dt().P)();if("v2"===i.version){var m;if(null===(m=i.formula2)||void 0===m||!m.code)return[];const r=p.evaluateCollectionFormula2({block:e,property:l,formulaCode:i.formula2.code,getRecordModel:n.getRecordModel,intl:t,userTimeZone:o,depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+a,resultCache:s,regExpCache:d,experimentService:mt().default,collectionFeatureGates:(0,bt().i)()});return r?(0,Rt().O)(r,n.getRecordModel,o):[]}return Gt(p.evaluateFormulaProperty({property:l,schema:n.getSchema(),block:e,getRecordModel:n.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:o,depth:0,intl:t,resultCache:s,regExpCache:d,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+a,experimentService:mt().default,collectionFeatureGates:(0,bt().i)()}}))}case"select":{const e=u().L3(o,i.options??[]);if(!i.options||!e)return[];return[{id:e,type:"select",value:e,color:(0,u().FE)(i.options??[],e)}]}case"multi_select":return u().o2(o,i.options??[]).map((e=>({id:e,type:"select",value:e,color:(0,u().FE)(i.options??[],e)})));case"number":{const e=u().Me(o);return void 0===e?[]:[{id:e,type:"number",value:e}]}case"person":return u().e5({textValue:o,propertySchema:i,blockCreatorPointer:n.getCreatedByPointer()}).map((e=>({id:e.id,type:"person",value:e})));case"title":if(void 0===r)return[];return[{id:(0,tn().r4)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,dt().P)(),intl:O().A.getIntl()}),type:"relation",value:{id:n.id,table:"block",spaceId:r.getSpaceId()}}];case"relation":if(void 0===r)return[];return u().bG({relationValue:u().n(o),getRecordModel:n.getRecordModel,propertySchema:i,includeNoAccess:!0}).map((e=>({id:e.id,type:"relation",value:e})));case"status":{const e=u().RZ(o,i),{options:t,groups:n}=i,r=null==t?void 0:t.find((t=>t.value===e));if(void 0===e||void 0===r)return[];const l=null==n?void 0:n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(r.id)}));return[{id:e,type:"select",value:e,color:r.color,groupColor:(null==l?void 0:l.color)??"default"}]}case"text":if(void 0===o)return[];const h=(0,tn().r4)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,dt().P)(),intl:O().A.getIntl()});return 0===h.length?[]:[{id:h,type:"text",value:o}];case"created_by":const x=n.getCreatedByPointer();return x?[{id:x.id,type:"person",value:x}]:[];case"created_time":{const e=n.getCreatedTime();return[{id:e,type:"date",value:(0,en().KQ)(e,(0,dt().P)())}]}case"last_edited_by":{const e=n.getLastEditedByPointer();return e?[{id:e.id,type:"person",value:e}]:[]}case"last_edited_time":{const e=n.getLastEditedTime();return[{id:e,type:"date",value:(0,en().KQ)(e,(0,dt().P)())}]}case"last_visited_time":{const{currentUserId:t}=e;if(!t)return[];const o=(0,on().$5)({parent_id:n.id,user_id:t}),r=W()._z.createChildStore(n,{table:on().F9,id:o,spaceId:n.getSpaceId()}).getModel(),i=null==r?void 0:r.getVisitedAt();if(!i)return[];return[{id:i,type:"date",value:(0,en().KQ)(i,(0,dt().P)())}]}default:(0,T().HB)(y)}}const Sn=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(y().L8),r=In(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.Table].checkbox},textButtonStyle:{padding:f().QJ[m().j.Table].text},buttonButtonStyle:{padding:f().QJ[m().j.Table].button}})),[]));return(0,x.jsx)(yn,{...r,numberRightAlign:!0,EmptyComponent:Ie().rW,quickActionButtons:["edit"],userExpandable:o})})),hn=n.forwardRef((function(e,t){const o=In(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.Page].checkbox},textButtonStyle:{padding:f().QJ[m().j.Page].text},buttonButtonStyle:{padding:f().QJ[m().j.Page].button}})),[]));return(0,x.jsx)(yn,{...o,quickActionButtons:["edit"],EmptyComponent:Ie().ao})})),xn=n.forwardRef((function(e,t){const o=In(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.CompactPage].checkbox},textButtonStyle:{padding:f().QJ[m().j.CompactPage].text},buttonButtonStyle:{padding:f().QJ[m().j.CompactPage].button}})),[]));return(0,x.jsx)(yn,{...o,EmptyComponent:Ie().ao})})),bn=n.forwardRef((function(e,t){const o=In(e,t);return(0,x.jsx)(yn,{...o,EmptyComponent:Ie().Fe})})),vn=n.forwardRef((function(e,t){const o=In(e,t,(0,S().F)(t,e.collectionStore,e.property,"rollup"));return(0,x.jsx)(yn,{...o})})),gn=n.forwardRef((function(e,t){const o=In(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.Board].checkbox},textButtonStyle:{padding:f().QJ[m().j.Board].text},buttonButtonStyle:{padding:f().QJ[m().j.Board].button}})),[]));return(0,x.jsx)(yn,{...o})})),kn=n.forwardRef((function(e,t){const o=In(e,t);return(0,x.jsx)(yn,{...o})})),Cn=n.forwardRef((function(e,t){const o=In(e,t);return(0,x.jsx)(yn,{...o})})),wn=n.forwardRef((function(e,t){const o=In(e,t);return(0,x.jsx)(yn,{...o})})),jn=n.forwardRef((function(e,t){const o=In(e,t);return(0,x.jsx)(yn,{...o})})),Pn=n.forwardRef((function(e,t){const o=In(e,t);return(0,x.jsx)(yn,{...o})}));function In(e,t,o){const{store:n,onContextMenu:r,property:i,collectionStore:l}=e;return{ref:t,store:n,property:i,collectionStore:l,editButtonClickProps:(0,ae().QK)(e),onContextMenu:r,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,textButtonStyle:null==o?void 0:o.textButtonStyle,buttonButtonStyle:null==o?void 0:o.buttonButtonStyle}}var _n=()=>o(787648);const An=n.memo(n.forwardRef((function(e,t){const{store:o,onContextMenu:i,property:l,disabled:a,enablePointerEventsForInteractiveTypes:c,editButtonClickProps:d,selectButtonStyle:m,checkboxButtonStyle:f,checkboxShowLabel:S,EmptyComponent:h,quickActionButtons:b,width:v,userExpandable:g}=e,{baseStyles:k,propertyFormat:C,propertySchema:w,shouldRenderTooltip:j}=(0,n.useContext)(y().L8),P=w,I=(0,Ue().Ug)(null==k?void 0:k.tokenFormat),_=(0,r().K8)((()=>o.getPropertyValue(l)),[l,o]),A=(0,n.useMemo)((()=>P?u().RZ(_,P)??"":""),[_,P]),B=(null==C?void 0:C.statusShowAs)??"select",R=(0,s().IS)((()=>({buttonStyle:{...k.buttonStyle,..."select"===B?m:f},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,m,f,B]);return A||void 0!==h?(0,x.jsx)(p().P,{ref:t,onContextMenu:i,editButtonClickProps:d,style:R.buttonStyle,pressedStyle:R.buttonPressedStyle,hoveredStyle:R.buttonHoveredStyle,tooltipPropertyValue:j&&"checkbox"===B?A:void 0,quickActionButtons:b,width:v,userExpandable:g,children:"checkbox"===B?(0,x.jsx)(Rn,{enablePointerEventsForInteractiveTypes:c,showLabel:S,propertyName:null==P?void 0:P.name,propertyValue:_,statusValue:A,editButtonClickProps:d,containerRef:t,store:o,property:l,disabled:a}):A||void 0===h?(0,x.jsx)(Bn,{statusValue:A,tokenFormat:I,store:o,property:l,propertySchema:P,parentHasTooltip:j}):(0,x.jsx)(h,{})}):null})));function Bn(e){const{statusValue:t,store:r,parentHasTooltip:i,property:l,propertySchema:a}=e,c=(0,s().DP)(),u=(0,o(358167).v)({blockId:null==r?void 0:r.id,propertyId:l}),d=(0,Ne().s)({propertyId:l,store:r}),p=Boolean(d),y=(0,s().IS)((()=>({container:{...p||u?{...(0,Ke().sQ)(c),paddingTop:3}:{},maxWidth:"fit-content"}})),[u,c,p]),{foundOption:m,foundGroup:f}=(0,n.useMemo)((()=>{const e=(null==a?void 0:a.options)??[],o=e.find((e=>e.value===t)),n=(null==a?void 0:a.groups)??[],r=o&&n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(o.id)}));return{options:e,foundOption:o,foundGroup:r}}),[a,t]);return m?(0,x.jsx)(ze().h,{style:y.container,className:d,children:(0,x.jsx)(o(997415).X,{type:"status",value:m.value,description:m.description,color:m.color,groupColor:null==f?void 0:f.color,shouldShowTooltip:!i})}):null}function Rn(e){const{propertyName:t,propertyValue:o,statusValue:r,showLabel:i,enablePointerEventsForInteractiveTypes:l,editButtonClickProps:s,containerRef:c,store:d,property:p,disabled:m}=e,f=(0,cn().X)("db_ux_mobile"),S=(0,a().v3)(),{propertySchema:h,shouldRenderTooltip:b}=(0,n.useContext)(y().L8),v=h,g=ue(d,p,m),k=(0,n.useMemo)((()=>!!v&&u().MC(o,v,O().A.getIntl())),[o,v]),C=(0,n.useCallback)((async e=>{await an().V({...s,element:c&&"current"in c?(null==c?void 0:c.current)??void 0:void 0,environment:S,statusSetCheckbox:!e.altKey,isDBUXMobileEnabled:f})}),[c,s,S,f]);return(0,x.jsx)(se().o,{onClick:C,propertyLabel:i?t:void 0,checked:k,enablePointerEventsForInteractiveTypes:l,tooltip:b?void 0:r,disabled:g,store:d,property:p})}const Mn=(0,n.forwardRef)((function(e,t){const{shouldWrap:o}=(0,n.useContext)(y().L8),r=(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.Table].checkbox}})),[]),i=(0,n.useMemo)((()=>(0,x.jsx)(Pe().k,{},"comment")),[]),l=Un(e,t,r);return(0,x.jsx)(An,{...l,checkboxShowLabel:!1,EmptyComponent:Ie().rW,collectionStore:e.collectionStore,quickActionButtons:i,userExpandable:o})})),En=(0,n.forwardRef)((function(e,t){const o=Un(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.Page].checkbox}})),[])),r=(0,n.useMemo)((()=>(0,x.jsx)(Pe().k,{},"comment")),[]);return(0,x.jsx)(An,{...o,checkboxShowLabel:!1,EmptyComponent:Ie().ao,collectionStore:e.collectionStore,quickActionButtons:r})})),Tn=(0,n.forwardRef)((function(e,t){const o=Un(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.CompactPage].checkbox}})),[])),r=(0,n.useMemo)((()=>(0,x.jsx)(Pe().k,{},"comment")),[]);return(0,x.jsx)(An,{...o,checkboxShowLabel:!1,EmptyComponent:Ie().ao,quickActionButtons:r})})),Ln=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Un(e,t,(0,S().F)(t,e.collectionStore,e.property,"status"));return(0,x.jsx)(An,{...n,checkboxShowLabel:!1,EmptyComponent:o?Ie().Jb:void 0})})),Vn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Un(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:f().QJ[m().j.Board].checkbox}})),[]));return(0,x.jsx)(An,{...n,checkboxShowLabel:!0,EmptyComponent:o?Ie().Jb:void 0})})),Fn=(0,n.forwardRef)((function(e,t){const o=Un(e,t);return(0,x.jsx)(An,{...o,checkboxShowLabel:!0})})),On=(0,n.forwardRef)((function(e,t){const o=Un(e,t);return(0,x.jsx)(An,{...o,checkboxShowLabel:!0})})),Hn=(0,n.forwardRef)((function(e,t){const o=Un(e,t);return(0,x.jsx)(An,{...o,checkboxShowLabel:!1})})),Wn=(0,n.forwardRef)((function(e,t){const o=Un(e,t);return(0,x.jsx)(An,{...o,checkboxShowLabel:!1})})),Dn=(0,n.forwardRef)((function(e,t){const o=Un(e,t);return(0,x.jsx)(An,{...o,checkboxShowLabel:!1})})),Kn=(0,n.forwardRef)((function(e,t){const o=Un(e,t);return(0,x.jsx)(An,{...o,checkboxShowLabel:!1,EmptyComponent:Ie().Fe})}));function Un(e,t,o){const{store:r,disabled:i,property:l,onContextMenu:a,enablePointerEventsForInteractiveTypes:s,width:c}=e,{propertyFormat:u}=(0,n.useContext)(y().L8),d="checkbox"===(null==u?void 0:u.statusShowAs),p=(0,ae().QK)(e,{isStatusCheckbox:d});return{ref:t,store:r,disabled:i,property:l,selectButtonStyle:null==o?void 0:o.selectButtonStyle,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,editButtonClickProps:p,onContextMenu:a,enablePointerEventsForInteractiveTypes:s,width:c}}const Nn=n.memo((0,n.forwardRef)(((e,t)=>{const{store:i,buttonStyle:l,onContextMenu:a,editButtonClickProps:c,quickActionButtons:u=[],EmptyComponent:d,property:m,width:f,linkifyUrls:S,disableLinks:b,userExpandable:v,clampLines:g,forceBlockPropertyButtonEnable:k=!1}=e,{baseStyles:C}=(0,n.useContext)(y().L8),w=(0,r().K8)((()=>i.getPropertyValue(m)),[m,i]),j=(0,s().IS)((()=>({buttonStyle:{...C.buttonStyle,...l},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C.buttonHoveredStyle,C.buttonPressedStyle,C.buttonStyle,l]);if((null==w||!w.length)&&void 0===d)return null;const P=Boolean(g);return(0,x.jsx)(p().P,{ref:t,style:j.buttonStyle,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,onContextMenu:a,editButtonClickProps:c,quickActionButtons:u,forceEnableButton:k,width:f,userExpandable:v,children:null!=w&&w.length||void 0===d?(0,x.jsx)(h().C,{children:(0,x.jsx)(o(178788).A,{textValue:w,parentStore:i,linkifyUrls:S,disableLinks:b,shouldTruncate:P,clampLines:g})}):(0,x.jsx)(d,{})})}))),zn=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].text}})),[]),a=(0,n.useMemo)((()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Zt().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,x.jsx)(Pe().k,{},"comment"),(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})),[i,r,o]),c=or(e,t,l);return(0,x.jsx)(Nn,{...c,EmptyComponent:Ie().ao,quickActionButtons:a})})),Qn=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),{shouldWrap:c}=(0,n.useContext)(y().L8),u=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].text}})),[]),p=(0,n.useMemo)((()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Zt().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,x.jsx)(Pe().k,{},"comment"),l?void 0:(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),S=or(e,t,u);return(0,x.jsx)(Nn,{...S,EmptyComponent:Ie().rW,quickActionButtons:p,userExpandable:c})})),Jn=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),c=(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].text,maxWidth:"300px"}})),[]),u=(0,n.useMemo)((()=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Pe().k,{},"comment"),l?void 0:(0,x.jsx)(d().i,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),p=or(e,t,c);return(0,x.jsx)(Nn,{...p,EmptyComponent:Ie().ao,quickActionButtons:u,linkifyUrls:!1,disableLinks:!0})})),qn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=or(e,t,(0,S().F)(t,e.collectionStore,e.property,"text"));return(0,x.jsx)(Nn,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Yn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=or(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].text}})),[]));return(0,x.jsx)(Nn,{...n,EmptyComponent:o?Ie().Jb:void 0})})),$n=(0,n.forwardRef)((function(e,t){const o=or(e,t);return(0,x.jsx)(Nn,{...o})})),Gn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=or(e,t);return(0,x.jsx)(Nn,{...n,EmptyComponent:o?Ie().Jb:void 0})})),Zn=(0,n.forwardRef)((function(e,t){const o=or(e,t);return(0,x.jsx)(Nn,{...o})})),Xn=(0,n.forwardRef)((function(e,t){const o=or(e,t);return(0,x.jsx)(Nn,{...o})})),er=(0,n.forwardRef)((function(e,t){const o=or(e,t);return(0,x.jsx)(Nn,{...o})})),tr=(0,n.forwardRef)((function(e,t){const o=or(e,t);return(0,x.jsx)(Nn,{...o,EmptyComponent:Ie().Fe})}));function or(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,width:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,ae().QK)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,width:s}}var nr=()=>o(340498),rr=()=>o(778417),ir=()=>o(725614),lr=()=>o(476492),ar=()=>o(682146),sr=()=>o(405417),cr=()=>o(97059),ur=()=>o(945895),dr=()=>o(614505);function pr(e){const{store:t}=e,r=(0,a().v3)(),l=(0,i().Ks)(),c=(0,M().tz)(),u=(0,n.useCallback)((()=>{const e=t.getBlockTitleStore();(0,o(573451).C)({store:t}),rr().hc({environment:r,store:t}),ir().setSelectionAtEnd({store:e}),(0,o(739041).u)(r,"list_item_edit_mode_enter",{...(0,lr().sl)(l),block_id:t.id,from:"click",view_type:"list"})}),[t,r,l]),d=(0,s().IS)((e=>({buttonStyle:{color:e.text.secondary,fill:e.text.secondary,height:20,width:26},iconStyle:{color:e.text.secondary,fill:e.text.secondary}})),[]),p=c.formatMessage({id:"collectionViewItem.edit.tooltip",defaultMessage:"Edit"});return(0,x.jsx)(U().A,{renderTooltip:()=>p,render:e=>(0,x.jsx)(o(285790).A,{icon:ln().r,ariaLabel:p,onClick:u,hasBackground:!0,showShadow:!1,style:d.buttonStyle,iconStyle:d.iconStyle,...e})})}var yr=()=>o(435009),mr=()=>o(519839),fr=()=>o(753199);const Sr=(0,M().YK)({openAsPageTitle:{defaultMessage:"Open",id:"database.actionButton.openAsPageTitle"}});function hr(e){const{store:t,handleOpenPeekPage:c,showLabel:u,showIcon:d}=e,p=(0,a().v3)(),y=(0,i().Ks)(),{peekModeProps:m}=(0,r().K8)((()=>{const e=void 0!==y?mr().hH(y):"full_page";return{peekModeProps:(0,l().lA)(e,!1)}}),[y],{useDeepEqual:!0}),f=(0,n.useCallback)((()=>(0,o(492414).Ay)({store:t,fullyQualified:!1,pageVisitSource:o(584262).y8.LinkInPage})),[t]),S=(0,n.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=o(351360).default.state;return mr().wy({environment:p,store:t,mainEditorCurrentBlockStore:e,collectionContextStore:y,fullyQualified:!1})}),[p,y,t]),h=(0,n.useCallback)((e=>{if(e.metaKey||e.ctrlKey)yr().oo({environment:p,url:f(),openInNew:"tab"});else{const e=S();if(!e)return;null==c||c(),yr().oo({environment:p,url:e})}}),[p,S,f,c]),b=(0,n.useCallback)((e=>{1===e.button&&yr().oo({environment:p,url:f(),openInNew:"tab"})}),[p,f]),v=(0,n.useCallback)((e=>{(0,fr().SQ)({event:e,context:fr().y$.EditorMouseDown,callback:()=>{e.preventDefault()}})}),[]),g=(0,s().IS)((e=>({buttonStyle:{color:e.text.secondary,fill:e.text.secondary,fontFamily:pt().Tf.sans,...!u&&{width:26},background:e.whiteButtonBackground,border:void 0,fontSize:12,fontWeight:pt().Wy.medium,textTransform:"uppercase",letterSpacing:.5,borderRadius:6,height:20,display:"flex",paddingLeft:4,paddingRight:4},buttonHoveredStyle:{background:e.whiteButtonHoveredBackground},buttonPressedStyle:{background:e.whiteButtonPressedBackground},iconStyle:{width:nr().Ev.default,height:nr().Ev.default,color:e.text.secondary,fill:e.text.secondary}})),[u]),k=(0,n.useCallback)((()=>m.tooltip),[m.tooltip]),C=(0,n.useCallback)((e=>(0,x.jsx)("div",{onAuxClick:b,onMouseDown:v,role:"button",tabIndex:0,children:(0,x.jsx)(K().A,{onClick:h,icon:d?m.icon:void 0,ariaLabel:m.tooltip,size:"sm",style:g.buttonStyle,iconStyle:g.iconStyle,hoveredStyle:g.buttonHoveredStyle,pressedStyle:g.buttonPressedStyle,...e,children:u?O().A.formatMessage(Sr.openAsPageTitle):void 0})})),[b,h,v,m.icon,m.tooltip,d,u,g.buttonHoveredStyle,g.buttonPressedStyle,g.buttonStyle,g.iconStyle]);return(0,x.jsx)(U().A,{renderTooltip:k,render:C})}const xr=(0,M().YK)({untitledBlock:{defaultMessage:"Untitled",id:"collectionViewItemTitle.untitledBlock"},typeAName:{defaultMessage:"Type a name…",id:"collectionViewItemTitle.itemName.placeholder"}}),br=new Set([m().j.Table,m().j.GalleryView,m().j.Board]),vr=n.memo((0,n.forwardRef)((function(e,t){const{buttonStyle:i,canEdit:c,collectionStore:u,commentsIndicatorStyle:d,editButtonClickProps:m,forceMouseEntered:f,format:S,iconActionFrom:h,iconSize:b,linkifyText:v,onContextMenu:g,onTab:k,onUntab:C,property:w,quickActionButtons:j,quickActionButtonsStyle:P,recordIconStyle:I,showIcon:_,store:A,textStyle:B,titlePropertyType:R,userExpandable:E,width:L}=e,V=(0,a().v3)(),{isMobile:F}=(0,a().Y0)(),H=(0,M().tz)(),W=(0,s().DP)(),D=(0,cn().X)("db_ux_chrome"),{baseStyles:K,collectionContextStore:U,propertySchema:N}=(0,n.useContext)(y().L8),z=(0,r().K8)((()=>{if("inlineEditable"===R)return(0,ar().yT)(A)}),[A,R],{useDeepEqual:!0}),{collectionViewBlockId:Q,collectionViewId:J}=(0,r().K8)((()=>{var e,t;return{collectionViewId:null==U||null===(e=U.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==U||null===(t=U.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[U]),q=(0,r().K8)((()=>{if("inlineEditable"!==R)return;const e=ur().A.state;return Boolean(e.isActive&&e.store.id===A.id)}),[A.id,R]),{icon:Y,iconStore:$,isEmptyPage:G,recordTable:Z,blockType:X,hasError:ee}=(0,r().K8)((()=>{const e=A.getIconStore();return{icon:A.getIcon(),iconStore:e,isEmptyPage:A.isEmptyPage(),recordTable:null==e?void 0:e.table,blockType:A.getType(),hasError:A.hasError()}}),[A],{useDeepEqual:!0}),te=(0,Zo().cP)(w),oe=(0,r().K8)((()=>{if(!te)return v?l().UY({store:A,propertySchema:(0,Ce().z)(N),property:w}):void 0;const e=A.getFormatStore().getKeyStore("uri").getValue(),t=e&&o(939768).Jf({str:e,allowNoProtocol:!1});return t&&(0,o(493208).e)(t,A.pointer.spaceId)}),[te,A,v,N,w]),ne=(0,n.useCallback)((()=>{if(U&&te){const e=(0,lr().sl)(U)||{};(0,o(464778).x)(V,{...e,block_id:A.id,property:w,from:l().zP(S),is_external_title_property_id:!0})}}),[U,V,S,w,A.id,te]),ie=(0,n.useCallback)((e=>{$&&le().createAndCommit({userAction:"TitleProperty.handleRecordIconChange",environment:V,canUndo:!0,perform:t=>{o(246826).KY({store:$,value:e,transaction:t})}})}),[V,$]),ae=(0,n.useCallback)((e=>{"Enter"!==(null==e?void 0:e.key)&&(U&&(0,re().E)({environment:V,collectionContextStore:U,block_id:A.id,property:"title",property_type:"text",from:"list"}),(0,o(714574).P)({store:A}))}),[V,A,U]),se=(0,n.useCallback)((e=>{e.target.scrollLeft=0}),[]),ce=(0,n.useCallback)((()=>{ur().A.setState({isActive:!1}),ir().clear({environment:V}),rr().Lt({environment:V,store:A})}),[A,V]),ue=(0,r().K8)((()=>{if(U){const e=U.searchQueryStore.state;return e.length>0?e:void 0}}),[U]),de=(0,r().K8)((()=>ro().qu.state??ue),[ue]),pe=(0,n.useMemo)((()=>({type:"page_property_value_match",collectionViewBlockId:Q,collectionViewId:J,propertyId:"title"})),[Q,J]),ye=(0,r().K8)((()=>{const e=ro().wb.state;return(0,o(792540).wc)(e)&&e.id===A.id?e:void 0}),[A.id]),me=(0,s().IS)((()=>{const e=D&&br.has(S);return{textStyle:{...K.textStyle,display:"inline",fontWeight:pt().Wy.medium,...B,marginRight:F?3:5},buttonStyle:{...K.buttonStyle,...i},quickActionButtonsStyle:{...P},buttonPressedStyle:{...K.buttonPressedStyle,background:"none"},buttonHoveredStyle:{...K.buttonHoveredStyle,background:"none"},recordIconStyle:{display:"inline-flex",verticalAlign:"text-top",...I},link:{display:"inline"},subitemCountIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},parentItemIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},discussionIndicator:{display:"inline-flex",alignItems:"center",color:W.text.tertiary,fontSize:12,fontWeight:pt().Wy.medium,verticalAlign:"text-top"},errorIcon:{display:"inline-block",verticalAlign:"text-top",marginLeft:1,marginRight:7,paddingBottom:4,width:nr().Ev.sm,fill:W.accentColors.orange[500]},content:e?{display:"flex",alignItems:"flex-start"}:{display:"contents"},iconContainer:e?{flexShrink:0}:{display:"contents"},restContainer:e?{flexGrow:1,minWidth:0}:{display:"contents"}}}),[D,S,K.textStyle,K.buttonStyle,K.buttonPressedStyle,K.buttonHoveredStyle,B,F,i,P,I,W.text.tertiary,W.accentColors.orange]),fe=(0,r().K8)((()=>{var e,t;switch(R){case"inlineEditable":const n=q?O().A.formatMessage(xr.typeAName):(null===(e=A.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:A.getRecordModel,intl:H,userTimeZone:(0,dt().P)()}))||H.formatMessage(xr.untitledBlock);return(0,x.jsx)(o(524702).A,{store:z,disabled:!q,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,disableShiftEnter:!0,onEnter:ce,onEsc:ce,onTab:k,onUntab:C,onChange:ae,onBlur:se,placeholder:n,style:me.textStyle,disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:pe});case"hidePlaceholderText":let r=null===(t=A.getTitleStore())||void 0===t?void 0:t.getValue();A.isType("external_object_instance_page")&&(r=A.getPropertyValue(w)),de&&de.length>0&&r&&(r=no().nu({textValue:r,blockId:A.id,textProps:pe,find:de,currentFocusedResult:ye}));const i=no().S5({environment:V,textValue:r&&{value:r,spaceId:(0,Xt().e)(A.pointer.spaceId)},parentStore:A,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,theme:W,emojiType:(0,oo().FN)(V),katex:V.KatexStore.getKatex(),formulaValueTypes:[]});return(0,x.jsx)("span",{style:me.textStyle,children:i});case"showPlaceholderAsTitle":return(0,x.jsx)(o(16006).A,{style:me.textStyle,store:A});default:(0,T().HB)(R)}}),[R,q,A,H,z,ce,k,C,ae,se,me.textStyle,pe,de,V,W,w,ye]),Se=(0,n.useMemo)((()=>({collection_id:u.id,recordTable:Z,source:h,block_type:X})),[u.id,Z,h,X]),he=(0,n.useMemo)((()=>D?"never"!==_&&("withContent"!==_||void 0!==Y):"never"!==_&&("withContent"!==_||void 0!==Y||!G)),[D,_,Y,G]),xe=(0,r().K8)((()=>U&&(0,sr().xC)({collectionContextStore:U,blockStore:A})),[U,A]),be=(0,r().K8)((()=>U&&(0,sr().Kk)({collectionContextStore:U,blockStore:A})),[U,A]);return(0,x.jsx)(p().P,{ref:t,editButtonClickProps:m,onContextMenu:g,style:me.buttonStyle,pressedStyle:me.buttonPressedStyle,hoveredStyle:me.buttonHoveredStyle,quickActionButtons:j,quickActionButtonsStyle:me.quickActionButtonsStyle,quickActionButtonsForceVisible:F?void 0:f,tooltipHide:!0,userExpandable:E,children:(0,x.jsxs)("div",{style:me.content,children:[(0,x.jsx)("div",{style:me.iconContainer,children:ee?(0,o(175882).exclamationMarkTriangleSmallIcon)(me.errorIcon):he?c?(0,x.jsx)(dr().B,{disabled:!1,icon:Y,isEmptyPage:G,size:b,style:me.recordIconStyle,store:A,bucket:"secure",onChange:ie,iconLoggingData:Se}):(0,x.jsx)(dr().B,{disabled:!0,icon:Y,isEmptyPage:G,size:b,style:me.recordIconStyle}):null}),(0,x.jsxs)("div",{style:me.restContainer,children:[!q&&oe?(0,x.jsx)(o(758740).A,{href:oe,external:te,onClick:ne,style:me.link,children:fe}):fe,void 0!==U&&xe?(0,x.jsx)("span",{style:me.parentItemIndicator,children:(0,x.jsx)(o(743147).n,{blockStore:A,collectionContextStore:U,columnWidth:L})}):null,void 0!==U&&be?(0,x.jsx)("span",{style:me.subitemCountIndicator,children:(0,x.jsx)(o(164124).W,{blockStore:A,collectionContextStore:U})}):null,(0,x.jsx)(o(932210).g,{store:A,iconStyle:me.discussionIndicator,buttonStyle:d})]})]})})}))),gr=(0,n.forwardRef)((function(e,t){const{store:o,handleOpenPeekPage:i,width:c}=e,u=(0,cn().X)("db_ux_chrome"),d=(0,a().v3)(),{isMobile:p}=(0,a().Y0)(),{collectionContextStore:S,canEdit:h,shouldWrap:b}=(0,n.useContext)(y().L8),v=(0,r().K8)((()=>(0,cr().W)(d,o.id)),[d,o]),g=(0,s().IS)((e=>({buttonStyle:{padding:f().QJ[m().j.Table].text},textStyle:u?{}:{...l().w_(e)},recordIconStyle:{height:22,width:22,margin:"-2px 3px 0px -2px"},dbCommentButton:{position:"relative",top:2,marginTop:-2.8}})),[u]),k=(0,r().K8)((()=>(null==S?void 0:S.shouldShowPageIcon())??!0),[S]),C=(0,n.useMemo)((()=>v?void 0:(0,x.jsx)(hr,{handleOpenPeekPage:i,store:o,showLabel:p||void 0===c||c>100,showIcon:!p})),[i,p,o,c,v]),w=wr(e,t,g);return(0,x.jsx)(vr,{...w,iconActionFrom:"collection_table_view",showIcon:k?"withContent":"never",iconSize:20,titlePropertyType:"hidePlaceholderText",quickActionButtons:C,linkifyText:!h,commentsIndicatorStyle:g.dbCommentButton,userExpandable:b,canEdit:h})})),kr=(0,n.forwardRef)((function(e,t){const{store:i}=e,{isPhone:l,isMobile:c}=(0,a().Y0)(),u=(0,a().v3)(),{canEdit:d,collectionContextStore:p}=(0,n.useContext)(y().L8),m=(0,r().K8)((()=>{const e=ur().A.state;return Boolean(e.isActive&&e.store.id===i.id)}),[i]),f=(0,r().K8)((()=>!!p&&p.isInHomeWidgetStore.state),[p]),h=(0,r().K8)((()=>(0,cr().W)(u,i.id)),[u,i]),b=(0,r().K8)((()=>(null==p?void 0:p.shouldShowPageIcon())??!0),[p]),v=(0,n.useMemo)((()=>!c&&!h&&(d&&!m?(0,x.jsx)(pr,{store:i}):(0,x.jsx)(hr,{store:i,showLabel:!1,showIcon:!0}))),[m,c,d,i,h]),g=(0,s().IS)((()=>({buttonStyle:{marginLeft:0,marginRight:0,paddingLeft:f?o(665579).VQ/2:void 0,flexGrow:1,flexShrink:1,flexBasis:"auto",maxWidth:void 0,minWidth:l?void 0:S().X},textStyle:{fontSize:f?14:16,whiteSpace:m?"pre":"nowrap",pointerEvents:m?void 0:"none",cursor:m?"text":void 0,width:"auto",textOverflow:m?void 0:"ellipsis"},recordIconStyle:{marginRight:5},actionButton:{marginLeft:10,marginRight:1,order:3}})),[m,f,l]),k=wr(e,t,g);return(0,x.jsx)(vr,{...k,iconActionFrom:"collection_list_view",showIcon:b?"always":"never",iconSize:f?16:22,editButtonClickProps:void 0,quickActionButtonsStyle:g.actionButton,quickActionButtons:v,titlePropertyType:"inlineEditable",canEdit:d})})),Cr=(0,n.forwardRef)((function(e,t){o(857639).log({level:"error",from:"BlockPropertyValue",type:"BlockPropertyValue.InvalidTitlePropertyFormat"});const r=wr(e,t),{canEdit:i}=(0,n.useContext)(y().L8);return(0,x.jsx)(vr,{...r,iconActionFrom:"collection_table_view",showIcon:"always",iconSize:20,titlePropertyType:"hidePlaceholderText",canEdit:i})}));function wr(e,t,o){const{collectionStore:n,disabled:r,forceMouseEntered:i,format:l,onContextMenu:a,onTab:s,onUntab:c,property:u,store:d,width:p}=e;return{ref:t,store:d,collectionStore:n,property:u,disabled:r,editButtonClickProps:(0,ae().QK)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,textStyle:null==o?void 0:o.textStyle,recordIconStyle:null==o?void 0:o.recordIconStyle,quickActionButtonsStyle:null==o?void 0:o.quickActionButtonsStyle,format:l,onTab:s,onUntab:c,forceMouseEntered:i,width:p}}var jr=()=>o(931075);const Pr=n.memo(n.forwardRef((function(e,t){var i;const{property:l,store:a,collectionStore:c,buttonStyle:u,editButtonClickProps:d,EmptyComponent:m}=e,{canEdit:f,propertySchema:S,baseStyles:h,collectionSchema:b}=(0,n.useContext)(y().L8),v=S,g=(0,r().K8)((()=>!(!v||!b)&&ar().E5(v,a,b)),[v,b,a]),k=(0,r().K8)((()=>{var e;if(c.isPageTreeCollection())return!0;const t=null==a||null===(e=a.getSpaceStore())||void 0===e?void 0:e.getModel();return!!t&&(0,jr().Xi)(t)}),[c,a]),C=!f||!g||!k,w=(0,s().IS)((e=>({buttonStyle:{...h.buttonStyle,...u,cursor:C?"text":"pointer"},buttonPressedStyle:h.buttonPressedStyle??{},buttonHoveredStyle:h.buttonHoveredStyle??{}})),[h.buttonHoveredStyle,h.buttonPressedStyle,h.buttonStyle,u,C]),j=(0,r().K8)((()=>{const e=a.getPropertyValue(l);return(0,jr().U1)(e)}),[l,a]),P=(0,n.useMemo)((()=>(0,jr().B2)(j)),[j]),I=(0,n.useMemo)((()=>{if("none"!==P.type)return(0,x.jsx)(o(360525).A,{verificationState:P,blockStore:a})}),[a,P]),_=(0,n.useMemo)((()=>{var e;if(!(!g||!k)||!b)return;if(!k)return(0,x.jsx)(M().sA,{defaultMessage:"Upgrade plan to edit verification",id:"VerificationPropertyButton.tooltip.nonWikiVerificationRestrictedToBusinessTier"});const t=null==v?void 0:v.verifier_property,o=t?null===(e=b[t])||void 0===e?void 0:e.name:void 0;return(0,x.jsx)(Ir,{verifierPropertyName:o})}),[g,b,k,null==v?void 0:v.verifier_property]),A="none"===P.type;return A&&void 0===m?null:(0,x.jsx)(p().P,{ref:t,editButtonClickProps:C?void 0:d,style:w.buttonStyle,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,tooltipPropertyValue:I,tooltipPropertyCaption:_,children:A&&void 0!==m?(0,x.jsx)(m,{}):(0,x.jsx)(o(880298).r,{verificationValue:j,fontSize:null===(i=h.buttonStyle)||void 0===i?void 0:i.fontSize})})})));function Ir(e){const{verifierPropertyName:t}=e;return t?(0,x.jsx)(M().sA,{defaultMessage:"Only people listed in {verifierPropertyName} can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToVerifier",values:{verifierPropertyName:(0,x.jsx)("span",{style:{fontWeight:pt().Wy.bold},children:t})}}):(0,x.jsx)(M().sA,{defaultMessage:"Only page owners can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToOwner"})}const _r=n.forwardRef((function(e,t){const o=Hr(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Table].text}})),[]));return(0,x.jsx)(Pr,{...o,EmptyComponent:Ie().rW})})),Ar=n.forwardRef((function(e,t){const o=Hr(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Page].text}})),[]));return(0,x.jsx)(Pr,{...o,EmptyComponent:Ie().ao})})),Br=n.forwardRef((function(e,t){const o=Hr(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.CompactPage].text}})),[]));return(0,x.jsx)(Pr,{...o,EmptyComponent:Ie().ao})})),Rr=n.forwardRef((function(e,t){const o=Hr(e,t);return(0,x.jsx)(Pr,{...o,EmptyComponent:Ie().Fe})})),Mr=n.forwardRef((function(e,t){const{collectionStore:o,store:i,showIfEmpty:l}=e,{propertySchema:a}=(0,n.useContext)(y().L8),s=a,c=(0,r().K8)((()=>o.getSchema()),[o]),u=(0,r().K8)((()=>!!s&&ar().E5(s,i,c)),[s,c,i]),d=Hr(e,t,(0,S().F)(t,e.collectionStore,e.property,"verification"));return(0,x.jsx)(Pr,{...d,EmptyComponent:l&&u?Ie().Jb:void 0})})),Er=n.forwardRef((function(e,t){const{collectionStore:o,store:i,showIfEmpty:l}=e,{propertySchema:a}=(0,n.useContext)(y().L8),c=a,u=(0,r().K8)((()=>o.getSchema()),[o]),d=(0,r().K8)((()=>!!c&&ar().E5(c,i,u)),[c,u,i]),p=Hr(e,t,(0,s().IS)((()=>({buttonStyle:{padding:f().QJ[m().j.Board].text}})),[]));return(0,x.jsx)(Pr,{...p,EmptyComponent:l&&d?Ie().Jb:void 0})})),Tr=n.forwardRef((function(e,t){const o=Hr(e,t);return(0,x.jsx)(Pr,{...o})})),Lr=n.forwardRef((function(e,t){const o=Hr(e,t);return(0,x.jsx)(Pr,{...o})})),Vr=n.forwardRef((function(e,t){const o=Hr(e,t);return(0,x.jsx)(Pr,{...o})})),Fr=n.forwardRef((function(e,t){const o=Hr(e,t);return(0,x.jsx)(Pr,{...o})})),Or=n.forwardRef((function(e,t){const o=Hr(e,t);return(0,x.jsx)(Pr,{...o})}));function Hr(e,t,o){const{store:n,collectionStore:r,property:i,onClick:l,onContextMenu:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ae().QK)(e),onClick:l,onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle}}const Wr=n.memo(n.forwardRef((function(e,t){const{property:o,format:n,propertyType:r,innerProps:i}=e;if(!r)return null;const l=Dr[n][r];return null===l?null:(0,x.jsx)(l,{ref:t,...i,property:o,format:n})}))),Dr={[m().j.Table]:{checkbox:de,created_by:Yo().JJ,created_time:De().wW,date:De().wW,email:Ae,file:qe,formula:Ft,last_edited_by:Yo().JJ,last_edited_time:De().wW,last_visited_time:De().wW,location:ko,multi_select:To().jd,number:Oo,person:Yo().JJ,phone_number:Ae,relation:$o().Kr,rollup:Sn,select:_n().wE,status:Mn,text:Qn,title:gr,url:Ae,verification:_r,auto_increment_id:g,button:z,geo_point:so},[m().j.Board]:{checkbox:fe,created_by:Yo().p$,created_time:De().Gx,date:De().Gx,email:Ee,file:Xe,formula:Nt,last_edited_by:Yo().p$,last_edited_time:De().Gx,last_visited_time:De().Gx,location:Io,multi_select:To().Dl,number:Do,person:Yo().p$,phone_number:Ee,relation:$o().QE,rollup:gn,select:_n().w4,status:Vn,text:Yn,title:Cr,url:Ee,verification:Er,auto_increment_id:j,button:$,geo_point:po},[m().j.Calendar]:{checkbox:Se,created_by:Yo().Jd,created_time:De().y9,date:De().y9,email:Te,file:et,formula:zt,last_edited_by:Yo().Jd,last_edited_time:De().y9,last_visited_time:De().y9,location:_o,multi_select:To().V6,number:Ko,person:Yo().Jd,phone_number:Te,relation:$o().eH,rollup:kn,select:_n().Y0,status:Fn,text:$n,title:Cr,url:Te,verification:Tr,auto_increment_id:P,button:G,geo_point:yo},[m().j.ListView]:{checkbox:me,created_by:Yo().VW,created_time:De().g$,date:De().g$,email:Me,file:Ze,formula:Ut,last_edited_by:Yo().VW,last_edited_time:De().g$,last_visited_time:De().g$,location:Po,multi_select:To().h3,number:Wo,person:Yo().VW,phone_number:Me,relation:$o().eM,rollup:vn,select:_n().Un,status:Ln,text:qn,title:kr,url:Me,verification:Mr,auto_increment_id:w,button:Y,geo_point:uo},[m().j.GalleryView]:{checkbox:he,created_by:Yo().bZ,created_time:De().UP,date:De().UP,email:Le,file:tt,formula:Qt,last_edited_by:Yo().bZ,last_edited_time:De().UP,last_visited_time:De().UP,location:Ao,multi_select:To().rw,number:Uo,person:Yo().bZ,phone_number:Le,relation:$o().iM,rollup:Cn,select:_n().WS,status:On,text:Gn,title:Cr,url:Le,verification:Lr,auto_increment_id:I,button:Z,geo_point:mo},[m().j.Timeline]:{checkbox:xe,created_by:Yo().cE,created_time:De().vy,date:De().vy,email:Ve,file:ot,formula:Jt,last_edited_by:Yo().cE,last_edited_time:De().vy,last_visited_time:De().vy,location:Bo,multi_select:To().ej,number:No,person:Yo().cE,phone_number:Ve,relation:$o().DE,rollup:wn,select:_n().Bb,status:Hn,text:Zn,title:Cr,url:Ve,verification:Vr,auto_increment_id:_,button:X,geo_point:fo},[m().j.Page]:{checkbox:pe,created_by:Yo().e7,created_time:De().zI,date:De().zI,email:Be,file:Ye,formula:Ht,last_edited_by:Yo().e7,last_edited_time:De().zI,last_visited_time:De().zI,location:Co,multi_select:To().I8,number:Fo,person:Yo().e7,phone_number:Be,relation:$o().hF,rollup:hn,select:_n().DE,status:En,text:zn,title:Cr,url:Be,verification:Ar,auto_increment_id:v,button:Q,geo_point:ao},[m().j.CompactPage]:{checkbox:ye,created_by:Yo()._R,created_time:De().v,date:De().v,email:Re,file:$e,formula:Dt,last_edited_by:Yo()._R,last_edited_time:De().v,last_visited_time:De().v,location:wo,multi_select:To().S1,number:Ho,person:Yo()._R,phone_number:Re,relation:$o().$s,rollup:xn,select:_n().P0,status:Tn,text:Jn,title:Cr,url:Re,verification:Br,auto_increment_id:k,button:J,geo_point:co},[m().j.Relation]:{checkbox:be,created_by:Yo().L$,created_time:De().Qz,date:De().Qz,email:Fe,file:nt,formula:qt,last_edited_by:Yo().L$,last_edited_time:De().Qz,last_visited_time:De().Qz,location:Ro,multi_select:To().xV,number:zo,person:Yo().L$,phone_number:Fe,relation:$o().I5,rollup:jn,select:_n().O2,status:Wn,text:Xn,title:Cr,url:Fe,verification:Fr,auto_increment_id:A,button:ee,geo_point:So},[m().j.RelationSection]:{checkbox:ve,created_by:Yo().K2,created_time:De().RM,date:De().RM,email:Oe,file:rt,formula:Yt,last_edited_by:Yo().K2,last_edited_time:De().RM,last_visited_time:De().RM,location:Mo,multi_select:To().ER,number:Qo,person:Yo().K2,phone_number:Oe,relation:$o().$$,rollup:Pn,select:_n().VM,status:Dn,text:er,title:Cr,url:Oe,verification:Or,auto_increment_id:B,button:te,geo_point:ho},[m().j.Mini]:{checkbox:ge,created_by:Yo().K1,created_time:De().BP,date:De().BP,email:He,file:Ge,formula:Kt,last_edited_by:Yo().K1,last_edited_time:De().BP,last_visited_time:De().BP,location:jo,multi_select:To()._Z,number:Jo,person:Yo().K1,phone_number:He,relation:$o().F1,rollup:bn,select:_n().dZ,status:Kn,text:tr,title:Cr,url:He,verification:Rr,auto_increment_id:C,button:q,geo_point:xo},[m().j.PropertyModule]:{checkbox:pe,created_by:Yo().oN,created_time:De().zI,date:De().zI,email:Be,file:it,formula:Ht,last_edited_by:Yo().oN,last_edited_time:De().zI,last_visited_time:De().zI,location:Co,multi_select:To().I8,number:Fo,person:Yo().oN,phone_number:Be,relation:$o().bn,rollup:hn,select:_n().DE,status:En,text:zn,title:Cr,url:Be,verification:Ar,auto_increment_id:v,button:Q,geo_point:ao}},Kr=n.memo((function(e){const{property:t,collectionStore:a,format:s,formDataStore:c,onTab:u,onUntab:d,onEnter:p,onEsc:m,onBgClick:f,onOpenProperty:S,store:h}=e,b=(0,o(761408).y)({collectionStore:a,property:t}),v=function(e,t,o){const n=(0,i().Ks)();return(0,r().K8)((()=>{var r;const i=e.getSchema();return(null==t||null===(r=t.getFormState())||void 0===r||null===(r=r.collectionSchema)||void 0===r?void 0:r[o])??i[o]??(null==n?void 0:n.normalizedSchemaStore.state[o])}),[n,t,e,o],{debugName:"usePropertySchema"})}(a,c,b),g=(0,n.useContext)(o(789550).R),k=(0,n.useRef)(null);return(0,o(790748).b)(o(57618).A,(()=>({getNode:()=>{const{current:e}=k;return e?"getNode"in e?e.getNode():e:null},props:{onTab:u,onUntab:d,onEnter:p,onEsc:m,onBgClick:f,onOpenProperty:S,property:b,format:s,store:h},getScrollerContext:()=>g})),[g,u,d,p,m,f,S,b,s,h]),null!=v&&v.type?(0,x.jsx)(y().qN,{innerProps:e,property:b,unmappedProperty:t,propertySchema:v,containerRef:k,children:(0,l().NN)(s)?(0,x.jsx)(o(130636).T,{ref:k,innerProps:e,format:s,property:b,propertyType:null==v?void 0:v.type}):(0,x.jsx)(Wr,{ref:k,innerProps:e,format:s,property:b,propertyType:null==v?void 0:v.type})}):null}))},40106:(e,t,o)=>{o.d(t,{a:()=>i});var n=o(296540),r=o(474848);const i=n.memo((function(e){const{recordPointer:t,parentStore:i,linkify:a,withComma:s,style:c,noUnderline:u,noWrap:d,disableTooltip:p}=e,{canEdit:y,shouldWrap:m,baseStyles:f,containerRef:S}=(0,n.useContext)(o(234359).L8),h=(0,o(425497).Ug)(null==f?void 0:f.tokenFormat),x=(0,o(401497).IS)((()=>({relationToken:{margin:0,...c}})),[c]);return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)(o(566081).A,{blockId:t.id,isSingle:!1,parentStore:i,shouldWrap:m&&!d,format:h,style:x.relationToken,containingParentRef:S,clickTitleBehavior:l({linkify:a,isReadOnly:!y}),noUnderline:u,disableTooltip:p,disableLinks:"never"===a},t.id),s?", ":""]})}));function l(e){let{linkify:t,isReadOnly:n}=e;switch(t){case"always":return"peek";case"never":return;case"whenReadOnly":return n?"peek":void 0;default:(0,o(534177).HB)(t)}}},41459:(e,t,o)=>{o.d(t,{j:()=>n});let n=function(e){return e[e.Table=0]="Table",e[e.Board=1]="Board",e[e.Calendar=2]="Calendar",e[e.ListView=3]="ListView",e[e.GalleryView=4]="GalleryView",e[e.Timeline=5]="Timeline",e[e.Page=6]="Page",e[e.CompactPage=7]="CompactPage",e[e.Relation=8]="Relation",e[e.RelationSection=9]="RelationSection",e[e.Mini=10]="Mini",e[e.PropertyModule=11]="PropertyModule",e[e.FormEditor=12]="FormEditor",e[e.FormViewer=13]="FormViewer",e}({})},48105:(e,t,o)=>{o.d(t,{J:()=>y,Y:()=>p});var n=o(296540),r=()=>o(484714),i=()=>o(401497),l=()=>o(955825),a=()=>o(234359),s=()=>o(41459),c=()=>o(828180),u=o(474848);const d=4;function p(e){const{children:t,align:o,sticky:n,style:r}=e,a=(0,i().IS)((t=>{const n=e.height||24,i=(c().tt-n)/2;return{buttonWrapperStyle:{display:"flex",justifyContent:"right"===o?"end":"start",position:"absolute",top:i,right:0,left:0,zIndex:2,margin:`0 ${d}px`,pointerEvents:"none",...r},innerWrapperStyle:{display:"flex",pointerEvents:"auto",background:t.surface.elevated,padding:"2px",height:n,boxShadow:t.shadowSM,borderRadius:6},stickyStyle:{position:"sticky",right:d}}}),[o,e.height,r]);return t?(0,u.jsx)("div",{style:a.buttonWrapperStyle,children:(0,u.jsx)("div",{...(0,l().AH)(a.innerWrapperStyle,n&&a.stickyStyle),className:"quickActionContainer",children:t})}):null}function y(e){const{format:t,align:o}=e;switch(t){case s().j.Table:return(0,u.jsx)(x,{...e,align:o??"right"});case s().j.PropertyModule:case s().j.Page:return(0,u.jsx)(f,{...e,align:o??"right"});case s().j.Board:return(0,u.jsx)(m,{...e,align:o??"right"});case s().j.GalleryView:return(0,u.jsx)(S,{...e,align:o??"right"});case s().j.ListView:return(0,u.jsx)(h,{...e,align:o??"right"});default:return(0,u.jsx)(p,{...e,align:o??"right"})}}function m(e){const t=(0,i().IS)((()=>({buttonWrapperStyle:{top:0,...e.style}})),[e.style]);return(0,u.jsx)(p,{...e,style:t.buttonWrapperStyle})}function f(e){const{propertyModule:t}=(0,n.useContext)(a().L8),o=(0,i().IS)((()=>({buttonWrapperStyle:{top:t&&"style"in t&&"large"===t.style?10:5,...e.style}})),[t,e.style]);return(0,u.jsx)(p,{...e,style:o.buttonWrapperStyle})}function S(e){const t=(0,i().IS)((()=>({buttonWrapperStyle:{top:-1,...e.style}})),[e.style]);return(0,u.jsx)(p,{...e,style:t.buttonWrapperStyle})}function h(e){const t=(0,i().IS)((()=>({buttonWrapperStyle:{position:void 0,margin:0,...e.style}})),[e.style]);return(0,u.jsx)(p,{...e,style:t.buttonWrapperStyle})}function x(e){const{align:t="right"}=e,{isMobile:o}=(0,r().Y0)(),{shouldWrap:l,propertyFormat:s}=(0,n.useContext)(a().L8),c=null==s?void 0:s.width,y=(0,n.useMemo)((()=>c&&c<=32?d-4:c&&c<50?d-2:d),[c]),m=(0,i().IS)((()=>({buttonWrapperStyle:{...e.style,...o&&l?{position:"sticky",float:t,marginRight:0,marginLeft:2,right:y}:{margin:`0 ${y}px`}}})),[t,y,o,e.style,l]);return(0,u.jsx)(p,{...e,style:m.buttonWrapperStyle,sticky:!0})}},74513:(e,t,o)=>{o.d(t,{V:()=>n});const n=32},88306:(e,t,o)=>{o.d(t,{C:()=>i});var n=o(296540),r=o(474848);const i=n.forwardRef((function(e,t){let{children:i,fontColor:l,style:a,isRightAligned:s,isEmpty:c}=e;const{baseStyles:u}=(0,n.useContext)(o(234359).L8),d=(0,o(401497).IS)((e=>({textStyle:{...c?u.emptyTextStyle??u.textStyle:u.textStyle,...a,...s?{justifyContent:"right",textAlign:"right"}:{},..."light"===l?{color:e.text.tertiary}:{}}})),[c,u.emptyTextStyle,u.textStyle,a,s,l]);return(0,r.jsx)("div",{ref:t,style:d.textStyle,children:i})}))},119444:(e,t,o)=>{o.r(t),o.d(t,{BlockPropertyButtonExternalPropertyTooltip:()=>y});o(296540);var n=()=>o(847249),r=()=>o(401497),i=()=>o(488173),l=()=>o(959013),a=()=>o(504836),s=()=>o(252833),c=()=>o(351360),u=o(474848);const d=(0,l().YK)({upgrade_to_enterprise:{defaultMessage:"Upgrade to Enterprise to edit this property",id:"BlockPropertyButtonExternalPropertyTooltip.upgradeToEnterprise"},two_way_sync_not_enabled:{defaultMessage:"2-way sync required to edit",id:"BlockPropertyButtonExternalPropertyTooltip.twoWaySyncRequired"},property_not_editable:{defaultMessage:"This property is not editable",id:"BlockPropertyButtonExternalPropertyTooltip.propertyNotEditable"},connect_to_integration:{defaultMessage:"Connection to {integration} required to edit",id:"BlockPropertyButtonExternalPropertyTooltip.connectToIntegration"},full_access:{defaultMessage:"You have full access to this property",id:"BlockPropertyButtonExternalPropertyTooltip.fullAccess"}}),p=(0,l().YK)({clickToGetStarted:{defaultMessage:"Click to get started",id:"BlockPropertyButtonExternalPropertyTooltip.clickToGetStarted"},dataCannotBeEdited:{defaultMessage:"Data synced from {integration} cannot be edited",id:"BlockPropertyButtonExternalPropertyTooltip.dataCannotBeEdited"}});function y(e){let{collectionContextStore:t,propertySchema:o,baseTooltip:y}=e;const m=(0,n().K8)((()=>{var e;return"enterprise"===(null===(e=c().default.getState().currentSpaceStore)||void 0===e?void 0:e.getSubscriptionTier())}),[]),f=(0,r().IS)((e=>({action:{color:e.text.contrastSecondary}})),[]),S=(0,n().K8)((()=>{var e,n,r;const l=null==t||null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().external_collection_type;if(!(0,s().cd)(l)||!(0,a().CS)())return{twoWaySyncUserState:void 0,integration:l};if(!m)return{twoWaySyncUserState:(0,i().fW)({isUserOnEnterprisePlan:m}),integration:l};const c=Boolean(null==t||null===(n=t.collectionStore())||void 0===n||null===(n=n.getFormat())||void 0===n||null===(n=n.sync_state)||void 0===n?void 0:n.enable_two_way_sync);if(!c)return{twoWaySyncUserState:(0,i().fW)({isUserOnEnterprisePlan:m,twoWaySyncEnabled:c}),integration:l};const u=Boolean(null==t||null===(r=t.externalSyncStore)||void 0===r||null===(r=r.state)||void 0===r?void 0:r.shouldAllowUserToEditSyncedCollection()),d="read_write"===(null==o?void 0:o.synced_permissions);return{twoWaySyncUserState:(0,i().fW)({isUserOnEnterprisePlan:m,twoWaySyncEnabled:c,canEdit:u,isEditableProperty:d}),integration:l}}),[m,t,o]);if(S.twoWaySyncUserState){if("full_access"===S.twoWaySyncUserState)return y;if("connect_to_integration"===S.twoWaySyncUserState||"two_way_sync_not_enabled"===S.twoWaySyncUserState){const e={...d[S.twoWaySyncUserState],values:{integration:S.integration??"integration"}};return(0,u.jsxs)("div",{children:[(0,u.jsx)(l().sA,{...e}),(0,u.jsx)("div",{style:f.action,children:(0,u.jsx)(l().sA,{...p.clickToGetStarted})})]})}return(0,u.jsx)(l().sA,{...d[S.twoWaySyncUserState]})}{const e={...p.dataCannotBeEdited,values:{integration:S.integration??"integration"}};return(0,u.jsx)(l().sA,{...e})}}},167677:(e,t,o)=>{o.d(t,{h:()=>i});var n=o(296540),r=o(474848);const i=n.forwardRef((function(e,t){let{children:i,style:l,isRightAligned:a,className:s}=e;const{baseStyles:c}=(0,n.useContext)(o(234359).L8),u=(0,o(401497).IS)((()=>({tokenWrapStyle:{...c.tokenWrapStyle,...a?{justifyContent:"end"}:void 0,...l}})),[c.tokenWrapStyle,l,a]);return(0,r.jsx)("div",{ref:t,style:u.tokenWrapStyle,className:s,children:i})}))},171722:(e,t,o)=>{o.d(t,{s:()=>l,y:()=>a});o(898992),o(354520),o(581454);var n=()=>o(847249),r=()=>o(955825),i=()=>o(299545);function l(e){let{store:t,propertyId:o}=e;const l=(0,n().K8)((()=>{var e;return t&&o?null===(e=(0,i().O3)(t,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===o)))||void 0===e||null===(e=e[0])||void 0===e?void 0:e.id:void 0}),[t,o]);return l?(0,r().wV)({discussionId:l}):void 0}function a(e){let{store:t,propertyId:o}=e;const l=(0,n().K8)((()=>t&&o?(0,i().O3)(t,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===o)).map((e=>e.id)):void 0),[t,o]);return l?l.map((e=>(0,r().wV)({discussionId:e}))):void 0}},178788:(e,t,o)=>{o.d(t,{A:()=>d});var n=o(296540),r=()=>o(847249),i=()=>o(401497),l=()=>o(919709),a=()=>o(116008),s=()=>o(921855),c=()=>o(735372),u=o(474848);const d=n.memo((function(e){const{parentStore:t,withComma:d,linkifyUrls:p,disableCommentHighlight:y,disableLinks:m,shouldTruncate:f,clampLines:S,textValue:h}=e,x=(0,o(484714).v3)(),b=(0,i().DP)(),v=(0,o(712030).Ol)();(0,n.useEffect)((()=>{void 0!==h&&x.KatexStore.loadIfNeeded((()=>h))}),[x.KatexStore,h]);const{collectionContextStore:g,property:k}=(0,n.useContext)(o(234359).L8),{collectionViewBlockId:C,collectionViewId:w}=(0,r().K8)((()=>{var e,t;return{collectionViewId:null==g||null===(e=g.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==g||null===(t=g.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[g]),j=(0,r().K8)((()=>x.KatexStore.getKatex()),[x.KatexStore]),P=(0,r().K8)((()=>{const e=c().qu.state,o=c().wb.state;return e&&k&&h?s().nu({textValue:h,blockId:t.id,textProps:{type:"page_property_value_match",collectionViewBlockId:C,collectionViewId:w,propertyId:k},find:e,currentFocusedResult:o}):h}),[k,h,t.id,C,w]),I=(0,r().K8)((()=>{if(a().A.getPropertyId()!==k||a().A.getBlockStore()!==t)return P;const e=a().A.getMultiSelection();return e?l().Mwp({textValue:P,selection:{startIndex:e.start.index,endIndex:e.end.index},annotation:[l().Ifu.TemporaryComment]}):h?l().Mwp({textValue:P,selection:{startIndex:0,endIndex:l().qAZ(h).length},annotation:[l().Ifu.TemporaryComment]}):P}),[t,k,h,P]),_=(0,r().K8)((()=>void 0===I?null:s().S5({environment:x,textValue:I&&{value:I,spaceId:(0,o(161479).e)(t.pointer.spaceId)},parentStore:t,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:y??!1,disabled:!0,theme:b,disableLinks:m??!1,emojiType:v,katex:j,formulaValueTypes:[],stopLinkPropagation:!0,linkTargetBlank:!0})),[I,x,t,y,b,m,v,j]),A=(0,n.useMemo)((()=>{if(!p||void 0===h)return null;const e=(0,l().k4p)(h);return(0,o(735577).A)(e)?(0,o(713998).MO)(h):null}),[p,h]),B=(0,i().IS)((e=>({text:{...f&&!S?o(284371).RC:void 0,...f&&S?{...(0,o(115512).pA)(S),overflow:"hidden",textOverflow:"ellipsis"}:{}}})),[f,S]);return(0,u.jsxs)("span",{style:B.text,children:[A?(0,u.jsx)(o(187485).A,{href:A,style:{display:"inline",pointerEvents:"auto",...(0,o(458366).w_)(b)},external:!0,onClick:e=>e.stopPropagation(),children:_}):_,d?", ":null]})}))},234359:(e,t,o)=>{o.d(t,{L8:()=>b,O2:()=>C,dm:()=>k,qN:()=>v});var n=o(296540),r=()=>o(484714),i=()=>o(847249),l=()=>o(443239),a=()=>o(970013),s=()=>o(713998),c=()=>o(416504),u=()=>o(862292),d=()=>o(909470),p=()=>o(972435),y=()=>o(645873),m=()=>o(963589),f=()=>o(508496),S=()=>o(41459),h=()=>o(414712),x=o(474848);const b=(0,n.createContext)({collectionContextStore:void 0,propertySchema:void 0,property:void 0,propertyFormat:void 0,isEmptyStore:o(757695).default.createValue(!1),canEdit:!1,disabled:!0,shouldRenderTooltip:!1,shouldWrap:!1,baseStyles:{},format:0,containerRef:null,store:void 0,shouldShowMultiSelectCheckbox:void 0,propertyIndex:void 0,collectionSchema:void 0});b.displayName="BlockPropertyValueContext";const v=n.memo((function(e){const{children:t,unmappedProperty:l,property:a,propertySchema:s,containerRef:c}=e,{format:d,disabled:p,store:m,tableWrap:f,collectionStore:h,shouldSetCellHeight:v,isLast:k,locked:w,showIfEmpty:j,shouldShowMultiSelectCheckbox:P,propertyIndex:I,propertyModule:_,formQuestionStore:A,formDataStore:B,onClose:R}=e.innerProps,M=(0,r().v3)(),{value:E}=(0,y().fJ)(u().T.formulas),T=(0,o(175116).Ks)(),[L,V,F]=(0,i().K8)((()=>{var e;const t=null==T?void 0:T.getPropertyFormat(l??a);let o=!1;B&&A&&(o=Boolean(B.getQuestionError(A.id)));const n=null==B||null===(e=B.getFormState())||void 0===e?void 0:e.collectionSchema;return n?[n,t,o]:[h.getSchema(),t,o]}),[T,h,B,A,a,l]),O=(0,o(551619).Sm)(m),H=C({store:m,collectionStore:h,property:a,disabled:p,format:d,propertySchema:s,collectionContextStore:T,writeStateType:"edit"}),W=function(e,t){return e===S().j.Page||e===S().j.Table&&t||e===S().j.Board&&t||e===S().j.GalleryView&&t||e===S().j.FormViewer}(d,f),D=_&&"style"in _&&"large"===_.style,K=(0,o(425497).x7)({shouldSetCellHeight:v,format:d,shouldWrap:W,isLast:k,locked:w,disabled:p,showIfEmpty:j,isInvalidFormAnswer:F,isLargeModule:D}),U=function(e,t,o,n,r,l,a,s){return(0,i().K8)((()=>!![S().j.Board,S().j.GalleryView,S().j.ListView,S().j.Relation,S().j.RelationSection].includes(r)||(r===S().j.Mini?!g(e,t,o,null==n?void 0:n.type,a.currentUser.id,s):!(!l||!S().j.Page))),[t,a.currentUser.id,r,s,l,o,null==n?void 0:n.type,e])}(m,L,a,s,d,O,M,E),N=(0,n.useMemo)((()=>{let e;return{store:m,collectionContextStore:T,property:a,propertySchema:s,propertyFormat:V,isEmpty:!1,canEdit:H,disabled:p,shouldRenderTooltip:U,shouldWrap:W,baseStyles:K,format:d,containerRef:c,shouldShowMultiSelectCheckbox:P,propertyIndex:I,isExternallyImportedAndSyncedPage:O,propertyModule:_,onClose:R,collectionSchema:L,get isEmptyStore(){return e||(e=new(o(496506).default)((()=>g(m,L,a,null==s?void 0:s.type,M.currentUser.id,E)),{debugName:"BlockPropertyValueContext.isEmptyStore"})),e}}}),[m,T,a,s,V,H,p,U,W,K,d,c,P,I,O,_,R,L,M.currentUser.id,E]);return(0,x.jsx)(b.Provider,{value:N,children:t})}));function g(e,t,o,n,r,i){return!!(o&&e&&e.isDefined())&&(!!t&&("checkbox"!==n&&"button"!==n&&"created_time"!==n&&"created_by"!==n&&"last_edited_time"!==n&&"last_edited_by"!==n&&"formula"!==n&&"rollup"!==n&&"auto_increment_id"!==n&&(0,s().r8)({block:e.getModel(),property:o,schema:t,getRecordModel:e.getRecordModel,userTimeZone:(0,c().P)(),intl:p().A.getIntl(),userId:r,experimentService:f().default,collectionFeatureGates:(0,d().i)(),formulasModule:i})))}function k(e,t,o,n){const l=(0,r().v3)(),{value:a}=(0,y().fJ)(u().T.formulas);return(0,i().K8)((()=>g(e,t,o,null==n?void 0:n.type,l.currentUser.id,a)),[t,l.currentUser.id,o,null==n?void 0:n.type,e,a],{debugName:"BlockPropertyValueContext.useIsBPVEmpty"})}function C(e){const{store:t,collectionStore:o,property:n,disabled:r,format:c,propertySchema:u,collectionContextStore:d,writeStateType:p}=e,y=(0,m().X)("jira_2_way_sync");return(0,i().K8)((()=>!!(t&&o&&n)&&(!(c===S().j.Calendar||c===S().j.Timeline||(0,l().u)(n)||(0,a().z3)(u)||(0,h().Lp)({collectionStore:o,property:n,propertySchema:u})||null!=d&&d.isUnlistedViewStore.state)&&(r||!t.canEdit()||t.isNonEditableStateStore().state?"edit"!==p&&(t.canComment()&&!t.isNavigableAncestorNonCommentableState()):!(0,h().ni)({store:t,collectionStore:o,collectionContextStore:d,propertySchema:u,property:n,isJiraTwoWaySyncEnabled:y})&&!(!o.isExternallyImportedAndSyncedCollection()&&(0,s().VF)(t.getModel(),n,t.getRecordModel))))),[c,n,u,o,d,r,t,p,y],{debugName:`BlockPropertyValueContext.useWriteState|${p}`})}},268925:(e,t,o)=>{o.d(t,{p$:()=>_,Jd:()=>A,_R:()=>w,bZ:()=>B,VW:()=>I,K1:()=>j,e7:()=>C,de:()=>b,oN:()=>P,L$:()=>M,K2:()=>E,JJ:()=>k,cE:()=>R,Dd:()=>T});o(16280),o(898992),o(354520),o(430670),o(581454);var n=o(296540),r=()=>o(484714),i=()=>o(847249),l=()=>o(401497),a=()=>o(764880),s=()=>o(784892),c=()=>o(534177),u=()=>o(630116),d=()=>o(821300),p=()=>o(234359),y=()=>o(414712),m=()=>o(859118),f=()=>o(962730),S=o(474848);function h(e){let{renderOrigin:t,actors:n,placement:i=f().W.Bottom,alignment:a=f().C.Start}=e;const s=(0,r().WS)(),c=(0,l().IS)((()=>({scrollContainer:{maxHeight:"min(50vh, 300px)",overflowY:"auto"},listContainer:{display:"flex",flexDirection:"column",gap:6,paddingTop:6,paddingBottom:6},tooltip:{maxWidth:300,paddingTop:0,paddingBottom:0}})),[]);return(0,S.jsx)(o(859428).A,{placement:i,alignment:a,disableTooltip:s||n.length<1,render:t,style:c.tooltip,allowHover:!0,renderTooltip:e=>(0,S.jsx)("div",{...e,style:c.scrollContainer,children:(0,S.jsx)("div",{style:c.listContainer,children:n.map((e=>e instanceof u().LU?(0,S.jsx)(o(994006).A,{userStore:e,avatarSize:20,inline:!0,hasTooltip:!1},e.id):e instanceof u().vK?(0,S.jsx)(o(427636).A,{botStore:e,avatarSize:20},e.id):null))})})})}const x=n.memo(h),b=n.memo(n.forwardRef((function(e,t){const{buttonStyle:r,onContextMenu:i,editButtonClickProps:a,property:c,store:u,EmptyComponent:d,tokenLimit:m,quickActionButtons:f,width:h,formQuestionStore:x,collectionSchema:b,limitTokensToSingleTruncatedLine:k,userExpandable:C,generateButtonStyles:w}=e,{propertySchema:j,baseStyles:P,format:I}=(0,n.useContext)(p().L8),_=(0,y().DZ)(u,c,j),A=(0,o(425497).Ug)(null==P?void 0:P.tokenFormat),B=g({store:u,property:c,propertySchema:j,format:I}),R=0===B.length,M=(0,l().IS)((e=>({buttonStyle:{...P.buttonStyle,...r,...(null==w?void 0:w(e,R))||{}},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},tokensContainer:{...A===s().NY.Inline?{gap:0}:{},...k&&{display:"flex",...o(284371).RC}},actorTokenOverlap:{...A===s().NY.Inline?{margin:o(848401).vb[A].margin}:{}},moreToken:{margin:0,...k&&{flexShrink:0}}})),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,r,R,k,w,A]);return R&&void 0===d?null:(0,S.jsx)(o(494585).P,{ref:t,editButtonClickProps:a,onContextMenu:i,style:M.buttonStyle,pressedStyle:M.buttonPressedStyle,hoveredStyle:M.buttonHoveredStyle,tooltipHide:A===s().NY.Inline,quickActionButtons:f,width:h,formQuestionStore:x,collectionSchema:b,userExpandable:C,children:R&&void 0!==d&&!_?(0,S.jsx)(d,{}):(0,S.jsx)(v,{values:B,tokenLimit:m,tokenFormat:A,styles:M,store:u,property:c,limitTokensToSingleTruncatedLine:k??!1})})})));function v(e){let{values:t,tokenLimit:n,tokenFormat:r,styles:s,store:u,property:d,limitTokensToSingleTruncatedLine:p}=e;const y=t.slice(0,n),m=(0,l().DP)(),f=(0,i().K8)((()=>{if(u)return(0,o(299545).O3)(u,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===d))}),[u,d]),h=(0,o(358167).v)({blockId:null==u?void 0:u.id,propertyId:d}),x=f&&(null==f?void 0:f.length)>0||h,b=(0,l().IS)((()=>({personTokenHighlightStyle:x?{marginLeft:3,marginRight:3,maxWidth:"fit-content",display:"inline-block"}:{},wrapperStyle:{...s.tokensContainer,...x?{...(0,o(191772).sQ)(m),paddingTop:9,paddingBottom:0,lineHeight:2,...p?{display:"flex"}:{flexWrap:"wrap",display:"inline"}}:{}}})),[x,p,s.tokensContainer,m]),v=(0,o(171722).s)({propertyId:d,store:u});return(0,S.jsxs)(o(167677).h,{className:v,style:b.wrapperStyle,children:[y.map(((e,n)=>(0,a().Pu)(e)?(0,S.jsx)(o(370618).A,{actorPointer:e,style:{...n<t.length-1&&s.actorTokenOverlap,...b.personTokenHighlightStyle,...p&&{width:"100%",flexShrink:1}}},e.id):(0,o(919709).MMZ)(e)?(0,S.jsx)(o(422464).W,{templateVariableType:e},`person-property-value-${e}`):void(0,c().ub)(e))),n&&t.length>n&&(0,S.jsx)(o(317958).A,{count:t.length-n,format:r,style:s.moreToken,fixedHeight:!0,isCompact:!0})]})}function g(e){let{property:t,store:n,propertySchema:r,format:l}=e;return(0,i().K8)((()=>{const e=null==r?void 0:r.type;switch(e){case"created_by":{const e=n.getCreatedByPointer();if(e)return[e];break}case"last_edited_by":{const e=n.getLastEditedByPointer();if(e)return[e];break}case"person":{const e=n.isTemplate();return(0,o(713998).as)({value:n.getPropertyValue(t),isTemplatePage:e,propertySchema:r,blockCreatorPointer:e||(0,o(458366).NN)(l)?void 0:n.getCreatedByPointer()})}case void 0:return[];default:(0,c().HB)(e)}return[]}),[t,r,n,l])}const k=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(p().L8),r=(0,n.useMemo)((()=>(0,S.jsx)(d().k,{},"comment")),[]),i=T(e,t);return(0,S.jsx)(b,{...i,EmptyComponent:m().rW,collectionStore:e.collectionStore,quickActionButtons:r,userExpandable:o})})),C=n.forwardRef((function(e,t){const o=T(e,t),r=(0,n.useMemo)((()=>(0,S.jsx)(d().k,{},"comment")),[]);return(0,S.jsx)(b,{...o,EmptyComponent:m().ao,collectionStore:e.collectionStore,quickActionButtons:r})})),w=n.forwardRef((function(e,t){var o;const l=T(e,t),s=(0,r().v3)(),{propertySchema:c}=(0,n.useContext)(p().L8),y=c,f=g({store:e.store,property:e.property,propertySchema:y,format:e.format}),h=(0,i().K8)((()=>{var t;const o=null===(t=e.store)||void 0===t?void 0:t.getRecordModel;return o?f.flatMap((e=>{if(!(0,a().Pu)(e))return[];const t=(0,a().xC)({pointer:e,getRecordModel:o});return t&&t.asActor?[u().sk.createUniqueRootStore(s,t.pointer)]:[]})):[]}),[s,f,null===(o=e.store)||void 0===o?void 0:o.getRecordModel]),v=(0,n.useMemo)((()=>(0,S.jsx)(d().k,{},"comment")),[]);return(0,S.jsx)(x,{actors:h,renderOrigin:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(b,{...l,EmptyComponent:m().ao,tokenLimit:1,quickActionButtons:v,limitTokensToSingleTruncatedLine:!0})})})})),j=n.forwardRef((function(e,t){const o=T(e,t);return(0,S.jsx)(b,{...o,EmptyComponent:m().Fe,tokenLimit:1})})),P=n.forwardRef((function(e,t){const{store:r,property:i}=T(e,t),{propertySchema:l,propertyModule:a,format:s}=(0,n.useContext)(p().L8),c=l,u=g({store:r,property:i,propertySchema:c,format:s});return a&&(0,o(778781).E2)(a)?(0,S.jsx)(o(3079).H,{ref:t,store:r,property:i,children:(0,S.jsx)(o(961529).a,{store:r,property:i,propertyValues:u,propertySchema:c,module:a,format:e.format})}):((0,o(63473).B)({from:"PropertyModulePersonProperty",type:"invalidModule",throttleSeconds:60,error:new Error("Expected to find a property_person module."),data:{blockId:r.id,propertyId:i,miscDataToConvertToString:{moduleType:null==a?void 0:a.type}}}),null)})),I=n.forwardRef((function(e,t){const n=T(e,t,(0,o(512321).F)(t,e.collectionStore,e.property,"person"));return(0,S.jsx)(b,{...n,EmptyComponent:e.showIfEmpty?m().Jb:void 0})})),_=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=T(e,t);return(0,S.jsx)(b,{...n,EmptyComponent:o?m().Jb:void 0})})),A=n.forwardRef((function(e,t){const o=T(e,t);return(0,S.jsx)(b,{...o})})),B=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=T(e,t);return(0,S.jsx)(b,{...n,EmptyComponent:o?m().Jb:void 0})})),R=n.forwardRef((function(e,t){const o=T(e,t);return(0,S.jsx)(b,{...o})})),M=n.forwardRef((function(e,t){const o=T(e,t);return(0,S.jsx)(b,{...o})})),E=n.forwardRef((function(e,t){const o=T(e,t);return(0,S.jsx)(b,{...o})}));function T(e,t,o){const{store:n,property:r,onContextMenu:i,width:l}=e;return{ref:t,store:n,property:r,editButtonClickProps:(0,y().QK)(e),onContextMenu:i,buttonStyle:null==o?void 0:o.buttonStyle,width:l}}},271311:(e,t,o)=>{o.d(t,{A:()=>C});var n=o(296540),r=()=>o(484714),i=()=>o(847249),l=()=>o(401497),a=()=>o(970013),s=()=>o(806411),c=()=>o(522986),u=()=>o(662453),d=()=>o(458366),p=()=>o(68465),y=()=>o(972435),m=()=>o(747100),f=()=>o(289190),S=()=>o(227440),h=()=>o(205682),x=()=>o(77238),b=()=>o(411671),v=()=>o(234359),g=()=>o(761529),k=o(474848);function C(e){const{store:t,property:o,openOverlay:C}=e,j=(0,r().v3)(),{propertySchema:P,format:I,collectionContextStore:_,isEmptyStore:A,canEdit:B}=(0,n.useContext)(v().L8),R=(0,i().O$)(A),M=(0,n.useCallback)((async()=>{if(!P)return;if(C){const e=(0,m().cq)(t)?x().A:h().A;c().ho({blockPropertyValueOverlayStore:e,collectionContextStore:_,format:I,environment:j,store:t,property:o,readOnly:!0})}const e=f().m.setIsWriting({propertySchema:P,stores:[t]}),{propertyCompletionsActions:n}=await u().aiDependency.load();n.autofillPropertyForBlocks({environment:j,stores:[t],property:o,propertySchema:P,userEventForAnalytics:"generate_from_action_button",collectionContextStore:_,sessionIdForAnalytics:e,from:d().zP(I)})}),[_,j,I,C,o,P,t]),E=(0,i().K8)((()=>B&&P&&(!j.device.isMobile||R)&&(0,p().ge)(b().A.getMode(j,t),t)&&(0,a().$M)(P)&&(0,a().om)(P)&&S().A.state.online),[j,B,R,P,t]),T=(0,l().IS)((e=>({iconStyle:{color:e.text.secondary,fill:e.text.secondary}})),[]);return E?(0,k.jsx)(g().A,{icon:s().x,tooltip:y().A.formatMessage(w.update),onClick:M,iconStyle:T.iconStyle,style:{height:20,width:20}}):null}const w=(0,o(959013).YK)({update:{defaultMessage:"Update",id:"database.editButton.autofillWithAiTooltip"}})},317958:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(784892),r=()=>o(959013),i=o(474848);const l={[n().NY.ExtremeSmall]:{height:12,fontSize:8,margin:"0 4px 0 0"},[n().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 4px 0 0"},[n().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0"},[n().NY.CompactEssential]:{height:21,fontSize:14,margin:"0 12px 6px 0"},[n().NY.Medium]:{height:21,fontSize:14,margin:"0 12px 6px 0"},[n().NY.Inline]:{height:21,fontSize:14,margin:"0 12px 0 0"},[n().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0"}};const a=function(e){const{count:t,format:n,fixedHeight:a,style:s,isCompact:c}=e,{margin:u,height:d,fontSize:p}=l[n],y=(0,o(401497).IS)((e=>({wrapper:{display:"flex",alignItems:"center",lineHeight:1.2,borderRadius:4,fontSize:p,margin:u,color:e.text.secondary,...a&&{height:d},...s},compact:{whiteSpace:"nowrap"}})),[p,d,a,u,s]);return(0,i.jsx)("div",{style:y.wrapper,children:c?(0,i.jsx)("span",{style:y.compact,children:(0,i.jsx)(r().sA,{defaultMessage:"+{thinSpace}{moreItemsCount}",id:"database.tokens.moreItems.message",values:{moreItemsCount:t,thinSpace:(0,i.jsx)("span",{children:" "})}})}):(0,i.jsx)("span",{children:(0,i.jsx)(r().sA,{defaultMessage:"{relationMoreItemsCount} more…",id:"database.relationPropertyValue.moreItems.message",values:{relationMoreItemsCount:t}})})})}},355594:(e,t,o)=>{o.d(t,{o:()=>l});o(898992),o(354520);var n=o(296540),r=()=>o(625830),i=o(474848);const l=n.memo((function(e){var t;const{propertyLabel:l,checked:a,enablePointerEventsForInteractiveTypes:s,onClick:c,disabled:u,tooltip:d,withComma:p,store:y,property:m}=e,{baseStyles:f}=(0,n.useContext)(o(234359).L8),S=(null==f?void 0:f.sizing)??"default",h=(0,o(847249).K8)((()=>{if(y)return(0,o(299545).O3)(y,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===m))}),[y,m]),x=h&&null!==(t=h[0])&&void 0!==t&&t.id?(0,o(955825).wV)({discussionId:h[0].id}):void 0,b="small"===S?14:16,v="small"===S?10:12,g=(0,o(401497).IS)((()=>({wrapperStyle:{maxWidth:"100%"},cardCheckboxWrapStyle:{display:"flex",alignItems:"center",lineHeight:`${b}px`,height:"100%"},cardCheckboxNameStyle:{marginLeft:"small"===S?5:6,marginRight:2,...o(284371).RC}})),[S,b]),k={checked:a,disabled:u,style:{...s&&{pointerEvents:"auto"}},onClick:c,size:b,checkSize:v,tooltipHeader:d,withComma:p};return(0,i.jsx)("div",{className:x,style:g.wrapperStyle,children:l?(0,i.jsxs)("div",{style:g.cardCheckboxWrapStyle,children:[(0,i.jsx)(r().A,{...k}),(0,i.jsx)("div",{style:g.cardCheckboxNameStyle,children:l})]}):(0,i.jsx)(r().A,{...k})})}))},370618:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(296540),r=()=>o(784892),i=o(474848);const l=n.memo((function(e){var t;const{actorPointer:l,style:a,shouldShrink:s,withComma:c}=e,{store:u,baseStyles:d,shouldRenderTooltip:p,propertySchema:y}=(0,n.useContext)(o(234359).L8),m=(0,o(425497).Ug)(null==d?void 0:d.tokenFormat),f=(0,o(401497).IS)((()=>({actorStyle:{margin:0,...a,...(null==d?void 0:d.tokenFormat)===r().NY.Inline&&{pointerEvents:"auto"},display:"inline-block"}})),[null==d?void 0:d.tokenFormat,a]),S=(0,o(847249).K8)((()=>{const e=null==u?void 0:u.getRecordModel;if(e)return(0,o(764880).xC)({pointer:l,getRecordModel:e})}),[l,null==u?void 0:u.getRecordModel]);return void 0===S?null:(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(o(448693).Ay,{actor:S,showRemoveButton:!1,format:m,isSingle:!1,shouldShrink:s,style:f.actorStyle,hasTooltip:!p||m===r().NY.Inline,tooltipHeader:null==y?void 0:y.name},null===(t=S.asActor)||void 0===t?void 0:t.id),c?", ":""]})}))},383852:(e,t,o)=>{o.d(t,{$$:()=>Y,$s:()=>K,DE:()=>J,Dd:()=>ee,F1:()=>X,I5:()=>q,Kr:()=>W,QE:()=>N,Tn:()=>M,bn:()=>G,eH:()=>z,eM:()=>U,hF:()=>D,iM:()=>Q,jD:()=>R});o(944114),o(898992),o(354520),o(581454),o(737550);var n=o(296540),r=()=>o(484714),i=()=>o(852507),l=()=>o(847249),a=()=>o(401497),s=()=>o(970013),c=()=>o(713998),u=()=>o(784892),d=()=>o(191772),p=()=>o(496603),y=()=>o(522986),m=()=>o(458366),f=()=>o(571468),S=()=>o(962730),h=()=>o(630116),x=()=>o(704152),b=()=>o(939740),v=()=>o(859428),g=()=>o(124954),k=()=>o(279620),C=()=>o(234359),w=()=>o(41459),j=()=>o(317958),P=()=>o(414712),I=()=>o(40106),_=()=>o(167677),A=()=>o(859118),B=o(474848);function R(e){const{store:t,property:o,propertySchema:n}=e;return(0,l().K8)((()=>{const e=t.getPropertyValue(o);return n?c().bG({relationValue:c().n(e),propertySchema:n,getRecordModel:t.getRecordModel,includeNoAccess:!0}):void 0}),[t,o,n])}function M(e){const{store:t,relationValue:o,propertySchema:n}=e;return(0,l().K8)((()=>{const e=null!=n&&n.limit&&o?o.slice(0,n.limit):o;if(!e)return[];const r=e.map((e=>{const o=h().Bv.createChildStore(t,e);if(!(0,f().X)(o))return{pointer:e,pageStore:o}}));return(0,p().oE)(r)}),[n,o,t])}const E=n.memo((0,n.forwardRef)((function(e,t){const{collectionStore:r,buttonStyle:i,editButtonClickProps:c,property:u,EmptyComponent:d,onContextMenu:p,blockPropertyValueOverlayStore:y,store:m,format:f,renderAs:S,quickActionButtons:x,width:b,formQuestionStore:v,userExpandable:g}=e,{propertySchema:k,canEdit:j,baseStyles:P,collectionContextStore:I}=(0,n.useContext)(C().L8),_=k,A=(0,o(425497).Ug)(null==P?void 0:P.tokenFormat),E=(0,l().uB)(void 0,o(970585).A),F=R({store:m,propertySchema:_,property:u}),O=(0,o(358167).v)({blockId:null==m?void 0:m.id,propertyId:u}),H=(0,o(171722).s)({propertyId:u,store:m}),W=Boolean(H),D=(0,n.useMemo)((()=>{const e=_?s().Nv(_):void 0;return e?h().md.createChildStore(m,e):void 0}),[_,m]),K=M({store:m,propertySchema:_,relationValue:F}),U=0===K.length,N="rows"===S&&!U,z=(0,a().IS)((e=>({buttonStyle:{...P.buttonStyle,...i,...N&&{padding:0}},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},relationItemsWrapper:{width:"100%"}})),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,i,N]),Q=(0,n.useMemo)((()=>D?"rows"===S?_&&F&&(0,B.jsx)(T,{relationItemPointers:K,relationValue:F,collectionStore:r,menuListStore:E,store:m,targetCollectionStore:D,property:u,disabled:!j,buttonContainerRef:t,blockPropertyValueOverlayStore:y,format:f,propertySchema:_,collectionContextStore:I}):"inline"===S?(0,B.jsx)(L,{relationItemPointers:K,store:m,tokenFormat:A,hasUnresolvedDiscussion:W,hasDraftComment:O}):"singleWithOverflow"===S?(0,B.jsx)(V,{relationItemPointers:K,store:m,tokenFormat:A,hasUnresolvedDiscussion:W,hasDraftComment:O,buttonContainerRef:t,blockPropertyValueOverlayStore:y,property:u,format:f,collectionContextStore:I,canEdit:j}):void(0,o(534177).HB)(S):null),[D,S,_,F,K,r,E,m,u,j,t,y,f,I,A,W,O]),J=n.useCallback((e=>Q||[w().j.PropertyModule,w().j.Page].includes(f)?(0,B.jsx)("div",{style:z.relationItemsWrapper,className:H,children:e.children}):(0,B.jsx)(B.Fragment,{children:e.children})),[H,f,Q,z.relationItemsWrapper]);return U&&void 0===d?null:(0,B.jsx)(o(494585).P,{ref:t,editButtonClickProps:N?void 0:c,forceEnableButton:"singleWithOverflow"===S,onContextMenu:p,style:z.buttonStyle,hoveredStyle:z.buttonHoveredStyle,pressedStyle:z.buttonPressedStyle,quickActionButtons:x,width:b,formQuestionStore:v,userExpandable:g,children:(0,B.jsx)(J,{children:U&&void 0!==d?(0,B.jsx)(d,{}):Q})})})));function T(e){const{collectionStore:t,targetCollectionStore:i,relationItemPointers:l,relationValue:s,property:c,store:d,disabled:p,menuListStore:f,buttonContainerRef:S,blockPropertyValueOverlayStore:h,format:v,propertySchema:g,collectionContextStore:k}=e,w=(0,r().v3)(),{collectionSchema:P}=(0,n.useContext)(C().L8),I=(0,n.useCallback)(((e,t)=>{y().ho({environment:w,blockPropertyValueOverlayStore:h,store:d,property:c,rect:null==t?void 0:t.getBoundingClientRect(),format:v,mode:e,collectionContextStore:k})}),[h,k,w,v,c,d]),_=(0,n.useCallback)(((e,t)=>{if(!k)return;const n=e.filter((e=>e.id!==t.id));o(751156).createAndCommit({userAction:"RelationBlockPropertyValue.handleRemoveRelationClick",environment:w,canUndo:!0,perform:e=>{o(27732).Iq({store:d,propertyId:c,value:n,environment:w,relatedPageId:t.id,propertySchema:g,transaction:e,collectionContextStore:k,analyticsData:{isFromBulkActionsToolbar:m().pi(h),analyticsFrom:m().zP(v)},isUnthrottled:!1})}})}),[h,k,w,v,c,g,d]),A=(0,a().IS)((()=>({moreMenuItem:{width:"100%",display:"flex",alignItems:"center",justifyItems:"center",borderRadius:4,fontSize:14,minHeight:32,margin:0,padding:"6px 8px"},moreMenuItemLabel:{lineHeight:"normal",margin:0}})),[]);if(!P)return null;const R=l.slice(0,5).map(((e,n)=>{let{pageStore:r}=e;return{key:r.id,render:e=>{let{ref:l,...a}=e;return(0,B.jsx)(o(86499).q,{...a,canDrag:!1,collectionStore:t,collectionId:t.id,schema:P,propertySchema:g,targetCollectionStore:i,relatedPageStore:r,disabled:p,isSelected:!0,pageStore:d,property:c,rowType:"inline",onActionButtonClick:()=>{_(s,r)},onMouseLeave:()=>f.unsetFocus(),onSecondaryButtonClick:e=>{I({type:"view",index:n+1},e)},onOpenPageButtonClick:()=>{o(870578).k({relationPointers:s,relatedPageStore:r,environment:w,from:"relation_property"})}})},action:()=>{}}}));return l.length>5&&R.push({key:"add",render:e=>(0,B.jsx)(x().A,{...e,style:A.moreMenuItem,onClick:e=>I({type:"view"},S&&"current"in S?S.current:void 0),children:(0,B.jsx)(j().A,{style:A.moreMenuItemLabel,count:l.length-5,format:u().NY.Medium,fixedHeight:!1,isCompact:!1})}),action:()=>{I({type:"add",index:s.length},void 0)}}),(0,B.jsx)(b().Ay,{type:b().Oh.Vertical,store:f,initialFocus:void 0,disableKeyboard:!0,style:{width:"100%"},sections:[{key:"results",render:e=>(0,B.jsx)(o(89924).A,{...e,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,children:e.children}),items:R}]})}function L(e){const{relationItemPointers:t,store:o,tokenFormat:n,hasUnresolvedDiscussion:r,hasDraftComment:i}=e;return(0,B.jsx)(O,{limit:10,store:o,linkify:"whenReadOnly",relationItemPointers:t,tokenFormat:n,hasUnresolvedDiscussion:r,hasDraftComment:i,wrapTokens:!0})}function V(e){const{relationItemPointers:t,store:o,tokenFormat:i,hasUnresolvedDiscussion:l,hasDraftComment:s,buttonContainerRef:c,blockPropertyValueOverlayStore:u,property:d,format:p,collectionContextStore:m,canEdit:f}=e,S=(0,a().IS)((()=>({relationTokenStyle:{overflow:"hidden",width:"100%"}})),[]),h=(0,r().v3)(),b=(0,n.useCallback)((()=>{var e;y().ho({environment:h,blockPropertyValueOverlayStore:u,store:o,property:d,rect:null===(e=c&&"current"in c?c.current:void 0)||void 0===e?void 0:e.getBoundingClientRect(),format:p,mode:{type:"view",index:0},collectionContextStore:m})}),[u,c,m,h,p,d,o]),v=(0,B.jsx)(O,{relationTokenStyle:S.relationTokenStyle,limit:1,store:o,linkify:"never",relationItemPointers:t,tokenFormat:i,hasUnresolvedDiscussion:l,hasDraftComment:s,wrapTokens:!1});return f?v:(0,B.jsx)(x().A,{...e,ignoreLocalHoverState:!0,onClick:b,children:v})}function F(e){let{pageStore:t}=e;const o=(0,n.useRef)(null);return(0,B.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,B.jsx)(g().w,{blockStore:t,format:u().NY.ExtraSmall}),(0,B.jsx)(k().Y,{blockStore:t,noUnderline:!0,shouldWrap:!1,titleStyle:{fontSize:12},recordTitleRef:o,disableTooltip:!0})]},t.id)}function O(e){let{linkify:t,limit:o,hasUnresolvedDiscussion:r,hasDraftComment:s,relationItemPointers:c,tokenFormat:u,store:p,relationTokenStyle:y,wrapTokens:m}=e;const f=(0,a().IS)((e=>({moreToken:{margin:0},commentHighlightWrapperStyle:r||s?{...(0,d().sQ)(e),padding:4,flexWrap:"wrap",lineHeight:2,display:"inline-flex"}:{},relationTokenHighlightStyle:r||s?{marginLeft:2,marginRight:2,maxWidth:"fit-content",display:"inline-flex"}:{}})),[s,r]),h=c.length>o,x=n.useMemo((()=>c.slice(0,o)),[c,o]);!function(e){const{store:t,relationItemPointers:o}=e,{format:r,collectionContextStore:a,property:s}=(0,n.useContext)(C().L8);(0,i().w)((()=>{var e;r===w().j.Table&&s&&(null==a||null===(e=a.propertyResultDurationTracker)||void 0===e||e.trackMount({pageId:t.id,propertyId:s,propertyType:"relation"}))}));const c=(0,l().K8)((()=>!o.some((e=>{let{pageStore:t}=e;return!t.isReady()}))),[o]);(0,n.useEffect)((()=>{var e;c&&r===w().j.Table&&s&&(null==a||null===(e=a.propertyResultDurationTracker)||void 0===e||e.trackResult({pageId:t.id,propertyId:s,propertyType:"relation"}))}),[a,r,c,s,t])}({store:p,relationItemPointers:x});const b=x.map((e=>{let{pointer:o,pageStore:r}=e;return(0,B.jsx)(n.Fragment,{children:(0,B.jsx)(H,{recordPointer:o,parentStore:p,recordStore:r,style:y,propertyStyle:f.relationTokenHighlightStyle,linkify:t,noWrap:!m,disableTooltip:h})},o.id)}));h&&b.push((0,B.jsx)(j().A,{style:f.moreToken,count:c.length-o,format:u,fixedHeight:!1,isCompact:!0},"more"));const g=(0,n.useCallback)((e=>(0,B.jsx)("div",{...e,style:{marginTop:2,marginBottom:2,display:"flex",flexDirection:"column",gap:1,width:"max-content",maxWidth:320},children:c.map((e=>{let{pointer:t,pageStore:o}=e;return(0,B.jsx)(F,{pageStore:o},t.id)}))})),[c]),k=(0,B.jsx)(_().h,{style:f.commentHighlightWrapperStyle,children:b});return h?(0,B.jsx)(v().A,{renderTooltip:g,delayThreshold:500,placement:S().W.Bottom,originGap:8,render:e=>(0,B.jsx)("div",{...e,children:k})}):k}function H(e){const{style:t,recordPointer:o,recordStore:n,parentStore:r,linkify:i,disableTooltip:l,propertyStyle:a,noWrap:s}=e;return(0,f().W)(n)?null:(0,B.jsx)("div",{style:t,children:(0,B.jsx)(I().a,{recordPointer:o,parentStore:r,style:a,linkify:i,noWrap:s,disableTooltip:l})})}const W=(0,n.forwardRef)((function(e,t){const{shouldWrap:r}=(0,n.useContext)(C().L8),i=ee(e,t),l=(0,n.useMemo)((()=>(0,B.jsx)(o(821300).k,{},"comment")),[]);return(0,B.jsx)(E,{...i,EmptyComponent:A().rW,renderAs:"inline",quickActionButtons:l,userExpandable:r})})),D=(0,n.forwardRef)((function(e,t){const o=ee(e,t);return(0,B.jsx)(E,{...o,EmptyComponent:A().ao,renderAs:"rows"})})),K=(0,n.forwardRef)((function(e,t){const o=ee(e,t);return(0,B.jsx)(E,{...o,EmptyComponent:A().ao,renderAs:"singleWithOverflow"})})),U=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=ee(e,t,(0,o(512321).F)(t,e.collectionStore,e.property,"relation"));return(0,B.jsx)(E,{...r,EmptyComponent:n?A().Jb:void 0,renderAs:"inline"})})),N=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=ee(e,t);return(0,B.jsx)(E,{...n,EmptyComponent:o?A().Jb:void 0,renderAs:"inline"})})),z=(0,n.forwardRef)((function(e,t){const o=ee(e,t);return(0,B.jsx)(E,{...o,renderAs:"inline"})})),Q=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=ee(e,t);return(0,B.jsx)(E,{...n,EmptyComponent:o?A().Jb:void 0,renderAs:"inline"})})),J=(0,n.forwardRef)((function(e,t){const o=ee(e,t);return(0,B.jsx)(E,{...o,renderAs:"inline"})})),q=(0,n.forwardRef)((function(e,t){const o=ee(e,t);return(0,B.jsx)(E,{...o,renderAs:"inline"})})),Y=(0,n.forwardRef)((function(e,t){const o=ee(e,t);return(0,B.jsx)(E,{...o,renderAs:"inline"})}));function $(){}const G=(0,n.forwardRef)((function(e,t){const{store:r,collectionStore:i,property:a,blockPropertyValueOverlayStore:c,isInPeekRenderer:u}=ee(e,t),{canEdit:d,propertyModule:p,propertySchema:y,collectionSchema:m}=(0,n.useContext)(C().L8),f=(0,l().K8)((()=>r.isNonEditableState()),[r]),S=(0,n.useMemo)((()=>new(o(171018).YB)),[]),x=(0,l().K8)((()=>i.getFormat()),[i]),b=(0,l().K8)((()=>null==i?void 0:i.getParentStore()),[i]),v=(0,l().K8)((()=>!(!i||!b||"block"!==b.table)&&(0,o(33791).v)({collectionStore:i,collectionViewBlockStore:b,checkNavigableAncestorLocked:!1})),[i,b]),g=(0,o(671891).l)(r),k=(0,l().K8)((()=>{var e;return"hide"===(null==g||null===(e=g.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[g]),w=(0,n.useMemo)((()=>{if("relation"!==(null==y?void 0:y.type))return;const e=y?s().Nv(y):void 0;return e?h().md.createChildStore(r,e):void 0}),[y,r]),j=(0,l().K8)((()=>(null==w?void 0:w.getDatabaseType())===o(636090).av),[w]);if(!y||!m)return null;const P=(0,B.jsx)(o(68350).I,{schema:m,format:x,hideDragHandle:!0,property:a,blockStore:r,collectionStore:i,pagePropertiesStore:S,disabled:!d,locked:f,canConfigureCollection:v,isInPeekRenderer:u??!1,styleVariants:Z,layoutModule:p,hideIcon:k});return(0,B.jsx)(o(3079).H,{store:r,property:a,ref:t,children:(0,B.jsx)(o(738328).M,{store:r,collectionStore:i,disabled:!d,locked:f,property:a,schema:m,handleMouseMove:$,handleMouseLeave:$,handleContextMenu:$,blockPropertyValueOverlayStore:c,format:x,visibility:j?"inline":e.propertyVisibility??"inline",isInPeekRenderer:Boolean(u),topBorder:!1,showIcon:!1,propertyRowName:P,pagePropertiesStore:S})})})),Z={width:{variant:"hug-content"},height:{variant:"small"},fontWeight:"medium",size:"small"},X=(0,n.forwardRef)((function(e,t){const o=ee(e,t);return(0,B.jsx)(E,{...o,EmptyComponent:A().Fe,renderAs:"inline"})}));function ee(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,blockPropertyValueOverlayStore:a,format:s,isInPeekRenderer:c,width:u,formQuestionStore:d}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,P().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,blockPropertyValueOverlayStore:a,format:s,isInPeekRenderer:c,width:u,formQuestionStore:d}}},388507:(e,t,o)=>{o.d(t,{b:()=>a});o(898992),o(354520);var n=o(296540),r=()=>o(401497),i=()=>o(597777),l=o(474848);const a=n.memo((function(e){var t;const{dateValue:a,dateFormat:s,timeFormat:c,withComma:u,store:d,property:p}=e,y=(0,r().DP)(),{baseStyles:m,shouldRenderTooltip:f}=(0,n.useContext)(o(234359).L8),S=(0,o(847249).K8)((()=>{if(d)return(0,o(299545).O3)(d,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===p))}),[d,p]),h=(0,o(358167).v)({blockId:null==d?void 0:d.id,propertyId:p}),x=(0,r().IS)((()=>({dateBox:{...m.textStyle,display:"inline",...(((null==S?void 0:S.length)??!1)||h)&&(0,o(191772).sQ)(y)}})),[m.textStyle,null==S?void 0:S.length,h,y]);let b;var v;S&&null!==(t=S[0])&&void 0!==t&&t.id&&(b=(0,o(955825).wV)({discussionId:null===(v=S[0])||void 0===v?void 0:v.id}));return(0,l.jsx)(o(654734).A,{value:a,dateFormat:s??i().vz,timeFormat:c??i().CE,style:x.dateBox,disableTooltip:f||"relative"!==s,withComma:u,displayInUserTimezone:!0,discussionStore:null==S?void 0:S[0],className:b})}))},414712:(e,t,o)=>{o.d(t,{DZ:()=>S,Lp:()=>m,QK:()=>f,YX:()=>h,ni:()=>d});var n=o(296540),r=()=>o(847249),i=()=>o(66689),l=()=>o(970013),a=()=>o(713998),s=()=>o(919709),c=()=>o(319975),u=()=>o(751156);i().Hx.Dates;function d(e){var t,o;const{collectionStore:n,propertySchema:r,collectionContextStore:i,store:l,property:s,isJiraTwoWaySyncEnabled:c}=e;if(!n.isExternallyImportedAndSyncedCollection())return!1;if(!c)return!0;const u=Boolean(null===(t=n.getFormat())||void 0===t||null===(t=t.sync_state)||void 0===t?void 0:t.syncing);if("read_write"!==(null==r?void 0:r.synced_permissions)||null===(o=n.getFormat().sync_state)||void 0===o||!o.enable_two_way_sync||u)return!0;const d=null==i?void 0:i.externalSyncStore.state;return(null==d||!d.shouldAllowUserToEditSyncedCollection())&&(0,a().VF)(l.getModel(),s,l.getRecordModel)}const p={[i().Hx.Dates]:{propertyId:i().Hx.Dates,validationCheck:e=>{const{collectionStore:t}=e,o=t.getPropertyMapping(),n=null==o?void 0:o[i().Hx.StatusV2];return Boolean(n)}}},y={date:[i().Hx.Dates]};function m(e){const{collectionStore:t,property:o,propertySchema:n}=e;if(!n)return!0;const r=t.getPropertyMapping();if(!r)return!1;const i=y[n.type]??[];for(const l of i){const e=p[l];if(!e.validationCheck({collectionStore:t}))continue;const n=null==r?void 0:r[e.propertyId];if(o===e.propertyId||o===n)return!0}return!1}function f(e,t){let{store:o,property:r,format:i,onClick:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:c,focusButtonAfterClose:u}=e;return(0,n.useMemo)((()=>({store:o,property:r,format:i,onClick:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:c,isStatusCheckbox:null==t?void 0:t.isStatusCheckbox,focusButtonAfterClose:u})),[s,a,c,i,null==t?void 0:t.isStatusCheckbox,l,r,o,u])}function S(e,t,o){return(0,r().K8)((()=>{if(!e.isDefined())return;if(!e.isTemplate())return;const n=null==o?void 0:o.type;if(!(0,l().mF)(n))return;const r=e.getPropertyValue(t);if(!r)return;const i=null==r?void 0:r[0];if(i&&s().qXl(i)){const e=s().PVS(s().wQU(i)),t=e&&s().y0Y(e);return t&&{templateVariable:t.type}}}),[t,o,e],{debugName:"useTemplateVariableContext"})}function h(e,t,o){const n=a().hk(e);u().createAndCommit({userAction:"BlockPropertyValueOverlay.handleNumberValueChange",environment:t,canUndo:!0,perform:e=>{for(const r of o)c().R9({environment:t,store:r,value:n,transaction:e})}})}},422464:(e,t,o)=>{o.d(t,{W:()=>h,e:()=>S});o(296540);var n=()=>o(401497),r=()=>o(784892),i=()=>o(563884),l=()=>o(91451),a=()=>o(436632),s=()=>o(919709),c=()=>o(959013),u=()=>o(534177),d=()=>o(848401),p=()=>o(88306),y=o(474848);const m="20px",f=(0,c().YK)({me:{id:"templateVariablePropertyValueComponent.templateVariables.text.me",defaultMessage:"Person who duplicated page"},now:a().H.nowText,today:a().H.todayText});function S(e){const t=(0,n().IS)((e=>({textWrapper:{lineHeight:m}})),[]);return(0,y.jsx)(p().C,{fontColor:"light",style:t.textWrapper,children:(0,y.jsx)(h,{templateVariableType:e.templateVariableType})})}function h(e){const{templateVariableType:t,showRemoveButton:o,onRemove:a,style:p}=e,m=(0,c().tz)(),f=(0,n().IS)((e=>({uiToken:{background:e.outlineBlueButtonPressedBackground,color:e.blueColor,padding:"2px 4px",width:"max-content",...p||{}}})),[p]);return(0,y.jsx)(d().Ay,{format:r().NY.Medium,isSingle:!0,title:x(t,m),renderAvatar:()=>function(e){let t;(0,s().pbt)(e)?t=l().z:(0,s().UKc)(e)?t=i().k:(0,u().HB)(e);return t}(t)({width:12,height:12,marginRight:4}),shouldShrink:!0,onClickRemove:a,showRemoveButton:Boolean(o),style:f.uiToken})}function x(e,t){let o;return"me"===e?o=t.formatMessage(f.me):"now"===e?o=t.formatMessage(f.now):"today"===e?o=t.formatMessage(f.today):(0,u().HB)(e),o}},425497:(e,t,o)=>{o.d(t,{Ug:()=>u,YX:()=>p,_t:()=>m,x7:()=>S});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698);var n=()=>o(484714),r=()=>o(401497),i=()=>o(784892),l=()=>o(534177),a=()=>o(284371),s=()=>o(41459),c=()=>o(828180);function u(e){return e??i().NY.Medium}const d=new Set(["title","text","email","phone_number","number","url","date","created_time","last_edited_time","auto_increment_id"]);function p(e){return"empty"===e||"error"===e||d.has(e)}const y=new Set(["button","file"]);function m(e){return y.has(e)}const f=Object.create(null);function S(e){const{shouldSetCellHeight:t,format:o,shouldWrap:u,isLast:d,disabled:p,locked:y,showIfEmpty:m,isInvalidFormAnswer:S,isLargeModule:h}=e,{isPhone:x}=(0,n().Y0)(),b=(0,r().DP)(),v=[o,u,t,p,y,x,m,d,h,S,b.mode].join("|");if(f[v])return f[v];const g=function(e,t,o,n,r,u,d,p,y,m,f){switch(n){case s().j.Table:return{buttonStyle:{display:"block",fontSize:c().Mi,overflow:"clip",width:"100%",whiteSpace:r?"normal":"nowrap",height:o?c().tt:void 0,minHeight:c().tt,cursor:d||p?"default":"pointer",padding:c().QJ[s().j.Table].default},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},textStyle:{lineHeight:c().$g,whiteSpace:r?"pre-wrap":"nowrap",wordBreak:r?"break-word":"normal"},tokenWrapStyle:{display:"flex",flexWrap:r?"wrap":"nowrap",...c().Cn[i().NY.Medium]},textLineHeight:c().wd,sizing:"default",tokenFormat:i().NY.Medium};case s().j.GalleryView:return{buttonStyle:{display:"flex",overflow:"hidden",alignItems:"center",borderRadius:5,margin:"0 6px 2px 6px",padding:"0 5px",fontSize:e?c().Mi:c().gJ,minHeight:c().eW,whiteSpace:r?"normal":"nowrap",minWidth:y?"auto":"fit-content",width:y?"auto":"fit-content"},textStyle:{lineHeight:c().$g,whiteSpace:r?"pre-wrap":"nowrap",wordBreak:r?"break-word":"normal",overflow:"hidden"},tokenWrapStyle:{display:"flex",minWidth:0,flexShrink:0,flexWrap:r?"wrap":"nowrap",width:r?"100%":void 0,...c().Cn[e?i().NY.Medium:i().NY.Small]},textLineHeight:e?c().wd:c().Yu,sizing:e?"default":"small",tokenFormat:e?i().NY.Medium:i().NY.Small};case s().j.Board:return{buttonStyle:{display:"flex",overflow:"hidden",alignItems:"center",borderRadius:5,fontSize:c().gJ,margin:"0 6px 2px 6px",padding:c().QJ[s().j.Board].default,minHeight:c().rO,whiteSpace:r?"normal":"nowrap",width:y?"auto":"fit-content"},textStyle:{lineHeight:c().$g,whiteSpace:r?"pre-wrap":"nowrap",wordBreak:r?"break-word":"normal"},tokenWrapStyle:{display:"flex",flexWrap:r?"wrap":"nowrap",...c().Cn[i().NY.Small]},textLineHeight:c().Yu,sizing:"small",tokenFormat:i().NY.Small};case s().j.RelationSection:return{buttonStyle:{display:"inline-flex",fontSize:c().gJ,overflow:"hidden",alignItems:"center",marginLeft:0,minHeight:c().Ih,padding:"0 8px",borderRadius:5},tokenWrapStyle:{display:"flex",minWidth:0,...c().Cn[i().NY.Small]},textLineHeight:c().Yu,sizing:"small",tokenFormat:i().NY.Small};case s().j.Relation:return{buttonStyle:{fontSize:c().gJ,overflow:"hidden",alignItems:"center",padding:"0 4px",borderRadius:5,display:"flex",marginLeft:e?0:8,marginRight:e?8:0,height:c().O0,minWidth:20},textStyle:{lineHeight:c().$g,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",minWidth:0,...c().Cn[i().NY.Small]},textLineHeight:c().Yu,sizing:"small",tokenFormat:i().NY.Small};case s().j.ListView:return{buttonStyle:{fontSize:c().gJ,overflow:"hidden",alignItems:"center",padding:"0 8px 0 8px",borderRadius:5,display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",marginLeft:0,marginRight:e?2:0,minHeight:c().kx,minWidth:20},textStyle:{lineHeight:c().$g,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",minWidth:0,...c().Cn[i().NY.Inline]},textLineHeight:c().Yu,sizing:"small",tokenFormat:i().NY.Inline};case s().j.Page:return{buttonStyle:{fontSize:c().Mi,overflow:"hidden",display:"inline-block",borderRadius:4,width:"100%",minHeight:c().at,padding:c().QJ[s().j.Page].default},textStyle:{lineHeight:c().$g,wordBreak:"break-word",whiteSpace:"pre-wrap"},tokenWrapStyle:{display:"flex",flexWrap:"wrap",...c().Cn[i().NY.Medium]},textLineHeight:c().wd,sizing:"default",tokenFormat:i().NY.Medium};case s().j.Timeline:return{buttonStyle:{display:"flex",alignItems:"center",fontSize:c().gJ,marginRight:u?0:10},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},textStyle:{lineHeight:c().$g,wordBreak:"break-word",whiteSpace:"nowrap"},tokenWrapStyle:{display:"flex",minWidth:0,...c().Cn[i().NY.Small]},textLineHeight:c().Yu,sizing:"small",tokenFormat:i().NY.Inline};case s().j.Calendar:return{buttonStyle:{fontSize:c().gJ,display:"flex",alignItems:"center",height:c().CL,whiteSpace:"nowrap",width:"100%"},textStyle:{lineHeight:c().$g,whiteSpace:"nowrap",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexShrink:0,flexWrap:"nowrap",...c().Cn[i().NY.Small]},textLineHeight:c().Yu,sizing:"small",tokenFormat:i().NY.Small};case s().j.CompactPage:return{buttonStyle:{fontSize:c().Mi,overflow:"hidden",alignItems:"center",borderRadius:4,display:"flex",width:"100%",minHeight:c().MI,padding:c().QJ[s().j.CompactPage].default},textStyle:{lineHeight:c().$g,wordBreak:"break-word",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",overflow:"hidden",alignItems:"center",...c().Cn[i().NY.CompactEssential]},textLineHeight:c().wd,sizing:"default",tokenFormat:i().NY.CompactEssential};case s().j.Mini:return{buttonStyle:{fontSize:c().Mi,overflow:"hidden",alignItems:"center",borderRadius:4,display:"flex",padding:"0 6px",minWidth:0,height:c().Bu,maxWidth:300},textStyle:{lineHeight:c().$g,wordBreak:"break-word",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",overflow:"hidden",alignItems:"center",...c().Cn[i().NY.Medium]},textLineHeight:c().wd,sizing:"default",tokenFormat:i().NY.Medium};case s().j.PropertyModule:const S={fontSize:f?c().KI:c().Mi,overflow:"hidden",display:"block",borderRadius:4,width:"100%",minHeight:c().at,padding:c().QJ[s().j.Page].default};return{buttonStyle:S,emptyButtonStyle:{...S,padding:c().QJ[s().j.Page].text},textStyle:{lineHeight:f?c().hR:c().$g,wordBreak:"break-word",whiteSpace:"pre-wrap",...f?{fontWeight:a().Wy.medium}:{}},emptyTextStyle:{fontSize:c().Mi,lineHeight:c().$g,wordBreak:"break-word"},tokenWrapStyle:{display:"flex",flexWrap:"wrap",...c().Cn[i().NY.Medium]},textLineHeight:f?c().aL:c().wd,sizing:f?"large":"default",tokenFormat:i().NY.Medium};case s().j.FormEditor:case s().j.FormViewer:return{buttonStyle:{borderRadius:6,boxShadow:n===s().j.FormViewer&&m?t.outlineRedInputBoxShadow:`0 0 0 1px ${t.stroke.input} inset`,marginTop:8,padding:"0 10px",minHeight:38,display:"flex",alignItems:"center",fontSize:16,overflowX:"hidden",cursor:"text"},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},tokenWrapStyle:{display:"flex",flexWrap:r?"wrap":"nowrap",...c().Cn[i().NY.Large]},textLineHeight:c().wd,sizing:"default",tokenFormat:i().NY.Medium};default:(0,l().HB)(n)}}(x,b,t,o,u,d,p,y,m,S,h);return f[v]=g,g}},454155:(e,t,o)=>{o.d(t,{Dl:()=>v,ER:()=>j,I8:()=>h,S1:()=>x,V6:()=>g,_Z:()=>P,ej:()=>C,h3:()=>b,jd:()=>S,rw:()=>k,xV:()=>w});o(581454);var n=o(296540),r=()=>o(401497),i=()=>o(713998),l=()=>o(962730),a=()=>o(271311),s=()=>o(821300),c=()=>o(234359),u=()=>o(997415),d=()=>o(859118),p=o(474848);const y=[],m=n.memo((0,n.forwardRef)((function(e,t){const{buttonStyle:l,editButtonClickProps:a,property:s,EmptyComponent:u,onContextMenu:d,tokenLimit:m,store:S,quickActionButtons:h,width:x,limitTokensToSingleTruncatedLine:b,userExpandable:v}=e,{propertySchema:g,baseStyles:k,shouldRenderTooltip:C}=(0,n.useContext)(c().L8),w=(0,o(425497).Ug)(null==k?void 0:k.tokenFormat),j=g,P=(null==j?void 0:j.options)??y,I=null==j?void 0:j.type,_=(0,o(847249).K8)((()=>S.getPropertyValue(s)),[S,s]),[A,B]=(0,n.useMemo)((()=>{let e=[];if("select"===I){const t=i().fF(_,P);e=t?[t]:[]}else e=i().J4(_,P);return[m?e.slice(0,m):e,m?e.slice(m):[]]}),[I,m,_,P]),R=(0,r().IS)((e=>({buttonStyle:{...k.buttonStyle,...l},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{},overflowIndicator:{marginRight:4,color:e.text.secondary},tooltip:{padding:8},remainderPropertiesContainer:{display:"flex",flexWrap:"wrap",fontWeight:"normal",width:"max-content",maxWidth:"240px",gap:4},selectToken:{margin:0},tokenContainer:b?{display:"flex",flexWrap:"nowrap",...o(284371).RC}:{},moreToken:{margin:0,...b?{flexShrink:0}:{}}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,l,b]);return null!=_&&_.length||void 0!==u?(0,p.jsx)(o(494585).P,{ref:t,editButtonClickProps:a,onContextMenu:d,style:R.buttonStyle,hoveredStyle:R.buttonHoveredStyle,pressedStyle:R.buttonPressedStyle,quickActionButtons:h,width:x,userExpandable:v,children:null!=_&&_.length||void 0===u?(0,p.jsx)(f,{shownOptions:A,hiddenOptions:B,tokenLimit:m,tokenFormat:w,styles:R,store:S,property:s,parentHasTooltip:C}):(0,p.jsx)(u,{})}):null})));function f(e){let{shownOptions:t,hiddenOptions:n,tokenLimit:i,styles:a,tokenFormat:s,store:c,property:d,parentHasTooltip:y}=e;const m=(0,r().DP)(),f=(0,o(358167).v)({blockId:null==c?void 0:c.id,propertyId:d}),S=(0,o(171722).s)({propertyId:d,store:c}),h=Boolean(S),x=(0,r().IS)((()=>{const e=h||f?{...(0,o(191772).sQ)(m),paddingTop:4,paddingBottom:4,flexWrap:"wrap",lineHeight:2,display:"inline"}:{},t=h||f?{marginLeft:3,marginRight:3,maxWidth:"fit-content",display:"inline-flex"}:{};return{tokenContainer:{...e,...a.tokenContainer},selectTokenHighlightStyle:t}}),[f,a.tokenContainer,m,h]);return(0,p.jsxs)(o(167677).h,{style:x.tokenContainer,className:S,children:[t.map((e=>(0,p.jsx)(u().X,{type:"select",value:e.value,description:e.description,color:e.color,shouldShrink:Boolean(i),style:x.selectTokenHighlightStyle,shouldShowTooltip:!y},e.id))),n.length>0&&(0,p.jsx)(o(859428).A,{style:a.tooltip,renderTooltip:()=>(0,p.jsx)("div",{style:a.remainderPropertiesContainer,children:n.map((e=>(0,p.jsx)(u().X,{type:"select",value:e.value,color:e.color,shouldShrink:!1},e.id)))}),isLightBackground:!0,textWrap:!0,alignment:l().C.Center,placement:l().W.Bottom,render:e=>(0,p.jsx)("div",{...e,children:(0,p.jsx)(o(317958).A,{count:n.length,format:s,fixedHeight:!1,style:a.moreToken,isCompact:!0})})})]})}const S=(0,n.forwardRef)((function(e,t){const{store:o,property:r}=e,{shouldWrap:i}=(0,n.useContext)(c().L8),l=(0,n.useMemo)((()=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,p.jsx)(s().k,{},"comment")]})),[r,o]),u=I(e,t);return(0,p.jsx)(m,{...u,EmptyComponent:d().rW,quickActionButtons:l,userExpandable:i})})),h=(0,n.forwardRef)((function(e,t){const o=I(e,t),{store:r,property:i}=e,l=(0,n.useMemo)((()=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a().A,{store:r,property:i,openOverlay:!0},"autofill"),(0,p.jsx)(s().k,{},"comment")]})),[i,r]);return(0,p.jsx)(m,{...o,EmptyComponent:d().ao,quickActionButtons:l})})),x=(0,n.forwardRef)((function(e,t){const o=I(e,t),{store:r,property:i}=e,l=(0,n.useMemo)((()=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a().A,{store:r,property:i,openOverlay:!0},"autofill"),(0,p.jsx)(s().k,{},"comment")]})),[i,r]);return(0,p.jsx)(m,{...o,EmptyComponent:d().ao,tokenLimit:1,quickActionButtons:l,limitTokensToSingleTruncatedLine:!0})})),b=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=I(e,t,(0,o(512321).F)(t,e.collectionStore,e.property,"multi_select"));return(0,p.jsx)(m,{...r,EmptyComponent:n?d().Jb:void 0})})),v=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=I(e,t);return(0,p.jsx)(m,{...n,EmptyComponent:o?d().Jb:void 0})})),g=(0,n.forwardRef)((function(e,t){const o=I(e,t);return(0,p.jsx)(m,{...o})})),k=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=I(e,t);return(0,p.jsx)(m,{...n,EmptyComponent:o?d().Jb:void 0})})),C=(0,n.forwardRef)((function(e,t){const o=I(e,t);return(0,p.jsx)(m,{...o})})),w=(0,n.forwardRef)((function(e,t){const o=I(e,t);return(0,p.jsx)(m,{...o})})),j=(0,n.forwardRef)((function(e,t){const o=I(e,t);return(0,p.jsx)(m,{...o})})),P=(0,n.forwardRef)((function(e,t){const o=I(e,t);return(0,p.jsx)(m,{...o,EmptyComponent:d().Fe,tokenLimit:1})}));function I(e,t,n){const{store:r,collectionStore:i,property:l,onContextMenu:a,width:s}=e;return{ref:t,store:r,collectionStore:i,property:l,editButtonClickProps:(0,o(414712).QK)(e),onContextMenu:a,buttonStyle:null==n?void 0:n.buttonStyle,width:s}}},494585:(e,t,o)=>{o.d(t,{P:()=>C});o(898992),o(737550);var n=o(296540),r=()=>o(484714),i=()=>o(847249),l=()=>o(401497),a=()=>o(675592),s=()=>o(753199),c=o(474848);function u(){const e=(0,l().IS)((e=>({outer:{display:"inline-flex",overflow:"hidden",position:"relative",width:"100%"},inner:{width:"60%",height:10,borderRadius:12,backgroundColor:e.lightDividerColor}})),[]);return(0,c.jsx)("div",{style:e.outer,children:(0,c.jsx)(o(710149).A,{style:e.inner})})}var d=()=>o(959013);const p=(0,d().YK)({expand_property:{defaultMessage:"Expand",id:"database.ExpandButton"}});function y(e){let{store:t,property:r,showHoverColor:a}=e;const s=(0,d().tz)(),u=(0,o(175116).Ks)(),y=null==u?void 0:u.virtualizedModule.getBlockHeightsCache(),m=(0,i().K8)((()=>null==y?void 0:y.propertyCanExpandStore(t.id,r).state),[y,r,t]),f=(0,n.useCallback)((()=>{null==y||y.expandHeightToTallestCached(t.id)}),[y,t.id]),S=(0,l().IS)((e=>({icon:{color:a?e.icon.secondary:e.icon.tertiary,fill:a?e.icon.secondary:e.icon.tertiary,height:16,width:16},iconButton:{height:20,width:20}})),[a]);return u&&m?(0,c.jsx)(o(761529).A,{onClick:f,icon:o(529854).C,tooltip:s.formatMessage(p.expand_property),iconStyle:S.icon,style:S.iconButton}):null}var m=()=>o(645873);const f=new(m().O2)("BlockPropertyButtonExternalPropertyTooltip",(()=>o.e(43380).then(o.bind(o,119444)))),S=(0,m()._h)(f,(e=>e.BlockPropertyButtonExternalPropertyTooltip));var h=()=>o(962730),x=()=>o(41459),b=()=>o(234359);function v(e){const{propertyValue:t,propertyCaption:r,render:i}=e,{propertySchema:a,format:s,shouldRenderTooltip:u,isExternallyImportedAndSyncedPage:d,collectionContextStore:p}=(0,n.useContext)(b().L8),y=null==a?void 0:a.name,m=!u,f=s===x().j.Board||s===x().j.GalleryView,v=(null==y?void 0:y.length)&&!m,g=void 0!==t,k=void 0!==r,C=v||g||k,w=(0,l().IS)((e=>({value:{color:v?e.text.contrastSecondary:void 0},caption:{color:v||g?e.text.contrastSecondary:void 0}})),[v,g]),j=(0,n.useCallback)((()=>{const e=(0,c.jsxs)(c.Fragment,{children:[v&&(0,c.jsx)("div",{children:y}),g&&(0,c.jsx)("div",{style:w.value,children:t}),k&&(0,c.jsx)("span",{style:w.caption,children:r})]});return d&&s===x().j.Page?(0,c.jsx)(S,{collectionContextStore:p,propertySchema:a,baseTooltip:e}):e}),[k,v,g,r,y,t,w,d,s,p,a]);return C?(0,c.jsx)(o(859428).A,{renderTooltip:j,render:e=>i(e),tooltipClassName:o(38337).Efz,placement:f?h().W.Left:h().W.Bottom}):i()}var g=()=>o(828180);function k(e){let{children:t,blockPropertyValueOverlayStore:r}=e;const i=(0,n.useRef)(null),{collectionContextStore:l,store:s,property:u}=(0,n.useContext)(b().L8),d=(0,a().PD)(),p=null==l?void 0:l.virtualizedModule.getBlockHeightsCache(),y=(0,n.useRef)(!1),m=(0,n.useCallback)((e=>{p&&s&&!e.state.isOpen&&(p.expandHeightToTallestCached(s.id),e.removeListener(m),y.current=!1)}),[p,s]),f=(0,n.useCallback)((e=>{if(!(p&&s&&u&&e))return;const t=p.getPropertyHeightStore(s.id,u).state,n=0===e.height?0:e.height+g().Nh+g().Nh;p.cachePropertyHeight(s.id,u,n),t!==n&&!1===(null==d?void 0:d.isScrolling)&&!0!==o(230062).A.state&&(null!=r&&r.state.isOpen&&!y.current?(r.addListener(m),y.current=!0):p.expandHeightToTallestCached(s.id))}),[p,d,u,s,r,m]);return(0,o(828634).tK)(i,f),(0,c.jsx)("div",{ref:i,children:t})}const C=n.memo((0,n.forwardRef)((function(e,t){const{tooltipPropertyValue:o,tooltipPropertyCaption:n,tooltipHide:r}=e,i=o=>(0,c.jsx)(w,{ref:t,...e,tooltipEvents:o});return r?i():(0,c.jsx)(v,{propertyValue:o,propertyCaption:n,render:i})}))),w=(0,n.forwardRef)((function(e,t){const{style:d,quickActionButtons:p,quickActionButtonsAlign:m,quickActionButtonsForceVisible:f,editButtonClickProps:S,width:h,forceEnableButton:x,collectionSchema:v,onContextMenu:g,formQuestionStore:C,userExpandable:w}=e,j=(0,r().v3)(),{isAndroid:P,isMobile:I,isPhone:_}=(0,r().Y0)(),A=(0,o(963589).X)("db_ux_mobile"),[B,R]=(0,n.useState)(!1),[M,E]=(0,n.useState)(!1),{collectionContextStore:T,format:L,canEdit:V,store:F,property:O,baseStyles:H,propertySchema:W}=(0,n.useContext)(b().L8),D=(0,i().K8)((()=>Boolean(null==T?void 0:T.viewsModuleContextStore.isInLayoutBuilder())),[T]),K="text"===(null==W?void 0:W.type)&&!(null!=W&&W.ai_inference),U=(0,i().K8)((()=>!!K&&(!!F&&(0,o(299545).O3)(F,{includePropertyDiscussions:!0}).some((e=>e.getPropertyId()===O)))),[K,O,F]),{isLoading:N,isExternalUpdateInProgress:z}=(0,i().K8)((()=>{var e;const t=null==T?void 0:T.collectionStore(),n=null==F?void 0:F.getFormat(),r=!(null!=n&&null!==(e=n.attributes)&&void 0!==e&&e.length)&&!(null!=n&&n.error)&&Boolean(null==t?void 0:t.isSyncedCollection());if(!(null==t?void 0:t.isExternallyImportedAndSyncedCollection())||null==F||!F.id||!O)return{isLoading:r,isExternalUpdateInProgress:!1};const i=o(485634).A.getState();return{isLoading:r,isExternalUpdateInProgress:Boolean(i.syncingProperties.size>0&&i.syncingProperties.has((0,o(252833).vT)({pageId:F.id,propertyId:O})))}}),[T,F,O]),Q=(0,l().IS)((()=>({buttonStyle:{position:"relative",...d,display:z?"flex":null==d?void 0:d.display},expandButtonPosition:{position:"relative",left:"left"===m?-2:2,float:"left"===m?"left":"right"}})),[d,z,m]),J=(0,n.useRef)(null),q=(0,n.useCallback)((()=>{E(!0)}),[]),Y=(0,n.useCallback)((e=>{J.current&&e.relatedTarget&&(!e.relatedTarget||J.current.contains(e.relatedTarget))||E(!1)}),[]),$=(0,n.useCallback)((()=>{R(!0)}),[]),G=(0,n.useCallback)((()=>{R(!1)}),[]),Z=(0,n.useCallback)((e=>{P&&_?e.preventDefault():g&&(0,s().SQ)({event:e,context:s().y$.EditorContextMenu,callback:()=>{g(e)}})}),[P,_,g]),X=(0,a().DV)(),ee=w&&X,te=(0,n.useCallback)((async e=>{if(void 0===S)return;const{onClick:t,store:n,property:r,format:i,collectionStore:l,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:s,isStatusCheckbox:c,focusButtonAfterClose:u}=S;await o(548218).V({element:J.current??void 0,environment:j,onClick:t,store:n,property:r,format:i,collectionStore:l,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:s,collectionContextStore:T,collectionSchema:v,setMouseEntered:R,statusSetCheckbox:c?!e.altKey:void 0,sizing:"large"===(null==H?void 0:H.sizing)?"large":"default",formQuestionStore:C,onClose:()=>{var e;u&&(null===(e=J.current)||void 0===e||e.focus())},isDBUXMobileEnabled:A})}),[S,j,T,v,null==H?void 0:H.sizing,C,A]),oe=(0,n.useCallback)((e=>{var o;null===(o=J.current)||void 0===o||o.removeEventListener("focusout",Y),J.current=e,null==e||e.addEventListener("focusout",Y),"function"==typeof t?t(e):t&&(t.current=e)}),[Y,t]),ne=(0,o(736230).V)({collectionContextStore:T,blockId:null==F?void 0:F.id,property:O,featureEnabled:ee}),re=(0,o(106412).Zp)(),ie=D||(null==re?void 0:re.disablePageLinks),le=(0,n.useMemo)((()=>{if(ie||!p||Array.isArray(p)&&0===p.length)return null;const t=void 0!==f?f||M:(!h||h>80)&&(B||M||I);if(!t)return ne&&F&&O?(0,c.jsx)("div",{style:Q.expandButtonPosition,children:(0,c.jsx)(y,{store:F,property:O})}):null;const n=ne?(0,c.jsxs)(c.Fragment,{children:["left"===m&&F&&O&&(0,c.jsx)(y,{store:F,property:O,showHoverColor:!0}),p,(!m||"right"===m)&&F&&O&&(0,c.jsx)(y,{store:F,property:O,showHoverColor:!0})]}):p;return(0,c.jsxs)(c.Fragment,{children:[!I&&ne&&F&&O&&(0,c.jsx)("div",{style:Q.expandButtonPosition,children:(0,c.jsx)(y,{store:F,property:O})}),t?(0,c.jsx)(o(48105).J,{align:m,style:e.quickActionButtonsStyle,format:L,containerRef:J,children:n}):null]})}),[ie,p,h,f,M,B,I,ne,m,F,O,Q.expandButtonPosition,e.quickActionButtonsStyle,L]);if(N)return(0,c.jsx)("div",{style:Q.buttonStyle,children:(0,c.jsx)(u,{})});const ae=(0,o(553965).A)({onMouseMove:$,onMouseLeave:G},e.tooltipEvents);return(x||V&&void 0!==S||U)&&!D&&!(null!=re&&re.disableAllPointerEvents)?(0,c.jsxs)(o(704152).A,{className:e.className,ref:oe,hoveredStyle:e.hoveredStyle,pressedStyle:e.pressedStyle,style:Q.buttonStyle,onContextMenu:Z,onClick:te,onFocus:q,testId:"property-value",...ae,children:[le,ee?(0,c.jsx)(k,{blockPropertyValueOverlayStore:null==S?void 0:S.blockPropertyValueOverlayStore,children:e.children}):e.children,z?(0,c.jsx)(o(331542).A,{style:{alignSelf:"center",marginRight:8,marginLeft:8}}):null]}):(0,c.jsxs)("div",{className:e.className,ref:oe,style:Q.buttonStyle,onFocus:q,...ae,children:[le,ee?(0,c.jsx)(k,{children:e.children}):e.children]})}))},495930:(e,t,o)=>{o.d(t,{E:()=>f});o(898992),o(354520);var n=o(296540),r=()=>o(847249),i=()=>o(401497),l=()=>o(955825),a=()=>o(72135),s=()=>o(191772),c=()=>o(299545),u=()=>o(358167),d=()=>o(963589),p=()=>o(67775),y=()=>o(234359),m=o(474848);function f(e){var t,o;const{numberValue:f,numberFormatOverride:S,numberPrecisionOverride:h,withComma:x,isRightAligned:b,store:v,property:g}=e,{baseStyles:k,propertySchema:C,shouldRenderTooltip:w,shouldWrap:j}=(0,n.useContext)(y().L8),P=(0,i().DP)(),I=(0,d().X)("improved_progress_bar"),_=C,A=(0,r().K8)((()=>{if(v)return(0,c().O3)(v,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===g))}),[v,g]),B=(0,u().v)({blockId:null==v?void 0:v.id,propertyId:g});let R;A&&null!==(t=A[0])&&void 0!==t&&t.id&&(R=(0,l().wV)({discussionId:A[0].id}));const M=A&&A.length>0,E=(null==k?void 0:k.sizing)??"default",T=(0,i().IS)((()=>{var e,t,o,n,r;const i="bar"===(null==_||null===(e=_.show_as)||void 0===e?void 0:e.type)||"ring"===(null==_||null===(t=_.show_as)||void 0===t?void 0:t.type);return{style:{...!i&&{display:void 0},...i?{flex:"1 0 auto",justifyContent:b?"flex-end":void 0}:{},...!j&&{display:i?"inline-flex":"inline",textWrap:"nowrap"},fontSize:null==k||null===(o=k.textStyle)||void 0===o?void 0:o.fontSize,lineHeight:null==k||null===(n=k.textStyle)||void 0===n?void 0:n.lineHeight,...(M||B)&&(0,s().sQ)(P),..."large"===E&&"bar"===(null==_||null===(r=_.show_as)||void 0===r?void 0:r.type)&&{flexDirection:"column",alignItems:void 0},...k.textStyle},barStyle:{..."large"===E&&{flexGrow:1,minWidth:48,maxWidth:"min(100%, 250px)",height:10,marginBottom:4},..."small"===E&&{flexGrow:1,minWidth:48,maxWidth:120},..."default"===E&&{flexGrow:1,minWidth:48,maxWidth:I?48:160}}}}),[null==_||null===(o=_.show_as)||void 0===o?void 0:o.type,b,j,k.textStyle,M,B,P,E,I]),[L,V]=(0,n.useMemo)((()=>[S||"number"===(null==_?void 0:_.type)&&(null==_?void 0:_.number_format)||a().C4,h||"number"===(null==_?void 0:_.type)&&(null==_?void 0:_.number_precision)||a().pS]),[S,h,_]);return(0,m.jsx)(p().l,{style:T.style,barStyle:T.barStyle,progressSize:k.textLineHeight,numberValue:f,barHeight:"large"===E?8:4,ringWidth:"large"===E?5:3,numberFormat:L,numberPrecision:V,numberShowAs:null==_?void 0:_.show_as,shouldRenderTooltip:!w,withComma:x,className:R})}},509111:(e,t,o)=>{o.d(t,{Ay:()=>rt,IB:()=>gt,_H:()=>Mt});o(18107),o(944114),o(967357),o(898992),o(354520),o(672577),o(581454);var n=o(296540),r=()=>o(908006),i=()=>o(484714),l=()=>o(792485),a=()=>o(847249),s=()=>o(401497),c=()=>o(700500),u=()=>o(443239),d=()=>o(970013),p=()=>o(713998),y=()=>o(452540),m=()=>o(597777),f=()=>o(448801),S=()=>o(585849),h=()=>o(806411),x=()=>o(179034),b=()=>o(519831),v=()=>o(919709),g=()=>o(931075),k=()=>o(959013),C=()=>o(496603),w=()=>o(534177),j=()=>o(720665),P=()=>o(299709),I=()=>o(559926),_=()=>o(193722),A=()=>o(522986),B=()=>o(313209),R=()=>o(44729),M=()=>o(246826),E=()=>o(899453),T=()=>o(319975),L=()=>o(751156),V=()=>o(312540),F=()=>o(465364),O=()=>o(724456),H=()=>o(797535),W=()=>o(312296),D=()=>o(33791),K=()=>o(116008),U=()=>o(175116),N=()=>o(458366),z=()=>o(476492),Q=()=>o(68465),J=()=>o(792540),q=()=>o(693689),Y=()=>o(504836),$=()=>o(645873),G=()=>o(97059),Z=()=>o(406792),X=()=>o(246219),ee=()=>o(962730),te=()=>o(351360),oe=()=>o(289190),ne=()=>o(227440),re=()=>o(630116),ie=()=>o(502438),le=()=>o(807778),ae=()=>o(577437),se=()=>o(493823),ce=()=>o(364280),ue=()=>o(545805),de=()=>o(135221),pe=()=>o(897119),ye=()=>o(125565),me=()=>o(51493),fe=()=>o(798174),Se=()=>o(683881),he=()=>o(524702),xe=()=>o(72135),be=()=>o(623580),ve=()=>o(634224),ge=o(474848);function ke(e){const{disabled:t,value:r,insertChar:l,format:c,onChange:u,isTable:d,size:p}=e,[y,m]=(0,n.useState)(""),f=(0,k().tz)(),S=(0,n.useCallback)((e=>{let t=(0,o(668766).q)(e,f);return"percent"===c&&void 0!==t&&(t/=100),t}),[f,c]),h=(0,n.useRef)(!1);(0,n.useEffect)((()=>{h.current||(m(xe().ZV(r,c,f)||""),h.current=!0)}),[c,f,r]);const x=(0,o(600871).GN)();(0,n.useEffect)((()=>{if(!x)return;const e=xe().$J(y,f);e&&r===-1*e&&m(r>0?y.replace("-",""):`-${y}`)}),[x,c,f,r,y]),(0,n.useEffect)((()=>{l&&(m(l),u(S(l)))}),[l,u,S]);const b=(0,n.useCallback)((e=>{const t=e.target.value;m(t),u(S(t))}),[u,S]),v=(0,s().IS)((()=>({input:{textAlign:d?"right":"left"},inputContainer:{..."large"===p?ve().qi:ve().qs,display:"block"}})),[d,p]),g=(0,i().Y0)(),w=(0,a().K8)((()=>g.isIOS&&!g.isIpad?x?"decimal":void 0:"decimal"),[g,x]);return(0,ge.jsx)(ue().A,{debugName:"NumberPropertyValue",capture:!t,onDelete:C().D_,onSpace:C().D_,onBackspace:C().D_,onLeft:C().D_,onRight:C().D_,onUp:C().D_,onDown:C().D_,onSelectAll:C().D_,onRedo:C().D_,onUndo:C().D_,onCut:C().D_,onCopy:C().D_,onPaste:C().D_,onKeypress:C().D_,children:(0,ge.jsx)(be().A,{style:v.inputContainer,value:y,format:be().C.Transparent,onChange:b,inputStyle:v.input,focus:!t,disabled:t,inputMode:w})})}const Ce=n.memo(ke),we=n.memo((function(e){const{disabled:t,inputType:o,onChange:r,value:i}=e,l=(0,s().IS)((()=>({input:{...ve().qs,display:"block"}})),[]),a=(0,n.useCallback)((e=>{r(e.target.value)}),[r]);return(0,ge.jsx)(ue().A,{debugName:"URLPropertyValue",capture:!t,onBackspace:C().D_,onCopy:C().D_,onCut:C().D_,onDelete:C().D_,onDown:C().D_,onKeypress:C().D_,onLeft:C().D_,onPaste:C().D_,onRedo:C().D_,onRight:C().D_,onSelectAll:C().D_,onSpace:C().D_,onUndo:C().D_,onUp:C().D_,children:(0,ge.jsx)(be().A,{disabled:t,focus:!t,format:be().C.Transparent,onChange:a,style:l.input,type:o,value:i})})}));var je=()=>o(41459),Pe=()=>o(414712),Ie=()=>o(857639),_e=()=>o(617837),Ae=()=>o(155004);function Be(e,t){const[o,r]=(0,n.useState)();return{feedbackState:o,setFeedbackState:r,inferenceId:(0,a().K8)((()=>{var t;return null===(t=e.store)||void 0===t||null===(t=t.getFormat())||void 0===t||null===(t=t.ai_property_inference_map)||void 0===t||null===(t=t[e.property])||void 0===t?void 0:t.inference_id}),[e])}}function Re(e){let{autofillBlockPropertyValueFeedbackButtonsState:t}=e;return t.inferenceId?(0,ge.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,ge.jsx)(_e().j,{traceId:t.inferenceId,feedbackState:t.feedbackState,setFeedbackState:t.setFeedbackState,feedbackType:"autofill"})}):(function(e){const{autofillBlockPropertyValueFeedbackButtonsState:t}=e;Ie().log({from:"AutofillUpdateButtonFailedToFetchFeedbackIndicators",level:"error",type:"Autofill",data:{miscDataToConvertToString:{...t}}})}({autofillBlockPropertyValueFeedbackButtonsState:t}),null)}function Me(e){let{overlayState:t,theme:o,propertySchema:n}=e;const r=(0,a().K8)((()=>oe().m.isWriting()),[]),l=(0,i().v3)(),s=Be(t),c=!(0,a().O$)(ne().e);return l.device.isMobile||c||r?null:(0,ge.jsx)(Ae().s,{allowSelectionWithin:!1,children:(0,ge.jsxs)("div",{style:{position:"absolute",top:-36,right:0,borderRadius:5,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",background:o.popoverBackground,boxShadow:o.shadowMD,zIndex:-1,padding:2},children:[(0,ge.jsx)(Ee,{overlayState:t,propertySchema:n}),(0,ge.jsx)(Re,{autofillBlockPropertyValueFeedbackButtonsState:s})]})})}function Ee(e){let{overlayState:t,propertySchema:o}=e;const n=(0,i().v3)(),r=(0,s().IS)((e=>({buttonStyle:{display:"flex",height:28},iconStyle:{height:16,width:16,fill:e.aiPurpleColor},updateTextStyle:{fontWeight:500,color:e.aiPurpleColor}})),[]);return(0,ge.jsx)(se().p,{style:r.buttonStyle,onClick:()=>{o&&V().autofillPropertyForBlocks({environment:n,stores:[t.store],property:t.property,propertySchema:o,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:t.collectionContextStore,from:N().zP(t.format)})},children:(0,ge.jsxs)(ce().fI,{gap:4,children:[(0,h().x)(r.iconStyle),(0,ge.jsx)("span",{style:r.updateTextStyle,children:(0,ge.jsx)(k().sA,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"})})]})})}function Te(e){let{overlayState:t,propertySchema:o,showSeparator:n}=e;const r=Be(t),i=(0,s().IS)((e=>({dot:{color:e.text.tertiary}})),[]);return(0,ge.jsxs)(ge.Fragment,{children:[n?(0,ge.jsx)("div",{style:i.dot,children:"•"}):null,(0,ge.jsx)(Re,{autofillBlockPropertyValueFeedbackButtonsState:r})]})}function Le(e){let{overlayState:t,propertySchema:o,style:n}=e;const r=(0,i().v3)(),l=(0,s().IS)((e=>({linkStyle:{color:e.aiPurpleColor,fontSize:12,...n}})),[n]);return(0,ge.jsx)("div",{style:l.linkStyle,onClick:()=>{o&&V().autofillPropertyForBlocks({environment:r,stores:[t.store],property:t.property,propertySchema:o,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:t.collectionContextStore,from:N().zP(t.format)})},children:(0,ge.jsx)(k().sA,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"})})}function Ve(e){const{store:t,additionalStores:o,collectionContextStore:n,collectionSchema:r}=e;return n&&(0,N().br)({store:t,additionalStores:o,collectionContextStore:n})?n.normalizedSchemaStore.state:r||t.getSchema()||{}}function Fe(e){if(!(0,N().br)({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore}))return e.store.getAssociatedCollectionStore()}function Oe(e){const t=Fe(e),o=t?t.getMappedProperty(e.property):e.property;return Ve(e)[o]}function He(e){let{overlayState:t,pageContext:o}=e;const{store:n}=t,r=Oe(t);return r&&(0,Q().ge)(null==o?void 0:o.publicEditModeStore.state,n)&&d().$M(r)&&d().om(r)&&!t.collectionsBulkActionsToolbarStore}var We=()=>o(187174),De=()=>o(65767),Ke=()=>o(10977),Ue=()=>o(722872),Ne=()=>o(736173),ze=()=>o(760217),Qe=()=>o(285790),Je=()=>o(928600),qe=()=>o(939740),Ye=()=>o(480095),$e=()=>o(89924),Ge=()=>o(856952),Ze=()=>o(123133),Xe=()=>o(828180);function et(e){let{propertyName:t,geopointValue:o,onChange:r,onClose:l}=e;const a=(0,i().Y0)(),[s,c]=(0,n.useState)(""),[{value:u=[]}]=(0,We().Yb)((async()=>{if(!s)return[];const e=(await(0,Ne().V)(s)).map((e=>e.placePrediction));return C().oE(e)}),[s]),d=(0,n.useCallback)((async e=>{const t=e.toPlace();await t.fetchFields({fields:["displayName","formattedAddress","location","googleMapsURI"]}),t.location&&(c(""),r({value:{lat:t.location.lat(),lon:t.location.lng(),name:t.displayName??void 0,address:t.formattedAddress??void 0,googlePlaceId:t.id??void 0,mapUri:t.googleMapsURI??void 0}}))}),[r]),p=(0,n.useCallback)((()=>{r({value:void 0})}),[r]),y={menuType:Ue().gu.Popup,...a.isMobile&&{title:t,menuType:Ue().gu.Modal,right:(0,ge.jsx)(Ye().DoneMenuText,{})},...!a.isMobile&&{tokenInputHeader:!0,maxHeight:333}};return(0,ge.jsx)(Je().A,{...y,header:(0,ge.jsx)(tt,{geopointValue:o,onClearLocationClick:p,setQuery:c,query:s}),disableHeaderBorder:!u.length,children:o?(0,ge.jsx)(Ze().F,{geoPoint:o}):(0,ge.jsx)(nt,{results:u,onSuggestionClick:d})})}function tt(e){const t=(0,i().Y0)(),o=(0,k().tz)(),{geopointValue:n,onClearLocationClick:r,setQuery:l,query:a}=e;return(0,ge.jsx)(Ge().Ay,{focus:!t.isMobile||void 0,focusAfterAnimation:!0,format:Ge().le.Geopoint,disabled:Boolean(n),tokens:n?[(0,ge.jsx)(ot,{geopointValue:n,onClearLocationClick:r},"geopointValue")]:[],tokenWrapStyle:{padding:"4px 6px",gap:4},placeholder:o.formatMessage({id:"geopointPropertyValueOverlay.search.placeholder",defaultMessage:"Search for a location..."}),value:a,onChange:e=>l(e.target.value),dontShowBorderBottom:t.isAndroid,onRemoveLastToken:r})}function ot(e){let{geopointValue:t,onClearLocationClick:o}=e;const n=(0,k().tz)(),r=(0,s().IS)((e=>({header:{display:"flex",alignItems:"center",fontSize:Xe().Mi},closeIconButton:{borderRadius:100,marginRight:2},closeIcon:{width:8,height:8}})),[]);return(0,ge.jsxs)("div",{style:r.header,children:[(0,ge.jsx)("div",{children:(0,Ke().t)({geopointAnnotation:(0,v().bxH)(t),index:0})}),(0,ge.jsx)(Qe().A,{style:r.closeIconButton,iconStyle:r.closeIcon,icon:De().l,onClick:o,ariaLabel:n.formatMessage({id:"geopointPropertyValueOverlay.clear",defaultMessage:"Clear location field"})})]})}function nt(e){const{results:t,onSuggestionClick:o}=e;if(!t.length)return null;const n=t.map((e=>({key:e.placeId,action:()=>o(e),render:t=>{var o,n;return(0,ge.jsx)(ze().A,{...t,title:null===(o=e.mainText)||void 0===o?void 0:o.text,caption:null===(n=e.secondaryText)||void 0===n?void 0:n.text})}})));return(0,ge.jsx)(qe().Ay,{type:qe().Oh.Vertical,initialFocus:0,sections:[{items:n,key:"results",render:e=>(0,ge.jsx)($e().A,{...e})}]})}const rt=n.memo((function(e){const t=(0,i().v3)(),r=(0,i().Y0)(),s=(0,o(963589).X)("db_ux_mobile"),{store:c}=e,u=(0,l().S)();(0,o(852507).l)((()=>{Ct({isFirstRender:!0},c,t)})),o(17022).A.withListenerIgnored((()=>{Ct({isFirstRender:!1},c,t)}));const y=(0,n.useRef)(void 0),m=(0,a().O$)(c),{originRect:f,mobileStyle:S,style:h,placementToOrigin:x}=(0,a().K8)((()=>{let e,n,i;const l=ee().W.Bottom;if(m.isOpen){const l=m.format===je().j.Page,c=Oe(m),y=c?c.type:void 0,f=m.store.canEdit();let S=m.rect.top,h=m.rect.left,x=m.rect.width,b=m.rect.height;if(l?(h-=1,x+=1):(S-=1,h-=1,x+=1,b+=2),("number"===y||p().DY(y))&&r.isMobile){const e=o(574012).A.mobileNativeBottomPadding(t)+24;i={overflowY:"auto",WebkitOverflowScrolling:"touch",width:Math.max(240,x),maxHeight:`calc(100vh - ${e}px)`}}if("number"===y)n={width:Math.max(240,x)};else if("date"===y)S+=b-1,n={};else if("relation"===y){const e=X().Qd;n={width:Math.max(e,x),minHeight:f?65:void 0,overflow:"hidden"}}else if("person"===y)n={width:Math.max(240,x)};else if("formula"===y)S+=b-1,n={borderRadius:12};else if("select"===y||"multi_select"===y)n={width:Math.max(300,x),overflow:"visible"};else if("rollup"===y)S+=b-1,n={};else if("file"===y)n={minWidth:Math.max(240,x)};else if("verification"===y)n={width:C().qE(x,265,270)};else{const e=24+(He({overlayState:m,pageContext:u})?28:0);n={width:Math.max(240,x),minHeight:Math.min(b,window.innerHeight-e),maxHeight:window.innerHeight-e,overflow:"visible",display:"flex",flexDirection:"column"},"status"===y&&N().br({store:m.store,additionalStores:m.additionalStores,collectionContextStore:m.collectionContextStore})&&(S+=b-1)}const v=m.collectionContextStore;if(v){var a,s;const e=v.subitemTreeStore.state,t=(0,o(708830).Qe)(e.children,(e=>e.value.store===m.store)),r=null==t?void 0:t.length,i=null===(a=v.normalizedFormatStore.state)||void 0===a||null===(a=a.table_properties)||void 0===a?void 0:a.filter((e=>e.visible)),l=i&&(null===(s=i[0])||void 0===s?void 0:s.property)===m.property;r&&l&&(n={...n,...y&&d().YW(y)&&{width:Math.max(90,x)}})}e=new DOMRect(h,S,x,0)}return{originRect:e,style:n,mobileStyle:i,placementToOrigin:l}}),[m,r.isMobile,t,u]),b=(0,a().K8)((()=>{const e=function(e){const{store:t,isMobile:o,isDBUXMobileEnabled:n}=e;if(o){const e=t.state;if(!e.isOpen)return pe().nl.SlideUp;const o=Oe(e);return o?n?ve().w1[o.type]:ve().Hp[o.type]:pe().nl.SlideUp}return pe().nl.Popup}({store:c,isMobile:r.isMobile,isDBUXMobileEnabled:s}),n=!r.isMobile||e===pe().nl.Popup,i={borderRadius:6,bottomSheetInitialState:"half",key:kt(c),popupType:e,open:m.isOpen,originRect:f,style:r.isMobile?S:h,alignmentToOrigin:ee().C.Start,placementToOrigin:x,preventScaleTransition:n,preventOpacityTransition:n,render:()=>function(e){const{overlayState:t,store:o,environment:n}=e;if(t.isOpen)return(0,ge.jsx)(ue().A,{debugName:"BlockPropertyValueOverlay",capture:!0,onTab:e=>_t(e,o,n),onUntab:e=>At(e,o,n),onEnter:()=>Bt(o,n),onDelete:C().D_,onBackspace:C().D_,children:(0,ge.jsxs)(U().RI,{value:t.collectionContextStore,children:[(0,ge.jsx)(it,{overlayState:t}),(0,ge.jsx)("div",{style:{display:"flex",flexDirection:"column",overflowY:"auto",flexGrow:1,height:"100%"},children:(0,ge.jsx)(lt,{overlayState:t,store:o})})]})},`${t.store.id}${t.property}`)}({overlayState:m,store:c,environment:t}),onDismiss:()=>function(e,t){o(112873).xl(),A().vF({environment:t,blockPropertyValueOverlayStore:e})}(c,t)};return y.current=i,i}),[r.isMobile,s,t,S,f,m,x,c,h]);return m.isOpen||!y.current?(0,ge.jsx)(pe().Ay,{...b}):(0,ge.jsx)(pe().Ay,{...y.current,open:!1})}));function it(e){let{overlayState:t}=e;const o=(0,l().S)(),n=(0,s().DP)(),r=(0,a().K8)((()=>He({overlayState:t,pageContext:o})),[t,o]),i=(0,a().K8)((()=>r?Oe(t):void 0),[r,t]);return r?(0,ge.jsx)(Me,{theme:n,propertySchema:i,overlayState:t}):null}function lt(e){let{overlayState:t,store:o}=e;const n=(0,a().K8)((()=>Oe(t)),[t]);if(!n)return null;const r=at[n.type];return r?(0,ge.jsx)(r,{store:o,overlayState:t,propertySchema:n,propertyType:n.type}):null}const at={title:function(e){let{overlayState:t,propertyType:o,store:r}=e;const l=(0,i().v3)(),{clonedStore:s}=t,c=(0,n.useCallback)((()=>Bt(r,l)),[r,l]),u=(0,n.useCallback)((()=>It(r,l)),[r,l]),d=(0,n.useCallback)((e=>_t(e,r,l)),[r,l]),p=(0,n.useCallback)((e=>At(e,r,l)),[r,l]),y=(0,n.useCallback)((()=>Tt(t,o,l,r)),[t,o,l,r]),m=(0,a().K8)((()=>s.getTitleStore()||s.getPropertyStore(t.property)),[s,t.property]),f=(0,a().K8)((()=>jt(t,l)),[t,l]);return(0,ge.jsx)("div",{style:st,children:(0,ge.jsx)(he().A,{store:m,disableSlashCommands:!0,onEnter:c,onEsc:u,onTab:d,onUntab:p,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableShiftEnter:!0,onChange:y,disabled:f,pasteBehavior:"inline",inPageFind:J().Os.none})})},text:function(e){var t;let{overlayState:o,propertySchema:r,propertyType:l,store:s}=e;const c=(0,i().v3)(),u=(0,k().tz)(),{clonedStore:d}=o,p="text"===(null==r?void 0:r.type)&&(null===(t=r.ai_inference)||void 0===t?void 0:t.auto_update_on_edit);let y;p&&(y=u.formatMessage({id:"BlockPropertyValueOverlay.textProperty.placeholder",defaultMessage:"Empty"}));const m=(0,a().K8)((()=>s.state.isOpen&&K().A.getPropertyId()===s.state.property&&K().A.getBlockStore()===s.state.store),[s]),f=(0,n.useCallback)((()=>Bt(s,c)),[s,c]),S=(0,n.useCallback)((()=>It(s,c)),[s,c]),h=(0,n.useCallback)((e=>_t(e,s,c)),[s,c]),x=(0,n.useCallback)((e=>At(e,s,c)),[s,c]),b=(0,n.useCallback)((()=>Tt(o,l,c,s)),[o,l,c,s]),v=(0,a().K8)((()=>d.getPropertyStore(o.property)),[d,o.property]),g=(0,a().K8)((()=>jt(o,c)),[o,c]);return(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsxs)("div",{style:ve().qs,children:[(0,ge.jsx)(he().A,{store:v,disableSlashCommands:!0,onEnter:f,onEsc:S,onTab:h,onUntab:x,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onChange:b,disabled:g,disableStyleAnnotations:p,pasteBehavior:"inline",placeholder:y,inPageFind:J().Os.none,hasTemporaryDiscussionOnProperty:m}),(0,ge.jsx)(ct,{overlayState:o,propertySchema:r})]}),(0,ge.jsx)(ut,{overlayState:o,propertySchema:r})]})},relation:function(e){let{overlayState:t,store:r}=e;const l=(0,i().v3)(),s=pt(t),u=(0,a().K8)((()=>p().n(xt(t))),[t]),m=yt(t),S=ft(t),h=(0,a().K8)((()=>t.store.getParentId()),[t]),g=St(t),k=(0,n.useCallback)((()=>Pt(r,l)),[r,l]),j=(0,n.useCallback)((e=>async function(e,t,o){const n=o.state;if(!n.isOpen)return;const r=Oe(n);if(!r||"relation"!==r.type)return;const i="relation"===r.type&&d().zO(r),l=i&&new(re().md)(t,{table:b().Vl,id:i});l&&await l.load();L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleRelationPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(e.newPage&&i&&l){const o=v().x9d(e.newPage.name),i=l.getRootPagePointer()??l.pointer,a=M().Wv({environment:t,id:e.newPage.id,type:c().xd.page,properties:{title:o},spaceId:e.newPage.spaceId,inMemoryRecordCache:n.store.inMemoryRecordCache,transaction:r});if(i.table===x().ev){const e=new(re().Bv)(t,i);R().NI({parentStore:e,childStore:a,transaction:r})}else i.table===b().Vl?R().X$({parentStore:l,childStore:a,transaction:r}):(0,w().HB)(i);const s=l.getDefaultTemplatePageStore();s&&B().n5({title:{text:o},environment:t,store:re().Bv.createChildStore(l,a.pointer),templateStore:s,isKeyboard:!1,isCreateIn:!1,transaction:r,from:"relation_property_menu_update"})}const a=e.newValues,s=e.oldValues,u=(0,f().i)(s.map(y().jV),a.map(y().jV)),d=C().oE(Array.from(u.removeOps).map((e=>{if(!a.find((t=>(0,y().jV)(t)===e)))return s.find((t=>(0,y().jV)(t)===e))}))),p=[];for(const e in u.beforeOps){const t=a.find((t=>(0,y().jV)(t)===e));if(!t)continue;const o=u.beforeOps[e];if(!o){p.push({relationToAdd:t});continue}const n=a.find((e=>(0,y().jV)(e)===o));p.push({relationToAdd:t,before:n})}for(const e of vt(n)){for(const o of d)E().zB({environment:t,store:e,propertyId:n.property,id:o.id,transaction:r});for(const o of p)o.before?E().K6({environment:t,store:e,propertyId:n.property,id:o.relationToAdd.id,position:{type:"before",before:o.before.id},transaction:r}):E().K6({environment:t,store:e,propertyId:n.property,id:o.relationToAdd.id,position:{type:"after"},transaction:r})}Mt(n,t,o)}})}(e,l,r)),[l,r]);if(h)return(0,ge.jsx)(o(655424).O,{blockPointers:u,property:t.property,collectionStore:m,collectionId:h,schema:s,isDisabled:g,canConfigureCollection:S,onChange:j,analyticsFrom:bt(t),onDismiss:k,blockStore:t.store,blockPropertyValueOverlayStore:r,overlayMode:t.mode,insertChar:t.insertChar,format:t.format,children:(0,ge.jsx)(X().PF,{})});return null},rollup:function(e){let{overlayState:t,store:o}=e;const r=(0,i().v3)(),l=(0,a().K8)((()=>Ve(t)),[t]),s=dt(t),c=(0,a().K8)((()=>{const e=Fe(t),o=null==e?void 0:e.getParentBlockStore();return jt(t,r)||!(0,D().v)({collectionStore:e,collectionViewBlockStore:o,checkNavigableAncestorLocked:!1})||s}),[t,r,s]),u=(0,n.useCallback)((()=>Pt(o,r)),[o,r]),d=(0,n.useCallback)((e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleRollupPropertyMenuUpdate",environment:o,canUndo:!0,perform:r=>{!function(e,t,o,n){const r=o.state;if(!r.isOpen)return;if(r.isOpen){const o=Fe(r);o&&(0,W().F)({environment:n,collectionStore:o,update:e,transaction:t})}}({[n.property]:e.propertySchema},r,t,o)}})}(e,o,r)),[o,r]);return(0,ge.jsx)(fe().A,{context:fe().C.BlockPropertyOverlay,property:t.property,schema:l,disabled:c,onChange:d,parentStore:t.store,analyticsFrom:bt(t),onDismiss:u})},select:function(e){let{overlayState:t,store:o}=e;const r=(0,i().v3)(),l=pt(t),s=yt(t),c=function(e){return(0,a().K8)((()=>Oe(e)),[e])}(t),u=mt(t),d=St(t),y=ft(t),m=(0,n.useCallback)((e=>Rt(e,o,r)),[o,r]),f=(0,n.useCallback)((()=>Pt(o,r)),[o,r]),S=(0,n.useCallback)((e=>Et(e,r,o)),[r,o]);if(!s||!c||"select"!==c.type)return null;const h=p().L3(u,c.options||[]);return(0,ge.jsx)(Se().A,{allowMultiple:!1,value:h?[h]:[],property:t.property,collectionId:s.id,schema:l,disabled:d,canConfigureCollection:y,onChange:S,analyticsFrom:bt(t),insertChar:t.insertChar,onAccept:m,onDismiss:f,blockStore:t.store,additionalStores:t.additionalStores,autofillExplanation:(0,ge.jsx)(ct,{overlayState:t,propertySchema:c}),bulkAutofillButton:(0,ge.jsx)(ut,{overlayState:t,propertySchema:c})})},multi_select:function(e){let{overlayState:t,store:o,propertySchema:r}=e;const l=(0,i().v3)(),a=pt(t),s=yt(t),c=mt(t),u=St(t),d=ft(t),y=(0,n.useCallback)((e=>Et(e,l,o)),[l,o]),m=(0,n.useCallback)((e=>Rt(e,o,l)),[o,l]),f=(0,n.useCallback)((()=>Pt(o,l)),[o,l]);if(!s||!r||"multi_select"!==r.type)return null;const S=p().o2(c,r.options||[]);return(0,ge.jsx)(Se().A,{allowMultiple:!0,value:S,property:t.property,collectionId:s.id,schema:a,disabled:u,canConfigureCollection:d,onChange:y,analyticsFrom:bt(t),insertChar:t.insertChar,onAccept:m,onDismiss:f,blockStore:t.store,additionalStores:t.additionalStores,autofillExplanation:(0,ge.jsx)(ct,{overlayState:t,propertySchema:r}),bulkAutofillButton:(0,ge.jsx)(ut,{overlayState:t,propertySchema:r})})},status:function(e){let{overlayState:t,propertySchema:r,store:l}=e;const a=(0,i().v3)(),s=mt(t),c=St(t),u=(0,n.useMemo)((()=>{if(!r||"status"!==r.type)return;return{initialValue:p().RZ(s,r),property:t.property,propertySchema:r,disabled:c,onDismiss:()=>Pt(l,a),onChange:(e,t)=>{e?Et({type:"selectPropertyMenuUpdateReplaceOptions",options:[e]},a,l):t?function(e,t,o){const n=o.state;if(!n.isOpen)return;L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleStatusGroupPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(e.groupType){for(const o of vt(n)){var i;const l=o.getAssociatedCollectionStore();if(!l)continue;const a=l.getSchema(),s=l.getMappedProperty(n.property),c=a[s];if("status"!==(null==c?void 0:c.type))continue;const u=(c.groups??[]).find((t=>{var o;return t.name.toLowerCase()===(null===(o=e.groupType)||void 0===o?void 0:o.toLowerCase())})),d=null==u||null===(i=u.optionIds)||void 0===i?void 0:i.at(0);if(!d)continue;const p=(c.options??[]).find((e=>e.id===d));if(!p)continue;const y=o.getPropertyStore(s);T().R9({environment:t,store:y,value:[[p.value]],transaction:r})}Mt(n,t,o)}}})}({groupType:t},a,l):r.defaultOption?Et({type:"selectPropertyMenuUpdateReplaceOptions",options:[r.defaultOption]},a,l):Et({type:"selectPropertyMenuUpdateReplaceOptions",options:[]},a,l)},onAccept:e=>Rt(e,l,a),blockPropertyValueOverlayStore:l}}),[r,s,c,t,l,a]);if(!r||"status"!==r.type||!u)return null;return t.property===o(66689).Hx.StatusV2?(0,ge.jsx)(o(940433).F,{...u}):(0,ge.jsx)(o(706513).r,{...u})},person:function(e){let{overlayState:t,propertySchema:r,store:l}=e;const s=(0,i().v3)(),c=pt(t),u=mt(t),d=(0,a().K8)((()=>{var e;return null===(e=t.collectionContextStore)||void 0===e?void 0:e.collectionStore()}),[t.collectionContextStore]),y=(0,a().K8)((()=>t.store.isTemplate()),[t]),m=St(t),f=(0,n.useCallback)((()=>Pt(l,s)),[l,s]),S=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;L().createAndCommit({userAction:"BlockPropertyValueOverlay.handlePersonPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(j().pN(e.schema)||wt(e.schema,r,o,t),"personPropertyMenuUpdateAddPerson"===e.type){for(const t of gt(n))for(const o of e.newValues)L().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"addPersonAfter",args:{pointer:o}}});Mt(n,t,o),n.property!==g()._e.Owner&&"notion://wiki/owner_property"!==n.property||(0,me().y)({environment:t,blockStore:n.store,entrypoint:"property_menu",action:"add"})}else if("personPropertyMenuUpdateRemovePerson"===e.type){for(const t of gt(n))L().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"removePerson",args:{pointer:e.removedValue}}});Mt(n,t,o),n.property!==g()._e.Owner&&"notion://wiki/owner_property"!==n.property||(0,me().y)({environment:t,blockStore:n.store,entrypoint:"property_menu",action:"remove"})}else if("personPropertyMenuUpdateReplacePerson"===e.type){const i=p().RV([e.newValue]);for(const e of gt(n))T().R9({environment:t,store:e,value:i,transaction:r});Mt(n,t,o),n.property!==g()._e.Owner&&"notion://wiki/owner_property"!==n.property||(0,me().y)({environment:t,blockStore:n.store,entrypoint:"property_menu",action:"replace"})}else(0,w().HB)(e)}})}(e,s,l)),[s,l]),h=(0,a().K8)((()=>t.store.getCreatedByPointer()),[t]);if(!r||"person"!==r.type)return null;const x=p().as({value:u,isTemplatePage:y,propertySchema:r,blockCreatorPointer:y||N().NN(t.format)?void 0:h}),b=(0,w().O9)(r.default)&&!u&&1===x.length;return(0,ge.jsx)(o(583538).Ay,{value:x,format:t.format,valueIsUnpersistedDefaultValue:b,propertySchema:r,schema:c,disabled:m,onChange:S,insertChar:t.insertChar,onDismiss:f,parentStore:t.store,isTemplatePage:y,formQuestionStore:t.formQuestionStore,collectionStore:d})},number:function(e){let{overlayState:t,store:o,propertySchema:r}=e;const l=(0,i().v3)(),a=mt(t),s=St(t),c=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;(0,Pe().YX)(e,t,gt(n)),Mt(n,t,o)}(e,l,o)),[l,o]);if(!r||"number"!==r.type)return null;const u=t.format===je().j.Table,d=p().Me(a),y="large"===(null==t?void 0:t.sizing)?"large":"default";return(0,ge.jsx)(Ce,{size:y,value:d,isTable:u,format:r.number_format||"number",disabled:s,insertChar:t.insertChar,onChange:c})},date:function(e){let{overlayState:t,store:r,propertySchema:l}=e;const s=(0,i().v3)(),c=mt(t),u=St(t),d=ft(t),p=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyValueChange",environment:t,canUndo:!0,perform:r=>{for(const i of vt(n))!e||m().kC(e)?(F().D5({environment:t,store:i,type:"dateValue",dateValue:e,propertyId:n.property,transaction:r}),e||Pt(o,t)):(M().zv({store:i.getPropertiesStore(),transaction:r,data:{[n.property]:[v().wmz(v().Ii$({type:e}))]}}),Pt(o,t)),Mt(n,t,o)}})}(e,s,r)),[s,r]),y=(0,n.useCallback)((e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;const r=Oe(n);if(!r||"date"!==r.type)return;const i=Ve(n),l={...r,date_format:e},a={...i,[n.property]:l};if(L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyDateFormatChange",environment:o,canUndo:!0,perform:e=>{wt(a,e,t,o)}}),l){var s;bt(n),(0,_().L)(o,{property_type:l.type,action:"date_change_format",from:bt(n),collection_id:null===(s=Fe(n))||void 0===s?void 0:s.id})}}(e,r,s)),[s,r]),f=(0,n.useCallback)((e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;const r=Oe(n);if(!r||"date"!==r.type)return;const i=Ve(n),l={...r,time_format:e},a={...i,[n.property]:l};if(L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyTimeFormatChange",environment:o,canUndo:!0,perform:e=>{wt(a,e,t,o)}}),l){var s;bt(n),(0,_().L)(o,{property_type:l.type,action:"date_change_format",from:bt(n),collection_id:null===(s=Fe(n))||void 0===s?void 0:s.id})}}(e,r,s)),[s,r]),S=(0,n.useCallback)((()=>Pt(r,s)),[r,s]),h=(0,a().K8)((()=>t.store.isTemplate()),[t]);if(!l||"date"!==l.type)return null;const x=(0,o(787626).b)(c),b=[je().j.FormEditor,je().j.FormViewer].includes(t.format);return(0,ge.jsx)($().u2,{dependency:o(896780).cm,children:e=>{let{DatePropertyMenu:n}=e;return(0,ge.jsx)(n,{firstDayOfWeek:o(186445).XX.state,value:x,format:t.format,onChangeValue:p,dateFormat:l.date_format,onChangeDateFormat:y,timeFormat:l.time_format,disabled:u,canConfigureCollection:d,onChangeTimeFormat:f,onDismiss:S,shouldShowReminder:!b,shouldShowControls:!b,isTemplatePage:h,formQuestionStore:t.formQuestionStore})}})},file:function(e){let{overlayState:t,store:r}=e;const l=(0,i().v3)(),a=pt(t),s=mt(t),c=St(t),u=p().pJ(s),d=(0,n.useCallback)((()=>Pt(r,l)),[r,l]),y=(0,n.useCallback)((e=>L().createAndCommit({userAction:"BlockPropertyValueOverlay.renderFile",environment:l,canUndo:!0,perform:o=>{if(j().pN(e.schema)||wt(e.schema,o,r,l),!j().pN(e.value)){const n=p().eQ(e.value);for(const e of gt(t))T().R9({environment:l,store:e,value:n,transaction:o});Mt(t,l,r)}e.pastedSecureFile&&M().Bn({store:t.store,source:e.pastedSecureFile.copiedSource,fileIds:[e.pastedSecureFile.fileId],transaction:o})}})),[l,r,t]);return(0,ge.jsx)(o(766024).A,{store:t.store,value:u,property:t.property,schema:a,onDismiss:d,uploadFiles:t.uploadFiles,disabled:c,onChange:y})},url:ht,phone_number:ht,email:ht,formula:function(e){let{overlayState:t,propertySchema:r,store:l}=e;const s=(0,i().v3)(),c=dt(t),u=St(t),d=ft(t),p=yt(t),y=(0,a().K8)((()=>t.store.getModel()),[t.store]),m=(0,n.useCallback)((()=>Pt(l,s)),[l,s]),f=(0,n.useCallback)((e=>function(e,t){const{newValue:o,newType:n,propertySchema:r,property:i,collectionStore:l}=e,a=o?{...r,formula2:{code:o,result_type:n},version:"v2"}:{...r,formula2:void 0,version:"v2"};L().createAndCommit({userAction:"CollectionSettingsFormulaOptions.handleFormulaChange",environment:t,canUndo:!0,perform:e=>{(0,W().F)({environment:t,collectionStore:l,update:{[i]:a},transaction:e})}})}(e,s)),[s]),S=u||!d||c;if(y&&p&&r&&"formula"===r.type)return(0,ge.jsx)($().u2,{dependency:o(862292).T.formulas,children:e=>(0,ge.jsx)(o(490696).A,{handleClose:m,property:t.property,getRecordModel:t.store.getRecordModel,propertySchema:r,collectionStore:p,handleSave:f,formulas:e,disabled:S,blockStore:t.store,analyticsFrom:bt(t)})});return null},verification:function(e){let{overlayState:t,propertySchema:r,store:l}=e;const a=(0,i().v3)(),s=mt(t),c=(0,n.useCallback)((e=>{L().createAndCommit({userAction:"BlockPropertyValueOverlay.verification",environment:a,canUndo:!0,perform:o=>{const n=p().j2(e.value);for(const e of gt(t))T().R9({environment:a,store:e,value:n,transaction:o});Mt(t,a,l)}}),(0,me().q)({environment:a,blockStore:t.store,update:e})}),[a,t,l]),u=(0,n.useCallback)((()=>Pt(l,a)),[l,a]),d=(0,g().U1)(s);if("verification"!==(null==r?void 0:r.type))return null;return(0,ge.jsx)(o(908671).y,{propertyName:r.name,onChange:c,verificationValue:d,getRecordModel:t.store.getRecordModel,blockId:t.store.id,onClose:u,showTitle:!0,showCurrentStatusHeader:!0,showRemoveVerificationButton:!0,showVerificationFooter:!0,showCustomHeader:!1,entrypoint:"db_property_menu"})},geo_point:function(e){let{overlayState:t,propertySchema:o,propertyType:r,store:l}=e;const a=(0,i().v3)(),s=mt(t),c=(0,n.useCallback)((e=>{const{store:o,property:n}=t;L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleGeoPointChange",environment:a,canUndo:!0,perform:t=>{T().R9({environment:a,store:o.getPropertyStore(n),value:(0,S().n)(e.value),transaction:t})}})}),[a,t]),u=(0,n.useCallback)((()=>{Pt(l,a)}),[l,a]);if("geo_point"!==(null==o?void 0:o.type))return null;const d=(0,S().w)(s);return(0,ge.jsx)(et,{geopointValue:d,propertyName:o.name,onChange:c,onClose:u})},checkbox:void 0,created_by:void 0,created_time:void 0,last_edited_by:void 0,last_edited_time:void 0,last_visited_time:void 0,button:void 0,auto_increment_id:void 0,location:void 0},st={...ve().qs,fontWeight:o(284371).Wy.medium};function ct(e){let{overlayState:t,propertySchema:o}=e;const n=(0,i().v3)(),r=(0,i().Y0)(),c=(0,l().S)(),u=(0,a().K8)((()=>(0,Q().O0)(n)),[n]),p=(0,a().K8)((()=>oe().m.isWriting()),[]),y=!(0,a().O$)(ne().e),m=o&&d().$M(o)?(0,d().om)(o):void 0,f=(0,a().K8)((()=>(0,Q().ge)(null==c?void 0:c.publicEditModeStore.state,t.store)),[c,t]),S=(0,s().IS)((e=>({aiWritingLabel:{fontSize:12,color:e.aiPurpleColor,display:"flex",alignItems:"inline",fontWeight:500,marginTop:6,marginBottom:2},editContainer:{display:"flex",alignItems:"center",marginTop:6,marginBottom:2},dot:{color:e.text.tertiary},autoUpdatingLinkContainer:{paddingLeft:2,display:"flex",alignItems:"center"},autoUpdatingMobileLink:{paddingLeft:2,paddingRight:2},editMobileLink:{marginTop:6,marginBottom:2}})),[]);return u?y?null:p?(0,ge.jsxs)(ye().A,{isSecondaryColor:!0,style:S.aiWritingLabel,isSmall:!0,isMultiline:!0,children:[(0,ge.jsx)(k().sA,{defaultMessage:"AI is writing",id:"BlockPropertyValueOverlay.AIActionText.overlay"}),(0,ge.jsx)("div",{style:{marginLeft:4},children:(0,ge.jsx)(de().A,{})})]}):null!=m&&m.auto_update_on_edit?(0,ge.jsxs)("div",{style:S.editContainer,children:[(0,ge.jsx)(ye().A,{isSecondaryColor:!0,style:{fontSize:12},isSmall:!0,isMultiline:!0,children:(0,ge.jsx)(k().sA,{defaultMessage:"Auto-updated by AI",id:"BlockPropertyValueOverlay.helpText.overlay"})}),r.isMobile&&f&&(0,ge.jsxs)("div",{style:S.autoUpdatingLinkContainer,children:[(0,ge.jsx)("div",{style:S.dot,children:"•"}),(0,ge.jsx)(Le,{overlayState:t,propertySchema:o,style:S.autoUpdatingMobileLink}),(0,ge.jsx)(Te,{overlayState:t,propertySchema:o,showSeparator:!0})]})]}):r.isMobile&&m&&f?(0,ge.jsx)(Le,{overlayState:t,propertySchema:o,style:S.editMobileLink}):null:null}function ut(e){let{overlayState:t,propertySchema:o}=e;const{store:r}=t,c=null==o?void 0:o.name,u=(0,i().v3)(),p=(0,l().S)(),y=(0,a().K8)((()=>(0,Q().ge)(null==p?void 0:p.publicEditModeStore.state,r)),[p,r]),m=!(0,a().O$)(ne().e),f=(0,a().K8)((()=>{var e;return Math.max((null===(e=t.collectionsBulkActionsToolbarStore)||void 0===e?void 0:e.getNumberOfTextStoresBeingEdited())??0,ie().default.state.stores.length)}),[t]),S=(0,s().IS)((e=>({button:{width:"100%",height:"auto",borderTop:`1px solid ${e.regularDividerColor}`},magicWandIcon:{width:18,fill:e.aiPurpleColor},titleContainer:{fontSize:14,whiteSpace:"normal"},descriptionContainer:{fontSize:12,color:e.text.secondary,whiteSpace:"normal",lineHeight:"1.4em"}})),[]),x=(0,a().K8)((()=>r.getSpaceId()),[r]),b=(0,a().K8)((()=>{var e;return null===(e=te().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),v=(0,ae()._X)({name:"collection_property_autofill",spaceId:x,userId:b,amount:f}),g=(0,n.useCallback)((()=>{v&&((0,ae().e2)(v)?function(e,t,o){const{collectionsBulkActionsToolbarStore:n}=e;if(!n)return;if((0,ae().e2)(t)){let t=n.state.textStoresBeingEdited;if(0===t.length&&(t=ie().default.state.stores),!(0,w().EI)(t))return;const r=Oe(e);if(!r)return;V().autofillPropertyForBlocks({environment:o,stores:t,property:e.property,propertySchema:r,userEventForAnalytics:"generate_from_overlay_button",isBulkAction:!0,from:N().zP(e.format),collectionContextStore:e.collectionContextStore})}else V().triggerAiAutofillUpsell({environment:o,from:"ai_autofill_bulk_fill",upsell:t.upsell})}(t,v,u):V().triggerAiAutofillUpsell({environment:u,from:"ai_autofill_bulk_fill",upsell:v.upsell}))}),[t,v,u]),C=(0,a().K8)((()=>(0,le().Le)()),[]);if(o&&y&&d().$M(o)&&(0,d().om)(o)){if(f<=1||m||!v)return null;const e=v.limit.amount;return(0,ge.jsx)(se().p,{style:S.button,onClick:()=>g(),children:(0,ge.jsxs)(ce().fI,{gap:8,padding:"8px 0px",alignItems:"start",children:[(0,h().x)(S.magicWandIcon),(0,ge.jsxs)(ce().VP,{gap:4,children:[(0,ge.jsx)("div",{style:S.titleContainer,children:c?(0,ge.jsx)(k().sA,{defaultMessage:'Update "{propertyName}" with AI',id:"BlockPropertyValueOverlay.bulkAiAutofillButton.titleWithPropertyName",values:{propertyName:c}}):(0,ge.jsx)(k().sA,{defaultMessage:"Update with AI",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.title"})}),(0,ge.jsx)("div",{style:S.descriptionContainer,children:(0,ae().e2)(v)?(0,ge.jsx)(k().sA,{defaultMessage:"{numPages, select, 1 {Update {numPages} page} other {Update {numPages} pages}}",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.countAndDescription",values:{numPages:f}}):0===e?C?(0,ge.jsx)(k().sA,{defaultMessage:"Upgrade Notion AI to update properties with AI",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.largeBulkFillUpsellMessage.zeroPagesV2"}):(0,ge.jsx)(k().sA,{defaultMessage:"Get the AI add-on to update properties with AI",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.largeBulkFillUpsellMessage.zeroPages"}):C?(0,ge.jsx)(k().sA,{defaultMessage:"Upgrade Notion AI to update more than {maxItems} pages at once",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.largeBulkFillUpsellMessageV2",values:{maxItems:v.limit.amount}}):(0,ge.jsx)(k().sA,{defaultMessage:"Get the AI add-on to update more than {maxItems} pages at once",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.largeBulkFillUpsellMessage",values:{maxItems:v.limit.amount}})})]})]})})}return null}function dt(e){return(0,a().K8)((()=>{var t;if(!e.isOpen)return!1;const o=null===(t=e.collectionContextStore)||void 0===t?void 0:t.collectionStore();if(!o)return!1;const n=e.property;return Boolean(o.getDatabaseType()&&o.isTypedProperty(n))}),[e])}function pt(e){return(0,a().K8)((()=>Ve(e)),[e])}function yt(e){return(0,a().K8)((()=>Fe(e)),[e])}function mt(e){return(0,a().K8)((()=>xt(e)),[e])}function ft(e){return(0,a().K8)((()=>{const t=Fe(e),o=null==t?void 0:t.getParentBlockStore();return(0,D().v)({collectionStore:t,collectionViewBlockStore:o,checkNavigableAncestorLocked:!1})}),[e])}function St(e){const t=(0,i().v3)();return(0,a().K8)((()=>jt(e,t)),[e,t])}function ht(e){let{overlayState:t,propertyType:o,store:r}=e;const l=mt(t),a=v().k4p(l),s=St(t),c=(0,i().v3)(),u=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;const r=p().jw(e);L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleURLValueChange",environment:t,canUndo:!0,perform:e=>{for(const o of gt(n))T().R9({environment:t,store:o,value:r,transaction:e})}}),Mt(n,t,o),I().oF(t,{pastedText:e,source:"url_property"})}(e,c,r)),[c,r]),d=(0,n.useCallback)((()=>Pt(r,c)),[r,c]);let y="url";return"phone_number"===o?y="tel":"email"===o&&(y="email"),(0,ge.jsx)(we,{value:a,inputType:y,disabled:s,onChange:u,onDismiss:d})}function xt(e){return e.store.getPropertyValue(e.property)}function bt(e){return N().zP(e.format)}function vt(e){return[e.store,...e.additionalStores]}function gt(e){return vt(e).map((t=>{const o=t.getAssociatedCollectionStore(),n=o?o.getMappedProperty(e.property):e.property;return t.getPropertyStore(n)}))}function kt(e){const t=e.state;if(!t.isOpen)return"ignore";const o=Oe(t);return o?o.type:"ignore"}function Ct(e,t,o){let{isFirstRender:n}=e;const r=t.state;if(!r.isOpen||!r.collectionContextStore)return;const i=Z().default.DO_NOT_USE_markLegacy("collections.block_property_value_overlay_render");Z().default.DO_NOT_USE_measureAfterNextFlushLegacy(i,{environment:o,getData:()=>{var e;return{...z().kz(r.collectionContextStore),is_first_render:n,property_type:null===(e=Oe(r))||void 0===e?void 0:e.type,from:N().zP(r.format)}}})}function wt(e,t,o,n){const r=o.state;if(r.isOpen&&r.isOpen){const o=Fe(r);o&&(0,H().I)({environment:n,collectionStore:o,update:{schema:e},transaction:t})}}function jt(e,t){if((0,G().W)(t,e.store.id))return!0;const o=Oe(e),n=o&&d().$M(o)&&(0,d().om)(o);if(n&&n.auto_update_on_edit&&(0,Q().O0)(t))return!0;const r=Fe(e);return!(null==r||!r.isExternallyImportedAndSyncedCollection()||!(0,Y().pB)()||(0,Y().CS)()&&"read_write"===(null==o?void 0:o.synced_permissions))||(e.readOnly||(0,q().Y)(t,e.store)||(0,u().u)(e.property))}function Pt(e,t){A().VN({environment:t,blockPropertyValueOverlayStore:e})}function It(e,t){A().tY({environment:t,blockPropertyValueOverlayStore:e})}function _t(e,t,o){e.preventDefault(),A().XQ({environment:o,blockPropertyValueOverlayStore:t})}function At(e,t,o){e.preventDefault(),A().gu({environment:o,blockPropertyValueOverlayStore:t})}function Bt(e,t){A().iF({environment:t,blockPropertyValueOverlayStore:e})}function Rt(e,t,o){const n=t.state;if(!n.isOpen)return;const i=Oe(n);!i||"select"!==i.type&&"status"!==i.type||r().default.afterNextFlush((()=>{e?A().iF({environment:o,blockPropertyValueOverlayStore:t}):A().tY({environment:o,blockPropertyValueOverlayStore:t})}))}function Mt(e,t,o){const n=e.store.getType(),r=e.store.getAssociatedCollectionId(),i=Oe(e),{collectionContextStore:l}=e;if(n&&i&&l){const n=bt(e);(0,P().E)({environment:t,collectionContextStore:l,block_id:e.store.id,property:e.property,property_type:i.type,from:n,collection_id:r,isFromBulkActionsToolbar:N().pi(o),value_count:p().o6(e.store.getModel(),e.property,i)})}}function Et(e,t,o){const n=o.state;n.isOpen&&L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleSelectPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(j().pN(e.schemaOperations)||function(e,t,o,n){const r=o.state;if(r.isOpen&&r.isOpen){const o=Fe(r);if(o){const r=o.getSchema();for(const n of e)L().applyOperation({store:(0,re().Oo)(o,n.pointer),operation:n,transaction:t});const i=o.getSchema();(0,O().H)({environment:n,collectionStore:o,oldSchema:r,newSchema:i,transaction:t})}}}(e.schemaOperations,r,o,t),"selectPropertyMenuUpdateReplaceOptions"===e.type){const i=p().rK(e.options);for(const e of gt(n))T().R9({environment:t,store:e,value:i,transaction:r});Mt(n,t,o)}else if("selectPropertyMenuUpdateAddOptions"===e.type){for(const t of gt(n))for(const o of e.addOptions)L().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"addSelectOptionAfter",args:{option:o}}});Mt(n,t,o)}else if("selectPropertyMenuUpdateRemoveOption"===e.type){for(const t of gt(n))L().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"removeSelectOption",args:{option:e.removeOption}}});Mt(n,t,o)}else"selectPropertyMenuUpdateSchema"===e.type||(0,w().HB)(e)}})}function Tt(e,t,o,n){!function(e,t,o){const n=Z().default.DO_NOT_USE_markLegacy("collections.property_overlay_typing_lag");Z().default.DO_NOT_USE_measureAfterNextFlushLegacy(n,{environment:o,getData:()=>({...z().kz(e.collectionContextStore),property_type:t,from:N().zP(e.format)})})}(e,t,o);const{store:r,property:i,additionalStores:l}=e,a=r.getPropertyStore(i).getValue();L().createAndCommit({userAction:"BlockPropertyValueOverlay.handleTextChange",environment:o,canUndo:!0,perform:e=>{for(const t of l)T().R9({environment:o,store:t.getPropertyStore(i),value:a,transaction:e})}}),Mt(e,o,n)}},512321:(e,t,o)=>{o.d(t,{F:()=>u,X:()=>s});o(898992),o(354520),o(581454);var n=o(296540),r=()=>o(847249),i=()=>o(401497),l=()=>o(761408),a=()=>o(234359);const s=120,c={title:[s,600],text:[100,300],number:[100,150],select:[100,150],multi_select:[100,200],date:[100,150],person:[100,150],file:[100,150],checkbox:[40,100],phone_number:[100,150],formula:[100,150],relation:[100,150],rollup:[100,150],created_time:[100,150],created_by:[100,150],last_edited_time:[100,150],last_edited_by:[100,150],last_visited_time:[100,150],button:[100,150],status:[100,150],auto_increment_id:[100,150],location:[100,150],verification:[100,150],geo_point:[100,150]};function u(e,t,o,u){const[d,p]=c[u],{collectionContextStore:y}=(0,n.useContext)(a().L8),{isBeforeTitle:m,propertyIndex:f,titleIndex:S,visibleProperties:h}=(0,r().K8)((()=>{var e,n;if(!t)return{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]};const r=((null===(n=((null==y||null===(e=y.collectionViewStore())||void 0===e?void 0:e.getFormat())??{}).list_properties)||void 0===n?void 0:n.filter((e=>e.visible)))??[]).map((e=>(0,l().L)({collectionStore:t,collectionContextStore:y,property:e.property})));if(void 0===r)return{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]};const i=r.findIndex((e=>"title"===e)),a=r.findIndex((e=>e===o));return-1===i||-1===a?{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]}:{isBeforeTitle:a<i,propertyIndex:a,titleIndex:i,visibleProperties:r}}),[y,t,o]),[x,b]=(0,n.useState)(null);return(0,n.useEffect)((()=>{if(!e||!("current"in e)||!e.current)return;const t=e.current,o=new ResizeObserver((e=>{var t;const o=null===(t=e[0])||void 0===t?void 0:t.contentRect.width;o&&b(o)}));return o.observe(t),()=>{o.disconnect()}}),[e]),(0,i().IS)((()=>{if(void 0===o||void 0===u)return{};const e={};0===f?(e.marginLeft=0,e.paddingLeft=0):f===h.length-1&&(e.marginRight=0,e.paddingRight=0);const t=Math.floor(100/h.length),n=S;return f!==S&&m&&n>0?e.maxWidth=`calc((100% - ${s}px) / ${n})`:(null!==x&&x>=d&&(e.minWidth=d),e.maxWidth=`max(${p}px, ${t}%)`),"rollup"===u?{textButtonStyle:e,buttonButtonStyle:e}:{buttonStyle:e}}),[o,u,f,h.length,S,m,x,d,p])}},598598:(e,t,o)=>{o.r(t),o.d(t,{default:()=>S});var n=o(296540),r=()=>o(847249),i=()=>o(401497),l=()=>o(498474),a=()=>o(808082),s=()=>o(818256),c=()=>o(959013),u=()=>o(534177),d=()=>o(234359),p=o(474848);function y(){var e;const{property:t,propertySchema:l,store:a,collectionContextStore:s}=(0,n.useContext)(d().L8),c=null===(e=(0,o(477660).z)(l))||void 0===e?void 0:e.type,{linkHref:u,shouldShowMaliciousContentDialog:y}=(0,r().K8)((()=>{const e=t?null==a?void 0:a.getPropertyValue(t):void 0;return(0,o(310188).K)({textValue:e,type:c,store:a})}),[t,a,c]),S=(0,r().K8)((()=>{var e;return null==s||null===(e=s.collectionStore())||void 0===e?void 0:e.getSchema()}),[s]),h=(0,d().dm)(a,S,t,l),x=e=>{(e.metaKey||e.ctrlKey)&&window.open(u,"_blank")},b=(0,i().IS)((e=>({container:{width:20,height:20,borderRadius:6,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]);return!h&&u&&c?(0,p.jsx)(o(859428).A,{renderTooltip:()=>(0,p.jsx)(m,{type:c}),placement:o(962730).W.Top,render:e=>(0,p.jsx)(o(296798).A,{href:u,style:b.container,...(0,o(553965).A)(e,{onClick:x}),external:!0,preNavigationAction:e=>{y?(0,o(465741).TW)({propertyType:"url",onConfirm:()=>{e()}}):e()},children:(0,p.jsx)(f,{type:c})})}):null}function m(e){let{type:t}=e;return"phone_number"===t?(0,p.jsx)(c().sA,{id:"contactVisitButton.tooltip.phone",defaultMessage:"Call number"}):"email"===t?(0,p.jsx)(c().sA,{id:"contactVisitButton.tooltip.email",defaultMessage:"Email"}):"url"===t?(0,p.jsx)(c().sA,{id:"contactVisitButton.tooltip.url",defaultMessage:"Open link"}):void(0,u().HB)(t)}function f(e){let{type:t}=e;const o=(0,i().IS)((e=>{const t={fill:e.icon.secondary,width:16,height:16};return{icon:t,phone:{...t,width:14,height:14},arrowRotated:{...t,transform:"rotate(45deg)"}}}),[]);return"phone_number"===t?(0,s().C)(o.phone):"email"===t?(0,a().g)(o.icon):"url"===t?(0,l().q)(o.arrowRotated):void(0,u().HB)(t)}const S=n.memo(y)},634224:(e,t,o)=>{o.d(t,{Hp:()=>i,qi:()=>c,qs:()=>s,w1:()=>l});var n=()=>o(897119),r=()=>o(828180);const i={title:n().nl.Popup,text:n().nl.Popup,number:n().nl.Popup,url:n().nl.Popup,phone_number:n().nl.Popup,email:n().nl.Popup,relation:n().nl.SlideUp,rollup:n().nl.SlideUp,select:n().nl.SlideUp,multi_select:n().nl.SlideUp,status:n().nl.SlideUp,person:n().nl.SlideUp,date:n().nl.SlideUp,file:n().nl.SlideUp,formula:n().nl.SlideUp,checkbox:n().nl.SlideUp,created_by:n().nl.SlideUp,created_time:n().nl.SlideUp,last_edited_by:n().nl.SlideUp,last_edited_time:n().nl.SlideUp,last_visited_time:n().nl.SlideUp,button:n().nl.SlideUp,auto_increment_id:n().nl.Popup,location:n().nl.Popup,verification:n().nl.SlideUp,geo_point:n().nl.SlideUp},l={title:n().nl.Popup,text:n().nl.Popup,number:n().nl.Popup,url:n().nl.Popup,phone_number:n().nl.Popup,email:n().nl.Popup,relation:n().nl.BottomSheet,rollup:n().nl.SlideUp,select:n().nl.BottomSheet,multi_select:n().nl.BottomSheet,status:n().nl.BottomSheet,person:n().nl.BottomSheet,date:n().nl.BottomSheet,file:n().nl.SlideUp,formula:n().nl.SlideUp,checkbox:n().nl.SlideUp,created_by:n().nl.SlideUp,created_time:n().nl.SlideUp,last_edited_by:n().nl.SlideUp,last_edited_time:n().nl.SlideUp,last_visited_time:n().nl.SlideUp,button:n().nl.SlideUp,auto_increment_id:n().nl.Popup,location:n().nl.Popup,verification:n().nl.SlideUp,geo_point:n().nl.SlideUp},a=Object.freeze({paddingLeft:9,paddingRight:9,paddingTop:(r().tt-20)/2,paddingBottom:(r().tt-20)/2,minHeight:r().tt+1+1,display:"flex",height:"100%",flexDirection:"column",justifyContent:"space-between",flexGrow:1}),s=Object.freeze({...a,fontSize:r().Mi}),c=Object.freeze({...a,fontSize:r().KI,fontWeight:o(284371).Wy.medium})},655424:(e,t,o)=>{o.d(t,{O:()=>l,t:()=>i});var n=o(296540),r=o(474848);const i=(0,n.createContext)({blockPointers:[],collectionStore:void 0,collectionId:"",property:"",schema:{},analyticsFrom:void 0,isDisabled:!0,canConfigureCollection:!1,onChange:()=>{},onDismiss:()=>{},blockStore:void 0,blockPropertyValueOverlayStore:void 0,overlayMode:void 0,insertChar:void 0,format:o(41459).j.Table});function l(e){const{children:t,blockPointers:o,collectionStore:l,collectionId:a,property:s,schema:c,analyticsFrom:u,isDisabled:d,canConfigureCollection:p,blockStore:y,blockPropertyValueOverlayStore:m,overlayMode:f,insertChar:S,onChange:h,onDismiss:x,format:b}=e,v=(0,n.useMemo)((()=>({blockPointers:o,collectionStore:l,collectionId:a,property:s,schema:c,analyticsFrom:u,isDisabled:d,canConfigureCollection:p,blockStore:y,blockPropertyValueOverlayStore:m,overlayMode:f,insertChar:S,onChange:h,onDismiss:x,format:b})),[o,l,a,s,c,u,d,p,y,m,f,S,h,x,b]);return(0,r.jsx)(i.Provider,{value:v,children:t})}i.displayName="BlockPropertyValueOverlayContext"},705516:(e,t,o)=>{o.d(t,{i:()=>c});var n=o(296540),r=()=>o(401497),i=()=>o(421107),l=()=>o(234359),a=o(474848);const s=(0,o(959013).YK)({copy:{defaultMessage:"Copy to Clipboard",id:"database.copyButton.copyToClipboard"}}),c=n.memo((function(e){const{store:t,property:c,style:u,format:d,showShadow:p}=e,y=(0,o(484714).v3)(),m=(0,r().DP)(),f=(0,o(175116).Ks)(),{collectionSchema:S}=(0,n.useContext)(l().L8),{isEmptyStore:h,propertySchema:x,canEdit:b}=(0,n.useContext)(l().L8),v=(0,o(847249).O$)(h),g=(0,r().IS)((e=>({buttonStyle:{display:"flex",position:"relative"},iconStyle:{color:e.text.secondary,fill:e.text.secondary}})),[]),k=d===o(41459).j.Table,C=o(972435).A.formatMessage(s.copy),w=(0,n.useCallback)((()=>C),[C]),j=(0,n.useCallback)((e=>(0,a.jsx)("div",{style:{...u,...g.buttonStyle},...e,children:(0,a.jsx)(o(285790).A,{onClick:async()=>{if(!S)return;let e;k&&(e=i().A.getState(),o(4319).wr()),await o(548218).E({environment:y,theme:m,store:t,schema:S,property:c,collectionContextStore:f}),k&&e&&i().A.setState(e)},ariaLabel:C,hasBackground:!0,icon:o(925907).n,showShadow:p,iconStyle:g.iconStyle,style:{height:20,width:20}})})),[f,S,y,k,c,p,t,u,g.buttonStyle,g.iconStyle,m,C]);return void 0===x||v||y.device.isMobile&&!0===b||"checkbox"===(0,o(501053).c)(x)?null:(0,a.jsx)(o(859428).A,{renderTooltip:w,render:j})}))},712796:(e,t,o)=>{o.d(t,{BP:()=>M,Gx:()=>P,Qz:()=>B,RM:()=>R,UP:()=>_,g$:()=>j,nr:()=>g,v:()=>w,vy:()=>A,wW:()=>C,y9:()=>I,zI:()=>k});var n=o(296540),r=()=>o(484714),i=()=>o(847249),l=()=>o(401497),a=()=>o(787626),s=()=>o(604995),c=()=>o(416504),u=()=>o(559653),d=()=>o(630116),p=()=>o(821300),y=()=>o(705516),m=()=>o(234359),f=()=>o(41459),S=()=>o(828180),h=()=>o(414712),x=()=>o(859118),b=o(474848);const v=n.memo((0,n.forwardRef)((function(e,t){const{store:i,onContextMenu:a,editButtonClickProps:s,quickActionButtons:c,EmptyComponent:u,buttonStyle:d,property:p,width:y,formQuestionStore:f,userExpandable:S}=e,{baseStyles:x,propertySchema:v,propertyFormat:k}=(0,n.useContext)(m().L8),C=(0,h().DZ)(i,p,v),w=(0,r().v3)(),j=v,P=g(i,null==j?void 0:j.type,p,w.currentUser.id),I=(0,l().IS)((e=>({buttonStyle:{...x.buttonStyle,...d},buttonPressedStyle:x.buttonPressedStyle??{},buttonHoveredStyle:x.buttonHoveredStyle??{}})),[x.buttonHoveredStyle,x.buttonPressedStyle,x.buttonStyle,d]);if(!P&&void 0===u&&void 0===C)return null;let _;if(C)_=(0,b.jsx)(o(422464).e,{templateVariableType:C.templateVariable});else if(P||void 0===u){const e=(null==k?void 0:k.date_format)??(null==j?void 0:j.date_format),t=(null==k?void 0:k.time_format)??(null==j?void 0:j.time_format);_=(0,b.jsx)(o(88306).C,{children:(0,b.jsx)(o(388507).b,{dateValue:P,dateFormat:e,timeFormat:t,store:i,property:p})})}else _=(0,b.jsx)(u,{});return(0,b.jsx)(o(494585).P,{ref:t,style:I.buttonStyle,hoveredStyle:I.buttonHoveredStyle,pressedStyle:I.buttonPressedStyle,onContextMenu:a,editButtonClickProps:s,quickActionButtons:c,width:y,formQuestionStore:f,userExpandable:S,children:_})})));function g(e,t,o,n){return(0,i().K8)((()=>{switch(t){case"created_time":const t=e.getCreatedTime();return t?s().KQ(t,(0,c().P)()):void 0;case"last_edited_time":const r=e.getLastEditedTime();return r?s().KQ(r,(0,c().P)()):void 0;case"last_visited_time":if(!n)return;const i=d()._z.createChildStore(e,{table:u().F9,id:(0,u().$5)({parent_id:e.id,user_id:n}),spaceId:e.getSpaceId()}).getVisitedAt();return i?s().KQ(i,(0,c().P)()):void 0;default:const l=e.getPropertyValue(o);return(0,a().b)(l)}}),[o,e,t,n])}const k=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:a}=e,{isMobile:s}=(0,r().Y0)(),c=(0,l().IS)((()=>({buttonStyle:{padding:S().QJ[f().j.Page].text}})),[]),u=(0,n.useMemo)((()=>{if(!s)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p().k,{},"comment"),(0,b.jsx)(y().i,{store:o,property:i,format:a},"copy")]})}),[a,s,i,o]),d=E(e,t,c);return(0,b.jsx)(v,{...d,EmptyComponent:x().ao,quickActionButtons:u})})),C=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:a}=e,{isMobile:s}=(0,r().Y0)(),{shouldWrap:c}=(0,n.useContext)(m().L8),u=(0,l().IS)((()=>({buttonStyle:{padding:S().QJ[f().j.Table].text}})),[]),d=(0,n.useMemo)((()=>{if(!s)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p().k,{},"comment"),(0,b.jsx)(y().i,{store:o,property:i,format:a},"copy")]})}),[a,s,i,o]),h=E(e,t,u);return(0,b.jsx)(v,{...h,EmptyComponent:x().rW,quickActionButtons:d,userExpandable:c})})),w=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:a}=e,s=E(e,t,(0,l().IS)((()=>({buttonStyle:{padding:S().QJ[f().j.CompactPage].text}})),[])),{isMobile:c}=(0,r().Y0)(),u=(0,n.useMemo)((()=>{if(!c)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p().k,{},"comment"),(0,b.jsx)(y().i,{store:o,property:i,format:a},"copy")]})}),[a,c,i,o]);return(0,b.jsx)(v,{...s,EmptyComponent:x().ao,quickActionButtons:u})})),j=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=E(e,t,(0,o(512321).F)(t,e.collectionStore,e.property,"date"));return(0,b.jsx)(v,{...r,EmptyComponent:n?x().Jb:void 0})})),P=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=E(e,t,(0,l().IS)((()=>({buttonStyle:{padding:S().QJ[f().j.Board].text}})),[]));return(0,b.jsx)(v,{...n,EmptyComponent:o?x().Jb:void 0})})),I=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,b.jsx)(v,{...o})})),_=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=E(e,t);return(0,b.jsx)(v,{...n,EmptyComponent:o?x().Jb:void 0})})),A=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,b.jsx)(v,{...o})})),B=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,b.jsx)(v,{...o})})),R=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,b.jsx)(v,{...o})})),M=(0,n.forwardRef)((function(e,t){const o=E(e,t);return(0,b.jsx)(v,{...o,EmptyComponent:x().Fe})}));function E(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,h().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}},736433:(e,t,o)=>{o.d(t,{X:()=>i});var n=o(296540),r=o(474848);const i=n.memo((function(e){const{linkValue:t,style:i,store:l,shouldDisableLinks:a,shouldLockImageAspectRatio:s}=e,c=l.pointer,{url:u,name:d}=t,{baseStyles:p}=(0,n.useContext)(o(234359).L8),y=(0,o(484714).v3)(),m=y.device.isRetina,f=(0,n.useRef)(null),S="small"===((null==p?void 0:p.sizing)??"default")?20:24,h=(0,o(401497).IS)((e=>({fileTextStyle:{display:"inline-block",height:S,lineHeight:`${S}px`,borderRadius:4,background:e.legacyDefaultSelectColor,fontSize:(0,o(115512).ny)(y,"UISmall"),padding:"0px 6px",maxWidth:120,minWidth:40,...a?{}:{cursor:"zoom-in"},...o(284371).RC,...i},fileImageStyle:{maxHeight:S,borderRadius:4,...a?{}:{cursor:"zoom-in"},...s?{maxHeight:S,minHeight:S,maxWidth:S,minWidth:S,objectFit:"cover"}:{},...i}})),[a,y,S,s,i]),x=(0,n.useCallback)(((e,t)=>{if(!t)return null;const n=a?void 0:(0,o(512397).T)({imageRef:f,url:u,blockStore:l,environment:y});return(0,r.jsx)("img",{ref:f,src:t,style:h.fileImageStyle,onClick:n},u)}),[a,y,l,h.fileImageStyle,u]);if((0,o(304740).rS)({url:u}))return(0,r.jsx)(o(360083).A,{url:u,isAuthenticated:!0,permissionRecord:c,width:m?2*S:S,render:x},u);return(0,r.jsx)("span",{style:h.fileTextStyle,onClick:a?void 0:e=>{e.stopPropagation(),o(235116).OG(y,{url:u,type:"file",from:"view_original",downloadName:d,permissionRecord:c})},children:(0,r.jsx)(o(265665).j,{children:d})},u)}))},761529:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(285790),r=()=>o(859428),i=o(474848);function l(e){const{href:t,icon:o,iconStyle:l,tooltip:a,externalLink:s,onClick:c,showShadow:u,style:d}=e;return(0,i.jsx)(r().A,{renderTooltip:()=>a,render:e=>(0,i.jsx)(n().A,{ariaLabel:a,icon:o,iconStyle:l,href:t,onClick:c,hasBackground:!0,showShadow:u,external:s,...e,style:d})})}},768407:(e,t,o)=>{o.d(t,{LE:()=>c,lj:()=>u});o(898992),o(354520);var n=o(296540),r=()=>o(847249),i=()=>o(401497),l=()=>o(919709),a=()=>o(458366),s=o(474848);const c=n.memo((function(e){const{textValue:t,type:c,useShortenedUrl:d,disableLinkify:p,withComma:y,store:m,property:f}=e,S=(0,r().K8)((()=>{if(m)return(0,o(299545).O3)(m,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===f))}),[m,f]),h=(0,o(358167).v)({blockId:null==m?void 0:m.id,propertyId:f}),x=S&&(null==S?void 0:S.length)>0||h,b=(0,i().IS)((e=>({linkBoxStyle:{pointerEvents:"all",display:"inline",background:void 0,...(0,a().w_)(e),...x&&(0,o(191772).sQ)(e)},hoveredLinkBoxStyle:{background:void 0,...(0,a().w_)(e)},pressedLinkBoxStyle:{background:void 0,...(0,a().w_)(e)}})),[x]),{collectionContextStore:v}=(0,n.useContext)(o(234359).L8),g=(0,r().K8)((()=>null==v?void 0:v.searchQueryStore.state),[null==v?void 0:v.searchQueryStore]),k=(0,r().K8)((()=>{if(!g||!t)return!1;const e=(0,l().k4p)(t);return null==e?void 0:e.toLowerCase().includes(g.toLowerCase())}),[g,t]),{linkHref:C,shouldShowMaliciousContentDialog:w}=(0,r().K8)((()=>(0,o(310188).K)({textValue:t||(f?null==m?void 0:m.getPropertyValue(f):void 0),type:c,store:m})),[f,m,t,c]);let j;return j=t&&"url"===c&&(d||k)?(0,s.jsx)(u,{textValue:t,searchQuery:g}):(0,l().k4p)(t),!C||p?(0,s.jsx)(s.Fragment,{children:j}):(0,s.jsxs)(o(296798).A,{href:C,onClick:e=>{(e.metaKey||e.ctrlKey)&&window.open(C,"_blank")},style:b.linkBoxStyle,hoveredStyle:b.hoveredLinkBoxStyle,pressedStyle:b.pressedLinkBoxStyle,external:!0,discussionStore:null==S?void 0:S[0],preNavigationAction:e=>{w?(0,o(465741).TW)({propertyType:"url",onConfirm:()=>{e()}}):e()},children:[j,y?", ":null]})}));function u(e){let{textValue:t,searchQuery:o}=e;const n=(0,i().IS)((e=>({restOfUrl:{color:e.text.tertiary}})),[]),{domain:r,restOfUrl:c}=(0,a().Kc)(t);if(!r)return(0,s.jsx)(s.Fragment,{children:(0,l().k4p)(t)});const u=function(e,t,o){if(!t)return;let n=t,r=!1;if(t&&o){const i=null==t?void 0:t.toLowerCase().indexOf(o.toLowerCase()),l=`${e}${t}`.toLowerCase().indexOf(o.toLowerCase());if(i>=0){let e="";i>0&&(e=`${t.slice(0,1)}`),i>1&&(e+="…");let l="";i+o.length<t.length&&(l="…"),n=`${e}${t.slice(i,i+o.length)}${l}`,r=!0}else if(l>=0&&l+o.length>e.length){const i=l+o.length-e.length;n=t.slice(0,i),i<t.length&&(n+="…"),r=!0}}!r&&t&&t.length>12&&(n=`${t.slice(0,4)}…${t.slice(-6)}`);return n}(r,c,o);return(0,s.jsxs)(s.Fragment,{children:[r,u?(0,s.jsx)("span",{style:n.restOfUrl,children:u}):null]})}},787648:(e,t,o)=>{o.d(t,{AK:()=>h,Bb:()=>y,DE:()=>a,O2:()=>m,P0:()=>s,Un:()=>c,VM:()=>f,WS:()=>p,Y0:()=>d,dZ:()=>S,w4:()=>u,wE:()=>l});var n=o(296540),r=()=>o(454155),i=o(474848);const l=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().jd,{...e,ref:t})})),a=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().I8,{...e,ref:t})})),s=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().S1,{...e,ref:t})})),c=(0,n.forwardRef)((function(e,t){const n=(0,o(512321).F)(t,e.collectionStore,e.property,"multi_select"),l={...e,styles:n};return(0,i.jsx)(r().h3,{...l,ref:t})})),u=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().Dl,{...e,ref:t})})),d=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().V6,{...e,ref:t})})),p=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().rw,{...e,ref:t})})),y=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().ej,{...e,ref:t})})),m=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().xV,{...e,ref:t})})),f=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r().ER,{...e,ref:t})})),S=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(r()._Z,{...e,ref:t})})),h=(0,n.forwardRef)((function(e,t){return(0,i.jsx)(o(465274).z,{...e,ref:t})}))},818844:(e,t,o)=>{o.d(t,{A:()=>c});var n=o(296540),r=()=>o(959013),i=()=>o(972435),l=o(474848);const a=(0,r().YK)({openAsPageTitle:{defaultMessage:"Open",id:"database.navigateButton.openAsPageTitle"},openPageSidePeekAriaLabel:{defaultMessage:"Open in side peek",id:"database.relationMenuRow.button.openPageSidePeek.ariaLabel"},openPageCenterPeekAriaLabel:{defaultMessage:"Open in center peek",id:"database.relationMenuRow.button.openPageCenterPeek.ariaLabel"},openPageFullPageAriaLabel:{defaultMessage:"Open as page",id:"database.relationMenuRow.button.openPageFullPage.ariaLabel"}});function s(e){const{hideLabel:t,style:n,peekMode:s,onOpenPageButtonClick:c}=e;let u,d,p;return"side_peek"===s?(u=a.openPageSidePeekAriaLabel,d=o(177256).A,p=(0,l.jsx)(r().sA,{id:"database.relationMenuRow.tooltip.openPageSidePeek.message",defaultMessage:"Open in side peek"})):"center_peek"===s?(u=a.openPageCenterPeekAriaLabel,d=o(415566).q,p=(0,l.jsx)(r().sA,{id:"database.relationMenuRow.tooltip.openPageCenterPeek.message",defaultMessage:"Open in center peek"})):"full_page"===s?(u=a.openPageFullPageAriaLabel,d=o(882262).m,p=(0,l.jsx)(r().sA,{id:"database.relationMenuRow.tooltip.openPage.message",defaultMessage:"Open as page"})):(0,o(534177).HB)(s),(0,l.jsx)(o(525174).d,{caption:t?void 0:i().A.formatMessage(a.openAsPageTitle),ariaLabel:i().A.formatMessage(u),onClick:c,style:{width:60,...n},icon:d,tooltipMessage:p})}const c=n.memo(s)},821300:(e,t,o)=>{o.d(t,{k:()=>S});o(898992),o(354520),o(908872);var n=o(296540),r=()=>o(484714),i=()=>o(847249),l=()=>o(965998),a=()=>o(959013),s=()=>o(534177),c=()=>o(112873),u=()=>o(116008),d=()=>o(285790),p=()=>o(234359),y=()=>o(41459),m=o(474848);const f=(0,a().YK)({comment_on_property:{defaultMessage:"Comment",id:"database.CommentButton.commentOnPropertyValue"},open_discussion:{defaultMessage:"Open discussion",id:"database.CommentButton.openDiscussion"}}),S=n.memo((function(e){const{style:t,showShadow:S}=e,h=(0,a().tz)(),x=(0,r().v3)(),{isMobile:b}=(0,r().Y0)(),{isEmptyStore:v,propertySchema:g,format:k,collectionContextStore:C,property:w,store:j,disabled:P}=(0,n.useContext)(p().L8),I=(0,i().O$)(v),_=(0,i().K8)((()=>null==C?void 0:C.collectionStore()),[C]),A=(0,p().O2)({store:j,collectionStore:_,property:w,disabled:P,format:k,propertySchema:g,collectionContextStore:C,writeStateType:"comment"}),B=(0,i().K8)((()=>o(372154).A.state.open),[]),R=(0,i().K8)((()=>{if(!w||!j)return 0;return(0,o(299545).O3)(j,{recursivelyLoadAllDiscussions:!1,includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===w&&(0,o(682146).q7)(e,h,j,w))).reduce(((e,t)=>{const o=t.getModel();return o?{comments:e.comments+(o.getComments()||[]).length}:e}),{comments:0}).comments}),[h,w,j]),M=R>99?"99+":`${R}`,E=(0,i().K8)((()=>{var e;return(0,s().O9)(j)&&u().A.state.open&&u().A.isPropertyComment()&&(null===(e=u().A.state)||void 0===e?void 0:e.blockId)===j.id&&u().A.getPropertyId()===w}),[w,j]),T=(0,i().K8)((()=>{if(!_)return!1;const e=k===y().j.CompactPage,t=_.canEditCollection();return!e||!t}),[_,k]),L=(0,n.useMemo)((()=>!(R<=0)&&function(e){switch(e){case y().j.Table:case y().j.Board:case y().j.Calendar:case y().j.ListView:case y().j.GalleryView:case y().j.Timeline:case y().j.Mini:case y().j.FormEditor:case y().j.FormViewer:return!1;case y().j.PropertyModule:case y().j.Page:case y().j.CompactPage:case y().j.Relation:case y().j.RelationSection:return!0;default:(0,s().HB)(e)}}(k)),[R,k]),V=(0,n.useMemo)((()=>R>0?h.formatMessage(f.open_discussion):h.formatMessage(f.comment_on_property)),[h,R]),F=(0,n.useCallback)((async()=>{w&&j&&(B?c().xl():j.isNavigableAncestorNonCommentableState()||(R>0?await c().B4({environment:x,blockStore:j,shouldFocusDiscussion:!0,analyticsFrom:"db_quick_action",recursivelyLoadAllDiscussions:!1,property_id:w,openFullPropertyDiscussionOnly:!0,intl:h}):E?o(555776).A.setActiveWithSource("popover_comments"):await(0,o(730307).l)({environment:x,blockStore:j,rect:o(57618).A.getRect(j,w),property_id:w})))}),[w,j,B,R,x,h,E]),O=(0,o(401497).IS)((e=>({icon:{color:e.text.secondary,fill:e.text.secondary},caption:{color:e.text.secondary},button:{...t,position:"relative",display:"flex"},iconButton:{height:20}})),[t]),H=(0,n.useCallback)((e=>(0,m.jsxs)("div",{...e,style:O.button,children:[R>0?(0,m.jsx)(d().A,{ariaLabel:V,hasBackground:!0,icon:l().M,caption:(0,m.jsx)("span",{children:M}),showShadow:S,iconStyle:O.icon,captionStyle:O.caption,style:O.iconButton,onClick:F},`icon-btn-${R}`):(0,m.jsx)(d().A,{ariaLabel:V,hasBackground:!0,icon:l().M,showShadow:S,iconStyle:O.icon,style:O.iconButton,onClick:F},`icon-btn-${R}`),E&&(0,m.jsx)(o(359848).h,{onlyShowDraftDot:!0,customTop:2,customLeft:15})]})),[M,E,R,F,S,O.button,O.caption,O.icon,O.iconButton,V]),W=(0,n.useCallback)((()=>V),[V]);return!g||I||!T||L||b||!A||(0,o(970013).F_)(g.type)?null:(0,m.jsx)(o(859428).A,{renderTooltip:W,render:H})}))},828180:(e,t,o)=>{o.d(t,{$g:()=>c,Bu:()=>k,CL:()=>g,Cn:()=>I,Ih:()=>x,KI:()=>l,MI:()=>f,Mi:()=>a,Nh:()=>C,O0:()=>b,QJ:()=>P,Um:()=>j,Yu:()=>y,aL:()=>d,at:()=>m,eW:()=>v,gJ:()=>s,hR:()=>u,kx:()=>h,rO:()=>S,tt:()=>w,wd:()=>p});var n=()=>o(784892),r=()=>o(165162),i=()=>o(41459);const l="28px",a="14px",s="12px",c=1.5,u=1.25,d=35,p=21,y=18,m=34,f=30,S=28,h=30,x=32,b=24,v=24,g=24,k=30,C=6,w=(0,r().Sx)({gateName:"db_ux_chrome"})?36:32,j=(0,r().Sx)({gateName:"db_ux_chrome"})?44:36,P={[i().j.Table]:{default:`calc((${w}px - 20px) / 2) 8px`,text:`calc((${w}px - 21px) / 2) 8px`,token:`calc((${w}px - 25.5px) / 2) 8px`,checkbox:`calc((${w}px - 16px) / 2) 8px`,button:`calc((${w}px - 24px) / 2) 8px`},[i().j.Page]:{default:"7px 6px",text:"6px",checkbox:"9px 6px",button:"5px 6px"},[i().j.CompactPage]:{default:"5px 6px",text:"4px 6px",token:"5px 6px",checkbox:"7px 6px",button:"3px 6px"},[i().j.Board]:{default:"5px",text:"5px",checkbox:"5px",button:"4px"}},I=(i().j.Table,{[n().NY.ExtremeSmall]:void 0,[n().NY.ExtraSmall]:void 0,[n().NY.Small]:{columnGap:6,rowGap:4},[n().NY.CompactEssential]:{columnGap:4,rowGap:6},[n().NY.Medium]:{columnGap:8,rowGap:6},[n().NY.Large]:{columnGap:10,rowGap:10},[n().NY.Inline]:{columnGap:6,rowGap:4}})},859118:(e,t,o)=>{o.d(t,{Fe:()=>S,Jb:()=>f,ao:()=>y,rW:()=>m});var n=o(296540),r=()=>o(847249),i=()=>o(401497),l=()=>o(455348),a=()=>o(743176),s=()=>o(959013),c=()=>o(234359),u=()=>o(88306),d=o(474848);const p="20px";function y(){return(0,d.jsx)(u().C,{fontColor:"light",style:{lineHeight:p},isEmpty:!0,children:(0,d.jsx)(s().sA,{defaultMessage:"Empty",id:"database.pageProperty.emptyTitle"})})}function m(){return null}function f(){const e=(0,i().DP)(),{store:t,property:o,collectionContextStore:p}=(0,n.useContext)(c().L8),y=(0,r().K8)((()=>{const e=null==p?void 0:p.normalizedSchemaStore.state,n=null==t?void 0:t.getAssociatedCollectionStore();if(!e||!n||!o)return;return e["collectionTypedView"===p.contextType?l().u9.derivePropertyUri(o,n.getPropertyMapping())??o:o]}),[p,o,t]),m=(0,i().IS)((()=>({textContainer:{display:"inline-flex",alignItems:"center"},propertyIcon:{marginRight:6}})),[]);return y?(0,d.jsxs)(u().C,{fontColor:"light",style:m.textContainer,children:[(0,d.jsx)(a().zB,{type:y.type,icon:y.icon,size:14,theme:e,style:m.propertyIcon}),(0,d.jsx)(s().sA,{defaultMessage:"Add {propertyName}",id:"database.boardProperty.fillProperty",values:{propertyName:y.name}})]}):null}function S(){const e=(0,i().DP)(),{propertySchema:t,baseStyles:o,collectionContextStore:l}=(0,n.useContext)(c().L8),s=(0,r().K8)((()=>{var e;return"hide"===(null==l||null===(e=l.collectionStore())||void 0===e||null===(e=e.getLayoutStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[l]),u=(0,i().IS)((e=>({container:{...null==o?void 0:o.textStyle,display:"inline-flex",alignItems:"center",overflow:"hidden",color:e.text.tertiary},text:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},icon:{marginRight:4}})),[o]);return t?(0,d.jsxs)("div",{style:u.container,children:[!s&&(0,d.jsx)(a().zB,{type:t.type,icon:t.icon,size:14,theme:e,style:u.icon}),(0,d.jsx)("div",{style:u.text,children:t.name})]}):null}},886578:(e,t,o)=>{o.d(t,{O:()=>s});o(898992),o(430670);var n=()=>o(869190),r=()=>o(416504),i=()=>o(450648),l=()=>o(534177),a=()=>o(972435);function s(e,t,o){if(void 0===e)return[];switch(e.type){case"text":const c=(0,i().r4)({textValue:e.value,getRecordModel:t,userTimeZone:o,intl:a().A.getIntl(),deterministic:!0});return 0===c.length?[]:[{id:c,type:"text",value:e.value}];case"block":return[{id:e.value.id,type:"relation",value:e.value}];case"date":return[{id:(0,n().ZF)({allowRelativeDates:!1,value:e.value,userTimeZone:(0,r().P)(),intl:a().A.getIntl()}),type:"date",value:e.value}];case"checkbox":return[{id:e.value,type:"checkbox",value:e.value}];case"number":return[{id:e.value,type:"number",value:e.value}];case"person":return[{id:e.value.id,type:"person",value:e.value}];case"array":return e.values.flatMap((e=>s(e,t,o)));case"undefined":case"function":return[];default:(0,l().HB)(e)}}},932210:(e,t,o)=>{o.d(t,{g:()=>m});var n=o(296540),r=()=>o(484714),i=()=>o(847249),l=()=>o(401497),a=()=>o(965998),s=()=>o(112873),c=()=>o(299545),u=()=>o(372154),d=()=>o(493823),p=o(474848);const y=14;function m(e){let{store:t,iconStyle:o,size:m,buttonStyle:f}=e;const S=(0,r().v3)(),h=(0,n.useRef)(null),x=(0,i().K8)((()=>c().oC(t,{recursivelyLoadAllDiscussions:!1})),[t]),{menuOpen:b,menuStoreId:v}=(0,i().K8)((()=>{const e=u().A.state.open;return{menuOpen:e,menuStoreId:e?u().A.state.blockStore.id:void 0}}),[]),g=(0,n.useCallback)((()=>{var e;b&&v===t.id?s().xl():(s().xl(),s().B4({environment:S,blockStore:t,shouldFocusDiscussion:!0,analyticsFrom:"db_page_comments",rect:null===(e=h.current)||void 0===e?void 0:e.getBoundingClientRect(),recursivelyLoadAllDiscussions:!1}))}),[b,v,S,t]),k=(0,l().IS)((e=>({iconStyle:{fill:e.mediumIconColor}})),[]);return 0===x?null:(0,p.jsx)(d().p,{"aria-label":"Open comments",ref:h,size:"sm",style:f,onClick:g,children:(0,p.jsxs)("div",{style:o,children:[(0,a().M)({width:m??y,height:m??y,marginRight:3,fill:k.iconStyle.fill}),x]})})}},942504:(e,t,o)=>{o.d(t,{GL:()=>T,Or:()=>R,Ye:()=>E,yZ:()=>M});o(898992),o(354520);var n=o(296540),r=()=>o(847249),i=()=>o(401497),l=()=>o(563015),a=()=>o(750559),s=()=>o(72135),c=()=>o(191772),u=()=>o(959013),d=()=>o(534177),p=()=>o(284371),y=()=>o(299545),m=()=>o(358167),f=()=>o(962730),S=()=>o(859428),h=()=>o(234359),x=()=>o(425497),b=()=>o(355594),v=()=>o(768407),g=()=>o(388507),k=()=>o(736433),C=()=>o(40106),w=()=>o(495930),j=()=>o(370618),P=()=>o(997415),I=()=>o(88306),_=()=>o(178788),A=()=>o(167677),B=o(474848);const R={id:"empty",type:"empty",value:[["Empty"]]};function M(e){const{token:t,targetPropertySchema:o,blockStore:n,checkboxPropertyLabel:r,withComma:c,numberRightAlign:y,disableLinks:m,shouldTruncate:h}=e,x=(0,i().DP)(),I=(0,u().tz)(),{type:A,value:R}=t;switch(A){case"url":case"email":case"phone_number":return(0,B.jsx)(v().LE,{textValue:R,type:A,useShortenedUrl:!1,withComma:c,disableLinkify:m});case"checkbox":return(0,B.jsx)(b().o,{checked:R,propertyLabel:r,disabled:!0,withComma:c});case"number":return(0,B.jsx)(w().E,{numberValue:R,numberFormatOverride:o&&"number_format"in o?null==o?void 0:o.number_format:s().C4,numberPrecisionOverride:o&&"number_precision"in o?null==o?void 0:o.number_precision:void 0,withComma:c,isRightAligned:y});case"date":return(0,B.jsx)(g().b,{dateValue:R,dateFormat:o&&"date_format"in o?o.date_format:void 0,timeFormat:o&&"time_format"in o?o.time_format:void 0,withComma:c});case"file":return(0,B.jsx)(k().X,{linkValue:R,store:n,shouldDisableLinks:m});case"person":return(0,B.jsx)(j().A,{actorPointer:R,shouldShrink:h,withComma:c});case"relation":return(0,B.jsx)(C().a,{recordPointer:R,parentStore:n,linkify:m?"never":"always",withComma:c,noWrap:h,style:{...h&&{maxWidth:"100%",...p().RC}}});case"select":return(0,B.jsx)(P().X,{type:t.groupColor?"status":"select",value:R,groupColor:t.groupColor,color:t.color,shouldShrink:h});case"text":return(0,B.jsx)(_().A,{textValue:R,parentStore:n,withComma:c,linkifyUrls:!m,disableCommentHighlight:!0,shouldTruncate:h});case"error":return(0,B.jsx)(S().A,{render:e=>(0,B.jsxs)("div",{style:{display:"inline-flex",cursor:"help",color:x.text.redPrimary,alignItems:"center",gap:3},...e,children:[(0,a().f)({width:16,height:16,color:x.icon.uiRedPrimary}),(0,B.jsx)(u().sA,{id:"propertyValueToken.error",defaultMessage:"Error"})]}),renderTooltip:()=>(0,B.jsx)(u().sA,{...(0,l().yI)(I,R)}),placement:f().W.Top,alignment:f().C.Center});case"empty":return(0,B.jsx)(S().A,{render:e=>(0,B.jsx)("div",{style:{opacity:.8,cursor:"help"},...e,children:(0,B.jsx)(_().A,{textValue:R,parentStore:n,withComma:c,linkifyUrls:!0})}),renderTooltip:()=>(0,B.jsx)(u().sA,{id:"propertyValueToken.emptyValueTooltip",defaultMessage:"Empty values aren't displayed but affect formula calculations."}),placement:f().W.Top,alignment:f().C.Center});default:return(0,d().HB)(A)}}function E(e){let{children:t,propertyType:o,rootPropertySchema:l,numberRightAlign:a,store:s,property_id:u}=e;const{shouldWrap:d}=(0,n.useContext)(h().L8),p="number"===o&&a,f=(0,m().v)({blockId:null==s?void 0:s.id,propertyId:u}),S=(0,r().K8)((()=>{if(s)return(0,y().O3)(s,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===u))}),[s,u]),x=(0,i().IS)((e=>({commentHighlightWrapperStyle:(null==S?void 0:S.length)||f?{...(0,c().sQ)(e),paddingTop:8,height:"fit-content",paddingLeft:5,display:"inline-flex"}:{}})),[f,null==S?void 0:S.length]);return T(o,l)?(0,B.jsx)(I().C,{style:{...x.commentHighlightWrapperStyle,...d&&{display:"flex",flexWrap:"wrap"}},isRightAligned:p,children:t}):(0,B.jsx)(A().h,{isRightAligned:p,style:x.commentHighlightWrapperStyle,children:t})}function T(e,t){var o,n;return void 0!==e&&"title"!==e&&(!!(0,x().YX)(e)&&("number"!==e||"bar"!==(null==t||null===(o=t.show_as)||void 0===o?void 0:o.type)&&"ring"!==(null==t||null===(n=t.show_as)||void 0===n?void 0:n.type)))}},997415:(e,t,o)=>{o.d(t,{X:()=>l});var n=o(296540),r=()=>o(401497),i=o(474848);const l=n.memo((function(e){const{value:t,description:l,color:a,shouldShrink:s,type:c,style:u,shouldShowTooltip:d}=e,p="status"===c?e.groupColor??"default":void 0,y=(0,r().DP)(),{baseStyles:m}=(0,n.useContext)(o(234359).L8),f=(0,o(425497).Ug)(null==m?void 0:m.tokenFormat),S=(0,r().IS)((()=>({token:{margin:0,...o(284371).RC,...u}})),[u]);if(!t)return null;const{textColor:h,backgroundColor:x}=(0,o(100622).LD)(y,a??p);let b;return"status"===c&&(b=a||(p||"gray")),(0,i.jsx)(o(881690).A,{format:f,value:(0,i.jsx)(o(288722).A,{children:t}),description:l,color:h,backgroundColor:x,showRemoveButton:!1,shouldShrink:s,isRound:"status"===c,isSingle:!1,showColoredDot:b,showTooltip:d?"always":"never",tooltipPlacement:o(962730).W.Top,style:S.token,tooltipClassName:o(38337).Efz})}))}}]);