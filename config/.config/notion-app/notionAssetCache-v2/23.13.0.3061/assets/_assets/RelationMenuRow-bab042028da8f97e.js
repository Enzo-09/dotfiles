"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[18766],{197534:(e,t,o)=>{o.d(t,{Q:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("settingsMembersFilled",{viewBox:"0 0 20 13",svg:(0,n.jsx)("path",{d:"M13.582 6.00293C15.0723 6.00293 16.3369 4.67676 16.3369 2.96094C16.3369 1.28613 15.0654 0.0078125 13.582 0.0078125C12.0986 0.0078125 10.8203 1.30664 10.8271 2.97461C10.8271 4.67676 12.0918 6.00293 13.582 6.00293ZM5.67969 6.16016C6.97852 6.16016 8.0791 4.99805 8.0791 3.50781C8.0791 2.04492 6.97168 0.9375 5.67969 0.9375C4.3877 0.9375 3.27344 2.06543 3.28027 3.52148C3.28027 4.99805 4.38086 6.16016 5.67969 6.16016ZM1.91309 12.3604H7.0332C6.30859 11.3145 7.1084 9.25 8.64648 8.04688C7.89453 7.55469 6.91016 7.19922 5.67969 7.19922C2.62402 7.19922 0.648438 9.44824 0.648438 11.3076C0.648438 11.9775 0.990234 12.3604 1.91309 12.3604ZM9.31641 12.3604H17.8408C18.9619 12.3604 19.3516 12.0186 19.3516 11.3965C19.3516 9.63281 17.123 7.21289 13.5752 7.21289C10.0342 7.21289 7.80566 9.63281 7.80566 11.3965C7.80566 12.0186 8.19531 12.3604 9.31641 12.3604Z"})})},413267:(e,t,o)=>{o.d(t,{b:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("thinCheck",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},525174:(e,t,o)=>{o.d(t,{RelationMenuRow:()=>$,d:()=>ie});o(898992),o(354520),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(790748),a=()=>o(847249),l=()=>o(401497),s=()=>o(584262),d=()=>o(66689),c=()=>o(784892),u=()=>o(168687),p=()=>o(212050),g=()=>o(887146),S=()=>o(689094),y=()=>o(197534),f=()=>o(413267),b=()=>o(959013),h=()=>o(496603),k=()=>o(534177),m=()=>o(284371),x=()=>o(727395),w=()=>o(281948),M=()=>o(458366),C=()=>o(544073),v=()=>o(728611),B=()=>o(753199),R=()=>o(972435),I=()=>o(592678),T=()=>o(685889),P=()=>o(571468),j=()=>o(806401),A=()=>o(163194),L=()=>o(205682),E=()=>o(712505),O=()=>o(29247),W=()=>o(818844),V=()=>o(41459),H=()=>o(828180),N=()=>o(704152),D=()=>o(57232),U=()=>o(59364),K=()=>o(285790),_=()=>o(678553),F=()=>o(958378),Y=()=>o(859428),z=()=>o(566081),G=o(474848);const Z=(0,b().YK)({dragRowHandleAriaLabel:{defaultMessage:"Drag to move a related page",id:"database.relationMenuRow.dragRowHandle.ariaLabel"},floatingInsertButtonAriaLabel:{defaultMessage:"Create a new related page",id:"database.relationMenuRow.floatingInsertButton.ariaLabel"},defaultIsSelectedPrimaryButtonAriaLabel:{defaultMessage:"Unlink page",id:"database.relationMenuRow.button.primary.default.isSelected.ariaLabel"},defaultIsNotSelectedPrimaryButtonAriaLabel:{defaultMessage:"Link page",id:"database.relationMenuRow.button.primary.default.isNotSelected.ariaLabel"},sprintIsSelectedPrimaryButtonAriaLabel:{defaultMessage:"Remove this sprint",id:"database.relationMenuRow.button.primary.sprint.isSelected.ariaLabel"},sprintIsNotSelectedPrimaryButtonAriaLabel:{defaultMessage:"Add this sprint",id:"database.relationMenuRow.button.primary.sprint.isNotSelected.ariaLabel"},defaultIsSelectedSecondaryButtonAriaLabel:{defaultMessage:"Insert new page",id:"database.relationMenuRow.button.secondary.default.isSelected.ariaLabel"},defaultIsNotSelectedSecondaryButtonAriaLabel:{defaultMessage:"Link another page",id:"database.relationMenuRow.button.secondary.default.isNotSelected.ariaLabel"},sprintIsSelectedSecondaryButtonAriaLabel:{defaultMessage:"Insert new page",id:"database.relationMenuRow.button.secondary.sprint.isSelected.ariaLabel"},sprintIsNotSelectedSecondaryButtonAriaLabel:{defaultMessage:"Move to a different sprint",id:"database.relationMenuRow.button.secondary.sprint.isNotSelected.ariaLabel"}}),Q=48;function $(e){const{collectionStore:t,collectionId:o,schema:l,propertySchema:c,targetCollectionStore:u,relatedPageStore:p,isSelected:g,disabled:S,locked:y,canDrag:f,pageStore:b,property:h,propertyLimit:k,limitReached:m,rowType:M,onActionButtonClick:B,onSecondaryButtonClick:R,onOpenPageButtonClick:I,onMouseEnter:T,onMouseLeave:O,blockPropertyValueOverlayStore:W,onInsertInline:V,onTitleEsc:H,index:N,focused:D,disableClickToNavigateToPage:U}=e,[K,_]=n.useState(!1),F=(0,i().v3)(),Y=(0,i().Y0)(),z=n.useRef(null),Z=n.useRef(null);(0,r().b)(A().A,(()=>({relatedPageStoreId:p.id,rowType:M,property:h,relationTokenBlockStoreRef:z,getNode:()=>Z.current})),[p,M,h]);const Q=(0,a().K8)((()=>{if(E().default.state.open)return E().default.state.mode;const e=null==W?void 0:W.state;if(null==e||!e.isOpen||null==e||!e.collectionContextStore)return E().default.state.mode;const t=e.collectionContextStore,o=null==t?void 0:t.collectionViewStore(),n=null==o?void 0:o.getType();return o&&n?o.getFormat().collection_peek_mode??C().C9[n]:E().default.state.mode}),[W]),$=(0,a().K8)((()=>u.getDatabaseType()),[u]),te=(0,j().D)(c);if((0,P().W)(p))return null;if(Y.isPhone&&"popup"===M)return te?(0,G.jsx)(ae,{...e}):(0,G.jsx)(le,{...e});if(te){const e=(0,G.jsx)(J,{canDrag:f,rowType:M,focused:D,disabled:S,locked:y,relatedPageStore:p,pageStore:b,onInsertInline:V,index:N,blockPropertyValueOverlayStore:W,collectionStore:t,targetCollectionStore:u,property:h,relationTokenBlockStoreRef:z});return(0,G.jsx)(ne,{innerRelationMenuRow:e,handleButtonClick:e=>function(e,t,o,n){o||n||t(e)}(e,B,S,g),canDrag:f,rowType:M,focused:D,disabled:S,limitReached:m,propertyLimit:k,hasMouseEntered:K,sectionOnClick:e=>ge(e,F,o,u,g,p,B,S,Q),outerRef:Z,onSecondaryButtonClick:R,onMouseEnter:T,onMouseLeave:O})}if($===d().av){const e=(0,G.jsx)(X,{canDrag:f,rowType:M,focused:D,disabled:S,locked:y,isSelected:g,onSecondaryButtonClick:R,onOpenPageButtonClick:I,onActionButtonClick:B,propertyLimit:k,relatedPageStore:p,pageStore:b,onInsertInline:V,index:N,blockPropertyValueOverlayStore:W,collectionStore:t,targetCollectionStore:u,property:h,relationTokenBlockStoreRef:z,outerRef:Z,peekMode:Q});return(0,G.jsx)(ne,{innerRelationMenuRow:e,handleButtonClick:e=>function(e,t,o,n){o||n||t(e)}(e,B,S,g),canDrag:f,rowType:M,focused:D,disabled:S,limitReached:m,propertyLimit:k,hasMouseEntered:K,sectionOnClick:e=>ge(e,F,o,u,g,p,B,S,Q),outerRef:Z,onSecondaryButtonClick:R,onMouseEnter:T,onMouseLeave:O})}{const e=(0,G.jsx)(q,{canDrag:f,rowType:M,focused:D,disabled:S,locked:y,propertyLimit:k,limitReached:m,isSelected:g,onSecondaryButtonClick:R,onOpenPageButtonClick:I,onActionButtonClick:B,relatedPageStore:p,pageStore:b,onInsertInline:V,onTitleEsc:H,index:N,blockPropertyValueOverlayStore:W,collectionStore:t,schema:l,targetCollectionStore:u,property:h,relationTokenBlockStoreRef:z,outerRef:Z,peekMode:Q}),n=(0,G.jsx)(ne,{innerRelationMenuRow:e,handleButtonClick:e=>function(e,t,o,n,i,r,a,l,d,c,u,p){if(a||d){if(p)return;const r=v().Vr(e),a=o===n.id?E().default.state.resultsStore:void 0,d=o===n.id?E().default.state.collectionContextStore:void 0,g=E().default.isSidePeekOpen();if(w().VU({environment:t,store:i,peekMode:c,openInNew:r,resultsStore:a,collectionContextStore:d,pageVisitSource:s().y8.PeekOpen}),(0,x()._)(t,{from:"inline"===l||"section"===l?"property_value":"configure_relation_modal",meta_click:Boolean(r)}),"popup"===l&&!g){(u??L().A).setState({isOpen:!1})}}else r(e)}(e,F,o,u,p,B,S,M,g,Q,W,U),canDrag:f,rowType:M,focused:D,disabled:S,limitReached:m,propertyLimit:k,hasMouseEntered:K,sectionOnClick:e=>ge(e,F,o,u,g,p,B,S,Q),outerRef:Z,onMouseEnter:T,onMouseLeave:O});return(0,G.jsx)(ee,{rowContainer:n,disabled:S,locked:y,canDrag:f,rowType:M,targetCollectionStore:u,propertyLimit:k,hasMouseEntered:K,outerRef:Z,handleMouseEnter:()=>_(!0),handleMouseLeave:()=>_(!1),onInsertInline:V})}}function q(e){const{canDrag:t,rowType:o,focused:n,disabled:r,locked:s,propertyLimit:d,limitReached:c,isSelected:p,onSecondaryButtonClick:g,onOpenPageButtonClick:y,onActionButtonClick:f,relatedPageStore:k,pageStore:m,onInsertInline:x,onTitleEsc:w,index:C,blockPropertyValueOverlayStore:v,collectionStore:B,targetCollectionStore:I,schema:P,property:j,relationTokenBlockStoreRef:A,outerRef:L,peekMode:E}=e,O=(0,i().Y0)(),W=(0,l().IS)((e=>({dragHandle:{marginLeft:2,height:20}})),[]),V=(0,a().K8)((()=>"section"===o&&!r&&k.canEdit()&&!O.isMobile),[o,r,k,O.isMobile]),H=O.isPhone?(0,G.jsx)(oe,{relatedPageStore:k,rowType:o,pageStore:m,canEditTitle:V,shouldShowOverflow:!1,noUnderline:!1,relationTokenBlockStoreRef:A,onInsertInline:x,onTitleEsc:w,index:C}):(0,G.jsx)(te,{collectionStore:B,property:j,relatedPageStore:k,targetCollectionStore:I,blockPropertyValueOverlayStore:v,rowType:o,pageStore:m,index:C,onInsertInline:x,onTitleEsc:w,canEditTitle:V,shouldShowOverflow:!1,noUnderline:!1,disabled:r,relationTokenBlockStoreRef:A}),N=(0,a().K8)((()=>T().s2(P,j)),[P,j]),U=(0,a().K8)((()=>{const e=null==v?void 0:v.state;if(e&&e.isOpen)return e.format}),[v]),K=function(e){const{device:t,rowType:o,focused:n,disabled:i,locked:r,propertyLimit:a,limitReached:l,onSecondaryButtonClick:s,onOpenPageButtonClick:d,onActionButtonClick:c,isSelected:p,isGithubRelationProperty:g,peekMode:y,onClick:f,format:k}=e,m=!t.isMobile&&n&&!i&&"section"===o&&!h().b0(d),x=(t.isMobile||n)&&!r&&!i&&!l&&(void 0===a||a>1),w=!t.isMobile&&!r&&n&&!i&&"inline"===o&&!h().b0(s),C=x?function(e){const{isSelected:t,isGithubRelationProperty:o,onActionButtonClick:n,format:i}=e,r=t?Z.defaultIsSelectedPrimaryButtonAriaLabel:Z.defaultIsNotSelectedPrimaryButtonAriaLabel;let a;const l=t?u().t:S().W;a=i&&(0,M().NN)(i)?void 0:t?o?(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.removePR.message",defaultMessage:"Unlink PR"}):(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.removePage.message",defaultMessage:"Unlink page"}):o?(0,G.jsx)(b().sA,{defaultMessage:"Link PR",id:"database.relationMenuRow.tooltip.addPR.message"}):(0,G.jsx)(b().sA,{defaultMessage:"Link page",id:"database.relationMenuRow.tooltip.addPage.message"});return(0,G.jsx)(ie,{ariaLabel:R().A.formatMessage(r),onClick:n,style:{borderRadius:3},icon:l,tooltipMessage:a})}({isSelected:p,isGithubRelationProperty:g,onActionButtonClick:c,format:k}):void 0,v=w?function(e){const{rowType:t,isSelected:o,isGithubRelationProperty:n,onClick:i}=e;let r;r="section"===t&&o?n?(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPRInline.message",defaultMessage:"Insert new PR"}):(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPageInline.message",defaultMessage:"Insert new page"}):n?(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPR.message",defaultMessage:"Link another PR"}):(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPage.message",defaultMessage:"Link another page"});const a="section"===t&&o?Z.defaultIsSelectedSecondaryButtonAriaLabel:Z.defaultIsNotSelectedSecondaryButtonAriaLabel;return(0,G.jsx)(ie,{ariaLabel:R().A.formatMessage(a),onClick:i,style:{borderRadius:0},icon:S().W,tooltipMessage:r})}({rowType:o,isSelected:p,isGithubRelationProperty:g,onClick:f}):void 0,B=m&&void 0!==d?(0,G.jsx)(pe,{peekMode:y,showPrimaryButton:void 0!==C,showSecondaryButton:void 0!==v,onOpenPageButtonClick:d}):void 0;return(0,G.jsx)(ue,{primaryButton:C,secondaryButton:v,openPageButton:B})}({device:O,rowType:o,focused:n,disabled:r,locked:s,propertyLimit:d,limitReached:c,isSelected:p,onSecondaryButtonClick:g,onOpenPageButtonClick:y,onActionButtonClick:f,isGithubRelationProperty:N,peekMode:E,onClick:()=>null==g?void 0:g(L.current),format:U});return(0,G.jsxs)(G.Fragment,{children:[t&&"popup"===o&&(0,G.jsx)(D().A,{iconSize:12,style:W.dragHandle}),H,K]})}function J(e){const{canDrag:t,rowType:o,disabled:n,relatedPageStore:r,pageStore:s,onInsertInline:d,onTitleEsc:c,index:u,blockPropertyValueOverlayStore:p,collectionStore:g,targetCollectionStore:S,property:f,relationTokenBlockStoreRef:b}=e,h=(0,i().Y0)(),k=(0,l().IS)((e=>({dragHandle:{marginLeft:2,height:20},iconWrapper:{display:"flex",alignItems:"center",marginLeft:"auto",height:24,padding:0,paddingRight:4},membersIcon:{width:16,height:16,fill:e.mediumIconColor,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]),m=(0,a().K8)((()=>"section"===o&&!n&&r.canEdit()&&!h.isMobile),[o,n,r,h.isMobile]),x=(0,G.jsxs)(G.Fragment,{children:[t&&"popup"===o&&(0,G.jsx)(D().A,{iconSize:12,style:k.dragHandle}),(0,G.jsx)(oe,{relatedPageStore:r,rowType:o,pageStore:s,canEditTitle:m,shouldShowOverflow:!0,noUnderline:!0,relationTokenBlockStoreRef:b,onInsertInline:d,onTitleEsc:c,index:u})]}),w=(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(te,{collectionStore:g,property:f,relatedPageStore:r,targetCollectionStore:S,blockPropertyValueOverlayStore:p,rowType:o,pageStore:s,index:u,onInsertInline:d,onTitleEsc:c,canEditTitle:m,shouldShowOverflow:!0,noUnderline:!0,disabled:n,relationTokenBlockStoreRef:b}),(0,G.jsx)("div",{style:k.iconWrapper,children:(0,y().Q)(k.membersIcon)})]}),M=(0,G.jsxs)(G.Fragment,{children:[t&&(0,G.jsx)(D().A,{iconSize:12,style:k.dragHandle}),w]}),C="popup"===o?M:w;return h.isPhone?x:C}function X(e){const{canDrag:t,rowType:o,focused:n,disabled:r,locked:s,isSelected:d,onSecondaryButtonClick:c,onOpenPageButtonClick:p,onActionButtonClick:g,propertyLimit:y,relatedPageStore:k,pageStore:m,onInsertInline:x,onTitleEsc:w,index:M,blockPropertyValueOverlayStore:C,collectionStore:v,targetCollectionStore:B,property:I,relationTokenBlockStoreRef:T,outerRef:P,peekMode:j}=e,A=(0,i().Y0)(),L=(0,l().IS)((e=>({dragHandle:{marginLeft:2,height:20},iconWrapper:{display:"flex",marginLeft:"auto",alignItems:"center",justifyContent:"center",padding:0,height:24},icon:{width:16,height:16,fill:e.regularIconColor,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]),E=(0,a().K8)((()=>"section"===o&&!r&&k.canEdit()&&!A.isMobile),[o,r,k,A.isMobile]),O=function(e){const{device:t,rowType:o,focused:n,disabled:i,locked:r,onSecondaryButtonClick:a,onOpenPageButtonClick:l,onActionButtonClick:s,isSelected:d,propertyLimit:c,peekMode:p,onClick:g}=e,y=!t.isMobile&&n&&!i&&("section"===o||"inline"===o)&&!h().b0(l),f=(t.isMobile||n)&&!r&&!i,k="section"!==o?(t.isMobile||n)&&!r&&!i&&1!==c&&"popup"===o&&d:f,m=!t.isMobile&&!r&&n&&!i&&!y&&"section"!==o&&!h().b0(a),x=k?function(e){const{isSelected:t,onActionButtonClick:o}=e,n=t?Z.sprintIsSelectedPrimaryButtonAriaLabel:Z.sprintIsNotSelectedPrimaryButtonAriaLabel,i=t?(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.removePage.messageSprints",defaultMessage:"Remove this sprint"}):(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.addPage.messageSprints",defaultMessage:"Add this sprint"});return(0,G.jsx)(ie,{ariaLabel:R().A.formatMessage(n),onClick:o,style:{borderRadius:3},icon:t?u().t:S().W,tooltipMessage:i})}({isSelected:d,onActionButtonClick:s}):void 0,w=m?function(e){const{rowType:t,isSelected:o,onClick:n}=e,i="section"===t&&o?Z.sprintIsSelectedSecondaryButtonAriaLabel:Z.sprintIsNotSelectedSecondaryButtonAriaLabel,r="section"===t&&o?(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPageInline.message",defaultMessage:"Insert new page"}):(0,G.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPage.messageSprints",defaultMessage:"Move to a different sprint"});return(0,G.jsx)(ie,{ariaLabel:R().A.formatMessage(i),onClick:n,style:{borderRadius:0},icon:S().W,tooltipMessage:r})}({rowType:o,isSelected:d,onClick:g}):void 0,M=y&&void 0!==l?(0,G.jsx)(pe,{peekMode:p,showPrimaryButton:void 0!==x,showSecondaryButton:void 0!==w,onOpenPageButtonClick:l}):void 0;return(0,G.jsx)(ue,{primaryButton:x,secondaryButton:w,openPageButton:M})}({device:A,rowType:o,focused:n,disabled:r,locked:s,isSelected:d,onSecondaryButtonClick:c,onOpenPageButtonClick:p,onActionButtonClick:g,propertyLimit:y,peekMode:j,onClick:()=>null==c?void 0:c(P.current)});return(0,G.jsxs)(G.Fragment,{children:[t&&"popup"===o&&(0,G.jsx)(D().A,{iconSize:12,style:L.dragHandle}),A.isPhone?(0,G.jsx)(oe,{relatedPageStore:k,rowType:o,pageStore:m,canEditTitle:E,shouldShowOverflow:!0,noUnderline:!0,relationTokenBlockStoreRef:T,onInsertInline:x,onTitleEsc:w,index:M}):(0,G.jsx)(te,{collectionStore:v,property:I,relatedPageStore:k,targetCollectionStore:B,blockPropertyValueOverlayStore:C,rowType:o,pageStore:m,index:M,onInsertInline:x,onTitleEsc:w,canEditTitle:E,shouldShowOverflow:!0,noUnderline:!0,disabled:r,relationTokenBlockStoreRef:T}),d&&"popup"===o&&(0,G.jsx)("div",{style:L.iconWrapper,children:(0,f().b)(L.icon)}),O]})}function ee(e){const{rowContainer:t,disabled:o,locked:n,canDrag:r,rowType:s,targetCollectionStore:d,propertyLimit:c,hasMouseEntered:u,outerRef:p,handleMouseEnter:g,handleMouseLeave:y,onInsertInline:f}=e,h=(0,i().Y0)(),k=(0,l().IS)((e=>({menuItem:{display:"flex",alignItems:"center",width:`calc(100% + ${Q}px)`,paddingLeft:Q,position:"relative",left:-Q},tooltip:{color:e.text.contrastSecondary},icon:{width:16,height:16,fill:e.lightIconColor},iconHover:{borderRadius:4},iconButton:{marginLeft:r?-44:-22,position:"absolute",marginRight:4}})),[r]),m=(0,a().K8)((()=>d.canEdit()),[d]),x=!n&&!o&&"section"===s&&!h.isMobile&&!(1===c)&&m;return(0,G.jsxs)("div",{style:k.menuItem,onMouseEnter:g,onMouseLeave:y,ref:p,children:[u&&x&&(0,G.jsx)(Y().A,{renderTooltip:()=>(0,G.jsx)(b().sA,{defaultMessage:"Click <medium>to insert a page below</medium>",id:"database.relationMenuRow.tooltip.floatingAddPageButton.message",values:{medium:e=>(0,G.jsx)("span",{style:k.tooltip,children:e})}}),render:e=>(0,G.jsx)(K().A,{hasBackground:!1,ariaLabel:R().A.formatMessage(Z.floatingInsertButtonAriaLabel),icon:S().W,iconStyle:k.icon,onClick:f,hoveredStyle:k.iconHover,style:k.iconButton,...e})}),t]})}function te(e){const{relatedPageStore:t,targetCollectionStore:o,blockPropertyValueOverlayStore:r,rowType:s,pageStore:d,index:c,onInsertInline:u,onTitleEsc:p,canEditTitle:g,shouldShowOverflow:S,noUnderline:y,collectionStore:f,property:b,disabled:k,relationTokenBlockStoreRef:x}=e,w=(0,i().Y0)(),M=(0,a().K8)((()=>t.isReady()&&!t.canRead()),[t]),C=(0,a().K8)((()=>{const e=o.getSchema();return e?!f||M?[{property:"title",visible:!0}]:T().B7({collectionStore:f,property:b}).filter((t=>t.visible&&("title"===t.property||e[t.property]))):[]}),[o,f,M,b]),v=(0,a().K8)((()=>"section"!==s||(k||!t.canEdit()||w.isMobile)),[s,k,t,w.isMobile]),B=(0,l().IS)((e=>({wrapper:{display:"flex",marginRight:8,maxHeight:22,alignItems:"center",...m().RC}})),[]);if(h().Im(C))return null;const R=C.map((e=>"title"===e.property?(0,G.jsx)(n.Fragment,{children:(0,G.jsx)(oe,{relatedPageStore:t,rowType:s,pageStore:d,canEditTitle:g,shouldShowOverflow:S,noUnderline:y,relationTokenBlockStoreRef:x,onInsertInline:u,onTitleEsc:p,index:c})},"title"):(0,G.jsx)(O().m,{store:t,property:e.property,disabled:v,locked:!1,format:"section"===s?V().j.RelationSection:V().j.Relation,tableWrap:!1,blockPropertyValueOverlayStore:r??L().A,collectionStore:o},e.property)));return(0,G.jsx)("div",{style:B.wrapper,children:R})}function oe(e){const{relatedPageStore:t,rowType:o,pageStore:n,canEditTitle:r,shouldShowOverflow:a,noUnderline:s,relationTokenBlockStoreRef:d,onInsertInline:u,onTitleEsc:p,index:g}=e,S=(0,i().Y0)(),y=(0,l().IS)((e=>({wrapper:{display:"flex",alignItems:"center",flex:"0 1 auto",minHeight:0,...!a&&{minWidth:40},paddingLeft:"section"===o?4:6},relationToken:{display:"flex",alignItems:"center",margin:0,whiteSpace:"nowrap",marginRight:"section"===o?0:S.isTablet?8:0,minWidth:0},title:{...m().RC,maxWidth:"100%"}})),[o,a,S.isTablet]);return(0,G.jsx)("div",{style:y.wrapper,children:(0,G.jsx)(z().A,{ref:d,format:c().NY.Inline,blockId:t.id,isSingle:!0,parentStore:n,noUnderline:s,style:y.relationToken,titleStyle:y.title,clickTitleBehavior:r?"edit":void 0,onTitleEnter:u,onTitleEsc:p,index:g},t.id)})}function ne(e){const{innerRelationMenuRow:t,handleButtonClick:o,canDrag:n,rowType:r,focused:a,disabled:s,limitReached:d,propertyLimit:c,hasMouseEntered:u,sectionOnClick:p,outerRef:S,onSecondaryButtonClick:y,onMouseEnter:f,onMouseLeave:h}=e,k=(0,i().v3)(),m=(0,l().IS)((e=>({container:{display:"flex",alignItems:"center",width:"100%"},tooltip:{color:e.text.contrastSecondary},icon:{width:14,height:14,fill:e.lightIconColor},iconHover:{borderRadius:4},iconButton:{cursor:"grab",width:U().Z+4,marginLeft:-(U().Z+4),height:24,borderRadius:4},row:se(r,e,a,d,c)})),[r,a,d,c]);return(0,G.jsxs)("div",{style:m.container,ref:S,children:["section"===r&&u&&n&&(0,G.jsx)(Y().A,{renderTooltip:()=>(0,G.jsx)(b().sA,{defaultMessage:"Drag <medium>to move</medium>",id:"database.relationMenuRow..dragPrompt.text",values:{medium:e=>(0,G.jsx)("span",{style:m.tooltip,children:e})}}),render:e=>(0,G.jsx)(K().A,{hasBackground:!1,ariaLabel:R().A.formatMessage(Z.dragRowHandleAriaLabel),icon:g().i,iconStyle:m.icon,hoveredStyle:m.iconHover,style:m.iconButton,...e})}),"section"===r?(0,G.jsx)("div",{style:m.row,onContextMenu:e=>de(e,k),onMouseEnter:f,onMouseLeave:h,onClick:p,role:"button","aria-label":"Editable title","aria-disabled":s,tabIndex:s?-1:0,children:t}):(0,G.jsx)(Y().A,{disableTooltip:!(d&&c&&c>1),renderTooltip:()=>(0,G.jsx)(b().sA,{defaultMessage:"To select more, remove selection above",id:"database.relationMenuRow.limitReached"}),render:e=>(0,G.jsx)("div",{style:m.row,onContextMenu:e=>de(e,k),onMouseEnter:f,onMouseLeave:h,role:"button",tabIndex:s?-1:0,"aria-disabled":s,onClick:e=>{(0,B().SQ)({event:e,context:B().y$.EditorClick,callback:()=>{(0,I().Vt)(e)||(y?y(S.current):o(e))}})},...e,children:t})})]})}function ie(e){const{caption:t,onClick:o,style:n,icon:i,tooltipMessage:r,ariaLabel:a}=e;return(0,G.jsx)(Y().A,{renderTooltip:()=>r,disableTooltip:(0,k().uy)(r),render:e=>(0,G.jsx)(K().A,{hasBackground:!1,ariaLabel:a,icon:i,onClick:o,caption:t,hoveredStyle:{borderRadius:4},style:{height:20,width:20,flex:"0 0 auto",...n},...e})})}function re(e){let{onActionButtonClick:t}=e;return(0,G.jsx)(N().A,{mobileFeedback:!0,onClick:t,style:{padding:12,marginRight:-12},children:(0,p().u)({width:20,height:20})})}function ae(e){const{rowType:t,relatedPageStore:o,pageStore:i,onInsertInline:r,onTitleEsc:a,index:s,disabled:d,isSelected:c,...u}=e,p=n.useRef(null),g=(0,l().IS)((e=>({container:{display:"flex",alignItems:"center"},iconWrapper:{display:"flex",alignItems:"center",marginLeft:"auto",height:24,padding:0},titleWrapper:{flex:1,overflow:"hidden",paddingRight:16},membersIcon:{width:16,height:16,fill:e.mediumIconColor,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]),S=!d&&c,f=!d&&!c;return(0,G.jsx)(_().Ay,{...u,title:(0,G.jsxs)("div",{style:g.container,children:[(0,G.jsx)("div",{style:g.titleWrapper,children:(0,G.jsx)(oe,{relatedPageStore:o,rowType:t,pageStore:i,canEditTitle:!1,shouldShowOverflow:!0,noUnderline:!0,relationTokenBlockStoreRef:p,onInsertInline:r,onTitleEsc:a,index:s})}),S&&(0,G.jsx)(re,{onActionButtonClick:t=>{e.onActionButtonClick(t),t.stopPropagation()}}),f&&(0,G.jsx)("div",{style:g.iconWrapper,children:(0,y().Q)(g.membersIcon)})]})})}function le(e){const t=!e.disabled&&e.isSelected;return(0,G.jsx)(F().A,{...e,store:e.relatedPageStore,hidePath:!0,right:t?(0,G.jsx)(re,{onActionButtonClick:e.onActionButtonClick}):void 0})}function se(e,t,o,n,i){const r=n&&i&&i>1;return{...m().RC,display:"flex",alignItems:"center",position:"relative",borderRadius:4,width:"100%",height:T().d0,paddingTop:2,paddingRight:4,paddingBottom:2,paddingLeft:"popup"!==e?2:0,fontSize:H().Mi,margin:"popup"===e?"0px 4px":0,cursor:r?"default":"pointer",background:o&&!r?t.buttonHoveredBackground:void 0,userSelect:"none",opacity:r?.4:1}}function de(e,t){const{device:o}=t;o.isAndroid&&o.isPhone&&e.preventDefault()}const ce={position:"absolute",top:4,display:"inline-flex",flexShrink:0,borderRadius:4,overflow:"hidden",padding:2,gap:1};function ue(e){const{primaryButton:t,secondaryButton:o,openPageButton:n}=e,i=(0,l().IS)((e=>({relationButtonWrapperStyle:{right:6,background:e.popoverBackground,boxShadow:e.shadowSM,...ce}})),[]);return(0,G.jsxs)(G.Fragment,{children:[(t||o)&&(0,G.jsxs)("div",{style:i.relationButtonWrapperStyle,children:[t,o]}),n]})}function pe(e){const t=(0,l().IS)((t=>({relationButtonWrapperStyle:{position:"absolute",right:e.showPrimaryButton||e.showSecondaryButton?36:6,background:t.popoverBackground,boxShadow:t.shadowSM,...ce}})),[e.showPrimaryButton,e.showSecondaryButton]);return(0,G.jsx)("div",{style:t.relationButtonWrapperStyle,children:(0,G.jsx)(W().A,{...e})})}function ge(e,t,o,n,i,r,a,l,d){(0,B().SQ)({event:e,context:B().y$.EditorClick,callback:()=>{if(!(0,I().Vt)(e))if(i||l){if(!r.canRead())return;const i=v().Vr(e),a=o===n.id?E().default.state.resultsStore:void 0,l=o===n.id?E().default.state.collectionContextStore:void 0;w().VU({environment:t,store:r,peekMode:d,openInNew:i,resultsStore:a,collectionContextStore:l,pageVisitSource:s().y8.PeekOpen}),(0,x()._)(t,{from:"relation_section",meta_click:Boolean(i)})}else a(e)}})}}}]);