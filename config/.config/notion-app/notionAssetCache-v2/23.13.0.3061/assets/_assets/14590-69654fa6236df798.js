"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[14590],{66323:(e,t,i)=>{i.d(t,{b:()=>l,h:()=>d});var n=()=>i(713998),o=()=>i(798880),r=()=>i(931075),a=()=>i(319975),s=()=>i(751156);function l(e){const{environment:t,blockStore:i,verificationValue:l}=e,d=i.getPropertyStore(r()._e.Verification),c=(0,n().j2)(l),u=i.getPropertyStore(r()._e.Owner),p=t.currentUser.id,v=p?{table:o().oo,id:p}:void 0;s().createAndCommit({userAction:"PageAddVerificationButton.verifyPage",environment:t,canUndo:!0,perform:e=>{a().R9({environment:t,store:d,value:c,transaction:e}),v&&s().applyOperation({transaction:e,store:u,operation:{path:u.path,pointer:u.pointer,command:"addPersonAfter",args:{pointer:v}}})}})}function d(e){const{environment:t,blockStore:i,verificationValue:o}=e,l=i.getPropertyStore(r()._e.Verification),d=(0,n().j2)(o);s().createAndCommit({userAction:"PageVerificationBadge.updatePageVerification",environment:t,canUndo:!0,perform:e=>{a().R9({environment:t,store:l,value:d,transaction:e})}})}},122894:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(959013).YK)({expirationProperty:{defaultMessage:"Expiration",id:"verificationHelpers.menuTitle.Expiration"},noExpiration:{defaultMessage:"None",id:"verificationHelpers.noExpiration"},verifierProperty:{defaultMessage:"Owner",id:"verificationHelpers.menuTitle.Owner"},noOwners:{defaultMessage:"No owners",id:"verificationHelpers.noOwners.placeholder"},removeVerificationProperty:{defaultMessage:"Remove verification",id:"verificationHelpers.removeVerification"},nonOwnerCannotRemoveVerification:{defaultMessage:"Only owners can remove verification",id:"verificationHelpers.nonOwnerCannotRemoveVerification"},nonOwnersCannotEditVerification:{defaultMessage:"Only owners can edit verification",id:"verificationHelpers.nonOwnersCannotEditVerification"},ownersAttribution:{defaultMessage:"{numOtherActors, plural, =0 {{actorName}} one {{actorName} and {numOtherActors} other} other {{actorName} and {numOtherActors} others}}",id:"verificationHelpers.displayPageOwners"},verificationMenuTitle:{defaultMessage:"Configure Verification",id:"verificationHelpers.verificationMenu.menuTitle.configureVerification"},addVerificationMenuTitle:{defaultMessage:"Verification Status",id:"verificationHelpers.verificationMenu.menuTitle.addVerification"}})},170356:(e,t,i)=>{i.d(t,{NS:()=>u,Pq:()=>f,Z3:()=>c,sw:()=>p});i(296540);var n=()=>i(484714),o=()=>i(297872),r=()=>i(928600),a=()=>i(678553),s=()=>i(480095),l=()=>i(722872),d=i(474848);const c=8,u=8,p=32,v={height:p+c-2,paddingTop:c-2};function f(e){let{title:t,helpButton:i,onCancel:a,desktopMinWidth:c,desktopMaxWidth:u,desktopWidth:p,children:v}=e;const{device:f}=(0,n().v3)();return(0,d.jsx)(o().A,{capture:!0,allowEsc:!0,allowUndo:!0,render:e=>{let n;return n=f.isMobile?{menuType:l().gu.Modal,title:t,right:(0,d.jsx)(s().DoneMenuText,{}),onClickRight:a,...e}:{menuType:l().gu.Popup,...c&&{minWidth:c},...u&&{maxWidth:u},...p&&{width:p},...e},(0,d.jsx)(r().A,{...n,header:t&&(0,d.jsx)(g,{title:t,helpButton:i}),children:v})}})}function g(e){let{title:t,helpButton:i}=e;return(0,n().v3)().device.isMobile?null:(0,d.jsx)(a().Ay,{style:v,title:t,right:i})}},274652:(e,t,i)=>{i.d(t,{A:()=>r});var n=i(296540),o=i(474848);const r=n.forwardRef((function(e,t){const n=(0,i(401497).IS)((t=>({base:{color:e.isBlue?i(100622).Ay.blue:t.text.secondary},buttonMenuItem:{...e.style,...e.disabled?{cursor:"not-allowed"}:{}}})),[e.disabled,e.isBlue,e.style]),{color:r}=n.base;return(0,o.jsx)(i(760217).A,{ref:t,...e,title:(0,o.jsx)("div",{style:{color:r,fill:r},children:e.title}),icon:(0,o.jsx)(i(8980).I,{icon:i(617668).plusIcon,style:{fill:r}}),style:n.buttonMenuItem})}))},379421:(e,t,i)=>{i.d(t,{C:()=>z});var n=i(296540),o=()=>i(484714),r=()=>i(847249),a=()=>i(931075),s=()=>i(959013),l=()=>i(534177),d=()=>i(908671),c=()=>i(66323),u=()=>i(51493),p=(i(898992),i(737550),()=>i(401497)),v=()=>i(764880),f=()=>i(906380),g=()=>i(797561),m=()=>i(42583),y=()=>i(599813),h=()=>i(53528),x=()=>i(284371),b=()=>i(722872),M=()=>i(470928),w=()=>i(962730),S=()=>i(760217),T=()=>i(928600),V=()=>i(939740),A=()=>i(480095),C=()=>i(8980),j=()=>i(89924),k=()=>i(859428),P=()=>i(125565),I=()=>i(8802),R=()=>i(122894),B=i(474848);function O(e){const{onClose:t,blockStore:i,setVerificationMenuDisplay:n}=e,a=(0,o().v3)(),l=(0,s().tz)(),d=a.device.isMobile,O=(0,r().K8)((()=>(0,M().i1)(i)),[i]),U="verified"===O.type,D="verified"===O.type||"expired"===O.type,E=(0,r().K8)((()=>{const{verificationOwners:e}=(0,M().h4)({blockStore:i}),t=e.length;if(t<=0)return l.formatMessage(R().n.noOwners);const n=e[0],o=(0,v().xC)({pointer:n,getRecordModel:i.getRecordModel}),r=null==o?void 0:o.asActor,a=null==r?void 0:r.getDisplayName(l);if(!a)return l.formatMessage(R().n.noOwners);const s=t-1;return l.formatMessage(R().n.ownersAttribution,{actorName:a,numOtherActors:s})}),[i,l]),H=(0,r().K8)((()=>i.canEdit()),[i]),_=(0,r().K8)((()=>{const{verificationOwners:e}=(0,M().h4)({blockStore:i}),t=a.currentUser.id;return e.some((e=>e.id===t))}),[i,a.currentUser]),W=(0,p().IS)((e=>({disabledButton:{opacity:.7},redStyling:{color:e.text.uiRedPrimary},buttonRightContainer:{display:"flex",alignItems:"center",maxWidth:150,gap:2,color:e.icon.secondary},buttonRightText:{color:e.icon.secondary,fontSize:d?x().J.UIRegular.mobile:x().J.UISmall.desktop},footer:{color:e.text.secondary,fontSize:x().J.UISmall.desktop,borderTop:d?`1px solid ${e.regularDividerColor}`:void 0}})),[d]),z="none"!==O.type&&(0,B.jsx)("div",{style:W.footer,children:(0,B.jsx)(I().d,{lastVerifiedDate:U&&O.isIndefinite?O.startDateTime:O.dateTimeRange.start,getRecordModel:i.getRecordModel,actorPointer:O.actorPointer})});let N;return N=d?{menuType:b().gu.Modal,title:l.formatMessage(R().n.verificationMenuTitle),right:(0,B.jsx)(A().DoneMenuText,{}),onClickRight:t,footer:z}:{menuType:b().gu.Popup,width:320,footer:z},(0,B.jsx)(T().A,{...N,children:(0,B.jsx)(V().Ay,{type:V().Oh.Vertical,initialFocus:0,sections:[{key:"Verification Configuration",render:e=>(0,B.jsx)(j().A,{...e,hideTitle:d,title:l.formatMessage(R().n.verificationMenuTitle),disableMobilePadding:!0,disableMobileBorders:!0}),items:[{key:"Expiration",render:e=>{let t=l.formatMessage(R().n.noExpiration);"verified"!==O.type||O.isIndefinite?"expired"===O.type&&(t=h().OH({dateTime:O.dateTimeRange.end,intl:l,shortenDateAndRange:!0})):t=h().OH({dateTime:O.dateTimeRange.end,intl:l,shortenDateAndRange:!0});const i=!_,n=(0,B.jsxs)("div",{style:W.buttonRightContainer,children:[(0,B.jsx)(P().A,{style:W.buttonRightText,showTooltipWhenTruncated:!0,children:t}),_&&(0,B.jsx)(C().I,{icon:f().x,size:"sm"})]});return(0,B.jsx)(k().A,{placement:w().W.Right,render:t=>(0,B.jsx)(S().A,{...e,...t,title:l.formatMessage(R().n.expirationProperty),icon:(0,B.jsx)(C().I,{icon:m().D}),right:n,disabled:i,buttonStyle:i?W.disabledButton:void 0}),renderTooltip:()=>l.formatMessage(R().n.nonOwnersCannotEditVerification),disableTooltip:!i})},action:()=>{n("expiration")}},{key:"Verifier",render:e=>(0,B.jsx)(S().A,{...e,title:l.formatMessage(R().n.verifierProperty),icon:(0,B.jsx)(C().I,{icon:g().E}),right:(0,B.jsxs)("div",{style:W.buttonRightContainer,children:[(0,B.jsx)(P().A,{style:W.buttonRightText,showTooltipWhenTruncated:!0,children:E}),(0,B.jsx)(C().I,{icon:f().x,size:"sm"})]}),disabled:!H}),action:()=>{n("owner")}},{key:"Remove",render:e=>{const t=!_||!D;return(0,B.jsx)(k().A,{placement:w().W.Right,render:i=>(0,B.jsx)(S().A,{...e,...i,title:l.formatMessage(R().n.removeVerificationProperty),icon:(0,B.jsx)(C().I,{icon:y().xMarkIcon}),style:W.redStyling,disabled:t,buttonStyle:t?W.disabledButton:void 0}),renderTooltip:()=>l.formatMessage(R().n.nonOwnerCannotRemoveVerification),disableTooltip:!t})},action:()=>{var e;e={value:void 0,metadata:{action:"remove",entrypoint:"page_menu"}},c().h({environment:a,blockStore:i,verificationValue:e.value}),(0,u().q)({environment:a,blockStore:i,update:e}),t()}}]}]})})}var U=()=>i(436572),D=()=>i(751156),E=()=>i(41459),H=()=>i(583538);function _(e){const{blockStore:t,onClose:i}=e,n=(0,o().v3)(),d=(0,s().tz)(),{verifierValue:c,isDefaultUnpersistedValue:p}=(0,r().K8)((()=>{const{verificationOwners:e,isCreatedByDefault:i}=(0,M().h4)({blockStore:t});return{verifierValue:e,isDefaultUnpersistedValue:Boolean(i)}}),[t]);return(0,B.jsx)(H().Ay,{value:c,format:E().j.Page,valueIsUnpersistedDefaultValue:p,propertySchema:{name:d.formatMessage(R().n.verifierProperty),type:"person",limit:void 0,default:"created_by"},schema:{},insertChar:void 0,disabled:!1,onChange:e=>{(e=>{const i=t.getPropertyStore(a()._e.Owner);"personPropertyMenuUpdateAddPerson"===e.type?(D().createAndCommit({userAction:"PageVerificationBadge.addVerifier",environment:n,canUndo:!0,perform:t=>{for(const n of e.newValues)D().applyOperation({transaction:t,store:i,operation:{path:i.path,pointer:i.pointer,command:"addPersonAfter",args:{pointer:n}}})}}),(0,u().y)({environment:n,blockStore:t,entrypoint:"breadcrumbs",action:"add"})):"personPropertyMenuUpdateRemovePerson"===e.type?1===c.length?U().D6({label:(0,B.jsx)(s().sA,{id:"pageVerification.removeLastVerifier.error",defaultMessage:"At least one owner is required for verification."})}):(D().createAndCommit({userAction:"PageVerificationBadge.removeVerifier",environment:n,canUndo:!0,perform:t=>{D().applyOperation({transaction:t,store:i,operation:{path:i.path,pointer:i.pointer,command:"removePerson",args:{pointer:e.removedValue}}})}}),(0,u().y)({environment:n,blockStore:t,entrypoint:"breadcrumbs",action:"remove"})):"personPropertyMenuUpdateReplacePerson"===e.type?(D().createAndCommit({userAction:"PageVerificationBadge.replaceVerifier",environment:n,canUndo:!0,perform:t=>{D().applyOperation({transaction:t,store:i,operation:{path:i.path,pointer:i.pointer,command:"addPersonAfter",args:{pointer:e.newValue}}})}}),(0,u().y)({environment:n,blockStore:t,entrypoint:"breadcrumbs",action:"replace"})):(0,l().HB)(e)})(e)},onDismiss:i,parentStore:t,isTemplatePage:!1,formQuestionStore:void 0})}var W=()=>i(206837);function z(e){const{onClose:t,blockStore:i,entrypoint:r}=e,a=(0,o().v3)(),[s,d]=(0,n.useState)("mainVerificationMenu");return"mainVerificationMenu"===s?(0,B.jsx)(O,{onClose:t,blockStore:i,setVerificationMenuDisplay:d}):"owner"===s?(0,B.jsx)(N,{blockStore:i,onClose:a.device.isMobile?()=>d("mainVerificationMenu"):t,setVerificationMenuDisplay:d}):"expiration"===s?(0,B.jsx)(K,{blockStore:i,onClose:a.device.isMobile?()=>d("mainVerificationMenu"):t,setVerificationMenuDisplay:d,entrypoint:r}):void(0,l().HB)(s)}function N(e){const{onClose:t,blockStore:i,setVerificationMenuDisplay:n}=e,r=(0,o().v3)(),a=(0,s().tz)(),l=r.device.isMobile;return(0,B.jsxs)(B.Fragment,{children:[!l&&(0,B.jsx)(W().o,{label:Q(a,"owner"),onClickBackButton:()=>n("mainVerificationMenu"),onClose:t,showBottomBorder:!0,width:350}),(0,B.jsx)(_,{blockStore:i,onClose:t})]})}function K(e){const{onClose:t,blockStore:i,setVerificationMenuDisplay:n,entrypoint:l}=e,p=(0,o().v3)(),v=(0,s().tz)(),f=p.device.isMobile,g=(0,r().K8)((()=>i.getPropertyStore(a()._e.Verification).getValue()),[i]);return(0,B.jsx)(d().y,{propertyName:"Verification Status",onChange:e=>{(e=>{c().h({environment:p,blockStore:i,verificationValue:e.value}),(0,u().q)({environment:p,blockStore:i,update:e})})(e)},verificationValue:(0,a().U1)(g),getRecordModel:i.getRecordModel,blockId:i.id,onClose:t,showTitle:f,showRemoveVerificationButton:f,showVerificationFooter:f,showCurrentStatusHeader:f,showCustomHeader:!f,customHeader:!f&&(0,B.jsx)(W().o,{label:Q(v,"expiration"),onClickBackButton:()=>n("mainVerificationMenu"),onClose:t,showBottomBorder:!0,width:320}),entrypoint:l})}function Q(e,t){return"expiration"===t?e.formatMessage(R().n.expirationProperty):"owner"===t?e.formatMessage(R().n.verifierProperty):"mainVerificationMenu"===t?null:void(0,l().HB)(t)}},381374:(e,t,i)=>{i.d(t,{p:()=>r});i(296540);var n=()=>i(959013),o=i(474848);function r(e){let{invalidInvites:t,showEmptyError:i,styles:r}=e;if(i)return(0,o.jsx)("div",{style:r,children:(0,o.jsx)(n().sA,{id:"inviteTargetsInput.invalidWarning.noEmails",defaultMessage:"Please enter an email address"})});if(0===t.length)return null;const a=t[0].value.text;return 1===t.length?(0,o.jsx)("div",{style:r,children:(0,o.jsx)(n().sA,{id:"inviteTargetsInput.invalidWarning.singleEmail",defaultMessage:"“{text}” is not a valid email",values:{text:a}})}):(0,o.jsx)("div",{style:r,children:(0,o.jsx)(n().sA,{id:"inviteTargetsInput.invalidWarning.multipleEmails",defaultMessage:"{additionalInvalid, plural, one {“{text}” and {additionalInvalid} other are not valid emails} other {“{text}” and {additionalInvalid} others are not valid emails}}",values:{text:a,additionalInvalid:t.length-1}})})}},398208:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(296540),o=i(474848);function r(e){let{onClose:t,style:n}=e;const r=(0,i(959013).tz)(),{isMobile:a}=(0,i(484714).Y0)(),s=(0,i(401497).IS)((()=>({closeButton:{borderRadius:"100%",width:a?28:22,height:a?28:22,...n},closeButtonIconStyle:a?{width:18,height:18}:{}})),[a,n]);return(0,o.jsx)(i(285790).A,{iconStyle:s.closeButtonIconStyle,style:s.closeButton,hovered:!0,icon:i(66913).V,onClick:t,ariaLabel:r.formatMessage({id:"circleCloseButton.ariaLabel",defaultMessage:"Close"})})}const a=n.memo(r)},401996:(e,t,i)=>{i.d(t,{P:()=>d,S:()=>c});i(898992),i(354520),i(581454);var n=()=>i(842599),o=()=>i(535279),r=()=>i(351360),a=()=>i(975971),s=()=>i(542056);const l=i(496603).sg((e=>{let{environment:t,flowId:n,billingData:o,origin:r}=e;i(134696).D2(t,{invite_flow_id:n,billingData:o,invite_origin:r})}),1e3);async function d(e){var t;const{environment:i,event:d,flowId:c,inviteTargetsStore:u,inviteOrigin:p,onInputChanged:v}=e;null==v||v();const f=null===(t=r().default.state.currentSpaceStore)||void 0===t?void 0:t.id,g=f?await a().A.awaitData(i,{spaceId:f}):void 0;u.setState({...u.state,tokenQuery:d.target.value}),l({environment:i,flowId:c,billingData:null==g?void 0:g.billingData,origin:p});const m=d.target.value,{extractedEmails:y,invalidParts:h,newInputValue:x}=(0,n().l2)(m),b=[...await s().Ah(i,y),...h.map((e=>({type:"invalidUser",value:{text:e}})))].filter((e=>!o().P4({inviteTargetsStore:u,target:e}))),M=[...u.state.inviteTargets,...b];u.setState({...u.state,inviteTargets:M,tokenQuery:x})}function c(e){const{targetToRemove:t,inviteTargetsStore:i}=e;if(0===i.state.inviteTargets.length)return;const n=i.state.inviteTargets.filter((e=>e!==t));0===n.length?i.setState({...i.state,inviteTargets:[]}):i.setState({...i.state,inviteTargets:n})}},535279:(e,t,i)=>{i.d(t,{P4:()=>o,U1:()=>a,lW:()=>s});i(944114),i(898992),i(354520),i(737550);var n=()=>i(842599);function o(e){const{target:t,inviteTargetsStore:i}=e;return i.state.inviteTargets.some((e=>"newUser"===t.type?e.type===t.type&&t.value.email===e.value.email:"invalidUser"===t.type?e.type===t.type&&t.value.text===e.value.text:"group"===t.type?e.type===t.type&&e.value.group_id===t.value.group_id:e.type===t.type&&e.value.id===t.value.id))}function r(e){return"invalidUser"!==e.type}function a(e){const{inviteTargetsStore:t,includeInputFieldText:i}=e,a=[...t.state.inviteTargets];if(i){const e=function(e){const t=e.state.tokenQuery.trim();if(!(0,n().DT)(t))return;const i={type:"newUser",value:{email:t},source:"email"};return o({target:i,inviteTargetsStore:e})?void 0:i}(t);e&&a.push(e)}return a.filter(r)}function s(e){const{inviteTargetsStore:t,inviteTarget:i}=e;if(o({target:i,inviteTargetsStore:t})){const e=t.state.inviteTargets.filter((e=>"group"===i.type&&"group"===e.type?i.value.group_id!==e.value.group_id:"existingUser"===i.type&&"existingUser"===e.type?i.value.id!==e.value.id:"newUser"!==i.type||"newUser"!==e.type||i.value.email!==e.value.email));return t.setState({...t.state,inviteTargets:e}),!1}return t.setState({inviteTargets:[...t.state.inviteTargets,i],tokenQuery:""}),!0}}}]);