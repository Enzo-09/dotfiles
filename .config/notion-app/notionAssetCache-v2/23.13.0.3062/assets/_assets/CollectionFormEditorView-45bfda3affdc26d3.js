"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[23133],{3197:(e,t,o)=>{o.d(t,{t:()=>s});var i=o(296540),n=()=>o(183558),l=()=>o(248064),r=()=>o(384130),a=()=>o(937199);function s(e){const{setModuleSelection:t,layoutStore:o}=(0,a().LH)(),s=(0,l().h)(),{dismissTooltip:d}=(0,r().J)();return(0,i.useCallback)((()=>{var i;"form"===(null===(i=o.getModel())||void 0===i?void 0:i.getLayoutType())&&"form_conditional_modules"!==e.area?s({layoutModule:{type:"placeholder",id:(0,n().Ay)()},position:e.afterModuleId?{type:"module_relative",area:e.area,direction:"below",relativeToModuleId:e.afterModuleId}:void 0}):(t({type:"new_module",isDragging:!1,..."views_main_tab_modules"===e.area?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:e.area}}),"page_main"===e.area&&d())}),[o,e,s,t,d])}},158359:(e,t,o)=>{o.d(t,{P:()=>n});o(296540);var i=o(474848);const n=(0,o(340498).wt)("arrowDown",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 1.57715C7.5625 1.57715 7.25488 1.88477 7.25488 2.33594V10.8262L7.30957 12.3027L5.50488 10.2861L3.95312 8.75488C3.82324 8.625 3.63184 8.53613 3.42676 8.53613C3.0166 8.53613 2.70898 8.85059 2.70898 9.26758C2.70898 9.46582 2.78418 9.64355 2.94141 9.80762L7.44629 14.3193C7.59668 14.4697 7.79492 14.5586 8 14.5586C8.20508 14.5586 8.40332 14.4697 8.55371 14.3193L13.0586 9.80762C13.2158 9.64355 13.291 9.46582 13.291 9.26758C13.291 8.85059 12.9902 8.53613 12.5801 8.53613C12.3682 8.53613 12.1836 8.625 12.0469 8.75488L10.4951 10.2861L8.69043 12.2959L8.74512 10.8262V2.33594C8.74512 1.88477 8.44434 1.57715 8 1.57715Z"})})},248064:(e,t,o)=>{o.d(t,{h:()=>s});var i=o(296540),n=()=>o(484714),l=()=>o(847249),r=()=>o(978846),a=()=>o(937199);function s(){const{layoutStore:e,currentModuleSelection:t,setModuleSelection:o,sessionId:s}=(0,a().LH)(),d=(0,n().v3)(),u=(0,l().K8)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e]),c="form"===u?"form_layout_schema":"new_module"===(null==t?void 0:t.type)?t.area:void 0;return(0,i.useCallback)((i=>{const{layoutModule:n,transaction:l}=i;if(!e.getModel()||!c||"form_conditional_modules"===c)return;let a;if("form"===u)a=i.position??{type:"area_relative",area:"form_layout_schema",location:"end_moveable"};else{if("new_module"!==(null==t?void 0:t.type))return;if("form_conditional_modules"===t.area)return;a="views_main_tab_modules"===t.area?{type:"area_relative",area:t.area,viewId:t.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:t.area,location:"end_moveable"}}(0,r().UQ)({environment:d,sessionId:s,layoutStore:e,position:a,module:n,transaction:l,isPropertyCreation:!1}),o({type:"existing_module",moduleId:n.id,isDragging:!1})}),[c,t,d,e,u,s,o])}},384130:(e,t,o)=>{o.d(t,{J:()=>u});var i=o(296540),n=()=>o(484714),l=()=>o(847249),r=()=>o(751156),a=()=>o(755199),s=()=>o(186445),d=()=>o(351360);function u(){return function(e){let{userSettingsDismissibleKey:t}=e;const o=(0,n().v3)(),u=(0,l().K8)((()=>d().default.state.currentUserSettingsStore),[]),c=(0,l().K8)((()=>{const e=null==u?void 0:u.getSettings();return!e||Boolean(e[t])}),[t,u]),m=(0,l().K8)((()=>{const e=(0,s()._m)(o),t=null==u?void 0:u.getSettings();return Boolean(e)&&Boolean(t)&&!o.device.isMobile&&!c}),[o,u,c]),S=i.useCallback((()=>{u&&!c&&m&&r().createAndCommit({environment:o,userAction:"LayoutInfoPanelButtonEducationTooltip.dismiss",canUndo:!1,perform:e=>{a().mJ({userSettingsStore:u,transaction:e,data:{[t]:Date.now()}})}})}),[o,m,t,u,c]);return{shouldShowTooltip:m,dismissTooltip:S}}({userSettingsDismissibleKey:"layout_builder_add_module_button_education_tooltip_dismissed_at"})}},402137:(e,t,o)=>{o.d(t,{w:()=>s});o(18107),o(967357),o(814603),o(147566),o(198721);const i="://",n="www.",l=/.+\..+\..+/,r=/\.{2,}/,a=/.+\..+/;function s(e){const t=e.trim();if(0===t.length)return!1;if(-1===t.indexOf(".")&&-1===t.indexOf("localhost"))return!1;if("."===t.at(t.length-1)||-1!==t.indexOf(" "))return!1;let o,s=`${-1===t.indexOf(i)?"http://":""}${t}`;try{o=new URL(s)}catch(u){const e=-1===s.indexOf(n),[t,l]=s.split(i);s=`${t}${i}${e?"www.":""}${l}`;try{o=new URL(s)}catch(u){return!1}}const d=o.hostname;return!r.test(d)&&(!(t.includes(n)&&"localhost"!==d&&!l.test(d))&&!("localhost"!==d&&!a.test(d)))}},412532:(e,t,o)=>{o.d(t,{l:()=>n});o(296540);const i={viewBox:"0 0 16 16",svg:(0,o(474848).jsx)("path",{d:"M13.165 12.75a.8.8 0 0 0 .69-1.203L8.692 2.693a.8.8 0 0 0-1.382 0l-5.165 8.854a.8.8 0 0 0 .691 1.203z"})},n=(0,o(340498).wt)("arrowCaretUpFillSmall",i)},471095:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,lockFillIcon:()=>n});o(296540);const i={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M6 5.95a4 4 0 1 1 8 0v1.433a2.426 2.426 0 0 1 2.025 2.392v5.4A2.425 2.425 0 0 1 13.6 17.6H6.4a2.425 2.425 0 0 1-2.425-2.425v-5.4c0-1.203.876-2.201 2.025-2.392zm6.75 1.4v-1.4a2.75 2.75 0 1 0-5.5 0v1.4zm-2.2 5.458a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"})},n=(0,o(340498).wt)("lockFill",i)},498474:(e,t,o)=>{o.d(t,{q:()=>n});o(296540);var i=o(474848);const n=(0,o(340498).wt)("arrowUp",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},542371:(e,t,o)=>{o.d(t,{A:()=>i});class i extends(()=>o(757695))().default{getInitialState(){}}},612900:(e,t,o)=>{o.d(t,{u:()=>l});var i=()=>o(645873);const n=new(i().O2)("PulsingWrapper",(async()=>o.e(45248).then(o.bind(o,673962)))),l=(0,i().jQ)(n,(e=>e.PulsingWrapper),{renderLoading:(e,t)=>t.children})},626466:(e,t,o)=>{o.r(t),o.d(t,{arrowChevronSingleDownFillIcon:()=>n,iconDefinition:()=>i});o(296540);const i={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M9.381 13.619a.875.875 0 0 0 1.238 0l5.4-5.4A.875.875 0 1 0 14.78 6.98L10 11.763 5.219 6.98A.875.875 0 1 0 3.98 8.22z"})},n=(0,o(340498).wt)("arrowChevronSingleDownFill",i)},731120:(e,t,o)=>{o.d(t,{A:()=>i});class i extends(()=>o(757695))().default{getInitialState(){return{isOpen:!1}}}},754199:(e,t,o)=>{function i(e){return/^(\+\d{1,2}[\s.-])?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function n(e){return/^[0-9 .()\-\+]{7,}$/.test(e)}o.d(t,{W:()=>i,e:()=>n})},766911:(e,t,o)=>{o.r(t),o.d(t,{CollectionFormEditorView:()=>q});var i=o(296540),n=()=>o(847249),l=()=>o(757695),r=()=>o(101981),a=()=>o(145214),s=()=>o(630116),d=(o(16280),o(898992),o(672577),()=>o(908006)),u=()=>o(484714),c=()=>o(118884),m=()=>o(591779),S=()=>o(206267),f=()=>o(919709),v=()=>o(686526),p=()=>o(725614),g=()=>o(175116),y=()=>o(454305),_=()=>o(753199),C=()=>o(953418),h=()=>o(47170),w=()=>o(963589),x=()=>o(640868),I=()=>o(937199),M=()=>o(761660),b=()=>o(817942),L=()=>o(731120),B=()=>o(542371),T=()=>o(104129);class k extends l().default{getInitialState(){return{openTooltip:void 0}}}class E extends l().default{getInitialState(){return{conditionalGroupCollapsedStates:{}}}}var K=()=>o(24157),j=()=>o(611371),A=()=>o(134217),D=()=>o(749240);class V extends l().default{getInitialState(){}autofocusQuestionDescription(e){let{questionId:t}=e;this.setState({questionId:t,questionInputType:"description"})}autofocusQuestionTitle(e){let{questionId:t}=e;this.setState({questionId:t,questionInputType:"title"})}clear(){this.setState(void 0)}}var Q=()=>o(348241),F=o(474848);function O(e){let{collectionContextStore:t,collectionViewStore:o,layoutStore:l,isCollectionEmpty:r}=e;const a=(0,u().v3)(),s=(0,n().uB)(void 0,B().A),d=(0,n().uB)(void 0,E),c=(0,n().uB)(void 0,k),m=(0,h().O)(),S=(0,n().O$)(D().subscriptionDataStoreInstance);return(0,i.useEffect)((()=>{S&&m&&A().V$(a,S,m)&&j().He(a)}),[a,S,m]),(0,F.jsx)(R,{collectionContextStore:t,collectionViewStore:o,layoutStore:l,layoutBuilderModuleSelectionStore:s,formConditionalGroupsStore:d,formAddConditionalLogicTooltipStore:c,isCollectionEmpty:r,children:(0,F.jsx)($,{children:(0,F.jsx)(b().Mx,{type:"form",children:(0,F.jsx)(M().J,{area:"form_layout_schema"})})})})}function R(e){let{children:t,collectionContextStore:o,collectionViewStore:r,layoutStore:a,layoutBuilderModuleSelectionStore:s,formConditionalGroupsStore:m,formAddConditionalLogicTooltipStore:_,isCollectionEmpty:h}=e;const w=(0,u().v3)(),M=(0,n().K8)((()=>o.collectionStore()),[o]),[b]=(0,i.useState)(S().JW()),B=(0,n().K8)((()=>s.getState()),[s]),k=(0,n().uB)(void 0,L().A),E=(0,n().uB)(void 0,V),K=(0,n().uB)(void 0,y().A),j=l().default.createValue(!1,{name:"headerFocusStore"}),A=(0,n().K8)((()=>o.permissionScopesStore.state.canConfigureCollection),[o]),D=(0,n().K8)((()=>r.getFormBlockStore()),[r]),O=(0,n().K8)((()=>w.WindowSizeStore.state.height),[w.WindowSizeStore]),R=(0,i.useCallback)((e=>{var t;const i=s.getState(),n=a.getModules();if(i&&"existing_module"===i.type){var l;const t=null===(l=n.form_conditional_modules)||void 0===l?void 0:l[i.moduleId],o=void 0!==t?t:n.form_layout_schema.find((e=>e.id===i.moduleId));!o||"placeholder"!==o.type||t||e&&("existing_module"!==e.type||i.moduleId===e.moduleId)||(0,x().U)({environment:w,position:{area:t?"form_conditional_modules":"form_layout_schema",moduleId:o.id},layoutStore:a,sessionId:b})}if(s.setState(e),(e||i)&&p().clear({environment:w}),!e||"existing_module"!==e.type||e.isDragging)return;if(!M)return;const r=a.getModuleById(e.moduleId);if(!r)return;const u=void 0!==(null===(t=n.form_conditional_modules)||void 0===t?void 0:t[r.id]);d().default.afterNextFlush((()=>{const t=T().A.findModuleContainer({layoutStore:a,moduleId:r.id}),i=null==t?void 0:t.getNode(),n={current:i??null},l=null==i?void 0:i.getBoundingClientRect();switch(((null==l?void 0:l.bottom)??0)+120>O&&(0,C().vq)(i,{edgeDist:.5*O,animate:!0}),r.type){case"formQuestion":v().Ow({collectionContextStore:o,collectionSettingsStore:o.settingsStore,ref:n}),v().dP({collectionSettingsStore:o.settingsStore,item:{type:"formQuestionEditSettings",formQuestionId:r.formQuestionId,moduleId:r.id},ref:n});break;case"placeholder":v().Ow({collectionContextStore:o,collectionSettingsStore:o.settingsStore}),v().dP({collectionSettingsStore:o.settingsStore,item:{type:"formQuestionCreateSettings",moduleId:r.id,area:u?"form_conditional_modules":"form_layout_schema",parentModuleId:r.parentModuleId,parentConditionalGroupId:r.parentConditionalGroupId},ref:n});break;default:throw new Error("Unexpected module type")}s.setState(e)}))}),[s,M,a,w,b,O,o]),$=l().default.createValue(!1),P=(0,i.useMemo)((()=>({collectionStore:M,layoutStore:a,currentModuleSelection:B,setModuleSelection:R,sessionId:b,addModuleHoverMenuStore:k,canEditLayout:A,isPropertyTypeSearchInputDirtyStore:$,layoutBuilderModuleSelectionStore:s})),[M,a,B,R,b,k,A,$,s]),q=(0,i.useMemo)((()=>{if(!M||!D)throw new Error("Need a collection store and form block store to build the form context");return{formConditionalGroupsStore:m,formAddConditionalLogicTooltipStore:_,autofocusedQuestionTextStore:E,formBlockStore:D,headerMouseStore:K,headerFocusStore:j,collectionStore:M,isCollectionEmpty:h}}),[E,D,m,_,j,K,M,h]);(0,i.useEffect)((()=>{o.formsBaseLayoutEditorContextValueStore.setState(P),o.formsSpecificLayoutEditorContextValueStore.setState(q)}),[o,P,q]);const U=(0,i.useRef)(!1);(0,i.useEffect)((()=>{if(!1===U.current&&D&&D.isReady()){U.current=!0;const e=D.getTitleStore();e&&!f().q4_(e.getValue())&&p().setSelectionAtEnd({store:e})}}),[D,U]);const z=(0,i.useCallback)((()=>{R(void 0),v().os({collectionSettingsStore:o.settingsStore})}),[o.settingsStore,R]);return(0,c().X)(z),M&&r?(0,F.jsx)(g().RI,{value:o,children:(0,F.jsx)(I().Op.Provider,{value:P,children:(0,F.jsx)(Q().zi.Provider,{value:q,children:t})})}):null}function $(e){let{children:t}=e;const o=(0,w().X)("db_ux_chrome"),{setModuleSelection:l,currentModuleSelection:r,layoutStore:a}=(0,I().LH)(),s=(0,g().ET)(),d=(0,n().K8)((()=>s.settingsStore.state.open),[s]),u=(0,m().ZC)(d),c=(0,i.useCallback)((()=>{l(void 0)}),[l]);(0,i.useEffect)((()=>{u&&!d&&c()}),[c,d,u]);const S=(0,n().K8)((()=>(K().default.state,K().default.getRootFormQuestionStoreOfSelection())),[]),f=(0,n().K8)((()=>"existing_module"===(null==r?void 0:r.type)?a.getModuleById(r.moduleId):void 0),[r,a]);return(0,i.useEffect)((()=>{S&&f&&"formQuestion"===(null==f?void 0:f.type)&&S.id!==f.formQuestionId&&(c(),v().os({collectionSettingsStore:s.settingsStore}))}),[c,s.settingsStore,f,S]),(0,F.jsx)("div",{style:{marginTop:o?12:void 0,paddingBottom:96,cursor:"default"},onClick:e=>{(0,_().SQ)({event:e,context:_().y$.EditorClick,callback:()=>{c()}})},children:t})}const P=l().default.createClass(void 0,{name:"ReducerResultStore"});function q(e){const{paddingLeft:t,paddingRight:o,collectionContextStore:i}=e,l=(0,n().K8)((()=>i.collectionViewStore()),[i]),d=(0,n().K8)((()=>{if(l)return l.getFormBlockStore()}),[l]),u=(0,n().K8)((()=>{if(!d)return;const e=null==d?void 0:d.getFormat().form_layout_pointer;return e?s().K_.createChildStore(d,e):void 0}),[d]),c=(0,n().K8)((()=>null==u?void 0:u.isDefined()),[u]),m=(0,n().K8)((()=>null==d?void 0:d.isDefined()),[d]),S=(0,n().uB)(void 0,P),f=(0,n().K8)((()=>!!S.state&&0===S.state.blockIds.length),[S]);return l&&u&&c&&m?(0,F.jsxs)("div",{style:{paddingLeft:t,paddingRight:o},children:[(0,F.jsx)(r().A,{id:"form_editor_results",collectionContextStore:i,reducer:{type:"results",filter:{operator:"and",filters:[]},limit:1},resultStore:S}),(0,F.jsx)(a().A,{animate:{width:"100%"},children:(0,F.jsx)(O,{collectionContextStore:i,collectionViewStore:l,layoutStore:u,isCollectionEmpty:f})})]}):null}}}]);