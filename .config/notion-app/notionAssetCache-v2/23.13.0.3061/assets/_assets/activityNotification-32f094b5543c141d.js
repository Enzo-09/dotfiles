"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[56409],{2609:(e,t,i)=>{i.d(t,{J2:()=>_,NF:()=>M,gA:()=>j,hr:()=>C,jl:()=>w,p6:()=>k,rQ:()=>R});i(898992),i(672577),i(581454),i(296540);var o=()=>i(847249),r=()=>i(401497),n=()=>i(803960),s=()=>i(959013),a=()=>i(722872),l=()=>i(115512),d=()=>i(700250),c=()=>i(493823),u=()=>i(843189),g=()=>i(760217),m=()=>i(406699),p=()=>i(625830),v=()=>i(331542),h=()=>i(928600),f=()=>i(939740),y=()=>i(554509),b=()=>i(204063),x=()=>i(89924),S=()=>i(475971),A=i(474848);const j=20,_=440,M=_+40;function R(e){const{icon:t,title:i,byline:o,bylineWidthOverride:n}=e,s=(0,r().IS)((()=>({container:{margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",gap:8},title:{textAlign:"center"},byline:{textAlign:"center"}})),[]);return(0,A.jsxs)("div",{style:s.container,children:[t,(0,A.jsx)(y().D,{styleName:"Heading-17px/Semibold",customStyles:s.title,children:i}),(0,A.jsx)(y().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",customStyles:n?{...s.byline,width:n}:s.byline,children:o})]})}function w(e){const{primaryText:t,primaryAction:i,primaryDisabled:o,secondaryText:n,secondaryAction:s,isLightRed:a,isDarkRed:l,isLoading:d}=e,g=!(a||l),m=(0,r().IS)((e=>({container:{margin:"0 auto",display:"flex",flexDirection:g?"row-reverse":"column",alignItems:"center",justifyContent:g?"flex-start":"flex-end",gap:8,padding:"0 20px",marginLeft:-20,width:"calc(100% + 40px)"},fullWidth:g?{}:{width:"100%",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},cancelButton:{...S().W,height:32,color:e.text.secondary}})),[g]);return(0,A.jsxs)("div",{style:m.container,children:[a?(0,A.jsx)(u().E,{size:"lg",onClick:i,color:a?"uiRed":void 0,disabled:o,style:m.fullWidth,children:d?(0,A.jsx)(v().A,{}):t}):(0,A.jsx)(b().A,{size:"lg",onClick:i,disabled:o,style:m.fullWidth,isRed:l,children:d?(0,A.jsx)(v().A,{}):t}),(0,A.jsx)(c().p,{size:"lg",onClick:s,style:{...m.fullWidth,...m.cancelButton},children:n})]})}function C(e){const{selectedId:t,options:i,onChange:o}=e,l=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:8},chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},selectedButton:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${e.outlineButtonBorder}`},icon:{alignSelf:"start",marginTop:0,fill:e.icon.secondary,height:18,width:18}})),[]);return(0,A.jsxs)("div",{style:l.container,children:[(0,A.jsx)(y().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",children:(0,A.jsx)(s().sA,{id:"orgConsole.modal.dropdown.title",defaultMessage:"Select role"})}),(0,A.jsx)(m().Ay,{popupType:m().z7.Popup,renderOrigin:e=>{const o=i.find((e=>e.id===t));return o?(0,A.jsx)(g().A,{...e,title:o.title,caption:o.caption,icon:o.icon({fill:l.icon.fill}),desktopIconStyle:l.icon,disabled:!1,right:(0,n().arrowChevronSingleDownIcon)(l.chevron),shouldWrapCaption:!0,buttonStyle:l.selectedButton,focused:!1}):null},originGap:8,placementToOrigin:d().UV.Bottom,alignmentToOrigin:d().MY.Center,sameWidthAsOrigin:!0,render:e=>{const r=[{key:"options",render:e=>(0,A.jsx)(x().A,{...e,topBorder:0!==e.index}),items:i.map((i=>{const r=i.id===t;return{key:i.id,render:e=>(0,A.jsx)(g().A,{...e,title:i.title,caption:i.caption,icon:i.icon({fill:l.icon.fill}),desktopIconStyle:l.icon,isChecked:r,shouldWrapCaption:!0}),action:()=>{o(i.id),e.close()}}}))}];return(0,A.jsx)(h().A,{menuType:a().gu.Popup,children:(0,A.jsx)(f().Ay,{type:f().Oh.Vertical,initialFocus:void 0,sections:r})})}})]})}function k(e){const{items:t,selectedIds:i,disabledIds:n,onSelectHeader:s,onSelect:a,titleText:d,headerText:c,headerAction:u}=e,g=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:8,marginBottom:4},selectorContainer:{border:`1px solid ${e.stroke.secondary}`,boxShadow:"0px 2px 4px 0px #0000000a",borderRadius:8},checkbox:{display:"flex",justifyContent:"center",alignItems:"flex-start",flexDirection:"column"},headerText:{display:"flex",justifyContent:"center",alignItems:"flex-start",flexDirection:"column"},right:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",flexDirection:"row"},workspace:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:8},byline:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},bylineWithoutCheckboxes:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},iconContainer:{display:"flex",alignItems:"center",justifyContent:"center",height:28,width:28},textContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",gap:2},selectorHeader:{padding:"4px 12px",borderBottom:`1px solid ${e.stroke.secondary}`,display:"grid",gridTemplateColumns:"24px 1fr 1fr"},selectorHeaderWithAction:{padding:"4px 4px 4px 12px",borderBottom:`1px solid ${e.stroke.secondary}`,display:"grid",gridTemplateColumns:"24px 1fr 1fr"},selectorBody:{paddingInline:12,display:"flex",flexDirection:"column",alignItems:"center",justifyItems:"center",width:"100%",maxHeight:204,overflowX:"hidden",overflowY:"auto"},selectorBodyRow:{display:"grid",gridTemplateColumns:"24px minmax(auto, 50%) 1fr",width:"100%",paddingBlock:8,gap:8,borderTop:`1px solid ${e.stroke.secondary}`}})),[]),m=void 0!==i&&void 0!==n&&a&&s,v=void 0!==n?t.length-n.length:0,h=(0,o().K8)((()=>{if(void 0===i)return!1;let e=0;for(const o of t)i.includes(o.id)&&(e+=1);return 0!==e&&(e===v?0!==v:"partial")}),[t,i,v]);return(0,A.jsxs)("div",{style:g.container,children:[(0,A.jsx)(y().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",children:d}),(0,A.jsxs)("div",{style:g.selectorContainer,children:[(0,A.jsxs)("div",{style:{...u?g.selectorHeaderWithAction:g.selectorHeader,gridTemplateColumns:m?"24px 1fr 1fr":"1fr 1fr"},children:[m?(0,A.jsx)("div",{style:g.checkbox,children:(0,A.jsx)(p().A,{checked:h,size:14,checkSize:10,onClick:s})}):null,(0,A.jsx)(y().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",customStyles:g.headerText,children:c}),(0,A.jsx)("div",{style:g.right,children:u})]}),(0,A.jsx)("div",{style:g.selectorBody,children:t.map(((e,t)=>{let{id:o,icon:r,name:s,caption:d,byline:c}=e;return(0,A.jsxs)("div",{style:{...g.selectorBodyRow,borderTopWidth:0===t?0:1,gridTemplateColumns:m?"24px minmax(auto, 50%) 1fr":"minmax(auto, 50%) 1fr"},children:[m?(0,A.jsx)("div",{style:g.checkbox,children:(0,A.jsx)(p().A,{checked:i.includes(o)||n.includes(o),size:14,checkSize:10,onClick:()=>a(o),disabled:n.includes(o),style:{opacity:n.includes(o)?.3:1}})}):null,(0,A.jsxs)("div",{style:g.workspace,children:[(0,A.jsx)("div",{style:g.iconContainer,children:r}),(0,A.jsxs)("div",{style:g.textContainer,children:[(0,A.jsx)(y().D,{styleName:"UIRegular-14px/Medium",customStyles:{...(0,l().pA)(1),textOverflow:"ellipsis"},children:s}),d?(0,A.jsx)(y().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",customStyles:{...(0,l().pA)(1),textOverflow:"ellipsis"},children:d}):null]})]}),(0,A.jsx)("div",{style:g.byline,children:c})]},o)}))})]})]})}},28536:(e,t,i)=>{i.d(t,{I:()=>p,T:()=>v});i(18107),i(967357),i(581454);var o=()=>i(484714),r=()=>i(847249),n=()=>i(692026),s=()=>i(798880),a=()=>i(496603),l=i(296540),d=()=>i(43013);var c=()=>i(630116),u=()=>i(616092),g=()=>i(749240),m=()=>i(646736);function p(e){var t;let{spaceStore:i,request:n}=e;const l=(0,o().v3)(),d=(0,r().K8)((()=>{if(n)return new(c().LU)(l,{id:n.getForActorId(),table:s().oo}).getModel()}),[n,l]),u=n&&d?{accessRequest:n,forActor:d}:void 0;return null===(t=v({spaceStore:i,requests:(0,a().oE)([u])}))||void 0===t?void 0:t.at(0)}function v(e){let{spaceStore:t,requests:i}=e;const s=function(e){let{spaceStore:t,requests:i}=e;const n=(0,o().v3)(),s=function(e){const t=(0,d().K)(e);return(0,l.useCallback)((e=>t.memberEmails.has(e)?"member":t.guestEmails.has(e)?"guest":void 0),[t])}(g().subscriptionDataStoreInstance),a=(0,r().K8)((()=>null==i?void 0:i.map((e=>({email:e.forActor.email,currentRole:s(e.forActor.email)})))),[i,s]),c=n.currentUser.id,p=c?(0,m().dp)(t,c):void 0;return(0,u().Hq)({space:t,spaceUser:p,team:void 0,optimism:"optimistic",invitees:a??[],publicPageDataGuestSetting:void 0})}({spaceStore:t,requests:i});return(0,r().K8)((()=>null==i?void 0:i.map((e=>{var t;const i=(0,n().C)(e.accessRequest),o=null==s||null===(t=s[e.forActor.email])||void 0===t?void 0:t.type;return"guest_invite_request"!==i?i:"cannot_add"===o?"space_membership_request":"guest_invite_request"}))),[i,s])}},68913:(e,t,i)=>{i.r(t),i.d(t,{alarmIcon:()=>n,iconDefinition:()=>r});i(296540);var o=i(474848);const r={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M5.791 1.886a.625.625 0 1 0-.801-.96L2.138 3.31a.625.625 0 1 0 .802.96zm4.834 3.839a.625.625 0 1 0-1.25 0v3.65H6.4a.625.625 0 0 0 0 1.25H10c.345 0 .625-.28.625-.625z"}),(0,o.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0M14.13 1.006a.625.625 0 0 0 .079.88l2.851 2.383a.625.625 0 1 0 .802-.96L15.01.927a.625.625 0 0 0-.88.079"})]})},n=(0,i(340498).wt)("alarm",r)},75491:(e,t,i)=>{i.d(t,{ED:()=>f,Kb:()=>b});i(296540);var o=()=>i(847249),r=()=>i(401497),n=()=>i(668725),s=()=>i(722872),a=()=>i(463830),l=()=>i(406699),d=()=>i(928600),c=()=>i(939740),u=()=>i(897119),g=()=>i(89924),m=()=>i(125565),p=()=>i(493823),v=()=>i(566468),h=i(474848);function f(e){let{title:t,items:i,disabled:n,hideDropdownIcon:m,itemMaxWidth:p,itemMinWidth:v,...f}=e;const b=(0,o().uB)(void 0,a().A),x=(0,r().IS)((()=>({container:{minWidth:180}})),[]),S={key:"workspace-users-menu",render:e=>(0,h.jsx)(g().A,{...e}),items:i};return(0,h.jsx)(l().Ay,{popupType:u().nl.Popup,style:x.container,buttonPopupStore:b,disabled:n,renderOrigin:e=>(0,h.jsx)(y,{title:t,hideDropdownIcon:m,disabled:n,styles:f.styles,...e}),render:()=>(0,h.jsx)(d().A,{menuType:s().gu.Popup,maxWidth:p??250,minWidth:v,children:(0,h.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:0,sections:[S],onAccept:()=>{b.setState({open:!1})}})})})}function y(e){let{title:t,hideDropdownIcon:i,disabled:o,...s}=e;const a=(0,r().IS)((e=>({container:{display:"inline-flex",flexDirection:"row",justifyContent:"center",alignItems:"center",maxWidth:"100%",...s.styles},chevron:{width:10,height:10,marginLeft:4,color:e.lightIconColor}})),[s.styles]);return(0,h.jsxs)(p().p,{style:a.container,disabled:o,...s,children:[(0,h.jsx)(m().A,{showTooltipWhenTruncated:!0,children:t}),i||o?null:(0,n().b)(a.chevron)]})}function b(){const e=(0,r().IS)((()=>({title:{width:"50%"}})),[]);return(0,h.jsx)(v().mf,{titleStyles:e.title})}},112665:(e,t,i)=>{i.d(t,{J:()=>n});i(296540);var o=i(474848);const r={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M12.806 8.074a.625.625 0 1 0-1.072-.643l-2.512 4.185-1.407-1.642a.625.625 0 1 0-.95.814l1.973 2.3a.625.625 0 0 0 1.01-.085z"}),(0,o.jsx)("path",{d:"M10.405 1.724a.625.625 0 0 0-.81 0L7.36 3.628l-2.926.233a.625.625 0 0 0-.573.574L3.628 7.36 1.724 9.595a.624.624 0 0 0 0 .81l1.904 2.234.233 2.926a.625.625 0 0 0 .574.573l2.926.234 2.234 1.904a.624.624 0 0 0 .81 0l2.234-1.904 2.926-.234a.625.625 0 0 0 .573-.573l.234-2.926 1.904-2.234a.624.624 0 0 0 0-.81L16.372 7.36l-.234-2.926a.625.625 0 0 0-.573-.573l-2.926-.234zM8.017 4.711 10 3.02l1.983 1.69c.1.085.224.136.355.147l2.597.207.207 2.597c.01.13.062.255.147.355L16.98 10l-1.69 1.983a.63.63 0 0 0-.147.355l-.207 2.597-2.597.207a.63.63 0 0 0-.355.147L10 16.98l-1.983-1.69a.63.63 0 0 0-.355-.147l-2.597-.207-.207-2.597a.63.63 0 0 0-.147-.355L3.02 10l1.69-1.983a.63.63 0 0 0 .147-.355l.207-2.597 2.597-.207a.63.63 0 0 0 .355-.147"})]})},n=(0,i(340498).wt)("badgeCheck",r)},126550:(e,t,i)=>{i.d(t,{$:()=>l,t:()=>d});var o=()=>i(792071),r=()=>i(848538),n=()=>i(798880),s=()=>i(436856),a=()=>i(47373);function l(e,t){return e.getKeyStore("settings").getKeyStore("seen_guest_membership_requests").getValue()&&(0,a().nJ)()}function d(e,t){const i=o().Bj6.fromAccessRequest(e);if(!i.isPageAccessRequest())return!1;const a=i.getForActorPointer(t.id);return a.table===n().oo&&!s().V.createChildStore(t,r().i1({userId:a.id,spaceId:t.id})).isMember()}},309049:(e,t,i)=>{i.d(t,{A:()=>r});class o extends(()=>i(757695))().default{getInitialState(){return{count:0}}}const r=new o},317131:(e,t,i)=>{i.d(t,{p:()=>j,l:()=>x});i(581454),i(296540);var o=()=>i(484714),r=()=>i(847249),n=()=>i(401497),s=()=>i(254437),a=()=>i(695608),l=()=>i(959013),d=()=>i(755636),c=()=>i(125565),u=()=>i(453697),g=()=>i(493823),m=()=>i(859428),p=()=>i(75491);function v(e){let{totalCount:t,shownCount:i}=e;const o=t-i;return o>0?o:0}var h=()=>i(566468),f=i(474848);const y=24,b=4;function x(e){let{userStores:t,isClickable:i,useSecondaryColorTitle:s,useIconsOnly:g,totalCount:h,customAvatarStyles:x}=e;const j=(0,l().tz)(),_=(0,o().v3)(),M=(0,n().IS)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8},iconsWrapper:{display:"flex",flexDirection:"row",alignItems:"center"},icons:{display:"flex",flexDirection:"row",alignItems:"center"},iconContainer:{marginRight:-y/4,display:"flex",alignItems:"center",justifyContent:"center"},avatar:{marginRight:4,...x},plusMore:{opacity:.5,marginLeft:4,display:"inline-block"},tooltip:{color:e.text.contrastPrimary,fontSize:12}})),[x]),R=t.slice(0,b),w=(0,r().K8)((()=>{if(R[0])return R.map((e=>{if(e)return e.computeWithRecordValues((t=>{let{getRecordValueAndSubscribe:i}=t;return i(e)}))}))}),[R]),C=w&&w[0],k=(0,f.jsxs)("div",{style:M.container,children:[(0,f.jsx)(u().A,{style:M.avatar,userValue:C,size:y}),(0,f.jsx)(l().sA,{id:"baseTable.usersCell.userName",defaultMessage:"{remainingCount, plural, =0 {<user>{firstUser}</user>} one {<user>{firstUser}</user><gray>+{remainingCount}</gray>} other {<user>{firstUser}</user><gray>+{remainingCount}</gray>}}",values:{firstUser:(0,a().c6)(j,C),remainingCount:v({totalCount:h||t.length,shownCount:1}),user:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,f.jsx)(c().A,{isSecondaryColor:s,children:t})},gray:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,f.jsx)(c().A,{style:M.plusMore,children:t})}}})]});let I=k;if(g){const e=v({totalCount:h||t.length,shownCount:R.length});I=(0,f.jsxs)("div",{style:M.iconsWrapper,children:[(0,f.jsx)("div",{style:M.icons,children:null==w?void 0:w.map(((e,t)=>(0,f.jsx)("div",{style:M.iconContainer,children:(0,f.jsx)(u().A,{userValue:e,size:y})},(null==e?void 0:e.id)||t)))}),e>0&&(0,f.jsx)(l().sA,{id:"baseTable.usersCell.remainingUsers",defaultMessage:"<gray>+{remainingCount}</gray>",values:{remainingCount:e,gray:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,f.jsx)(c().A,{style:{...M.plusMore,marginLeft:M.plusMore.marginLeft+-1*M.iconContainer.marginRight},children:t})}}})]})}if(!i)return(0,f.jsx)(m().A,{disableTooltip:t.length<=1,render:e=>(0,f.jsx)("div",{...e,children:I}),renderTooltip:()=>(0,f.jsx)(f.Fragment,{children:t.map(((e,t)=>(0,f.jsx)(c().A,{style:M.tooltip,children:(0,f.jsx)(A,{userStore:e})},e?e.id:t)))})});const B=t.map(((e,t)=>({key:null!=e&&e.id?null==e?void 0:e.id:t,render:t=>(0,f.jsx)(S,{userStore:e,...t}),action:()=>null!=e&&e.getEmail?d().f({environment:_,url:`mailto:${null==e?void 0:e.getEmail()}`}):void 0})));return(0,f.jsx)(p().ED,{hideDropdownIcon:!0,title:I,items:B,itemMaxWidth:380})}function S(e){let{userStore:t,...i}=e;const o=(0,r().K8)((()=>null==t?void 0:t.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:i}=e;return i(t)}))),[t]),a=(0,n().IS)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingBlock:8,marginInline:4},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:400},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:400}})),[]);return(0,f.jsxs)(g().p,{style:a.container,...i,children:[(0,f.jsx)("div",{style:a.avatarContainer,children:(0,f.jsx)(u().A,{userValue:o,size:y})}),(0,f.jsxs)("div",{style:a.nameContainer,children:[(0,f.jsx)(c().A,{style:a.name,children:(0,f.jsx)(A,{userStore:t})}),o?(0,f.jsx)(c().A,{style:a.email,children:o.email}):null]}),(0,f.jsx)("div",{style:a.copyContainer,children:(0,s().F)({height:18,width:18})})]})}function A(e){const t=(0,l().tz)(),{userStore:i}=e,o=(0,r().K8)((()=>null==i?void 0:i.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(i)}))),[i]);return(0,f.jsx)(f.Fragment,{children:(0,a().c6)(t,o)})}function j(){const e=(0,n().IS)((()=>({icon:{borderRadius:"100%"},title:{width:"80%"}})),[]);return(0,f.jsx)(h().mf,{titleStyles:e.title,includeIcon:!0,iconStyles:e.icon})}},350648:(e,t,i)=>{i.d(t,{D2:()=>A,Ip:()=>b,Jk:()=>x,YT:()=>S,e2:()=>f,g:()=>y});i(898992),i(354520);var o=()=>i(584262),r=()=>i(798880),n=()=>i(946141),s=()=>i(449506),a=()=>i(246826),l=()=>i(436572),d=()=>i(426116),c=()=>i(751156),u=()=>i(972435),g=()=>i(640653),m=()=>i(351360),p=()=>i(848237),v=()=>i(263928);const h=(0,i(959013).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function f(e){let{environment:t,userId:i,teamStore:o,user:r}=e;const s=o.getSpaceId();if(!s)return;await p().rU({environment:t,teamId:o.id,spaceId:s,teamUserInfo:r,isSettingDefaultTeam:!1,inviterId:i})&&(n().vo(t,{store:o,joined_role:"member",from:"team_invite_link"}),await y({environment:t,userId:i,teamStore:o}),l().D6({label:u().A.formatMessage(h.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function y(e){let{environment:t,userId:i,teamStore:r}=e;const n=m().default.state.currentUserRootStore,s=r.getSpaceId();if(!s||!n)return;const a=n.getSpaceViewStores().filter((e=>e.getSpaceId()===s))[0];await d().tR({environment:t,spaceViewStore:a,userSettingsStore:void 0,userRootStore:n,pageVisitSource:o().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await v().J({environment:t,spaceId:s,userId:i}),p().L0({environment:t,teamStore:r,shouldScroll:!0})}async function b(e){let{environment:t,teamId:i,message:o}=e;if(!t.currentUser.id)return;"success"===(await s().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:i,message:o}})).type?(n().XQ(t,{teamId:i}),await S({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{l().D6({label:u().A.formatMessage(h.requestTeamSuccessMessage)})}))):l().D6({label:u().A.formatMessage(h.requestTeamFailureMessage)})}async function x(e){let{environment:t,teamStore:i,accessRequestStore:o,status:s}=e;const l=o.getForActorId();if(!l)return;const d=o.getRecordModel({table:r().oo,id:l});if(d){if("approved"===s){const e=[{type:"member",entity_type:"user",user_id:d.id}];if(!(await p().Zd({environment:t,teamStore:i,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}c().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{a().zv({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:r().oo,resolved_by_id:t.currentUser.id,status:s}})}}),n().GW(t,{store:i,resolution:s})}}async function S(e){let{environment:t}=e;const{lastVisitedSpaceView:i,userRootStore:r,userSettingsStore:n}=await(0,g().ex)({environment:t,disableRedirectUrl:!1});i?await d().tR({environment:t,spaceViewStore:i,userRootStore:r,userSettingsStore:n,pageVisitSource:o().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await d().t9({environment:t,userRootStore:r,userSettingsStore:n,pageVisitSource:o().y8.BackForward})}async function A(e){let{environment:t,teamId:i}=e;const o=await s().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:i}});if("success"===o.type)return o.data}},383716:(e,t,i)=>{i.d(t,{n:()=>u});i(296540);var o=()=>i(484714),r=()=>i(380048),n=()=>i(959013),s=()=>i(284371),a=()=>i(84817),l=()=>i(285790),d=()=>i(8178),c=i(474848);function u(e){const t=(0,n().tz)(),{title:i,goBack:u}=e,g=(0,o().v3)(),{isMobile:m}=g.device;return(0,c.jsxs)(a().Y1,{direction:"horizontal",gap:6,children:[u&&(0,c.jsx)(l().A,{ariaLabel:t.formatMessage({id:"requestsPageHeader.back",defaultMessage:"Back"}),icon:r().I,onClick:u}),(0,c.jsx)(d().A,{large:!m,divider:"none",fontSize:16,fontWeight:s().Wy.medium,style:{marginBottom:0},children:i})]})}},384100:(e,t,i)=>{i.d(t,{z:()=>n});var o=()=>i(798880),r=()=>i(630116);function n(e){let{userId:t,currentSpaceStore:i}=e;return r().LU.createChildStore(i,{table:o().oo,id:t})}},475971:(e,t,i)=>{i.d(t,{M:()=>r,W:()=>o});const o={height:28,paddingLeft:8,paddingRight:8,paddingTop:4,paddingBottom:4,fontWeight:i(284371).Wy.medium},r={opacity:.4}},479314:(e,t,i)=>{i.d(t,{K:()=>r});const o={currentPage:"home",setPage:()=>{},isSalesEligible:!1},r=(0,i(296540).createContext)(o);r.displayName="RequestsSettingsPageContext"},525884:(e,t,i)=>{i.d(t,{A:()=>n});i(296540);var o=i(474848);const r={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M8.65 8.25a.625.625 0 1 0 0 1.25h.725v3.25H8.65a.625.625 0 1 0 0 1.25h2.7a.625.625 0 1 0 0-1.25h-.725V8.875A.625.625 0 0 0 10 8.25zM10.7 6.3a.8.8 0 1 1-1.6 0 .8.8 0 0 1 1.6 0"}),(0,o.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},n=(0,i(340498).wt)("infoCircle",r)},566468:(e,t,i)=>{i.d(t,{Ji:()=>_,bd:()=>C,f0:()=>R,mf:()=>w,s7:()=>M});i(944114),i(296540);var o=()=>i(847249),r=()=>i(401497),n=()=>i(30626),s=()=>i(959013),a=()=>i(496603),l=()=>i(534177),d=()=>i(722872),c=()=>i(962730),u=()=>i(463830),g=()=>i(760217),m=()=>i(406699),p=()=>i(285790),v=()=>i(710149),h=()=>i(928600),f=()=>i(939740),y=()=>i(897119),b=()=>i(89924),x=()=>i(859428),S=()=>i(125565),A=i(474848);const j=20,_=12;function M(e){let{title:t,byline:i,icon:o,iconSize:r,iconMargin:n,useThinTitle:s,useSecondaryColorTitle:a,containerStyles:l,summaryStyles:d,rightContent:c,badge:u}=e;const g=R({icon:o,iconSize:r,iconMargin:n,useThinTitle:s,containerStyles:l,summaryStyles:d});return(0,A.jsxs)("div",{style:g.container,children:[o?(0,A.jsx)("div",{style:g.iconContainer,children:o}):null,(0,A.jsxs)("div",{style:g.summaryContainer,children:[(0,A.jsxs)("div",{style:g.nameContainer,children:[(0,A.jsx)(S().A,{style:g.name,isSecondaryColor:a,showTooltipWhenTruncated:!0,children:t}),u?(0,A.jsx)("div",{style:g.badge,children:u}):null]}),i?(0,A.jsx)(S().A,{style:g.byline,children:i}):null]}),c]})}function R(e){const{icon:t,iconSize:i,iconMargin:o,useThinTitle:n,containerStyles:s,summaryStyles:a}=e,l=o??_,d=t?i??j:0;return(0,r().IS)((e=>({container:{position:"relative",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%",...s},summaryContainer:{width:`calc(100% - ${d}px)`,...a},iconContainer:{height:d,width:d,flexGrow:0,flexShrink:0,flexBasis:d,marginRight:l,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:6},badge:{marginRight:8},nameContainer:{display:"flex",alignItems:"center",gap:6},name:{fontSize:14,fontWeight:n?400:500},byline:{fontSize:12,lineHeight:1.3,opacity:.5}})),[d,l,n,s,a])}function w(e){let{titleStyles:t,includeByline:i,bylineStyles:o,includeIcon:n,iconStyles:s,containerStyles:a}=e;const l=(0,r().IS)((()=>({container:{height:53,display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%",gap:8,...a},icon:{borderRadius:4,height:24,width:24,marginLeft:-2,...s},textContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",width:"calc(100% - 32px)",gap:4},title:{borderRadius:4,height:14,width:"80%",...t},byline:{borderRadius:4,height:12,width:"60%",...o}})),[a,t,o,s]);return(0,A.jsxs)("div",{style:l.container,children:[n?(0,A.jsx)(v().A,{style:l.icon}):null,(0,A.jsxs)("div",{style:l.textContainer,children:[(0,A.jsx)(v().A,{style:l.title}),i?(0,A.jsx)(v().A,{style:l.byline}):null]})]})}function C(e){const t=(0,s().tz)(),i=(0,o().uB)(void 0,u().A),v=(0,r().IS)((()=>({popupMenu:{width:312}})),[]);let S=[];const j=[];for(const o of e.items)if("divider"===o.type){const t=j.length>0,i={key:`actions-${j.length}`,render:i=>(0,A.jsx)(b().A,{title:e.title,topBorder:t,...i}),items:S};j.push(i),S=[]}else if("action"===o.type){const e={key:o.key,render:e=>(0,A.jsx)(x().A,{textWrap:!0,render:t=>(0,A.jsx)(g().A,{...e,...t,isRedOnHover:o.isDestructive,shouldWrapCaption:!0,icon:o.icon,title:o.title,caption:o.caption,disabled:o.disabled,disabledFeedback:o.disabled}),renderTooltip:()=>o.tooltipTitle,disableTooltip:o.tooltipDisabled??!0,placement:c().W.Right}),action:()=>{o.action(),i.setState({...i.state,open:!1})}};S.push(e)}else(0,l().HB)(o);const _={key:`actions-${j.length}`,render:t=>(0,A.jsx)(b().A,{title:e.title,topBorder:j.length>0,...t}),items:S};return j.push(_),(0,A.jsx)(m().Ay,{stopClickPropagation:!0,popupType:y().nl.Popup,alignmentToOrigin:c().C.Start,placementToOrigin:c().W.Bottom,style:v.popupMenu,render:()=>(0,A.jsx)(h().A,{menuType:d().gu.Popup,width:312,children:(0,A.jsx)(f().Ay,{type:f().Oh.Vertical,initialFocus:void 0,sections:j})}),onClose:a().lQ,buttonPopupStore:i,renderOrigin:e=>(0,A.jsx)(p().A,{ariaLabel:t.formatMessage({id:"iconCellActionMenu.iconButton.ariaLabel",defaultMessage:"More actions"}),icon:n()._,...e})})}},593167:(e,t,i)=>{i.r(t),i.d(t,{ActivityNotification:()=>jn});var o=i(296540),r=()=>i(484714),n=()=>i(847249),s=()=>i(813206),a=()=>i(857639),l=()=>i(197959),d=()=>i(963589),c=()=>i(999598),u=(i(18107),i(967357),()=>i(401497)),g=()=>i(692026),m=()=>i(584262),p=()=>i(296344),v=()=>i(179034),h=()=>i(96689),f=()=>i(854150),y=()=>i(798880),b=()=>i(959013),x=()=>i(534177),S=()=>i(284371),A=()=>i(746970),j=()=>i(126550),_=()=>i(972435),M=()=>i(28536),R=()=>i(212326),w=()=>i(630116),C=()=>i(869190),k=()=>i(402390),I=()=>i(563884),B=()=>i(823279),K=()=>i(496603),T=()=>i(572080),q=()=>i(82926),N=()=>i(751156),P=()=>i(38337),L=()=>i(728611),D=()=>i(753199),z=()=>i(553965),U=()=>i(907514),W=()=>i(577009),O=()=>i(965351),E=()=>i(962730),F=()=>i(197190),V=()=>i(406699),H=()=>i(285790),$=()=>i(614505),G=()=>i(16006),Y=()=>i(859428),Q=()=>i(473594),X=()=>i(659799),J=i(474848);const Z=o.createContext((()=>{}));function ee(e){const{disabled:t=!1,children:i}=e,r=(0,o.useContext)(Z),n=(0,o.useCallback)((()=>{t||r(!0)}),[r,t]),s=(0,o.useCallback)((()=>{t||r(!1)}),[r,t]);return(0,J.jsx)("div",{style:{display:"contents"},onMouseEnter:n,onMouseLeave:s,children:i})}Z.displayName="NestedNotificationButtonContext";const te=0,ie=8,oe=24,re=24+oe+ie,ne="150ms ease";function se(e){const{notification:t,children:s,rootStore:a,icon:l,isPrivate:d,onArchiveClicked:c,onUnarchiveClicked:g,onMarkAsReadClicked:m,onMarkAsUnreadClicked:p,onNotificationBodyClicked:h,navigableBlockId:f,url:y,showSnapshotButton:b,hidePageTitle:x,header:S,isFirst:A,isLast:j}=e,_=(0,r().v3)(),M=(0,r().Y0)(),R=parseInt(t.end_time),C=(0,n().K8)((()=>{const e=t.navigable_block_id;if(e)return w().sk.createChildStore(a,{table:v().ev,id:e,spaceId:a.id})}),[a,t.navigable_block_id]),k=(0,n().K8)((()=>i(441199).default.isPeekDismissableState()),[]),[I,B]=(0,o.useState)(!1),[K,q]=(0,o.useState)(!1),L=(0,o.useRef)(null),z=(0,i(683097).A)({onLongPress:()=>{var e;return null===(e=L.current)||void 0===e?void 0:e.setOpen(!0)}}),[U,W]=(0,o.useState)(!1),E=I&&!K&&!U,H=(0,n().K8)((()=>"mentions"===i(606846).Ay.state.currentTab),[]),$=!t||t.read,G=M.isMobile,Y=(0,n().K8)((()=>{const e=_.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[_.WindowSizeStore]),Q=(0,u().IS)((e=>({article:{display:"flex",flexDirection:"column"},mainClickTargetButton:{display:"flex",flexDirection:"column",gap:8,paddingTop:14-te,paddingBottom:14-te,paddingLeft:G?Y.left:0,paddingRight:G?Y.right:0,marginTop:A?0:te,marginBottom:j?0:te,marginLeft:te,marginRight:te,transition:`background ${ne}`},mainClickTargetButtonHovered:{background:e.state.hover},headerAndAvatar:{display:"flex",paddingLeft:8-te,paddingRight:20-te,gap:ie,maxWidth:"100%"},avatarAndStatusDot:{display:"flex",gap:8,alignItems:"center",height:oe},statusDotSpacer:{width:8,flexShrink:0},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},children:{paddingLeft:re-te,paddingRight:20-te},divider:{height:1,backgroundColor:e.stroke.secondary},buttonPressed:{backgroundColor:I&&K?e.buttonBackground:e.state.pressed}})),[G,Y.left,Y.right,A,j,I,K]),X=(0,o.useCallback)((e=>{t&&(U||(!y&&t.read||h(),(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{!k||e.metaKey||e.ctrlKey||i(770906).VI({environment:_}),t.read||N().createAndCommit({userAction:"ActivityNotificationSection.handleMarkAsRead",environment:_,canUndo:!0,perform:e=>{T().ZB({notification:t,rootStore:a,transaction:e,read:!0})}})}})))}),[_,U,t,h,k,a,y]),ee=(0,o.useCallback)((e=>{t&&(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{t.read?p():m(),N().createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:_,canUndo:!0,perform:e=>{T().ZB({notification:t,rootStore:a,transaction:e,read:!t.read})}})}})}),[_,t,m,p,a]),se=(0,o.useCallback)((e=>{t&&(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{c(),N().createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:_,canUndo:!0,perform:e=>{T().s4({notification:t,rootStore:a,transaction:e})}})}})}),[_,t,c,a]),ae=(0,o.useCallback)((e=>{t&&(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{g(),N().createAndCommit({userAction:"Activity.handleUnarchive",environment:_,canUndo:!0,perform:e=>{T().JV({notificationId:t.id,visited:!1,rootStore:a,transaction:e})}})}})}),[_,t,g,a]),le=(0,o.useCallback)((()=>B(!0)),[]),de=(0,o.useCallback)((()=>B(!1)),[]),ue=(0,o.useId)(),ge=(0,i(575301).T4)();return(0,J.jsx)(V().Ay,{ref:L,disabled:!M.isMobile,style:ge.popup,popupType:M.isTablet?V().z7.Popup:V().z7.SlideUp,render:e=>(0,J.jsx)(O().Lk,{blockStore:C,notification:t,handlers:{handleUnarchive:ae,handleArchive:se,toggleNotificationReadStatus:ee},closePopup:()=>e.close()}),renderOrigin:()=>(0,J.jsx)("div",{...M.isMobile&&z,children:(0,J.jsx)("article",{style:Q.article,onMouseOver:le,onMouseLeave:de,children:(0,J.jsxs)(Z.Provider,{value:q,children:[(0,J.jsx)(ce,{notification:t,rootStore:a,isMobile:G,isHovered:I,isFirst:A,onMouseEnter:()=>W(!0),onMouseLeave:()=>W(!1),onArchiveClicked:c,onUnarchiveClicked:g,onMarkAsReadClicked:m,onMarkAsUnreadClicked:p}),(0,J.jsxs)(F().A,{href:y,hovered:E,ignoreLocalHoverState:!0,style:Q.mainClickTargetButton,onClick:X,hoveredStyle:Q.mainClickTargetButtonHovered,disabled:!Boolean(y),pressedStyle:Q.buttonPressed,"aria-labelledby":ue,children:[(0,J.jsxs)("div",{style:Q.headerAndAvatar,children:[(0,J.jsxs)("div",{className:P().a9W,style:Q.avatarAndStatusDot,children:[H&&!$?(0,J.jsx)(i(709438).m,{size:8}):(0,J.jsx)("div",{style:Q.statusDotSpacer}),l]}),(0,J.jsx)(pe,{blockStore:C,timestamp:R,header:S,hidePageTitle:Boolean(x),titleAriaId:ue}),b&&f&&(0,J.jsx)(ve,{timestamp:R,navigableBlockId:f,rootStore:a}),d&&!t&&(0,J.jsx)(i(365136).A,{style:Q.privatePageBadge})]}),s&&(0,J.jsx)("div",{style:Q.children,className:P().CyB,children:s})]}),!j&&(0,J.jsx)("div",{style:Q.divider})]})})})},t.id)}const ae=12-te,le=12-te,de="100ms ease-out";function ce(e){const{notification:t,rootStore:i,isMobile:o,isHovered:r,isFirst:n,onArchiveClicked:s,onUnarchiveClicked:a,onMarkAsReadClicked:l,onMarkAsUnreadClicked:d,onMouseEnter:c,onMouseLeave:g}=e,m=(0,u().IS)((()=>({container:{display:"flex",alignItems:"flex-start",position:"relative",zIndex:1},body:{transition:`opacity ${de}`,opacity:o||r?1:0,position:"absolute",right:ae,top:le+(o?-3:0)+(n?0:te)}})),[o,r,n]);return t?(0,J.jsx)("div",{style:m.container,onMouseEnter:c,onMouseLeave:g,children:(0,J.jsx)("div",{style:m.body,children:(0,J.jsx)(W().hR,{notification:t,rootStore:i,onArchiveClicked:s,onUnarchiveClicked:a,onMarkAsReadClicked:l,onMarkAsUnreadClicked:d})})}):null}const ue=14,ge=12,me=3;function pe(e){const{blockStore:t,timestamp:i,hidePageTitle:s,header:a,titleAriaId:l}=e,d=(0,r().Y0)().isMobile,c=!s,[g,m]=(0,o.useState)(!1),[p,v]=(0,o.useState)(!1),h=(0,U().nl)(i,{useUltraCompactFormat:!0}),f=(0,U().x$)(i),y=(0,n().K8)((()=>{var e;if(t)return null===(e=t.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:t.getRecordModel})}),[t]),b=(0,n().K8)((()=>!!t&&t.isEmptyPage()),[t]),x=(0,n().K8)((()=>null==t?void 0:t.isDefined()),[t]),A=(0,o.useCallback)((()=>{m(!0),v(!1)}),[]),j=K().nF((()=>{v(!0)}),200,{leading:!0}),_=(0,o.useCallback)((()=>{m(!1),v(!1),L().Ol(window,"scroll",j,!0)}),[j]),M=(0,o.useCallback)((e=>(0,J.jsx)(Q().yf,{store:t,events:e})),[t]);(0,o.useEffect)((()=>(L().P4(window,"scroll",j,!0),()=>L().Ol(window,"scroll",j,!0))),[j]);const R=(0,u().IS)((e=>({container:{display:"flex",flexDirection:"row",minWidth:0,width:"100%",marginTop:2},headerMobile:{fontSize:ue,minWidth:0},header:{display:"inline-grid",gridAutoFlow:"column",justifyContent:"space-between",fontSize:ue,minWidth:0},headlineMobile:{paddingTop:2,display:"inline",whiteSpace:"pre-wrap",wordBreak:"break-word"},headline:{flexShrink:2,whiteSpace:"pre-wrap",wordBreak:"break-word"},time:{display:"flex",fontSize:ge,color:e.text.tertiary,whiteSpace:"nowrap",...d&&{display:"inline"},paddingLeft:6,marginTop:ue-ge},headerAndPageTitle:{display:"flex",flex:1,flexDirection:"column",gap:me,minWidth:0},pageTitleMockedButton:{maxWidth:"fit-content",display:"flex",alignItems:"center",gap:4,borderRadius:3,paddingTop:2,paddingBottom:2,paddingLeft:3,paddingRight:5,marginTop:-2,marginBottom:-2,marginLeft:-3,marginRight:-5,background:g&&x?e.state.hover:void 0},recordTitle:{fontSize:14,fontWeight:S().Wy.medium}})),[d,g,x]),w=!0!==p&&void 0;return(0,J.jsxs)("div",{style:R.container,children:[(0,J.jsxs)("div",{style:R.headerAndPageTitle,children:[(0,J.jsxs)("div",{style:d?R.headerMobile:R.header,children:[(0,J.jsx)("div",{style:d?R.headlineMobile:R.headline,className:P().k2l,id:l,children:a}),(0,J.jsx)("div",{style:R.time,className:P().Cxn,children:(0,J.jsx)(X().A,{text:h,tooltipText:f,icon:I().k})})]}),t&&c&&(0,J.jsx)(ee,{disabled:!x,children:(0,J.jsx)(Y().A,{originGap:3,disableTooltip:!x,alignment:E().C.Start,placement:E().W.Bottom,renderTooltip:M,closeDelay:0,noStyle:!0,textWrap:!0,forceVisibleState:w,render:e=>(0,J.jsxs)("div",{style:R.pageTitleMockedButton,...(0,z().A)(e,{onMouseEnter:A,onMouseLeave:_}),children:[(0,J.jsx)($().B,{disabled:!0,icon:y,isEmptyPage:b,size:16}),(0,J.jsx)(G().A,{store:t,style:R.recordTitle,underline:!0})]})})})]}),d&&(0,J.jsx)("div",{style:{width:O().UM-ae,flexShrink:0}})]})}function ve(e){const{timestamp:t,navigableBlockId:i,rootStore:o}=e,n=(0,r().v3)();if(t<new Date("2018-10-26").getTime())return null;const s=_().A.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),a=()=>{const e=w().Bv.createChildStore(o,{table:v().ev,id:i});q().WE({environment:n,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return(0,J.jsx)(Y().A,{renderTooltip:()=>s,render:e=>(0,J.jsx)(H().A,{ariaLabel:s,onClick:a,icon:B().L,...e})})}function he(e){const{children:t}=e,i=(0,u().IS)((e=>({container:{borderRadius:"100%",display:"flex",flexShrink:0,justifyContent:"center",alignItems:"center",height:oe,width:oe,backgroundColor:e.surface.elevated,borderWidth:1,borderStyle:"solid",borderColor:e.stroke.secondary}})),[]);return(0,J.jsx)("div",{style:i.container,children:t})}const fe=o.memo(se);var ye=()=>i(493823);const be=function(e){const{accessRequestStore:t,teamStore:o}=e,s=(0,r().v3)(),a=(0,b().tz)(),{isRequestResolved:l,resolvedStatus:d,resolvedTime:c}=(0,n().K8)((()=>({isRequestResolved:t.isResolvedTeamMembershipRequest(),resolvedStatus:t.getStatus(),resolvedTime:t.getResolvedTime()})),[t]),g=(0,n().K8)((()=>{const e=t.getResolvedById();if(!e)return;const i=w().LU.createChildStore(t,{table:y().oo,id:e});return i?i.getDisplayName(a):void 0}),[t,a]),m=async e=>{await i(350648).Jk({environment:s,teamStore:o,accessRequestStore:t,status:e})},p=(0,u().IS)((e=>({container:{display:"flex",alignItems:"center"},redesignedContainer:{display:"flex",alignItems:"center",fontSize:14,color:e.text.secondary},approveButton:{height:26,paddingLeft:8,paddingRight:8,fontSize:12,marginRight:10,fontWeight:500,boxShadow:e.shadow2XS,color:e.text.primary}})),[]);return(0,J.jsx)("div",{style:p.container,children:l?(0,J.jsx)("div",{style:p.redesignedContainer,children:"approved"===d?(0,J.jsx)(b().sA,{defaultMessage:"Approved by {grantedBy} on {resolvedTime}",id:"approveTeamMembershipActivityButton.requestApprovedWithTime.title",values:{grantedBy:g,resolvedTime:(0,C().W_)(Math.min(c??0,Date.now()),"medium_with_time",(0,k().H)(a))}}):(0,J.jsx)(b().sA,{defaultMessage:"Denied by {grantedBy} on {resolvedTime}",id:"approveTeamMembershipActivityButton.requestDeniedWithTime.title",values:{grantedBy:g,resolvedTime:(0,C().W_)(Math.min(c??0,Date.now()),"medium_with_time",(0,k().H)(a))}})}):(0,J.jsxs)("div",{children:[(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{isGray:!0,size:"xs",style:p.approveButton,onClick:()=>m("approved"),children:(0,J.jsx)(b().sA,{defaultMessage:"Approve",id:"approveTeamMembershipActivityButton.approveButton.label"})})}),(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{isGray:!0,size:"xs",style:p.approveButton,onClick:()=>m("rejected"),children:(0,J.jsx)(b().sA,{defaultMessage:"Deny",id:"approveTeamMembershipActivityButton.denyButton.label"})})})]})})};var xe=()=>i(764880),Se=()=>i(824862),Ae=()=>i(701763),je=()=>i(209660),_e=()=>i(973189);const Me=function(e){const{accessRequestStore:t,effectiveAccessRequestType:i,onApprove:o,onReject:s,spaceStore:a}=e,l=(0,r().v3)(),c=(0,n().K8)((()=>t.isDefined()),[t]),g=(0,n().K8)((()=>t.getModel()),[t]),m=(0,n().K8)((()=>a.canAdmin()),[a]),p=(0,n().K8)((()=>a.canEditMembership()),[a]),v=(0,n().K8)((()=>null==g?void 0:g.isResolved()),[g]),h=(0,n().K8)((()=>null==g?void 0:g.isGuestInviteRequest()),[g]),f=(0,d().X)("workspace_member_access_notif_polish"),y=(0,u().IS)((e=>({viewAllButton:{height:26,paddingLeft:8,paddingRight:8,color:e.text.primary,fontSize:14},secondaryButtonForGuestInvites:{height:26,paddingLeft:8,paddingRight:8},actionButton:{height:28,paddingLeft:12,paddingRight:12,boxShadow:e.shadow2XS,fontSize:14,color:e.text.primary},notifContainer:{display:"flex",alignItems:"center",gap:h||!f?10:8},guestApproveButton:{height:28,paddingLeft:8,paddingRight:8,boxShadow:e.shadow2XS,fontSize:12,color:e.text.primary,fontWeight:500}})),[h,f]),x="space_membership_request"===i;return c?v?(0,J.jsx)(Ce,{accessRequestStore:t,spaceStore:a}):h&&!m||x&&!p?null:(0,J.jsxs)("div",{style:y.notifContainer,children:[(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{isGray:!0,size:"xs",onClick:o,style:h||!f?y.guestApproveButton:y.actionButton,children:(0,J.jsx)(b().sA,{defaultMessage:"Approve",id:"approveSpaceMembershipActivityAction.approveButton.label"})})}),(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{isGray:!0,size:"xs",onClick:s,style:h||!f?y.secondaryButtonForGuestInvites:y.actionButton,children:(0,J.jsx)(b().sA,{defaultMessage:"Deny",id:"approveSpaceMembershipActivityAction.denyButton.label"})})}),!l.device.isMobile&&(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{isGray:!0,size:"xs",onClick:()=>{Ae().Sp(l,{disable_membership_requests:a.getDisableMembershipRequests()}),je().Ow({currentTab:"members",subtab:_e().d.Requests})},style:h||!f?y.secondaryButtonForGuestInvites:y.viewAllButton,children:h||!f?(0,J.jsx)(b().sA,{defaultMessage:"View all requests",id:"approveSpaceMembershipActivityAction.viewAllRequests.label"}):(0,J.jsx)(b().sA,{defaultMessage:"View all",id:"approveSpaceMembershipActivityAction.viewAll.label"})})})]}):null};function Re(e,t,i){if(e===y().oo){const o=i.getRecordValue({table:e,id:t});if(o)return(0,xe().A7)(o)}if(e===Se().GP){const o=i.getRecordValue({table:e,id:t});if(o)return(0,xe().qt)(o)}}function we(e){const{pointer:t,accessRequestStore:i}=e,{table:o,id:r}=t,s=(0,n().K8)((()=>K().oE([Re(o,r,i)])),[o,r,i]),a=(0,n().K8)((()=>(0,c().bD)(s,(0,R()._m)())),[s]);return(0,J.jsx)(J.Fragment,{children:a})}function Ce(e){const{accessRequestStore:t,spaceStore:i}=e,o=(0,b().tz)(),r=(0,u().DP)(),s=(0,n().K8)((()=>t.getModel()),[t]),a=(0,n().K8)((()=>t.getStatus()),[t]),l=(0,n().K8)((()=>t.getResolvedTime()),[t]),{isResolved:d,resolveByPointer:c}=(0,n().K8)((()=>({isResolved:(null==s?void 0:s.isResolved())??!1,resolveByPointer:null==s?void 0:s.getResolvedByPointer(i.id)})),[s,i.id]);if(!s)return null;const g=d&&c&&(0,J.jsx)(we,{accessRequestStore:t,pointer:c});return(0,J.jsx)("div",{style:{fontSize:14,color:r.text.secondary},children:"approved"===a?(0,J.jsx)(b().sA,{defaultMessage:"Approved by {grantedBy} on {resolvedTime}",id:"approveSpaceMembershipActivityAction.requestApprovedWithTime.title",values:{grantedBy:g,resolvedTime:(0,C().W_)(Math.min(l??1/0,Date.now()),"medium_with_time",(0,k().H)(o))}}):(0,J.jsx)(b().sA,{defaultMessage:"Denied by {grantedBy} on {resolvedTime}",id:"approveSpaceMembershipActivityAction.requestDenied.title",values:{grantedBy:g,resolvedTime:(0,C().W_)(Math.min(l??1/0,Date.now()),"medium_with_time",(0,k().H)(o))}})})}var ke=()=>i(125565),Ie=()=>i(68263),Be=()=>i(310442),Ke=()=>i(848259),Te=()=>i(579627),qe=()=>i(246826),Ne=()=>i(731320),Pe=()=>i(963575),Le=()=>i(351360),De=()=>i(715392),ze=()=>i(12296),Ue=()=>i(912913);const We=i(757695).default.createClass(void 0,{name:"RoleStore"});const Oe=function(e){const{accessRequestStore:t,targetBlockStore:i,notification:o,initialRole:r,rootStore:s,activity:a,tabArgs:l}=e,d=(0,n().uB)(void 0,We),c=(0,n().K8)((()=>t.getValue()),[t]),u=(0,n().K8)((()=>i.canAdmin()),[i]);return c?(0,p().z)(c)?(0,J.jsx)(et,{accessRequestStore:t,accessRequestValue:c}):u?(0,J.jsx)(Ze,{accessRequestStore:t,notification:o,targetBlockStore:i,initialRole:r,roleStore:d,accessRequestValue:c,rootStore:s,activity:a,tabArgs:l}):null:null};function Ee(){const e=(0,u().IS)((e=>({banner:{borderRadius:Pe().A.borderRadius,padding:"5px 8px",background:e.accentColors.yellow[50],marginBottom:12,fontSize:S().J.UISmall.desktop,lineHeight:S().K_.UISmall.desktop,fontWeight:S().Wy.regular,color:e.accentColors.yellow[500]}})),[]);return(0,J.jsx)("div",{style:e.banner,children:(0,J.jsx)(b().sA,{defaultMessage:"Make sure you trust this external user before sharing any content",id:"grantPageAccessActivityAction.externalWarning"})})}function Fe(e,t){const i=e.getValue();if(!i)return;const o=t.getPermissionItems();for(const r of o){if(i.for_actor_table===y().oo&&(0,Ie().B2)(r)&&r.user_id===i.for_actor_id)return r;if(i.for_actor_table===Se().GP&&(0,Ie().P3)(r)&&r.bot_id===i.for_actor_id)return r}}function Ve(e){return{tab:Ke().jD(),activityId:null==e?void 0:e.activity_id,notificationId:null==e?void 0:e.id}}function He(e,t){const i={height:26,paddingLeft:8,paddingRight:8,boxShadow:t.shadow2XS,fontSize:12,marginRight:10};return e?i:{...i,color:t.text.primary,fontWeight:500}}function $e(e){const{notification:t,accessRequestStore:i,activity:o,tabArgs:n}=e,s=(0,r().v3)();return t?t.visited?null:(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{isGray:!0,size:"xs",onClick:e=>{(0,ze().jU)({...n,environment:s,activity:o}),function(e,t,i,o){o&&(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{N().createAndCommit({userAction:"GrantPageAccessActivityAction.handleArchive",environment:i,canUndo:!0,perform:e=>{T().s4({notification:o,rootStore:t,transaction:e})}});const e=t.id,r=Ve(o);Ae().Fs(i,{...r,requestId:e})}})}(e,i,s,t)},style:{height:26,paddingLeft:8,paddingRight:8},children:(0,J.jsx)(b().sA,{defaultMessage:"Deny",id:"grantPageAccessActivityAction.ignoreButton.label.deny"})})}):null}function Ge(e,t,i,o){const r=Fe(e,t),n=r&&r.role;return o.state||n||i}function Ye(e,t,i,o,r){var n;const s=function(e,t,i,o){const r=e.getValue();if(r)return r.for_actor_table===y().oo?{type:"user_permission",user_id:r.for_actor_id,role:Ge(e,t,i,o)}:r.for_actor_table===Se().GP?{type:"bot_permission",bot_id:r.for_actor_id,role:Ge(e,t,i,o)}:void(r.for_actor_table!==Be().yj&&(0,x().HB)(r.for_actor_table))}(t,i,o,r);if(!s)return{};if(Fe(t,i))return{permissionItem:s};const a=null===(n=Le().default.getState().currentSpaceStore)||void 0===n?void 0:n.id;if(!a)return{};if("user_permission"===s.type){const i=De().W.getData(e,{userId:s.user_id,spaceId:a});if(i&&"none"!==i.membership_type){return{type:"existingUser",value:t.getRecordModel({table:y().oo,id:s.user_id}),permissionItem:s}}return{permissionItem:s}}if("bot_permission"===s.type){const e=t.getRecordModel({table:Se().GP,id:s.bot_id}),i=a&&a===(null==e?void 0:e.space_id)&&e.alive;return e&&!i?{type:"bot",value:e,permissionItem:s}:{permissionItem:s}}(0,x().HB)(s)}function Qe(e,t,i){if(e===y().oo){const o=i.getRecordModel({table:e,id:t});if(o)return(0,xe().A7)(o)}if(e===Se().GP){const o=i.getRecordModel({table:e,id:t});if(o)return(0,xe().qt)(o)}}async function Xe(e,t,i,o,r,n,s,a){if(o.getKeyStore("for_actor_table").getValue()!==y().oo)return;const l=o.getKeyStore("for_actor_id").getValue(),d=(0,Ne().zt)({userId:l,store:i}).role,c=Ye(t,o,i,r,n);if(!("permissionItem"in c))return;a&&(c.permissionItem.role=a);const u=t.currentUser.id;if(u){if("type"in c&&!a){let e;if("existingUser"===c.type){e=(await Te().eP({environment:t,store:i,inviteTargets:[c],inviteRole:c.permissionItem.role,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else if("bot"===c.type){e=(await Te().eP({environment:t,store:i,inviteTargets:[c],inviteRole:void 0,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else(0,x().HB)(c);if(!e)return}(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{N().createAndCommit({userAction:"GrantPageAccessActivityAction.handleGrantPageAccess",environment:t,canUndo:!0,perform:e=>{"type"in c||Te().zP({environment:t,transaction:e,store:i,permissionItems:[c.permissionItem]}),s&&T().ZB({notification:s,rootStore:i,transaction:e,read:!0}),qe().zv({store:o,transaction:e,data:{granted_time:Date.now(),granted_by_table:y().oo,granted_by_id:u,resolved_time:Date.now(),resolved_by_table:y().oo,resolved_by_id:u,status:"approved"}})}});const e=o.isDefined(),r=o.id,n=o.getKeyStore("created_time").getValue(),a=o.getKeyStore("resolved_time").getValue(),l=e&&n&&a?a-n:void 0;Ae().qI(t,{requestId:r,timeElapsedSinceRequest:l,newAccessLevel:c.permissionItem.role,prevAccessLevel:d,...Ve(s)})}})}}function Je(e){const{table:t,id:i,accessRequestStore:o}=e,r=(0,n().K8)((()=>{const e=K().oE([Qe(t,i,o)]);return(0,c().bD)(e,{...(0,R()._m)()})}),[t,i,o]);return(0,J.jsx)(J.Fragment,{children:r})}function Ze(e){const{accessRequestValue:t,accessRequestStore:i,notification:s,targetBlockStore:a,initialRole:l,roleStore:d,rootStore:c,activity:g,tabArgs:m}=e,f=(0,u().DP)(),x=(0,r().v3)(),S=(0,o.useCallback)((e=>function(e,t,i,o,r){const n=i.id,s=o.state;o.setState(e),Ae().Sd(t,{requestId:n,previousAccessLevel:s,newAccessLevel:e,...Ve(r)})}(e,x,i,d,s)),[x,i,d,s]),A=t.parent_table===h().NX,_=(0,n().K8)((()=>Fe(i,a)),[i,a]),M=(0,n().K8)((()=>Ge(i,a,l,d)),[i,a,l,d]),R=(0,p().HH)(t),w=(0,n().K8)((()=>(0,j().t)(t,c)),[t,c]),C=(0,n().K8)((()=>a.getType()),[a]);if(_&&!A){const e=(0,J.jsx)(Je,{accessRequestStore:i,table:t.for_actor_table,id:t.for_actor_id}),o=_.role===M;if(!R||R&&(0,Ie().p2)(_.role))return(0,J.jsxs)(J.Fragment,{children:[R?(0,J.jsx)(ke().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginBottom:6},children:(0,J.jsx)(b().sA,{defaultMessage:"{requestingUser} already has edit access.",id:"grantPageAccessActivityAction.alreadyHasEditAccess.label",values:{requestingUser:e}})}):(0,J.jsx)(ke().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginBottom:6},children:(0,J.jsx)(b().sA,{defaultMessage:"{requestingUser} already has access.",id:"grantPageAccessActivityAction.alreadyHasAccess.label",values:{requestingUser:e}})}),(0,J.jsx)(ee,{children:(0,J.jsx)(Ue().Ay,{upgradeButtonName:"user_permission_item",role:M,table:v().ev,blockType:C,type:t.for_actor_table===y().oo?"user_permission":"bot_permission",onChange:S,isInvite:!0,buttonStyle:He(!0,f)})}),(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{isGray:!0,size:"xs",onClick:e=>Xe(e,x,a,i,l,d,s),style:He(o,f),children:(0,J.jsx)(b().sA,{defaultMessage:"Change",id:"grantPageAccessActivityAction.changePermissionButton.label"})})}),(0,J.jsx)($e,{notification:s,accessRequestStore:i,activity:g,tabArgs:m})]})}return(0,J.jsxs)(J.Fragment,{children:[w&&(0,J.jsx)(Ee,{}),(0,J.jsx)(ee,{children:!R&&(0,J.jsx)(Ue().Ay,{upgradeButtonName:"user_permission_item",role:M,table:v().ev,blockType:C,type:t.for_actor_table===y().oo?"user_permission":"bot_permission",onChange:S,isInvite:!0,buttonStyle:He(!1,f)})}),(0,J.jsx)(ee,{children:R?(0,J.jsx)(ye().p,{isGray:!0,size:"xs",onClick:e=>{s&&(0,ze().hx)({...m,environment:x,activity:g}),Xe(e,x,a,i,l,d,s,"read_and_write")},style:He(!1,f),children:(0,J.jsx)(b().sA,{defaultMessage:"Approve",id:"grantPageAccessActivityAction.grantEditAccessButton.label.approve"})}):(0,J.jsx)(ye().p,{isGray:!0,size:"xs",onClick:e=>{s&&(0,ze().hx)({...m,environment:x,activity:g}),Xe(e,x,a,i,l,d,s)},style:He(!1,f),children:(0,J.jsx)(b().sA,{defaultMessage:"Approve",id:"grantPageAccessActivityAction.grantAccessButton.label.approve"})})}),(0,J.jsx)($e,{notification:s,accessRequestStore:i,activity:g,tabArgs:m})]})}function et(e){const{accessRequestValue:t,accessRequestStore:i}=e,o=(0,b().tz)(),r=(0,u().DP)(),n=(0,J.jsx)(Je,{accessRequestStore:i,table:t.granted_by_table,id:t.granted_by_id}),s=(0,C().W_)(Math.min(t.granted_time,Date.now()),"medium_with_time",(0,k().H)(o));return(0,J.jsx)("div",{style:{fontSize:12,color:r.text.secondary},children:(0,J.jsx)(b().sA,{defaultMessage:"Approved by {grantedBy} on {time}",id:"grantPageAccessActivityAction.accessGrantedWithTime.title",values:{grantedBy:n,time:s}})})}var tt=()=>i(77179),it=()=>i(360137),ot=()=>i(423213);function rt(e){var t;const i=(null===(t=e.profileEmail)||void 0===t?void 0:t.charAt(0).toUpperCase())??"?",o=(0,u().IS)((e=>({circleStyle:{width:20,height:20,borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",borderColor:e.UIUserAvatarIdleOutline,borderWidth:1,borderStyle:"solid",marginRight:6},letterStyle:{color:e.text.secondary,fontWeight:S().Wy.medium,fontSize:12}})),[]);return(0,J.jsx)("div",{style:o.circleStyle,children:(0,J.jsx)("span",{style:o.letterStyle,children:i})})}function nt(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:g,source:h}=o,f=(0,r().v3)(),y=(0,n().K8)((()=>t.getEdits()),[t]),b=y[0],x=(0,u().IS)((()=>({message:{marginBottom:8},messageLabel:{whiteSpace:"pre-wrap"},titleStyle:{fontSize:14,display:"flex"}})),[]),S=(0,n().K8)((()=>w().v3.createChildStore(i,{table:p().O,id:t.access_request_id})),[t,i]),A=(0,n().K8)((()=>S.getModel()),[S]),_=(0,n().K8)((()=>Boolean(A&&(0,j().t)(A,i))),[A,i]),R=A&&(0,J.jsx)(at,{activity:t,accessRequest:A,rootStore:i,tabArgs:o}),C=b.message,k=(0,n().K8)((()=>(0,c().Ln)({edits:y,rootStore:i})),[y,i]),I=(0,n().K8)((()=>{if(null!=A&&A.isGuestInviteRequest()){const e=A.getAttributes().permission_records_and_roles[0],r=e&&w().Bv.createChildStore(i,{table:v().ev,id:e.id}),n=e.role;if(r.isDefined())return;return(0,J.jsx)(ot().A,{titledRecordStore:r,activity:t,tabArgs:o,getRecordModel:i.getRecordModel,permissionRole:n,shouldRenderEmpty:!0})}}),[o,A,t,i]),B=(0,n().K8)((()=>{if(t.navigable_block_id)return w().Bv.createChildStore(i,{table:v().ev,id:t.navigable_block_id})}),[t,i]),K=(0,n().K8)((()=>{if(!B)return;const e=B.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().y8.Notification}):void 0}),[B,i,t]),T=(0,M().I)({spaceStore:i,request:A}),q=(0,d().X)("workspace_member_access_notif_polish");return R?(0,J.jsxs)(fe,{header:(0,J.jsx)("span",{children:R}),isFirst:s,isLast:a,isPrivate:!1,rootStore:i,notification:l,icon:(0,J.jsx)(tt().H8,{authors:k,size:oe,style:{marginTop:0,marginRight:0},iconStyle:{right:-3},showAvatarShadow:!1,showWarningIcon:_}),showSnapshotButton:!1,url:K,...(0,ze().$5)({notification:l,activity:t,environment:f,tab:g}),children:[q&&"space_membership_request"===T&&(0,J.jsx)(st,{rootStore:i,accessRequestModel:A}),C&&(0,J.jsx)("div",{style:x.message,children:(0,J.jsx)(ke().A,{isMultiline:!0,style:x.messageLabel,children:C})}),I&&(0,J.jsx)("div",{style:x.titleStyle,children:I}),(0,J.jsx)(gt,{activity:t,accessRequestStore:S,rootStore:i,source:h,notification:l,tabArgs:o})]}):null}function st(e){const{rootStore:t,accessRequestModel:i}=e,o=(0,n().K8)((()=>i.getForActorId()===i.getCreatedById()),[i]),r=(0,n().K8)((()=>i.getForActorPointer(t.id)),[i,t.id]),s=r.table===y().oo?w().LU.createChildStore(t,r):void 0,a=(0,n().K8)((()=>null==s?void 0:s.getModel()),[s]),l=(0,n().K8)((()=>null==a?void 0:a.getEmail()),[a]),d=(0,n().K8)((()=>{if(!o)return l;const e=null==a?void 0:a.getFullName(_().A.getIntl());return e?`${e} (${l})`:l}),[o,a,l]),c=(0,u().IS)((()=>({inviteeBox:{display:"flex",alignItems:"center",marginBottom:8},inviteePhrase:{fontWeight:S().Wy.medium,fontSize:14}})),[]);return(0,J.jsxs)("div",{style:c.inviteeBox,children:[(0,J.jsx)(rt,{profileEmail:d}),(0,J.jsx)("span",{style:c.inviteePhrase,children:d})]})}function at(e){const{activity:t,accessRequest:i,rootStore:o,tabArgs:r}=e,n=(0,M().I)({spaceStore:o,request:i});if(!n)return null;switch(n){case"guest_invite_request":return(0,J.jsx)(ct,{activity:t,accessRequest:i,rootStore:o});case"space_membership_request":return(0,J.jsx)(dt,{activity:t,accessRequest:i,rootStore:o});case"team_membership_request":return(0,J.jsx)(ut,{activity:t,rootStore:o,tabArgs:r});case"page_access_request":return(0,J.jsx)(lt,{activity:t,tabArgs:r,rootStore:o,accessRequest:i});default:(0,x().HB)(n)}}function lt(e){const{activity:t,rootStore:i,accessRequest:o}=e,r=(0,n().K8)((()=>t.getEdits()),[t]),s=(0,n().K8)((()=>{const e=o.getForActorPointer(i.id),t=e.table===y().oo?w().LU.createChildStore(i,e):void 0,r=null==t?void 0:t.getModel();return null==r?void 0:r.getEmail()}),[o,i]),a=(0,n().K8)((()=>Boolean(o&&(0,j().t)(o,i))),[o,i]),l=(0,n().K8)((()=>(0,c().Ln)({edits:r,rootStore:i})),[r,i]),d=(0,n().K8)((()=>a&&s?(0,c().Jd)(s,(0,R()._m)()):(0,c().bD)(l,(0,R()._m)())),[a,s,l]),u=(0,n().K8)((()=>{if(t.navigable_block_id)return w().Bv.createChildStore(i,{table:v().ev,id:t.navigable_block_id})}),[t,i]),g=(0,n().K8)((()=>o.isEditPageAccessRequest()),[o]);return u?g?(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested edit access to} other {{authorOrAuthors} requested edit access to}}",values:{numberOfAuthors:l.length,authorOrAuthors:d},id:"activity.editAccessRequested.header.short"}):(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to} other {{authorOrAuthors} requested access to}}",values:{numberOfAuthors:l.length,authorOrAuthors:d},id:"activity.accessRequested.header.short"}):null}function dt(e){const{activity:t,accessRequest:i,rootStore:o}=e,r=(0,u().IS)((()=>({inviteePhrase:{fontWeight:S().Wy.semibold}})),[]),s=(0,n().K8)((()=>t.getEdits()),[t]),a=(0,n().K8)((()=>i.getForActorPointer(o.id)),[i,o.id]),l=a.table===y().oo?w().LU.createChildStore(o,a):void 0,g=(0,n().K8)((()=>null==l?void 0:l.getModel()),[l]),m=(0,n().K8)((()=>null==g?void 0:g.getEmail()),[g]),p=(0,n().K8)((()=>i.getForActorId()===i.getCreatedById()),[i]),v=(0,n().K8)((()=>(0,c().Ln)({edits:s,rootStore:o})),[s,o]),h=(0,n().K8)((()=>(0,c().bD)(v,(0,R()._m)())),[v]),f=(0,n().K8)((()=>{if(!p)return m;const e=null==g?void 0:g.getFullName(_().A.getIntl());return e?`${e} (${m})`:m}),[p,g,m]),x=(0,d().X)("workspace_member_access_notif_polish");return g&&a.table===y().oo?p?(0,J.jsx)(b().sA,{defaultMessage:"{invitee} requested to become a workspace member",values:{invitee:(0,J.jsx)("span",{style:r.inviteePhrase,children:f})},id:"activity.accessRequestedMembershipFromGuest.header"}):x?(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested to add a workspace member} other {{authorOrAuthors} requested to add workspace members}}",values:{numberOfAuthors:v.length,authorOrAuthors:h},id:"activity.accessRequestedMembershipNoInvitee.header.short"}):(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested to add {invitee} as a workspace member} other {{authorOrAuthors} requested to add {invitee} as a workspace member}}",values:{numberOfAuthors:v.length,authorOrAuthors:h,invitee:(0,J.jsx)("span",{style:r.inviteePhrase,children:f})},id:"activity.accessRequestedMembership.header.short"}):null}function ct(e){const{activity:t,accessRequest:i,rootStore:o}=e,r=(0,n().K8)((()=>t.getEdits()),[t]),s=(0,u().IS)((()=>({inviteePhrase:{fontWeight:S().Wy.semibold}})),[]),a=(0,n().K8)((()=>i.getForActorPointer(o.id)),[i,o.id]),l=a.table===y().oo?w().LU.createChildStore(o,a):void 0,d=(0,n().K8)((()=>null==l?void 0:l.getModel()),[l]),g=(0,n().K8)((()=>null==d?void 0:d.getEmail()),[d]),m=(0,n().K8)((()=>(0,c().Ln)({edits:r,rootStore:o})),[r,o]),p=(0,n().K8)((()=>(0,c().bD)(m,{...(0,R()._m)()})),[m]);return(0,n().K8)((()=>i.isGuestInviteRequest()),[i])&&d&&a.table===y().oo?(0,J.jsx)(b().sA,{defaultMessage:"{requestorsPhrase} requested inviting {guestEmail} as a guest",values:{requestorsPhrase:p,guestEmail:(0,J.jsx)("span",{style:s.inviteePhrase,children:g})},id:"activity.guestInviteRequest.header.short"}):null}function ut(e){const{activity:t,rootStore:i,tabArgs:o}=e,r=(0,n().K8)((()=>t.getEdits()),[t]),s=(0,n().K8)((()=>(0,c().Ln)({edits:r,rootStore:i})),[r,i]),a=(0,n().K8)((()=>(0,c().bD)(s,{...(0,R()._m)()})),[s]),l=(0,n().K8)((()=>{if(t.team_id)return w().h4.createChildStore(i,{table:f().yK,id:t.team_id})}),[t,i]);return r&&l?(0,J.jsx)(b().sA,{defaultMessage:"{user} requested to join {teamName}",values:{user:(0,J.jsx)("span",{style:{fontWeight:S().Wy.semibold},children:a}),teamName:(0,J.jsx)(ot().A,{titledRecordStore:l,getRecordModel:i.getRecordModel,activity:t,tabArgs:o})},id:"activity.teamAccessRequest.header.short"}):null}function gt(e){const{activity:t,accessRequestStore:i,rootStore:s,notification:a,tabArgs:l}=e,d=(0,r().v3)(),c=(0,n().K8)((()=>t.getEdits()),[t])[0],m=(0,n().K8)((()=>i.getParentTable()),[i]),p=(0,n().K8)((()=>i.getParentId()),[i]),y=(0,n().K8)((()=>t.navigable_block_id),[t]),b=(0,n().K8)((()=>i.getModel()),[i]),S=(0,n().K8)((()=>b&&(0,g().C)(b)),[b]),j=(0,M().I)({spaceStore:s,request:b}),_=(0,n().K8)((()=>{if("page_access_request"===S){var e;const t=null==b||null===(e=b.getAttributes())||void 0===e||null===(e=e.permission_records_and_roles)||void 0===e||null===(e=e.at(0))||void 0===e?void 0:e.role;if(t)return t}return"reader"}),[b,S]),R=(0,o.useCallback)((async()=>{if(S&&j&&b)if("space_membership_request"===j&&"space_membership_request"===S)await A().p4({status:"approved",environment:d,requests:[b],store:s,from:"notification"});else if("space_membership_request"===j&&"guest_invite_request"===S)await A().KB({status:"approved",environment:d,store:s,requests:[b],from:"notification"});else{if("guest_invite_request"!==S)return;await A().aV({status:"approved",environment:d,requests:[b],from:"notification"})}}),[d,b,s,j,S]),C=(0,o.useCallback)((async()=>{if(S&&b)if("space_membership_request"===S)await A().p4({status:"rejected",environment:d,requests:[b],store:s,from:"notification"});else if("guest_invite_request"===S)await A().aV({status:"rejected",environment:d,requests:[b],from:"notification"});else{if("team_membership_request"===S||"page_access_request"===S)return;(0,x().HB)(S)}}),[d,b,s,S]),k=(0,u().IS)((e=>({actionPrimaryContainer:{paddingTop:4,paddingBottom:0,paddingRight:0},actionButton:(0,it().Ei)(e)})),[]),I=y?w().Bv.createChildStore(s,{table:v().ev,id:y}):void 0,B=(0,n().K8)((()=>m===v().ev&&Boolean(null==I?void 0:I.canAdmin())),[m,I]);if(!(m&&p&&j&&c))return null;if("page_access_request"===j)return B&&I?(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Oe,{accessRequestStore:i,targetBlockStore:I,initialRole:_,buttonStyle:k.actionButton,notification:a,rootStore:s,activity:t,tabArgs:l})}):null;if("space_membership_request"===j||"guest_invite_request"===j){const e=w().SL.createChildStore(s,{table:h().NX,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Me,{effectiveAccessRequestType:j,accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:k.actionButton,notification:a,onApprove:R,onReject:C})})}if("team_membership_request"===j){const e=w().h4.createChildStore(s,{table:f().yK,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(be,{accessRequestStore:i,teamStore:e})})}(0,x().HB)(j)}const mt=o.memo(nt);function pt(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d}=o,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),h=(0,n().K8)((()=>w().v3.createChildStore(i,{table:p().O,id:t.access_request_id})),[t,i]),f=(0,n().K8)((()=>{const e=h.getModel();return e&&e.isGuestInviteRequest()&&e.isResolved()||e&&e.isEditPageAccessRequest()&&e.isApproved()?e:void 0}),[h]),y=(0,n().K8)((()=>Boolean(null==f?void 0:f.isEditPageAccessRequest())),[f]),b=(0,n().K8)((()=>(0,c().Ln)({edits:g,rootStore:i})),[g,i]),x=(0,n().K8)((()=>{if(t.navigable_block_id)return w().Bv.createChildStore(i,{table:v().ev,id:t.navigable_block_id})}),[t,i]),S=f&&(0,J.jsx)(vt,{activity:t,accessRequest:f,rootStore:i,isEditAccessRequest:y}),A=(0,n().K8)((()=>{if(!x)return;const e=x.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().y8.Notification}):void 0}),[x,i,t]);return S&&x?(0,J.jsx)(fe,{header:(0,J.jsx)("span",{children:S}),isFirst:s,isLast:a,isPrivate:!1,rootStore:i,notification:l,icon:(0,J.jsx)(tt().H8,{authors:b,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:A,...(0,ze().$5)({notification:l,activity:t,environment:u,tab:d})}):null}function vt(e){const{accessRequest:t,rootStore:i,isEditAccessRequest:o}=e,r=(0,u().IS)((()=>({inviteePhrase:{fontWeight:S().Wy.medium}})),[]),s=(0,n().K8)((()=>i.getRecordModel({id:t.getForActorId(),table:t.getForActorTable()})),[t,i]),a=(0,n().K8)((()=>null==s?void 0:s.getEmail()),[s]),l=(0,n().K8)((()=>{const e=(null==s?void 0:s.isUser())&&(null==s?void 0:s.getFullName(_().A.getIntl()));return e?`${e} (${a})`:a}),[s,a]),d=(0,n().K8)((()=>i.getRecordModel({id:t.getResolvedById(),table:t.getResolvedByTable()})),[t,i]),g=(0,n().K8)((()=>d&&(0,c().bD)([d],{fontWeight:S().Wy.medium})),[d]),m=(0,n().K8)((()=>t.getStatus()),[t]);return g&&l?o?(0,J.jsx)(b().sA,{defaultMessage:"{resolverPhrase} approved your request to edit the page",values:{resolverPhrase:g},id:"activity.EditAccessRequestResolvedMembership.approved.header.short"}):"approved"===m?(0,J.jsx)(b().sA,{defaultMessage:"{resolverPhrase} approved your request to invite {invitee} as a guest",values:{resolverPhrase:g,invitee:(0,J.jsx)("span",{style:r.inviteePhrase,children:l})},id:"activity.AccessRequestResolvedMembership.approved.header.short"}):"rejected"===m?(0,J.jsx)(b().sA,{defaultMessage:"{resolverPhrase} denied your request to invite {invitee} as a guest",values:{resolverPhrase:g,invitee:(0,J.jsx)("span",{style:r.inviteePhrase,children:l})},id:"activity.AccessRequestResolvedMembership.rejected.header.short"}):void(0,x().HB)(m):null}const ht=o.memo(pt);var ft=i.n(i(842838)),yt=i.n(i(42833)),bt=i.n(i(542922)),xt=()=>i(46220),St=()=>i(693954),At=()=>i(128713),jt=()=>i(145820),_t=()=>i(498212),Mt=()=>i(435009),Rt=()=>i(492414),wt=()=>i(864943);const Ct=(0,b().YK)({errorTitle:{id:"appBuilderNotificationActivityError.formattedHeaderMessage.errorTitle",defaultMessage:"A workflow run has failed {numWorkflows, plural, one {} other {{numWorkflows} times}}"},errorButton:{id:"appBuilderNotificationActivityError.formattedHeaderMessage.errorButton",defaultMessage:"View {numWorkflows, plural, one {} other {last}} failed run"},actionTitle:{id:"appBuilderNotificationActivityError.formattedHeaderMessage.actionTitle",defaultMessage:"{workflowName} has sent you a message"},actionButton:{id:"appBuilderNotificationActivityError.formattedHeaderMessage.actionButton",defaultMessage:"View run"},customActionTitle:{id:"appBuilderNotificationActivityError.formattedHeaderMessage.customActionTitle",defaultMessage:"From {workflowName}: {customTitle}"},defaultWorkflowName:{id:"appBuilderNotificationActivityError.defaultWorkflowName",defaultMessage:"An App"}});function kt(e){const{rootStore:t,activity:s,isLast:a,tabArgs:l,isFirst:d}=e,{tab:c,notification:g}=l,p=(0,r().v3)(),h=(0,n().K8)((()=>s.getEdits()),[s]),f=h.at(0),y=(0,b().tz)(),A=(0,n().K8)((()=>{if((0,x().O9)(f))return w().NU.createChildStore(t,{table:i(743246).C0,id:f.workflow_id,spaceId:t.getSpaceId()}).getData()}),[t,f]),{handleNavigateToAutomationRun:j,workflowRunUrl:_,navigableBlockStore:M,navigableBlockUrl:R}=function(e){let{edit:t,rootStore:i}=e;const o=(0,r().v3)(),s=(0,n().K8)((()=>{if((0,x().O9)(t)&&t.automation_run_id)return w().ty.createChildStore(i,{table:jt().QR,id:t.automation_run_id,spaceId:i.getSpaceId()})}),[i,t]),a=(0,n().K8)((()=>{if((0,x().O9)(t)&&t.navigable_block_id)return new(w().Bv)(o,{id:t.navigable_block_id,table:v().ev})}),[t,o]),l=(0,n().K8)((()=>{if(!(0,x().O9)(a))return!0;const e=a.getRole();return!e||!(0,Ie().Tt)(e)}),[a]),d=(0,n().K8)((()=>{if((0,x().O9)(a))return(0,Rt().Ay)({store:a,preferPublicLink:!1,pageVisitSource:m().y8.Notification})}),[a]),c=(0,n().K8)((()=>{if(l||!(0,x().O9)(t))return;if(t.workflow_url)return t.workflow_url;const e=(0,x().O9)(s)?`&wfv=runs&t=new&wfk=${(0,_t().Xw)(s.id)}`:"&wfv=runs&t=new";return`${d}${e}`}),[s,t,l,d]),u=(0,n().K8)((()=>()=>{a&&d&&c&&Mt().oo({environment:o,url:c})}),[o,a,d,c]);return{handleNavigateToAutomationRun:u,navigableBlockStore:a,navigableBlockUrl:d,workflowRunUrl:c}}({edit:f,rootStore:t}),C=(0,u().IS)((e=>({viewButton:{marginTop:8,height:26,fontWeight:S().Wy.medium},bodyContainer:{fontSize:ue,lineHeight:S().K_.UIRegular.desktop,wordBreak:"break-word"},headerName:{fontWeight:S().Wy.medium,display:"inline-flex"}})),[]),k=(0,u().eP)(),I=(0,o.useCallback)((e=>{(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{N().createAndCommit({userAction:"AutomationTypecheckErrorRaisedActivity.viewError",environment:p,canUndo:!0,perform:e=>{T().ZB({notification:g,rootStore:t,transaction:e,read:!0})}}),j(),Ke().K4({tab:c,notificationId:null==g?void 0:g.id,environment:p,alreadyRead:Boolean(null==g?void 0:g.read),activity:s})}})}),[s,p,j,g,t,c]);if(!f)return null;const B=(0,J.jsx)("div",{style:C.headerName,children:(null==A?void 0:A.name)||y.formatMessage(Ct.defaultWorkflowName)});return(0,J.jsx)(fe,{header:"workflow-error"===f.app_builder_notification_type?(0,J.jsx)(b().sA,{...Ct.errorTitle,values:{numWorkflows:h.length}}):f.header_content?(0,J.jsx)(b().sA,{...Ct.customActionTitle,values:{workflowName:B,customTitle:f.header_content}}):(0,J.jsx)(b().sA,{...Ct.actionTitle,values:{workflowName:B}}),isFirst:d,isLast:a,isPrivate:!1,rootStore:t,notification:g,icon:(0,J.jsx)(It,{workflowName:(null==A?void 0:A.name)||"W",notificationType:f.app_builder_notification_type}),showSnapshotButton:!1,navigableBlockId:null==M?void 0:M.id,url:"workflow-error"===f.app_builder_notification_type?_:R,...(0,ze().$5)({notification:g,activity:s,environment:p,tab:c}),children:"workflow-error"===f.app_builder_notification_type?(0,J.jsx)("div",{children:(0,J.jsx)(wt().A,{style:C.viewButton,onClick:I,size:"sm",children:(0,J.jsx)(b().sA,{...Ct.errorButton,values:{numWorkflows:h.length}})})}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{className:"dark"===k?"app-builder-notification-activity--dark":"app-builder-notification-activity--light",style:C.bodyContainer,dangerouslySetInnerHTML:{__html:ft().sanitize(Bt({markdown:f.body_content||""}))}}),(0,J.jsx)("div",{children:(0,J.jsx)(wt().A,{style:C.viewButton,onClick:I,size:"sm",children:(0,J.jsx)(b().sA,{...Ct.actionButton})})})]})})}function It(e){let{workflowName:t,notificationType:i}=e;const o=(0,u().IS)((e=>({icon:{fill:e.icon.uiRedPrimary,height:12,left:9,position:"absolute",top:14,width:12},firstLetter:{textTransform:"uppercase",color:e.text.secondary},workflowIcon:{color:e.text.secondary,padding:"3px"},wrapper:{position:"relative"}})),[]);return(0,J.jsx)(he,{children:(0,J.jsx)("div",{style:o.wrapper,children:"workflow-error"===i?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:o.firstLetter,children:t.charAt(0)}),(0,St().Q)(o.icon)]}):(0,xt().S)(o.workflowIcon)})})}function Bt(e){return At().uY({MarkdownIt:bt(),LinkifyIt:yt(),markdown:e.markdown})}i(517642),i(658004),i(733853),i(845876),i(432475),i(515024),i(731698),i(898992),i(354520),i(581454);var Kt=()=>i(278132),Tt=()=>i(912720),qt=()=>i(989423),Nt=()=>i(704152),Pt=()=>i(908006),Lt=()=>i(763824),Dt=()=>i(686526),zt=()=>i(837570),Ut=()=>i(799832);async function Wt(e){const{environment:t,automationNavigableBlockStore:i,automationId:o,source:r,rootStore:n}=e;await Pt().default.afterNextFlush();const s=await async function(e,t){const i=Date.now(),o=async()=>{const r=e();return void 0!==r?r:Date.now()-i>=t?void 0:(await(0,Lt().wR)(10),await o())};return await o()}((()=>(0,Ut().U)(i)),2e3);if(!s)return;const a=s.settingsStore;if(a)if(o){"event"===n.getRecordStore(n,{table:Tt().yB,id:o,spaceId:n.getSpaceId()}).getTriggerType()&&(Dt().Ow({collectionContextStore:s,collectionSettingsStore:a}),zt().h({environment:t,collectionContextStore:s,collectionSettingsStore:a,mode:"edit_automation",automationId:o,source:r}))}else Dt().Ow({collectionContextStore:s,collectionSettingsStore:a}),Dt().R8({collectionSettingsStore:a,item:{type:"automationSettings",source:r}})}function Ot(e){const{automationNames:t,handleAutomationNavigate:i}=e,o=(0,b().tz)(),r=t.at(0),n=t.length,s=n-2,a=o.formatList([...t.slice(0,2),s>0?o.formatMessage({defaultMessage:"{numRemainingAutomations} more",id:"AutomationTypecheckErrorRaisedActivity.wrappedAutomationName.tooltipNumRemainingAutomations"},{numRemainingAutomations:s}):void 0].filter(x().O9),{style:"long",type:"conjunction"}),l={defaultMessage:"{numAutomations, plural, one {{firstAutomationName}} other {{numAutomations} automations}}",values:{firstAutomationName:r,numAutomations:n},id:"AutomationTypecheckErrorRaisedActivity.wrappedAutomationName.automationName",description:"The display name for an automation."},d=e=>(0,J.jsx)(Nt().A,{...e,onClick:i,children:(0,J.jsx)(b().sA,{...l})});return 1===n?d():(0,J.jsx)(Y().A,{renderTooltip:e=>(0,J.jsx)("div",{...e,children:a}),render:e=>d(e)})}function Et(e){let{automationName:t}=e;const i=(0,u().IS)((e=>({icon:{fill:e.icon.uiRedPrimary,height:12,left:9,position:"absolute",top:14,width:12},firstLetter:{textTransform:"uppercase",color:e.text.secondary},wrapper:{position:"relative"}})),[]);return(0,J.jsx)(he,{children:(0,J.jsxs)("div",{style:i.wrapper,children:[(0,J.jsx)("div",{style:i.firstLetter,children:t.charAt(0)}),(0,St().Q)(i.icon)]})})}i(803949);var Ft=()=>i(107273),Vt=()=>i(921194);var Ht=()=>i(713998),$t=()=>i(400835),Gt=()=>i(413267),Yt=()=>i(161479),Qt=()=>i(191772),Xt=()=>i(774733),Jt=()=>i(902731),Zt=()=>i(105157),ei=()=>i(712030),ti=()=>i(921855),ii=()=>i(299545),oi=()=>i(477293),ri=()=>i(710648),ni=()=>i(296798),si=()=>i(256863),ai=()=>i(453697),li=()=>i(719147),di=()=>i(447587),ci=()=>i(331132);function ui(e){const{activity:t,tabArgs:i,rootStore:s,isFirst:d,isLast:u}=e,{source:g,tab:p,notification:h}=i,f=(0,n().K8)((()=>t.getEdits()),[t]);let y=f.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":case"suggestion-created":return!0;default:(0,x().HB)(e)}}));const b=(0,n().K8)((()=>"suggestion-created"===f[0].type),[f]);0===y.length&&0!==f.length&&(y=f);const A=y.length>0,j=(0,r().v3)(),_=(0,n().K8)((()=>{const e=s.getRecordStore(s,{table:l().$Y,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,s]),M=(0,n().K8)((()=>_?_.getCommentStores():[]),[_]),R=(0,n().K8)((()=>{const e=null==_?void 0:_.getParentPointer();if(e)return w().Bv.createChildStore(s,e)}),[_,s]),C=(0,n().K8)((()=>Boolean(R&&R.isDefined())),[R]),k="on"===(0,oi().r)("inbox_activity_split"),I=(0,n().K8)((()=>{const e=null==R?void 0:R.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,R]),B=w().Bv.createChildStore(s,{table:v().ev,id:I}),T=(0,n().K8)((()=>B.isDefined()),[B]),q=(0,n().K8)((()=>Boolean(!(null!=R&&R.pathIsDead()))),[R]),N=(0,n().K8)((()=>B.canComment()&&q&&!k),[q,B,k]),P=(0,n().K8)((()=>{var e;if(R)return null===(e=R.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:s.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().y8.Notification})}),[R,s,t]),L=(0,n().K8)((()=>(0,c().Ln)({edits:y,rootStore:s})),[y,s]),D=(0,n().K8)((()=>(0,K().hS)(M.map((e=>e.getCreatedByPointer())).filter(x().O9),"id").map((e=>w().sk.createChildStore(s,e)))),[M,s]),z=(0,n().K8)((()=>D.map((e=>e.getModel())).filter(x().O9)),[D]),{backActorStore:U,frontActorStore:W}=(0,n().K8)((()=>{const e=j.currentUser.id;return e?(0,c()._S)({authorStores:D,currentUserId:e}):{backActorStore:void 0,frontActorStore:void 0}}),[j.currentUser.id,D]),O=q,E=(0,o.useCallback)((e=>{if((0,ze().uY)({...i,environment:j,activity:t,mightCloseTab:O}),!q&&R&&_){var o;const r=e.target;Jt().IX({environment:j,discussionStore:_,rect:r.getBoundingClientRect(),blockStore:R,discussionLocation:yi({forReplyMenu:!0,source:i.source}),activityId:t.id,notificationId:null===(o=i.notification)||void 0===o?void 0:o.id})}}),[t,q,R,_,j,i,O]),F=(0,o.useCallback)((e=>{"Removed"===e?(0,ze().jv)({...i,environment:j,activity:t,mightCloseTab:O}):"Added"===e?(0,ze().P)({...i,environment:j,activity:t,mightCloseTab:O}):(0,x().HB)(e)}),[i,j,t,O]),V=(0,n().K8)((()=>(0,c().DU)({recordId:I,recordType:v().ev,tab:p,rootStore:s,environment:j})),[I,p,s,j]),H=(0,n().K8)((()=>yi({source:g,forReplyMenu:!1})),[g]),$=(0,n().K8)((()=>{const e=null==_?void 0:_.getModel();if(e)return(0,c().pN)(e)}),[_]);return A&&T&&C&&_?(0,J.jsxs)(fe,{header:(0,J.jsx)(bi,{authorCount:L.length,authorPhrase:(0,J.jsx)(ki,{authorsLength:D.length,frontActorStore:W,backActorStore:U,authorTextStyle:{fontWeight:S().Wy.medium}}),isSuggestionCreatedActivity:b}),isFirst:d,isLast:u,isPrivate:V,rootStore:s,navigableBlockId:I,notification:h,icon:W&&U?(0,J.jsx)(Ci,{frontActorStore:W,backActorStore:U}):z.length>0?(0,J.jsx)(tt().H8,{authors:z,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}):(0,J.jsx)(Ii,{}),showSnapshotButton:!1,url:P,...(0,ze().$5)({notification:h,environment:j,tab:p,activity:t}),children:[_&&$&&(0,J.jsx)(pi,{discussionStore:_,url:P,onClick:E,rootStore:s,source:g,isSuggestionCreatedActivity:b}),_&&(0,J.jsx)(ji,{discussionStore:_,discussionLocation:H,onReactionToggle:F}),N&&(0,J.jsx)(fi,{activity:t,rootStore:s,tabArgs:i,isSuggestionCreatedActivity:b}),_&&(0,J.jsx)(mi,{discussionStore:_})]}):(a().log({level:"warning",from:"CommentActivityNotification",type:"invalidNotificationData",data:{ids:[(null==h?void 0:h.id)??"unknown"]}}),null)}const gi=8;function mi(e){const{discussionStore:t}=e,i=(0,n().K8)((()=>t.getResolved()),[t]),o=(0,u().IS)((e=>({container:{display:"flex",alignItems:"center",gap:4,fontSize:12,color:e.text.secondary,marginTop:gi},icon:{height:12,width:12}})),[]);return i?(0,J.jsxs)("div",{style:o.container,children:[(0,Gt().b)(o.icon),(0,J.jsx)(b().sA,{id:"activity.commentActivity.commentStatusResolved",defaultMessage:"Resolved on the page"})]}):null}function pi(e){const{url:t,onClick:i,discussionStore:o,rootStore:r,isSuggestionCreatedActivity:s}=e,a=(0,u().IS)((e=>({linkbox:{display:"flex",alignItems:"center",fontSize:13,color:e.text.secondary,paddingTop:2,paddingBottom:8,marginBottom:0}})),[,]),l=(0,n().K8)((()=>o.getType()),[o]);return(0,J.jsx)(ni().A,{href:t,onClick:i,innerStyle:a.linkbox,disabled:!0,children:"suggestion"===l?!s&&(0,J.jsx)(Xt().c4,{discussionStore:o,collapsed:!1}):(0,J.jsx)(vi,{rootStore:r,discussionStore:o})})}function vi(e){const t=(0,r().v3)(),i=(0,u().DP)(),{rootStore:o,discussionStore:s}=e,a=(0,n().K8)((()=>{const e=s.getModel();if(e)return(0,c().pN)(e)}),[s]),l=(0,n().K8)((()=>{var e;const t=null==s||null===(e=s.getParentStore())||void 0===e?void 0:e.getParentStore();if(!t||"collection"!==t.table)return;const i=t.getSchema(),o=s.getPropertyId();return void 0!==o?(0,Ht()._g)({schema:i,property:o}):void 0}),[s]),d=(0,n().K8)((()=>(0,ti().S5)({environment:t,textValue:a?{value:a,spaceId:o.id}:void 0,parentStore:o,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,highlightDiscussionId:s.id,theme:i,emojiType:(0,ei().FN)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})),[t,a,o,s.id,i]);return a?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(ci().A,{}),l&&(0,J.jsx)(Zt().A,{propertySchema:l}),(0,J.jsx)("div",{style:S().RC,children:d})]}):null}const hi=8;function fi(e){const{activity:t,rootStore:i,tabArgs:s,isSuggestionCreatedActivity:a}=e,{source:d,notification:c,tab:g}=s,m=(0,n().K8)((()=>{const e=i.getRecordStore(i,{table:l().$Y,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,i]),p=(0,r().v3)(),h=(0,n().K8)((()=>w().sk.createChildStore(i,{table:l().$Y,id:t.discussion_id,spaceId:(0,Yt().e)(i.pointer.spaceId)})),[t,i]),f=(0,n().K8)((()=>null==m?void 0:m.getParentId()),[m]),y=(0,o.useCallback)((e=>{(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{if(!f)return;const o=w().Bv.createChildStore(i,{table:v().ev,id:f}),r=e.target,n=null==c?void 0:c.id;Jt().IX({environment:p,discussionStore:h,rect:r.getBoundingClientRect(),blockStore:o,discussionLocation:yi({forReplyMenu:!0,source:d}),activityId:t.id,notificationId:n}),"notifications_tab"===d&&Ke().ZP({environment:p,notificationId:n,alreadyRead:Boolean(null==c?void 0:c.read),activity:t,tab:g})}})}),[t,h,p,c,f,i,d,g]),x=(0,u().IS)((e=>({container:{paddingTop:hi},actionButton:(0,it().Ei)(e)})),[]);return!m||a?null:(0,J.jsx)("div",{style:x.container,children:(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{isGray:!0,size:"xs",onClick:y,style:x.actionButton,children:(0,J.jsx)(b().sA,{defaultMessage:"Reply",id:"activityNotification.replyButton.label"})})})})}function yi(e){const{forReplyMenu:t,source:i}=e;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${Ke().jD()}`}function bi(e){const{authorCount:t,authorPhrase:i,isSuggestionCreatedActivity:o}=e;return o?(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} suggested in} other {{authorOrAuthors} suggested in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.commentActivity.standardizedHeader.suggestion"}):(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in} other {{authorOrAuthors} commented in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.commentActivity.standardizedHeader"})}const xi=2,Si=10,Ai=4;function ji(e){const{discussionStore:t,discussionLocation:i,onReactionToggle:s}=e,a=(0,r().v3)(),[l,d]=(0,o.useState)(!1),c=(0,n().K8)((()=>{if(!t)return[];const e=t.getCommentStores();return"suggestion"===t.getType()?e.slice(1):e}),[t]),g=c.length-xi,m=g>0,p="on"===(0,oi().r)("inbox_activity_split"),v=1===c.length,h=(0,o.useCallback)((e=>{(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{d(!l),Ke().o1(a,{expand:!l,comments_count:c.length,discussion_id:t.id})}})}),[a,l,c.length,t.id]),f=(0,u().IS)((e=>({discussion:{display:"flex",flexDirection:"column",gap:Si},expandButton:{display:"flex",justifyContent:"start",alignItems:"center",gap:14,borderRadius:6,fontSize:12,padding:6,marginLeft:-6,marginTop:Ai-Si,marginBottom:Ai-Si,color:e.text.secondary,maxWidth:"fit-content",maxHeight:26}})),[]),y=l?void 0:v?4:3;if(v){const e=c[0];return(0,J.jsx)("div",{style:f.discussion,children:(0,J.jsx)(_i,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:s,maxLines:y,showAuthor:!1,onMore:h},e.id)})}if(p&&c.length>0){const e=c[c.length-1];return(0,J.jsx)("div",{style:f.discussion,children:(0,J.jsx)(_i,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:s,maxLines:y,showAuthor:!1,onMore:h},e.id)})}return(0,J.jsxs)("div",{style:f.discussion,children:[c.slice(0,1).map((e=>(0,J.jsx)(_i,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:s,maxLines:y,onMore:h},e.id))),m&&(0,J.jsx)(ee,{children:(0,J.jsx)(F().A,{style:f.expandButton,onClick:h,children:l?(0,J.jsx)(b().sA,{id:"CommentGroupingActivity.discussionThread.hidePreviousRepliesCount",defaultMessage:"Hide {previousRepliesCount} {previousRepliesCount, plural, one {comment} other {comments}}",values:{previousRepliesCount:g}}):(0,J.jsx)(b().sA,{id:"CommentGroupingActivity.discussionThread.showPreviousRepliesCount",defaultMessage:"{previousRepliesCount} {previousRepliesCount, plural, one {more comment} other {more comments}}",values:{previousRepliesCount:g}})})}),l&&c.slice(1,-1).map((e=>(0,J.jsx)(_i,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:s,maxLines:y,onMore:h},e.id))),c.slice(-1).map((e=>(0,J.jsx)(_i,{commentStore:e,discussionStore:t,discussionLocation:i,onReactionToggle:s,maxLines:y,onMore:h},e.id)))]})}function _i(e){const{commentStore:t,discussionStore:i,discussionLocation:s,onReactionToggle:a,maxLines:l,showAuthor:d=!0,onMore:c}=e,g=(0,r().Y0)(),[m,p]=(0,o.useState)(!1),h=(0,n().K8)((()=>{const e=t.getContent(),i=0===e.length;if(e||!i)return e.map((e=>{const i=w().sk.createChildStore(t,{table:v().ev,id:e,spaceId:t.getSpaceId()}).getValue();if(i)return(0,J.jsx)(ri().Ay,{blockValue:i,rootStore:t},e)})).filter(x().O9)}),[t]),f=(0,n().K8)((()=>w().Lk.getUserVisibleReactions(t).length>0),[t]),y=(0,n().K8)((()=>t.getLastEditedTime()>t.getCreatedTime()+100),[t]),A=!f&&g.isMobile,j=!A,_=(0,o.useCallback)((e=>{g.isMobile?e.preventDefault():p(!0)}),[g.isMobile]),M=(0,o.useCallback)((e=>{g.isMobile?e.preventDefault():p(!1)}),[g.isMobile]),R=(0,u().IS)((e=>({avatarCommentReactionBarContainer:{...!f&&!g.isMobile&&{position:"relative"}},avatarAndCommentContainer:{display:"flex",flexDirection:"column"},commentContainer:{display:"flex",justifyContent:"space-between",gap:6,flexGrow:1},commentClampContainer:{lineHeight:S().K_.UIRegular.desktop,color:e.accentColors.gray[500]},toggleOverflowButton:{color:e.accentColors.gray[500],fontSize:14},editedBadge:{fontSize:13,color:e.text.secondary,paddingLeft:4},reactionBarMobile:f?{marginTop:4}:{marginRight:-6},reactionBar:{...!f&&{position:"absolute",top:-2,right:-8,opacity:m?1:0,transition:`opacity ${de}`},...f&&{marginTop:4}},newReaction:{borderWidth:1,borderStyle:"solid",borderColor:g.isMobile?"transparent":e.stroke.primary,borderRadius:6,boxShadow:g.isMobile?"unset":"0px 2px 4px 0px rgba(22, 29, 27, 0.02)"}})),[g,f,m]),C=(0,o.useCallback)((e=>{e.preventDefault(),c(e)}),[c]);return(0,J.jsx)("div",{children:(0,J.jsxs)("div",{style:R.avatarCommentReactionBarContainer,onMouseEnter:_,onMouseLeave:M,children:[(0,J.jsxs)("div",{style:R.avatarAndCommentContainer,children:[d&&(0,J.jsx)("div",{children:(0,J.jsx)(Mi,{commentStore:t})}),(0,J.jsxs)("div",{style:R.commentContainer,dir:"auto",children:[(0,J.jsxs)(di().A,{style:R.commentClampContainer,maxLines:l,onMore:C,moreElement:(0,J.jsxs)(li().A,{style:R.toggleOverflowButton,disableUnderline:!0,hoverColor:"blue",children:["…"," ",(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{id:"commentActivityNotification.truncated.showMoreLabel",defaultMessage:"more"})})]}),children:[(0,J.jsx)(Ri,{discussionStore:i,commentStore:t}),h,y&&(0,J.jsx)("span",{style:R.editedBadge,children:(0,J.jsx)(b().sA,{id:"CommentGroupingActivity.discussionThreadComment.editedBadge",defaultMessage:"(edited)"})})]}),A&&(0,J.jsx)("div",{style:g.isMobile?R.reactionBarMobile:R.reactionBar,children:(0,J.jsx)(ee,{children:(0,J.jsx)(Xt().fj,{parentStore:t,discussionLocation:s,onReactionToggle:a,newReactionStyle:R.newReaction})})})]})]}),j&&(0,J.jsx)("div",{style:g.isMobile?R.reactionBarMobile:R.reactionBar,children:(0,J.jsx)(ee,{children:(0,J.jsx)(Xt().fj,{parentStore:t,discussionLocation:s,onReactionToggle:a,newReactionStyle:R.newReaction})})})]})})}function Mi(e){const{commentStore:t}=e,i=(0,r().v3)(),o=(0,b().tz)(),s=(0,n().K8)((()=>{const e=t.getCreatedByPointer();if(e)return w().sk.createChildStore(t,e)}),[t]),a=(0,n().K8)((()=>{if(s)return s.getDisplayName(o)}),[s,o]),l=(0,n().K8)((()=>!!s&&i.currentUser.id===s.id),[i,s]),d=(0,u().IS)((e=>({fullName:{fontWeight:S().Wy.regular,fontSize:12,lineHeight:"22px",color:e.text.secondary},you:{fontWeight:S().Wy.regular,fontSize:12,lineHeight:"22px",color:e.text.tertiary}})),[]);return l?(0,J.jsx)(b().sA,{id:"CommentGroupingActivity.discussionThreadComment.authorLabel",defaultMessage:"<author>{fullName}</author> <you>(You)</you>",values:{author:e=>(0,J.jsx)("span",{style:d.fullName,children:e}),fullName:a,you:e=>(0,J.jsx)("span",{style:d.you,children:e})}}):a?(0,J.jsx)("span",{style:d.fullName,children:a}):(0,J.jsx)("span",{style:d.fullName,children:(0,J.jsx)(b().sA,{id:"CommentGroupingActivity.discussionThreadComment.unknownAuthorLabel",defaultMessage:"Unknown author"})})}function Ri(e){const{discussionStore:t,commentStore:i}=e,o=(0,r().v3)(),s=(0,u().DP)(),a=(0,n().K8)((()=>ii().gp(i).getValue()),[i]),l=(0,n().K8)((()=>i.getSpaceId()),[i]),d=(0,n().K8)((()=>{if(!a||!l)return null;const e=(0,Qt().Eh)({textValue:a,currentUserId:o.currentUser.id,getRecordModel:t.getRecordModel,highlightStyle:"text_only"});return(0,ti().S5)({environment:o,textValue:{value:e,spaceId:l},parentStore:t,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableHover:!0,disabled:!0,theme:s,emojiType:(0,ei().FN)(o),katex:o.KatexStore.getKatex(),formulaValueTypes:[]})}),[o,t,s,a,l]),c=(0,u().IS)((e=>({commentText:{whiteSpace:"pre-wrap",wordBreak:"break-word",display:"inline",fontSize:14,color:e.text.primary,lineHeight:"22px"}})),[]);return(0,J.jsx)("span",{style:c.commentText,children:d})}const wi=20;function Ci(e){const{frontActorStore:t,backActorStore:i}=e,o=(0,u().IS)((()=>({container:{display:"grid",height:oe,width:oe},back:{gridColumn:1,gridRow:1,marginLeft:-3,marginTop:-3,maxWidth:wi,minWidth:wi},front:{gridColumn:1,gridRow:1,marginLeft:7,marginTop:7,maxWidth:wi,minWidth:wi}})),[]);return(0,J.jsxs)("div",{style:o.container,children:[(0,J.jsx)("div",{style:o.back,children:(0,J.jsx)(Bi,{size:wi,actorStore:i,avatar:void 0})}),(0,J.jsx)("div",{style:o.front,children:(0,J.jsx)(Bi,{size:wi,actorStore:t,avatar:void 0})})]})}function ki(e){const{authorsLength:t,frontActorStore:i,backActorStore:o,authorTextStyle:s}=e,a=(0,r().v3)(),l=(0,b().tz)(),d=a.currentUser.id,c=(0,n().K8)((()=>{if(i)return i.getDisplayName(l)}),[i,l]),u=(0,n().K8)((()=>{if(o)return o.getDisplayName(l)}),[o,l]),g={fontWeight:S().Wy.semibold,...s};return 0===t?(0,J.jsx)("span",{style:g,children:(0,J.jsx)(b().sA,{defaultMessage:"<b>Nobody</b>",id:"activitySection.authorPhraseInboxRedesign.forNoAuthors.label",values:{b:e=>(0,J.jsx)("span",{style:g,children:e})}})}):1===t&&i?i.id===d?(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"<b>You</b>",id:"activitySection.authorPhraseInboxRedesign.forOneAuthorCurrentUser.label",values:{b:e=>(0,J.jsx)("span",{style:g,children:e})}})}):(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhraseInboxRedesign.forOneAuthor.label",values:{author:c,b:e=>(0,J.jsx)("span",{style:g,children:e})}})}):2===t?o&&o.id===d?(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"<b>{frontActorName} and You</b>",id:"activitySection.authorPhraseInboxRedesign.forTwoAuthorsCurrentUser.label",values:{frontActorName:c,b:e=>(0,J.jsx)("span",{style:g,children:e})}})}):(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"<b>{frontActorName} and {backActorName}</b>",id:"activitySection.authorPhraseInboxRedesign.forTwoAuthors.label",values:{frontActorName:c,backActorName:u,b:e=>(0,J.jsx)("span",{style:g,children:e})}})}):t>2?(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"<b>{frontActorName} and {numberOfOtherAuthors} others</b>",id:"activitySection.authorPhraseInboxRedesign.forMoreThanTwoAuthors.label",values:{frontActorName:c,numberOfOtherAuthors:t-1,b:e=>(0,J.jsx)("span",{style:g,children:e})}})}):null}function Ii(){const e=(0,u().IS)((e=>({icon:{height:14,width:14,fill:e.icon.secondary}})),[]);return(0,J.jsx)(he,{children:(0,$t().D)(e.icon)})}function Bi(e){const{actorStore:t,avatar:i}=e,o=e.size??28;return t?t.table===Se().GP?(0,J.jsx)(si().A,{botStore:t,size:o}):t.table===y().oo?(0,J.jsx)(ai().A,{userStore:t,size:o}):t.table===Be().yj?(0,J.jsx)(ai().A,{userStore:void 0,size:o}):void(0,x().HB)(t):i?(0,J.jsx)(ai().A,{avatar:i,size:o}):(0,J.jsx)(ai().A,{userStore:void 0,size:o})}const Ki=o.memo(ui);const Ti=function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{tab:l,notification:d}=o,u=(0,r().v3)(),g=(0,n().K8)((()=>(0,Ft().W9)(t.getEdits())),[t]),m=(0,n().K8)((()=>(0,c().Ln)({edits:g,rootStore:i})),[g,i]),p=(0,n().K8)((()=>{const e=g[0];return e?e.new_email:""}),[g]);return(0,J.jsx)(fe,{header:(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"You updated your email to {newEmail}",values:{newEmail:p},id:"activity.emailEdited.header.short"})}),isFirst:s,isLast:a,isPrivate:!1,rootStore:i,notification:d,icon:(0,J.jsx)(tt().H8,{authors:m,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:void 0,...(0,ze().$5)({notification:d,activity:t,environment:u,tab:l})})};var qi=()=>i(674020),Ni=()=>i(21140);function Pi(){const e=(0,u().IS)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,J.jsx)(he,{children:(0,qi().y)(e.icon)})}var Li=()=>i(280746);const Di=(0,b().YK)({jiraSyncTokenExpiry:{id:"externalIntegrationNotificationActivity.jiraSyncTokenExpiry",defaultMessage:"Your Jira sync stopped for {site} due to expired Jira token. Please re-authenticate to continue."}});function zi(e){const{rootStore:t,activity:i,isLast:o,tabArgs:s,isFirst:a}=e,{tab:l,notification:d}=s,c=(0,r().v3)(),u=(0,n().K8)((()=>i.getEdits()),[i]).at(0);return u&&"jira-sync-token-expiry"===u.external_integration_notification_type?(0,J.jsx)(fe,{header:(0,J.jsx)(b().sA,{...Di.jiraSyncTokenExpiry,values:{site:u.identifier}}),isFirst:a,isLast:o,isPrivate:!1,rootStore:t,notification:d,icon:(0,J.jsx)(Ui,{}),showSnapshotButton:!1,url:void 0,...(0,ze().$5)({notification:d,activity:i,environment:c,tab:l})}):null}function Ui(){const e=(0,r().v3)(),t=(0,n().K8)((()=>"dark"===e.ThemeStore.state.mode),[e]),i=(0,u().IS)((e=>({icon:{height:18,width:18,marginTop:2,marginRight:2,fill:t?e.primaryBlack:e.blueColor}})),[t]);return(0,J.jsx)(he,{children:(0,Li().jiraIcon)(i.icon)})}i(672577);var Wi=()=>i(921940),Oi=()=>i(555555),Ei=()=>i(831098),Fi=()=>i(115512),Vi=()=>i(37433),Hi=()=>i(466872),$i=()=>i(848237);const Gi=3;function Yi(e){const{userIds:t,remainingAvatarCount:i,shownAvatarCount:o,titledRecordStore:r,isMobile:n}=e,s=(0,u().IS)((e=>({avatarContainer:{display:"flex",flexDirection:"row",justifyContent:"start",overflow:"hidden",paddingRight:2,alignItems:"center"},overlappingAvatar:{marginRight:-5,position:"relative"},rightmostAvatar:{position:"relative"},remainderCount:{paddingLeft:2,color:e.text.tertiary}})),[]);return(0,J.jsxs)("div",{style:s.avatarContainer,children:[t.slice(0,Gi).map(((e,t)=>{const i=w().LU.createChildStore(r,{table:y().oo,id:e}),a=t===o-1;if(i)return(0,J.jsx)(ai().A,{userStore:i,size:24,avatarShouldShowShadow:!1,style:a?s.rightmostAvatar:s.overlappingAvatar,isOffline:!1,hasTooltip:!n},e)})),i>0&&(0,J.jsx)("div",{style:s.remainderCount,children:(0,J.jsx)(b().sA,{defaultMessage:"{remainingAvatarCount, plural, one {+{remainingAvatarCount}} other {+{remainingAvatarCount}}}",id:"activity.titleCard.members.otherCount.message",values:{remainingAvatarCount:i}})})]})}function Qi(e){const{titledRecordStore:t,rootStore:s,activity:a,tabArgs:l}=e,d=s.getRecordModel,c=(0,n().K8)((()=>t.getModel()),[t]),g=(0,r().v3)(),{isMobile:p}=g.device,b=(0,n().K8)((()=>null==c?void 0:c.getRenderIcon({getRecordModel:d})),[c,d]),A=(0,u().IS)((e=>({container:{display:"block",borderWidth:1,borderStyle:"solid",borderColor:e.tint.regular,borderRadius:8,marginTop:0,padding:12,background:e.contentBackground,boxShadow:"0px 1px 2px 0px "+("light"===e.mode?"rgba(0, 0, 0, 0.03)":"rgba(0, 0, 0, 0.12)"),transition:`background ${ne}`},icon:{...it().kI,marginRight:10},activityTitle:{fontSize:14,marginRight:void 0!==b?3:0,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,verticalAlign:"top",textAlign:"left",lineHeight:S().K_.UIRegular.desktop,...S().RC,whiteSpace:"normal",...it().a_},flexRow:{display:"flex",alignItems:"center"},title:{maxWidth:"80%"},spacer:{flexGrow:1}})),[b]),j=(0,n().K8)((()=>{if(c&&c.table!==f().yK)return c.getRenderUrl({getRecordModel:d,pageVisitSource:m().y8.Notification})}),[c,d]),_=(0,o.useCallback)((e=>{const i=t.table;switch(i){case v().ev:case h().NX:(0,ze().Qo)({environment:g,activity:a,...l});break;case f().yK:(0,ze().uY)({environment:g,activity:a,...l}),$i().L0({environment:g,teamStore:t,shouldScroll:!0}),Hi().A.setState({...Hi().A.state,open:!1});break;default:(0,x().HB)(i)}}),[a,g,l,t]),M=(0,n().K8)((()=>{const e=t.table;let o=[];const r=i(749240).subscriptionDataStoreInstance.state;r&&(o=(0,i(134217).Ye)(r));let n=[],s=0;switch(e){case"space":if(!t.getModel())break;n=o.map((e=>e.userId)),s=Math.max(0,n.length-Gi);break;case"block":const i=t.getCreatedByPointer();(null==i?void 0:i.table)===y().oo&&(n=[i.id]),s=Math.max(0,n.length-Gi);break;case"team":const r=(0,Vi().getTeamMemberCountAndSampleUserIds)(t);n=(null==r?void 0:r.sampleMemberUserIds)??[],s=Math.max(0,(null==r?void 0:r.memberCount)??0-Gi);break;default:(0,x().HB)(e)}const a=Math.min(n.length,Gi);return(0,J.jsx)(Yi,{userIds:n,remainingAvatarCount:s,shownAvatarCount:a,titledRecordStore:t,isMobile:p})}),[p,t]);return c?(0,J.jsx)(ni().A,{href:j,onClick:_,external:!1,innerStyle:A.container,inline:!0,children:(0,J.jsxs)("div",{style:A.flexRow,children:[b&&(0,J.jsx)($().B,{disabled:!0,icon:b,isEmptyPage:!1,size:25,style:A.icon}),(0,J.jsx)("div",{style:A.title,children:(0,J.jsx)(G().A,{store:t,style:A.activityTitle})}),(0,J.jsx)("div",{style:A.spacer}),(0,J.jsx)("div",{children:M})]})}):null}const Xi=o.memo(Qi);function Ji(){const e=(0,u().IS)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,J.jsx)(he,{children:(0,Oi().n)(e.icon)})}function Zi(){const e=(0,r().v3)(),t=(0,n().K8)((()=>"dark"===e.ThemeStore.state.mode),[e]),i=(0,u().IS)((e=>({icon:{height:18,width:18,marginTop:2,marginRight:2,fill:t?e.primaryBlack:e.blueColor}})),[t]);return(0,J.jsx)(he,{children:(0,Ei().y)(i.icon)})}var eo=()=>i(101209),to=()=>i(722872),io=()=>i(377586),oo=()=>i(463830),ro=()=>i(920773),no=()=>i(928600),so=()=>i(480095),ao=()=>i(128295);function lo(e){const{timestamp:t,header:i,navigableBlockId:o,rootStore:n,showRecordPath:s,disableJustify:a,onBacklinkClick:l,titleAriaId:d}=e,c=(0,U().nl)(t,{useUltraCompactFormat:!0}),g=(0,r().v3)().device.isMobile,m=(0,U().x$)(t),p=(0,u().IS)((e=>({container:{width:"100%"},header:{width:g?"calc(100% - 98px)":"100%",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:g?28:void 0,display:"flex",alignItems:"baseline",justifyContent:a?void 0:"space-between"},time:{fontSize:12,color:e.text.tertiary,whiteSpace:"nowrap",display:"inline",paddingLeft:6},path:{marginTop:4,marginBottom:4}})),[g,a]);return(0,J.jsxs)("div",{style:p.container,children:[(0,J.jsxs)("div",{className:P().k2l,style:p.header,children:[(0,J.jsx)("span",{id:d,children:i}),(0,J.jsx)("div",{style:p.time,className:P().Cxn,children:(0,J.jsx)(X().A,{text:c,tooltipText:m,icon:I().k})})]}),s&&o&&n&&(0,J.jsx)("div",{style:p.path,children:(0,J.jsx)(ao().Ay,{isLink:!0,store:w().Bv.createChildStore(n,{table:v().ev,id:o}),onClick:l})})]})}const co=1;function uo(e){const{rootStore:t,activity:i,isLast:s,tabArgs:a,edits:l,style:d,isFirst:g}=e,{tab:p,notification:h,source:f}=a,y=(0,r().v3)(),b=l.at(0),[A,j]=(0,o.useState)(null),_=(0,o.useMemo)((()=>A&&A.scrollHeight>A.clientHeight),[A]),M=(0,n().K8)((()=>{if(!b)return;const e=w().Bv.createChildStore(t,{table:v().ev,id:b.navigable_block_id});return(0,x().O9)(e)?e:void 0}),[b,t]),R=(0,n().K8)((()=>{const e=null==M?void 0:M.getModel();if(e)return e.getRenderUrl({getRecordModel:t.getRecordModel,pageVisitSource:m().y8.Notification})}),[t,M]),C=(0,n().K8)((()=>(0,c().DU)({recordId:null==M?void 0:M.id,recordType:v().ev,tab:p,rootStore:t,environment:y})),[M,p,t,y]),k=(0,u().IS)((e=>({formattedTitleStyle:{fontSize:S().J.UISmall.desktop,color:e.text.tertiary},container:{paddingBlock:4,display:"flex",flexDirection:"row",columnGap:1.5*Number((0,it().AG)(e).paddingLeft),alignItems:"center"}})),[]),I=(0,o.useMemo)((()=>new Set(l.map((e=>e.automation_id)))),[l]),B=1===I.size;return(0,x().O9)(M)&&(0,x().O9)(b)?(0,J.jsx)(fe,{header:(0,J.jsx)(vo,{rootStore:t,uniqueAutomations:I,firstEdit:b,spaceId:i.spaceId,environment:y,shortened:!1,titleStyle:{fontWeight:S().Wy.semibold}}),isFirst:g,isLast:s,isPrivate:C,rootStore:t,navigableBlockId:M.id,notification:h,icon:(0,J.jsx)(fo,{}),showSnapshotButton:!1,url:R,...(0,ze().$5)({notification:h,activity:i,environment:y,tab:p}),children:(0,J.jsxs)("div",{style:d,children:[l.slice(-1*co).map(((i,o)=>(0,J.jsxs)("div",{children:[!B&&(0,J.jsx)(vo,{rootStore:t,firstEdit:i,uniqueAutomations:new Set([i.automation_id]),shortened:!0,spaceId:i.space_id,environment:y,titleStyle:k.formattedTitleStyle}),(0,J.jsx)(po,{...e,edit:i,isViewAllMenu:!1,source:f,isLast:l.length>co?o===l.length-1-co:o===l.length-1,clampedMessageContainerRef:j})]},o))),(0,J.jsx)("div",{style:k.container,children:(_||l.length>co)&&(0,J.jsx)(go,{edits:l,rootStore:t,activity:i,navigableBlockStore:M,source:f})})]})}):null}function go(e){const{edits:t,rootStore:i,activity:s,navigableBlockStore:a,source:l}=e,d=(0,r().Y0)(),c=(0,r().v3)(),{handleAnalyticsForPopupMenu:g}=(0,o.useContext)(yo),m=(0,n().uB)(void 0,oo().A),p=(0,o.useCallback)((()=>m.reset()),[m]),v=(0,o.useMemo)((()=>(0,J.jsx)(b().sA,{defaultMessage:"{numNotifications, plural, one {View more} other {View {numRemainingNotifications}}}",id:"inAppNotificationAutomationActionTriggeredActivity.renderViewAllNotificationsButton.buttonLabel",values:{numNotifications:t.length,numRemainingNotifications:t.length}})),[t.length]);let h;h=d.isMobile?{menuType:to().gu.Modal,title:v,right:(0,J.jsx)(so().DoneMenuText,{}),onClickRight:p,whiteBackground:!0}:{menuType:to().gu.Popup,width:420,maxWidth:d.isMobileBrowser?"80vw":"100%"};const f=(0,u().IS)((e=>({actionButton:(0,it().Ei)(e),divider:{borderBlockEnd:`1px solid ${e.regularDividerColor}`},viewAllMenuNotificationContainer:{display:"flex",flexDirection:"column",padding:12},viewAllMenuHeaderContainer:{display:"flex",flexDirection:"row",gap:ie},popupMenu:{marginInlineStart:-2,fontSize:ue}})),[]),y=(0,o.useId)();return(0,J.jsx)(V().Ay,{buttonPopupStore:m,popupType:d.isMobile?io().n.SlideUp:io().n.Popup,placementToOrigin:E().W.Bottom,alignmentToOrigin:E().C.Center,originGap:4,onClick:()=>!m.state.open&&g(),renderOrigin:e=>(0,J.jsx)(ro().p,{size:"xs",isGray:!0,...e,style:f.actionButton,children:v}),render:()=>(0,J.jsx)(no().A,{...h,children:(0,J.jsx)("div",{style:f.popupMenu,children:t.map(((o,r)=>(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:f.viewAllMenuNotificationContainer,children:[(0,J.jsxs)("div",{style:f.viewAllMenuHeaderContainer,children:[(0,J.jsx)(fo,{}),(0,J.jsx)(lo,{timestamp:o.timestamp,titleAriaId:y,onBacklinkClick:()=>null,disableJustify:!0,header:(0,J.jsx)(vo,{rootStore:i,uniqueAutomations:new Set([o.automation_id]),firstEdit:o,spaceId:s.spaceId,environment:c,closeViewAllMenu:p,shortened:!0,titleStyle:{fontWeight:S().Wy.semibold}}),rootStore:i,navigableBlockId:a.id,showRecordPath:!1})]}),(0,J.jsx)(po,{...e,edit:o,isViewAllMenu:!0,source:l,isLast:r===t.length-1},r)]}),r!==t.length-1&&(0,J.jsx)("div",{style:f.divider})]},r)))})})})}const mo=4;function po(e){const{edit:t,rootStore:i,source:o,isViewAllMenu:s,clampedMessageContainerRef:a}=e,l=(0,u().DP)(),d=(0,r().v3)(),c=(0,r().Y0)(),{isMobile:g}=c,m=(0,n().K8)((()=>d.KatexStore.getKatex()),[d]),p=(0,ei().Ol)(),v=(0,n().K8)((()=>(0,J.jsx)("div",{children:(0,ti().S5)({environment:d,textValue:t.message.value?{value:t.message.value,spaceId:t.space_id}:void 0,parentStore:i,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!1,theme:l,emojiType:p,katex:m,parentBlockId:void 0,renderedPageBlockId:void 0,formulaValueTypes:[],stopLinkPropagation:!0})})),[d,p,m,l,t.message.value,i,t.space_id]),h=(0,u().IS)((e=>({container:{paddingInlineStart:s?32:(0,it().F9)({source:o,isMobile:g}),paddingBlockEnd:4},messageContainer:{position:"relative",display:"flex",justifyContent:"space-between",alignItems:"center"},clampedMessageContainer:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:s?void 0:mo,verticalAlign:"top",textAlign:"left",lineHeight:S().K_.UIRegular.desktop,...S().RC},messageContent:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:ue,lineHeight:(0,Fi().ks)({device:c},"UIRegular"),paddingInlineEnd:8}})),[g,o,c,s]);return(0,J.jsx)("div",{style:{...s&&h.container,...h.messageContainer},children:(0,J.jsx)("div",{ref:a,style:h.clampedMessageContainer,children:(0,J.jsx)("div",{style:h.messageContent,children:v})})})}function vo(e){const{rootStore:t,spaceId:i,environment:o,closeViewAllMenu:r,shortened:s,titleStyle:a,firstEdit:l,uniqueAutomations:d}=e,c=(0,b().tz)(),u=1===d.size,g=(0,n().K8)((()=>!w().dn.createChildStore(t,{table:Tt().yB,id:l.automation_id,spaceId:t.getSpaceId()}).getAlive()),[t,l]),p=(0,n().K8)((()=>{const e=new(w().Bv)(o,{id:l.automation_navigable_block_id,table:v().ev}).getRole();return!e||!(0,Ie().Tt)(e)}),[l,o]),h=(0,n().K8)((()=>{if(!(g&&u||p))return()=>{const e=l.automation_navigable_block_id,i=l.automation_id,n=w().Bv.createChildStore(t,{table:v().ev,id:e});if(!n)return;r&&r();const s=(0,Rt().Ay)({store:n,preferPublicLink:!1,pageVisitSource:m().y8.Notification});Mt().oo({environment:o,url:s,callback:async()=>await Wt({environment:o,automationNavigableBlockStore:n,automationId:u?i:void 0,rootStore:t,source:"in_app_notification"})})}}),[o,u,l,t,r,g,p]),f=(0,n().K8)((()=>[...d].map((e=>{const o=t.getRecordStore(t,{table:Tt().yB,id:e,spaceId:i}),r=o.getRole();return(0,x().O9)(r)&&(0,Ie().Tt)(r)?o.getAlive()?o.getNameWithDefault(c):c.formatMessage(Kt().VS.automationDeletedName):c.formatMessage(Kt().VS.automationPrivateName)}))),[c,t,i,d]);return s?(0,J.jsx)("div",{style:{...a,display:"inline-flex"},children:(0,J.jsx)(ho,{handleAutomationNavigate:h,automationNames:f})}):(0,J.jsx)(b().sA,{id:"inAppNotificationAutomationActionTriggeredActivity.formattedHeaderMessage.automationTitle",defaultMessage:"{automationNameWrappedHeader} sent you a message",values:{automationNameWrappedHeader:(0,J.jsx)("div",{style:{...a,display:"inline-flex"},children:(0,J.jsx)(ho,{handleAutomationNavigate:h,automationNames:f})})}})}function ho(e){const{automationNames:t,handleAutomationNavigate:i}=e,o=(0,b().tz)(),r=t.at(0),n=t.length,s=n-2,a=o.formatList([...t.slice(0,2),s>0?o.formatMessage({defaultMessage:"{numRemainingAutomations} more",id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.tooltipNumRemainingAutomations"},{numRemainingAutomations:s}):void 0].filter(x().O9),{style:"long",type:"conjunction"}),l={defaultMessage:"{numAutomations, plural, one {{firstAutomationName}} other {{numAutomations} automations}}",values:{firstAutomationName:r,numAutomations:n},id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.automationName",description:"The display name for an automation."},d=e=>i?(0,J.jsx)(Nt().A,{...e,onClick:i,children:(0,J.jsx)(b().sA,{...l})}):(0,J.jsx)("div",{...e,children:(0,J.jsx)(b().sA,{...l,...e})});return 1===n?d():(0,J.jsx)(Y().A,{renderTooltip:e=>(0,J.jsx)("div",{...e,children:a}),render:e=>d(e)})}function fo(){const e=(0,u().IS)((e=>({icon:{height:12,width:12,fill:e.icon.secondary}})),[]);return(0,J.jsx)(he,{children:(0,eo().v)(e.icon)})}const yo=(0,o.createContext)({handleAnalyticsForPopupMenu:()=>{}});function bo(e){const{analyticsInfo:t,children:i}=e,r=(0,o.useCallback)((()=>Ke().mF(t)),[t]);return(0,J.jsx)(yo.Provider,{value:{handleAnalyticsForPopupMenu:r},children:i})}yo.displayName="InAppNotificationAutomationActionTriggeredAnalyticsContext";var xo=()=>i(641007),So=()=>i(148832);const Ao=function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{tab:l,notification:d}=o,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),m=(0,n().K8)((()=>(0,c().Ln)({edits:g,rootStore:i})),[g,i]),p=(0,n().K8)((()=>(0,c().bD)(m,{...(0,R()._m)()})),[m]),h=(0,n().K8)((()=>{const e=w().Bv.createChildStore(i,{table:v().ev,id:t.navigable_block_id});if(e.isDefined())return e}),[t,i]),f=(0,n().K8)((()=>Boolean(h&&(0,c().DU)({recordId:h.id,recordType:v().ev,tab:l,rootStore:i,environment:u}))),[h,l,i,u]),x=g[0],S=(0,n().K8)((()=>(0,c().j1)(x.from_user_id,i)),[x,i]),A=(0,n().K8)((()=>(0,c().j1)(x.to_user_id,i)),[x,i]);if(!(g.length>0&&S&&A&&h))return null;const j=(0,xe().lR)(_().A.getIntl(),(0,xe().D3)({table:y().oo,value:S}));return(0,J.jsx)(fe,{header:(0,J.jsx)(b().sA,{defaultMessage:"{authorPhrase} transferred {fromUserName}{fromUserNameEndsWithS, select, true {’} other {’s}} private pages to you",values:{authorPhrase:p,fromUserName:j,fromUserNameEndsWithS:"s"===j.slice(-1).toLowerCase()},id:"activity.privateContentTransferred.standardizedHeader.short"}),isPrivate:f,rootStore:i,notification:o.notification,isFirst:s,isLast:a,icon:(0,J.jsx)(tt().H8,{authors:m,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:void 0,...(0,ze().$5)({notification:d,activity:t,environment:u,tab:l})})};i(430670),i(908872);var jo=()=>i(343666),_o=()=>i(204384),Mo=()=>i(56086);function Ro(e){const{authorCount:t,authorPhrase:i,targetStore:o}=e;return(0,n().K8)((()=>o instanceof w().jg),[o])?(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} reacted in} other {{authorOrAuthors} reacted in}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.reactionActivity.standardizedHeader.comment"}):(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} reacted to} other {{authorOrAuthors} reacted to}}",values:{numberOfAuthors:t,authorOrAuthors:i},id:"activity.reactionActivity.standardizedHeader.discussion"})}function wo(e){const{targetStore:t,source:i}=e,o=(0,r().v3)(),s=(0,r().Y0)(),a=(0,u().DP)(),l=(0,n().K8)((()=>yi({source:i,forReplyMenu:!1})),[i]),d=(0,u().IS)((e=>({commentText:{whiteSpace:"pre-wrap",wordBreak:"break-word",display:"inline",fontSize:14,color:e.text.primary,lineHeight:"22px"},newReaction:{borderWidth:1,borderStyle:"solid",borderColor:s.isMobile?"transparent":e.stroke.primary,borderRadius:6,boxShadow:s.isMobile?"unset":"0px 2px 4px 0px rgba(22, 29, 27, 0.02)"},avatarCommentReactionBarContainer:{...!s.isMobile&&{position:"relative"}},avatarAndCommentContainer:{display:"flex",flexDirection:"column"},commentContainer:{display:"flex",justifyContent:"space-between",gap:6,flexGrow:1}})),[s.isMobile]),c=(0,n().K8)((()=>{if(t&&t.table===jo().SN)return t}),[t]),g=(0,n().K8)((()=>{if(!c)return null;const e=ii().gp(c).getValue();if(!e)return null;const i=t.getSpaceId();if(!i)return null;const r=(0,Qt().Eh)({textValue:e,currentUserId:o.currentUser.id,getRecordModel:t.getRecordModel,highlightStyle:"text_only"});return(0,ti().S5)({environment:o,textValue:{value:r,spaceId:i},parentStore:t,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableHover:!0,disabled:!0,theme:a,emojiType:(0,ei().FN)(o),katex:o.KatexStore.getKatex(),formulaValueTypes:[]})}),[t,o,a,c]);return(0,J.jsxs)("div",{style:d.avatarCommentReactionBarContainer,children:[c&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:d.avatarAndCommentContainer,children:(0,J.jsx)("div",{children:(0,J.jsx)(Mi,{commentStore:c})})}),(0,J.jsx)("div",{style:d.commentContainer,children:(0,J.jsx)("div",{style:S().RC,children:(0,J.jsx)("span",{style:d.commentText,children:g})})})]}),(0,J.jsx)(Xt().fj,{parentStore:t,discussionLocation:l,onReactionToggle:()=>{},newReactionStyle:d.newReaction})]})}var Co=()=>i(599987);function ko(){const e=(0,u().IS)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,J.jsx)(he,{children:(0,Co().P)(e.icon)})}var Io=()=>i(120739),Bo=()=>i(578136);function Ko(e){const{titledRecordStore:t,rootStore:i,activity:s,tabArgs:a}=e,l=i.getRecordModel,d=(0,n().K8)((()=>t.getModel()),[t]),c=(0,r().v3)(),{isMobile:g}=c.device,m=(0,n().K8)((()=>null==d?void 0:d.getRenderIcon({getRecordModel:l})),[d,l]),p=(0,o.useCallback)((o=>{const r=t.table;switch(r){case v().ev:(0,ze().Qo)({environment:c,activity:s,...a});break;case f().yK:(0,ze().Qo)({environment:c,activity:s,...a}),$i().L0({environment:c,teamStore:t,shouldScroll:!0}),Hi().A.setState({...Hi().A.state,open:!1});const n=e.notification;if(!n||n.read)break;(0,D().SQ)({event:o,context:D().y$.NotificationClick,callback:()=>{N().createAndCommit({userAction:"NotificationTitleCard.handleMarkAsRead",environment:c,canUndo:!0,perform:e=>{T().ZB({notification:n,rootStore:i,transaction:e,read:!0})}})}});break;default:(0,x().HB)(r)}}),[s,c,e.notification,i,a,t]),[h,b]=o.useState(!1),[A,j]=o.useState(!1),_=(0,u().IS)((e=>({container:{display:"flex",alignItems:"center",borderRadius:8,background:A?e.state.pressed:h?e.state.hover:"transparent",transition:`background ${ne}`,marginTop:0,padding:12,boxShadow:"0px 1px 2px 0px "+("light"===e.mode?"rgba(0, 0, 0, 0.03)":"rgba(0, 0, 0, 0.12)"),border:"1px",borderStyle:"solid",borderColor:e.tint.regular,cursor:h?"pointer":"default"},icon:{...it().kI,marginRight:10},activityTitle:{fontSize:14,marginRight:void 0!==m?3:0,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,verticalAlign:"top",textAlign:"left",lineHeight:S().K_.UIRegular.desktop,...S().RC,whiteSpace:"normal",...it().a_},title:{maxWidth:"80%"},spacer:{flexGrow:1}})),[m,h,A]),M=(0,n().K8)((()=>{let e=[],i=0;const o=t.table;switch(o){case"block":const r=t.getCreatedByPointer();(null==r?void 0:r.table)===y().oo&&(e=[r.id]),i=Math.max(0,e.length-Gi);break;case"team":const n=(0,Vi().getTeamMemberCountAndSampleUserIds)(t);e=(null==n?void 0:n.sampleMemberUserIds)??[],i=Math.max(0,(null==n?void 0:n.memberCount)??0-Gi);break;default:(0,x().HB)(o)}const r=Math.min(e.length,Gi);return(0,J.jsx)(Yi,{userIds:e,remainingAvatarCount:i,shownAvatarCount:r,titledRecordStore:t,isMobile:g})}),[g,t]);return d?(0,J.jsxs)("div",{style:_.container,onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),onMouseDown:()=>j(!0),onMouseUp:()=>j(!1),onClick:p,children:[m&&(0,J.jsx)($().B,{disabled:!0,icon:m,isEmptyPage:!1,size:25,style:_.icon}),(0,J.jsx)("div",{style:_.title,children:(0,J.jsx)(G().A,{store:t,style:_.activityTitle})}),(0,J.jsx)("div",{style:_.spacer}),(0,J.jsx)("div",{children:M})]}):null}const To=o.memo(Ko);var qo=()=>i(979340),No=()=>i(84817),Po=()=>i(554509);function Lo(e){const{activity:t,isFirst:o,isLast:s,rootStore:a,tabArgs:l}=e,{notification:d,tab:u}=l,g=(0,r().v3)(),m=(0,b().tz)(),p=(0,n().K8)((()=>(0,Ft().W9)(t.getEdits())),[t]),v=(0,n().K8)((()=>{if(!p.length)return(0,c().Ln)({edits:p,rootStore:a});const e={id:p.at(0).trial_data.user_id,table:y().oo},t=(0,c().T9)(e,a);return t?[t]:(0,c().Ln)({edits:p,rootStore:a})}),[p,a]),h=(0,n().K8)((()=>(0,c().bD)(v,{...(0,R()._m)()})),[v]),{frontActorStore:f,backActorStore:x}=(0,n().K8)((()=>{const e=v.map((e=>w().sk.createChildStore(a,e)));return{frontActorStore:e.at(0),backActorStore:e.at(1)}}),[v,a]);if(!(p.length>0))return null;const{trial_data:{end_time:S,product:A,days:j}}=p[0],_=i(244641).c9.fromMillis(S);return(0,J.jsx)(fe,{header:(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{id:"activity.trialCreated.standardizedHeader.single",defaultMessage:"{authorOrAuthors} started a {days} day trial of <b>Notion {plan}</b>",values:{b:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,J.jsx)("b",{children:t})},days:j,plan:(0,qo().u2)({product:A,intl:m}),authorOrAuthors:h}})}),isFirst:o,isLast:s,isPrivate:!1,rootStore:a,notification:d,icon:f&&x?(0,J.jsx)(Ci,{frontActorStore:f,backActorStore:x}):(0,J.jsx)(tt().H8,{authors:v,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),url:void 0,showSnapshotButton:!1,...(0,ze().$5)({notification:d,activity:t,environment:g,tab:u}),children:(0,J.jsxs)(No().Y1,{direction:"vertical",align:"center-left",gap:12,children:[(0,J.jsx)(No().Y1,{direction:"horizontal",align:"center-left",gap:4,children:(0,J.jsx)(Po().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:(0,J.jsx)(b().sA,{defaultMessage:"You now have access to all {product} plan features until {date}",id:"activityNotification.trialCreated.productName",values:{product:(0,qo().u2)({product:A,intl:m}),date:`${_.toFormat("MMM")} ${(0,i(264435).o4)(_.locale.substring(0,2),_.day,"c")} ${_.toFormat("yyyy")}`}})})}),(0,J.jsx)(wt().A,{onClick:()=>(0,i(922442).openSelfServeBusinessTrialExplorePlanModal)(),children:(0,J.jsx)(b().sA,{id:"activityNotification.trialCreated.learnMoreButton",defaultMessage:"Learn more"})})]})})}var Do=()=>i(232802),zo=()=>i(762433),Uo=()=>i(8980);function Wo(e){const{activity:t,isFirst:o,isLast:s,rootStore:a,tabArgs:l}=e,{tab:d,notification:g}=l,m=(0,u().IS)((e=>({container:{paddingTop:8},actionButton:{height:28,paddingLeft:12,paddingRight:12,boxShadow:e.shadow2XS,fontSize:14,color:e.text.primary},getActionButtonStyleWithoutOutline:{height:26,paddingLeft:8,paddingRight:8,color:e.text.primary,fontSize:14},approvalIcon:{width:12,height:12},approvalMessageContainer:{fontSize:12,color:e.text.secondary}})),[]),p=(0,r().v3)(),v=(0,i(58293).r)(),h=(0,b().tz)(),f=(0,i(714300).l)({spaceId:null==v?void 0:v.id}),y=(0,n().K8)((()=>(0,Ft().W9)(t.getEdits())),[t]),x=(0,n().K8)((()=>(0,c().Ln)({edits:y,rootStore:a})),[y,a]),{frontActorStore:A,backActorStore:j}=(0,n().K8)((()=>{const e=x.map((e=>w().sk.createChildStore(a,e)));return{frontActorStore:e.at(0),backActorStore:e.at(1)}}),[x,a]),_=y.length>0,M=(0,n().K8)((()=>{var e;const i=null===(e=y[0])||void 0===e?void 0:e.request_id;return a.getRecordModel({table:Do().GU,id:i,spaceId:t.space_id})}),[y,a,t.space_id]),R=(0,n().K8)((()=>M?M.getRequest():null),[M]),C=(0,n().K8)((()=>zo().N8(null==f?void 0:f.subscription)),[f]),k=(0,i(128265).n)(),I=(0,n().K8)((()=>M?M.getReasonForRequest():null),[M]),B=(0,n().K8)((()=>M?M.getRequestStatus():null),[M]),T=(0,n().K8)((()=>{const e={enterprise:["business"]};const t=(0,zo().d$)(f).filter((e=>(0,Do().rU)(e))),i=(0,K().R9)((0,K().sb)(t.flatMap((t=>e[t]??[]))),t);return!!R&&((0,zo().eh)(f,R)||i.includes(R))}),[f,R]);if(!R)return null;const q=(0,i(799104).Y)(R,C,k);if(!M||!_||!q)return null;return(0,J.jsxs)(fe,{header:(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested an upgrade to the workspace} other {{authorOrAuthors} requested an upgrade to the workspace}}",id:"activity.upgradeRequested.standardizedHeader.single",values:{numberOfAuthors:x.length,authorOrAuthors:(0,J.jsx)(ki,{authorsLength:x.length,frontActorStore:A,backActorStore:j,authorTextStyle:{fontWeight:S().Wy.medium}})}})}),isFirst:o,isLast:s,isPrivate:!1,rootStore:a,notification:g,icon:A&&j?(0,J.jsx)(Ci,{frontActorStore:A,backActorStore:j}):(0,J.jsx)(tt().H8,{authors:x,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),url:void 0,showSnapshotButton:!1,...(0,ze().$5)({notification:g,activity:t,environment:p,tab:d}),children:[(0,J.jsxs)(No().Y1,{direction:"vertical",align:"center-left",gap:8,children:[(0,J.jsxs)(No().Y1,{direction:"horizontal",align:"center-left",gap:4,children:["ai"===R&&(0,J.jsx)(Uo().I,{icon:i(529099).aiFaceIcon}),"ai"!==R&&(0,J.jsx)(Uo().I,{icon:i(132855).arrowInCircleUpFillIcon,color:"uiBluePrimary"}),(0,J.jsx)(Po().D,{styleName:"UIRegular-14px/Semibold",children:(0,J.jsx)(b().sA,{defaultMessage:"Notion {productName}",id:"activityNotification.upgradeRequestCreated.productName",values:{productName:qo().v0[R].defaultMessage}})})]}),(0,J.jsx)(Po().D,{styleName:"UIRegular-14px/Regular",colorName:"primary",style:{marginBottom:4},children:I})]}),"pending"===B&&!T&&(0,J.jsx)("div",{style:m.container,children:(0,J.jsxs)(No().Y1,{direction:"horizontal",align:"center-left",gap:4,children:[(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{size:"xs",isGray:!0,onClick:async()=>{await(0,i(911964).F)({environment:p,spaceStore:v,billingData:f,product:R,from:"upgrade_request_created_notification"})},style:m.actionButton,children:h.formatMessage(q)})}),(0,J.jsx)(ee,{children:(0,J.jsx)(ye().p,{size:"xs",isGray:!0,onClick:()=>{je().Ow({currentTab:"requests",openedFrom:"upgrade_request_created_notification",subtab:"upgrades"})},style:m.getActionButtonStyleWithoutOutline,children:(0,J.jsx)(b().sA,{defaultMessage:"View all",id:"activityNotification.upgradeRequestCreated.viewAllRequestsButton.label"})})})]})}),("approved"===B||"superseded"===B||T)&&(0,J.jsx)("div",{style:m.container,children:(0,J.jsxs)(No().Y1,{direction:"horizontal",align:"center-left",gap:4,style:m.approvalMessageContainer,children:[(0,Gt().b)(m.approvalIcon),(0,J.jsx)(b().sA,{id:"activityNotification.upgradeRequestCreated.requestApproved",defaultMessage:"This request has been approved."})]})})]})}var Oo=()=>i(814388),Eo=()=>i(426302),Fo=()=>i(456328),Vo=()=>i(720665);function Ho(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d}=o,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),p=g[0],v=Qo({rootStore:i,edit:p}),h=function(e){let{data:t,tab:i,rootStore:o}=e;const s=(0,r().v3)();return(0,n().K8)((()=>{if("block"!==(null==t?void 0:t.type))return!1;const e=t.blockStore.id;return(0,c().DU)({recordId:e,recordType:"block",tab:i,rootStore:o,environment:s})}),[t,s,o,i])}({data:v,tab:d,rootStore:i}),f=(0,n().K8)((()=>(0,c().Ln)({edits:g,rootStore:i})),[g,i]),y=(0,n().K8)((()=>{if("block"===(null==v?void 0:v.type))return v.blockStore}),[v]),b=(0,n().K8)((()=>{if(!y)return;const e=y.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification}):void 0}),[y,i.getRecordModel]),x=(0,n().K8)((()=>t.navigable_block_id),[t]);if(0===g.length||!v)return null;const S=0===f.filter(xe().L_).length,A=S?void 0:(0,J.jsx)(tt().H8,{authors:f,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1});return(0,J.jsxs)(fe,{header:(0,J.jsx)(Go,{data:v,authors:f,isFromBot:S}),hidePageTitle:!0,isFirst:s,isLast:a,isPrivate:h,rootStore:i,navigableBlockId:x,notification:l,icon:A,showSnapshotButton:!1,url:b,...(0,ze().$5)({notification:l,environment:u,tab:d,activity:t}),children:[(0,J.jsx)(Yo,{...e,edit:p}),(0,J.jsx)($o,{data:v,rootStore:i,activity:t,tabArgs:o})]})}function $o(e){var t;const{data:i,rootStore:o,activity:r,tabArgs:n}=e,s=(0,u().IS)((e=>({group:{color:e.text.secondary,fontSize:14},titleCardWrapper:{display:"contents",pointerEvents:"none"}})),[]);switch(i.type){case"block":return(0,J.jsx)(ee,{children:(0,J.jsx)(To,{titledRecordStore:i.blockStore,rootStore:o,activity:r,tabArgs:n})});case"group":return(0,J.jsx)("div",{style:s.group,children:(0,J.jsx)(b().sA,{defaultMessage:"You will now get notifications when @{groupName} is mentioned",id:"activity.userInvitedActivity.groupInviteExplanation",values:{groupName:null===(t=i.group)||void 0===t?void 0:t.name}})});case"space":return(0,J.jsx)(ee,{children:(0,J.jsx)("div",{style:s.titleCardWrapper,children:(0,J.jsx)(Xi,{tabArgs:n,titledRecordStore:i.spaceStore,rootStore:o,activity:r})})});default:(0,x().HB)(i)}}function Go(e){var t,i;const{data:o,authors:r,isFromBot:s}=e,a=(0,n().K8)((()=>(0,c().bD)(r,{...(0,R()._m)()})),[r]);switch(o.type){case"block":return s?(0,J.jsx)(b().sA,{defaultMessage:"You were invited to a page",id:"activity.userInvitedActivityByBot.standardizedHeader.redesign"}):(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a page} other {{authorOrAuthors} invited you to a page}}",values:{numberOfAuthors:r.length,authorOrAuthors:a},id:"activity.userInvitedActivity.standardizedHeader.redesign"});case"group":return s?(0,J.jsx)(b().sA,{defaultMessage:"You were added to @{groupName}",values:{groupName:null===(t=o.group)||void 0===t?void 0:t.name},id:"activity.userInvitedActivityGroupIdByBot.standardizedHeader.redesign"}):(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to @{groupName}} other {{authorOrAuthors} added you to @{groupName}}}",values:{numberOfAuthors:r.length,authorOrAuthors:a,groupName:null===(i=o.group)||void 0===i?void 0:i.name},id:"activity.userInvitedActivityGroupId.standardizedHeader.redesign"});case"space":return s?(0,J.jsx)(b().sA,{defaultMessage:"You were invited to a workspace",id:"activity.userInvitedActivityOtherInviteByBot.standardizedHeader.redesign"}):(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a workspace} other {{authorOrAuthors} invited you to a workspace}}",values:{numberOfAuthors:r.length,authorOrAuthors:a},id:"activity.userInvitedActivityOtherInvite.standardizedHeader.redesign"});default:(0,x().HB)(o)}}function Yo(e){const{edit:t,activity:i,rootStore:o}=e,r=(0,u().IS)((()=>({redesignedInviteMessage:{fontSize:14,paddingTop:8,paddingBottom:8}})),[]),s=Qo({rootStore:o,edit:t}),a=(0,n().K8)((()=>parseInt(i.end_time)),[i]),l=(0,n().K8)((()=>{if("block"!==(null==s?void 0:s.type))return;const e=s.blockStore;return null!=e&&e.isDefined()?e.getModel():void 0}),[s]),d=(0,n().K8)((()=>{if(!l)return{isValid:!1};const e=l&&(0,Fo()._T)(l,i);if(!e)return{isValid:!1};const t=o.getRecordModel({table:Eo().Yx,id:e,spaceId:i.space_id});return t&&t.getMessage()&&t.getCreatedTime()<=a+5*Vo().Xb?{isValid:!0,message:t.getMessage()}:{isValid:!1}}),[i,a,l,o]);return null!=d&&d.isValid?(0,J.jsx)("div",{style:r.redesignedInviteMessage,children:d.message}):null}function Qo(e){let{rootStore:t,edit:i}=e;return(0,n().K8)((()=>{if(i)return i.navigable_block_id?{type:"block",blockStore:w().Bv.createChildStore(t,{table:v().ev,id:i.navigable_block_id})}:i.permission_group_id?{type:"group",group:(0,Oo().$I)({spaceId:i.space_id,permissionGroupId:i.permission_group_id,getRecordValue:t.getRecordValue})}:{type:"space",spaceStore:w().SL.createChildStore(t,{table:h().NX,id:i.space_id})}}),[i,t])}var Xo=()=>i(66689);function Jo(e){const{mentionedProperty:t,authorPhrase:i,authors:o}=e;switch(t){case Xo().yx.Assign:return(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} assigned you a task} other {{authorOrAuthors} assigned you a task}}",values:{numberOfAuthors:o.length,authorOrAuthors:i},id:"activity.mentionTaskActivity.standardizedHeader"});case Xo().K4.People:return(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in} other {{authorOrAuthors} mentioned you in}}",values:{numberOfAuthors:o.length,authorOrAuthors:i},id:"activity.mentionProjectActivity.standardizedHeader.short"});default:return(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in} other {{authorOrAuthors} mentioned you in}}",values:{numberOfAuthors:o.length,authorOrAuthors:i},id:"activity.mentionActivity.standardizedHeader.short"})}}var Zo=()=>i(372160),er=()=>i(519831),tr=()=>i(931075);function ir(){const e=(0,u().IS)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,J.jsx)(he,{children:(0,Zo().E)(e.icon)})}const or={"block-property-edited":function(e){const{activity:t,rootStore:o,tabArgs:s,isFirst:a,isLast:l}=e,{tab:d,notification:u}=s,g=(0,n().K8)((()=>(0,Ft().W9)(t.getEdits())),[t]),p=g.length>0,h=(0,n().K8)((()=>w().Bv.createChildStore(o,{table:v().ev,id:g[0].navigable_block_id})),[o,g]),f=(0,n().K8)((()=>{const e=h.getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:m().y8.Notification})}),[h,o]),y=(0,n().K8)((()=>(0,c().Ln)({edits:g,rootStore:o})),[g,o]),x=(0,r().v3)(),S=(0,n().K8)((()=>(0,c().bD)(y,{...(0,R()._m)()})),[y]),A=(0,n().K8)((()=>(0,c().DU)({recordId:h.id,recordType:"block",tab:d,rootStore:o,environment:x})),[h,d,o,x]);if(!(0,n().K8)((()=>h.isDefined()),[h])||!p)return null;const j=new Set;return g.forEach((e=>{Object.keys(e.property_updates).forEach((e=>{j.add(e)}))})),(0,J.jsx)(fe,{header:j.size>1?(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated properties} other {{authorOrAuthors} updated properties}}",id:"activity.blockEdited.standardizedHeader.multiple",values:{numberOfAuthors:y.length,authorOrAuthors:S}})}):(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated a property} other {{authorOrAuthors} updated a property}}",id:"activity.blockEdited.standardizedHeader.single",values:{numberOfAuthors:y.length,authorOrAuthors:S}})}),isFirst:a,isLast:l,isPrivate:A,rootStore:o,navigableBlockId:h.id,notification:u,icon:(0,J.jsx)(tt().H8,{authors:y,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:f,...(0,ze().$5)({notification:u,activity:t,environment:x,tab:d}),children:(0,J.jsx)(i(6533).A,{visible:5,items:g.map(((e,t)=>(0,J.jsx)(Vt().A,{edit:e,rootStore:o},t)))})})},"user-mentioned":function(e){const{activity:t,rootStore:o,tabArgs:s,isFirst:a,isLast:l}=e,{tab:d,notification:u}=s,g=(0,r().v3)(),p=(0,n().K8)((()=>t.getEdits()),[t]),h=p.length>0,f=p[0],y=w().Bv.createChildStore(o,{table:v().ev,id:f.navigable_block_id}),b=(0,n().K8)((()=>y.isDefined()),[y]),x=(0,n().K8)((()=>w().xq.createChildStore(o,{table:i(801634).kz,id:t.id,spaceId:t.space_id}).getStandardizedMentionedPropertyURI()),[t,o]),S=(0,n().K8)((()=>{const e=w().Bv.createChildStore(o,{table:v().ev,id:t.mentioned_block_id}).getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:m().y8.Notification})}),[t,o]),A=(0,n().K8)((()=>(0,c().Ln)({edits:p,rootStore:o})),[p,o]),j=(0,n().K8)((()=>(0,c().bD)(A,{...(0,R()._m)()})),[A]),_=(0,n().K8)((()=>(0,c().DU)({recordId:y.id,recordType:"block",tab:d,rootStore:o,environment:g})),[y,d,o,g]);return h&&b&&S?(0,J.jsx)(fe,{header:(0,J.jsx)(Jo,{mentionedProperty:x,authorPhrase:j,authors:A}),isFirst:a,isLast:l,isPrivate:_,rootStore:o,navigableBlockId:y.id,notification:u,icon:(0,J.jsx)(tt().H8,{authors:A,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:S,...(0,ze().$5)({notification:u,activity:t,environment:g,tab:d}),children:(0,J.jsx)(Vt().A,{edit:f,rootStore:o,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):null},commented:Ki,"user-invited":o.memo(Ho),reminder:function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d}=o,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),p=g.length>0,h=w().Bv.createChildStore(i,{table:v().ev,id:g[0].navigable_block_id}),f=(0,n().K8)((()=>h.isDefined()),[h]),y=(0,n().K8)((()=>{const e=w().Bv.createChildStore(i,{table:v().ev,id:t.reminder_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification})}),[t,i]),x=(0,n().K8)((()=>(0,c().DU)({recordId:h.id,recordType:v().ev,tab:d,rootStore:i,environment:u})),[h,d,i,u]);return p&&f&&y?(0,J.jsx)(fe,{header:(0,J.jsx)("span",{style:{fontWeight:S().Wy.medium},children:(0,J.jsx)(b().sA,{defaultMessage:"Reminder",id:"activity.reminderInActivity.header.short"})}),isFirst:s,isLast:a,isPrivate:x,rootStore:i,navigableBlockId:h.id,notification:l,icon:(0,J.jsx)(ko,{}),showSnapshotButton:!1,url:y,...(0,ze().$5)({notification:l,activity:t,environment:u,tab:d}),children:(0,J.jsx)(Vt().A,{edit:g[0],rootStore:i})}):null},"email-edited":Ti,"access-requested":mt,"access-request-resolved":ht,"team-membership-edited":function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d}=o,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),p=g.length>0,v=(0,n().K8)((()=>(0,c().Ln)({edits:g,rootStore:i})),[g,i]),h=(0,n().K8)((()=>(0,c().bD)(v,{...(0,R()._m)()})),[v]),y=g[0],x=w().h4.createChildStore(i,{table:f().yK,id:y.team_id}),S=(0,n().K8)((()=>x.isDefined()),[x]),A=(0,n().K8)((()=>{if((0,Bo().D)({isMobileNative:u.device.isMobileNative}))return(0,Io().a)({teamId:y.team_id,pageVisitSource:m().y8.Notification})}),[y.team_id,u]);return p&&S?(0,J.jsx)(fe,{header:(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a teamspace} other {{authorOrAuthors} invited you to a teamspace}}",values:{numberOfAuthors:v.length,authorOrAuthors:h},id:"activity.userInvitedToTeamActivity.standardizedHeader"}),isFirst:s,isLast:a,isPrivate:!1,rootStore:i,notification:l,icon:(0,J.jsx)(tt().H8,{authors:v,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:A,...(0,ze().$5)({notification:l,activity:t,environment:u,tab:d}),children:(0,J.jsx)(ee,{children:(0,J.jsx)(To,{titledRecordStore:x,rootStore:i,activity:t,tabArgs:o,notification:l})})}):null},"private-content-transferred":Ao,"permission-group-mentioned":function(e){const{activity:t,rootStore:i,isFirst:o,isLast:s,tabArgs:a}=e,{tab:l,notification:d}=a,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),p=g.length>0,h=g[0],f=w().Bv.createChildStore(i,{table:v().ev,id:h.navigable_block_id}),y=(0,n().K8)((()=>f.isDefined()),[f]),x=(0,n().K8)((()=>{const e=w().Bv.createChildStore(i,{table:v().ev,id:t.mentioned_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification})}),[t,i]),S=(0,n().K8)((()=>(0,c().Ln)({edits:t.getEdits(),rootStore:i})),[t,i]),A=(0,n().K8)((()=>(0,c().bD)(S,{...(0,R()._m)()})),[S]),j=(0,n().K8)((()=>(0,c().DU)({recordId:f.id,recordType:v().ev,tab:l,rootStore:i,environment:u})),[f,l,i,u]);return p&&y&&x?(0,J.jsx)(fe,{header:(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned your group} other {{authorOrAuthors} mentioned your group}}",values:{numberOfAuthors:S.length,authorOrAuthors:A},id:"activity.groupMentionActivity.standardizedHeader.short"})}),isFirst:o,isLast:s,isPrivate:j,rootStore:i,navigableBlockId:f.id,notification:d,icon:(0,J.jsx)(tt().H8,{authors:S,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:x,...(0,ze().$5)({notification:d,activity:t,environment:u,tab:l}),children:(0,J.jsx)(Vt().A,{edit:h,rootStore:i,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):null},"team-mentioned":function(e){const{activity:t,rootStore:i,isFirst:o,isLast:s,tabArgs:a}=e,{tab:l,notification:d}=a,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),p=g.length>0,h=g[0],f=(0,n().K8)((()=>w().Bv.createChildStore(i,{table:v().ev,id:h.navigable_block_id})),[h,i]),y=(0,n().K8)((()=>f&&f.isDefined()),[f]),x=(0,n().K8)((()=>{const e=w().Bv.createChildStore(i,{table:v().ev,id:t.mentioned_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification})}),[t,i]),S=(0,n().K8)((()=>(0,c().Ln)({edits:t.getEdits(),rootStore:i})),[t,i]),A=(0,n().K8)((()=>(0,c().bD)(S,{...(0,R()._m)()})),[S]),j=(0,n().K8)((()=>(0,c().DU)({recordId:f.id,recordType:v().ev,tab:l,rootStore:i,environment:u})),[f,l,i,u]);return p&&y&&x?(0,J.jsx)(fe,{header:(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned your teamspace} other {{authorOrAuthors} mentioned your teamspace}}",values:{numberOfAuthors:S.length,authorOrAuthors:A},id:"activity.teamMentionActivity.standardizedHeader.short"})}),isFirst:o,isLast:s,isPrivate:j,rootStore:i,navigableBlockId:f.id,notification:d,icon:(0,J.jsx)(tt().H8,{authors:S,size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:x,...(0,ze().$5)({notification:d,activity:t,environment:u,tab:l}),children:(0,J.jsx)(Vt().A,{edit:h,rootStore:i,highlightCurrentUser:!0,highlightCurrentUserStyle:"text_only"})}):null},"verification-expired":function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{tab:l,notification:d}=o,g=(0,r().v3)(),p=(0,n().K8)((()=>w().Bv.createChildStore(i,{table:v().ev,id:t.navigable_block_id})),[t,i]),h=(0,n().K8)((()=>p.isDefined()),[p]),f=(0,n().K8)((()=>{const e=p.getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification})}),[p,i]),y=(0,n().K8)((()=>t.collection_id?w().md.createChildStore(i,{table:er().Vl,id:t.collection_id,spaceId:t.space_id}):void 0),[t,i]),x=(0,n().K8)((()=>Boolean(null==y?void 0:y.isPageTreeCollection())),[y]),A=(0,n().K8)((()=>{let e;if(x){const t=null==y?void 0:y.getSchema();e=(t?Object.keys(t):[]).find((e=>{var i;return!!t&&"verification"===(null===(i=t[e])||void 0===i?void 0:i.type)}))}else e=tr()._e.Verification;let t=(0,J.jsx)(b().sA,{id:"Activity.author.unknown",defaultMessage:"Unknown"});if(e){const o=p.getPropertyValue(e),r=(0,tr().U1)(o);if(r){const e=r[0],o=(0,c().T9)(e,i);o&&o.asActor&&(t=(0,c().bD)([o],{...(0,R()._m)()}))}}return t}),[p,y,x,i]),j=(0,n().K8)((()=>(0,c().DU)({recordId:p.id,recordType:"block",tab:l,rootStore:i,environment:g})),[p,l,i,g]),{activityStartTimestamp:_,activityEndTimestamp:M}=(0,n().K8)((()=>({activityStartTimestamp:parseInt(t.start_time),activityEndTimestamp:parseInt(t.end_time)})),[t]),C=(0,u().IS)((e=>({verificationMessage:{fontSize:14,color:e.text.secondary}})),[]);return h?(0,J.jsx)(fe,{header:x?(0,J.jsx)(b().sA,{defaultMessage:"<medium>Wiki verification</medium> expired",id:"activity.verificationExpired.header.short",values:{medium:e=>(0,J.jsx)("span",{style:{fontWeight:S().Wy.medium},children:e})}}):(0,J.jsx)(b().sA,{defaultMessage:"<medium>Page verification</medium> expired",id:"activity.verificationExpired.page.header.short",values:{medium:e=>(0,J.jsx)("span",{style:{fontWeight:S().Wy.medium},children:e})}}),isFirst:s,isLast:a,isPrivate:j,rootStore:y??i,navigableBlockId:p.id,notification:d,icon:(0,J.jsx)(ir,{}),showSnapshotButton:!1,url:f,...(0,ze().$5)({notification:d,activity:t,environment:g,tab:l}),children:(0,J.jsx)("div",{style:C.verificationMessage,children:_&&M?(0,J.jsx)(b().sA,{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:A,startDate:(0,U().DG)(_),endDate:(0,U().DG)(M)},id:"activity.verificationExpired.contentWithTimestamp"}):(0,J.jsx)(b().sA,{defaultMessage:"Last verified by {person}",values:{person:A},id:"activity.verificationExpired.contentWithoutTimestamp"})})}):null},"export-completed":function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{tab:l,notification:d}=o,c=(0,r().v3)(),{edits:g}=(0,n().K8)((()=>({edits:t.getEdits()})),[t]),m=(0,u().IS)((e=>({newContainer:{paddingTop:12,paddingBottom:4},actionButton:(0,it().Ei)(e)})),[]),p=(0,J.jsx)(b().sA,{defaultMessage:"Your workspace export is ready",id:"activity.exportCompleted.header"}),v=(0,J.jsx)(Ni().Ye,{style:{fontSize:12},children:(0,J.jsx)(b().sA,{defaultMessage:"The download link will expire in 7 days.",id:"activity.exportCompleted.downloadLink"})});return(0,J.jsxs)(fe,{header:p,isFirst:s,isLast:a,isPrivate:!0,rootStore:i,notification:d,icon:(0,J.jsx)(Pi,{}),showSnapshotButton:!1,url:void 0,...(0,ze().$5)({notification:d,activity:t,environment:c,tab:l}),children:[v,(0,J.jsx)("div",{style:m.newContainer,children:(0,J.jsx)(ye().p,{isGray:!0,size:"xs",onClick:()=>{window.open(g[0].link,"_blank")},style:m.actionButton,children:(0,J.jsx)(b().sA,{defaultMessage:"Download",id:"activity.actions.exportCompleted.download"})})})]})},"import-completed":function(e){var t;const{activity:s,rootStore:a,tabArgs:l,isFirst:d,isLast:c}=e,{tab:g,notification:p,source:h}=l,f=(0,r().v3)(),{edits:y}=(0,n().K8)((()=>({edits:s.getEdits()})),[s]),x=null===(t=y[0])||void 0===t?void 0:t.teamspace_id,S=(0,Vi().useTeamsFromCache)(),A=(0,o.useMemo)((()=>S.find((e=>e.id===x))),[x,S]),j=(0,n().K8)((()=>null==A?void 0:A.getName()),[A]),_=f.device.isMobile,M=(0,u().IS)((e=>({newContainerLinkBox:{...(0,it().aY)({source:h,isMobile:_}),display:"flex",alignItems:"center",fontSize:Fi().ny(f,"UIRegular"),paddingTop:2,paddingBottom:6,marginBottom:0,paddingLeft:0,width:"100%"}})),[_,h,f]);if(!y.length)return(0,J.jsx)(J.Fragment,{});const{import_source:R,import_status:C,version:k,landing_page:I,collection_page_ids:B}=y[0],K=(0,J.jsx)(b().sA,{defaultMessage:"Your {importSource} import has failed",id:"activity.importFailed.header",values:{importSource:R,importStatus:C}}),T=(0,J.jsx)(b().sA,{defaultMessage:"Your {importSource} import was successful",id:"activity.importSuccess.header",values:{importSource:R,importStatus:C}}),q=(0,J.jsx)(Ni().Ye,{style:{fontSize:Fi().ny(f,"UISmall")},children:(0,J.jsx)(b().sA,{defaultMessage:"View projects and tasks in Notion",id:"activity.importCompleted.projects.redirect"})}),N=(0,J.jsx)(Ni().Ye,{style:{fontSize:Fi().ny(f,"UISmall")},children:(0,J.jsx)(b().sA,{defaultMessage:"View boards in Notion",id:"activity.importCompleted.boards.redirect"})}),P=(0,J.jsx)(Ni().Ye,{style:{fontSize:Fi().ny(f,"UISmall")},children:(0,J.jsx)(b().sA,{defaultMessage:"View import logs",id:"activity.importCompleted.loggerPage.redirect"})}),L=(0,Wi().A)({pageId:I,pageVisitSource:m().y8.Import});let D="successful"===C?T:K,z=(0,J.jsx)(Ni().Ye,{children:(0,J.jsx)(ni().A,{href:L,innerStyle:M.newContainerLinkBox,children:"successful"===C?"Monday"===R&&"v2"===k?N:q:P})});const U="Jira"===R?(0,J.jsx)(Zi,{}):(0,J.jsx)(Ji,{}),W=null==B?void 0:B[0];if("Jira"===R){const{headerComponent:e,bodyComponent:t}=(()=>{let e,t;if(A&&"successful"===C&&(e=(0,J.jsxs)("div",{children:[(0,J.jsx)(b().sA,{defaultMessage:"Your Jira projects and tasks have been synced to",id:"activity.importCompleted.jira.success.header"})," ",(0,J.jsx)("div",{style:{display:"inline-block",position:"relative"},children:(0,J.jsx)(i(898808).x,{disabled:!0,store:A,size:20})})," ",(0,J.jsx)("span",{children:j})]})),W){const e=w().Bv.createChildStore(a,{id:W.projectCollectionPageId,spaceId:a.id,table:v().ev}),i=w().Bv.createChildStore(a,{id:W.taskCollectionPageId,spaceId:a.id,table:v().ev});t=(0,J.jsxs)("div",{style:{paddingRight:12},children:[(0,J.jsx)(Xi,{titledRecordStore:e,rootStore:a,activity:s,tabArgs:l}),(0,J.jsx)("div",{style:{height:6}}),(0,J.jsx)(Xi,{titledRecordStore:i,rootStore:a,activity:s,tabArgs:l})]})}return{headerComponent:e,bodyComponent:t}})();t&&(z=t),e&&(D=e)}return(0,J.jsx)(fe,{url:void 0,header:D,isPrivate:!0,isFirst:d,isLast:c,rootStore:a,notification:p,icon:U,showSnapshotButton:!1,...(0,ze().$5)({notification:p,activity:s,environment:f,tab:g}),children:z})},"in-app-notification-automation-action-triggered":function(e){const{activity:t,tabArgs:i}=e,{tab:o,notification:s}=i,a=(0,r().v3)(),l=(0,n().K8)((()=>t.getEdits()),[t]),d=l.length>0,c={tab:o,notificationId:null==s?void 0:s.id,environment:a,alreadyRead:Boolean(null==s?void 0:s.read),activity:t},g=(0,u().IS)((e=>({notificationContainer:{paddingBlock:"8px 4px",display:"flex",flexDirection:"column",rowGap:8}})),[]);return d?(0,J.jsx)(bo,{analyticsInfo:c,children:(0,J.jsx)(uo,{...e,edits:l,style:g.notificationContainer})}):null},"no-conflicts-found":function(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{tab:l,notification:d}=o,c=(0,r().v3)(),u=(0,b().tz)(),g=(0,n().K8)((()=>t.navigable_block_id),[t]),p=(0,n().K8)((()=>{const e=So().B.createChildStore(i,{table:v().ev,id:t.navigable_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification})}),[t,i]),h=(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"<b>{author}</b> did not find conflicts",id:"activity.noConflictsFound.header",values:{author:xo().px.getDisplayName(u),b:e=>(0,J.jsx)("span",{style:{fontWeight:S().Wy.semibold},children:e})}})});return p?(0,J.jsx)(fe,{header:h,isFirst:s,isLast:a,isPrivate:!0,rootStore:i,navigableBlockId:g,notification:d,icon:(0,J.jsx)(tt().H8,{authors:[xo().px],size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:p,...(0,ze().$5)({notification:d,activity:t,environment:c,tab:l})}):null},"automation-typecheck-error-raised":function(e){const{rootStore:t,activity:i,isLast:s,tabArgs:a,isFirst:l}=e,{tab:g,notification:p}=a,h=(0,b().tz)(),f=(0,r().v3)(),y=(0,n().K8)((()=>i.getEdits()),[i]),A=y.at(0),j=(0,u().IS)((e=>({notificationContainer:{paddingTop:4,display:"flex",flexDirection:"column",rowGap:8},editAutomation:{marginTop:8,height:26,fontWeight:S().Wy.medium},messageContainer:{alignItems:"center",color:e.text.secondary,display:"flex",fontSize:ue,justifyContent:"space-between",lineHeight:S().K_.UIRegular.desktop,paddingInlineEnd:12,position:"relative"},headerName:{fontWeight:S().Wy.medium,display:"inline-flex"}})),[]),_=(0,o.useMemo)((()=>new Set(y.map((e=>e.automation_id)))),[y]),M=(0,n().K8)((()=>{if(!(0,x().O9)(A))return!1;return!w().dn.createChildStore(t,{table:Tt().yB,id:A.automation_id,spaceId:t.getSpaceId()}).getAlive()}),[t,A]),{handleNavigateToAutomation:R,navigableBlockStore:C,navigableBlockUrl:k}=function(e){let{edit:t,rootStore:i,uniqueAutomationIds:o}=e;const s=(0,r().v3)(),a=1===o.size,l=(0,n().K8)((()=>{if(!(0,x().O9)(t))return!1;return!w().dn.createChildStore(i,{table:Tt().yB,id:t.automation_id,spaceId:i.getSpaceId()}).getAlive()}),[i,t]),d=(0,n().K8)((()=>{if((0,x().O9)(t))return new(w().Bv)(s,{id:t.automation_navigable_block_id,table:v().ev})}),[t,s]),c=(0,n().K8)((()=>{if(!(0,x().O9)(d))return!0;const e=d.getRole();return!e||!(0,Ie().Tt)(e)}),[d]),u=(0,n().K8)((()=>{if((0,x().O9)(d))return(0,Rt().Ay)({store:d,preferPublicLink:!1,pageVisitSource:m().y8.Notification})}),[d]),g=(0,n().K8)((()=>c||!(0,x().O9)(t)?()=>{}:()=>{const e=t.automation_id;d&&u&&((0,qt().u4)({environment:s,event:{eventName:"click_automation_typecheck_error_notification",eventProperties:{block_id:d.id,automation_id:e}}}),Mt().oo({environment:s,url:u,callback:async()=>await Wt({environment:s,automationNavigableBlockStore:d,automationId:a&&!l?e:void 0,rootStore:i,source:"automation_typecheck_error_raised_notification"})}))}),[l,a,c,t,d,u,s,i]);return{handleNavigateToAutomation:g,navigableBlockStore:d,navigableBlockUrl:u}}({edit:A,rootStore:t,uniqueAutomationIds:_}),I=(0,n().K8)((()=>(0,c().DU)({recordId:null==C?void 0:C.id,recordType:v().ev,tab:g,rootStore:t,environment:f})),[C,g,t,f]),B=(0,n().K8)((()=>{const e=_.values().next().value;if(e){return t.getRecordStore(t,{table:Tt().yB,id:e,spaceId:i.spaceId}).getNameWithDefault(h)}return""}),[i.spaceId,h,t,_]),K=(0,n().K8)((()=>[..._].map((e=>{const o=t.getRecordStore(t,{table:Tt().yB,id:e,spaceId:i.spaceId}),r=o.getRole();return(0,x().O9)(r)&&(0,Ie().Tt)(r)?o.getAlive()?o.getNameWithDefault(h):h.formatMessage(Kt().VS.automationDeletedName):h.formatMessage(Kt().VS.automationPrivateName)}))),[h,t,i,_]),q=(0,o.useCallback)((e=>{(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{N().createAndCommit({userAction:"AutomationTypecheckErrorRaisedActivity.viewError",environment:f,canUndo:!0,perform:e=>{T().ZB({notification:p,rootStore:t,transaction:e,read:!0})}}),R(),Ke().K4({tab:g,notificationId:null==p?void 0:p.id,environment:f,alreadyRead:Boolean(null==p?void 0:p.read),activity:i})}})}),[i,f,R,p,t,g]),P=(0,d().X)("automation_updated_error_states");if(!(0,x().O9)(C)||!(0,x().O9)(A)||0===y.length||!P)return null;const L=(0,J.jsx)("div",{style:j.headerName,children:(0,J.jsx)(Ot,{handleAutomationNavigate:q,automationNames:K})}),z=M&&1===_.size;return(0,J.jsx)(fe,{header:(0,J.jsx)(b().sA,{id:"AutomationTypecheckErrorRaisedActivity.formattedHeaderMessage.automationTitle",defaultMessage:"{automationNames} {numAutomationNames, plural, one {is} other {are}} invalid",values:{numAutomationNames:_.size,automationNames:L}}),isFirst:l,isLast:s,isPrivate:I,rootStore:t,navigableBlockId:C.id,notification:p,icon:(0,J.jsx)(Et,{automationName:B}),showSnapshotButton:!1,url:k,...(0,ze().$5)({notification:p,activity:i,environment:f,tab:g}),children:(0,J.jsx)("div",{style:j.notificationContainer,onClick:q,children:!z&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:j.messageContainer,children:(0,J.jsx)(b().sA,{id:"AutomationTypecheckErrorRaisedActivity.formattedHeaderMessage.automationMessage",defaultMessage:"Resolve any errors or remove failing steps to enable {numAutomationNames, plural, one {this automation} other {these automations}}",values:{numAutomationNames:_.size}})}),(0,J.jsx)("div",{children:(0,J.jsx)(wt().A,{style:j.editAutomation,onClick:q,size:"sm",children:(0,J.jsx)(b().sA,{id:"AutomationTypecheckErrorRaisedActivity.editAutomation.automationMessage",defaultMessage:"Edit automation"})})})]})})})},reacted:function(e){const{activity:t,tabArgs:i,rootStore:o,isFirst:s,isLast:a}=e,{source:d,tab:u,notification:g}=i,p=(0,n().K8)((()=>t.getEdits()),[t]),h=(0,r().v3)(),f=(0,n().K8)((()=>{const e=t.discussion_id;if(!p||!t.discussion_id)return;const{reacted_comment_id:i}=p[0],r=i?jo().SN:l().$Y,n=i??e;return o.getRecordStore(o,{table:r,id:n,spaceId:t.space_id})}),[p,t,o]),y=(0,n().K8)((()=>{if(f){if(f.table===jo().SN){const e=f.getParentStore(),t=null==e?void 0:e.getParentPointer();if(!t)return;return w().Bv.createChildStore(o,t)}if(f.table===l().$Y){const e=f.getParentPointer();if(!e)return;return w().Bv.createChildStore(o,e)}}}),[f,o]),b=(0,n().K8)((()=>{const e=null==y?void 0:y.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,y]),A=(0,n().K8)((()=>{var e;if(y)return null===(e=y.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:o.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().y8.Notification})}),[y,o,t]),j=(0,n().K8)((()=>{if(!f)return[];const e=(f.getReactionPointers()??[]).map((e=>w().sk.createChildStore(o,e)));let t;var i;f instanceof w().jg&&(t=null===(i=f.getCreatedById)||void 0===i?void 0:i.call(f));if(f instanceof w().cc){const e=f.getParentStore();t=null==e?void 0:e.getCreatedById()}const r=(0,K().hS)(e.flatMap((e=>{var t;return(null===(t=e.getActorPointers())||void 0===t?void 0:t.filter(x().O9))??[]})).filter((e=>e.id!==t)),"id"),n=new Map;null==p||p.forEach((e=>{"reaction-created"===e.type&&e.authors&&e.authors.forEach((t=>{const i=n.get(t.id)??0;e.timestamp>i&&n.set(t.id,e.timestamp)}))}));return r.sort(((e,t)=>{const i=n.get(e.id)??0;return(n.get(t.id)??0)-i})).map((e=>w().sk.createChildStore(o,e)))}),[f,o,p]),{frontActorStore:_,backActorStore:M}=(0,n().K8)((()=>{const e=h.currentUser.id;if(!e||0===j.length)return{frontActorStore:void 0,backActorStore:void 0};const i=j.map((e=>w().sk.createChildStore(o,{table:e.table,id:e.id,spaceId:t.space_id})));return(0,c()._S)({authorStores:i,currentUserId:e})}),[j,h.currentUser.id,o,t.space_id]),R=(0,n().K8)((()=>(0,c().DU)({recordId:t.navigable_block_id,recordType:v().ev,tab:u,rootStore:o,environment:h})),[t,o,u,h]),C=(0,n().K8)((()=>{if(null==p||!p.length)return;const e=p.filter((e=>"reaction-created"===e.type)).reduce(((e,t)=>e.timestamp>t.timestamp?e:t),p[0]);if(null==e||!e.reaction_id)return;const i=o.getRecordStore(o,{table:_o().ez,id:e.reaction_id,spaceId:t.space_id});return null==i?void 0:i.getIcon()}),[t,o,p]);return(0,J.jsx)(fe,{header:f&&(0,J.jsx)(Ro,{authorCount:j.length,authorPhrase:(0,J.jsx)(ki,{authorsLength:j.length,frontActorStore:_,backActorStore:M,authorTextStyle:{fontWeight:S().Wy.medium}}),targetStore:f}),isFirst:s,isLast:a,isPrivate:R,rootStore:o,navigableBlockId:b,notification:g,icon:C?(0,J.jsx)(Mo().A,{char:C,size:18}):void 0,showSnapshotButton:!1,url:A,...(0,ze().$5)({notification:g,environment:h,tab:u,activity:t}),children:f&&(0,J.jsx)(wo,{targetStore:f,source:d})})},"upgrade-request-created":Wo,"app-builder-notification":kt,"external-integration-notification":zi,"trial-created":Lo};var rr=()=>i(61548),nr=()=>i(260414);function sr(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a,guestInviteRequestModel:l}=e,{notification:d,tab:c,source:g}=o,p=(0,r().v3)(),h=(0,b().tz)(),f=(0,n().K8)((()=>w().v3.createChildStore(i,{table:l.table,id:l.id,spaceId:l.spaceId})),[l,i]),y=(0,n().K8)((()=>f.getModel()),[f]),x=(0,n().K8)((()=>{if(!y)return;const e=i.getSpaceId();if(!e)return;const t=y.getCreatedByPointer(e);return w().sk.createChildStore(i,t)}),[y,i]),A=(0,n().K8)((()=>{if(x&&x instanceof w().LU)return x.getDisplayName(h)}),[x,h]),j=(0,n().K8)((()=>{if(t.navigable_block_id)return w().Bv.createChildStore(i,{table:v().ev,id:t.navigable_block_id})}),[t,i]),_=(0,n().K8)((()=>{var e;return null==j||null===(e=j.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:i.getRecordModel})}),[j,i]),M=(0,n().K8)((()=>(null==j?void 0:j.isEmptyPage())??!1),[j]),R=(0,n().K8)((()=>{if(!j)return;const e=j.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().y8.Notification}):void 0}),[j,i,t]),C=(0,n().K8)((()=>{const e=null==y?void 0:y.getForActorPointer(i.getSpaceId());if(!e)return;const t=w().sk.createChildStore(i,e);return t&&t instanceof w().LU?t.getEmail():void 0}),[y,i]),k=(0,u().IS)((e=>({externalUser:{color:e.accentColors.yellow[300]}})),[]),I="actor"===(0,oi().r)("notification_ia"),B=(0,n().K8)((()=>{var e;return null==x||null===(e=x.getModel())||void 0===e?void 0:e.asActor}),[x]);return I?(0,J.jsx)(rr().my,{notificationTitleStore:j,header:{icon:(0,J.jsx)(tt().H8,{authors:B?[B]:[],size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:A},subheader:(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{defaultMessage:"Requested access to {pageTitleAndIcon}",id:"activity.guestInviteRequest.subheader",values:{pageTitleAndIcon:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:_,isEmptyPage:M,size:16}),j&&(0,J.jsx)(G().A,{store:j,style:{fontWeight:S().Wy.medium}})]})}})}),body:(0,J.jsx)(b().sA,{id:"activity.guestInviteRequest.bodyMessage",defaultMessage:"Requested access for {guestEmail} <yellow>(external user)</yellow>",values:{guestEmail:C,yellow:e=>(0,J.jsx)("span",{style:k.externalUser,children:e})}}),isFirst:s,isLast:a,rootStore:i,notification:d,url:R,...(0,ze().$5)({notification:d,activity:t,environment:p,tab:c}),children:(0,J.jsx)(ar,{activity:t,accessRequestStore:f,rootStore:i,source:g,notification:d,tabArgs:o})}):(0,J.jsx)(nr().Nx,{subheader:A,body:(0,J.jsx)(b().sA,{id:"activity.guestInviteRequest.bodyMessage",defaultMessage:"Requested access for {guestEmail} <yellow>(external user)</yellow>",values:{guestEmail:C,yellow:e=>(0,J.jsx)("span",{style:k.externalUser,children:e})}}),isFirst:s,isLast:a,rootStore:i,notification:d,url:R,...(0,ze().$5)({notification:d,activity:t,environment:p,tab:c}),children:(0,J.jsx)(ar,{activity:t,accessRequestStore:f,rootStore:i,source:g,notification:d,tabArgs:o})})}function ar(e){const{activity:t,accessRequestStore:i,rootStore:s,notification:a,tabArgs:l}=e,d=(0,r().v3)(),c=(0,n().K8)((()=>t.getEdits()),[t])[0],m=(0,n().K8)((()=>i.getParentTable()),[i]),p=(0,n().K8)((()=>i.getParentId()),[i]),y=(0,n().K8)((()=>t.navigable_block_id),[t]),b=(0,n().K8)((()=>i.getModel()),[i]),S=(0,n().K8)((()=>b&&(0,g().C)(b)),[b]),j=(0,M().I)({spaceStore:s,request:b}),_=(0,n().K8)((()=>{if("page_access_request"===S){var e;const t=null==b||null===(e=b.getAttributes())||void 0===e||null===(e=e.permission_records_and_roles)||void 0===e||null===(e=e.at(0))||void 0===e?void 0:e.role;if(t)return t}return"reader"}),[b,S]),R=(0,o.useCallback)((async()=>{if(S&&j&&b)if("space_membership_request"===j&&"space_membership_request"===S)await A().p4({status:"approved",environment:d,requests:[b],store:s,from:"notification"});else if("space_membership_request"===j&&"guest_invite_request"===S)await A().KB({status:"approved",environment:d,store:s,requests:[b],from:"notification"});else{if("guest_invite_request"!==S)return;await A().aV({status:"approved",environment:d,requests:[b],from:"notification"})}}),[d,b,s,j,S]),C=(0,o.useCallback)((async()=>{if(S&&b)if("space_membership_request"===S)await A().p4({status:"rejected",environment:d,requests:[b],store:s,from:"notification"});else if("guest_invite_request"===S)await A().aV({status:"rejected",environment:d,requests:[b],from:"notification"});else{if("team_membership_request"===S||"page_access_request"===S)return;(0,x().HB)(S)}}),[d,b,s,S]),k=(0,u().IS)((e=>({actionPrimaryContainer:{paddingTop:0,paddingBottom:0,paddingRight:0},actionButton:(0,it().Ei)(e)})),[]),I=y?w().Bv.createChildStore(s,{table:v().ev,id:y}):void 0,B=(0,n().K8)((()=>m===v().ev&&Boolean(null==I?void 0:I.canAdmin())),[m,I]);if(!(m&&p&&j&&c))return null;if("page_access_request"===j)return B&&I?(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Oe,{accessRequestStore:i,targetBlockStore:I,initialRole:_,buttonStyle:k.actionButton,notification:a,rootStore:s,activity:t,tabArgs:l})}):null;if("space_membership_request"===j||"guest_invite_request"===j){const e=w().SL.createChildStore(s,{table:h().NX,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Me,{effectiveAccessRequestType:j,accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:k.actionButton,notification:a,onApprove:R,onReject:C})})}if("team_membership_request"===j){const e=w().h4.createChildStore(s,{table:f().yK,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(be,{accessRequestStore:i,teamStore:e})})}(0,x().HB)(j)}const lr=o.memo(sr);function dr(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d,source:c}=o,g=(0,r().v3)(),h=(0,b().tz)(),f=(0,n().K8)((()=>t.getEdits()),[t])[0],y=(0,n().K8)((()=>w().v3.createChildStore(i,{table:p().O,id:t.access_request_id,spaceId:i.getSpaceId()})),[t,i]),x=(0,n().K8)((()=>y.getModel()),[y]),A=(0,n().K8)((()=>null==x?void 0:x.isEditPageAccessRequest()),[x]),_=(0,n().K8)((()=>Boolean(x&&(0,j().t)(x,i))),[x,i]),M=f.message,R=(0,n().K8)((()=>{if(!x)return;const e=i.getSpaceId();if(!e)return;const t=x.getCreatedByPointer(e);return w().sk.createChildStore(i,t)}),[x,i]),C=(0,n().K8)((()=>{if(t.navigable_block_id)return w().Bv.createChildStore(i,{table:v().ev,id:t.navigable_block_id})}),[t,i]),k=(0,n().K8)((()=>{if(!C)return;const e=C.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().y8.Notification}):void 0}),[C,i,t]),I=(0,n().K8)((()=>{if(R&&R instanceof w().LU)return R.getEmail()}),[R]),B=(0,n().K8)((()=>{if(R)return R.getDisplayName(h)}),[R,h]),K=(0,u().IS)((e=>({externalUser:{color:e.accentColors.yellow[300]}})),[]),T=(0,n().K8)((()=>{var e;if(!R)return[];const t=null===(e=R.getModel())||void 0===e?void 0:e.asActor;return t?[t]:[]}),[R]),q=(0,n().K8)((()=>{var e;if(!C)return null;const t=null===(e=C.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:i.getRecordModel}),o=C.isEmptyPage();return(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{id:"activity.pageAccessRequest.pageTitleText",defaultMessage:"Requested access to {pageTitle}",values:{pageTitle:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:t,isEmptyPage:o,size:16}),(0,J.jsx)(G().A,{store:C,style:{fontWeight:S().Wy.medium}})]})}})})}),[C,i]);return"actor"===(0,oi().r)("notification_ia")?(0,J.jsx)(rr().my,{notificationTitleStore:C,header:{icon:(0,J.jsx)(tt().H8,{authors:T,size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:B},subheader:q,body:M?(0,J.jsx)(b().sA,{id:"activity.pageAccessRequest.messageBody",defaultMessage:'"{message}"',values:{message:M}}):A?(0,J.jsx)(b().sA,{id:"activity.pageAccessRequest.bodyEditAccessNoMessage",defaultMessage:"Requested edit access"}):void 0,isFirst:s,isLast:a,rootStore:i,navigableBlockId:null==C?void 0:C.id,notification:l,url:k,...(0,ze().$5)({notification:l,activity:t,environment:g,tab:d}),children:(0,J.jsx)(cr,{activity:t,accessRequestStore:y,rootStore:i,source:c,notification:l,tabArgs:o})}):(0,J.jsx)(nr().Nx,{subheader:_?(0,J.jsx)(b().sA,{id:"activity.pageAccessRequest.externalUserSubheader",defaultMessage:"{requestingActorEmail} <yellow>(external user)</yellow>",values:{requestingActorEmail:I,yellow:e=>(0,J.jsx)("span",{style:K.externalUser,children:e})}}):I,body:M?(0,J.jsx)(b().sA,{id:"activity.pageAccessRequest.bodyMessage",defaultMessage:'Requested access, "{message}"',values:{message:M}}):A?(0,J.jsx)(b().sA,{id:"activity.pageAccessRequest.editAccessBodyNoMessage",defaultMessage:"Requested edit access"}):(0,J.jsx)(b().sA,{id:"activity.pageAccessRequest.bodyNoMessage",defaultMessage:"Requested access",values:{requestingActorName:B}}),isFirst:s,isLast:a,rootStore:i,notification:l,url:k,...(0,ze().$5)({notification:l,activity:t,environment:g,tab:d}),children:(0,J.jsx)(cr,{activity:t,accessRequestStore:y,rootStore:i,source:c,notification:l,tabArgs:o})})}function cr(e){const{activity:t,accessRequestStore:i,rootStore:s,notification:a,tabArgs:l}=e,d=(0,r().v3)(),c=(0,n().K8)((()=>t.getEdits()),[t])[0],m=(0,n().K8)((()=>i.getParentTable()),[i]),p=(0,n().K8)((()=>i.getParentId()),[i]),y=(0,n().K8)((()=>t.navigable_block_id),[t]),b=(0,n().K8)((()=>i.getModel()),[i]),S=(0,n().K8)((()=>b&&(0,g().C)(b)),[b]),j=(0,M().I)({spaceStore:s,request:b}),_=(0,n().K8)((()=>{if("page_access_request"===S){var e;const t=null==b||null===(e=b.getAttributes())||void 0===e||null===(e=e.permission_records_and_roles)||void 0===e||null===(e=e.at(0))||void 0===e?void 0:e.role;if(t)return t}return"reader"}),[b,S]),R=(0,o.useCallback)((async()=>{if(S&&j&&b)if("space_membership_request"===j&&"space_membership_request"===S)await A().p4({status:"approved",environment:d,requests:[b],store:s,from:"notification"});else if("space_membership_request"===j&&"guest_invite_request"===S)await A().KB({status:"approved",environment:d,store:s,requests:[b],from:"notification"});else{if("guest_invite_request"!==S)return;await A().aV({status:"approved",environment:d,requests:[b],from:"notification"})}}),[d,b,s,j,S]),C=(0,o.useCallback)((async()=>{if(S&&b)if("space_membership_request"===S)await A().p4({status:"rejected",environment:d,requests:[b],store:s,from:"notification"});else if("guest_invite_request"===S)await A().aV({status:"rejected",environment:d,requests:[b],from:"notification"});else{if("team_membership_request"===S||"page_access_request"===S)return;(0,x().HB)(S)}}),[d,b,s,S]),k=(0,u().IS)((e=>({actionPrimaryContainer:{paddingTop:0,paddingBottom:0,paddingRight:0},actionButton:(0,it().Ei)(e)})),[]),I=y?w().Bv.createChildStore(s,{table:v().ev,id:y}):void 0,B=(0,n().K8)((()=>m===v().ev&&Boolean(null==I?void 0:I.canAdmin())),[m,I]);if(!(m&&p&&j&&c))return null;if("page_access_request"===j)return B&&I?(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Oe,{accessRequestStore:i,targetBlockStore:I,initialRole:_,buttonStyle:k.actionButton,notification:a,rootStore:s,activity:t,tabArgs:l})}):null;if("space_membership_request"===j||"guest_invite_request"===j){const e=w().SL.createChildStore(s,{table:h().NX,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Me,{effectiveAccessRequestType:j,accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:k.actionButton,notification:a,onApprove:R,onReject:C})})}if("team_membership_request"===j){const e=w().h4.createChildStore(s,{table:f().yK,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(be,{accessRequestStore:i,teamStore:e})})}(0,x().HB)(j)}const ur=o.memo(dr);function gr(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d,source:c}=o,u=(0,r().v3)(),g=(0,b().tz)(),m=(0,n().K8)((()=>t.getEdits()),[t])[0],v=(0,n().K8)((()=>w().v3.createChildStore(i,{table:p().O,id:t.access_request_id})),[t,i]),h=(0,n().K8)((()=>v.getModel()),[v]),f=m.message,y=(0,n().K8)((()=>{if(!h)return;const e=h.getCreatedByPointer(i.getSpaceId());return w().sk.createChildStore(i,e)}),[h,i]),x=(0,n().K8)((()=>!!h&&h.getForActorId()===h.getCreatedById()),[h]),S=(0,n().K8)((()=>{if(!h)return;const e=h.getForActorPointer(i.id);if(!e)return;const t=w().sk.createChildStore(i,e);return t instanceof w().LU?t.getEmail():void 0}),[h,i]),A=(0,n().K8)((()=>{if(y)return y.getDisplayName(g)}),[y,g]),j="actor"===(0,oi().r)("notification_ia"),_=(0,n().K8)((()=>{var e;return null==y||null===(e=y.getModel())||void 0===e?void 0:e.asActor}),[y]);return j?(0,J.jsx)(rr().my,{notificationTitleStore:y,header:{icon:(0,J.jsx)(tt().H8,{authors:_?[_]:[],size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:A},body:x?(0,J.jsx)(b().sA,{id:"activity.spaceMembershipRequestForSelf.body",defaultMessage:'Requested to be added as a workspace member {hasMessage, select, true {, "{message}"} other {}}',values:{hasMessage:Boolean(f),message:f}}):(0,J.jsx)(b().sA,{id:"activity.spaceMembershipRequest.body",defaultMessage:'Requested to add {forActorEmail} as a workspace member {hasMessage, select, true {, "{message}"} other {}}',values:{forActorEmail:S,hasMessage:Boolean(f),message:f}}),isFirst:s,isLast:a,rootStore:i,notification:l,url:void 0,...(0,ze().$5)({notification:l,activity:t,environment:u,tab:d}),children:(0,J.jsx)(mr,{activity:t,accessRequestStore:v,rootStore:i,source:c,notification:l,tabArgs:o})}):(0,J.jsx)(nr().Nx,{notificationTitleStore:y,body:x?(0,J.jsx)(b().sA,{id:"activity.spaceMembershipRequestForSelf.body",defaultMessage:'Requested to be added as a workspace member {hasMessage, select, true {, "{message}"} other {}}',values:{hasMessage:Boolean(f),message:f}}):(0,J.jsx)(b().sA,{id:"activity.spaceMembershipRequest.body",defaultMessage:'Requested to add {forActorEmail} as a workspace member {hasMessage, select, true {, "{message}"} other {}}',values:{forActorEmail:S,hasMessage:Boolean(f),message:f}}),isFirst:s,isLast:a,rootStore:i,notification:l,url:void 0,...(0,ze().$5)({notification:l,activity:t,environment:u,tab:d}),children:(0,J.jsx)(mr,{activity:t,accessRequestStore:v,rootStore:i,source:c,notification:l,tabArgs:o})})}function mr(e){const{activity:t,accessRequestStore:i,rootStore:s,notification:a,tabArgs:l}=e,d=(0,r().v3)(),c=(0,n().K8)((()=>t.getEdits()),[t])[0],m=(0,n().K8)((()=>i.getParentTable()),[i]),p=(0,n().K8)((()=>i.getParentId()),[i]),y=(0,n().K8)((()=>t.navigable_block_id),[t]),b=(0,n().K8)((()=>i.getModel()),[i]),S=(0,n().K8)((()=>b&&(0,g().C)(b)),[b]),j=(0,M().I)({spaceStore:s,request:b}),_=(0,n().K8)((()=>{if("page_access_request"===S){var e;const t=null==b||null===(e=b.getAttributes())||void 0===e||null===(e=e.permission_records_and_roles)||void 0===e||null===(e=e.at(0))||void 0===e?void 0:e.role;if(t)return t}return"reader"}),[b,S]),R=(0,o.useCallback)((async()=>{if(S&&j&&b)if("space_membership_request"===j&&"space_membership_request"===S)await A().p4({status:"approved",environment:d,requests:[b],store:s,from:"notification"});else if("space_membership_request"===j&&"guest_invite_request"===S)await A().KB({status:"approved",environment:d,store:s,requests:[b],from:"notification"});else{if("guest_invite_request"!==S)return;await A().aV({status:"approved",environment:d,requests:[b],from:"notification"})}}),[d,b,s,j,S]),C=(0,o.useCallback)((async()=>{if(S&&b)if("space_membership_request"===S)await A().p4({status:"rejected",environment:d,requests:[b],store:s,from:"notification"});else if("guest_invite_request"===S)await A().aV({status:"rejected",environment:d,requests:[b],from:"notification"});else{if("team_membership_request"===S||"page_access_request"===S)return;(0,x().HB)(S)}}),[d,b,s,S]),k=(0,u().IS)((e=>({actionPrimaryContainer:{paddingTop:4,paddingBottom:0,paddingRight:0},actionButton:(0,it().Ei)(e)})),[]),I=y?w().Bv.createChildStore(s,{table:v().ev,id:y}):void 0,B=(0,n().K8)((()=>m===v().ev&&Boolean(null==I?void 0:I.canAdmin())),[m,I]);if(!(m&&p&&j&&c))return null;if("page_access_request"===j)return B&&I?(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Oe,{accessRequestStore:i,targetBlockStore:I,initialRole:_,buttonStyle:k.actionButton,notification:a,rootStore:s,activity:t,tabArgs:l})}):null;if("space_membership_request"===j||"guest_invite_request"===j){const e=w().SL.createChildStore(s,{table:h().NX,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Me,{effectiveAccessRequestType:j,accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:k.actionButton,notification:a,onApprove:R,onReject:C})})}if("team_membership_request"===j){const e=w().h4.createChildStore(s,{table:f().yK,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(be,{accessRequestStore:i,teamStore:e})})}(0,x().HB)(j)}const pr=o.memo(gr);function vr(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d,source:c}=o,u=(0,r().v3)(),g=(0,b().tz)(),m=(0,n().K8)((()=>t.getEdits()),[t])[0],v=(0,n().K8)((()=>{if(t.team_id)return w().h4.createChildStore(i,{table:f().yK,id:t.team_id,spaceId:i.getSpaceId()})}),[t,i]),h=(0,n().K8)((()=>{var e;return null==v||null===(e=v.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:v.getRecordModel})}),[v]),y=(0,n().K8)((()=>w().v3.createChildStore(i,{table:p().O,id:t.access_request_id})),[t,i]),x=(0,n().K8)((()=>y.getModel()),[y]),A=m.message,j=(0,n().K8)((()=>{if(!x)return;const e=i.getSpaceId();if(!e)return;const t=x.getCreatedByPointer(e);return w().sk.createChildStore(i,t)}),[x,i]),_=(0,n().K8)((()=>{if(j)return j.getDisplayName(g)}),[j,g]),M="actor"===(0,oi().r)("notification_ia"),R=(0,n().K8)((()=>{var e;return null==j||null===(e=j.getModel())||void 0===e?void 0:e.asActor}),[j]);return M?(0,J.jsx)(rr().my,{notificationTitleStore:v,header:{icon:(0,J.jsx)(tt().H8,{authors:R?[R]:[],size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:_},subheader:(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{defaultMessage:"Requested to join {teamIconAndName}",id:"activity.teamMembershipRequest.subheader",values:{teamIconAndName:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:h,isEmptyPage:!1,size:16}),v&&(0,J.jsx)(G().A,{store:v,style:{fontWeight:S().Wy.medium}})]})}})}),body:A?(0,J.jsx)(b().sA,{id:"activity.teamMembershipRequest.messageBody",defaultMessage:'"{message}"',values:{message:A}}):void 0,isFirst:s,isLast:a,rootStore:i,notification:l,url:void 0,...(0,ze().$5)({notification:l,activity:t,environment:u,tab:d}),children:(0,J.jsx)(hr,{activity:t,accessRequestStore:y,rootStore:i,source:c,notification:l,tabArgs:o})}):(0,J.jsx)(nr().Nx,{notificationTitleStore:v,subheader:_,body:A?(0,J.jsx)(b().sA,{id:"activity.teamMembershipRequest.bodyWithMessage",defaultMessage:'Requested to join, "{message}"',values:{message:A}}):(0,J.jsx)(b().sA,{id:"activity.teamMembershipRequest.bodyNoMessage",defaultMessage:"Requested to join"}),isFirst:s,isLast:a,rootStore:i,notification:l,url:void 0,...(0,ze().$5)({notification:l,activity:t,environment:u,tab:d}),children:(0,J.jsx)(hr,{activity:t,accessRequestStore:y,rootStore:i,source:c,notification:l,tabArgs:o})})}function hr(e){const{activity:t,accessRequestStore:i,rootStore:s,notification:a,tabArgs:l}=e,d=(0,r().v3)(),c=(0,n().K8)((()=>t.getEdits()),[t])[0],m=(0,n().K8)((()=>i.getParentTable()),[i]),p=(0,n().K8)((()=>i.getParentId()),[i]),y=(0,n().K8)((()=>t.navigable_block_id),[t]),b=(0,n().K8)((()=>i.getModel()),[i]),S=(0,n().K8)((()=>b&&(0,g().C)(b)),[b]),j=(0,M().I)({spaceStore:s,request:b}),_=(0,n().K8)((()=>{if("page_access_request"===S){var e;const t=null==b||null===(e=b.getAttributes())||void 0===e||null===(e=e.permission_records_and_roles)||void 0===e||null===(e=e.at(0))||void 0===e?void 0:e.role;if(t)return t}return"reader"}),[b,S]),R=(0,o.useCallback)((async()=>{if(S&&j&&b)if("space_membership_request"===j&&"space_membership_request"===S)await A().p4({status:"approved",environment:d,requests:[b],store:s,from:"notification"});else if("space_membership_request"===j&&"guest_invite_request"===S)await A().KB({status:"approved",environment:d,store:s,requests:[b],from:"notification"});else{if("guest_invite_request"!==S)return;await A().aV({status:"approved",environment:d,requests:[b],from:"notification"})}}),[d,b,s,j,S]),C=(0,o.useCallback)((async()=>{if(S&&b)if("space_membership_request"===S)await A().p4({status:"rejected",environment:d,requests:[b],store:s,from:"notification"});else if("guest_invite_request"===S)await A().aV({status:"rejected",environment:d,requests:[b],from:"notification"});else{if("team_membership_request"===S||"page_access_request"===S)return;(0,x().HB)(S)}}),[d,b,s,S]),k=(0,u().IS)((e=>({actionPrimaryContainer:{paddingTop:4,paddingBottom:0,paddingRight:0},actionButton:(0,it().Ei)(e)})),[]),I=y?w().Bv.createChildStore(s,{table:v().ev,id:y}):void 0,B=(0,n().K8)((()=>m===v().ev&&Boolean(null==I?void 0:I.canAdmin())),[m,I]);if(!(m&&p&&j&&c))return null;if("page_access_request"===j)return B&&I?(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Oe,{accessRequestStore:i,targetBlockStore:I,initialRole:_,buttonStyle:k.actionButton,notification:a,rootStore:s,activity:t,tabArgs:l})}):null;if("space_membership_request"===j||"guest_invite_request"===j){const e=w().SL.createChildStore(s,{table:h().NX,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(Me,{effectiveAccessRequestType:j,accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:k.actionButton,notification:a,onApprove:R,onReject:C})})}if("team_membership_request"===j){const e=w().h4.createChildStore(s,{table:f().yK,id:p});return(0,J.jsx)("div",{style:k.actionPrimaryContainer,children:(0,J.jsx)(be,{accessRequestStore:i,teamStore:e})})}(0,x().HB)(j)}const fr=o.memo(vr);function yr(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:s}=e,a=(0,n().K8)((()=>w().v3.createChildStore(i,{table:p().O,id:t.access_request_id})),[t,i]),l=(0,n().K8)((()=>a.getModel()),[a]),{pageAccessRequestModel:d,guestInviteRequestModel:c,teamMembershipRequestModel:u}=(0,n().K8)((()=>({pageAccessRequestModel:null!=l&&l.isPageAccessRequest()?l:void 0,guestInviteRequestModel:null!=l&&l.isGuestInviteRequest()?l:void 0,spaceMembershipRequestModel:null!=l&&l.isSpaceMembershipRequest()?l:void 0,teamMembershipRequestModel:null!=l&&l.isTeamMembershipRequest()?l:void 0})),[l]),g=(0,M().I)({spaceStore:i,request:l});switch(g){case"guest_invite_request":return c?(0,J.jsx)(lr,{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:s,guestInviteRequestModel:c}):null;case"space_membership_request":return(0,J.jsx)(pr,{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:s});case"team_membership_request":return u?(0,J.jsx)(fr,{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:s}):null;case"page_access_request":return d?(0,J.jsx)(ur,{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:s,pageAccessRequestModel:d}):null;case void 0:return null;default:(0,x().HB)(g)}}const br=o.memo(yr);function xr(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d}=o,c=(0,r().v3)(),u=(0,b().tz)(),g=(0,n().K8)((()=>w().v3.createChildStore(i,{table:p().O,id:t.access_request_id,spaceId:i.id})),[t,i]),h=(0,n().K8)((()=>{const e=g.getModel();return e&&e.isGuestInviteRequest()&&e.isResolved()||e&&e.isEditPageAccessRequest()&&e.isApproved()?e:void 0}),[g]),f=(0,n().K8)((()=>null==h?void 0:h.getStatus()),[h]),y=(0,n().K8)((()=>Boolean(null==h?void 0:h.isEditPageAccessRequest())),[h]),x=(0,n().K8)((()=>{if(t.navigable_block_id)return w().Bv.createChildStore(i,{table:v().ev,id:t.navigable_block_id,spaceId:i.id})}),[t,i]),A=(0,n().K8)((()=>{if(!h)return;const e=h.getForActorPointer(i.getSpaceId()),t=w().sk.createChildStore(i,e);return t instanceof w().LU?t:void 0}),[h,i]),j=(0,n().K8)((()=>{const e=null==A?void 0:A.getDisplayName(u),t=null==A?void 0:A.getEmail();return e?`${e} (${t})`:t}),[A,u]),{resolvedByActorModel:_,resolvedByActor:M}=(0,n().K8)((()=>{if(!h)return{resolvedByActorModel:void 0,resolvedByActor:void 0};const e=h.getResolvedByPointer(i.getSpaceId());if(!e)return{resolvedByActorModel:void 0,resolvedByActor:void 0};const t=w().sk.createChildStore(i,e).getModel();return{resolvedByActorModel:t,resolvedByActor:null==t?void 0:t.asActor}}),[h,i]),R=(0,n().K8)((()=>{if(_)return _.getDisplayName(u)}),[_,u]),C=(0,n().K8)((()=>{if(!x)return;const e=x.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().y8.Notification}):void 0}),[x,i,t]),k="actor"===(0,oi().r)("notification_ia"),I=(0,n().K8)((()=>{var e;return null==x||null===(e=x.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:i.getRecordModel})}),[x,i]),B=(0,n().K8)((()=>(null==x?void 0:x.isEmptyPage())??!1),[x]);return k?(0,J.jsx)(rr().my,{notificationTitleStore:x,header:{icon:(0,J.jsx)(tt().H8,{authors:M?[M]:[],size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:R},subheader:(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:x&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:I,isEmptyPage:B,size:16}),(0,J.jsx)(G().A,{store:x,style:{fontWeight:S().Wy.medium}})]})}),body:y?(0,J.jsx)(b().sA,{defaultMessage:"Approved your request to edit the page",id:"activity.EditAccessRequestResolved.approvedBody"}):"approved"===f?(0,J.jsx)(b().sA,{defaultMessage:"Approved your request to invite {forActorNameOrEmail} as a guest",values:{forActorNameOrEmail:j},id:"activity.GuestInviteRequestResolved.approvedBody"}):"rejected"===f?(0,J.jsx)(b().sA,{defaultMessage:"Denied your request to invite {forActorNameOrEmail} as a guest",values:{forActorNameOrEmail:j},id:"activity.GuestInviteRequestResolved.rejectedBody"}):void 0,isFirst:s,isLast:a,rootStore:i,navigableBlockId:null==x?void 0:x.id,notification:l,url:C,...(0,ze().$5)({notification:l,activity:t,environment:c,tab:d})}):(0,J.jsx)(nr().Nx,{subheader:R,body:y?(0,J.jsx)(b().sA,{defaultMessage:"Approved your request to edit the page",id:"activity.EditAccessRequestResolved.approvedBody"}):"approved"===f?(0,J.jsx)(b().sA,{defaultMessage:"Approved your request to invite {forActorNameOrEmail} as a guest",values:{forActorNameOrEmail:j},id:"activity.GuestInviteRequestResolved.approvedBody"}):"rejected"===f?(0,J.jsx)(b().sA,{defaultMessage:"Denied your request to invite {forActorNameOrEmail} as a guest",values:{forActorNameOrEmail:j},id:"activity.GuestInviteRequestResolved.rejectedBody"}):void 0,isFirst:s,isLast:a,rootStore:i,notification:l,url:C,...(0,ze().$5)({notification:l,activity:t,environment:c,tab:d})})}const Sr=o.memo(xr);var Ar=()=>i(297813);function jr(e){const{rootStore:t,activity:i,isLast:s,tabArgs:a,isFirst:l}=e,{tab:c,notification:g}=a,p=(0,b().tz)(),h=(0,r().v3)(),f=(0,n().K8)((()=>i.getEdits()),[i]),y=f.at(0),A=(0,u().IS)((e=>({editAutomation:{marginTop:8,height:26,fontWeight:S().Wy.medium}})),[]),j=(0,o.useMemo)((()=>new Set(f.map((e=>e.automation_id)))),[f]),_=(0,n().K8)((()=>{if(!(0,x().O9)(y))return!1;return!w().dn.createChildStore(t,{table:Tt().yB,id:y.automation_id,spaceId:t.getSpaceId()}).getAlive()}),[t,y]),{handleNavigateToAutomation:M,navigableBlockStore:R,navigableBlockUrl:C}=function(e){let{edit:t,rootStore:i,uniqueAutomationIds:o}=e;const s=(0,r().v3)(),a=1===o.size,l=(0,n().K8)((()=>{if(!(0,x().O9)(t))return!1;return!w().dn.createChildStore(i,{table:Tt().yB,id:t.automation_id,spaceId:i.getSpaceId()}).getAlive()}),[i,t]),d=(0,n().K8)((()=>{if((0,x().O9)(t))return new(w().Bv)(s,{id:t.automation_navigable_block_id,table:v().ev})}),[t,s]),c=(0,n().K8)((()=>{if(!(0,x().O9)(d))return!0;const e=d.getRole();return!e||!(0,Ie().Tt)(e)}),[d]),u=(0,n().K8)((()=>{if((0,x().O9)(d))return(0,Rt().Ay)({store:d,preferPublicLink:!1,pageVisitSource:m().y8.Notification})}),[d]),g=(0,n().K8)((()=>c||!(0,x().O9)(t)?()=>{}:()=>{const e=t.automation_id;d&&u&&((0,qt().u4)({environment:s,event:{eventName:"click_automation_typecheck_error_notification",eventProperties:{block_id:d.id,automation_id:e}}}),Mt().oo({environment:s,url:u,callback:async()=>await Wt({environment:s,automationNavigableBlockStore:d,automationId:a&&!l?e:void 0,rootStore:i,source:"automation_typecheck_error_raised_notification"})}))}),[l,a,c,t,d,u,s,i]);return{handleNavigateToAutomation:g,navigableBlockStore:d,navigableBlockUrl:u}}({edit:y,rootStore:t,uniqueAutomationIds:j}),k=(0,n().K8)((()=>[...j].map((e=>{const o=t.getRecordStore(t,{table:Tt().yB,id:e,spaceId:i.spaceId}),r=o.getRole();return(0,x().O9)(r)&&(0,Ie().Tt)(r)?o.getAlive()?o.getNameWithDefault(p):p.formatMessage(Kt().VS.automationDeletedName):p.formatMessage(Kt().VS.automationPrivateName)}))),[p,t,i,j]),I=(0,o.useCallback)((e=>{(0,D().SQ)({event:e,context:D().y$.NotificationClick,callback:()=>{N().createAndCommit({userAction:"AutomationTypecheckErrorRaisedActivity.viewError",environment:h,canUndo:!0,perform:e=>{T().ZB({notification:g,rootStore:t,transaction:e,read:!0})}}),M(),Ke().K4({tab:c,notificationId:null==g?void 0:g.id,environment:h,alreadyRead:Boolean(null==g?void 0:g.read),activity:i})}})}),[i,h,M,g,t,c]),B=(0,d().X)("automation_updated_error_states");if(!(0,x().O9)(R)||!(0,x().O9)(y)||0===f.length||!B)return null;const K=_&&1===j.size;return(0,J.jsx)(nr().Nx,{header:{icon:(0,Ar().xMarkFillIcon)({width:16,height:16}),title:(0,J.jsx)(b().sA,{id:"AutomationTypecheckErrorRaisedActivity.formattedHeaderMessage.header",defaultMessage:"{numAutomationNames, plural, one {Automation is} other {Automations are}} invalid",values:{numAutomationNames:j.size}})},subheader:k.join(", "),body:!K&&(0,J.jsx)(b().sA,{id:"AutomationTypecheckErrorRaisedActivity.formattedHeaderMessage.body",defaultMessage:"Resolve any errors or remove failing steps to enable {numAutomationNames, plural, one {this automation} other {these automations}}",values:{numAutomationNames:j.size}}),isFirst:l,isLast:s,rootStore:t,navigableBlockId:R.id,notification:g,url:C,...(0,ze().$5)({notification:g,activity:i,environment:h,tab:c}),children:!K&&(0,J.jsx)(wt().A,{style:A.editAutomation,onClick:I,size:"md",children:(0,J.jsx)(b().sA,{id:"AutomationTypecheckErrorRaisedActivity.editAutomation.automationMessage",defaultMessage:"Edit automation"})})})}const _r=o.memo(jr);var Mr=()=>i(100622),Rr=()=>i(700500),wr=()=>i(743176),Cr=()=>i(797809);function kr(e){const{activity:t,rootStore:o,tabArgs:s,isFirst:a,isLast:l}=e,{tab:d,notification:g}=s,p=(0,r().v3)(),h=(0,b().tz)(),f=(0,u().eP)(),y=(0,n().K8)((()=>t.getEdits()),[t]),x=y.length>0,A=y[0],j=w().sk.createChildStore(o,{table:v().ev,id:A.navigable_block_id}),_="actor"===(0,oi().r)("notification_ia"),M=(0,n().K8)((()=>j.isDefined()),[j]),R=(0,n().K8)((()=>w().Bv.createChildStore(o,{table:v().ev,id:t.mentioned_block_id})),[t,o]),C=(0,n().K8)((()=>A.mentioned_property),[A]),k=(0,n().K8)((()=>{if(!R)return;const e=R.getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:m().y8.Notification})}),[R,o]),I=(0,n().K8)((()=>(0,c().Ln)({edits:y,rootStore:o})),[y,o]),B=I.map((e=>e.asActor)),K=(0,n().K8)((()=>{const e=I[0];if(e)return w().sk.createChildStore(o,e.pointer)}),[I,o]),T=(0,n().K8)((()=>{var e;return null==K||null===(e=K.getModel())||void 0===e?void 0:e.getDisplayName(h)}),[K,h]),q=(0,n().K8)((()=>(null==R?void 0:R.getType())===Rr().xd.tableRow),[R]),N=(0,n().K8)((()=>{var e;const t=null===(e=j.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:j.getRecordModel}),i=j.isEmptyPage();return(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{id:"activity.userMentionedActivity.subheaderPageTitle",defaultMessage:"Mentioned you in {pageTitle}",values:{pageTitle:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:t,isEmptyPage:i,size:16}),(0,J.jsx)(G().A,{store:j,style:{fontWeight:S().Wy.medium}})]})}})})}),[j]),P=(0,n().K8)((()=>{if(!R)return;if(q){var e;const t=null===(e=R.getModel())||void 0===e?void 0:e.__IM_SORRY__getValue();if(t&&t.type===Rr().xd.tableRow)return(0,J.jsx)(b().sA,{id:"activity.userMentionedActivity.mentionSimpleTableRow",defaultMessage:"Mentioned you in {rowPreview}",values:{rowPreview:(0,J.jsx)(i(350297).V,{blockValue:t,rootStore:o})}})}const t=R.getTitleValue(),r=(0,Mr().O4)({theme:f}),n=j.pointer.spaceId;if(!n)return;const s="title"===C;return j.id===R.id&&!s?_?(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(Ir,{property:C,blockStore:R})}):(0,J.jsx)(b().sA,{id:"activity.userMentionedActivity.mentionPropertyBody",defaultMessage:'Mentioned you in "{property}"',values:{property:(0,J.jsx)(Ir,{property:C,blockStore:R})}}):_?(0,ti().S5)({environment:p,textValue:{value:t,spaceId:n},parentStore:o,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disableHover:!0,disabled:!0,theme:r,emojiType:(0,ei().FN)(p),katex:p.KatexStore.getKatex(),formulaValueTypes:[]}):(0,J.jsx)(b().sA,{id:"activity.userMentionedActivity.mentionBody",defaultMessage:'Mentioned you "{blockText}"',values:{blockText:(0,ti().S5)({environment:p,textValue:{value:t,spaceId:n},parentStore:o,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disableHover:!0,disabled:!0,theme:r,emojiType:(0,ei().FN)(p),katex:p.KatexStore.getKatex(),formulaValueTypes:[]})}})}),[R,f,j.pointer.spaceId,C,p,o,j.id,q,_]);return x&&M&&k?_?(0,J.jsx)(rr().my,{notificationTitleStore:j,header:{icon:(0,J.jsx)(tt().H8,{authors:B,size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:T},subheader:N,body:P,isFirst:a,isLast:l,rootStore:o,navigableBlockId:j.id,notification:g,url:k,disableLineClamp:q,...(0,ze().$5)({notification:g,activity:t,environment:p,tab:d})}):(0,J.jsx)(nr().Nx,{notificationTitleStore:j,subheader:T,body:P,isFirst:a,isLast:l,rootStore:o,navigableBlockId:j.id,notification:g,url:k,disableLineClamp:q,...(0,ze().$5)({notification:g,activity:t,environment:p,tab:d})}):null}function Ir(e){const{property:t,blockStore:i}=e,o=(0,u().DP)(),r=(0,b().tz)(),s=(0,n().K8)((()=>{var e;const t=i.getAssociatedCollectionStore();return(null==t||null===(e=t.getModel())||void 0===e?void 0:e.getNormalizedSchema())||(0,Cr().RX)(r)}),[i,r]),a=(0,n().K8)((()=>{if(s&&t&&t in s)return s[t]}),[s,t]),l=(0,u().IS)((e=>({container:{display:"inline-flex",alignItems:"baseline",gap:6},propertyIcon:{alignSelf:"center",fill:e.text.secondary}})),[]);return a?(0,J.jsxs)("div",{style:l.container,children:[(0,J.jsx)(wr().zB,{type:a.type,icon:a.icon,size:14,theme:o,style:l.propertyIcon}),(0,J.jsx)("div",{children:a.name})]}):null}const Br=o.memo(kr);function Kr(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{tab:l,notification:d}=o,g=(0,r().v3)(),p=(0,b().tz)(),h=(0,u().eP)(),f=(0,n().K8)((()=>(0,Ft().W9)(t.getEdits())),[t]),y=f.length>0,x=(0,n().K8)((()=>w().Bv.createChildStore(i,{table:v().ev,id:f[0].navigable_block_id})),[i,f]),A=(0,n().K8)((()=>{const e=x.getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification})}),[x,i]),j=(0,n().K8)((()=>(0,c().Ln)({edits:f,rootStore:i})),[f,i]),_=(0,n().K8)((()=>j.map((e=>e.getDisplayName(p)))),[j,p]),M=(0,n().K8)((()=>j.map((e=>e.asActor))),[j]),R=(0,n().K8)((()=>x.isDefined()),[x]),C=(0,n().K8)((()=>{var e;const t=null===(e=x.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:i.getRecordModel}),o=x.isEmptyPage();return(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{id:"activity.blockEdited.pageTitleText",defaultMessage:"Edited a property in {pageTitle}",values:{pageTitle:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:t,isEmptyPage:o,size:16}),(0,J.jsx)(G().A,{store:x,style:{fontWeight:S().Wy.medium}})]})}})})}),[x,i]),k=(0,n().K8)((()=>f.map(((e,t)=>{var o;const r=(0,Mr().O4)({theme:h}),n=Object.keys(e.property_updates)[0],s=null===(o=e.property_updates[n].after)||void 0===o?void 0:o.value;return s?(0,J.jsx)(b().sA,{defaultMessage:'Updated "{property}" to "{propertyValue}"',id:"activity.blockEdited.body.single",values:{property:(0,J.jsx)(Ir,{property:n,blockStore:x}),propertyValue:(0,ti().S5)({environment:g,textValue:{value:s,spaceId:i.id},parentStore:i,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disableHover:!0,disabled:!0,theme:r,emojiType:(0,ei().FN)(g),katex:g.KatexStore.getKatex(),formulaValueTypes:[]})}},t):null}))),[g,x,f,h,i]),I="actor"===(0,oi().r)("notification_ia");return R&&y?I?(0,J.jsx)(rr().my,{notificationTitleStore:x,header:{icon:(0,J.jsx)(tt().H8,{authors:M,size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:_.join(", ")},subheader:C,body:k,isFirst:s,isLast:a,rootStore:i,navigableBlockId:x.id,notification:d,url:A,...(0,ze().$5)({notification:d,activity:t,environment:g,tab:l})}):(0,J.jsx)(nr().Nx,{notificationTitleStore:x,subheader:_.join(", "),body:k,isFirst:s,isLast:a,rootStore:i,navigableBlockId:x.id,notification:d,url:A,...(0,ze().$5)({notification:d,activity:t,environment:g,tab:l})}):null}const Tr=o.memo(Kr);i(944114),i(57145);function qr(e){const{activity:t,tabArgs:o,rootStore:s,isFirst:d,isLast:c}=e,{tab:g,notification:p}=o,h=(0,b().tz)(),f=(0,n().K8)((()=>t.getEdits()),[t]);let y=f.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":case"suggestion-created":return!0;default:(0,x().HB)(e)}}));0===y.length&&0!==f.length&&(y=f);const A=y.length>0,j=(0,r().v3)(),_=(0,n().K8)((()=>{const e=s.getRecordStore(s,{table:l().$Y,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,s]),M=(0,n().K8)((()=>{const e=null==_?void 0:_.getParentPointer();if(e)return w().Bv.createChildStore(s,e)}),[_,s]),R=(0,n().K8)((()=>Boolean(M&&M.isDefined())),[M]),C=(0,n().K8)((()=>{const e=null==M?void 0:M.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,M]),k=w().Bv.createChildStore(s,{table:v().ev,id:C}),I=(0,n().K8)((()=>k.isDefined()),[k]),B=(0,i(419123).k)({navigableBlockStore:k}),K=(0,n().K8)((()=>i(508496).default.getConfigKey("assume_comment_read","last_seen_at")),[]),T=(0,n().K8)((()=>B.filter((e=>e.isUnread(K))).length),[B,K]),q=(0,n().K8)((()=>B.toSorted(((e,t)=>Math.max(...t.getCommentStores().map((e=>e.getCreatedTime())))-Math.max(...e.getCommentStores().map((e=>e.getCreatedTime()))))).toSorted(((e,t)=>(t.isUnread(K)?1:0)-(e.isUnread(K)?1:0)))),[B,K]),{actorModels:N,actorNamesInDiscussions:P}=(0,n().K8)((()=>{const e=new Set,t=[],i=j.currentUser.id,o=q.flatMap((e=>e.getCommentStores().toSorted(((e,t)=>t.getCreatedTime()-e.getCreatedTime()))));o.forEach((i=>{const o=i.getCreatedByPointer();o&&!e.has(o.id)&&(e.add(o.id),t.push(o))}));const r=t.map((e=>w().sk.createChildStore(s,e).getModel())).filter(x().O9).filter((e=>e.id!==i));return{actorModels:r,actorNamesInDiscussions:r.map((e=>e.getDisplayName(h)))}}),[q,s,h,j.currentUser.id]),L=(0,n().K8)((()=>{var e;const t=q.at(0),i=null==t||null===(e=t.getCommentStores())||void 0===e?void 0:e.at(-1);return i&&t?{commentStore:i,discussionStore:t}:{author:void 0,commentStore:void 0,discussionStore:void 0}}),[q]),D=(0,n().K8)((()=>{var e;if(M)return null===(e=M.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:s.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().y8.Notification,updateSidebarTab:T&&T>1?i(737230).UL.ForYou:void 0})}),[M,s,t,T]),z=(0,u().IS)((e=>({latestComment:{fontSize:14,color:e.text.secondary,display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,overflow:"hidden"},actorFirstSubheader:{display:"flex",alignItems:"center",gap:3}})),[]),U="actor"===(0,oi().r)("notification_ia"),W=(0,n().K8)((()=>N.map((e=>e.asActor)).filter(x().O9)),[N]),O=(0,n().K8)((()=>k.getIcon()),[k]),E=(0,n().K8)((()=>k.isEmptyPage()),[k]);return A&&I&&R&&_?(0,J.jsx)(nr().Nx,{isFirst:d,isLast:c,rootStore:s,navigableBlockId:C,notification:p,count:T,url:D,header:U?{icon:(0,J.jsx)(tt().H8,{authors:W,size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:(0,J.jsx)(Pr,{actorNames:P})}:void 0,subheader:U?(0,J.jsxs)("div",{style:z.actorFirstSubheader,children:["Commented in",(0,J.jsx)($().B,{disabled:!0,icon:O,isEmptyPage:E,size:16}),(0,J.jsx)(G().A,{store:k,style:{fontWeight:S().Wy.medium}})]}):`${P.join(", ")}`,body:L.commentStore&&L.discussionStore&&(0,J.jsx)(Nr,{discussionStore:L.discussionStore,commentStore:L.commentStore,style:z.latestComment}),...(0,ze().$5)({notification:p,environment:j,tab:g,activity:t})}):(a().log({level:"warning",from:"CommentPageGroupActivityNotification",type:"invalidNotificationData",data:{ids:[(null==p?void 0:p.id)??"unknown"]}}),null)}function Nr(e){const{discussionStore:t,commentStore:i,style:o}=e,s=(0,r().v3)(),a=(0,u().DP)(),l=(0,n().K8)((()=>ii().gp(i).getValue()),[i]),d=(0,n().K8)((()=>i.getSpaceId()),[i]),c=(0,n().K8)((()=>{if(!l||!d)return null;const e=(0,Qt().Eh)({textValue:l,currentUserId:s.currentUser.id,getRecordModel:t.getRecordModel,highlightStyle:"text_only"});return(0,ti().S5)({environment:s,textValue:{value:e,spaceId:d},parentStore:t,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableHover:!0,disabled:!0,theme:a,emojiType:(0,ei().FN)(s),katex:s.KatexStore.getKatex(),formulaValueTypes:[]})}),[s,t,a,l,d]),g=(0,u().IS)((e=>({commentText:{whiteSpace:"pre-wrap",wordBreak:"break-word",display:"inline",fontSize:14,color:e.text.primary,lineHeight:"22px",...o}})),[o]);return(0,J.jsx)("span",{style:g.commentText,children:c})}function Pr(e){let{actorNames:t}=e;if(1===t.length)return(0,J.jsx)("span",{children:t[0]});if(2===t.length)return(0,J.jsxs)("span",{children:[t[0]," and ",t[1]]});if(t.length>2){const e=t.length-1;return(0,J.jsxs)("span",{children:[t[0]," & ",e," ",1===e?"other":"others"]})}return null}const Lr=o.memo(qr);var Dr=()=>i(94701);function zr(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{tab:l,notification:d}=o,c=(0,r().v3)(),u=(0,n().K8)((()=>(0,Ft().W9)(t.getEdits())),[t]),g=(0,n().K8)((()=>{const e=u[0];return e?e.new_email:""}),[u]);return(0,J.jsx)(nr().Nx,{header:{icon:(0,J.jsx)(rr().S7,{icon:Dr().checkmarkFillIcon}),title:(0,J.jsx)(b().sA,{defaultMessage:"Email updated",id:"activity.emailEdited.header"})},body:(0,J.jsx)(b().sA,{defaultMessage:"Updated to {newEmail}",values:{newEmail:g},id:"activity.emailEdited.subheader.short"}),isFirst:s,isLast:a,rootStore:i,notification:d,url:void 0,...(0,ze().$5)({notification:d,activity:t,environment:c,tab:l})})}const Ur=o.memo(zr);function Wr(e){const{activity:t,rootStore:i,tabArgs:s,isFirst:a,isLast:l}=e,{tab:d,notification:c}=s,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),m=(0,o.useCallback)((()=>{window.open(g[0].link,"_blank")}),[g]);return(0,J.jsx)(nr().Nx,{header:{icon:(0,J.jsx)(rr().S7,{icon:Dr().checkmarkFillIcon}),title:(0,J.jsx)(b().sA,{defaultMessage:"Your workspace export is ready",id:"activity.exportCompleted.header"})},body:(0,J.jsx)(b().sA,{defaultMessage:"The download link will expire in 7 days.",id:"activity.exportCompleted.downloadLink"}),isFirst:a,isLast:l,rootStore:i,notification:c,url:void 0,...(0,ze().$5)({notification:c,activity:t,environment:u,tab:d}),children:(0,J.jsx)(wt().A,{size:"md",onClick:m,children:(0,J.jsx)(b().sA,{defaultMessage:"Download",id:"activity.actions.exportCompleted.download"})})})}const Or=o.memo(Wr);function Er(e){const{activity:t,rootStore:i,isFirst:o,isLast:s,tabArgs:a}=e,{tab:l,notification:d}=a,g=(0,r().v3)(),p=(0,b().tz)(),h=(0,n().K8)((()=>t.getEdits()),[t]),f=h.length>0,y=h[0],x="actor"===(0,oi().r)("notification_ia"),A=(0,n().K8)((()=>w().Bv.createChildStore(i,{table:v().ev,id:y.navigable_block_id,spaceId:i.id})),[i,y.navigable_block_id]),j=(0,n().K8)((()=>A.isDefined()),[A]),_=(0,n().K8)((()=>w().Bv.createChildStore(i,{table:v().ev,id:t.getMentionedBlockId(),spaceId:i.id})),[i,t]),M=(0,n().K8)((()=>{const e=_.getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification})}),[i,_]),R=(0,n().K8)((()=>(0,c().Ln)({edits:h,rootStore:i})),[h,i]),C=R.map((e=>e.asActor)),k=(0,n().K8)((()=>{const e=R[0];if(e)return w().sk.createChildStore(i,e.pointer)}),[R,i]),I=(0,n().K8)((()=>{var e;return null==k||null===(e=k.getModel())||void 0===e?void 0:e.getDisplayName(p)}),[k,p]),B=(0,u().eP)(),K=(0,n().K8)((()=>{const e=(0,Mr().O4)({theme:B}),t=_.getTitleValue();return(0,ti().S5)({environment:g,textValue:{value:t,spaceId:i.id},parentStore:A,disableHover:!1,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0,disableSuggestionAnnotations:!0,disabled:!0,emojiType:(0,ei().FN)(g),theme:e,katex:g.KatexStore.getKatex(),formulaValueTypes:[]})}),[_,B,g,i,A]),T=(0,n().K8)((()=>{var e;const t=null===(e=A.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:A.getRecordModel}),i=A.isEmptyPage();return(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{id:"activity.groupMentionActivity.subheaderPageTitle",defaultMessage:"Mentioned your group in {pageTitle}",values:{pageTitle:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:t,isEmptyPage:i,size:16}),(0,J.jsx)(G().A,{store:A,style:{fontWeight:S().Wy.medium}})]})}})})}),[A]),q=(0,n().K8)((()=>{const e=(0,Mr().O4)({theme:B}),t=_.getTitleValue(),o=A.pointer.spaceId;if(o)return(0,ti().S5)({environment:g,textValue:{value:t,spaceId:o},parentStore:i,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,emojiType:(0,ei().FN)(g),theme:e,katex:g.KatexStore.getKatex(),formulaValueTypes:[]})}),[_,B,A.pointer.spaceId,g,i]);return f&&j&&M?x?(0,J.jsx)(rr().my,{notificationTitleStore:A,header:{icon:(0,J.jsx)(tt().H8,{authors:C,size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:I},subheader:T,body:q,isFirst:o,isLast:s,rootStore:i,navigableBlockId:A.id,notification:d,url:M,...(0,ze().$5)({notification:d,activity:t,environment:g,tab:l})}):(0,J.jsx)(nr().Nx,{subheader:I,body:(0,J.jsx)(b().sA,{defaultMessage:'Mentioned your group in "{renderedBlockText}"',values:{renderedBlockText:K},id:"activity.groupMentionActivity.body"}),isFirst:o,isLast:s,rootStore:i,navigableBlockId:A.id,notification:d,url:M,...(0,ze().$5)({notification:d,activity:t,environment:g,tab:l})}):null}const Fr=o.memo(Er);function Vr(e){const{activity:t,rootStore:o,tabArgs:s,isFirst:a,isLast:l}=e,{tab:d,notification:c}=s,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),p=(0,n().K8)((()=>{var e;const t=null===(e=g[0])||void 0===e?void 0:e.teamspace_id;if(t)return w().sk.createChildStore(o,{table:f().yK,id:t,spaceId:o.id})}),[o,g]),h=(0,n().K8)((()=>null==p?void 0:p.getName()),[p]),{import_source:y,import_status:x,version:S,landing_page:A,collection_page_ids:j}=g[0],_=(0,Wi().A)({pageId:A,pageVisitSource:m().y8.Import}),M="successful"===x?(0,J.jsx)(rr().S7,{icon:Dr().checkmarkFillIcon}):(0,J.jsx)(rr().S7,{icon:Ar().xMarkFillIcon}),{body:R,header:C,children:k}=(0,n().K8)((()=>{const e=Boolean(y)?(0,i(484392).A)(y):void 0,t=(0,J.jsx)(b().sA,{defaultMessage:"{importSource, select, false {External} other {{importSource}}} import failed",id:"importCompletedActivity.importFailed.header",values:{importSource:e,importStatus:x}}),r=(0,J.jsx)(b().sA,{defaultMessage:"{importSource, select, false {External} other {{importSource}}} import was successful",id:"importCompletedActivity.importSuccess.header",values:{importSource:e,importStatus:x}}),n=(0,J.jsx)(b().sA,{defaultMessage:"View projects and tasks in Notion",id:"importCompletedActivity.projects.redirect"}),s=(0,J.jsx)(b().sA,{defaultMessage:"View boards in Notion",id:"importCompletedActivity.boards.redirect"}),a=(0,J.jsx)(b().sA,{defaultMessage:"View import logs",id:"importCompletedActivity.loggerPage.redirect"}),l=null==j?void 0:j[0];let d,c="successful"===x?r:t;if("Jira"===e&&(p&&"successful"===x&&(c=(0,J.jsx)(b().sA,{defaultMessage:"Your Jira projects and tasks have been synced to {teamName}",id:"importCompletedActivity.jiraSuccess.header",values:{teamName:h}})),l)){const e=w().Bv.createChildStore(o,{id:l.projectCollectionPageId,spaceId:o.id,table:v().ev}),t=w().Bv.createChildStore(o,{id:l.taskCollectionPageId,spaceId:o.id,table:v().ev});d=(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,J.jsx)(wt().A,{size:"md",onClick:()=>{var t;const i=null===(t=e.getModel())||void 0===t?void 0:t.getRenderUrl({pageVisitSource:m().y8.Import,getRecordModel:e.getRecordModel});i&&Mt().oo({environment:u,url:i})},children:(0,J.jsx)(b().sA,{defaultMessage:"View project",id:"importCompletedActivity.project.redirect"})}),(0,J.jsx)(wt().A,{size:"md",onClick:()=>{var e;const i=null===(e=t.getModel())||void 0===e?void 0:e.getRenderUrl({pageVisitSource:m().y8.Import,getRecordModel:t.getRecordModel});i&&Mt().oo({environment:u,url:i})},children:(0,J.jsx)(b().sA,{defaultMessage:"View task",id:"importCompletedActivity.task.redirect"})})]})}return{header:c,body:"successful"===x?"Monday"===e&&"v2"===S?s:n:a,children:d}}),[j,x,y,S,p,h,o,u]);return g.length?(0,J.jsx)(nr().Nx,{header:{icon:M,title:C},body:R,isFirst:a,isLast:l,rootStore:o,notification:c,url:_,...(0,ze().$5)({notification:c,activity:t,environment:u,tab:d}),children:k}):null}const Hr=o.memo(Vr);function $r(e){const{activity:t,tabArgs:i}=e,{tab:o,notification:s}=i,a=(0,r().v3)(),l=(0,n().K8)((()=>t.getEdits()),[t]),d=l.length>0,c={tab:o,notificationId:null==s?void 0:s.id,environment:a,alreadyRead:Boolean(null==s?void 0:s.read),activity:t},g=(0,u().IS)((e=>({notificationContainer:{paddingBlock:"8px 4px",display:"flex",flexDirection:"column",rowGap:8}})),[]);return d?(0,J.jsx)(rn,{analyticsInfo:c,children:(0,J.jsx)(Yr,{...e,edits:l,style:g.notificationContainer})}):null}const Gr=1;function Yr(e){const{rootStore:t,activity:i,isLast:s,tabArgs:a,edits:l,style:d,isFirst:c}=e,{tab:g,notification:p,source:h}=a,f=(0,r().v3)(),y=(0,b().tz)(),A=l.at(0),[j,_]=(0,o.useState)(null),M=(0,o.useMemo)((()=>j&&j.scrollHeight>j.clientHeight),[j]),R=(0,n().K8)((()=>{if(!A)return;const e=w().Bv.createChildStore(t,{table:v().ev,id:A.navigable_block_id});return(0,x().O9)(e)?e:void 0}),[A,t]),C=(0,n().K8)((()=>{const e=null==R?void 0:R.getModel();if(e)return e.getRenderUrl({getRecordModel:t.getRecordModel,pageVisitSource:m().y8.Notification})}),[t,R]),k=(0,u().IS)((e=>({container:{paddingBlock:4,display:"flex",flexDirection:"row",columnGap:1.5*Number((0,it().AG)(e).paddingLeft),alignItems:"center"}})),[]),I=(0,o.useMemo)((()=>new Set(l.map((e=>e.automation_id)))),[l]),B=(0,n().K8)((()=>[...I].map((e=>{const i=t.getRecordStore(t,{table:Tt().yB,id:e,spaceId:t.id}),o=i.getRole();return(0,x().O9)(o)&&(0,Ie().Tt)(o)?i.getAlive()?i.getNameWithDefault(y):y.formatMessage(Kt().VS.automationDeletedName):y.formatMessage(Kt().VS.automationPrivateName)}))),[y,t,I]),K="actor"===(0,oi().r)("notification_ia");return(0,x().O9)(R)&&(0,x().O9)(A)?(0,J.jsx)(nr().Nx,{header:{icon:K?(0,J.jsx)(rr().S7,{icon:Dr().checkmarkFillIcon}):(0,Dr().checkmarkFillIcon)({width:16,height:16}),title:(0,J.jsx)(Zr,{rootStore:t,uniqueAutomations:I,firstEdit:A,spaceId:i.spaceId,environment:f,shortened:I.size>1,titleStyle:{fontWeight:S().Wy.semibold}})},subheader:B.join(", "),body:l.slice(-1*Gr).map(((t,i)=>(0,J.jsx)("div",{children:(0,J.jsx)(Jr,{...e,edit:t,isViewAllMenu:!1,source:h,isLast:l.length>Gr?i===l.length-1-Gr:i===l.length-1,clampedMessageContainerRef:_})},i))),isFirst:c,isLast:s,rootStore:t,navigableBlockId:R.id,notification:p,url:C,...(0,ze().$5)({notification:p,activity:i,environment:f,tab:g}),children:(M||l.length>Gr)&&(0,J.jsx)("div",{style:d,children:(0,J.jsx)("div",{style:k.container,children:(0,J.jsx)(Qr,{edits:l,rootStore:t,activity:i,navigableBlockStore:R,source:h})})})}):null}function Qr(e){const{edits:t,rootStore:i,activity:s,navigableBlockStore:a,source:l}=e,d=(0,r().Y0)(),c=(0,r().v3)(),{handleAnalyticsForPopupMenu:g}=(0,o.useContext)(on),m=(0,n().uB)(void 0,oo().A),p=(0,o.useCallback)((()=>m.reset()),[m]),v=(0,o.useMemo)((()=>(0,J.jsx)(b().sA,{defaultMessage:"{numNotifications, plural, one {View more} other {View {numRemainingNotifications}}}",id:"inAppNotificationAutomationActionTriggeredActivity.renderViewAllNotificationsButton.buttonLabel",values:{numNotifications:t.length,numRemainingNotifications:t.length}})),[t.length]);let h;h=d.isMobile?{menuType:to().gu.Modal,title:v,right:(0,J.jsx)(so().DoneMenuText,{}),onClickRight:p,whiteBackground:!0}:{menuType:to().gu.Popup,width:420,maxWidth:d.isMobileBrowser?"80vw":"100%"};const f=(0,u().IS)((e=>({actionButton:(0,it().Ei)(e),divider:{borderBlockEnd:`1px solid ${e.regularDividerColor}`},viewAllMenuNotificationContainer:{display:"flex",flexDirection:"column",padding:12},viewAllMenuHeaderContainer:{display:"flex",flexDirection:"row",gap:ie},popupMenu:{marginInlineStart:-2,fontSize:ue}})),[]),y=(0,o.useId)();return(0,J.jsx)(V().Ay,{buttonPopupStore:m,popupType:d.isMobile?io().n.SlideUp:io().n.Popup,placementToOrigin:E().W.Bottom,alignmentToOrigin:E().C.Center,originGap:4,onClick:()=>!m.state.open&&g(),renderOrigin:e=>(0,J.jsx)(ye().p,{isGray:!0,size:"xs",...e,style:f.actionButton,children:v}),render:()=>(0,J.jsx)(no().A,{...h,children:(0,J.jsx)("div",{style:f.popupMenu,children:t.map(((o,r)=>(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:f.viewAllMenuNotificationContainer,children:[(0,J.jsxs)("div",{style:f.viewAllMenuHeaderContainer,children:[(0,J.jsx)(tn,{}),(0,J.jsx)(lo,{timestamp:o.timestamp,titleAriaId:y,onBacklinkClick:()=>null,disableJustify:!0,header:(0,J.jsx)(Zr,{rootStore:i,uniqueAutomations:new Set([o.automation_id]),firstEdit:o,spaceId:s.spaceId,environment:c,closeViewAllMenu:p,shortened:!0,titleStyle:{fontWeight:S().Wy.semibold},verbose:!0}),rootStore:i,navigableBlockId:a.id,showRecordPath:!1})]}),(0,J.jsx)(Jr,{...e,edit:o,isViewAllMenu:!0,source:l,isLast:r===t.length-1},r)]}),r!==t.length-1&&(0,J.jsx)("div",{style:f.divider})]},r)))})})})}const Xr=4;function Jr(e){const{edit:t,rootStore:i,source:o,isViewAllMenu:s,clampedMessageContainerRef:a}=e,l=(0,u().DP)(),d=(0,r().v3)(),c=(0,r().Y0)(),{isMobile:g}=c,m=(0,n().K8)((()=>d.KatexStore.getKatex()),[d]),p=(0,ei().Ol)(),v=(0,n().K8)((()=>(0,J.jsx)("div",{children:(0,ti().S5)({environment:d,textValue:t.message.value?{value:t.message.value,spaceId:t.space_id}:void 0,parentStore:i,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disabled:!1,theme:l,emojiType:p,katex:m,parentBlockId:void 0,renderedPageBlockId:void 0,formulaValueTypes:[],stopLinkPropagation:!0})})),[d,p,m,l,t.message.value,i,t.space_id]),h=(0,u().IS)((e=>({container:{paddingInlineStart:s?32:(0,it().F9)({source:o,isMobile:g}),paddingBlockEnd:4},messageContainer:{position:"relative",display:"flex",justifyContent:"space-between",alignItems:"center"},clampedMessageContainer:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:s?void 0:Xr,verticalAlign:"top",textAlign:"left",lineHeight:S().K_.UIRegular.desktop,...S().RC},messageContent:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:ue,lineHeight:(0,Fi().ks)({device:c},"UIRegular"),paddingInlineEnd:8}})),[g,o,c,s]);return(0,J.jsx)("div",{style:{...s&&h.container,...h.messageContainer},children:(0,J.jsx)("div",{ref:a,style:h.clampedMessageContainer,children:(0,J.jsx)("div",{style:h.messageContent,children:v})})})}function Zr(e){const{rootStore:t,spaceId:i,environment:o,closeViewAllMenu:r,shortened:s,titleStyle:a,firstEdit:l,uniqueAutomations:d,verbose:c=!1}=e,u=(0,b().tz)(),g=1===d.size,p=(0,n().K8)((()=>!w().dn.createChildStore(t,{table:Tt().yB,id:l.automation_id,spaceId:t.getSpaceId()}).getAlive()),[t,l]),h=(0,n().K8)((()=>{const e=new(w().Bv)(o,{id:l.automation_navigable_block_id,table:v().ev}).getRole();return!e||!(0,Ie().Tt)(e)}),[l,o]),f=(0,n().K8)((()=>{if(!(p&&g||h))return()=>{const e=l.automation_navigable_block_id,i=l.automation_id,n=w().Bv.createChildStore(t,{table:v().ev,id:e});if(!n)return;r&&r();const s=(0,Rt().Ay)({store:n,preferPublicLink:!1,pageVisitSource:m().y8.Notification});Mt().oo({environment:o,url:s,callback:async()=>await Wt({environment:o,automationNavigableBlockStore:n,automationId:g?i:void 0,rootStore:t,source:"in_app_notification"})})}}),[o,g,l,t,r,p,h]),y=(0,n().K8)((()=>[...d].map((e=>{const o=t.getRecordStore(t,{table:Tt().yB,id:e,spaceId:i}),r=o.getRole();return(0,x().O9)(r)&&(0,Ie().Tt)(r)?o.getAlive()?o.getNameWithDefault(u):u.formatMessage(Kt().VS.automationDeletedName):u.formatMessage(Kt().VS.automationPrivateName)}))),[u,t,i,d]);return s?c?(0,J.jsx)("div",{style:{...a,display:"inline-flex"},children:(0,J.jsx)(en,{handleAutomationNavigate:f,automationNames:y})}):(0,J.jsx)(b().sA,{defaultMessage:"Messages from automations",id:"inAppNotificationAutomationActionTriggeredActivity.multipleAutomation.header"}):c?(0,J.jsx)(b().sA,{id:"inAppNotificationAutomationActionTriggeredActivity.formattedHeaderMessage.automationTitle",defaultMessage:"{automationNameWrappedHeader} sent you a message",values:{automationNameWrappedHeader:(0,J.jsx)("div",{style:{...a,display:"inline-flex"},children:(0,J.jsx)(en,{handleAutomationNavigate:f,automationNames:y})})}}):(0,J.jsx)(b().sA,{defaultMessage:"Messages from automation",id:"inAppNotificationAutomationActionTriggeredActivity.singleAutomation.header"})}function en(e){const{automationNames:t,handleAutomationNavigate:i}=e,o=(0,b().tz)(),r=t.at(0),n=t.length,s=n-2,a=o.formatList([...t.slice(0,2),s>0?o.formatMessage({defaultMessage:"{numRemainingAutomations} more",id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.tooltipNumRemainingAutomations"},{numRemainingAutomations:s}):void 0].filter(x().O9),{style:"long",type:"conjunction"}),l={defaultMessage:"{numAutomations, plural, one {{firstAutomationName}} other {{numAutomations} automations}}",values:{firstAutomationName:r,numAutomations:n},id:"inAppNotificationAutomationActionTriggeredActivity.wrappedAutomationName.automationName",description:"The display name for an automation."},d=e=>i?(0,J.jsx)(Nt().A,{...e,onClick:i,children:(0,J.jsx)(b().sA,{...l})}):(0,J.jsx)("div",{...e,children:(0,J.jsx)(b().sA,{...l,...e})});return 1===n?d():(0,J.jsx)(Y().A,{renderTooltip:e=>(0,J.jsx)("div",{...e,children:a}),render:e=>d(e)})}function tn(){const e=(0,u().IS)((e=>({icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,J.jsx)(he,{children:(0,eo().v)(e.icon)})}const on=(0,o.createContext)({handleAnalyticsForPopupMenu:()=>{}});function rn(e){const{analyticsInfo:t,children:i}=e,r=(0,o.useCallback)((()=>Ke().mF(t)),[t]);return(0,J.jsx)(on.Provider,{value:{handleAnalyticsForPopupMenu:r},children:i})}on.displayName="InAppNotificationAutomationActionTriggeredAnalyticsContext";const nn=o.memo($r);function sn(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{tab:l,notification:d}=o,c=(0,r().v3)(),u=(0,b().tz)(),g=(0,n().K8)((()=>t.navigable_block_id),[t]),p=(0,n().K8)((()=>{const e=So().B.createChildStore(i,{table:v().ev,id:t.navigable_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification})}),[t,i]),h=(0,J.jsx)("span",{children:(0,J.jsx)(b().sA,{defaultMessage:"<b>{author}</b> did not find conflicts",id:"activity.noConflictsFound.header",values:{author:xo().px.getDisplayName(u),b:e=>(0,J.jsx)("span",{style:{fontWeight:S().Wy.semibold},children:e})}})});return p?(0,J.jsx)(fe,{header:h,isFirst:s,isLast:a,isPrivate:!0,rootStore:i,navigableBlockId:g,notification:d,icon:(0,J.jsx)(tt().H8,{authors:[xo().px],size:oe,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),showSnapshotButton:!1,url:p,...(0,ze().$5)({notification:d,activity:t,environment:c,tab:l})}):null}const an=o.memo(sn);function ln(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{tab:l,notification:d}=o,u=(0,r().v3)(),g=(0,b().tz)(),p=(0,n().K8)((()=>t.getEdits()),[t]),h=p[0],f=(0,n().K8)((()=>(0,c().Ln)({edits:p,rootStore:i})),[p,i]),x=(0,n().K8)((()=>(0,c().bD)(f,{fontWeight:S().Wy.regular})),[f]),A=w().sk.createChildStore(i,{table:v().ev,id:t.navigable_block_id,spaceId:i.id}),j=w().sk.createChildStore(i,{table:y().oo,id:h.from_user_id,spaceId:i.id}),_=(0,n().K8)((()=>j.getDisplayName(g)),[j,g]),M=(0,n().K8)((()=>{var e;return null===(e=A.getModel())||void 0===e?void 0:e.getRenderUrl({pageVisitSource:m().y8.Notification,getRecordModel:A.getRecordModel})}),[A]);return p.length>0?(0,J.jsx)(nr().Nx,{header:{icon:(0,J.jsx)(rr().S7,{icon:Dr().checkmarkFillIcon}),title:(0,J.jsx)(b().sA,{defaultMessage:"Private content transfer",id:"activity.privateContentTransferred.header"})},body:(0,J.jsx)(b().sA,{defaultMessage:"{authorPhrase} transferred {fromUserName}{fromUserNameEndsWithS, select, true {’} other {’s}} private pages to you",values:{authorPhrase:x,fromUserName:_,fromUserNameEndsWithS:"s"===_.slice(-1).toLowerCase()},id:"activity.privateContentTransferred.standardizedHeader.short"}),rootStore:i,notification:o.notification,isFirst:s,isLast:a,url:M,...(0,ze().$5)({notification:d,activity:t,environment:u,tab:l})}):null}const dn=o.memo(ln);function cn(e){const{activity:t,tabArgs:i,rootStore:o,isFirst:s,isLast:a}=e,{tab:d,notification:c}=i,g=(0,b().tz)(),p=(0,n().K8)((()=>t.getEdits()),[t]),v=(0,r().v3)(),h=(0,n().K8)((()=>{const e=t.discussion_id;if(!p||!t.discussion_id)return;const{reacted_comment_id:i}=p[0],r=i?jo().SN:l().$Y,n=i??e;return o.getRecordStore(o,{table:r,id:n,spaceId:t.space_id})}),[p,t,o]),f=(0,n().K8)((()=>{if(h){if(h.table===jo().SN){const e=h.getParentStore();return null==e?void 0:e.getParentStore()}return h.table===l().$Y?h.getParentStore():void 0}}),[h]),y=(0,n().K8)((()=>{const e=null==f?void 0:f.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,f]),A=(0,n().K8)((()=>{var e;if(f)return null===(e=f.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:o.getRecordModel,discussionId:t.discussion_id,pageVisitSource:m().y8.Notification})}),[f,o,t]),j=(0,n().K8)((()=>{if(!h)return[];const e=(h.getReactionPointers()??[]).map((e=>w().sk.createChildStore(o,e)));let t;var i;h instanceof w().jg&&(t=null===(i=h.getCreatedById)||void 0===i?void 0:i.call(h));if(h instanceof w().cc){const e=h.getParentStore();t=null==e?void 0:e.getCreatedById()}const r=(0,K().hS)(e.flatMap((e=>{var t;return(null===(t=e.getActorPointers())||void 0===t?void 0:t.filter(x().O9))??[]})).filter((e=>e.id!==t)),"id"),n=new Map;null==p||p.forEach((e=>{"reaction-created"===e.type&&e.authors&&e.authors.forEach((t=>{const i=n.get(t.id)??0;e.timestamp>i&&n.set(t.id,e.timestamp)}))}));return r.sort(((e,t)=>{const i=n.get(e.id)??0;return(n.get(t.id)??0)-i}))}),[h,o,p]),_=(0,n().K8)((()=>{if(null==p||!p.length)return;const e=p.filter((e=>"reaction-created"===e.type)),i=e.reduce(((e,t)=>e.timestamp>t.timestamp?e:t),e[0]);if(null==i||!i.reaction_id)return;const r=o.getRecordStore(o,{table:_o().ez,id:i.reaction_id,spaceId:t.space_id});return null==r?void 0:r.getIcon()}),[t,o,p]),M=(0,u().DP)(),R=(0,n().K8)((()=>{var e;if(!(h instanceof w().jg))return;const i=ii().gp(h).getValue();if(!i)return;const o=(0,Qt().Eh)({textValue:i,currentUserId:v.currentUser.id,getRecordModel:h.getRecordModel,highlightStyle:"text_only"}),r=(0,ti().S5)({environment:v,textValue:{value:o,spaceId:t.space_id},parentStore:h,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableHover:!0,disabled:!0,theme:M,emojiType:(0,ei().FN)(v),katex:v.KatexStore.getKatex(),formulaValueTypes:[]});return`${Array.isArray(r)&&(null===(e=r[0])||void 0===e||null===(e=e.props)||void 0===e?void 0:e.children)||""}`}),[h,v,M,t.space_id]),C=(0,n().K8)((()=>j.map((e=>{var t;return null===(t=w().sk.createChildStore(o,e).getModel())||void 0===t?void 0:t.getDisplayName(g)})).filter(x().O9).join(", ")),[j,o,g]),k=(0,n().K8)((()=>{var e;if(!f)return null;const t=null===(e=f.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:o.getRecordModel}),i=f.isEmptyPage();return(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{id:"activity.reactionActivity.pageTitleText",defaultMessage:"Reacted in {pageTitle}",values:{pageTitle:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:t,isEmptyPage:i,size:16}),(0,J.jsx)(G().A,{store:f,style:{fontWeight:S().Wy.medium}})]})}})})}),[f,o]),I="actor"===(0,oi().r)("notification_ia");if(!h||!f)return null;const B=h instanceof w().jg;return I?(0,J.jsx)(rr().my,{notificationTitleStore:f,header:{icon:_?(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24},children:(0,J.jsx)(Mo().A,{char:_,size:20})}):null,title:C},subheader:k,body:(0,J.jsxs)("div",{children:[(0,J.jsx)("div",{style:{marginBottom:3},children:R}),(0,J.jsx)("div",{children:(0,J.jsx)(Xt().fj,{parentStore:h,discussionLocation:"updates_menu_archive"})})]}),isFirst:s,isLast:a,rootStore:o,navigableBlockId:y,notification:c,url:A,...(0,ze().$5)({notification:c,environment:v,tab:d,activity:t})}):(0,J.jsx)(nr().Nx,{notificationTitleStore:f,subheader:C,body:(0,J.jsx)(b().sA,{defaultMessage:"Reacted {emoji}{hasComment, select, true { to {commentContent}} other {}}",id:"activity.reactionActivity.reactionMessage",values:{emoji:_?(0,J.jsx)(Mo().A,{char:_,size:16}):null,hasComment:Boolean(B&&R),commentContent:R}}),isFirst:s,isLast:a,rootStore:o,navigableBlockId:y,notification:c,url:A,...(0,ze().$5)({notification:c,environment:v,tab:d,activity:t})})}const un=o.memo(cn);function gn(e){const{activity:t,rootStore:o,tabArgs:s,isFirst:a,isLast:l}=e,{notification:d,tab:c}=s,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),p=g.length>0,h=w().Bv.createChildStore(o,{table:v().ev,id:g[0].navigable_block_id}),f=(0,n().K8)((()=>h.isDefined()),[h]),y=(0,n().K8)((()=>{const e=w().Bv.createChildStore(o,{table:v().ev,id:t.reminder_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:m().y8.Notification})}),[t,o]),x=(0,n().K8)((()=>{var e;const t=null===(e=h.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:o.getRecordModel}),i=h.isEmptyPage();return(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,J.jsx)($().B,{disabled:!0,icon:t,isEmptyPage:i,size:16}),(0,J.jsx)(G().A,{store:h,style:{fontWeight:S().Wy.medium}})]})}),[h,o]),A="actor"===(0,oi().r)("notification_ia");return p&&f&&y?A?(0,J.jsx)(rr().my,{notificationTitleStore:h,header:{icon:(0,J.jsx)(rr().S7,{icon:i(68913).alarmIcon}),title:(0,J.jsx)(b().sA,{defaultMessage:"Reminder",id:"activity.reminderInActivity.header.short"})},subheader:x,body:(0,J.jsx)(Vt().A,{edit:g[0],rootStore:o}),isFirst:a,isLast:l,rootStore:o,navigableBlockId:h.id,notification:d,url:y,...(0,ze().$5)({notification:d,activity:t,environment:u,tab:c})}):(0,J.jsx)(nr().Nx,{subheader:(0,J.jsx)(b().sA,{defaultMessage:"Reminder",id:"activity.reminderInActivity.header.short"}),body:(0,J.jsx)(Vt().A,{edit:g[0],rootStore:o}),isFirst:a,isLast:l,rootStore:o,navigableBlockId:h.id,notification:d,url:y,...(0,ze().$5)({notification:d,activity:t,environment:u,tab:c})}):null}const mn=o.memo(gn);function pn(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d}=o,u=(0,r().v3)(),g=(0,n().K8)((()=>t.getEdits()),[t]),p=g.length>0,v=(0,n().K8)((()=>(0,c().Ln)({edits:g,rootStore:i})),[g,i]),h=(0,n().K8)((()=>(0,c().bD)(v,{...(0,R()._m)()})),[v]),y=g[0],x=(0,n().K8)((()=>w().h4.createChildStore(i,{table:f().yK,id:y.team_id})),[i,y.team_id]),A=(0,n().K8)((()=>{var e;return null===(e=x.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:x.getRecordModel})}),[x]),j=(0,n().K8)((()=>x.isDefined()),[x]),_=(0,n().K8)((()=>{if((0,Bo().D)({isMobileNative:u.device.isMobileNative}))return(0,Io().a)({teamId:y.team_id,pageVisitSource:m().y8.Notification})}),[y.team_id,u]),M="actor"===(0,oi().r)("notification_ia");return p&&j&&x?M?(0,J.jsx)(rr().my,{notificationTitleStore:x,header:{icon:(0,J.jsx)(tt().H8,{authors:v,size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:h},subheader:(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{defaultMessage:"Invited you to {teamIconAndName}",id:"activity.teamMembershipEdited.subheader",values:{teamIconAndName:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:A,isEmptyPage:!1,size:16}),(0,J.jsx)(G().A,{store:x,style:{fontWeight:S().Wy.medium}})]})}})}),isFirst:s,isLast:a,rootStore:i,notification:l,url:_,...(0,ze().$5)({notification:l,activity:t,environment:u,tab:d})}):(0,J.jsx)(nr().Nx,{notificationTitleStore:x,subheader:h,body:(0,J.jsx)(b().sA,{defaultMessage:"Invited you to the teamspace",id:"activity.teamMembershipEdited.body"}),isFirst:s,isLast:a,rootStore:i,notification:l,url:_,...(0,ze().$5)({notification:l,activity:t,environment:u,tab:d})}):null}const vn=o.memo(pn);function hn(e){const{activity:t,rootStore:i,isFirst:o,isLast:s,tabArgs:a}=e,{tab:l,notification:d}=a,g=(0,r().v3)(),p=(0,b().tz)(),h=(0,n().K8)((()=>t.getEdits()),[t]),f=h.length>0,y=h[0],x=(0,n().K8)((()=>w().Bv.createChildStore(i,{table:v().ev,id:y.navigable_block_id})),[y,i]),A=(0,n().K8)((()=>x&&x.isDefined()),[x]),j=(0,n().K8)((()=>w().Bv.createChildStore(i,{table:v().ev,id:t.mentioned_block_id,spaceId:i.id})),[t,i]),_=(0,n().K8)((()=>{const e=j.getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification})}),[j,i]),M=(0,u().eP)(),R=(0,n().K8)((()=>{const e=(0,Mr().O4)({theme:M}),t=j.getTitleValue();return(0,ti().S5)({environment:g,textValue:{value:t,spaceId:i.id},parentStore:x,disableHover:!1,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0,disableSuggestionAnnotations:!0,disabled:!0,emojiType:(0,ei().FN)(g),theme:e,katex:g.KatexStore.getKatex(),formulaValueTypes:[]})}),[j,M,g,i,x]),C=(0,n().K8)((()=>(0,c().Ln)({edits:h,rootStore:i})),[h,i]),k=C.map((e=>e.asActor)),I=(0,n().K8)((()=>{const e=C[0];if(e)return e}),[C]),B=(0,n().K8)((()=>I?I.getDisplayName(p):null),[I,p]),K=(0,n().K8)((()=>{var e;if(!x)return null;const t=null===(e=x.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:i.getRecordModel}),o=x.isEmptyPage();return(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{id:"activity.teamMentionActivity.pageTitleText",defaultMessage:"Mentioned your teamspace in {pageTitle}",values:{pageTitle:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:t,isEmptyPage:o,size:16}),(0,J.jsx)(G().A,{store:x,style:{fontWeight:S().Wy.medium}})]})}})})}),[x,i]),T="actor"===(0,oi().r)("notification_ia");return f&&A&&_?T?(0,J.jsx)(rr().my,{notificationTitleStore:x,header:{icon:(0,J.jsx)(tt().H8,{authors:k,size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:B},subheader:K,body:(0,J.jsx)(b().sA,{defaultMessage:'"{blockText}"',id:"activity.teamMentionActivity.bodyBlockText",values:{blockText:R}}),isFirst:o,isLast:s,rootStore:i,navigableBlockId:x.id,notification:d,url:_,...(0,ze().$5)({notification:d,activity:t,environment:g,tab:l})}):(0,J.jsx)(nr().Nx,{subheader:B,body:(0,J.jsx)(b().sA,{defaultMessage:'Mentioned your teamspace, "{blockText}"',id:"activity.teamMentionActivity.body",values:{blockText:R}}),isFirst:o,isLast:s,rootStore:i,navigableBlockId:x.id,notification:d,url:_,...(0,ze().$5)({notification:d,activity:t,environment:g,tab:l})}):null}const fn=o.memo(hn);function yn(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:s,isLast:a}=e,{notification:l,tab:d}=o,u=(0,r().v3)(),g=(0,b().tz)(),p=(0,n().K8)((()=>t.getEdits()),[t]),v=xn({spaceStore:i,edit:p[0]}),h=(0,n().K8)((()=>(0,c().Ln)({edits:p,rootStore:i})),[p,i]),f=(0,n().K8)((()=>{if("block"===(null==v?void 0:v.type))return v.blockStore}),[v]),y=(0,n().K8)((()=>{if(!f)return;const e=f.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:m().y8.Notification}):void 0}),[f,i.getRecordModel]),x=(0,n().K8)((()=>t.navigable_block_id),[t]),A=function(e){const{edit:t,activity:i,spaceStore:o}=e,r=xn({spaceStore:o,edit:t}),s=(0,n().K8)((()=>parseInt(i.getEndTime())),[i]),a=(0,n().K8)((()=>{if("block"!==(null==r?void 0:r.type))return;const e=r.blockStore;return null!=e&&e.isDefined()?e.getModel():void 0}),[r]);return(0,n().K8)((()=>{if(!a)return{isValid:!1};const e=a&&(0,Fo()._T)(a,i);if(!e)return{isValid:!1};const t=o.getRecordModel({table:Eo().Yx,id:e,spaceId:i.space_id});return t&&t.getMessage()&&t.getCreatedTime()<=s+5*Vo().Xb?{isValid:!0,message:t.getMessage()}:{isValid:!1}}),[i,s,a,o])}({edit:p[0],activity:t,spaceStore:i}),j=(0,n().K8)((()=>{if(v){if("block"===v.type)return v.blockStore;if("group"===v.type){const e=h[0];if(!e)return;return w().sk.createChildStore(i,e.pointer)}return"space"===v.type?v.spaceStore:void 0}}),[h,v,i]),_=(0,n().K8)((()=>{var e;return Boolean(null===(e=h[0])||void 0===e?void 0:e.isBot())}),[h]),M=(0,n().K8)((()=>{var e;return null===(e=h[0])||void 0===e?void 0:e.getDisplayName(g)}),[h,g]),R=(0,n().K8)((()=>{var e;if(!f)return null;const t=null===(e=f.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:i.getRecordModel}),o=f.isEmptyPage();return(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",gap:4},children:(0,J.jsx)(b().sA,{id:"activity.userInvitedActivity.pageTitleText",defaultMessage:"Invited you to {pageTitle}",values:{pageTitle:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)($().B,{disabled:!0,icon:t,isEmptyPage:o,size:16}),(0,J.jsx)(G().A,{store:f,style:{fontWeight:S().Wy.medium},underline:!1})]})}})})}),[f,i]),C="actor"===(0,oi().r)("notification_ia");return 0!==p.length&&v&&j?C?(0,J.jsx)(rr().my,{notificationTitleStore:j,header:{icon:(0,J.jsx)(tt().H8,{authors:h.map((e=>e.asActor)),size:rr().eQ,style:{marginTop:0,marginRight:0},showAvatarShadow:!1}),title:M},subheader:"block"===v.type?R:void 0,body:(0,J.jsx)(bn,{data:v,inviteMessage:A,authors:h,isFromBot:_}),isFirst:s,isLast:a,rootStore:i,navigableBlockId:x,notification:l,url:y,...(0,ze().$5)({notification:l,environment:u,tab:d,activity:t})}):(0,J.jsx)(nr().Nx,{notificationTitleStore:j,subheader:"block"===v.type?h.map((e=>e.getDisplayName(g))).join(", "):void 0,body:(0,J.jsx)(bn,{data:v,inviteMessage:A,authors:h,isFromBot:_}),isFirst:s,isLast:a,rootStore:i,navigableBlockId:x,notification:l,url:y,...(0,ze().$5)({notification:l,environment:u,tab:d,activity:t})}):null}function bn(e){var t,i;const{data:o,inviteMessage:r,authors:s,isFromBot:a}=e,l=(0,n().K8)((()=>(0,c().bD)(s,{fontWeight:S().Wy.regular})),[s]),d="actor"===(0,oi().r)("notification_ia");switch(o.type){case"block":return a?(0,J.jsx)(b().sA,{defaultMessage:"You were invited to a page",id:"activity.userInvitedActivityByBot.standardizedHeader.redesign"}):d?(0,J.jsx)(b().sA,{defaultMessage:'{hasMessage, select, true {"{message}"} other {}}',id:"activity.userInvitedActivity.actorBody",values:{hasMessage:r.isValid&&r.message?"true":"false",message:r.isValid?r.message:""}}):(0,J.jsx)(b().sA,{defaultMessage:'Invited you to the page{hasMessage, select, true {, "{message}"} other {}}',id:"activity.userInvitedActivity.body",values:{hasMessage:r.isValid&&r.message?"true":"false",message:r.isValid?r.message:""}});case"group":return a?(0,J.jsx)(b().sA,{defaultMessage:"You were added to @{groupName}",values:{groupName:null===(t=o.group)||void 0===t?void 0:t.name},id:"activity.userInvitedActivityGroupIdByBot.standardizedHeader.redesign"}):(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to @{groupName}} other {{authorOrAuthors} added you to @{groupName}}}",values:{numberOfAuthors:s.length,authorOrAuthors:l,groupName:null===(i=o.group)||void 0===i?void 0:i.name},id:"activity.userInvitedActivityGroupId.standardizedHeader.redesign"});case"space":return a?(0,J.jsx)(b().sA,{defaultMessage:"You were invited to a workspace",id:"activity.userInvitedActivityOtherInviteByBot.standardizedHeader.redesign"}):(0,J.jsx)(b().sA,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a workspace} other {{authorOrAuthors} invited you to a workspace}}",values:{numberOfAuthors:s.length,authorOrAuthors:l},id:"activity.userInvitedActivityOtherInvite.standardizedHeader.redesign"});default:(0,x().HB)(o)}}function xn(e){const{spaceStore:t,edit:i}=e;return(0,n().K8)((()=>{if(i)return i.navigable_block_id?{type:"block",blockStore:w().Bv.createChildStore(t,{table:v().ev,id:i.navigable_block_id})}:i.permission_group_id?{type:"group",group:(0,Oo().$I)({spaceId:i.space_id,permissionGroupId:i.permission_group_id,getRecordValue:t.getRecordValue})}:{type:"space",spaceStore:w().SL.createChildStore(t,{table:h().NX,id:i.space_id})}}),[i,t])}function Sn(e){const{activity:t,rootStore:o,tabArgs:s,isFirst:a,isLast:l}=e,{tab:d,notification:u}=s,g=(0,r().v3)(),p=(0,n().K8)((()=>w().Bv.createChildStore(o,{table:v().ev,id:t.navigable_block_id})),[t,o]),h=(0,n().K8)((()=>p.isDefined()),[p]),f=(0,n().K8)((()=>{const e=p.getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:m().y8.Notification})}),[p,o]),y=(0,n().K8)((()=>t.collection_id?w().md.createChildStore(o,{table:er().Vl,id:t.collection_id,spaceId:t.space_id}):void 0),[t,o]),x=(0,n().K8)((()=>Boolean(null==y?void 0:y.isPageTreeCollection())),[y]),A=(0,n().K8)((()=>{let e;if(x){const t=null==y?void 0:y.getSchema();e=(t?Object.keys(t):[]).find((e=>{var i;return!!t&&"verification"===(null===(i=t[e])||void 0===i?void 0:i.type)}))}else e=tr()._e.Verification;let t=(0,J.jsx)(b().sA,{id:"Activity.author.unknown",defaultMessage:"Unknown"});if(e){const i=p.getPropertyValue(e),r=(0,tr().U1)(i);if(r){const e=r[0],i=(0,c().T9)(e,o);i&&i.asActor&&(t=(0,c().bD)([i],{...(0,R()._m)(),fontWeight:S().Wy.regular}))}}return t}),[p,y,x,o]),{activityStartTimestamp:j,activityEndTimestamp:_}=(0,n().K8)((()=>({activityStartTimestamp:parseInt(t.start_time),activityEndTimestamp:parseInt(t.end_time)})),[t]),M="actor"===(0,oi().r)("notification_ia");if(!h)return null;const C=j&&_?(0,J.jsx)(b().sA,{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:A,startDate:(0,U().DG)(j),endDate:(0,U().DG)(_)},id:"activity.verificationExpired.contentWithTimestamp"}):(0,J.jsx)(b().sA,{defaultMessage:"Last verified by {person}",values:{person:A},id:"activity.verificationExpired.contentWithoutTimestamp"}),k=x?(0,J.jsx)(b().sA,{defaultMessage:"Wiki verification expired",id:"activity.verificationExpiredWiki.body"}):(0,J.jsx)(b().sA,{defaultMessage:"Page verification expired",id:"activity.verificationExpiredPage.body"});return M?(0,J.jsx)(rr().my,{notificationTitleStore:p,header:{icon:(0,J.jsx)(rr().S7,{icon:i(112665).J}),title:k},body:C,isFirst:a,isLast:l,rootStore:o,navigableBlockId:p.id,notification:u,url:f,...(0,ze().$5)({notification:u,activity:t,environment:g,tab:d})}):(0,J.jsx)(nr().Nx,{subheader:k,body:C,isFirst:a,isLast:l,rootStore:o,navigableBlockId:p.id,notification:u,url:f,...(0,ze().$5)({notification:u,activity:t,environment:g,tab:d})})}const An={"block-property-edited":Tr,"user-mentioned":Br,commented:Lr,"user-invited":o.memo(yn),reminder:mn,"email-edited":Ur,"access-requested":br,"access-request-resolved":Sr,"team-membership-edited":vn,"private-content-transferred":dn,"permission-group-mentioned":Fr,"team-mentioned":fn,"verification-expired":o.memo(Sn),"export-completed":Or,"import-completed":Hr,"in-app-notification-automation-action-triggered":nn,"no-conflicts-found":an,"automation-typecheck-error-raised":_r,reacted:un,"upgrade-request-created":Wo,"app-builder-notification":kt,"external-integration-notification":zi,"trial-created":Lo};function jn(e){const{activity:t,rootStore:i}=e,{source:n,notification:s,tab:a,...d}=e,u=(0,r().v3)(),g=(0,o.useMemo)((()=>({source:n,notification:s,tab:a})),[n,s,a]);return(0,o.useEffect)((()=>{!function(e,t){if("commented"===e.type){const o=t.getRecordStore(t,{table:l().$Y,id:e.discussion_id,spaceId:e.space_id});if(o.isDefined()){const e=o.getCommentStores();for(const t of e){var i;null===(i=t.getCreatedByStore())||void 0===i||i.load()}}}}(t,i),u.KatexStore.loadIfNeeded((()=>function(e,t){const i=(0,c().U6)({activity:e,rootStore:t});if(!i)return;return i.context}(t,i)))}),[u.KatexStore,t,i]),(0,J.jsx)("div",{"data-activity-id":t.id,"data-notification-id":s.id,"data-notification-type":s.type,children:(0,J.jsx)(_n,{...d,tabArgs:g})})}function _n(e){const{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:l}=e,c=(0,n().K8)((()=>t.type),[t]),u=(0,d().X)("inbox_page_grouping_notification_style"),g=e.overrideUsePageGroupRedesign??u;if(!(0,s().Jc)(c))return a().log({level:"error",from:"ActivityNotification",type:"unsupportedActivityType",data:{message:`Activity type ${c} is not supported for ActivityNotification`}}),null;if(g){const e=An[c];return(0,J.jsx)(e,{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:l})}const m=or[c];return(0,J.jsx)(m,{activity:t,rootStore:i,tabArgs:o,isFirst:r,isLast:l})}},613198:(e,t,i)=>{i.d(t,{Q:()=>r});i(296540);var o=i(474848);const r=(0,i(340498).wt)("speechBubble",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M4.32 15.424c.39 0 .677-.192 1.149-.609l2.344-2.064h4.116c2.057 0 3.213-1.19 3.213-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.22h.28v1.675c0 .608.322.998.875.998zm.342-1.531v-1.949c0-.403-.178-.56-.56-.56H3.26c-1.285 0-1.9-.65-1.9-1.894V4.26c0-1.243.615-1.893 1.9-1.893h8.627c1.278 0 1.893.65 1.893 1.894v5.23c0 1.243-.615 1.893-1.893 1.893h-4.15c-.417 0-.622.068-.909.369l-2.167 2.14z"})})},625383:(e,t,i)=>{i.d(t,{d:()=>l,h:()=>d});i(296540);var o=()=>i(401497),r=()=>i(907514),n=()=>i(859428),s=()=>i(566468),a=i(474848);function l(e){let{dateTs:t,useSecondaryColorTitle:i,includeTime:o,tooltip:l,omitTooltip:d}=e;const c=(0,a.jsx)(s().s7,{useThinTitle:!0,useSecondaryColorTitle:i,title:o?(0,r().x$)(t,!0):(0,r().DG)(t)});return d?c:(0,a.jsx)(n().A,{render:e=>(0,a.jsx)("div",{...e,children:c}),renderTooltip:()=>l??(0,r().x$)(t)})}function d(){const e=(0,o().IS)((()=>({title:{width:"50%"}})),[]);return(0,a.jsx)(s().mf,{titleStyles:e.title})}},641300:(e,t,i)=>{i.d(t,{Gr:()=>R,WE:()=>k,rC:()=>C});i(898992),i(581454),i(908872);var o=i(296540),r=()=>i(401497),n=()=>i(158359),s=()=>i(126158),a=()=>i(380048),l=()=>i(742117),d=()=>i(525884),c=()=>i(959013),u=()=>i(534177),g=()=>i(284371),m=()=>i(753199),p=()=>i(553965),v=()=>i(115512),h=()=>i(962730),f=()=>i(704152),y=()=>i(493823),b=()=>i(625830),x=()=>i(958846),S=()=>i(554509),A=()=>i(859428),j=i(474848);const _=14,M=16,R=_+M,w=24;function C(e){let{columnRenderInfo:t,theme:i,containerMarginTop:o}=e;return{container:{marginTop:o??17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:t.reduce(((e,t)=>e+N(t.widthData)+w),0)},tableHeaderRow:{},paddingRowCell:{height:8}}}function k(e){let{columnRenderInfo:t,sortState:i,onSortStateChanged:n,showRowBorders:s,hideHeaderRow:a,hideHeaderRowPadding:l,renderRowChild:d,rows:c,onRowClick:u,renderNoRowsComponent:g,styles:m,getStyleForRow:p,extendToFullScreen:v,multiselect:h,allowHorizontalScroll:f,setStickyHeaderColumn:y,maxHeight:b,setStickyHeaderRow:S,loadMoreMethod:A}=e;const _=f?y??!0:void 0,M=(0,r().IS)((e=>({horizontalScrollContainer:{position:"relative",width:null!=v&&v.extendTableToFullWidthOffsetPx?`calc(100% + ${null==v?void 0:v.extendTableToFullWidthOffsetPx}px)`:"100%",display:"grid",overflow:"auto"},scrollableContainer:{maxHeight:b,position:"relative",display:"grid",overflowX:"auto",width:"100%"},table:_?{...m.container,minWidth:"100%",width:void 0}:m.container})),[m.container,_,b,null==v?void 0:v.extendTableToFullWidthOffsetPx]),R=(0,r().IS)((e=>({thead:{position:"sticky",zIndex:1}})),[]),w=(0,o.useCallback)((e=>{var t;const o=e.id===(null==i||null===(t=i.column)||void 0===t?void 0:t.id)&&!(null!=i&&i.sortAscending);n&&n({sortAscending:o,column:e})}),[i,n]),C=(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("table",{style:M.table,children:[!a&&(0,j.jsx)("thead",{style:S?R.thead:void 0,children:(0,j.jsxs)("tr",{children:[t.map(((e,t)=>(0,j.jsx)(I,{index:t,column:e,sortState:i,handleSortableColumnClick:w,shouldShowSortIcon:0!==c.length,multiselect:h,setStickyHeaderColumn:_,setStickyHeaderRow:S,style:e.headerStyle},`header_${e.id}`))),null!=v&&v.rightPaddingPx?(0,j.jsx)(U,{width:null==v?void 0:v.rightPaddingPx,style:t[t.length-1].rowStyle}):null]})}),!l&&(0,j.jsx)("tbody",{children:(0,j.jsxs)("tr",{children:[t.map((e=>(0,j.jsx)("td",{style:m.paddingRowCell},`padding_row_${e.id}`))),null!=v&&v.rightPaddingPx?(0,j.jsx)("td",{style:m.paddingRowCell}):null]})}),(0,j.jsx)("tbody",{children:c.map((e=>(0,j.jsx)(B,{columns:t,onRowClick:u,rowChild:null==d?void 0:d(e),showRowBorders:s,row:e,getStyleForRow:p,multiselect:h,setStickyHeaderColumn:_,rightPaddingPx:null==v?void 0:v.rightPaddingPx},`${e.id}_row`)))}),c.length>0&&A&&(!f||"scroll"!==(null==A?void 0:A.type))?(0,j.jsx)("tfoot",{children:(0,j.jsx)(z,{columnLength:t.length,loadMoreMethod:A,showRowBorders:s,rightPaddingPx:null==v?void 0:v.rightPaddingPx,style:t[t.length-1].rowStyle})}):null]}),0===c.length&&g()]});return f?(0,j.jsxs)("div",{style:M.horizontalScrollContainer,children:[(0,j.jsxs)("div",{style:M.scrollableContainer,children:[C,b&&"scroll"===(null==A?void 0:A.type)&&(0,j.jsx)(x().A,{loading:!1,loadMoreOffsetThreshold:100,onLoadMore:A.onLoadMore})]}),!b&&"scroll"===(null==A?void 0:A.type)&&(0,j.jsx)(x().A,{loading:!1,loadMoreOffsetThreshold:100,onLoadMore:A.onLoadMore})]}):(0,j.jsx)("div",{style:{maxHeight:b,overflowY:S&&b?"auto":void 0,overflowX:S&&b?"hidden":void 0},children:C})}function I(e){let{column:t,index:i,sortState:n,handleSortableColumnClick:a,shouldShowSortIcon:l,multiselect:u,setStickyHeaderColumn:m,setStickyHeaderRow:v,style:f}=e;const[x,S]=(0,o.useState)(!1),R=0===i,w=t.id===(null==n?void 0:n.column.id),C=(0,r().IS)((e=>({th:{boxShadow:`\n\t\t\t\t\tinset 0 1px 0 ${e.tableDividerColor},\n\t\t\t\t\tinset 0 -1px 0 ${e.tableDividerColor}\n\t\t\t\t`,...v&&{position:"sticky",top:0,zIndex:3,background:e.modalBackground},...P(t),...m&&R&&{position:"sticky",zIndex:4,left:0,background:e.modalBackground,boxShadow:`\n\t\t\t\t\t\t\tinset -1px 0px 0px ${e.tableDividerColor},\n\t\t\t\t\t\t\tinset 0 1px 0 ${e.tableDividerColor},\n\t\t\t\t\t\t\tinset 0 -1px 0 ${e.tableDividerColor}\n\t\t\t\t\t\t`},height:32,...f},innerDiv:{display:"flex",alignItems:"center",height:"100%",minWidth:N(t.widthData),maxWidth:t.widthData.maxWidth},text:{fontSize:g().J.UISmall.desktop,fontWeight:g().Wy.regular,color:e.text.secondary,...g().RC},sortButton:{padding:5,margin:-5},sortIcon:{color:e.text.secondary,width:12,height:12,marginLeft:4,fill:"currentColor"},multiselectCheckbox:{color:e.selectLightGray[300],marginRight:M,opacity:null!=u&&u.header.isDisabled?.5:1},tooltipContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},tooltipIcon:{marginLeft:4,color:x?e.mediumIconColor:e.lightIconColor,height:16,width:16},tooltip:{width:380}})),[t,u,m,v,f,R,x]),k=()=>{if(n&&l&&w)return(0,s().m)({...C.sortIcon,...n.sortAscending&&{transform:"rotate(180deg)"}})},I={onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1)},B=t.headerInfoTooltip?(0,j.jsxs)("div",{style:C.tooltipContainer,children:[(0,j.jsx)("div",{style:C.text,children:t.headerTitle}),(0,j.jsx)(A().A,{textWrap:!0,style:C.tooltip,delayThreshold:0,render:e=>(0,j.jsx)("div",{...(0,p().A)(e,I),children:(0,d().A)(C.tooltipIcon)}),renderTooltip:()=>t.headerInfoTooltip})]}):(0,j.jsx)("div",{style:C.text,children:t.headerTitle}),K=t.sortable?(0,j.jsx)(A().A,{placement:h().W.Bottom,disableTooltip:!t.shouldShowSortTooltip,renderTooltip:()=>w?(0,j.jsx)(c().sA,{id:"baseTable.hoverSortedHeaderCell",defaultMessage:"Reverse sort order"}):(0,j.jsx)(c().sA,{id:"baseTable.hoverSortableHeaderCell",defaultMessage:"Sort by this column"}),render:e=>(0,j.jsxs)(y().p,{size:"xs",style:C.sortButton,onClick:()=>a(t),...e,children:[B,k()]})}):B,T=void 0!==u&&0===i?(0,j.jsx)(b().A,{style:C.multiselectCheckbox,disabled:u.header.isDisabled,onClick:()=>u.header.onClick(),checked:u.header.isSelected,size:_,tapArea:{size:30}}):null;return(0,j.jsx)("th",{style:C.th,children:(0,j.jsxs)("div",{style:C.innerDiv,children:[T,K]})})}function B(e){let{row:t,columns:i,onRowClick:n,rowChild:s,showRowBorders:a,getStyleForRow:l,setStickyHeaderColumn:d,multiselect:c,rightPaddingPx:u}=e;const[g,m]=(0,o.useState)(!1),p=t.isClickable,v=(0,o.useCallback)((()=>m(!0)),[]),h=(0,o.useCallback)((()=>m(!1)),[]),f=(0,o.useCallback)((e=>{p&&void 0!==n&&T(e,(()=>n(t)))}),[p,n,t]),y=(0,r().IS)((e=>({row:{height:1,...p&&{cursor:"pointer"},...a&&{borderBottom:`1px solid ${e.tableDividerColor}`},...l&&l(t)}})),[p,a,l,t]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("tr",{onMouseLeave:h,onMouseEnter:v,style:y.row,onClick:f,children:[i.map(((e,o)=>(0,j.jsx)(K,{isRowHovered:g,isRowClickable:p,columnIndex:o,numColumns:i.length,data:t,column:e,multiselect:c,setStickyHeaderColumn:d,cellStyle:e.rowStyle},`cell_${t.id}_${e.id}`))),u?(0,j.jsx)(W,{style:i[i.length-1].rowStyle}):null]}),s&&(0,j.jsx)("tr",{style:y.row,children:(0,j.jsx)("td",{colSpan:i.length,children:s})})]})}function K(e){let{data:t,column:i,columnIndex:o,numColumns:n,isRowHovered:s,isRowClickable:a,multiselect:l,setStickyHeaderColumn:d,cellStyle:c}=e;const u=0===o,m=o===n-1,p=(0,r().IS)((e=>({td:{...P(i),height:"inherit",...u&&{borderRadius:(0,v().Nb)({topLeft:4,bottomLeft:4})},...m&&{borderRadius:(0,v().Nb)({topRight:4,bottomRight:4})},...d&&u&&{position:"sticky",zIndex:2,left:0,background:e.modalBackground,boxShadow:`inset -1px 0px 0px ${e.tableDividerColor}`},...c,...s&&a&&{background:"light"===e.mode?"#f8f8f7":e.accentColors.gray[30]}},innerDiv:{minWidth:N(i.widthData),maxWidth:i.widthData.maxWidth,fontSize:g().J.UIRegular.desktop,color:e.text.primary,minHeight:42,maxHeight:52,display:"flex",alignItems:"center",height:"100%"},multiselectCheckbox:{color:e.selectLightGray[300],marginRight:16,opacity:null!=l&&l.row.getDisabledState(t)?.5:1}})),[i,u,m,s,a,l,t,d,c]),h=Boolean(i.hasClickableContents)||!!i.computeClickableContents&&i.computeClickableContents(t),f=l&&u?(0,j.jsx)(b().A,{style:p.multiselectCheckbox,checked:l.row.getSelectedState(t),onClick:e=>{e.stopPropagation(),l.row.onClick(t)},disabled:l.row.getDisabledState(t),size:14,tapArea:{size:30}}):null;return(0,j.jsx)("td",{style:p.td,children:(0,j.jsxs)("div",{style:p.innerDiv,onClick:h?T:void 0,children:[f,i.renderCell({...t,isRowHovered:s})]})})}function T(e,t){(0,m().SQ)({event:e,context:m().y$.BaseTableRowClick,callback:t})}const q={paddingLeft:w/2,paddingRight:w/2};function N(e){return"minWidth"in e?e.minWidth:e.width}function P(e){let t;return t="width"in e.widthData?{width:e.widthData.width}:{width:`${e.widthData.widthPercent}%`,minWidth:e.widthData.minWidth},{...q,...t}}function L(e){let{columnLength:t,onLoadMore:i,showRowBorders:o,hasNextPage:s}=e;const a=(0,r().IS)((e=>({row:{...o&&{borderBottom:`1px solid ${e.tableDividerColor}`}},container:{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:4},sticky:{position:"sticky",left:0,display:"flex",justifyContent:"flex-start",alignItems:"center",gap:4},button:{display:"flex",alignItems:"center",height:30,borderRadius:o?0:6,whiteSpace:"break-spaces",fontSize:14,paddingRight:8},icon:{width:14,height:14,marginLeft:4,marginRight:6,fill:e.lightIconColor},text:{color:e.text.tertiary}})),[o]);return!1===s?null:(0,j.jsx)("tr",{style:a.row,children:(0,j.jsx)("td",{colSpan:t,children:(0,j.jsx)("div",{style:a.container,children:(0,j.jsx)("div",{style:a.sticky,children:(0,j.jsxs)(f().A,{style:a.button,onClick:i,children:[(0,n().P)(a.icon),(0,j.jsx)("div",{style:a.text,children:(0,j.jsx)(c().sA,{id:"baseTable.loadMoreButton",defaultMessage:"Load more"})})]})})})})})}function D(e){let{columnLength:t,onLoadNext:i,onLoadPrevious:o,currentPage:n,finalPage:s,hasNextPage:d,hasPrevPage:u,showRowBorders:g,rightPaddingPx:m,style:p}=e;const v=(0,r().IS)((e=>({row:{...g&&{borderBottom:`1px solid ${e.tableDividerColor}`}},container:{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:4},sticky:{position:"sticky",left:0,display:"flex",justifyContent:"flex-start",alignItems:"center",gap:4},button:{display:"flex",justifyContent:"center",alignItems:"center",height:30,width:30,borderRadius:g?0:6,whiteSpace:"break-spaces",fontSize:14},icon:{width:14,height:14,marginLeft:4,marginRight:6,fill:e.icon.secondary}})),[g]);return(0,j.jsxs)("tr",{style:v.row,children:[(0,j.jsx)("td",{colSpan:Boolean(m)?t:t-1,children:(0,j.jsx)("div",{style:v.container,children:(0,j.jsxs)("div",{style:v.sticky,children:[(0,j.jsx)(f().A,{ariaLabel:u?"Previous page":"No previous pages",style:v.button,onClick:o,disabled:!u,disabledFeedback:!u,children:(0,a().I)(v.icon)}),(0,j.jsx)(f().A,{ariaLabel:d?"Next page":"No more pages",style:v.button,onClick:i,disabled:!d,disabledFeedback:!d,children:(0,l().V)(v.icon)}),(0,j.jsx)(S().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",children:s?(0,j.jsx)(c().sA,{id:"baseTable.pages.currentPageWithFinalPageCount",defaultMessage:"Page {currentPage} of {finalPage}",values:{currentPage:n,finalPage:s}}):(0,j.jsx)(c().sA,{id:"baseTable.pages.currentPage",defaultMessage:"Page {currentPage}",values:{currentPage:n}})})]})})}),m?(0,j.jsx)(W,{style:p}):null]})}function z(e){let{columnLength:t,loadMoreMethod:i,showRowBorders:o,rightPaddingPx:r,style:n}=e;switch(i.type){case"scroll":return(0,j.jsx)(x().A,{loading:!1,loadMoreOffsetThreshold:100,onLoadMore:i.onLoadMore});case"button":return(0,j.jsx)(L,{columnLength:t,onLoadMore:i.onLoadMore,showRowBorders:o,hasNextPage:i.hasNextPage});case"pages":return(0,j.jsx)(D,{columnLength:t,showRowBorders:o,onLoadNext:i.onLoadNext,onLoadPrevious:i.onLoadPrevious,currentPage:i.currentPage,finalPage:i.finalPage,hasNextPage:i.hasNextPage,hasPrevPage:i.hasPrevPage,rightPaddingPx:r,style:n});default:return(0,u().HB)(i)}}function U(e){const t=(0,r().IS)((t=>({container:{position:"relative"},extender:{width:e.width,height:1},inner:{background:t.modalBackground,position:"absolute",top:0,left:0,right:0,bottom:-1,...e.style}})),[e.width,e.style]);return(0,j.jsxs)("th",{style:t.container,children:[(0,j.jsx)("div",{style:t.extender}),(0,j.jsx)("div",{style:t.inner})]})}function W(e){const t=(0,r().IS)((t=>({container:{position:"relative"},inner:{background:t.modalBackground,position:"absolute",top:0,left:0,right:0,bottom:-1,...e.style}})),[e.style]);return(0,j.jsx)("td",{style:t.container,children:(0,j.jsx)("div",{style:t.inner})})}},692026:(e,t,i)=>{i.d(t,{C:()=>r});var o=()=>i(534177);function r(e){return e.isGuestInviteRequest()?"guest_invite_request":e.isPageAccessRequest()?"page_access_request":e.isSpaceMembershipRequest()?"space_membership_request":e.isTeamMembershipRequest()?"team_membership_request":void(0,o().HB)(e)}},715392:(e,t,i)=>{i.d(t,{W:()=>r});var o=()=>i(666144);const r=new(i(848776).U)((e=>{let{userId:t,spaceId:i}=e;return`${t}-${i}`}),(async function(e,t){var r;let{userId:n,spaceId:s}=t;const[a,l]=await Promise.all([o().sy({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:i(798880).oo,id:n},userId:n}),o().sy({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:(0,i(848538).i1)({userId:n,spaceId:s}),userId:n})]),d=null===(r=i(351360).default.state.currentSpaceViewStore)||void 0===r||null===(r=r.getModel())||void 0===r?void 0:r.first_joined_space_time,c=null==a?void 0:a.value,u=null==l?void 0:l.value;if(c&&u&&d)return{id:c.id,space_id:u.id,membership_type:u.membership_type,email:c.email,name:c.name,profile_photo:c.profile_photo,onboarding_completed:c.onboarding_completed,first_joined_space_time:d}}));i(604341).exposeDebugValue("UserOnSpaceStore",r)},746970:(e,t,i)=>{i.d(t,{KB:()=>b,Wy:()=>S,aV:()=>x,p4:()=>y,si:()=>A});i(18107),i(967357),i(898992),i(354520),i(581454);var o=()=>i(296344),r=()=>i(96689),n=()=>i(798880),s=()=>i(496603),a=()=>i(134696),l=()=>i(966505),d=()=>i(449506),c=()=>i(579627),u=()=>i(246826),g=()=>i(751156),m=()=>i(680074),p=()=>i(592674),v=()=>i(630116),h=()=>i(309049),f=()=>i(224701);async function y(e){const{environment:t,store:i,status:o,requests:r}=e,a=t.currentUser.id;l().qQ(t,{status:o,user_count:r.length,from:e.from,request_type:"member"});const d=await Promise.all(r.map((e=>j(t,{id:e.getForActorId(),table:n().oo})))).then((e=>(0,s().oE)(e)));if("approved"===o){const e=d.map((e=>({type:"existingUser",value:e.__IM_SORRY__getValue(),spaceRole:"read_and_write"})));if(!(await c().eP({environment:t,store:i,inviteTargets:e,inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return{failedUsers:d,resolvedUsers:[]}}return g().createAndCommit({userAction:"accessRequestActions.resolveMembershipRequests",environment:t,canUndo:!0,perform:s=>{r.map((r=>{const d=new(v().v3)(t,r.pointer);u().zv({store:d,transaction:s,data:{granted_time:Date.now(),granted_by_table:n().oo,granted_by_id:a,resolved_time:Date.now(),resolved_by_table:n().oo,resolved_by_id:a,status:o}}),l().vn(t,{status:o,request_id:r.id,from:e.from,for_actor_id:r.for_actor_id,space_role:i.getRole()})}))}}),{failedUsers:[],resolvedUsers:d}}async function b(e){const{environment:t,store:i,status:o,requests:r}=e,d=t.currentUser.id;l().qQ(t,{status:o,user_count:r.length,from:e.from,request_type:"member"});const m=await Promise.all(r.map((e=>j(t,{id:e.getForActorId(),table:n().oo})))).then((e=>(0,s().oE)(e)));if("approved"===o){const e=m.map((e=>({type:"existingUser",value:e.__IM_SORRY__getValue(),spaceRole:"read_and_write"})));if(!(await c().eP({environment:t,store:i,inviteTargets:e,inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return{failedUsers:m,resolvedUsers:[]};const o=i.id,r=await p().A.awaitData(t,{spaceId:o}),n=r?r.map((e=>e.domain.url)):[];a().hp(t,{invite_flow_id:void 0,invite_origin:"membership_request",user_ids:m.map((e=>e.id)),internal_domains:n})}return g().createAndCommit({userAction:"accessRequestActions.resolveMembershipRequests",environment:t,canUndo:!0,perform:e=>{r.map((i=>{const r=new(v().v3)(t,i.pointer);u().zv({store:r,transaction:e,data:{granted_time:Date.now(),granted_by_table:n().oo,granted_by_id:d,resolved_time:Date.now(),resolved_by_table:n().oo,resolved_by_id:d,status:o,type:"space_membership_request"}})}))}}),{failedUsers:[],resolvedUsers:m}}async function x(e){const{environment:t,status:i,requests:o,from:r}=e;l().qQ(t,{status:i,user_count:o.length,from:r,request_type:"guest"});const c=await Promise.all(o.map((async e=>{var o,s,c;const u=await j(t,{id:e.getForActorId(),table:n().oo});if(!u)return{type:"failed",user:void 0};if(!e.isGuestInviteRequest())return{type:"failed",user:u};const g=await d().callApi({eventName:"resolveAccessRequest",environment:t,data:{accessRequestId:e.id,status:i,spaceId:e.getParentId()}}),p=null===(o=e.getAttributes().permission_records_and_roles.at(0))||void 0===o?void 0:o.role,v=null===(s=e.getAttributes().permission_records_and_roles.at(0))||void 0===s?void 0:s.id,h=(null===(c=e.getAttributes().invite_message)||void 0===c?void 0:c.length)??0;return"success"===g.type&&"approved"===i&&a().Jg(t,{role:p,is_space:!1,invite_targets:[{type:"existingUser",value:{id:u.id,version:0,email:u.getEmail()},spaceRole:"none"}],is_onboarding:!1,invite_origin:"guest_invite_request",permission_items:[{type:"user_permission",role:p,user_id:u.id}],invite_message_length:h,domainType:(0,m().FX)()}),"success"===g.type&&l().AE(t,{status:i,request_id:e.id,for_actor_id:e.getForActorId(),created_by_id:e.getCreatedById(),requested_page_id:v,requested_role:p,from:r}),{type:g.type,user:u}})));await f().Ow(t);const u=c.filter((e=>"failed"===e.type)).map((e=>e.user)),g=c.filter((e=>"success"===e.type)).map((e=>e.user));return{failedUsers:(0,s().oE)(u),resolvedUsers:(0,s().oE)(g)}}async function S(e){if(h().A.reset(),!e.canAdmin)return;const{environment:t,spaceId:i}=e,o=await d().callApi({eventName:"getUnreadAccessRequestCount",environment:t,data:{parentTable:r().NX,parentId:i,size:1}});"success"===o.type&&h().A.setState({spaceId:i,count:o.data.count})}async function A(e,t,i){const r=function(e){return Object.values((0,s().$z)(e,(e=>function(e){if(e.isGuestInviteRequest()){const t=e.getAttributes().permission_records_and_roles[0];return`guest_invite_${e.getForActorId()}:${null==t?void 0:t.id}:${e.getCreatedById()}`}return e.isSpaceMembershipRequest()?`space_membership_${e.getForActorId()}:${e.getCreatedById()}}`:e.isTeamMembershipRequest()?void 0:void e.isPageAccessRequest()}(e)))).map((e=>{const t=(0,s().Ul)(e,(e=>e.getCreatedTime()));return t[t.length-1]}))}(await Promise.all(i.map((async t=>{const i=o().O,r=new(v().v3)(e,{table:i,id:t});return await r.load(),r.getModel()}))).then((e=>(0,s().oE)(e)))),a=await function(e,t){const i=Object.values((0,s().$z)(t,(e=>function(e){if(e.isGuestInviteRequest()){const t=e.getAttributes().permission_records_and_roles[0];return`guest_invite_${e.getForActorId()}:${null==t?void 0:t.id}:${null==t?void 0:t.role}`}return e.isSpaceMembershipRequest()?`space_membership_${e.getForActorId()}`:e.isTeamMembershipRequest()?void 0:void e.isPageAccessRequest()}(e))));return Promise.all(i.map((async t=>{const i=(0,s().Ul)(t,(e=>e.getCreatedTime())),o=i[0];return{createdByActorsWithReason:await Promise.all(i.map((async t=>{const i=await j(e,{id:t.created_by_id,table:n().oo});if(i)return{actor:i,reason:t.message}}))).then((e=>(0,s().oE)(e))),accessRequest:o}})))}(e,r);return Promise.all(a.map((async t=>{const i=await j(e,{id:t.accessRequest.getForActorId(),table:n().oo});if(i)return{forActor:i,...t}}))).then((e=>(0,s().oE)(e)))}async function j(e,t){const i=new(v().LU)(e,t);return await i.load(),i.getModel()}},799104:(e,t,i)=>{i.d(t,{Z:()=>G,Y:()=>ne});i(581454);var o=i(296540),r=()=>i(484714),n=()=>i(847249),s=()=>i(401497),a=()=>i(613198),l=()=>i(762433),d=()=>i(959013),c=()=>i(534177),u=()=>i(209660),g=()=>i(84817),m=()=>i(641300),p=()=>i(554509),v=()=>i(204063),h=()=>i(702723),f=()=>i(702796),y=()=>i(384100),b=()=>i(807778),x=()=>i(479314),S=()=>i(714300),A=()=>i(568688);var j=()=>i(911964),_=()=>i(798880),M=()=>i(979340),R=()=>i(509628),w=()=>i(493823),C=()=>i(903706),k=()=>i(7674),I=()=>i(107683),B=()=>i(453697),K=()=>i(475971),T=()=>i(2609),q=()=>i(58293),N=()=>i(870092),P=()=>i(128265),L=i(474848);function D(e){let{feature:t,request:i,userId:o,onDismiss:a}=e;const u=(0,d().tz)(),g=(0,q().r)(),m=(0,r().v3)(),h=(0,S().l)({spaceId:null==g?void 0:g.id}),f=(0,s().IS)((e=>({fullWidth:{width:"100%",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},cancelButton:{...K().W,height:32,color:e.text.secondary},input:{color:e.text.primary}})),[]),{userStore:y,userDisplayName:b}=(0,n().K8)((()=>{if(!g||!o)return{userStore:void 0,userDisplayName:void 0};const e=N().L.createChildStore(g,{table:_().oo,id:o});return{userStore:e,userDisplayName:e.getDisplayName(u)}}),[g,o,u]),{entrypoint:x}=i,A=(0,n().K8)((()=>{switch(x){case"ai_connectors_request_modal":return u.formatMessage(z.subtitleAiConnectorsModal);case"ai_for_work_announcement_modal":return u.formatMessage(z.subtitleAiForWorkModal);case"plans":case"settings":case"charts":case"ai_chat":case"teamspace_menu":case"ai_corner_chat":case"version_history":case"ai_limit_nudge_sidebar":return u.formatMessage(z.subtitlePlans);default:(0,c().HB)(x)}}),[u,x]),D=(0,n().K8)((()=>l().N8(null==h?void 0:h.subscription)),[h]),U=(0,P().n)(),W=ne(i.request,D,U);return W?(0,L.jsx)(I().s,{ariaLabel:u.formatMessage(z.ariaLabel),isOpen:!0,onDismiss:a,showCloseIcon:!0,areaConstraint:{width:{type:"fixed",length:400},height:{type:"unlimited",scroll:"allow"}},render:()=>(0,L.jsx)(k().tf,{showDismissButton:!1,header:(0,L.jsx)(T().rQ,{icon:(0,L.jsx)(B().A,{userStore:y,size:40}),title:u.formatMessage(z.title,{feature:M().v0[t].defaultMessage,user:b}),byline:A}),footer:(0,L.jsx)(R().Y,{gap:16,children:(0,L.jsxs)(R().Y,{gap:8,children:[(0,L.jsx)(v().A,{"aria-label":u.formatMessage(W),onClick:async()=>{await(0,j().F)({environment:m,spaceStore:g,billingData:h,product:i.request,from:"upgrade_requests_page"}),a()},style:{height:32},children:u.formatMessage(W)}),(0,L.jsx)("div",{style:{textAlign:"center"},children:(0,L.jsx)(p().D,{styleName:"Caption-12px/Regular",colorName:"secondary",children:u.formatMessage(z.billingNotice)})}),(0,L.jsx)(w().p,{size:"lg",onClick:a,style:{...f.fullWidth,...f.cancelButton},"aria-label":u.formatMessage(z.cancelButton),children:u.formatMessage(z.cancelButton)})]})}),children:(0,L.jsxs)(R().Y,{gap:8,children:[(0,L.jsx)(p().D,{styleName:"Caption-12px/Medium",colorName:"secondary",children:u.formatMessage(z.noteLabel)}),(0,L.jsxs)(R().Y,{style:{position:"relative"},gap:8,children:[(0,L.jsx)(C().A,{disabled:!0,format:C().C.Large,value:i.reason_for_request,inputStyle:{...f.input,paddingBottom:24},textarea:!0,autosize:!0}),(0,L.jsx)(p().D,{styleName:"Caption-12px/Regular",colorName:"secondary",style:{position:"absolute",bottom:8,left:8},children:u.formatDate(i.created_time,{year:"numeric",month:"long",day:"numeric"})})]})]})})}):null}const z=(0,d().YK)({cancelButton:{id:"viewUpgradeRequestModal.cancelButton",defaultMessage:"Cancel"},billingNotice:{id:"viewUpgradeRequestModal.billingNotice",defaultMessage:"You’ll be able to confirm the updated bill on the next step"},subtitlePlans:{id:"viewUpgradeRequestModal.subtitlePlans",defaultMessage:"This request was made from the Plans page"},subtitleAiConnectorsModal:{id:"viewUpgradeRequestModal.subtitleAiConnectorsModal",defaultMessage:"This request was made from AI Connector onboarding."},subtitleAiForWorkModal:{id:"viewUpgradeRequestModal.subtitleAiForWorkModal",defaultMessage:"This request was made from the AI for Work announcement."},title:{id:"viewUpgradeRequestModal.title",defaultMessage:"{user} would like access to Notion {feature}"},ariaLabel:{id:"viewUpgradeRequestModal.modal.ariaLabel",defaultMessage:"View plan request modal"},noteLabel:{id:"viewUpgradeRequestModal.noteLabel",defaultMessage:"Note"}});var U=()=>i(864943);function W(e){let{title:t,loadedIconFunction:i,buttonAction:o,buttonText:r,buttonAriaLabel:a}=e;const l=(0,s().IS)((e=>({icon:{height:48,width:48,fill:e.icon.tertiary}})),[]),d=(0,n().K8)((()=>i(l.icon)),[l.icon,i]);return(0,L.jsxs)(g().Y1,{gap:16,align:"center",direction:"vertical",padding:"32px 0 88px 0",height:"fill",children:[(0,L.jsx)("div",{children:d}),(0,L.jsx)(p().D,{customStyles:{textAlign:"center"},styleName:"UIRegular-14px/Regular",colorName:"secondary",children:t}),(0,L.jsx)(U().A,{size:"lg",onClick:o,ariaLabel:a,children:(0,L.jsx)(p().D,{customStyles:{textAlign:"center"},styleName:"UIRegular-14px/Medium",children:r})})]})}var O=()=>i(383716),E=()=>i(209969),F=()=>i(179030),V=()=>i(640653);function H(){const e=(0,d().tz)(),t=(0,s().IS)((e=>({checkmarkCircleIcon:{fill:e.icon.uiBluePrimary}})),[]),i=(0,q().r)(),o=(0,n().K8)((()=>i&&(0,V()._s)(i)),[i]);if(null==o||!o.variant)return null;let r;return"ai_requests_resolved"===o.variant?r=$.aiRequestsResolved:"ai_requests_migrated_to_business"===o.variant?r=$.aiRequestsMigratedToBusiness:(0,c().HB)(o.variant),(0,L.jsx)(F().l,{label:e.formatMessage($.aiNowApartOfBusiness),display:"inline",description:e.formatMessage(r),tint:"blue",staticIcon:(0,E().checkmarkCircleFillIcon)(t.checkmarkCircleIcon)})}const $=(0,d().YK)({aiNowApartOfBusiness:{id:"RequestsSettingsPage.UpgradesPage.banner.aiNowApartOfBusiness",defaultMessage:"Unlimited use of Notion AI is now a part of the Business plan"},aiRequestsResolved:{id:"RequestsSettingsPage.UpgradesPage.banner.aiRequestsResolved",defaultMessage:"We’ve resolved all pending Notion AI add-on requests in your workspace"},aiRequestsMigratedToBusiness:{id:"RequestsSettingsPage.UpgradesPage.banner.aiRequestsMigratedToBusiness",defaultMessage:"Pending AI add-on requests have been moved to the Business plan request table"}});function G(e){let{spaceStore:t}=e;const i=(0,d().tz)(),{setPage:r,isSalesEligible:s}=(0,o.useContext)(x().K),{requests:l,isLoading:m}=(0,A().I)({spaceId:t.id}),p=(0,n().K8)((()=>(0,b().Y3)()),[]);if(m)return null;const v=Object.keys(l).length,h=1===v,f=0===v;return(0,L.jsxs)(g().Y1,{height:"fill",direction:"vertical",gap:32,padding:"36px 60px",children:[(0,L.jsx)(O().n,{title:i.formatMessage(se.title),goBack:()=>r("home")}),p&&(0,L.jsx)(H,{}),f?(0,L.jsx)(W,{title:i.formatMessage(se.noRequestsTitle),buttonAriaLabel:"explore plans",buttonText:i.formatMessage(se.noRequestsButtonTitle),buttonAction:()=>{u().Ow({currentTab:"plans"})},loadedIconFunction:a().Q}):(0,c().WP)(l).map((e=>{let[i,o]=e;return o?(0,L.jsx)(Y,{expandByDefault:!0,hasOneRequestType:h,requestType:i,requests:o,spaceStore:t,isSalesEligible:s},i):null}))]})}function Y(e){let{expandByDefault:t=!1,requestType:i,requests:n,spaceStore:s,isSalesEligible:a,hasOneRequestType:c}=e;const u=(0,r().v3)(),g=(0,S().l)({spaceId:s.id}),[m,p]=o.useState(t),f=(0,d().tz)(),y=l().N8(null==g?void 0:g.subscription),b=ne(i,y,a);return(0,L.jsxs)("div",{children:[(0,L.jsx)(h().A,{title:(0,L.jsx)(Q,{requestType:i,requestCount:n.length,isExpanded:m,handleClick:()=>{p(!m)},shouldHideToggle:c}),type:"custom",isMobile:!1,disableSettingsItemClick:!0,customButton:b&&(0,L.jsx)(v().A,{onClick:async()=>{await(0,j().F)({environment:u,spaceStore:s,billingData:g,product:i,from:"upgrade_requests_page"})},children:f.formatMessage(b)})}),m&&(0,L.jsx)(re,{spaceStore:s,requests:n})]})}function Q(e){let{handleClick:t,isExpanded:i,requestType:o,requestCount:r,shouldHideToggle:n}=e;const a=(0,d().tz)(),l=function(e){switch(e){case"ai":return se.ai;case"business":return se.business;case"enterprise":return se.enterprise;default:return null}}(o),c=(0,s().IS)((e=>({toggleButton:{color:e.icon.primary}})),[]);return(0,L.jsxs)(g().Y1,{direction:"horizontal",gap:6,align:"center-left",children:[!n&&(0,L.jsx)(f().A,{isSidebar:!1,fill:!0,onClick:()=>{t()},open:i,color:c.toggleButton.color}),l&&(0,L.jsx)(p().D,{styleName:"UIRegular-14px/Medium",colorName:"primary",children:a.formatMessage(l)}),(0,L.jsx)(p().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:r})]})}const X={id:"note",headerTitle:(0,L.jsx)(d().sA,{id:"RequestsSettingsPage.UpgradesPage.noteColumn",defaultMessage:"Note"}),renderCell:e=>{let{value:t}=e;return(0,L.jsx)(J,{value:t})},sortable:!1,widthData:{minWidth:150,maxWidth:310,widthPercent:37}};function J(e){const t=e.value.reason_for_request??"—",i=(0,s().IS)((e=>({container:{width:"100%"},textWithEllipsis:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})),[]);return(0,L.jsx)("div",{style:i.container,children:(0,L.jsx)(p().D,{style:i.textWithEllipsis,styleName:"UIRegular-14px/Regular",children:t})})}function Z(e){let{value:t,isRowHovered:r}=e;const n=(0,d().tz)(),[a,l]=o.useState(!1),[c,u]=o.useState(null),m=(0,s().IS)((e=>({icon:{height:14,width:14,color:e.icon.secondary}})),[]),p=n.formatMessage({id:"RequestsSettingsPage.UpgradesPage.viewDetail",defaultMessage:"View Detail"});return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(g().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",children:r&&(0,L.jsx)(i(859428).A,{placement:i(962730).W.Top,renderTooltip:()=>p,render:e=>(0,L.jsx)(i(285790).A,{ariaLabel:p,hasBackground:!0,icon:i(576250).y,showShadow:!0,iconStyle:m.icon,onClick:e=>{u(t),l(!0),e.stopPropagation()},...e})})}),a&&c&&(0,L.jsx)(D,{feature:c.request,request:c,userId:c.created_by_id,onDismiss:()=>l(!1)})]})}const ee={id:"date",headerTitle:(0,L.jsx)(d().sA,{id:"RequestsSettingsPage.UpgradesPage.dateColumn",defaultMessage:"Date"}),renderCell:e=>{let{value:t}=e;return(0,L.jsx)(i(625383).d,{dateTs:t.created_time})},sortable:!1,widthData:{minWidth:150,maxWidth:240,widthPercent:24}},te={id:"dateWithViewDetail",headerTitle:"",renderCell:e=>{let{value:t,isRowHovered:i}=e;return(0,L.jsx)(Z,{value:t,isRowHovered:i})},sortable:!1,widthData:{minWidth:100,maxWidth:100,widthPercent:6}},ie=[{id:"requestedBy",headerTitle:(0,L.jsx)(d().sA,{id:"RequestsSettingsPage.UpgradesPage.requestedByColumn",defaultMessage:"Requested By"}),renderCell:e=>{let{userStore:t}=e;return(0,L.jsx)(i(317131).l,{customAvatarStyles:{marginRight:8},userStores:[t]})},sortable:!1,widthData:{minWidth:150,maxWidth:240,widthPercent:30}},X,ee,te],oe=8;function re(e){let{requests:t,spaceStore:i}=e;const[r,n]=o.useState(!1),[a,l]=o.useState(null),{header:d}=(0,s().IS)((e=>({header:{boxShadow:`inset 0 -1px 0 ${e.tableDividerColor}`}})),[]),c=ie.map((e=>({...e,headerStyle:d}))),u=(0,s().IS)((e=>{const t=(0,m().rC)({columnRenderInfo:c,theme:e,containerMarginTop:8});return{...t,container:{...t.container,width:"100%"}}}),[c]),g=t.map((e=>({value:e,userStore:(0,y().z)({userId:e.created_by_id,currentSpaceStore:i}),id:e.id,isClickable:!0}))),{pageRows:p,loadMoreMethod:v}=function(e){let{rows:t,limit:i}=e;const[r,n]=(0,o.useState)(i),[s,a]=(0,o.useState)(0),l=t.length,d=l>i;return{pageRows:(0,o.useMemo)((()=>d?t.slice(s,r):t),[t,s,r,d]),loadMoreMethod:(0,o.useMemo)((()=>{if(d)return{type:"pages",onLoadNext:()=>{if(r>=l)return;const e=Math.min(r+i,l);n(e),a(s+i)},onLoadPrevious:()=>{0!==s&&(n(s),a(s-i))},hasNextPage:r<l,hasPrevPage:s>0,currentPage:Math.floor(s/i)+1,finalPage:Math.floor(l/i)+1}}),[l,s,r,i,d])}}({rows:g,limit:oe});return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(m().WE,{columnRenderInfo:c,rows:p,hideHeaderRowPadding:!0,renderNoRowsComponent:()=>null,styles:u,loadMoreMethod:v,onRowClick:e=>{l(e.value),n(!0)},showRowBorders:!0}),r&&a&&(0,L.jsx)(D,{feature:a.request,request:a,userId:a.created_by_id,onDismiss:()=>n(!1)})]})}function ne(e,t,i){if(t||i&&"enterprise"===e)return se.contactSales;switch(e){case"ai":return se.aiUpgrade;case"business":case"enterprise":return se.planUpgrade;default:return null}}const se=(0,d().YK)({title:{id:"RequestsSettingPage.UpgradePage.title",defaultMessage:"Upgrades"},aiUpgrade:{id:"RequestsSettingsPage.UpgradesPage.aiUpgrade",defaultMessage:"Upgrade AI"},planUpgrade:{id:"RequestsSettingsPage.UpgradesPage.planUpgrade",defaultMessage:"Upgrade Plan"},contactSales:{id:"RequestsSettingsPage.UpgradesPage.contactSales",defaultMessage:"Contact Sales"},ai:{id:"RequestsSettingsPage.UpgradesPage.notionAI",defaultMessage:"Notion AI"},business:{id:"RequestsSettingsPage.UpgradesPage.business",defaultMessage:"Business"},enterprise:{id:"RequestsSettingsPage.UpgradesPage.enterprise",defaultMessage:"Enterprise"},noRequestsTitle:{id:"RequestsSettingsPage.UpgradesPage.NoPendingRequestsTitle",defaultMessage:"No upgrade requests in your workspace"},noRequestsButtonTitle:{id:"RequestsSettingsPage.UpgradesPage.NoPendingRequestsButtonTitle",defaultMessage:"Explore plans"}})},958846:(e,t,i)=>{i.d(t,{A:()=>r});i(296540);var o=i(474848);const r=function(e){let{loading:t,onLoadMore:r,loadMoreOffsetThreshold:n,resultSize:s,fetchSize:a}=e;return(0,o.jsx)(i(228927).A,{onChange:e=>function(e,t,i,o,r,n){if(t)return;const s=o||200;if(e>s)return;const a=void 0===r||void 0===n||r>=n;a&&i()}(e,t,r,n,s,a)})}}}]);