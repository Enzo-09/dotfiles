"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[22462,77970,87196],{847:(e,t,o)=>{o.r(t),o.d(t,{addModule:()=>$,addStepsToExistingThreadAndRun:()=>W,addTranscriptToNewThreadAndRun:()=>z,addTranscriptToNewThreadOnClientAndRun:()=>Z,addUnsavedOperations:()=>L,appendWorkflowSetupUpdate:()=>B,createAppAndRunFromStep:()=>de,createEmptyWorkflowContainerAndBuild:()=>ee,createWorkflowForCollectionViewBlock:()=>te,createWorkflowFromWorkflowStep:()=>Y,createWorkflowUpdate:()=>F,overrideWorkflowData:()=>ne,removeModule:()=>X,requestEditWorkflowFunction:()=>pe,restoreToWorkflowStep:()=>re,runWorkflowFunction:()=>le,saveConfigVariable:()=>q,saveFunction:()=>J,saveModule:()=>Q,saveTest:()=>H,saveTrigger:()=>G,saveTriggers:()=>K,saveWorkflowStep:()=>ae,updateDatabasesAndViews:()=>ce,updateWorkflowStep:()=>se});o(16280),o(944114),o(898992),o(354520),o(672577),o(581454),o(737550);var a=()=>o(943387),n=()=>o(386164),r=()=>o(179034),i=()=>o(96689),s=()=>o(234459),c=()=>o(155792),d=()=>o(798880),l=()=>o(743246),p=()=>o(758256),u=()=>o(919709),f=()=>o(725649),m=()=>o(550622),g=()=>o(142918),b=()=>o(532659),v=()=>o(498212),I=()=>o(534177),w=()=>o(449506),S=()=>o(896628),y=()=>o(246826),h=()=>o(185544),_=()=>o(319975),T=()=>o(751156),k=()=>o(182865),C=()=>o(555102),R=()=>o(166442),A=()=>o(186445),P=()=>o(594794),M=()=>o(351360),D=()=>o(630116),N=()=>o(253141),O=()=>o(205605),U=()=>o(46986),x=()=>o(758417),E=()=>o(392012),V=()=>o(691093);function F(e){const{environment:t,workflowStore:o,threadStore:a,operations:r,transaction:i}=e;if(0===r.length)return;const{currentUserStore:s,currentSpaceStore:c}=M().default.state;if(!s)throw new Error("No current user");const d=M().default.state.currentSpaceViewStore;if(!d)throw new Error("No current space view");if(!c)throw new Error("No current space");const l=o.getParentStore();if(!l||!l.isCollectionView())throw new Error("No workflow collection block parent");const p=[(0,x().dy)({operations:r})];if(a)(0,k().Vn)({threadStore:a,environment:t,spaceStore:c,userStore:s,addSteps:p,transaction:i});else{const e=(0,x().Y$)({environment:t,spaceStore:c,userStore:s,spaceViewStore:d,workflowStore:o,addSteps:p,store:l}),a=(0,k().aP)({environment:t,spaceStore:c,userStore:s,transaction:i,transcript:e,workflowStore:o});!async function(e){const{environment:t,threadStore:o,spaceId:a}=e;if(o.getDataStore().getKeyStore("title").getValue())return;const r=(null==o?void 0:o.getMessageStores())??[],i=r.map((e=>e.getStep())).filter(I().O9)??[],s={traceId:(0,v().lZ)(),spaceId:a,transcript:i,generateTitle:!0},c=await w().callStreamApi({eventName:"runInferenceTranscript",environment:t,data:s,headers:(0,n().WS)({spaceId:s.spaceId})});if("failed"===c.type)throw c.error;if(b().hS.is(c.data))for await(const n of c.data)"title"===n.type&&T().createAndCommit({userAction:"WorkflowActions.generateWorkflowTitle",environment:t,canUndo:!0,perform:e=>{y().zv({store:o.getDataStore(),data:{title:n.value},transaction:e})}})}({environment:t,threadStore:a,spaceId:c.id}),(0,V().showWorkflowEditor)({environment:t,chatSidebarState:{threadId:a.id},parentStore:l})}}function B(e){const{environment:t,threadStore:o,workflowOperations:n,operations:r,transaction:i}=e,s=M().default.state.currentUserStore;if(!s)throw new Error("No current user");const c=M().default.state.currentSpaceStore;if(!c)throw new Error("No current space");(0,k().Vn)({threadStore:o,environment:t,spaceStore:c,userStore:s,addSteps:[{id:(0,v().lZ)(),type:"workflow-operation",workflowOperations:n??[],threadOperations:(0,a().eB)({operations:r})}],transaction:i})}function z(e){const{environment:t,spaceStore:o,clientStore:a,transcript:n,threadId:r,workflowStore:c}=e,d=r??(0,P().Z1)({environment:t,table:s().To,spaceId:o.id});return(0,k().WE)({environment:t,clientStore:a,threadStore:void 0,createThreadArgs:{id:d,transcript:n,workflowBlockId:null==c?void 0:c.getParentId(),parentPointer:{table:i().NX,id:o.id,spaceId:o.id}}}),D().Ei.createChildStore(o,{id:d,spaceId:o.id,table:s().To})}function Z(e){const{environment:t,spaceStore:o,clientStore:a,userStore:n,transcript:r,threadId:i,workflowStore:s,analyticsArgs:c}=e,{serverCommitResult:d,performResult:l}=T().createAndCommit({userAction:"WorkflowActions.addTranscriptToNewThreadAndRun",environment:t,canUndo:!0,perform:e=>(0,k().aP)({environment:t,spaceStore:o,userStore:n,transaction:e,transcript:r,threadId:i,workflowStore:s})});return(0,k().WE)({environment:t,clientStore:a,threadStore:l,waitBeforeSending:d,analyticsArgs:c}),l}function W(e){const{environment:t,userStore:o,spaceStore:a,threadStore:n,addSteps:r,clientStore:i,waitForServerCommit:s}=e,{serverCommitResult:c}=T().createAndCommit({userAction:"WorkflowActions.addStepsToExistingThreadAndRun",environment:t,canUndo:!0,perform:e=>{(0,k().Vn)({threadStore:n,environment:t,spaceStore:a,userStore:o,addSteps:r,transaction:e})}});(0,k().WE)({environment:t,clientStore:i,threadStore:n,waitBeforeSending:s?c:void 0})}function Q(e){const{environment:t,module:o,threadStore:a,workflowStore:n}=e;T().createAndCommit({userAction:"WorkflowActions.saveModule",environment:e.environment,canUndo:!0,perform:e=>{F({environment:t,threadStore:a,transaction:e,operations:[g().xb({pointer:n.pointer,module:o})],workflowStore:n})}})}function j(e){const{collectionViewBlockStore:t,collectionPointer:o,threadStore:a}=e,{workflowValue:n,workflowPointer:r}=function(e){const{collectionViewBlockStore:t,threadStore:o}=e;if(o){const e=(0,m().rE)({transcript:o.getTranscript(),appId:t.id,spaceId:t.getSpaceId()});if(e)return{workflowValue:e.workflow,workflowPointer:e.workflowModel.pointer}}const a=t.getWorkflowStore();if(!a)throw new Error("No workflow store");return{workflowValue:a.getData(),workflowPointer:a.pointer}}({collectionViewBlockStore:t,threadStore:a});if((n?(0,O().VX)(n):[]).find((e=>{var t;return(null===(t=(0,f().DK)(e.state))||void 0===t||null===(t=t.pointer)||void 0===t?void 0:t.id)===o.id})))return;const i=D().md.createChildStore(t,o),s=(0,O().PP)({collectionStore:i});return g().xb({pointer:r,module:s})}function L(e){const{operations:t,threadStore:o,collectionViewBlockStore:a,...n}=e,r=[];for(const i of t)if(g().QA(i)){const e=i.args.collection_pointers.map((e=>j({collectionViewBlockStore:a,collectionPointer:e,threadStore:o}))).filter(I().O9);r.push(...e)}else g().kK(i)&&r.push(i);T().createAndCommit({userAction:"WorkflowActions.addUnsavedOperations",environment:e.environment,canUndo:!0,perform:e=>{F({...n,threadStore:o,operations:r,transaction:e})}})}function q(e){const{value:t,...o}=e;T().createAndCommit({userAction:"WorkflowActions.saveConfigVariable",environment:e.environment,canUndo:!0,perform:e=>{F({...o,operations:[g().bE({pointer:o.workflowStore.pointer,configVariable:t})],transaction:e})}})}function $(e){const{module:t,...o}=e;T().createAndCommit({userAction:"WorkflowActions.addModule",environment:e.environment,canUndo:!0,perform:e=>{F({...o,operations:[g().xb({pointer:o.workflowStore.pointer,module:t})],transaction:e})}})}function K(e){const{triggers:t,...o}=e;T().createAndCommit({userAction:"WorkflowActions.saveTriggers",environment:e.environment,canUndo:!0,perform:e=>{F({...o,operations:[g().IA({pointer:o.workflowStore.pointer,triggers:t})],transaction:e})}})}function G(e){const{trigger:t,...o}=e;T().createAndCommit({userAction:"WorkflowActions.saveTrigger",environment:e.environment,canUndo:!0,perform:e=>{F({...o,operations:[g().NW({pointer:o.workflowStore.pointer,trigger:t})],transaction:e})}})}function J(e){const{functionStore:t,fn:o,...a}=e,{environment:n}=a;T().createAndCommit({userAction:"WorkflowActions.saveFunction",environment:e.environment,canUndo:!0,perform:r=>{const i=t.getParentPointer();if(!i)throw new Error("No parent pointer");if(!i.spaceId)throw new Error("No parent space id");const s=y().vt({environment:e.environment,table:p().U6,args:{id:(0,v().lZ)(),type:"function",parentPointer:i,space_id:i.spaceId,data:o},inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache,transaction:r});F({...a,operations:[g().sr({pointer:a.workflowStore.pointer,functionPointer:s.pointer})],transaction:r})}})}function H(e){const{functionStore:t,test:o,...a}=e;T().createAndCommit({userAction:"WorkflowActions.saveTest",environment:e.environment,canUndo:!0,perform:n=>{const r=t.getParentPointer();if(!r)throw new Error("No parent pointer");if(!r.spaceId)throw new Error("No parent space id");const i=t.getData(),s=[...((null==i?void 0:i.tests)??[]).filter((e=>e.description.name!==o.description.name)),o],c=y().vt({environment:e.environment,table:p().U6,args:{id:(0,v().lZ)(),type:"function",parentPointer:r,space_id:r.spaceId,data:{...i,tests:s}},inMemoryRecordCache:t.inMemoryRecordCache,transaction:n});F({...a,operations:[g().sr({pointer:a.workflowStore.pointer,functionPointer:c.pointer})],transaction:n})}})}function X(e){const{environment:t,module:o,threadStore:a,workflowStore:n}=e;T().createAndCommit({userAction:"WorkflowActions.removeModule",environment:e.environment,canUndo:!0,perform:e=>{F({environment:t,operations:[g().$h({pointer:n.pointer,module:o})],transaction:e,threadStore:a,workflowStore:n})}})}function Y(e){const{environment:t,saveWorkflowStep:o,newWorkflow:a,transaction:n,workflowBlockId:i}=e,{currentSpaceStore:s,currentSpaceViewStore:c}=M().default.state;if(!s||!c)throw new Error("No current space");let d;i?d=D().Bv.createChildStore(s,{table:r().ev,id:i,spaceId:s.id}):(d=y().Wv({environment:t,type:"collection_view_page",transaction:n,inMemoryRecordCache:s.inMemoryRecordCache}),h().yM({environment:t,spaceStore:s,spaceViewStore:c,pageStore:d,isPrivate:!0,location:{type:"append"},transaction:n}));const l=oe({environment:t,transaction:n,store:d,workflowData:a});return ce({environment:t,store:d,previousWorkflow:void 0,workflowStore:l,newWorkflow:a,transaction:n,performPushToDatabases:!0}),ie({step:o,workflowStore:l,environment:t,transaction:n}),{workflowStore:l,parentStore:d}}async function ee(e){const{environment:t,parentStore:o,userStep:a,onThreadChange:n}=e,r=M().default.state.currentSpaceStore;if(!r)throw new Error("No space store");const i=M().default.state.currentSpaceViewStore;if(!i)throw new Error("No current space view");const s=M().default.state.currentUserStore;if(!s)throw new Error("No user store");const{performResult:c,serverCommitResult:d}=T().createAndCommit({userAction:"SetupGenerator.handlePromptSubmit",environment:t,canUndo:!0,perform:e=>function(e){const{environment:t,transaction:o,parentStore:a}=e,{currentSpaceStore:n,currentSpaceViewStore:r}=M().default.state;if(!n||!r)throw new Error("No current space");const i=y().Wv({environment:t,type:"collection_view_page",transaction:o,inMemoryRecordCache:n.inMemoryRecordCache});return(0,N().Ls)({environment:t,parentStore:a??n,collectionViewBlockStore:i,transaction:o,appendOrPrepend:"append",spaceViewStore:r}),{workflowStore:te({environment:t,store:i,transaction:o}),collectionViewBlockStore:i}}({environment:t,transaction:e,parentStore:o})});await d;const{workflowStore:l,collectionViewBlockStore:p}=c,u=(0,x().Y$)({environment:t,spaceStore:r,spaceViewStore:i,userStore:s,workflowStore:l,store:p,addSteps:[a]}),f=z({environment:t,clientStore:R().Kd,spaceStore:r,transcript:u,workflowStore:l});(0,U().aj)()?null==n||n(f):(0,V().showWorkflowEditor)({environment:t,parentStore:p,navigationState:{isOpen:!0,type:"configure"},chatSidebarState:{isOpen:!0,threadId:f.id}})}function te(e){const{environment:t,store:o,transaction:a}=e,n=function(e){const{store:t}=e,o=t.getCollectionPointers()??[],a=o.map((e=>{const o=D().md.createChildStore(t,e);return(0,O().PP)({collectionStore:o})})),n=(0,O().dZ)({store:t,databaseModules:a,databaseViews:[]});return{name:"",modules:a,databaseViews:n}}({store:o});return oe({environment:t,transaction:a,store:o,workflowData:n})}function oe(e){const{environment:t,store:o,transaction:a,workflowData:n}=e,i=y().vt({environment:t,table:l().C0,args:{id:(0,P().Z1)({environment:t,table:l().C0,spaceId:o.getSpaceId()}),data:n,parentPointer:{table:r().ev,id:o.id},space_id:o.getSpaceId()},inMemoryRecordCache:o.inMemoryRecordCache,transaction:a});return S().zA({stores:[o],update:{workflow_id:i.id},transaction:a}),i}function ae(e){const{environment:t,workflowStore:o,transaction:a,previousWorkflow:n,newWorkflow:r,saveWorkflowStep:i,parentStore:s}=e;return y().KY({store:o.getDataStore(),value:r,transaction:a}),ce({environment:t,store:s,workflowStore:o,previousWorkflow:n,newWorkflow:r,transaction:a,performPushToDatabases:!0}),ie({step:i,workflowStore:o,environment:t,transaction:a}),{workflowStore:o,parentStore:s}}function ne(e){const{environment:t,parentStore:o,workflowStore:a,transaction:n,workflow:r}=e;y().KY({store:a.getDataStore(),value:r,transaction:n}),ce({environment:t,store:o,workflowStore:a,previousWorkflow:void 0,newWorkflow:r,transaction:n,performPushToDatabases:!1})}function re(e){const{environment:t,workflowStore:o,transaction:a,newWorkflow:n,liveWorkflow:r,threadStore:i,parentStore:s}=e,{currentSpaceStore:l}=M().default.state;if(!l)throw new Error("No current space");const u=M().default.state.currentUserStore;if(!u)throw new Error("No current user");const f=(0,v().lZ)(),m=t.currentUser.id;if(!m)throw new Error("Current user id not found");const g=y().vt({environment:t,table:p().U6,args:{id:(0,v().lZ)(),type:"version",parentPointer:s.pointer,space_id:l.id,data:{createdAt:Date.now(),savedAt:Date.now(),savedByActorPointer:{table:d().oo,id:m,spaceId:l.id},threadMessagePointer:{table:c().mS,id:f,spaceId:l.id}}},inMemoryRecordCache:l.inMemoryRecordCache,transaction:a}),b=n.versionPointer,I={...n,versionPointer:g.pointer};return y().KY({store:o.getDataStore(),value:I,transaction:a}),ce({environment:t,store:s,workflowStore:o,previousWorkflow:r,newWorkflow:I,transaction:a,performPushToDatabases:!0}),(0,k().Vn)({environment:t,transaction:a,spaceStore:l,threadStore:i,userStore:u,addSteps:[{id:f,type:"workflow",value:I,workflow_block_id:s.id,traceId:(0,v().lZ)(),saved:!0,completed:!0,restoredFromVersionPointer:b}]}),(0,V().showWorkflowEditor)({environment:t,parentStore:s,chatSidebarState:{threadId:i.id}}),{workflowStore:o,parentStore:s}}function ie(e){const{step:t,environment:o,workflowStore:a,transaction:n}=e,r=o.currentUser.id;if(!r)throw new Error("Current user id not found");se({workflowStore:a,step:t,transaction:n,userAction:"accept"});const i=a.getSpaceId();if(!i)throw new Error("Workflow space id not found");const s=t.value.versionPointer;if(s){const e=D().je.createChildStore(a,s);y().zv({store:e.getDataStore(),data:{savedAt:Date.now(),savedByActorPointer:{table:d().oo,id:r,spaceId:i}},transaction:n})}}function se(e){let{workflowStore:t,step:o,transaction:a,userAction:n}=e;const r=t.getSpaceId();if(!r)throw new Error("Workflow space id not found");const i=D().XV.createChildStore(t,{table:c().mS,id:o.id,spaceId:r});if(!i)throw new Error("Thread message store not found");y().zv({store:i.getStepStore(),data:{workflow_block_id:t.getParentId(),value:t.getData(),saved:"accept"===n,userAction:n},transaction:a})}function ce(e){const{environment:t,store:o,workflowStore:a,previousWorkflow:n,newWorkflow:r,transaction:i,performPushToDatabases:s}=e;((null==r?void 0:r.modules)||[]).some((e=>{var t;return"database"===e.type&&!(null!==(t=(0,f().DK)(e.state))&&void 0!==t&&t.pointer)}))&&(0,E().qm)({environment:t,store:o,workflowStore:a,transaction:i}),s&&(0,E().Ug)({workflowStore:a,transaction:i,previousDatabaseModules:(0,O().VX)(n??{})}),(0,E().Z6)({store:o,workflowStore:a,transaction:i,previousDatabaseViews:(0,O().wB)(n??{})}),function(e){const{environment:t,parentBlockStore:o,workflow:a,transaction:n}=e,r=o.getTitleStore();r&&(0,u().w9s)(r.getValue())&&a.name&&_().R9({environment:t,store:r,value:(0,u().x9d)(a.name),transaction:n})}({environment:t,parentBlockStore:o,workflow:r,transaction:i})}function de(e){const{environment:t,threadStore:o,stepIndex:a,transaction:n}=e,{currentSpaceStore:i,currentSpaceViewStore:s}=M().default.state;if(!i||!s)throw new Error("No current space");const c=o.getTranscript(),d=o.getMessageStores(),l=c.findIndex((e=>"config"===e.type)),p=c[l],u=d[l];if(l<0||!u||!p||"config"!==p.type)throw new Error("No config step found");const f=y().Wv({environment:t,type:"collection_view_page",transaction:n,inMemoryRecordCache:i.inMemoryRecordCache});h().yM({environment:t,spaceStore:i,spaceViewStore:s,pageStore:f,isPrivate:!0,transaction:n}),y().zv({store:o,data:{parent_table:r().ev,parent_id:f.id,space_id:f.getSpaceId()},transaction:n});const m={...p,value:{type:"workflow",workflowBlockId:f.id}};y().KY({store:u.getStepStore(),value:m,transaction:n}),(0,V().showWorkflowEditor)({environment:t,parentStore:f,chatSidebarState:{isOpen:!0,threadId:o.id}}),(0,k().hx)({threadStore:o,stepIndex:a,transaction:n})}function le(e){const{environment:t,workflowFunction:o,workflowStore:a,clientStore:n,threadStore:r,functionArgs:i,parentStore:s}=e,c=(0,A()._m)(t);if(!c)throw new Error("Could not find valid user store");const d=M().default.state.currentSpaceViewStore;if(!d)throw new Error("No space view store");const l=M().default.state.currentSpaceStore;if(!l)throw new Error("No space store");const p=(0,C().nD)({environment:t,spaceStore:l,workflowFunction:o,functionArgs:i,from:"run-button"});if(r)W({environment:t,spaceStore:l,userStore:c,threadStore:r,clientStore:n,addSteps:[p]});else{const e=z({environment:t,spaceStore:l,clientStore:n,transcript:(0,x().Y$)({environment:t,spaceStore:l,userStore:c,spaceViewStore:d,workflowStore:a,store:s,addSteps:[p]})});(0,V().showWorkflowEditor)({environment:t,parentStore:s,chatSidebarState:{isOpen:!0,threadId:e.id}})}}function pe(e){const{environment:t,store:o,workflowStore:a,runStore:n,threadStore:r,isError:i,userFeedback:s,clientStore:c}=e,d=M().default.state.currentSpaceStore;if(!d)throw new Error("WorkflowRunFeedbackButton: spaceStore is undefined");const l=M().default.state.currentSpaceViewStore;if(!l)throw new Error("WorkflowRunFeedbackButton: spaceViewStore is undefined");const p=M().default.state.currentUserStore;if(!p)throw new Error("WorkflowRunFeedbackButton: userStore is undefined");if(!i&&!s)return;if(!o||!a)throw new Error("WorkflowRunFeedbackButton: store or workflowStore is undefined");const f=n.getData();if(!f)throw new Error("WorkflowRunFeedbackButton: runData is undefined");const m=(0,x().fw)({environment:t,spaceStore:d,runStore:n}),g=(0,C().XZ)({environment:t,spaceStore:d,functionKey:f.trigger_key,runId:n.id,message:s?(0,u().x9d)(s):void 0});if(r)W({environment:t,spaceStore:d,userStore:p,threadStore:r,clientStore:c,addSteps:[m,g]});else{const e=z({environment:t,spaceStore:d,clientStore:c,transcript:(0,x().Y$)({environment:t,spaceStore:d,userStore:p,workflowStore:a,spaceViewStore:l,store:o,addSteps:[m,g]})});(0,V().showWorkflowEditor)({environment:t,parentStore:o,chatSidebarState:{isOpen:!0,threadId:e.id}})}}},26388:(e,t,o)=>{o.r(t),o.d(t,{DO_NOT_USE_setUserPersonaRoleAndUseCases:()=>ue,checkAndApplyTrial:()=>fe,clearAllOnboardingStates:()=>me,createOrJoinSpace:()=>le,createSpaceAndSetSpaceId:()=>ie,createSpaceAsOwner:()=>se,defaultOnboardingComplete:()=>ge,handleExitOnboarding:()=>ve,handleOnboardingError:()=>Se,handleUserCanNotCreateSpace:()=>Ie,joinSpaceAsGuestOrMember:()=>ce,joinSpaceAsGuestOrMemberWithPerformanceTracking:()=>de,onOnboardingCompletePublicAccess:()=>be,prefillTeamWorkspaceName:()=>we,redirectAfterContextualizedOnboardingComplete:()=>oe,setAndTrackContextualizedOnboardingComplete:()=>ne,setMobileContextualizedOnboardingComplete:()=>ae,setProfileData:()=>re,setUserAndSpaceSurveyData:()=>pe});o(16280),o(898992),o(354520),o(581454),o(296540);var a=()=>o(584262),n=()=>o(857639),r=()=>o(416845),i=()=>o(763884),s=()=>o(243020),c=()=>o(179034),d=()=>o(677338),l=()=>o(959013),p=()=>o(496603),u=()=>o(534177),f=()=>o(382055),m=()=>o(796756),g=()=>o(148024),b=()=>o(449506),v=()=>o(901389),I=()=>o(705540),w=()=>o(433052),S=()=>o(496414),y=()=>o(246826),h=()=>o(857783),_=()=>o(435009),T=()=>o(537941),k=()=>o(426116),C=()=>o(751156),R=()=>o(840153),A=()=>o(755199),P=()=>o(440209),M=()=>o(989423),D=()=>o(898486),N=()=>o(974233),O=()=>o(972435),U=()=>o(640653),x=()=>o(628315),E=()=>o(719431),V=()=>o(1130),F=()=>o(616385),B=()=>o(144114),z=()=>o(607859),Z=()=>o(12145),W=()=>o(406792),Q=()=>o(869562),j=()=>o(351360),L=()=>o(508496),q=()=>o(630116),$=()=>o(807778),K=()=>o(655765),G=()=>o(162342),J=()=>o(151168),H=()=>o(846955),X=()=>o(913454),Y=()=>o(59424),ee=()=>o(235921),te=o(474848);async function oe(e){await(0,F().navigateWithRedirectData)(e),e.environment.device.isMobile&&ae({environment:e.environment,userStore:e.onboardingData.userStore}),ne({environment:e.environment,onboardingState:e.onboardingState,userStore:e.onboardingData.userStore,spaceJoinOrCreate:e.spaceJoinOrCreate,permissionLevel:e.permissionLevel})}function ae(e){const{environment:t,userStore:o}=e;C().createAndCommit({userAction:"contextualizedOnboardingActions.contextualizedOnboardingActions",environment:t,canUndo:!0,perform:e=>{V().PF({userStore:o,transaction:e})}})}function ne(e){const{environment:t,onboardingState:o,userStore:a,spaceJoinOrCreate:n,permissionLevel:r}=e;t.device.isElectron&&I().quickSearchRefresh(),C().createAndCommit({userAction:"contextualizedOnboardingActions.setAndTrackContextualizedOnboardingComplete",environment:t,canUndo:!0,perform:e=>{V().LC({userStore:a,transaction:e})}}),m().IA(t,{...(0,Y().getContextualizedOnboardingAnalyticsData)({onboardingState:o,environment:t}),initial_workspace_type:n,permission_level:r}),g().Kc(t)}async function re(e,t){const{onboardingData:o,profileName:a,profilePhoto:n,password:r,emailOptIn:i}=t;if(!o)return;const s=o.userStore;(0,M().mt)(e,{email_optin_product_updates_and_releases:i,email_optin_newsletters_and_thought_leadership:i,email_optin_user_research_and_surveys:i,email_optin_sales_outreach:i,email_optin_events_and_resources:i,email_optin_product_education_and_how_tos:i,email_optin_notion_for_startups:i}),C().createAndCommit({userAction:"onboardingHelpers.setProfileData",environment:e,canUndo:!0,perform:e=>{const t={...n&&{profile_photo:n}};t.name=a,y().zv({store:s,data:t,transaction:e})}});const c=await E().shouldCreatePassword(e)&&!function(){var e;const{currentUserSettingsStore:t}=j().default.state;return Boolean(t&&t.isReady()&&"email-password"===(null===(e=t.getSettings())||void 0===e?void 0:e.mobile_ads_signup_variant))}();r&&c&&await b().callApi({eventName:"setPassword",environment:e,data:{newPassword:r,sendEmail:!1}})}async function ie(e){var t;let{onboardingState:o,environment:a,createTemplates:n,showLoader:r=!0}=e;if(!o.onboardingData)return;const i=B().sg(o.onboardingData),{spaceStore:s,spaceViewStore:c,inviteLinkCode:d,teamStoreId:l}=await se({onboardingState:o,onboardingData:o.onboardingData,redirectData:i,planType:null===(t=o.planTypeAndSurveyInfo)||void 0===t?void 0:t.planType,environment:a,createTemplates:n,showLoader:r});ee().A.setState({...ee().A.state,spaceId:s.id,spaceViewId:c.id,inviteLinkCode:d,inviteLinkUrl:d?(0,U().X$)(a,s.id,d):void 0,teamStoreId:l})}async function se(e){var t,o,a,n;const{onboardingState:r,onboardingData:i,redirectData:s,planType:c,environment:d,createTemplates:l,showLoader:p=!0}=e,{currentSpaceStore:u,currentSpaceViewStore:f}=j().default.state;if(u&&f&&u.id===r.spaceId)return{spaceStore:u,spaceViewStore:f,teamStoreId:r.teamStoreId};p&&S().m({message:F().messages.creatingWorkspace});const m=O().A.getIntl(),g=i.userStore.getFullName(m),b=W().default.DO_NOT_USE_markLegacy("onboarding.create_space"),v=r.spaceName||B().JR(g||"",m),{spaceViewStore:I,spaceStore:w,inviteLinkCode:y,redirectData:h,teamStoreId:_}=await F().createSpaceWithTemplates({environment:d,isNewUserOnboarding:Boolean(r.isFirstTimeOnboarding),onboardingData:i,userPersona:(null===(t=r.planTypeAndSurveyInfo)||void 0===t||null===(t=t.surveyResponses)||void 0===t?void 0:t.userPersona)||"unfilled",redirectData:s,spaceName:v,spaceIcon:r.spaceIcon||null,planSelection:c,isPrivate:"team"!==c,useCases:(null===(o=r.planTypeAndSurveyInfo)||void 0===o||null===(o=o.surveyResponses)||void 0===o?void 0:o.useCases)||[],categories:(null===(a=r.planTypeAndSurveyInfo)||void 0===a||null===(a=a.surveyResponses)||void 0===a?void 0:a.categories)||[],hasTrialId:!1,selectedWorkflowTemplates:(null==r?void 0:r.selectedWorkflowTemplateIds)||[],collaborativeIntent:null===(n=r.planTypeAndSurveyInfo)||void 0===n?void 0:n.collaborativeIntent,createTemplates:l,source:r.source});return W().default.DO_NOT_USE_measureLegacy(b,{environment:d,data:{flow:r.flowName,onboarding_complete_data:{stage:(0,Y().getStageName)({flowName:r.flowName,stageIndex:r.currentStageIndex,environment:d}),redirect_data:s,is_new_user:!0,permission_level:"member",plan:c}}}),p&&S().V(),{spaceViewStore:I,spaceStore:w,inviteLinkCode:y,newRedirectData:h,teamStoreId:_}}async function ce(e){const{onboardingData:t,redirectData:o,currentUserRootStore:a,currentUserSettingsStore:n,environment:r}=e;if("guest_redirect"===o.type){const{spaceViewStore:e}=await k().DT({environment:r,spaceId:o.spaceId,userRootStore:a,analyticsFrom:"onboarding",userSettingsStore:n,navigate:!1,redirectPageId:o.pageId,isOnboarding:!0});return{spaceViewStore:e}}{const{spaceViewStore:e}=await F().joinTeamSpaceWithTemplates({environment:r,onboardingData:t,redirectData:o,spaceId:ee().A.state.spaceId,isNewUserOnboarding:Boolean(ee().A.state.isFirstTimeOnboarding)});return{spaceViewStore:e}}}async function de(e){const{onboardingState:t,onboardingData:o,redirectData:a,currentUserRootStore:n,currentUserSettingsStore:r,environment:i}=e;S().m({message:F().messages.joiningWorkspace});const s=W().default.DO_NOT_USE_markLegacy("onboarding.join_space"),{spaceViewStore:c}=await ce({onboardingData:o,redirectData:a,currentUserRootStore:n,currentUserSettingsStore:r,environment:i});return W().default.DO_NOT_USE_measureLegacy(s,{environment:i,data:{flow:t.flowName,onboarding_complete_data:{stage:(0,Y().getStageName)({flowName:t.flowName,stageIndex:t.currentStageIndex,environment:i}),redirect_data:a,is_new_user:!0,permission_level:B().S1(a)}}}),S().V(),{spaceViewStore:c}}async function le(e){const{spaceJoinOrCreate:t,onboardingState:o,onboardingData:a,currentUserRootStore:n,currentUserSettingsStore:r,planType:i,environment:s}=e,c=B().sg(a);if("create"===t){const{spaceStore:e,spaceViewStore:t,newRedirectData:n,teamStoreId:r}=await se({onboardingState:o,onboardingData:a,redirectData:c,planType:i,environment:s});return{spaceStore:e,spaceViewStore:t,newRedirectData:n,teamStoreId:r}}if("join"===t){const{spaceViewStore:e}=await de({onboardingState:o,onboardingData:a,redirectData:c,currentUserRootStore:n,currentUserSettingsStore:r,environment:s});return{spaceViewStore:e}}(0,u().HB)(t)}function pe(e){var t,o,a;const{environment:n,onboardingState:r,planSelection:i,spaceStore:s,spaceViewStore:c}=e,d=null===(t=r.planTypeAndSurveyInfo)||void 0===t?void 0:t.surveyResponses,l=null!=d&&d.educationRole&&"other"!==(null==d?void 0:d.educationRole)?d.educationRole:void 0;B().BH({environment:n,state:{onboardingExperiments:void 0,userPersona:null==d?void 0:d.userPersona,userRole:null==d?void 0:d.userRole,categories:null==d?void 0:d.categories,userEducationRole:l,userEducationLevel:null==d?void 0:d.educationLevel,notionUseFrequency:null==d?void 0:d.notionUseFrequency,companySize:null==d?void 0:d.companySize,useCases:p().sb([...(null==d?void 0:d.useCases)??[],...(null===(o=r.selectedWorkflowTemplateIds)||void 0===o?void 0:o.map((e=>{const t=(0,X().getCollectionTemplateFromId)(e);return null!=t&&t.category?X().useCaseByCollectionTemplateCategory[null==t?void 0:t.category]:void 0})).filter((e=>void 0!==e)))??[]]),planSelection:i,collaborativeIntent:null===(a=r.planTypeAndSurveyInfo)||void 0===a?void 0:a.collaborativeIntent},spaceStore:s,spaceViewStore:c})}function ue(e,t){var o,a,n,r;const{onboardingData:i}=t;if(!i)return;const s=null===(o=t.planTypeAndSurveyInfo)||void 0===o||null===(o=o.surveyResponses)||void 0===o?void 0:o.userPersona,c=null===(a=t.planTypeAndSurveyInfo)||void 0===a||null===(a=a.surveyResponses)||void 0===a?void 0:a.userRole,d=null===(n=t.planTypeAndSurveyInfo)||void 0===n||null===(n=n.surveyResponses)||void 0===n?void 0:n.useCases,l=null===(r=t.planTypeAndSurveyInfo)||void 0===r||null===(r=r.surveyResponses)||void 0===r?void 0:r.companySize;C().createAndCommit({userAction:"contextualizedOnboardingStateActions.DO_NOT_USE_setUserPersonaRoleAndUseCases",environment:e,canUndo:!0,perform:e=>{A().mJ({userSettingsStore:i.userSettingsStore,data:{persona:s,team_role:c,use_cases:d,company_size:l,persona_version:{version:"V4",timestamp:(new Date).getTime()}},transaction:e})}})}async function fe(e,t,o){if((0,J().Os)()&&e&&t){const a=await F().applyPerfmarkTrial(e.id,t,o);a.enableTrialInfoModal&&(0,G().fR)({openedFrom:"onboarding"}),a.enableTrialIneligibleToast&&Z().A.setState({open:!0,isExistingUser:!1})}else if(e&&t&&"team"===t&&(0,$().i4)(o)){await(0,K().applyReversePlusTrial)(e.id,o,"onboarding")&&(0,x().UW)(o,"onboarding_reverse_trial_sidebar")}}function me(e){const{currentUserRootStore:t}=j().default.state;t&&(i().K.set({userId:t.id,key:ee().l,value:void 0}),ee().A.reset(),z().default.setState({isOnboarding:!1,isLoading:!1,currentUserId:e.currentUser.id}),(0,d().$A)())}async function ge(e,t){var o;const{currentUserRootStore:a,currentUserSettingsStore:n}=j().default.state;if(!a)return;const r=ee().A.state;if(!r.onboardingData)throw new Error("onboardingData should not be undefined!");const i=(0,Y().getSpaceIntentOverride)(r)??(null===(o=r.planTypeAndSurveyInfo)||void 0===o?void 0:o.planType),{spaceStore:s,spaceViewStore:c,newRedirectData:d,teamStoreId:l}=await le({spaceJoinOrCreate:t,onboardingState:r,onboardingData:r.onboardingData,currentUserRootStore:a,currentUserSettingsStore:n,planType:i,environment:e}),p=B().sg(r.onboardingData);S().m({message:F().messages.navigatingToWorkspace}),"create"===t&&(await fe(s,i,e),!(0,Y().getOnboardingFlowCreatedSpaceWithoutPlanType)(r.flowName)&&L().default.checkGate({gateName:"enable_write_survey_data_optimization"})||(pe({environment:e,onboardingState:r,planSelection:i,spaceStore:s,spaceViewStore:c}),ue(e,r)),(0,Y().getOnboardingFlowCreatedSpaceWithoutPlanType)(r.flowName)&&k().If(e,"team"===i?"team":"personal",s)),function(e){var t,o;let{environment:a,onboardingState:n,spaceStore:r,planType:i,teamStoreId:s}=e;const c=n.planTypeAndSurveyInfo,d=n.selectedWorkflowTemplateIds,l=Boolean((null==c||null===(t=c.surveyResponses)||void 0===t?void 0:t.useCases)&&(null==c||null===(o=c.surveyResponses)||void 0===o||null===(o=o.useCases)||void 0===o?void 0:o.length)>0),p=Boolean(d&&d.length>0),u=l||p;if("team"===i&&s&&u&&(0,Y().isWorkflowTemplatesEnabledForOnboarding)(a))Q().setExpand({environment:a,isExpanded:!0,from:"contextualized_onboarding_overlay",saveDetailsSidebarPreference:!1}),H().default.setState({type:"team_workflow_templates",step:"teamspaces",initialTeamStoreId:s});else if((0,P().Mq)({environment:a,experimentId:"adoption_hide_features_v2"})){const e=L().default.getEligibleGroup({experimentId:"adoption_hide_features_v2"});"hide_all_except_templates"===e?H().default.setState({type:"adoption_push_templates",step:"explore_templates"}):"hide_all_except_home"===e?H().default.setState({type:"adoption_push_home",step:"home"}):"hide_all_except_ai"===e?H().default.setState({type:"adoption_push_ai",step:"ai_assistant"}):"hide_all_except_invite"===e&&H().default.setState({type:"adoption_push_invite",step:"invite_members"})}}({environment:e,onboardingState:r,spaceStore:s,planType:i,teamStoreId:l});const u=d??p;await oe({environment:e,onboardingData:r.onboardingData,spaceId:c.getSpaceId(),spaceViewId:c.id,spaceJoinOrCreate:t,redirectData:u,onboardingFlow:r.flowName,onboardingState:r,permissionLevel:B().S1(u)}),S().V()}function be(e,t,o){if(!e.onboardingData)throw new Error("onboardingData not found!");ne({onboardingState:e,environment:o,userStore:e.onboardingData.userStore,spaceJoinOrCreate:void 0,permissionLevel:"public"}),h().uK({environment:o,store:new(q().Bv)(o,{table:c().ev,id:t.pageId}),pageVisitSource:a().y8.Onboarding})}async function ve(e,t){if(e.isFirstTimeOnboarding){const{accept:o}=await v().Gh({message:(0,te.jsxs)("div",{style:{display:"block"},children:[(0,te.jsx)("div",{style:{fontWeight:600},children:(0,te.jsx)(l().sA,{defaultMessage:"Cancel new account setup?",id:"contextualizedOnboardingActions.closeOnboardingDialog.newUser.title"})}),(0,te.jsx)("div",{children:(0,te.jsx)(l().sA,{defaultMessage:"You'll be taken back to the Notion home page.",id:"contextualizedOnboardingActions.closeOnboardingDialog.newUser.subtitle"})})]}),acceptLabel:(0,te.jsx)(l().sA,{defaultMessage:"Return to home page",id:"contextualizedOnboardingActions.closeOnboardingDialog.newUser.confirmCloseButton.label"}),cancelLabel:(0,te.jsx)(l().sA,{defaultMessage:"Continue setup",id:"contextualizedOnboardingActions.closeOnboardingDialog.newUser.continueButton.label"})});if(!o)return;m().rG(t,(0,Y().getContextualizedOnboardingAnalyticsData)({onboardingState:e,environment:t})),await E().actuallyLogoutAndDeleteMostLocalData({environment:t,logoutOrigin:s().d.ContextualizedOnboardingExit,userId:t.currentUser.id})}else{const{accept:a}=await v().Gh({message:(0,te.jsx)(l().sA,{defaultMessage:"Cancel new workspace setup?",id:"onboardingActions.closeOnboardingDialog.existingUser.title"}),description:(0,te.jsx)(l().sA,{defaultMessage:"You'll be taken back to your previous workspace.",id:"onboardingActions.closeOnboardingDialog.existingUser.subtitle"}),acceptLabel:(0,te.jsx)(l().sA,{defaultMessage:"Back to previous workspace",id:"onboardingActions.closeOnboardingDialog.existingUser.confirmCloseButton.label"}),cancelLabel:(0,te.jsx)(l().sA,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.existingUser.continueButton.label"})});if(!a)return;m().rG(t,(0,Y().getContextualizedOnboardingAnalyticsData)({onboardingState:e,environment:t}));const{mainEditorCurrentBlockStore:r}=j().default.state,i=null==r?void 0:r.getSpaceId(),s=i&&(0,U().km)(i);if(s){const e=s.getSpaceStore();t.device.isMobileNative&&n().log({level:"info",from:"onboardingActions",type:"SpaceSwitchingDebug",data:{message:"onboardingActions.handleCloseOnboarding set space",spaceId:null==e?void 0:e.id}}),j().default.setState({...j().default.state,currentSpaceStore:e,currentSpaceViewStore:s})}const{url:c,userId:d}=w().v4(t);let p=t;if(d&&d!==t.currentUser.id&&(p=await R().T({environment:t,newCurrentUserId:d})),c){var o;Q().close();const e=()=>{me(p)};_().oo({environment:p,url:c}),null!==(o=p.mobileNative)&&void 0!==o&&o.supportsNativeHomeOnPhone()?T().navigateToHomeTab(p,e):e()}}}function Ie(e,t){var o;f().FX(e,{can_user_create_space:!1,is_new_user:!0,has_joinable_spaces:!1,onboarding_stage:(0,Y().getStageName)({flowName:t.flowName,stageIndex:t.currentStageIndex,environment:e})});const a=null===(o=t.onboardingData)||void 0===o?void 0:o.userStore.getEmail();throw ee().A.setState({...t,isInvalidRedirect:!0}),new(r().Xgk)(a?O().A.formatMessage(F().messages.errorWorkspaceCreationPreventedWithEmail,{userEmailAddress:a}):O().A.formatMessage(F().messages.errorWorkspaceCreationPrevented),{newUser:!0})}function we(e){const t=O().A.getIntl(),o=e.userStore.getFullName(t);ee().A.update((e=>({...e,spaceName:B().mi(o||"",t)})))}async function Se(e,t){if(z().default.setState({...z().default.state,isLoading:!1}),n().log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Found onboarding error: ${t.message}`,stack:String(t.stack)}}),S().V(),t instanceof N().C&&(0,r().OwV)(t.data.responseBody)&&"UnauthorizedError"===t.data.responseBody.name)return void m().bn(e,{...(0,Y().getContextualizedOnboardingAnalyticsData)({onboardingState:ee().A.state,environment:e}),errorMessage:t.message,debugMessage:"UnauthorizedError"});let o;if(t instanceof N().C){var a;const e=null==t||null===(a=t.data)||void 0===a||null===(a=a.responseBody)||void 0===a?void 0:a.clientData;e&&(o=(0,D().t4)(O().A.getIntl(),e))}m().bn(e,{...(0,Y().getContextualizedOnboardingAnalyticsData)({onboardingState:ee().A.state,environment:e}),errorMessage:t.message,debugMessage:o||"undefined"});const{accept:i}=await v().Gh({message:(0,te.jsxs)("div",{children:[(0,te.jsx)(l().sA,{defaultMessage:"Oops, something went wrong.",id:"onboardingActions.onboardingErrorDialog.message"}),(0,te.jsx)("div",{children:o??t.message})]}),acceptLabel:(0,te.jsx)(l().sA,{defaultMessage:"Start over",id:"onboardingActions.onboardingErrorDialog.startOverButton.label"}),cancelLabel:(0,te.jsx)(l().sA,{defaultMessage:"Close",id:"onboardingActions.onboardingErrorDialog.closeButton.label"})});i&&(0,V().Vh)(e,t)}},47273:(e,t,o)=>{o.d(t,{DS:()=>n,Fe:()=>d,GB:()=>i,Gf:()=>p,V_:()=>l,j1:()=>c,j8:()=>r,yp:()=>u,yw:()=>s});var a=()=>o(762433);function n(e){return(0,a().Fq)({subscription:e})}function r(e){return(0,a().Ry)({subscription:e,trial:void 0})}function i(e){let{subscriptionState:t,logFunction:o,spaceId:n}=e;const r=f(t);return(0,a().yB)({billingData:{subscription:r,trial:void 0},logFunction:o,spaceId:n})}function s(e){return(0,a().q8)({subscription:e})}function c(e){return(0,a().V9)({subscription:f(e),trial:void 0})}function d(e){return(0,a().d$)({subscription:f(e),trial:void 0})}function l(e){return(0,a().ji)({subscription:f(e),trial:void 0})}function p(e){return(0,a().AI)({subscription:f(e),trial:void 0})}function u(e,t){return(0,a().KH)({subscription:f(e),trial:void 0},t)}function f(e){return e?{...e,trialEnd:void 0}:void 0}},51618:(e,t,o)=>{o.d(t,{lM:()=>P,Lh:()=>M,GC:()=>C,dR:()=>k,zD:()=>T,w2:()=>R,aD:()=>D,XO:()=>h,yX:()=>_,Nm:()=>A,vZ:()=>y,Wg:()=>E,Or:()=>U,Dk:()=>x,Km:()=>O,Ut:()=>N});o(16280),o(898992),o(430670),o(581454);var a=()=>o(496603),n=()=>o(973647),r=()=>o(251582),i=()=>o(181856),s=()=>o(832443),c=()=>o(252050),d=()=>o(972261),l=()=>o(534177),p=()=>o(228803),u=()=>o(331119);function f(e,t){const o=`filter-${e}`;return r().p.mapResult((0,u().U5)(o),(a=>{var s;if(null===(s=a.attributes)||void 0===s||!s.condition)return{error:new(i().HQ)({tagName:o,attributeName:"condition"})};const d=c().RI[e],l=function(e){const{tagName:t,condition:o,allowedOperators:a}=e;if(o.includes("not ")){const e=o.replace("not ","").replace(/\s+/g," ").trim();return a.includes(e)?{value:{not:!0,operator:e}}:{error:new(i().js)({tagName:t,allowedOperators:a,inputCondition:o})}}return a.includes(o)?{value:{not:!1,operator:o}}:{error:new(i().js)({tagName:t,allowedOperators:a,inputCondition:o})}}({condition:a.attributes.condition,tagName:o,allowedOperators:Object.keys(d)});if(n().Q.isFail(l))return l;const f=d[l.value.operator],m=(0,u().ke)({inputAttributes:a.attributes,definitions:{name:{required:!0,values:!0},condition:{required:!0,values:!0},...f.attributes},tagName:o,mapCounterToKey:t.mapCounterToKey});if(n().Q.isFail(m))return m;const{name:g,condition:b,...v}=m.value,I=(0,r().$d)((0,u().nx)(o,[(0,p().Et)({inlineNodesAllowed:f.inline,textAllowed:f.text,parentTagName:o,mapCounterToKey:t.mapCounterToKey})],{allowUnmatchedText:!0}),a.children??[]);if(n().Q.isFail(I))return I.error instanceof i().RR?{error:new(i().nB)({tagName:I.error.tagName,unexpectedNode:I.error.unexpectedNode,conditionName:a.attributes.condition,cause:I.error})}:I;return{value:{propertyName:m.value.name,propertyTagName:e,children:I.value,attributes:v,operator:l.value.operator,not:l.value.not}}}))}function m(e){return r().p.choice([...(0,l().uv)(c().RI).map((t=>f(t,e))),r().p.fail((e=>new(i().yc)({nodeType:"database filter",unexpectedNode:a().$1(e)})))])}function g(e){return r().p.mapResult((0,u().U5)("filter-group"),(t=>{const o=(0,u().ke)({inputAttributes:t.attributes,definitions:{match:{required:!0,values:["any","all"]}},tagName:"filter-group",mapCounterToKey:e.mapCounterToKey});if(n().Q.isFail(o))return o;if(!t.children||0===t.children.length)return{error:new(i().Dp)({tagName:"filter-group"})};const a=(0,r().$d)((0,u().nx)("filter-group",[b(e)],{allowUnmatchedText:!0}),t.children??[]);return n().Q.isFail(a)?a:{value:{operator:o.value.match,filters:a.value}}}))}function b(e){return r().p.choice([m(e),g(e)])}const v=r().p.choice([...(0,l().uv)(c().GU).map((e=>function(e){const t=`sort-${e}`;return r().p.mapResult((0,u().U5)(t),(e=>{const o=(0,u().x3)(e);if(n().Q.isFail(o))return o;const a=(0,u().ke)({inputAttributes:e.attributes,definitions:{name:{required:!0,values:!0},direction:{required:!0,values:["ascending","descending"]}},tagName:t,mapCounterToKey:void 0});return n().Q.isFail(a)?a:{value:{propertyName:a.value.name,direction:a.value.direction}}}))}(e))),r().p.fail((e=>new(i().yc)({nodeType:"database sort",unexpectedNode:a().$1(e)})))]),I=r().p.map((0,u().RB)({tagName:"limit",attributeDefinitions:{number:{required:!0,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return parseInt(t.number)})),w=r().p.map((0,u().RB)({tagName:"search",attributeDefinitions:{question:{required:!0,values:!0},keywords:{required:!0,values:!0},"question-intl":{required:!1,values:!0},channel:{required:!1,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{question:t.question,keywords:t.keywords,questionIntl:t["question-intl"]}}));const S=r().p.choice([...(0,l().uv)(c().GU).map((e=>function(e){const t=`aggregation-${e}`,o=c().RD[t];return r().p.mapResult((0,u().U5)(t),(e=>{const a=(0,u().x3)(e);if(n().Q.isFail(a))return a;const r=(0,u().ke)({inputAttributes:e.attributes,definitions:o.attributes,tagName:t,mapCounterToKey:void 0});return n().Q.isFail(r)?r:{value:{tagName:t,attributes:r.value}}}))}(e))),r().p.fail((e=>new(i().yc)({nodeType:"database sort",unexpectedNode:a().$1(e)})))]);function y(e){return r().p.mapResult((0,u().U5)("query-database"),(t=>{const{id:o,...s}=t.attributes,c=o?function(e){const{id:t,mapCounterToKey:o}=e;if(!o)return{value:{key:t,type:"collection"}};const a=(0,n().j)((()=>o(t)));if(n().Q.isFail(a))return a;return"collection"===a.value.type||"collection-view"===a.value.type?{value:a.value}:{error:new Error(`Expected block or collection ID, got ${a.value.type}`)}}({id:o,mapCounterToKey:e.mapCounterToKey}):void 0;if(c&&n().Q.isFail(c))return c;if(!c)return{error:new Error('The <query-database> tag is missing a id attribute. It should be specified as <query-database id="...">')};if(Object.keys(s).length>0)return{error:new Error("<query-database> cannot have any attributes other than 'id'")};const d=(0,r().$d)((0,u().nx)("query-database",[r().p.map(b(e),(e=>({type:"filter",value:e}))),r().p.map(v,(e=>({type:"sort",value:e}))),r().p.map(w,(e=>({type:"search",value:e}))),r().p.map(S,(e=>({type:"aggregation",value:e}))),r().p.map(I,(e=>({type:"limit",value:e})))],{allowUnmatchedText:!0}),t.children??[]);if(n().Q.isFail(d))return d;const l=d.value.flatMap((e=>"filter"===e.type?[e.value]:[])),p=d.value.flatMap((e=>"sort"===e.type?[e.value]:[])),f=d.value.flatMap((e=>"search"===e.type?[e.value]:[])),m=d.value.flatMap((e=>"aggregation"===e.type?[e.value]:[])),g=d.value.flatMap((e=>"limit"===e.type?[e.value]:[]));if(f.length>1)return{error:new(i().bV)("<search>")};if(m.length>1)return{error:new(i().bV)("aggregation")};return{value:{tagName:"query-database",type:"observation",query:{databaseId:c.value.key,search:a().$1(f),aggregation:a().$1(m),filter:{operator:"all",filters:l},sorts:p,limit:a().$1(g)}}}}))}function h(e){return r().p.map((0,u().RB)({tagName:"load-page",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-page",attributes:t}}))}function _(e){return r().p.map((0,u().RB)({tagName:"load-slack",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-slack",attributes:t}}))}function T(e){return r().p.map((0,u().RB)({tagName:"load-google-drive",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-google-drive",attributes:t}}))}function k(e){return r().p.map((0,u().RB)({tagName:"load-github",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-github",attributes:t}}))}function C(e){return r().p.map((0,u().RB)({tagName:"load-github-code",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-github-code",attributes:t}}))}function R(e){return r().p.map((0,u().RB)({tagName:"load-jira",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-jira",attributes:t}}))}function A(e){return r().p.map((0,u().RB)({tagName:"load-web-page",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-web-page",attributes:t}}))}function P(e){return r().p.map((0,u().RB)({tagName:"load-attachment",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"attachment_id_counter"},attachmentType:{required:!0,values:["pdf"]}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-attachment",attributes:t}}))}function M(e){return r().p.map((0,u().RB)({tagName:"load-database",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"collection_counter"}},mapCounterToKey:e.mapCounterToKey}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-database",attributes:t}}))}function D(e){return r().p.mapResult((0,u().U5)("load"),(t=>{const o=(0,u().x3)(t);if(n().Q.isFail(o))return o;const{id:a,...r}=t.attributes;if(void 0===a)return{error:new Error("<load> must have an 'id' attribute")};if(Object.keys(r).length>0)return{error:new Error("<load> cannot have any attributes other than 'id'")};const{mapCounterToKey:i}=e;if(!i)return{error:new Error("mapCounterToKey is required")};const c=s().tD.mapCounterToKeyInMode({mapCounterToKey:i},a,"block_counter","load");if(!c.error)return{value:{type:"observation",tagName:"load-page",attributes:{id:c.value}}};const l=s().tD.mapCounterToKeyInMode({mapCounterToKey:i},a,"collection_counter","load");if(!l.error)return{value:{type:"observation",tagName:"load-database",attributes:{id:l.value}}};const p=s().tD.mapCounterToKeyInMode({mapCounterToKey:i},a,"external_id_counter","load");if(!p.error){const e=(0,d().Tq)(p.value);if("web"===e)return{value:{type:"observation",tagName:"load-web-page",attributes:{id:p.value}}};if("slack"===e)return{value:{type:"observation",tagName:"load-slack",attributes:{id:p.value}}};if("googleDrive"===e)return{value:{type:"observation",tagName:"load-google-drive",attributes:{id:p.value}}};if("github"===e)return{value:{type:"observation",tagName:"load-github",attributes:{id:p.value}}};if("githubCode"===e)return{value:{type:"observation",tagName:"load-github-code",attributes:{id:p.value}}};if("jira"===e)return{value:{type:"observation",tagName:"load-jira",attributes:{id:p.value}}}}return{error:new Error(`<load> with id ${a} could must be either a block or database ID.`)}}))}const N=["notion","slack","google-drive","github","jira","microsoft-teams","sharepoint","onedrive","linear","web"],O=["document","spreadsheets","presentation","pdf","message","pull-request","code","issue","task","ticket"],U=r().p.map((0,u().RB)({tagName:"search",attributeDefinitions:{question:{required:!0,values:!0},keywords:{required:!0,values:!0},lookback:{required:!1,values:!0},"question-intl":{required:!1,values:!0},channel:{required:!1,values:!0},source:{required:!1,values:!0},sort:{required:!1,values:["latest"]},database:{required:!1,values:!0},"file-type":{required:!1,values:O},repo:{required:!1,values:!0},[c().HV]:{required:!1,values:["true"]},contributor:{required:!1,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search",attributes:t}})),x=(r().p.map((0,u().RB)({tagName:"search",attributeDefinitions:{question:{required:!1,values:!0},keywords:{required:!0,values:!0},lookback:{required:!1,values:!0},"question-intl":{required:!1,values:!0},channel:{required:!1,values:!0},source:{required:!1,values:!0},sort:{required:!1,values:["latest"]},database:{required:!1,values:!0},"file-type":{required:!1,values:O},repo:{required:!1,values:!0},[c().HV]:{required:!1,values:["true"]},contributor:{required:!1,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search",attributes:t}})),r().p.map((0,u().RB)({tagName:"search-people",attributeDefinitions:{search:{required:!0,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search-people",attributes:t}}))),E=r().p.map((0,u().RB)({tagName:"search-databases",attributeDefinitions:{search:{required:!0,values:!0}},mapCounterToKey:void 0}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search-databases",attributes:t}}))},59424:(e,t,o)=>{o.r(t),o.d(t,{getContextualizedOnboardingAnalyticsData:()=>u,getOnboardingFlowCreatedSpaceWithoutPlanType:()=>w,getOnboardingProgressPercentage:()=>b,getSpaceIntentOverride:()=>g,getStageName:()=>d,getStages:()=>l,isAiOnboardingFlow:()=>S,isEducationFlowState:()=>p,isPublicAccessPageRedirect:()=>m,isWorkflowTemplatesEnabledForOnboarding:()=>I,shouldRedirectToJoinSpace:()=>f,shouldShowProgressIndicatorOnStage:()=>v});o(16280);var a=()=>o(820103),n=()=>o(313127),r=()=>o(640653),i=()=>o(351360),s=()=>o(151168),c=()=>o(71666);function d(e){const{flowName:t,stageIndex:o,environment:a}=e;return l({flowName:t,environment:a})[o]}function l(e){let{flowName:t,environment:o}=e;const a=o.device.isMobile,n=c().onboardingFlowNameToFlowConfig[t];if(a){if(!n.isEnabledForMobile)throw new Error(`Mobile flow is not enabled for flow name: ${t}`);return n.getMobileStages(o)}if(!n.isEnabledForDesktop)throw new Error(`Desktop flow is not enabled for flow name: ${t}`);return n.getDesktopStages()}function p(e){var t,o;return"education_flow"===e.flowName&&void 0!==(null===(t=e.planTypeAndSurveyInfo)||void 0===t||null===(t=t.surveyResponses)||void 0===t?void 0:t.educationRole)&&void 0!==(null===(o=e.planTypeAndSurveyInfo)||void 0===o||null===(o=o.surveyResponses)||void 0===o?void 0:o.educationLevel)}function u(e){var t,o,a,n,c,l,p;let{onboardingState:u,spaceJoinOrCreate:f,environment:m}=e;const{currentSpaceStore:g}=i().default.state,b=(0,r().p3)(),v=(null===(t=u.planTypeAndSurveyInfo)||void 0===t||null===(t=t.surveyResponses)||void 0===t?void 0:t.userPersona)??b.function,I=(null===(o=u.planTypeAndSurveyInfo)||void 0===o||null===(o=o.surveyResponses)||void 0===o?void 0:o.userRole)??b.role,w=(null===(a=u.planTypeAndSurveyInfo)||void 0===a||null===(a=a.surveyResponses)||void 0===a?void 0:a.companySize)??b.companySize,S=(null===(n=u.planTypeAndSurveyInfo)||void 0===n?void 0:n.planType)??b.intent,y=(null===(c=u.planTypeAndSurveyInfo)||void 0===c||null===(c=c.surveyResponses)||void 0===c?void 0:c.useCases)??b.useCases,h=(null===(l=u.planTypeAndSurveyInfo)||void 0===l||null===(l=l.surveyResponses)||void 0===l?void 0:l.categories)??b.categories,_=(null===(p=u.planTypeAndSurveyInfo)||void 0===p?void 0:p.collaborativeIntent)??b.collaborativeIntent;return{flow_name:u.flowName,flow_id:u.flowId,stage:d({flowName:u.flowName,stageIndex:u.currentStageIndex,environment:m}),initial_workspace_type:f,is_new_onboarding:Boolean(u.isFirstTimeOnboarding),is_create_or_join:!0,stage_number:u.currentStageIndex,num_of_joinable_spaces:u.joinableSpaces.length,historical_stages:u.historicalStages,selectedPresets:void 0,user_persona:v,user_team_role:I,user_use_cases:y,user_categories:h,user_company_size:w,plan_selection:S,collaborative_intent:_,plan_type:null==g?void 0:g.getPlanType(),stage_duration_in_ms:void 0,onboarding_templates:void 0,trial_id:(0,s().E5)(),performance_marketing_term:u.performanceMarketingTerm,is_invalid_redirect:u.isInvalidRedirect,is_dark_mode:"dark"===m.ThemeStore.state.mode,selected_workflow_templates:u.selectedWorkflowTemplateIds}}function f(e){return"guest_redirect"===e.type||"redirect_page"===e.type||"redirect_space"===e.type}function m(e){return"public_access_page_redirect"===e.type}function g(e){if("form_response_onboarding"===e.flowName)return"string"==typeof(t=e.formSpaceIntent)&&n().ay.includes(t)?e.formSpaceIntent:"personal";var t}function b(e,t){const{currentStageIndex:o}=e;return 15+(o+1)/l({flowName:e.flowName,environment:t}).length*80}function v(e,t){const o=t.device.isMobile,{currentStageIndex:a}=e,n=l({flowName:e.flowName,environment:t}).indexOf(o?"mobile_onboarding_plan_type_choose":"onboarding_plan_type_choose");return-1!==n&&a>=n}function I(e){return!e.device.isMobile}function w(e){return S(e)}function S(e){return a().He.includes(e)}},66460:(e,t,o)=>{o.d(t,{V_:()=>D,WR:()=>M,eu:()=>P,xE:()=>O,xX:()=>N});o(16280);var a=()=>o(244641),n=(o(296540),()=>o(857639)),r=()=>o(762433),i=()=>o(323063),s=()=>o(959013),c=()=>o(502800),d=()=>o(498212),l=()=>o(252105),p=()=>o(449506),u=()=>o(901389),f=()=>o(496414),m=()=>o(989423),g=()=>o(351360),b=()=>o(57605),v=()=>o(508496),I=()=>o(613240),w=()=>o(128265),S=()=>o(224701),y=()=>o(749356),h=()=>o(779795),_=()=>o(807778),T=()=>o(134217),k=()=>o(981046),C=()=>o(151168),R=o(474848);const A=(0,s().YK)({applyingBusinessTrial:{id:"trialUpsellActions.applyingBusinessTrial",defaultMessage:"Setting up your Business trial…"}});async function P(e){var t,o;const{environment:c,stripe:d,elements:p,trialData:f,trialDays:m,sessionId:v,customerName:I,businessName:w}=e;if(!p||!d)return void n().log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}});const{error:y}=await p.submit();if(y)return void l().$X(c,{error:"could not submit form",error_type:"payment_method"});const A=await d.createPaymentMethod({elements:p});if(A.error)return void l().$X(c,{error:A.error.message,error_type:"payment_method"});if(!A.paymentMethod)return void l().$X(c,{error:"could not create token",error_type:"payment_method"});const P={type:"paymentMethodId",value:A.paymentMethod.id},M=g().default.state.currentSpaceStore;if(!M)return;const D=M.id,N=await h().p_({environment:c,spaceId:D}),O=await b().A.awaitData(c,{spaceId:D});if(!O)throw new Error("Billing data not loaded");const U=(0,r().lQ)(O),x=k().A.state.selectedCurrencyCode??"USD",E=(0,C().Zr)(),V=(0,i().vk)(N,{interval:"month",product:E,currency:x}),F=(0,_().Le)(),B=(0,i().vH)(U,{price:V,quantity:1},{isMay13PackagingChangesEnabled:F}),z=a().c9.now().plus({days:m});return await async function(e){const{environment:t,spaceStore:o,paymentData:a,desiredState:n,stripe:r,trialData:i,customerName:c,businessName:d,addressZip:p,addressCountry:f,sessionId:m}=e,g=await b().A.awaitData(t,{spaceId:o.id});try{const e=await S().nV({environment:t,sessionId:m,spaceStore:o,desiredState:n,paymentData:a,from:"onboarding",trialData:i,billingEmail:(0,T().cs)(g),customerName:c,businessName:d,addressZip:p,addressCountry:f}),l=e.paymentIntentClientSecret,b=e.paymentIntentStatus;if(l&&"requires_action"===b){const{error:e}=await r.handleNextAction({clientSecret:l});e&&(await S().M2({environment:t,spaceStore:o,from:"subscription_upgrade_onboarding_failed_payment"}),u().f1((0,R.jsx)(s().sA,{id:"subscription.upgrade.payment_failed",defaultMessage:"Your payment could not be processed. Please provide an alternate payment method or you will lose access to Notion."})))}return"success"}catch{return void l().AF(t)}}({environment:c,spaceStore:M,desiredState:{...B,trialEnd:z},paymentData:P,stripe:d,trialData:f,customerName:I,businessName:w,addressZip:(null===(t=A.paymentMethod.billing_details.address)||void 0===t?void 0:t.postal_code)||"",addressCountry:(null===(o=A.paymentMethod.billing_details.address)||void 0===o?void 0:o.country)||"",sessionId:v})}const M=(0,o(496603).sg)(P,1e3,{leading:!0,trailing:!1});async function D(e){let{spaceId:t,environment:o}=e;if(await(0,y().L6)({environment:o,spaceId:t,offerCampaign:"reverse"})&&(0,_().s)(o)){await O(t,o,"going_multiplayer")&&await I().A.resetData(o,{spaceId:t})}}async function N(e,t,o){try{f().m({message:A.applyingBusinessTrial});const a=await p().callApi({eventName:"applyReverseTrial",environment:t,data:{spaceId:e,trialData:{id:"business_reverse",from:o}}});return"success"===a.type?((0,m().u4)({environment:t,event:{eventName:"trial_apply_attempt",eventProperties:{trial_id:"business_reverse",success:"success"===a.data.status}}}),await S().Ow(t),f().V(),"success"===a.data.status):(U("business_reverse",t,a.error),f().V(),!1)}catch(a){return U("business_reverse",t,a),f().V(),!1}}async function O(e,t,o){let a="reverse";try{const n=await(0,w().G)(t),r=Boolean(v().default.checkGate({gateName:"apply_reverse_trial_key"}));n&&(a="reverse_mm_ent");const i=`${e}_timed_trial`,s=r?(0,d().gB)(i):void 0,c=await p().callApi({eventName:"applyReverseTrial",environment:t,data:{spaceId:e,trialData:{id:a,from:o},idempotencyKey:s}});return"success"===c.type?((0,m().u4)({environment:t,event:{eventName:"trial_apply_attempt",eventProperties:{trial_id:a,success:"success"===c.data.status}}}),await S().Ow(t),"success"===c.data.status):(U(a,t,c.error),!1)}catch(n){return U(a,t,n),!1}}function U(e,t,o){(0,m().u4)({environment:t,event:{eventName:"trial_apply_attempt",eventProperties:{trial_id:e,success:!1}}}),n().log({level:"error",from:"trialUpsellActions",type:"applyReverseTrialError",error:(0,c().convertErrorToLog)(o)})}},71666:(e,t,o)=>{o.r(t),o.d(t,{onboardingFlowNameToFlowConfig:()=>I});var a=o.n(o(794148)),n=()=>o(677338),r=()=>o(867899),i=()=>o(496414),s=()=>o(780054),c=()=>o(989423),d=()=>o(285518),l=()=>o(144114),p=()=>o(351360),u=()=>o(508496),f=()=>o(589994),m=()=>o(151168);function g(){const e=n().r9();return Boolean(e)}var b=()=>o(322920),v=()=>o(235921);const I={education_flow:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","education_persona_survey","education_category_picker"],onStartFlow:()=>{},shouldShowFlowToUser:e=>!1},ai_onboarding_phase_2:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","app_builder","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_function","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout"],onStartFlow:()=>{},shouldShowFlowToUser:e=>{const t=(0,d().R)(p().default.state.currentUserRootStore);void 0===t&&(0,c().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}});const o=0===(t??0),a=e.device.isMobile;return o&&!a&&g()&&"on"===u().default.getEligibleGroup({experimentId:"ai_first_onboarding_phase_two",defaultGroup:"control"})}},ai_onboarding_phase_2_5:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_function","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout","app_builder"],onStartFlow:()=>{},shouldShowFlowToUser:e=>{const t=(0,d().R)(p().default.state.currentUserRootStore);void 0===t&&(0,c().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}});const a=0===(t??0),n=e.device.isMobile,r="en-US"===o(662303).locale;return a&&!n&&r&&("ai_step_in_onboarding"===u().default.getEligibleGroup({experimentId:"ai_first_onboarding_phase_two_point_five",defaultGroup:"control"})||"ai_step_in_onboarding_with_skip"===u().default.getEligibleGroup({experimentId:"ai_first_onboarding_phase_two_point_five",defaultGroup:"control"}))}},ai_onboarding_app_builder:{isEnabledForDesktop:!0,isEnabledForMobile:!1,persistStoreStateAfterFlowComplete:!0,getDesktopStages:()=>["profile"],onStartFlow:()=>{},onCompleteFlow:async(e,t)=>{var n;a()(t.onboardingData,"Missing onboardingData in onCompleteFlow"),a()("ai_onboarding_app_builder"===t.flowName,`In onCompleteFlow for ai_onboarding_app_builder but flowName is ${t.flowName}`);const r=(0,l().sg)(t.onboardingData),{spaceStore:i}=await(0,o(26388).createSpaceAsOwner)({onboardingState:t,onboardingData:t.onboardingData,redirectData:r,planType:null===(n=t.planTypeAndSurveyInfo)||void 0===n?void 0:n.planType,environment:e,createTemplates:!1,showLoader:!1}),s=t.onboardingData.userStore;return await(0,o(847).createEmptyWorkflowContainerAndBuild)({environment:e,parentStore:i,userStep:(0,o(555102).Kf)({environment:e,spaceStore:i,userStore:s,value:(0,o(919709).x9d)(t.aiPrompt)})})},shouldShowFlowToUser:e=>{const t=(0,d().R)(p().default.state.currentUserRootStore);void 0===t&&(0,c().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}});const o=0===(t??0),a=e.device.isMobile;return o&&!a&&g()&&"on"===u().default.getEligibleGroup({experimentId:"ai_builder_onboarding_flow",defaultGroup:"control"})}},form_response_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile","onboarding_workspace_choose"],getMobileStages:()=>["mobile_profile","mobile_onboarding_workspace_choose"],onStartFlow:()=>{},onCompleteFlow:async(e,t,n)=>{a()("form_response_onboarding"===t.flowName);const{defaultOnboardingComplete:i}=await r().F.contextualizedOnboardingActions.load();await i(e,n),o(464510).V(t.formResponseId,t.secretKey,t.formSpaceId)},shouldShowFlowToUser:()=>0===(0,d().R)(p().default.state.currentUserRootStore)&&(0,o(326406).A)()},mail_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>[],getMobileStages:()=>[],onStartFlow:()=>{},onCompleteFlow:async(e,t,a)=>{const{setAndTrackContextualizedOnboardingComplete:c}=await r().F.contextualizedOnboardingActions.load(),{onboardingData:d,joinableSpaces:p}=t;if(!d)return;const{onboardingStateActions:u}=await o(935370).onboardingActionsDependency.load();if(i().m({message:u.messages.creatingWorkspace}),0===p.length&&d.canUserCreateSpace){const a=o(972435).A.getIntl(),n=d.userStore.getFullName(a),{spaceViewStore:r}=await o(426116).bz({environment:e,planType:"personal",planSelection:"personal",name:n?(0,l().JR)(n,a):(0,l().CD)(a),userRootStore:d.userRootStore,analyticsFrom:"onboarding",icon:void 0,userPersona:"unfilled"});o(72234).I$(e,r,!0),c({environment:e,onboardingState:t,userStore:d.userStore,spaceJoinOrCreate:"create",permissionLevel:"member"})}await f().transactionQueue.drain(),i().V();const m=(0,n().KB)({fileHostProtocol:s().A.secureFileConfig.protocol,fileHostName:s().A.secureFileConfig.hostname}),g=null==m?void 0:m.result,b=null==g?void 0:g.startsWith(`${s().A.mail.domainBaseUrl}/`);g&&b?o(435009).oo({environment:e,url:`${g}#activeUserID=${e.currentUser.id}`}):await(0,o(838824).Z)({environment:e,from:"contextualizedOnboarding",targetSelf:!0})},shouldShowFlowToUser:()=>"mail"===(0,n().dY)()},calendar_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile"],getMobileStages:()=>["mobile_profile"],onStartFlow:()=>{},onCompleteFlow:async(e,t,a)=>{await f().transactionQueue.drain(),await(0,o(645200).J7)({environment:e,url:`${s().A.domainBaseUrl}/calendarAuth/`,from:"contextualizedOnboarding",targetSelf:!0})},shouldShowFlowToUser:()=>0===(0,d().R)(p().default.state.currentUserRootStore)&&"calendar"===(0,n().dY)()},performance_marketing_term_onboarding:{isEnabledForDesktop:!0,isEnabledForMobile:!1,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","team_onboarding_invite"],onStartFlow:()=>{},onCompleteFlow:async(e,t,o)=>{const{defaultOnboardingComplete:a}=await r().F.contextualizedOnboardingActions.load();await a(e,o)},shouldShowFlowToUser:e=>!e.device.isMobile&&("gantt"===(0,m().TQ)()||"crm"===(0,m().TQ)()||"projectManagement"===(0,m().TQ)())},mobile_tutorial_onboarding:{isEnabledForDesktop:!1,isEnabledForMobile:!0,getMobileStages:e=>(0,b().getMobileTutorialStages)(e),onStartFlow:()=>{},onCompleteFlow:async(e,t,o)=>{var a,n;const i=t.onboardingData;if(!i)return;const{redirectAfterContextualizedOnboardingComplete:s}=await r().F.contextualizedOnboardingActions.load(),c=(0,l().sg)(i);await s({environment:e,spaceViewId:null===(a=p().default.state.currentSpaceViewStore)||void 0===a?void 0:a.id,spaceId:null===(n=p().default.state.currentSpaceStore)||void 0===n?void 0:n.id,onboardingData:i,spaceJoinOrCreate:"join",redirectData:c,onboardingFlow:t.flowName,onboardingState:t,permissionLevel:(0,l().S1)(c)})},shouldShowFlowToUser:(e,t)=>Boolean(t)},default:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>["profile","onboarding_workspace_choose","onboarding_plan_type_choose","onboarding_collaborative_intent_choose","onboarding_category_survey",..."on"===w({experimentId:"onboarding_split_team_survey",disableExposureLogging:!0})?["team_onboarding_function","team_onboarding_role","team_onboarding_company_size"]:["team_onboarding_persona_survey"],"team_onboarding_use_cases","team_onboarding_workspace_create","team_onboarding_invite","team_onboarding_timed_trial_offer","team_onboarding_timed_trial_checkout"],getMobileStages:e=>[...["mobile_profile","mobile_onboarding_workspace_choose","mobile_onboarding_plan_type_choose","mobile_onboarding_collaborative_intent_choose",..."on"===w({experimentId:"onboarding_split_team_survey",disableExposureLogging:!0})?["mobile_team_onboarding_function","mobile_team_onboarding_role","mobile_team_onboarding_company_size"]:["mobile_team_onboarding_persona_survey"],"mobile_onboarding_category_survey","mobile_team_onboarding_use_cases","mobile_team_onboarding_workspace_create","mobile_team_onboarding_invite"],...(0,b().getMobileTutorialStages)(e)],onStartFlow:()=>{},shouldShowFlowToUser:(e,t)=>(void 0===(0,d().R)(p().default.state.currentUserRootStore)&&(0,c().u4)({environment:e,event:{eventName:"onboarding_undefined_space_view_count",eventProperties:{}}}),!t)},undefined:{isEnabledForDesktop:!0,isEnabledForMobile:!0,getDesktopStages:()=>[],getMobileStages:()=>[],onStartFlow:()=>{},onCompleteFlow:async()=>{},shouldShowFlowToUser:()=>!1}};function w(e){const{experimentId:t,disableExposureLogging:o}=e,a=v().A.state.onboardingExperiments;if(null!=a&&a[t])return a[t];const n=u().default.getEligibleGroup({experimentId:t,defaultGroup:"control",disableExposureLogging:o});v().A.setState({...v().A.state,onboardingExperiments:{...a,[t]:n}})}},101926:(e,t,o)=>{o.d(t,{ai:()=>te,xN:()=>re,e_:()=>oe,Ix:()=>ne,Z5:()=>ie});o(898992),o(672577);var a=()=>o(663077),n=()=>o(792071),r=()=>o(869558),i=()=>o(144081),s=()=>o(496603),c=()=>o(534177),d=()=>o(235191),l=()=>o(751156),p=()=>o(414360),u=()=>o(586481),f=()=>o(630116),m=(o(354520),()=>o(913454)),g=()=>o(204067);function b(e){var t;let{environment:o,collectionStore:n,collectionViewValue:r,dependencyMap:i,logger:s}=e;if((0,m().remapPropertyIds)({collectionStore:n,object:r,dependencyMap:i}),function(e){let{environment:t,spaceId:o,collectionViewValue:a,logger:n}=e;for(const s of(null===(r=a.format)||void 0===r?void 0:r.collection_groups)??[]){var r,i;const{value:e}=s;if(("created_by"===e.type||"last_edited_by"===e.type)&&"notion_user"===(null===(i=e.value)||void 0===i?void 0:i.table)){const a=t.currentUser.id;if(!a){n.warn("No current user ID, unable to remap collection group user to current user!");continue}n.log(`Remapping user ID ${e.value.id} to ${a} in collection view group.`),e.value.id=a,e.value.spaceId=o}}}({environment:o,spaceId:n.getSpaceId(),collectionViewValue:r,logger:s}),r.query2&&function(e){let{collectionStore:t,query2:o,dependencyMap:n}=e;for(const r of a().Nf){const e=o[r];e&&(o[r]=(0,g().CB)({collectionStore:t,sourceTemplateType:"property",dependencyMap:n,sourcePrimitiveId:e}))}}({collectionStore:n,query2:r.query2,dependencyMap:i}),"object"==typeof(null===(t=r.format)||void 0===t?void 0:t.collection_view_default_template)){const e=(0,g().fI)({collectionStore:n,sourceTemplateType:"block",dependencyMap:i,sourcePrimitiveId:r.format.collection_view_default_template.template_page_id});e?r.format.collection_view_default_template={template_page_id:e}:(s.warn("Unable to resolve collection_view default template, omitting it."),delete r.format.collection_view_default_template)}}function v(e){let{collectionViewFormat:t}=e;const o=null==t?void 0:t.table_properties;o&&(t.table_properties=o.filter((e=>!(0,g().TE)(e.property))))}var I=()=>o(731638),w=(o(581454),o.n(o(794148))),S=()=>o(192845),y=()=>o(977345),h=()=>o(206267),_=()=>o(884173),T=()=>o(696706),k=()=>o(912720),C=()=>o(199378),R=()=>o(179034),A=()=>o(519831),P=()=>o(798880),M=()=>o(324587),D=()=>o(780054),N=()=>o(594794),O=()=>o(972435);function U(e){let{collectionStore:t,environment:o,logger:a,template:r,transaction:i}=e;const s=function(e){let{environment:t,logger:o,parentStore:a,template:r,transaction:i}=e;const s=(0,N().zP)({environment:t,spaceId:a.getSpaceId(),table:k().yB}),c=t.currentUser.id,d=n().Bj6.fromAutomation({alive:!0,created_by_id:c??"",created_by_table:P().oo,created_time:Date.now(),id:s.id,parent_id:a.pointer.id,parent_table:a.pointer.table,space_id:a.getSpaceId(),trigger:{...r.value.trigger,id:h().JW()},version:0,last_edited_by_id:c??"",last_edited_by_table:P().oo,last_edited_time:Date.now(),status:"active"}),l=x({actionPlaceholderIdToActionId:new Map,collectionStore:a,dependencyMap:r.dependencyMap,logger:o}),{value:p}=(0,S().n)({automationModel:d,visitors:l}),u=p.getTrigger(),f=M().createAutomation({actionIds:[],environment:t,automationId:s.id,automationName:r.value.name,parentPointer:a.getSpaceShardedPointer(),transaction:i,trigger:u});return f}({environment:o,logger:a,parentStore:t,template:r,transaction:i}),c=new Map;return r.value.actions.map((e=>function(e){let{actionPlaceholderIdToActionId:t,actionTemplate:o,collectionStore:a,environment:n,logger:r,parentStore:i,parentTemplate:s,transaction:c}=e;const d=(0,N().zP)({environment:n,spaceId:i.getSpaceId(),table:C().SC}),{config:l,placeholderId:p,type:u}=o,{model:f}=_().RU.create({alive:!0,config:l,id:d.id,parent_id:i.pointer.id,parent_table:i.pointer.table,space_id:a.getSpaceId(),type:u,version:0}),m=x({actionPlaceholderIdToActionId:t,collectionStore:a,dependencyMap:s.dependencyMap,logger:r}),{value:g}=(0,S().G)({automationActionModel:f,baseUrl:D().A.domainBaseUrl,preventClearingConfig:!0,publicDomainName:D().A.publicDomainName,sourceSpaceId:a.getSpaceId(),visitors:m}),b=g.getConfig(),v=M().addAutomationAction({actionId:d.id,actionType:o.type,automationStore:i,config:b,createDuplicateBlocksContainer:!0,environment:n,intl:O().A.getIntl(),transaction:c});return w()(v,"Failed to create automation action"),t.set(p,v.id),v}({actionPlaceholderIdToActionId:c,actionTemplate:e,collectionStore:t,environment:o,logger:a,parentStore:s,parentTemplate:r,transaction:i}))),s.isTriggerType("event")&&l().applyOperation({store:t,operation:{pointer:t.pointer,path:["format","automation_ids"],command:"listAfter",args:{id:s.id}},transaction:i}),{id:s.id,spaceId:t.getSpaceId(),type:"automation"}}function x(e){const{actionPlaceholderIdToActionId:t,collectionStore:o,dependencyMap:a,logger:n}=e;function i(e){const o=(0,y().y5)(e);if("action"===o.source){const e=t.get(o.action_id)??o.action_id;return(0,y().$y)({...o,action_id:e})}if("global"===o.source)return e;(0,c().HB)(o)}function d(e){if(!a)return;if("title"===e)return e;const t=(0,g().fI)({collectionStore:o,sourceTemplateType:"property",sourcePrimitiveId:e,dependencyMap:a});return t||n.warn(`Failed to remap property ID ${e} in automation template`),t}return{visitCollectionProperty:e=>a?{type:"replace",value:d(e)}:{type:"keep"},visitCollectionPropertyPointer:e=>{if(!a)return{type:"keep"};const t=d(e.propertyId);if(!t)return{type:"replace",value:void 0};const r=(0,g().fI)({collectionStore:o,sourceTemplateType:"collection",sourcePrimitiveId:e.id,dependencyMap:a});return r?{type:"replace",value:{id:r,propertyId:t,spaceId:o.getSpaceId(),table:A().Vl}}:(n.warn(`Failed to remap collection ID ${e.id} in automation template`),{type:"replace",value:void 0})},visitFormulaContextValue:e=>({type:"replace",value:i(e)}),visitFormulaPageProperty:e=>{if(!a)return{type:"keep"};const t=(0,s().mg)(e),r=d(e.property);if(!r)return{type:"replace",value:void 0};if(t.property=r,"collection"in t&&t.collection){const e=(0,g().fI)({collectionStore:o,sourceTemplateType:A().Vl,sourcePrimitiveId:t.collection.id,dependencyMap:a});if(!e)return n.warn(`Failed to remap collection ID ${t.collection.id} in automation template`),{type:"replace",value:void 0};t.collection=T().L3.fromSpaceShardRecordId({id:e,spaceId:o.getSpaceId()},A().Vl)}else"contextValueId"in t&&t.contextValueId&&(t.contextValueId=i(t.contextValueId));return{type:"replace",value:t}},visitRecordPointer:e=>{if(!a)return{type:"keep"};if(e.table===R().ev||e.table===A().Vl||e.table===k().yB||e.table===r().Gy){const t=(0,g().fI)({collectionStore:o,sourceTemplateType:e.table,sourcePrimitiveId:e.id,dependencyMap:a});return t?{type:"replace",value:T().L3.fromSpaceShardRecordId({id:t,spaceId:o.getSpaceId()},e.table)}:(n.warn(`Failed to remap record pointer ${T().L3.toKey(e)} in automation template`),{type:"replace",value:void 0})}return{type:"keep"}}}}o(16280);var E=()=>o(388821),V=()=>o(722101),F=()=>o(44729),B=()=>o(183324);var z=()=>o(253141),Z=(o(944114),o(803949),()=>o(246826));function W(e){let{environment:t,transaction:o,collectionStore:a,template:n,logger:i,preserveCollectionFeatureOrdering:s}=e;const c=a.getParentBlockStore();if(!c)throw new Error("Collection view block store not found");const{value:d,dependencyMap:l}=n;if(!l)throw new Error("Dependency map not defined on view template");b({environment:t,collectionStore:a,collectionViewValue:d,dependencyMap:l,logger:i}),function(e){var t;let{collectionStore:o,collectionViewValue:a}=e;const n=null===(t=a.format)||void 0===t?void 0:t.table_properties;if(!n)return;const r=n.map((e=>e.property)),i=Object.keys(o.getSchema()).filter((e=>!r.includes(e)));for(const s of i)n.push({property:s,visible:!1})}({collectionStore:a,collectionViewValue:d});const p=Z().eC({environment:t,table:r().Gy,inMemoryRecordCache:c.inMemoryRecordCache,value:{...d,parent_id:c.id,parent_table:c.table,space_id:c.getSpaceId(),format:{...d.format,collection_pointer:a.pointer},alive:!0},transaction:o}),u=f().pS.createChildStore(c,p.pointer),m=c.getCollectionViewsStore();if(s){const e=function(e){let t,{collectionTemplate:o,collectionViewStores:a,collectionViewTemplate:n}=e,r=-1;const i=o.value.templateItems.findIndex((e=>e.pointer===n.templateId));return a.forEach((e=>{var a;const n=null===(a=e.getFormat().workflow_template_instance)||void 0===a?void 0:a.template_id;if(!n)return;const s=o.value.templateItems.findIndex((e=>e.pointer===n));s>i||s>r&&(r=s,t=e.id)})),t}({collectionTemplate:s,collectionViewStores:c.getCollectionViewStores(),collectionViewTemplate:n});e?V().BC({parentStore:m,appendStore:u,transaction:o,after:e}):V().Hs({parentStore:m,prependStore:u,transaction:o})}else V().BC({parentStore:m,appendStore:u,transaction:o});return{type:"collection_view",id:u.id}}var Q=()=>o(498212);var j=()=>o(220719),L=()=>o(447934);var q=()=>o(428045),$=()=>o(443881),K=()=>o(931075),G=()=>o(183558),J=()=>o(312296);function H(e){const{environment:t,logger:o,transaction:n,collectionStore:r,template:i}=e,c=function(e){if("title"===e.value.type)return"title";if(e.templateId===q().RE)return K()._e.Verification;if(e.templateId===q().dr)return K()._e.Owner;return(0,G().Ay)()}(i);if((0,a().PC)(i,"formula"))X({...e,template:i});else if((0,a().Ox)(i)){const t=m().globalWorkflowTemplates.featureFromId(i.buttonAutomationId);o.log(`Instantiating dependency "${t.templateId}" of button property template "${i.templateId}".`);const a=oe({...e,template:t});if(!a)throw new Error(`Failed to create instance of automation template "${t.templateId}"`);if("automation"!==a.type)throw new Error(`Unexpected instance pointer. Expected "automation" but got "${a.type}"`);i.value.automation_id=a.id}const d=(0,s().mg)(i.value);return d.workflow_template_instance={template_id:i.templateId},(0,J().F)({environment:t,collectionStore:r,update:{[c]:d},transaction:n}),{type:"property",id:c,collectionId:r.id}}function X(e){let{template:t,collectionStore:o}=e;const{value:a,dependencyMap:n}=t;if(!n)return;if(!a.formula2)return;const{value:r}=(0,$().RI)({baseUrl:D().A.domainBaseUrl,formula:a.formula2.code,publicDomainName:D().A.publicDomainName,spaceId:o.getSpaceId(),visitors:{visitFormulaContextValue:void 0,visitFormulaPageProperty:e=>{const t={...e};return t.property=(0,g().CB)({dependencyMap:n,collectionStore:o,sourcePrimitiveId:e.property,sourceTemplateType:"property"}),"collection"in t&&t.collection&&(t.collection=o.pointer),{type:"replace",value:t}},visitRecordPointer:void 0}});a.formula2.code=r}var Y=()=>o(290966),ee=()=>o(839754);function te(e){let{environment:t,transaction:o,collectionStore:a,template:n,logger:r,origin:i,examplePageStores:s,preserveCollectionFeatureOrdering:c}=e;const d=oe({transaction:o,environment:t,collectionStore:a,template:n,logger:r,origin:i,preserveCollectionFeatureOrdering:c}),l=(0,m().getPropertyTemplates)([n]);return(0,ee().My)({transaction:o,collectionStore:a,propertyTemplates:l}),(0,ee().Bi)({transaction:o,collectionStore:a,propertyTemplates:l}),ne({environment:t,transaction:o,collectionStore:a,template:n,logger:r,examplePageStores:s}),d}function oe(e){const{collectionStore:t,template:o,transaction:n}=e;!function(e){const{template:t,logger:o}=e,n=(0,a().Z6)({template:t,logger:o}),{environment:r,collectionStore:i}=e;for(const a of n){(0,g().Zp)({environment:r,scopeStore:i,templateId:a.templateId})||(o.log(`Template "${t.templateId}" has implicit dependency "${a.templateId}" (source: ${a.debugSource}), instantiating it.`),oe({...e,template:m().globalWorkflowTemplates.featureFromId(a.templateId)}))}}(e);const r=function(e){const{logger:t}=e,o=s().mg(e.template),{type:n}=o;switch(t.log(`Instantiating ${n} template "${o.templateId}".`),n){case"property":return H({...e,template:o});case"collection_view":return W({...e,template:o});case"layout":return function(e){let{environment:t,transaction:o,collectionStore:a,template:n}=e;if(!n.dependencyMap)throw new Error("Dependency map not defined on layout template");const r=(0,I().f)({collectionStore:a,modules:{page_layout_schema:void 0,page_info_layout_schema:void 0,form_layout_schema:void 0,person_profile_page_main:void 0,person_profile_page_details:void 0,...n.value},dependencyMap:n.dependencyMap}),{model:i}=(0,L().$L)({environment:t,transaction:o,collectionStore:a,userId:(0,j().o9)(t.currentUser.id),modules:r});return{type:"layout",id:i.id,spaceId:a.getSpaceId()}}({...e,template:o});case"compound":return function(e){const{environment:t,template:o,collectionStore:n,logger:r}=e,i=[],s=e=>{if(!(0,g().DM)(e)||"compound"===e.type)throw new Error(`Template in compound template generated a non-feature instance pointer of an illegal type: ${e.type}`);i.push(e)};for(const c of o.value.templateItems){const{optionality:i,pointer:d}=c;if("optionalDefaultOff"===i)continue;const l=(0,g().Zp)({environment:t,scopeStore:n,templateId:c.pointer});if(l){s(l);continue}const p=m().globalWorkflowTemplates.fromId(d);if(!(0,a().$K)(p))throw new Error(`${p.templateId} in compound template is of an illegal type: ${p.type}`);r.log(`Instantiating dependency "${p.templateId}" of compound template "${o.templateId}".`);const u=te({...e,template:p});u&&s(u)}return{type:"compound",id:(0,Q().Ay)(),instancePointers:i,collectionId:n.id}}({...e,template:o});case"block":return function(e){let{environment:t,transaction:o,collectionStore:a,template:n}=e;const r=(0,N().zP)({environment:t,spaceId:a.getSpaceId(),table:R().ev});if("block"!==n.type)throw new Error(`Expected block template, got ${n.type} template: ${n.templateId}`);if(!n.dependencyMap)throw new Error(`Dependency map not defined on block template: ${n.templateId}`);const{dependencyMap:i}=n,s=E().RecordMap.create(n.value.recordMap),c=s.getModel(n.value.blockPointer);if(c){const e=c.getProperties();for(const[t,o]of Object.entries(e)){const n=(0,g().CB)({collectionStore:a,sourceTemplateType:"property",sourcePrimitiveId:t,dependencyMap:i});n&&(delete e[t],e[n]=o)}}const{targetBlockStore:d}=B().localDuplicate({environment:t,sourceBlockId:n.value.blockPointer.id,targetBlockPointer:r,sourceBlockSubtree:s,transaction:o,targetInMemoryRecordCache:a.inMemoryRecordCache,options:{deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1}});return F().X$({childStore:d,parentStore:a,transaction:o}),d.isTemplate()&&V().BC({parentStore:a.getTemplatePagesStore(),appendStore:d,transaction:o}),{type:"block",id:d.id,spaceId:a.getSpaceId()}}({...e,template:o});case"automation":return U({...e,template:o});default:(0,c().HB)(n)}}(e);return r&&(0,Y().ZQ)({transaction:n,collectionStore:t,templateId:o.templateId,instance:r,logger:e.logger}),r}function ae(e){let{environment:t,transaction:o,collectionStore:a,template:n,instancePointer:r,examplePageStores:i}=e;if(i&&"property"===r.type)for(const s of i){const e=(0,z().gv)({collectionStore:a,dependencyMap:n.dependencyMap??{},exampleRow:{properties:s.getProperties()}});(0,u().L)({environment:t,store:s,properties:e.properties,transaction:o})}}function ne(e){let{environment:t,transaction:o,collectionStore:a,template:s,logger:c,examplePageStores:d}=e;const p=(0,g().Sl)({environment:t,collectionStore:a});for(const{instancePointer:u,templateId:g}of p){if("collection"===u.type)continue;const e=m().globalWorkflowTemplates.fromId(g),p=e.dependencyMap&&Object.values(e.dependencyMap).includes(s.templateId);if(!("dependencyMap"in e)||!e.dependencyMap||!p){ae({environment:t,transaction:o,collectionStore:a,template:s,examplePageStores:d,instancePointer:u});continue}c.log(`Remapping dependency "${s.templateId}" in "${g}".`);const v={};if("layout"===u.type){const e=f().K_.createChildStore(a,{table:i().zx,id:u.id,spaceId:u.spaceId}),t=e.getRawModules();if(t){const r=(0,I().f)({collectionStore:a,modules:t,dependencyMap:v});l().applyOperation({transaction:o,store:e,operation:n().N4X.updateModules(e.pointer,r)})}}else if("collection_view"===u.type){const e=f().pS.createChildStore(a,{table:r().Gy,id:u.id}),o=e.getType();if(!o)continue;b({environment:t,collectionStore:a,collectionViewValue:{type:o,name:e.getName(),format:e.getFormat(),query2:e.getRawQuery()},dependencyMap:v,logger:c})}else c.warn(`Don't know how to remap instance type "${u.type}"!`)}}function re(e){let{environment:t,collectionStore:o}=e;const a=(0,g().Sl)({environment:t,collectionStore:o});for(const{instancePointer:n}of a)if("collection_view"===n.type){const e=f().pS.createChildStore(o,{table:r().Gy,id:n.id});if(!e.getType())continue;v({collectionViewFormat:e.getFormat()})}}function ie(e){let{environment:t,transaction:o,collectionViewBlockStore:a,collectionStore:n,instancePointer:r}=e;const i=r.type;switch(i){case"property":d().BJ({environment:t,collectionStore:n,schema:n.getSchema(),property:r.id,transaction:o,permanentlyDelete:!1});break;case"collection_view":if(!a)return;const e=a.getCollectionViewStores().find((e=>e.id===r.id));e&&(0,p().T)({collectionViewBlockStore:a,collectionViewStore:e,transaction:o});break;case"layout":case"block":case"automation":break;default:(0,c().HB)(i)}}},118078:(e,t,o)=>{o.r(t),o.d(t,{closeChatSidebar:()=>m,maybeCloseNotionSidebar:()=>p,maybeOpenNotionSidebar:()=>u,showChatSidebar:()=>f});var a=()=>o(435009),n=()=>o(492414),r=()=>o(644914),i=()=>o(749687),s=()=>o(351360),c=()=>o(712505),d=()=>o(890754),l=()=>o(590027);function p(e){const{environment:t}=e;(0,r().KB)(t)&&((0,d().getIsChatSidebarOpen)(t)||(i().sidebarExpandedStore.setState(!1),c().default.setSidebarExpandedStoreState(!1),l().M.setState({...l().M.state,reopenMainSidebarOnClose:!0})))}function u(){l().M.state.reopenMainSidebarOnClose&&(i().sidebarExpandedStore.setState(!0),c().default.setSidebarExpandedStoreState(!0),l().M.setState({...l().M.state,reopenMainSidebarOnClose:void 0}))}function f(e){const{environment:t,store:o}=e,r=(0,d().getMergedChatSidebarState)({environment:t,update:e.chatSidebarState}),i=(0,d().routeArgsGivenChatSidebarState)(r),c=(0,n().Ef)({environment:t,updates:{...i,store:o}}),l=s().default.state.mainEditorCurrentBlockStore!==o;a().oo({environment:t,url:c,redirect:!l}),p({environment:t})}function m(e){const{environment:t}=e;u();const o=(0,d().routeArgsGivenChatSidebarState)(d().CLOSED_CHAT_SIDEBAR_STATE),r=(0,n().Ef)({environment:t,updates:o});a().oo({environment:t,url:r,redirect:!0})}},134539:(e,t,o)=>{o.d(t,{NU:()=>g,O:()=>m,Rf:()=>f,SU:()=>v,cV:()=>b,fn:()=>I});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(581454);var a=()=>o(428045),n=()=>o(888325),r=()=>o(278238),i=()=>o(919709),s=()=>o(534177),c=()=>o(403905),d=()=>o(972435),l=()=>o(630116),p=()=>o(913454),u=()=>o(476219);function f(e){var t;const{collectionViewBlockStore:o,collectionStore:f,instanceMap:m}=e,g=f.id,b=(0,n()._)({table:"collection",id:g}),I=m[b]??{};if(!o.isReady()||!f.isReady())return;let w,S=!1;const y=o.getCollectionViewIds().map((e=>{const t=l().pS.createChildStore(o,{table:"collection_view",id:e}),n=t.getModel();if(!n)return void(S=!0);const r=t.getCollectionStore();if(!r)return void(S=!0);let i=!1;return w||"table"!==n.getType()||(w=e,i=!0),r.id===g?function(e){const{collectionViewStore:t,templateIdToInstancePointersMap:o,schema:n,isFirstTableView:r}=e,i=t.id;let s=t.getName();const l=t.getType(),u=v(o,"collection_view",i);let f;r&&!s&&(f=a().Gs,s=(0,p().getWorkflowTemplateName)(p().globalWorkflowTemplates.fromId(f)));!s&&l&&(s=d().A.intl.formatMessage(c().X[l]));return{type:"collection_view",name:s,id:i,viewType:l,format:t.getNormalizedFormat(n)??{},query:t.getRawQuery(),templateId:u,isFirstTableView:r,defaultBuiltinTemplateIdToMapTo:f}}({collectionViewStore:t,templateIdToInstancePointersMap:I,schema:r.getSchema(),isFirstTableView:i}):void 0})).filter(s().O9);if(S)return;const h=[];for(const a of y)if(a.isFirstTableView){const e=a.format;if(e.table_properties){for(const t of e.table_properties)t.visible&&h.push(t.property);if(h.length>0)break}}const _=f.getSchema(),T=Object.entries(_).map((e=>{let[t,o]=e;if(o)return function(e){const{propertyId:t,schema:o,instanceMap:a,templateIdToInstancePointersMap:r}=e,i="relation"===o.type&&o.collection_id?function(e,t){const o=(0,n()._)({table:"collection",id:t});return v(e[o]??{},"collection",t)}(a,o.collection_id):void 0;return{type:"property",id:t,name:o.name,schema:o,relatedCollectionTemplateId:i,templateId:v(r,"property",t),isSupported:u().Pg(o)}}({propertyId:t,schema:o,instanceMap:m,templateIdToInstancePointersMap:I})})).filter(s().O9),k=f.getLayoutStore();if(k&&!k.isReady())return;const C=null==k?void 0:k.getModel(),R=C?function(e){const{layoutModel:t,templateIdToInstancePointersMap:o}=e,a=v(o,"layout",t.id);let n;if(a){const e=p().globalWorkflowTemplates.fromId(a);"layout"===e.type&&(n=e.name)}return{id:t.id,type:"layout",templateId:a,name:n,layout:t.getRawModules(),spaceId:t.spaceId}}({layoutModel:C,templateIdToInstancePointersMap:I}):void 0,A=f.getAutomationStores().map((e=>e.pointer)),P=null===(t=f.getIcon())||void 0===t?void 0:t.icon,M=P&&(0,r().T8)(P)?P:void 0,D=f.getDescription();return{type:"collection",id:g,description:D,descriptionAsString:(0,i().q4_)(D),schema:_,templateId:v(I,"collection",g),name:(0,i().q4_)(f.getName()),pageTemplateIds:f.getTemplatePages(),format:f.getFormat(),icon:M,properties:T,collectionViews:y,firstTableViewId:w,layout:R,templateIdToInstancePointersMap:I,tableOrderPropertyIds:h,automationPointers:A}}function m(e){return"property"===e.type&&"title"===e.id}function g(e){return m(e)&&"Name"===e.schema.name}function b(e){const{collectionInfo:t,pageStore:o,instanceMap:a,recordMap:r}=e,s=(0,i().q4_)(o.getTitleValue())||"Untitled",c=a[(0,n()._)({table:"collection",id:t.id})]??{},d=new Set,l=o.getProperties();for(const n of Object.keys(l))"title"!==n&&d.add(n);return{type:"block",id:o.id,recordMap:r,templateId:v(c,"block",o.id),name:s,propertyIds:d,spaceId:o.getSpaceId()}}function v(e,t,o){var a;return null===(a=I(e,t,o))||void 0===a?void 0:a.templateId}function I(e,t,o){for(const[a,n]of Object.entries(e))for(const e of n)if(e.type===t&&e.id===o)return{...e,templateId:a}}},147427:(e,t,o)=>{function a(e){return"text"===e.type&&!e.value.trim()}o.d(t,{A:()=>a})},154152:(e,t,o)=>{o.d(t,{y:()=>d,z:()=>l});o(16280);var a=()=>o(555102),n=()=>o(351360),r=()=>o(847),i=()=>o(46986),s=()=>o(317053),c=()=>o(458097);async function d(e){const{environment:t,parentStore:o,prompt:i}=e;c().A.close({type:"opened_app_builder"});const s=n().default.state.currentSpaceStore;if(!s)throw new Error("No current space store");const d=n().default.state.currentUserStore;if(!d)throw new Error("No current user store");await(0,r().createEmptyWorkflowContainerAndBuild)({environment:t,parentStore:o??s,userStep:(0,a().Kf)({environment:t,spaceStore:s,userStore:d,value:i})})}async function l(e){let{setupGenerator:t,environment:o,parentStore:a,allowNavigateToAppBuilder:n=!0,isPhone:r}=e;if(!n||!(0,i().Yf)({environment:o})){(0,s().moveToNextOnboardingStep)(r);if(!(await t.submitPrompt({from:"initial-input"})))return;return void(0,s().moveToNextOnboardingStep)(r)}const{prompt:c}=t.store.state;c&&await d({environment:o,parentStore:a,prompt:c})}},162342:(e,t,o)=>{o.d(t,{W$:()=>s,fR:()=>r,iv:()=>i});var a=()=>o(228814),n=()=>o(846199);function r(e){n().A.setState({open:!0,...e})}function i(){n().A.setState({open:!1})}function s(e){a().A.setState({open:!0,...e})}},182865:(e,t,o)=>{o.d(t,{VG:()=>W,Vn:()=>U,aP:()=>D,fI:()=>L,WF:()=>Q,zf:()=>F,Wq:()=>M,hx:()=>x,WE:()=>V,gj:()=>Z,cO:()=>j,GS:()=>O,g6:()=>N,D7:()=>E});o(16280),o(944114),o(898992),o(354520),o(672577),o(430670),o(581454);var a=()=>o(498212),n=()=>o(534177),r=()=>o(832443),i=()=>o(252050),s=()=>o(191772);function c(e){const{text:t,baseUrl:o}=e,c=new Map;let d=1;const l=t.replace(/\[(.*?)\]\(#citation:([^)]+)\)/g,((e,t,l)=>{try{const e=decodeURIComponent(l),t=r().tD.parseAssistantHref(e),p=t||((0,a().iv)(e)?{type:"block",blockId:(0,i().ew)(e)}:void 0);if(!p)return"";const u=function(e){const{citation:t,baseUrl:o,type:r}=e;if(!t)throw new Error(`Citation not found for search result of type: ${r}`);if("slack"===t.type)return(0,s().mQ)({...t});if("google-drive"===t.type||"github"===t.type||"helpdoc"===t.type||"helpdoc-section"===t.type||"webpage"===t.type||"gmail"===t.type||"jira"===t.type||"microsoftTeams"===t.type||"sharepoint"===t.type)return t.url;if("block"===t.type)return`${o}/${(0,a().Xw)(t.blockId)}`;if("database_query_results"===t.type);else{if("citation_unsupported"===t.type)return;(0,n().HB)(t)}}({citation:p,baseUrl:o,type:p.type??"unknown"});if(!u)return"";let f=c.get(u);return void 0===f&&(f=d++,c.set(u,f)),` [[${f}]](${u})`}catch(p){return""}}));return l}var d=()=>o(362750),l=()=>o(460744),p=()=>o(386164),u=()=>o(234459),f=()=>o(155792),m=()=>o(724639),g=()=>o(532659),b=()=>o(496603),v=()=>o(449506),I=()=>o(787172),w=()=>o(884107),S=()=>o(901389),y=()=>o(246826),h=()=>o(751156),_=()=>o(780054),T=()=>o(594794),k=()=>o(351360),C=()=>o(122058),R=()=>o(255299),A=()=>o(717375),P=()=>o(989423);function M(e){const{clientStore:t,environment:o}=e,a=o.RouterStore.state.route,n="chat"===a.name?a.threadId:void 0;n&&t.getClientAIChatThreadStore(n).resetState(),t.setState({...t.state,userSelectedConfig:void 0,isAIChatTranscriptSidePanelVisible:!1})}function D(e){const{environment:t,userStore:o,spaceStore:a,transcript:n,workflowStore:r,transaction:i,threadId:s}=e,c=y().vt({environment:t,table:u().To,args:{id:s??(0,T().Z1)({environment:t,table:u().To,spaceId:a.id}),parentPointer:a.pointer,space_id:a.id,messages:[],data:{workflow_block_id:null==r?void 0:r.getParentId()},createdByPointer:o.pointer},transaction:i,inMemoryRecordCache:a.inMemoryRecordCache});return n&&U({environment:t,spaceStore:a,threadStore:c,userStore:o,addSteps:n,transaction:i}),c}function N(e){var t;const{threadStore:o,transaction:a}=e;y().zv({store:o.getDataStore(),data:{shared_with_space:!Boolean(null===(t=o.getData())||void 0===t?void 0:t.shared_with_space)},transaction:a})}function O(e){var t;const{threadStore:o,transaction:a,clientStore:n}=e;null===(t=n.getClientAIChatThreadStore(o.id).state.abortController)||void 0===t||t.abort(),y().zv({store:o,data:{current_inference_id:null,current_inference_lease_expiration:null},transaction:a})}function U(e){const{environment:t,spaceStore:o,threadStore:a,userStore:n,addSteps:r,transaction:i}=e,s=r.map((e=>y().vt({environment:t,table:f().mS,args:{id:e.id.toString(),parentPointer:a.pointer,space_id:o.id,step:e,createdByPointer:n.pointer},transaction:i,inMemoryRecordCache:o.inMemoryRecordCache})));return h().applyOperation({operation:{args:{ids:s.map((e=>e.id))},command:"listAfterMulti",path:["messages"],pointer:a.pointer},store:a,transaction:i}),s}function x(e){const{threadStore:t,stepIndex:o,transaction:a}=e,n=t.getMessages().slice(o+1);for(const r of n)h().applyOperation({operation:{args:{id:r},command:"listRemove",path:["messages"],pointer:t.pointer},store:t,transaction:a})}function E(e){const{threadStore:t,stepIndex:o,transaction:a,newValue:n}=e,r=t.getStepStoreAt(o);r&&y().zv({store:r,data:{value:n},transaction:a})}async function V(e){var t,o;const{clientStore:n,environment:r,threadStore:i,createThreadArgs:s,waitBeforeSending:c,analyticsArgs:d}=e,m=(null==i?void 0:i.getTranscript())??(null==s?void 0:s.transcript)??[];if(0===m.length)throw new Error("No transcript");const b=null===(t=k().default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!b)throw new Error("No space id");const I=(null==i?void 0:i.id)??(null==s?void 0:s.id);if(!I)throw new Error("No thread id");const{model:w}=n.state,{cachedInferences:_,annotationInferences:T}=(0,R().Hg)(n,I),A=new AbortController,M={};for(const a of _){if(!a.value.expected)throw new Error("No expected output for cached inference");if((0,l().Mt)(a.value.expected))throw new Error("Merged response not supported");M[a.key]=a.value.expected}const D={};for(const a of T)a.value.input.annotation&&(D[a.key]=a.value.input.annotation);const N=(0,a().Ay)(),O=n.getClientAIChatThreadStore(I);O.setState({...O.state,inferences:[],temporarySteps:(null==s?void 0:s.transcript)??[],abortController:A,traceId:N,loading:!0}),O.state.stopInferencePromise&&(await O.state.stopInferencePromise,O.setState({...O.state,stopInferencePromise:void 0}));const U=Boolean(null==i||null===(o=i.getData())||void 0===o?void 0:o.title),x={traceId:N,spaceId:b,transcript:m,threadId:I,threadParentPointer:null==s?void 0:s.parentPointer,threadWorkflowBlockId:null==s?void 0:s.workflowBlockId,createThread:void 0===i,debugOverrides:{...n.state.debugOverrides,cachedInferences:M,annotationInferences:D,model:w,emitInferences:n.state.showDebug,agentModelConfig:n.state.agentModelConfig},generateTitle:!U,analyticsArgs:d};n.state.showDebug&&O.setState({...O.state,requestInfo:{request:x,response:void 0,memory:void 0}});try{c&&await c,await async function(e){const{environment:t,abortController:o,clientStore:a,request:n}=e,r=await v().callStreamApi({eventName:"runInferenceTranscript",environment:t,data:n,abortSignal:o.signal,headers:(0,p().WS)({spaceId:n.spaceId})});if("failed"===r.type)throw r.error;const i=n.threadId?function(e){const{environment:t,threadId:o,transcript:a,traceId:n,analyticsArgs:r}=e,i=(0,R().JD)(a),s=i&&"search"===i.type?i.searchSessionId:void 0,c=Date.now();let d=a.filter((e=>"user"===e.type)).length>1,l=a.filter((e=>"user"===e.type)).length>1,p=!1,u=!1;return{deepFindResultsOnClient:()=>{d||((0,C().hp)({environment:t,assistantSessionId:void 0,searchSessionId:s,threadId:o,timeSinceTurnStartMs:Date.now()-c}),d=!0)},deepFindBeginAiAnswer:()=>{l||((0,C().S9)({environment:t,assistantSessionId:void 0,searchSessionId:s,threadId:o,timeSinceTurnStartMs:Date.now()-c}),l=!0)},beginInferenceTranscriptTurn:()=>{p||(!function(e){(0,P().u4)({environment:e.environment,event:{eventName:"inference_transcript_start_turn",eventProperties:{thread_id:e.threadId,trace_id:e.traceId,config:e.config,suggested_prompt:e.suggestedPrompt}}})}({environment:t,threadId:o,traceId:n,config:i,suggestedPrompt:null==r?void 0:r.suggestedPrompt}),p=!0)},endInferenceTranscriptTurn:e=>{let{isError:a}=e;u||(!function(e){(0,P().u4)({environment:e.environment,event:{eventName:"inference_transcript_end_turn",eventProperties:{thread_id:e.threadId,trace_id:e.traceId,is_error:e.isError}}})}({environment:t,threadId:o,traceId:n,isError:a}),u=!0)}}}({environment:t,threadId:n.threadId,transcript:n.transcript,traceId:n.traceId,analyticsArgs:n.analyticsArgs}):{deepFindResultsOnClient:()=>{},deepFindBeginAiAnswer:()=>{},beginInferenceTranscriptTurn:()=>{},endInferenceTranscriptTurn:()=>{}};if(g().hS.is(r.data)){i.beginInferenceTranscriptTurn();let e=!1;for await(const o of r.data)"error"===o.type&&(e=!0),z({environment:t,request:n,clientStore:a,value:o}),B({analyticsController:i,value:o});i.endInferenceTranscriptTurn({isError:e})}}({environment:r,abortController:A,clientStore:n,request:x})}catch(E){F(A,E)?function(e){const{environment:t,clientStore:o,threadId:a,spaceId:n}=e,{currentUserStore:r}=k().default.state;if(!r)throw new Error("No current user root store");const i=o.getClientAIChatThreadStore(a);h().createAndCommit({userAction:"inferenceTranscriptActions.handleAbort",environment:t,canUndo:!0,perform:e=>{for(const o of i.state.temporarySteps)y().vt({environment:t,table:f().mS,args:{id:o.id.toString(),parentPointer:{id:a,table:u().To,spaceId:n},space_id:n,step:o,createdByPointer:r.pointer},transaction:e,inMemoryRecordCache:r.inMemoryRecordCache})}})}({environment:r,clientStore:n,threadId:I,spaceId:b}):S().rG({message:E instanceof Error?E.message:"Unknown error"})}O.setState({...O.state,abortController:void 0,loading:!1})}function F(e,t){return t instanceof Error&&"AbortError"===t.name&&e.signal.aborted}function B(e){const{analyticsController:t,value:o}=e;"search"===o.type&&"resultsPartial"===o.status&&t.deepFindResultsOnClient(),"search-chat"===o.type&&t.deepFindBeginAiAnswer()}function z(e){const{request:t,clientStore:o,value:a,environment:n}=e,r=n.currentUser.id,i=t.threadId;if(!i)return;const s=o.getClientAIChatThreadStore(i);if(I().s({environment:n,eventName:"runInferenceTranscript",response:a,userId:r}),"queue-handoff"!==a.type&&"record-map"!==a.type&&"workflow"!==a.type)if("inference"===a.type){const e={type:"inference",key:(0,m().$A)(a.value.input),index:a.index,value:a.value},t=b().Ul([...s.state.inferences,e],(e=>e.index));s.setState({...s.state,inferences:t})}else{const e=(0,l().RM)(s.state.temporarySteps,a);if(s.setState({...s.state,temporarySteps:e}),o.state.showDebug){const o={transcript:e};s.setState({...s.state,requestInfo:{request:t,response:o,memory:void 0}})}}}async function Z(e){const{environment:t,onResponse:o,data:a,userId:n,tracking:r,abortSignal:i}=e,s=await v().callStreamApi({eventName:"runInferenceTranscript",environment:t,data:a,userId:n,tracking:r,abortSignal:i,headers:(0,p().WS)({spaceId:a.spaceId})});if("success"!==s.type)return S().Qg(s),{error:{message:s.error.message,code:s.status}};const c=[];if(g().hS.is(s.data))for await(const d of s.data){if("error"===d.type)return{error:{message:d.message,code:d.errorCode}};null==o||o(d),c.push(d)}return{value:c}}async function W(e){const{environment:t,step:o}=e;let a;if("markdown-chat"===o.type||"fast-researcher-chat"===o.type)a=o.value;else if("search-chat"===o.type){a=c({text:(0,R().Jz)(o.value),baseUrl:_().A.domainBaseUrl})}else{if("workflow-inference"!==o.type&&"agent-inference"!==o.type)throw new Error("Unsupported step type");a=(0,d().lH)(o.value).flatMap((e=>"text"===e.type?[e.content]:[])).join("")}const n=await w().R.clipboardActions.load();await n.copyString({environment:t,stringValue:a,copiedMessage:n.clipboardMessages.copiedQnAMessageToClipboard})}function Q(e){const{environment:t,threadStore:o,stepIndex:a,clientStore:n,analyticsArgs:r}=e;h().createAndCommit({userAction:"AIChatTranscript.RunFromStepButton.handleClick",environment:t,canUndo:!0,perform:e=>{x({threadStore:o,stepIndex:a,transaction:e})}}),V({environment:t,threadStore:o,clientStore:n,analyticsArgs:r})}function j(e){const{threadStore:t,config:o,environment:a}=e,{currentSpaceStore:n,currentSpaceViewStore:r}=k().default.state;if(!n||!r)throw new Error("No current space");const i=t.getTranscript(),s=t.getMessageStores(),c=i.findIndex((e=>"config"===e.type)),d=i[c],l=s[c];if(c<0||!l||!d||"config"!==d.type)throw new Error("No config step found");if(d.value.type!==o.type)throw new Error("Cannot change config type");const p={...d,value:o};h().createAndCommit({userAction:"AIChatTranscript.setConfigInThread",environment:a,canUndo:!0,perform:e=>{y().KY({store:l.getStepStore(),value:p,transaction:e})}})}function L(e){const{spaceStore:t}=e;return(0,A().xm)({spaceStore:t}).find((e=>"researcher"===e.type))??{type:"researcher"}}},228803:(e,t,o)=>{o.d(t,{Et:()=>u});o(16280),o(944114),o(898992),o(354520);var a=()=>o(973647),n=()=>o(534177),r=()=>o(251582),i=()=>o(181856),s=()=>o(252050),c=()=>o(147427),d=(o(581454),()=>o(331119));const l=r().p.map(d().W6,(e=>({type:"text",value:e.value})));function p(e){const t=(0,n().s8)(s()._S,((t,o)=>function(e,t){const o=s()._S[e],{mapCounterToKey:n}=t;return r().p.mapResult((0,d().U5)(e),(t=>{const i=(0,d().ke)({inputAttributes:t.attributes,definitions:o.attributes,tagName:e,mapCounterToKey:n});if(a().Q.isFail(i))return i;let s=t.children??[];o.text||(s=s.filter((e=>!(0,c().A)(e))));const l=(0,r().$d)(r().p.manyTill(u({inlineNodesAllowed:o.inline,textAllowed:o.text,parentTagName:e,mapCounterToKey:n}),r().p.eof()),s);if(a().Q.isFail(l))return l;const p=l.value;return{value:{type:"inline",tagName:e,attributes:i.value,children:p}}}))}(o,e)));return t}function u(e){const{inlineNodesAllowed:t,textAllowed:o,parentTagName:a,mapCounterToKey:s}=e,c=[...t],d=[];for(const[r,i]of(0,n().WP)(p({mapCounterToKey:s})))(0,n().Xk)(c,r)&&d.push(i);return r().p.choice([...d,...o?[l]:[],r().p.fail((e=>e.length>0?new(i().RR)({tagName:a,unexpectedNode:e[0]}):new Error("No inline or text node")))])}},228814:(e,t,o)=>{o.d(t,{A:()=>a});const a=o(757695).default.createValue({open:!1},{name:"TrialEndModalStore"})},247211:(e,t,o)=>{o.d(t,{D6:()=>h,Jp:()=>p,OU:()=>v,PT:()=>y,To:()=>b,rW:()=>I,rs:()=>m,vO:()=>g});o(898992),o(354520),o(672577),o(581454);var a=()=>o(496603),n=()=>o(534177),r=()=>o(913454),i=()=>o(134539);const s="content",c="item",d="items",l="optionalDefaultOn",p="/icons/document_gray.svg",u={collection_view:"View",layout:"Layout",collection:"Collection",property:"Property",compound:"Compound",block:"Block",automation:"Automation"},f=Symbol("BuilderKey"),m=g({type:"property",id:o(970013).rn});function g(e){return(0,n().GV)(`${e.type}:${e.id}`,f)}function b(e){if("explicit-undefined"!==e)return e}function v(e){return void 0===e?"explicit-undefined":e}function I(e,t){var o;const a=g(t),u=null===(o=e.state.builderSettings)||void 0===o?void 0:o[a],f=S(e,t),m=f?function(e,t){const o={},a=e.templateRegistryMap.get(t);if(!a)return o;o.name=(0,r().getWorkflowTemplateName)(a),"property"!==a.type&&"collection_view"!==a.type&&"block"!==a.type&&(o.description=a.description);"property"===a.type&&(o.propertyOptionsType=a.propertyOptionsType,o.relatedCollectionTemplateId=a.relatedCollectionTemplateId);if("collection"===a.type){var i;o.hasMinimalOnboarding=null===(i=a.value.onboarding)||void 0===i?void 0:i.isMinimal,o.singularItemName=a.value.targetCollection.itemName.singular,o.pluralItemName=a.value.targetCollection.itemName.plural,o.category=a.category}if("collection"!==a.type&&e.sourceCollectionTemplate){const a=e.sourceCollectionTemplate.value.templateItems.find((e=>e.pointer===t));a?(o.optionality=a.optionality,o.isInSettings=a.isInSettings):o.includeInCollectionTemplate=!1}"compound"===a.type&&(o.icon=a.icon,o.templateItems=a.value.templateItems.map((t=>{const o=e.templateIdToBuilderKeyMap.get(t.pointer);if(o)return{pointer:o,optionality:t.optionality}})).filter(n().O9));return o}(e,e.state.createCopy&&t.templateId?t.templateId:f):{};return{templateId:f,isDeleted:(null==u?void 0:u.isDeleted)??"uninstantiated_template"===t.type,description:((null==u?void 0:u.description)??m.description)||void 0,category:(null==u?void 0:u.category)??m.category,optionality:(0,i().O)(t)?"required":(null==u?void 0:u.optionality)??m.optionality??l,hasMinimalOnboarding:(null==u?void 0:u.hasMinimalOnboarding)??m.hasMinimalOnboarding??!1,singularItemName:(null==u?void 0:u.singularItemName)??m.singularItemName??c,pluralItemName:(null==u?void 0:u.pluralItemName)??m.pluralItemName??d,isInSettings:(null==u?void 0:u.isInSettings)??m.isInSettings??!1,propertyOptionsType:(null==u?void 0:u.propertyOptionsType)??(null==m?void 0:m.propertyOptionsType)??s,includeInCollectionTemplate:(null==u?void 0:u.includeInCollectionTemplate)??(null==m?void 0:m.includeInCollectionTemplate)??!0,templateItems:(null==u?void 0:u.templateItems)??(null==m?void 0:m.templateItems)??[],name:(null==u?void 0:u.name)??(null==m?void 0:m.name)??t.name??("layout"===t.type?"Layout":""),icon:(null==u?void 0:u.icon)??(null==m?void 0:m.icon)??p,bypassCreateCopy:w(u,t),relatedCollectionTemplateId:(null==u?void 0:u.relatedCollectionTemplateId)??(null==m?void 0:m.relatedCollectionTemplateId),ignore:(null==u?void 0:u.ignore)??!!(0,i().NU)(t),shouldMapToTemplate:(null==u?void 0:u.shouldMapToTemplate)??!("collection_view"!==t.type||!t.defaultBuiltinTemplateIdToMapTo)}}function w(e,t){return void 0!==(null==e?void 0:e.bypassCreateCopy)?e.bypassCreateCopy:"property"===t.type&&"relation"===t.schema.type}function S(e,t){var o;const a=g(t),n=null===(o=e.state.builderSettings)||void 0===o?void 0:o[a],r=w(n,t),s=e.state.createCopy&&!r?void 0:t.templateId;if(void 0!==(null==n?void 0:n.templateId))return null==n?void 0:n.templateId;if(void 0!==s)return s;const c="collection"===t.type?"":`${S(e,e.collectionInfo)}.`;return(0,i().O)(t)?`${c}title${u.property}`:"collection_view"===t.type&&t.defaultBuiltinTemplateIdToMapTo&&!1!==(null==n?void 0:n.shouldMapToTemplate)?t.defaultBuiltinTemplateIdToMapTo:t.name&&"uninstantiated_template"!==t.type?c+(d=t.name,l=t.type,`${y(d)}${u[l]}`):"layout"===t.type?`${c}default${u.layout}`:"automation"===t.type?`${c}${t.referrerName}${u.automation}`:void 0;var d,l}function y(e){return(0,a().xQ)(e)}function h(e,t){let o,a,n,{includeType:r=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof t?(a=t,n=e.featureInfoMap.get(t)):(n=t,a=g(n)),n){const t=I(e,n);o=`${t.name||t.templateId}${r?` (${i=n,i.type.replace(/_/g," ")})`:""}`}var i;return o||a}},251582:(e,t,o)=>{o.d(t,{$d:()=>i,AZ:()=>s,p:()=>d});o(16280),o(944114),o(581454);var a=()=>o(496603),n=()=>o(973647);class r extends Error{constructor(e){super(e)}}function i(e,t){const o=Array.isArray(t)?t:[t],[,a]=e(o);return a.status?{value:a.value}:{error:a.error}}function s(e,t){const o=i(e,t);if(n().Q.isFail(o))throw o.error;return o.value}const c=Symbol("ManyTillEndSentinel"),d={try:e=>t=>{const[o,a]=e(t);return a.status?[o,a]:[t,a]},any:()=>e=>e.length>0?[e.slice(1),{status:!0,value:e[0]}]:[[],{status:!1,error:new r("Reached end of input")}],eof:e=>t=>0===t.length?[[],{status:!0,value:void 0}]:[t,{status:!1,error:(null==e?void 0:e(t[0]))??new r("Expected end of input")}],map:(e,t)=>o=>{const[a,n]=e(o);return[a,n.status?{status:!0,value:t(n.value)}:n]},mapResult:(e,t)=>o=>{const[a,r]=d.map(e,t)(o);return r.status?n().Q.isFail(r.value)?[a,{status:!1,error:r.value.error}]:[a,{status:!0,value:r.value.value}]:[a,r]},andThen:(e,t)=>o=>{const[a,n]=e(o);return n.status?t(n.value)(a):[a,n]},sequence:function(e){return t=>{const o=[];for(const a of e){const[e,n]=a(t);if(!n.status)return[e,n];o.push(n.value),t=e}return[t,{status:!0,value:o}]}},satisfy:function(e){return d.try((t=>{const[o,a]=d.any()(t);return a.status&&!e(a.value)?[o,{status:!1,error:new r("Failed predicate")}]:[o,a]}))},filter:function(e,t){return d.try((o=>{const[a,n]=e(o);return[a,n.status?t(n.value)?n:{status:!1,error:new r("Failed predicate")}:n]}))},literal:e=>d.describe(d.satisfy((t=>a().n4(t,e))),(()=>new r(`Expected: ${JSON.stringify(e)}.`))),describe:(e,t)=>o=>{const[a,n]=e(o);return[a,n.status?n:{status:!1,error:t()}]},constant:e=>t=>[t,{status:!0,value:e}],choice:e=>0===e.length?d.fail((()=>new r("No parsers to choose from"))):t=>{let o=e[0](t);for(const n of e.slice(1)){const[e,r]=o;if(r.status||!a().n4(e,t))return o;o=n(t)}return o},fail:e=>t=>[t,{status:!1,error:e(t)}],many:e=>t=>{const o=[];for(;;){const[a,n]=d.try(e)(t);if(!n.status)return[a,{status:!0,value:o}];o.push(n.value),t=a}},manyTill:(e,t)=>o=>{const a=[];for(;;){const[n,r]=d.choice([d.map(t,(()=>c)),d.try(e)])(o);if(!r.status)return[n,r];if(r.value===c)return[n,{status:!0,value:a}];a.push(r.value),o=n}},many1:e=>d.map(d.sequence([e,d.many(e)]),(e=>{let[t,o]=e;return[t,...o]})),sepBy:(e,t)=>d.choice([d.sepBy1(e,t),d.constant([])]),sepBy1:(e,t)=>d.andThen(e,(o=>d.map(d.many(d.map(d.sequence([t,e]),(e=>{let[,t]=e;return t}))),(e=>[o,...e])))),lazy:e=>d.andThen(d.constant(void 0),e),lookAhead:e=>t=>[t,e(t)[1]]}},253141:(e,t,o)=>{o.d(t,{Ls:()=>Q,mm:()=>B,my:()=>z,gv:()=>Z});o(16280),o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(581454);var a=()=>o(663077),n=()=>o(179034),r=()=>o(869558),i=()=>o(96689),s=()=>o(854150),c=()=>o(919709),d=()=>o(534177),l=()=>o(970330),p=()=>o(612008),u=()=>o(313209),f=()=>o(896628),m=()=>o(722101),g=()=>o(44729),b=()=>o(246826),v=()=>o(185544),I=()=>o(955930),w=()=>o(751156),S=()=>o(58415),y=()=>o(414360),h=()=>o(409902),_=()=>o(586481),T=()=>o(389658),k=()=>o(972435),C=()=>o(493260),R=()=>o(351360),A=()=>o(889097),P=()=>o(630116),M=()=>o(317053),D=()=>o(922952),N=()=>o(913454),O=()=>o(204067),U=()=>o(101926),x=(o(898992),o(354520),()=>o(27732)),E=()=>o(290966);function V(e){const{environment:t,transaction:o,collectionStore:n,template:r,targetCollectionStore:i,logger:s}=e,{value:c}=r,d=(0,U().ai)(e);if(!d)throw new Error(`relationPropertyPointer not created for ${r.templateId}`);if("property"!==d.type)throw new Error(`Instance pointer returned is not of property type: ${d.type}`);const l=new(A().A)(t);l.setContext({type:"collectionPage",collectionStore:n});const{inverseRelationPropertyId:p}=x().cT({environment:t,transaction:o,intl:k().A.getIntl(),collectionContextStore:l,collectionStore:n,property:d.id,targetCollectionStore:i,hasInverseRelation:!0,inverseName:void 0,propertyName:c.name,autoRelate:c.autoRelate,propertyLimit:1===c.limit?"1":"no_limit"});if(p){const e=function(e){let{environment:t,sourceCollectionStore:o,targetCollectionStore:n}=e;const r=(0,O().tY)({environment:t,collectionStore:o}),i=(0,O().tY)({environment:t,collectionStore:n});if(!r||!i)return;const s=(0,a().bQ)(i).map((e=>N().globalWorkflowTemplates.fromId(e))).filter((e=>(0,a().Sz)(e)));for(const a of s)if(a.relatedCollectionTemplateId===r.templateId)return a}({environment:t,sourceCollectionStore:n,targetCollectionStore:i});e&&(s.log(`Instantiating relation property template "${e.templateId}" because it is the inverse of "${r.templateId}".`),(0,E().ZQ)({transaction:o,collectionStore:i,templateId:e.templateId,instance:{type:"property",id:p,collectionId:i.id},logger:s}))}return d}var F=()=>o(839754);function B(e){var t;let{environment:o,transaction:n,template:i,parentStore:s,existingCollectionInfo:d,inMemoryRecordCache:m,selectedFeatureTemplateIds:g,collectionViewBlockType:v="collection_view_page",relationInfos:I,logger:w}=e;w.log(`Instantiating collection template "${i.templateId}".`);const{collectionStore:C,collectionViewBlockStore:x}=function(e){var t;let o,{environment:a,transaction:n,template:r,parentStore:i,existingCollectionInfo:s,collectionViewBlockType:d="collection_view_page",inMemoryRecordCache:l,logger:p}=e;if(!(0,D().u)(i))throw new Error(`Parent store is not a valid  collection template parent store ${i.table}`);if(s){const{collectionStore:e,collectionViewStore:t}=s;o=s.collectionViewBlockStore,t&&(0,y().T)({collectionViewBlockStore:o,collectionViewStore:t,transaction:n}),e&&(0,h().h)({collectionViewBlockStore:o,collectionStore:e,transaction:n})}else o=W({environment:a,transaction:n,parentStore:i,collectionViewBlockType:d,inMemoryRecordCache:l});const{name:u,icon:f,description:m}=r.value.targetCollection,g=(0,S().E)({environment:a,collectionViewBlockStore:o,transaction:n,collectionValue:{name:(0,c().x9d)(u),icon:f,description:m,format:{item_name_config:r.value.targetCollection.itemName,item_name_config_v2:null===(t=r.value.targetCollection.format)||void 0===t?void 0:t.item_name_config_v2},schema:{title:{name:k().A.formatMessage(T().n4.namePropertyTitle),type:"title"}}}});if(!R().default.state.currentSpaceStore)throw new Error("No current space store");return{collectionStore:g,collectionViewBlockStore:o}}({environment:o,transaction:n,template:i,parentStore:s,existingCollectionInfo:d,collectionViewBlockType:v,inMemoryRecordCache:m,logger:w});(0,E().ZQ)({transaction:n,collectionStore:C,templateId:i.templateId,instance:{type:"collection",id:C.id},logger:w});const{allFeatureTemplates:B,nonRelationPropertyTemplates:z}=function(e){let{template:t,selectedFeatureTemplateIds:o}=e;if(o){const e=new Set((0,a().bQ)(t));for(const a of o)if(!e.has(a))throw new Error(`Feature template ID ${a} is not part of collection template ${t.templateId}`)}const{templateItems:n}=t.value,r=(0,a().b2)(n,"required"),i=(0,a().b2)(n,"optionalDefaultOn"),s=new Set([...r,...o??i]),c=Array.from(s).map(N().globalWorkflowTemplates.featureFromId),d=[],l=[];for(const p of c)(0,a().Sz)(p)?d.push(p):l.push(p);return{allFeatureTemplates:c,relationPropertyTemplates:d,nonRelationPropertyTemplates:l}}({template:i,selectedFeatureTemplateIds:g}),Q=[];for(const a of z){const e=(0,U().e_)({environment:o,transaction:n,collectionStore:C,template:a,logger:w,origin:"collection_creation"});"collection_view"===(null==e?void 0:e.type)&&Q.push(e),(0,U().Ix)({environment:o,transaction:n,collectionStore:C,template:a,logger:w})}if(0===Q.length)throw new Error("No collection view templates to create");const L=P().pS.createChildStore(x,{table:r().Gy,id:Q[0].id});I&&function(e){let{environment:t,transaction:o,currentCollectionStore:a,relationInfos:n,logger:r}=e;for(const i of n){const{sourceCollectionStore:e,targetCollectionStore:n}=j({currentCollectionStore:a,relationInfo:i});V({environment:t,transaction:o,origin:"collection_creation",collectionStore:e,targetCollectionStore:n,template:i.relationPropertyTemplate,logger:r})}}({environment:o,transaction:n,currentCollectionStore:C,relationInfos:I,logger:w});const q=(0,N().getPropertyTemplates)(B);(0,F().My)({transaction:n,collectionStore:C,propertyTemplates:q}),(0,F().Bi)({transaction:n,collectionStore:C,propertyTemplates:q}),function(e){const{transaction:t,collectionStore:o,template:a,logger:n}=e,{format:r}=a.value.targetCollection;if("object"!=typeof(null==r?void 0:r.collection_default_template))return;const i=(0,O().fI)({collectionStore:o,sourceTemplateType:"block",dependencyMap:a.dependencyMap??{},sourcePrimitiveId:r.collection_default_template.template_page_id});i?f().zA({stores:[o],update:{collection_default_template:{template_page_id:i}},transaction:t}):n.warn("Unable to resolve collection default template, omitting it.")}({transaction:n,template:i,collectionStore:C,logger:w}),"tasks"===i.category&&(0,M().maybeAddAppTemplateMetadataForTasks)({environment:o,collectionStore:C,collectionViewBlockStore:x,transaction:n}),function(e){let{transaction:t,collectionViewBlockStore:o}=e;const a=o.getFormat();("workflow_template_placeholder"===a.collection_view_sub_type||a.placeholder_workflow_template_id)&&f().zA({stores:[o],update:{placeholder_workflow_template_id:void 0,collection_view_sub_type:void 0},transaction:t})}({transaction:n,collectionViewBlockStore:x});let $=[];return null!==(t=i.value.exampleRows)&&void 0!==t&&t.length&&($=function(e){let{environment:t,transaction:o,collectionStore:a,collectionViewStore:n,collectionViewBlockStore:r,exampleRows:i,dependencyMap:s}=e;const c=new(A().A)(t);c.setContext({type:"collectionView",collectionViewBlockStore:r,collectionStore:a,collectionViewStore:n,pageVisitSourceOverride:void 0});const d=[],l=c.defaultPageTemplateStore.state,{inMemoryRecordCache:f}=r;for(const m of i){const{newStore:e}=(0,p().Q)({environment:t,collectionContextStore:c,groupsPointer:[],insertAtIndex:0,shouldCoerce:!0,transaction:o,from:{createBlock:"workflow_template"},inMemoryRecordCache:f});d.push(e);const n=Z({collectionStore:a,dependencyMap:s,exampleRow:m});(0,_().L)({environment:t,store:e,properties:n.properties,transaction:o}),l&&u().n5({title:"template",environment:t,store:e,templateStore:l,isKeyboard:!1,isCreateIn:!1,transaction:o,from:"collection_template_actions"});const r=e.getIconStore();m.icon&&r&&b().KY({store:r,value:m.icon,transaction:o})}return d}({environment:o,transaction:n,collectionStore:C,collectionViewStore:L,collectionViewBlockStore:x,exampleRows:i.value.exampleRows,dependencyMap:i.dependencyMap??{}})),n.postSubmitCallbacks.push((e=>{e||l().v(o,{from:"workflow_template",type:x.getType()??"collection_view_page",creating_block_id:x.id,collection_view_block_id:x.id,collection_view_id:L.id,collection_id:C.id,view_type:L.getType()})})),{collectionStore:C,collectionViewStore:L,collectionViewBlockStore:x,examplePageStores:$}}async function z(e){const{environment:t,parentStore:o,title:a,onFinish:n}=e,{serverCommitResult:i,performResult:{collectionViewBlockStore:s,collectionViewStore:d,collectionStore:p}}=w().createAndCommit({userAction:"workflowTemplatesOnboardingModal.addEmptyDatabase",environment:t,canUndo:!0,perform:n=>{let i=e.collectionViewBlockStore;void 0===i&&(i=W({environment:t,transaction:n,parentStore:o,collectionViewBlockType:"collection_view_page",inMemoryRecordCache:o.inMemoryRecordCache}),l().v(t,{from:"workflow_template",type:"page",new_page_id:i.id,creating_block_id:i.id}));const s=(0,S().E)({environment:t,collectionViewBlockStore:i,transaction:n,collectionValue:{name:a?(0,c().x9d)(a):void 0,schema:{title:{name:k().A.formatMessage(T().n4.namePropertyTitle),type:"title"}}}}),d=b().eC({environment:t,table:r().Gy,inMemoryRecordCache:i.inMemoryRecordCache,value:{type:"table",parent_id:i.id,parent_table:i.table,space_id:i.getSpaceId(),format:{collection_pointer:s.pointer},alive:!0},transaction:n}),p=P().pS.createChildStore(i,d.pointer);return(0,C().F)(p.id,{viewType:"table",isPlaceholderCollection:!0}),m().BC({parentStore:i.getCollectionViewsStore(),appendStore:p,transaction:n}),{collectionViewBlockStore:i,collectionViewStore:p,collectionStore:s}}});return await i,n&&n(s),{collectionViewBlockStore:s,collectionViewStore:d,collectionStore:p}}function Z(e){let{exampleRow:t,dependencyMap:o,collectionStore:a}=e;const n={properties:{}};for(const[r,i]of Object.entries(t.properties))n.properties[(0,O().CB)({collectionStore:a,sourceTemplateType:"property",dependencyMap:o,sourcePrimitiveId:r})]=i;return n}function W(e){var t;let{environment:o,transaction:a,parentStore:n,collectionViewBlockType:r,inMemoryRecordCache:i}=e;const s=b().Wv({environment:o,type:r,inMemoryRecordCache:i,transaction:a});return b().zv({store:s,transaction:a,data:{parent_id:n.id,parent_table:n.table,alive:!0}}),Q({environment:o,spaceViewStore:null===(t=R().default.state.currentSpaceViewStore)||void 0===t?void 0:t.clone(i),parentStore:n,collectionViewBlockStore:s,transaction:a,appendOrPrepend:"append"}),s}function Q(e){let{environment:t,parentStore:o,collectionViewBlockStore:a,transaction:r,appendOrPrepend:c,spaceViewStore:l}=e;if(o.table===n().ev)g().NI({parentStore:o,childStore:a,transaction:r});else if(o.table===i().NX){if((null==l?void 0:l.getSpaceId())!==o.id)throw new Error(`spaceViewStore doesn't match parent with ID ${o.id}`);v().yM({environment:t,spaceStore:o,spaceViewStore:l,pageStore:a,isPrivate:!0,transaction:r})}else o.table===s().yK?I().sP({teamStore:o,store:a,transaction:r,location:{type:c}}):(0,d().HB)(o)}function j(e){let{currentCollectionStore:t,relationInfo:o}=e;const{type:a,collectionStore:n}=o;return"source"===a?{sourceCollectionStore:n,targetCollectionStore:t}:"target"===a?{sourceCollectionStore:t,targetCollectionStore:n}:void(0,d().HB)(a)}},285518:(e,t,o)=>{o.d(t,{R:()=>n});o(898992),o(354520),o(581454);var a=()=>o(496603);function n(e){return e&&e.isReady()?a().sb(e.getSpaceViewStores().filter((e=>e.getJoined())).map((e=>e.getSpaceId()))).length:void 0}},301782:(e,t,o)=>{o.d(t,{CM:()=>u,UB:()=>p,zc:()=>l});o(898992),o(354520),o(581454);var a=()=>o(890409),n=()=>o(973647),r=()=>o(534177),i=()=>o(862292),s=()=>o(989423),c=()=>o(909470),d=()=>o(546461);function l(e){const{automationActionStore:t,automationStore:o,formulaAnalyticsModule:i,formulasModule:s,simpleFormulasModule:l}=e,p=t.getModel(),u=o??t.getParentStore();if(!p||!u)return;const f=u.getActionStores().map((e=>e.getModel())).filter(r().O9),m=(0,d().To)(u);let g=[];return m&&n().Q.isSuccess(m)&&(g=m.value.valueTypes),(0,a()._f)({automationActionModel:p,automationActionModels:f,formulaAnalyticsModule:i,formulasModule:s,simpleFormulasModule:l,formulaTypecheckContextValues:g,getRecordModel:t.getRecordModel,featureGates:(0,c().i)()})}function p(e,t){const{automationStore:o,automationActionStore:a}=t;o.isTriggerType("event")||u(((t,n,r)=>{const i=l({automationActionStore:a,automationStore:o,formulaAnalyticsModule:n,formulasModule:t,simpleFormulasModule:r});i&&(0,s().pM)(e,"automation_action_update",a.id,1,{automation_action:i,automation_action_id:a.id,automation_id:o.id})}))}function u(e){return Promise.all([i().T.formulas.load(),i().T.formulaAnalytics.load(),i().T.simpleFormulas.load()]).then((t=>{let[o,a,n]=t;e(o,a,n)})).catch((e=>{console.error("Error sending analytics for automations",e)}))}},317053:(e,t,o)=>{o.r(t),o.d(t,{createCollectionTemplateFromModalState:()=>ae,createMinimalCollectionTemplateWithoutModal:()=>te,createPlaceholderWorkflowTemplateBlock:()=>ce,getSetupGeneratorForTemplate:()=>H,getTemplateOnboardingVersion:()=>G,handleSelectTemplateFromOnboardingModal:()=>Y,maybeAddAppTemplateMetadataForTasks:()=>ie,moveToNextOnboardingStep:()=>fe,moveToPreviousOnboardingStep:()=>ue,onNavigateToPlaceholderWorkflowTemplateBlock:()=>de,openSelectedTemplateOnboardingModalForInAppFlows:()=>X,openTemplateOnboardingModal:()=>K,retryAiSetup:()=>le,setFollowUpInputFocused:()=>pe,switchModalToTemplate:()=>ee,toggleFeatureSelectionInPreview:()=>se});o(16280),o(898992),o(354520),o(672577),o(581454);var a=()=>o(584262),n=()=>o(66689),r=()=>o(428045),i=()=>o(663077),s=()=>o(700500),c=()=>o(206267),d=()=>o(919709),l=()=>o(496603),p=()=>o(498212),u=()=>o(973647),f=()=>o(534177),m=()=>o(612008),g=()=>o(896628),b=()=>o(496414),v=()=>o(246826),I=()=>o(857783),w=()=>o(436572),S=()=>o(751156),y=()=>o(586481),h=()=>o(211716),_=()=>o(972435),T=()=>o(154152),k=(o(18107),o(410838),o(813451),o(967357),o(737550),()=>o(155792)),C=()=>o(449412),R=()=>o(989423),A=()=>o(594794),P=()=>o(349379);o(944114);class M{constructor(){this.root=new D}append(e){if(this.root.isEmpty())this.root.addChild(e);else{const t=this.toNodes().at(-1);if(!t)throw new Error("Last node not found");t.addChild(e)}}toNodes(){return this.root.getSelectedPath()}toValues(){return this.toNodes().map((e=>e.value))}removeLast(){const e=this.toNodes().at(-1);if(!e)return;const t=e.value;return e.remove(),t}removeLastMatching(e){const t=this.toNodes().findLastIndex((t=>e(t.value)));if(-1===t)return[];const o=[];for(;this.toNodes().length>t;){const e=this.removeLast();void 0!==e&&o.push(e)}return o}}class D{constructor(){this.children=[],this.selectedChild=void 0}addChild(e){const t=new N(e,this);return this.children.push(t),this.selectedChild=t,t}getSelectedPath(){var e;return(null===(e=this.selectedChild)||void 0===e?void 0:e.toSelectedPath())??[]}isEmpty(){return 0===this.children.length}getChildren(){return this.children}setSelectedChild(e){if(!this.children.includes(e))throw new Error("Cannot select a node that is not a child");this.selectedChild=e}removeChild(e){const t=this.children.indexOf(e);-1!==t&&(this.children.splice(t,1),this.selectedChild===e&&(this.selectedChild=void 0))}}class N{constructor(e,t){this.value=void 0,this.children=[],this.selectedChild=void 0,this.parent=void 0,this.isRemoved=!1,this.value=e,this.parent=t}addChild(e){const t=new N(e,this);return this.children.push(t),this.selectedChild=t,t}toSelectedPath(){const e=[this];return this.selectedChild&&e.push(...this.selectedChild.toSelectedPath()),e}retry(e){if(this.isRemoved)throw new Error("Cannot retry on a removed node");this.parent.addChild(e)}select(e){if(this.isRemoved)throw new Error("Cannot select on a removed node");const t=this.parent.getChildren(),o=e(t.map((e=>e.value)),this.value);if(void 0===o)return!1;const a=t.find((e=>e.value===o));return a?this.parent.setSelectedChild(a):this.parent.addChild(o),!0}selectOrRetry(e){if(!this.select(e)){const t=e([],void 0);void 0!==t&&this.retry(t)}}remove(){if(this.children.length>0)throw new Error("Cannot remove a node that has children");if(this.isRemoved)throw new Error("Node is already removed");this.parent.removeChild(this),this.isRemoved=!0}getChildren(){return this.children}setSelectedChild(e){if(!this.children.includes(e))throw new Error("Cannot select a node that is not a child");this.selectedChild=e}removeChild(e){const t=this.children.indexOf(e);-1!==t&&(this.children.splice(t,1),this.selectedChild===e&&(this.selectedChild=void 0),e.isRemoved=!0)}}class O extends(()=>o(757695))().default{getInitialState(){return{isBusy:!1,transcriptTree:new M}}setPrompt(e){this.setState({...this.state,prompt:e})}}class U{constructor(e){this.environment=void 0,this.generatedSetupCount=0,this.store=void 0,this.error=void 0,this.spaceId=void 0,this.eventBase=void 0,this.abortController=void 0,this.onSetupReady=void 0,this.setPrompt=e=>{this.store.setState({...this.store.state,prompt:e})},this.submitPrompt=async e=>{var t;const{from:a}=e,n="follow-up"===a,{isBusy:r,prompt:i}=this.store.state;if(r||!i)return!1;if(!this.spaceId)return!1;this.store.setState({...this.store.state,isBusy:!0}),null===(t=this.store.state.transcriptTree.toNodes().find((e=>"config"===e.value.type)))||void 0===t||t.selectOrRetry((e=>{const t=e.find((e=>"config"===e.type&&"setup-generator"===e.value.type));return t||{id:(0,A().Z1)({environment:this.environment,table:k().mS,spaceId:this.spaceId}),type:"config",value:{type:"setup-generator"}}}));try{var s;const e=this.store.state.transcriptTree.toNodes().find((e=>"user"===e.value.type));if(e&&!n)e.selectOrRetry((e=>{const t=e.find((e=>"user"===e.type&&(0,d().MTk)(i,e.value)));if(t)return t;{var o;const e=null===(o=this.environment.currentUser)||void 0===o?void 0:o.id;if(!e)throw new Error("Current user not found");return{id:(0,A().Z1)({environment:this.environment,table:k().mS,spaceId:this.spaceId}),type:"user",value:i,userId:e}}}));else{var c;const e=null===(c=this.environment.currentUser)||void 0===c?void 0:c.id;if(!e)throw new Error("Current user not found");this.store.state.transcriptTree.append({id:(0,A().Z1)({environment:this.environment,table:k().mS,spaceId:this.spaceId}),type:"user",value:i,userId:e})}const t=this.store.state.transcriptTree.toValues();if(!t.slice(t.findLastIndex((e=>"user"===e.type))+1).some((e=>"setup"===e.type))){const e=(0,p().Ay)(),a=new AbortController;this.abortController=a;let n=!1;try{const r=await(0,o(182865).gj)({environment:this.environment,abortSignal:a.signal,data:{traceId:e,generateTitle:!1,transcript:t,spaceId:this.spaceId},onResponse:e=>{"setup-operations"===e.type&&this.store.setState({...this.store.state,progress:e.progress}),"retry"!==e.type||n||(n=!0,w().D6({label:"This is taking a little longer than usual"}))}});if(this.abortController=void 0,this.store.setState({...this.store.state,progress:void 0,feedbackArgs:this.computeFeedbackArgs()}),!u().Q.isSuccess(r))return C().O8(r.error,{from:"fullPageTranslationActions.generateAndApplyTranslationMapToPage",type:"error"}),this.onSetupReady({error:r.error}),!1;const i=function(e){const t=new Map;for(const o of e){const e="string"==typeof o.id?o.id:String(o.id),a=t.get(e);a&&"setup-operations"===a.type&&"setup-operations"===o.type?t.set(e,{...a,operations:[...a.operations,...o.operations]}):t.set(e,o)}return Array.from(t.values())}(r.value.filter(o(592933).Vf));for(const e of i)this.store.state.transcriptTree.append(e)}finally{this.abortController=void 0}}const a=null===(s=this.store.state.transcriptTree.toValues().findLast((e=>"setup"===e.type)))||void 0===s?void 0:s.setup;if(!a)throw new Error("Missing setup step");return this.generatedSetupCount++,this.store.setState({...this.store.state,setup:a,prompt:void 0}),this.trackGeneratedSetup(a),this.onSetupReady({value:a}),!0}catch(l){return l instanceof Error&&"AbortError"===l.name||(C().O8(l,{from:"setupGenerator.submitPrompt",type:"error"}),this.onSetupReady({error:{code:500,message:"Unknown error"}})),!1}finally{this.store.setState({...this.store.state,isBusy:!1,feedbackArgs:this.computeFeedbackArgs()})}},this.stopGenerating=()=>{var e;null===(e=this.abortController)||void 0===e||e.abort()},this.discardLatestSetup=()=>{var e,t;const o=null===(e=this.store.state.transcriptTree.toValues().findLast((e=>"user"===e.type)))||void 0===e?void 0:e.value;if(!o)return;this.store.state.transcriptTree.removeLastMatching((e=>"user"===e.type));const a=null===(t=this.store.state.transcriptTree.toValues().findLast((e=>"setup"===e.type)))||void 0===t?void 0:t.setup;this.store.setState({...this.store.state,prompt:o,setup:a,feedbackArgs:this.computeFeedbackArgs()}),a&&this.onSetupReady({value:a}),(0,R().u4)({environment:this.environment,event:{eventName:"setup_generator_try_again_clicked",eventProperties:this.eventBase}})};const{environment:t,spaceId:a,onSetupReady:n,initialPrompt:r,analyticsArgs:i}=e;if(this.environment=t,this.spaceId=a,this.eventBase={flow_id:i.workflowTemplatesFlowId??(0,p().Ay)(),origin:i.origin,has_selection_modal_search_query:i.hadSelectionModalSearchEntered},this.store=new O,this.store.state.transcriptTree.append({id:(0,A().Z1)({environment:t,table:k().mS,spaceId:a}),type:"config",value:{type:"setup-generator"}}),r){var s;this.store.setState({...this.store.state,prompt:r});const e=null===(s=this.environment.currentUser)||void 0===s?void 0:s.id;e&&this.store.state.transcriptTree.append({id:(0,A().Z1)({environment:t,table:k().mS,spaceId:a}),type:"user",value:r,userId:e})}this.onSetupReady=n}computeFeedbackArgs(){const{setup:e}=this.store.state,t=null==e?void 0:e.metadata.setupId;if(t&&this.store.state.transcriptTree)return{spaceId:this.spaceId,traceId:t,transcript:this.store.state.transcriptTree.toValues()}}discardAllSetups(){var e;if(!this.store.state.transcriptTree)return;const t=this.store.state.transcriptTree.toNodes().findIndex((e=>"user"===e.value.type));if(-1===t)return;const o=this.store.state.transcriptTree.toValues().at(t);if(!o||"user"!==o.type)return;for(;this.store.state.transcriptTree.toNodes().length>t;)this.store.state.transcriptTree.removeLast();const a=null===(e=this.store.state.transcriptTree.toValues().findLast((e=>"setup"===e.type)))||void 0===e?void 0:e.setup;this.store.setState({...this.store.state,prompt:o.value,setup:a,feedbackArgs:this.computeFeedbackArgs()}),a&&this.onSetupReady({value:a})}trackSessionStarted(){(0,P().Vd)({environment:this.environment,eventProperties:this.eventBase})}trackSessionEnded(e){const{reason:t}=e;(0,R().u4)({environment:this.environment,event:{eventName:"setup_generator_session_ended",eventProperties:{...this.eventBase,generated_setup_count:this.generatedSetupCount,reason:t}}})}trackGeneratedSetup(e){const{metadata:t}=e,{setupId:o,promptInfo:a}=t,n=e.allTemplates.filter((e=>(0,i().Xq)(e,"collection"))).length,r=e.allTemplates.filter((e=>(0,i().Xq)(e,"collection_view"))).length,s=e.allTemplates.filter((e=>(0,i().Xq)(e,"property"))).length;(0,P().If)({environment:this.environment,eventProperties:{...this.eventBase,setup_id:o,prompt_type:"custom",collection_count:n,collection_view_count:r,property_count:s,total_duration_ms:e.metadata.timing.total,warning_count:e.metadata.warnings.length,error_count:e.metadata.errors.length,use_case:null==a?void 0:a.useCase,prompt_specificity:null==a?void 0:a.specificity,prompt_language:null==a?void 0:a.language}})}}var x=()=>o(889097),E=()=>o(630116),V=()=>o(46986),F=()=>o(973891),B=()=>o(253141),z=()=>o(101926),Z=()=>o(922952),W=()=>o(913454);function Q(e){let{environment:t,parentStore:o,collectionTemplate:a}=e;if(!o.getSpaceId())throw new Error(`Space ID not found for ${o}`);const n=(0,i().bQ)(a).map((e=>W().globalWorkflowTemplates.fromId(e))).filter((e=>(0,i().Sz)(e))),r=[];for(const i of n){const{relatedCollectionTemplateId:e}=i,a=(0,W().getChildCollectionStoreByTemplateId)({environment:t,parentStore:o,collectionTemplateId:e});a&&r.push({type:"target",collectionStore:a,relationPropertyTemplate:i})}return r}var j=()=>o(204067),L=()=>o(605315),q=()=>o(896326),$=()=>o(458097);function K(e){let{template:t,parentStore:o,origin:a,version:n,existingCollectionInfo:r,relationInfos:i,navigateToOnFinish:s="created_collection",setupGenerator:c,flowId:d,onClose:l}=e;const p=t?(0,q().C8)({collectionTemplate:t,origin:a,flowId:d,parentStore:o}):(0,q().XM)({origin:a,flowId:d,parentStore:o});F().T_(),$().A.setState({open:!0,isSaving:!1,currentStepIndex:0,version:n,existingCollectionInfo:r,relationInfos:i??[],navigateToOnFinish:s,setupGenerator:c,onClose:l,...p,parentStore:o})}function G(e){if(!e.template)return"select_and_customize_template";const{includeTemplateSelectionStep:t,hasSetupGenerator:o}=e;return o?t?"select_and_build_with_ai":"build_with_ai":t?"select_and_customize_template":"customize_template"}const J=(0,o(959013).YK)({setupGenerationError:{id:"setupGenerator.error.failedToGenerateSetup",defaultMessage:"Sorry, something went wrong while completing this request. Please try again."},setupGenerationRateLimitError:{id:"setupGenerator.error.rateLimited",defaultMessage:"Too many requests. Please try again later."}});function H(e){let{environment:t,parentStore:o,template:a,initialAiPrompt:n,analyticsArgs:r,isForInAppFlows:s}=e;const c=null==o?void 0:o.getSpaceId(),d=(0,i().cB)(a.templateId)?new U({environment:t,analyticsArgs:r,spaceId:c,initialPrompt:n,onSetupReady:e=>{const t=$().A.state;if(!t.open)return;if(u().Q.isFail(e))return void(429===e.error.code?w().D6({label:_().A.formatMessage(J.setupGenerationRateLimitError)}):w().D6({label:_().A.formatMessage(J.setupGenerationError)}));const o=e.value;if(t.setupGenerator!==d)return;L().Z.append(o.allTemplates.filter((e=>e.isAiGenerated)));const a=o.allTemplates.find((e=>(0,i().Xq)(e,"collection")));if(!a)throw new Error("No collection template found");ee(a)}}):void 0;return d}function X(e){var t;let{template:o,environment:a,aiPrompt:n,autoSubmit:r=!1,version:i,...s}=e;const{parentStore:c,relationInfos:d,origin:u,flowId:f=(0,p().Ay)()}=s,m=a.device.isPhone,g=Q({environment:a,parentStore:c,collectionTemplate:o}),b=H({environment:a,template:o,parentStore:c,initialAiPrompt:n,analyticsArgs:{origin:u,hadSelectionModalSearchEntered:((null===(t=s.collectionTemplatesSearchQuery)||void 0===t?void 0:t.length)??0)>0,workflowTemplatesFlowId:f},isForInAppFlows:!0});K({...s,template:o,flowId:f,version:i??G({template:o,includeTemplateSelectionStep:!1,hasSetupGenerator:Boolean(b)}),relationInfos:l().hS([...d??[],...g],(e=>e.collectionStore.id)),setupGenerator:b}),b&&r&&(0,T().z)({setupGenerator:b,environment:a,parentStore:c,allowNavigateToAppBuilder:"new_user_onboarding"!==u&&"ai_chat"!==u,isPhone:m})}function Y(e){var t,o;let{template:a,environment:n,analyticsArgs:s}=e;const c=$().A.state;if(!c.open||!c.parentStore)return;const{parentStore:p,relationInfos:u,origin:f,flowId:m}=c,g=n.device.isPhone,b=c.collectionTemplatesSearchQuery?(0,d().x9d)(c.collectionTemplatesSearchQuery):void 0;if((0,V().Yf)({environment:n})&&(0,i().cB)(a.templateId)&&b&&"new_user_onboarding"!==f)return void(0,T().y)({environment:n,parentStore:p,prompt:b});const v=Q({environment:n,parentStore:p,collectionTemplate:a}),I=l().hS([...u??[],...v],(e=>e.collectionStore.id)),w=H({environment:n,template:a,parentStore:p,analyticsArgs:{origin:f,hadSelectionModalSearchEntered:((null===(t=c.collectionTemplatesSearchQuery)||void 0===t?void 0:t.length)??0)>0,workflowTemplatesFlowId:m},initialAiPrompt:b,isForInAppFlows:!0}),S=G({template:a,includeTemplateSelectionStep:!0,hasSetupGenerator:Boolean(w)}),y={...c,open:!0,isSaving:!1,currentStepIndex:(0,q().aO)(c,g),version:S,relationInfos:I??[],setupGenerator:c.setupGenerator??H({environment:n,template:W().globalWorkflowTemplates.fromIdOfType({templateId:r().MH,type:"collection"}),parentStore:c.parentStore,initialAiPrompt:[[""]],analyticsArgs:{origin:c.origin,workflowTemplatesFlowId:c.flowId,hadSelectionModalSearchEntered:!1},isForInAppFlows:!0}),isFollowUpInputFocused:!1,...(0,q().C8)({collectionTemplate:a,origin:f,flowId:m,parentStore:p}),parentStore:c.parentStore};null!==(o=a.value.onboarding)&&void 0!==o&&o.isMinimal?ae({environment:n,modalState:y}):("suggested_template"===s.type&&(0,P().os)({environment:n,eventProperties:{from_modal_template_picker:!0,selected_index:s.allOrderedTemplateIds.indexOf(a.templateId),collection_template_ids_shown:s.allOrderedTemplateIds,...(0,q().gM)({origin:f,parentStore:p,collectionTemplatesSearchQuery:c.collectionTemplatesSearchQuery,flowId:m,collectionTemplate:a})}}),$().A.setState(y))}function ee(e){const t=$().A.state;if(!t.open||!t.collectionTemplate||!t.parentStore)return;let o={...t,...(0,q().C8)({collectionTemplate:e,origin:t.origin,flowId:t.flowId,parentStore:t.parentStore}),parentStore:t.parentStore,isSaving:!1};if(t.collectionTemplate.templateId===e.templateId){var a;const e=o.userCustomizations.featureTemplateSelections,n=t.userCustomizations.featureTemplateSelections,r=e.map((e=>{const t=n.find((t=>t.template.templateId===e.template.templateId));return"required"!==e.optionality&&t?{...e,selected:t.selected}:e}));o={...o,userCustomizations:{...o.userCustomizations,featureTemplateSelections:r,prevFeatureTemplateSelections:e},previewCollectionInfo:{collectionViewBlockStore:void 0,collectionContextStore:void 0,examplePageStores:void 0,focusViewTemplateId:null===(a=t.previewCollectionInfo)||void 0===a||null===(a=a.collectionContextStore)||void 0===a||null===(a=a.collectionViewStore())||void 0===a||null===(a=a.getFormat().workflow_template_instance)||void 0===a?void 0:a.template_id}}}$().A.setState(o)}function te(e){let{environment:t,template:o,parentStore:a,existingCollectionInfo:n,relationInfos:r}=e;S().createAndCommit({userAction:"workflowTemplates.createMinimalCollectionTemplate",environment:t,canUndo:!0,perform:e=>{(0,B().mm)({environment:t,transaction:e,template:o,parentStore:a,existingCollectionInfo:n,inMemoryRecordCache:a.inMemoryRecordCache,relationInfos:r,logger:new(W().WorkflowTemplateLogger)})}})}function oe(e){var t;let{environment:o,modalState:n,collectionViewBlockStore:r,collectionStore:i,examplePageStores:s}=e;if(!i)return;(0,z().xN)({environment:o,collectionStore:i});const{existingCollectionInfo:c,userCustomizations:d,navigateToOnFinish:l}=n,p=(0,q().gM)(n);!function(e){let{environment:t,eventProperties:o,collectionViewBlockStore:n,examplePageStores:r,navigateTo:i,result:s}=e;if("created_collection"===i)I().uK({environment:t,store:n,visitType:h().ig.Link,pageVisitSource:a().y8.WorkflowTemplateOnboarding,redirect:!0,callback:()=>{F().yQ({examplePageStores:r,collectionViewBlockStore:n,eventProperties:o})}});else if("skip"===i){var c;null!==(c=n.getModel())&&void 0!==c&&c.isFullPageCollectionView()&&F().yQ({examplePageStores:r,collectionViewBlockStore:n,eventProperties:o})}else(0,f().HB)(i);const d=$().A.getState();!d.open&&d.isShowingLoadingState&&b().V();$().A.close(s)}({environment:o,eventProperties:p,collectionViewBlockStore:r,examplePageStores:s,navigateTo:l,result:{type:"accepted_template",blockId:r.id,collectionId:i.id}}),(0,P().g2)({environment:o,modalState:n,eventProperties:{record_titles_is_empty:d.recordTitles.map((e=>0===e.length)),selected_feature_template_ids:d.featureTemplateSelections.filter((e=>"required"!==e.optionality&&e.selected)).map((e=>e.template.templateId)),step:(0,q().hq)(n),target_page_ids:[r.id],collection_ids:[i.id],example_page_ids:s.map((e=>e.id)),existing_block_id:null==c||null===(t=c.collectionViewBlockStore)||void 0===t?void 0:t.id,...p}})}function ae(e){let{environment:t,modalState:o}=e;if(!o.collectionTemplate||o.isSaving||!o.parentStore)return;const{collectionTemplate:a,parentStore:n,existingCollectionInfo:r,relationInfos:i,userCustomizations:s}=o;$().A.setState({...o,isSaving:!0});const{performResult:c}=S().createAndCommit({userAction:"WorkflowTemplatesOnboardingModal.getStarted",environment:t,canUndo:!0,perform:e=>{const{collectionStore:o,collectionViewStore:c,collectionViewBlockStore:d,examplePageStores:l}=(0,B().mm)({environment:t,transaction:e,template:a,parentStore:n,existingCollectionInfo:r,inMemoryRecordCache:n.inMemoryRecordCache,selectedFeatureTemplateIds:(0,W().getSelectedFeatureTemplateIds)(s),relationInfos:i,logger:new(W().WorkflowTemplateLogger)});return function(e){let{environment:t,transaction:o,collectionStore:a,collectionViewStore:n,collectionViewBlockStore:r,recordTitles:i}=e;const s=new(x().A)(t);s.setContext({type:"collectionView",collectionViewBlockStore:r,collectionStore:a,collectionViewStore:n,pageVisitSourceOverride:void 0});const c=i.filter((e=>e.length>0));for(const d of c)ne({environment:t,transaction:o,collectionContextStore:s,title:d})}({environment:t,transaction:e,collectionStore:o,collectionViewStore:c,collectionViewBlockStore:d,recordTitles:s.recordTitles}),{collectionViewBlockStore:d,collectionStore:o,examplePageStores:l}}});return oe({environment:t,modalState:o,collectionViewBlockStore:c.collectionViewBlockStore,collectionStore:c.collectionStore,examplePageStores:c.examplePageStores}),c}function ne(e){let{environment:t,transaction:o,collectionContextStore:a,title:n}=e;const{newStore:r}=(0,m().Q)({environment:t,collectionContextStore:a,groupsPointer:[],insertAtIndex:0,shouldCoerce:!0,templateStore:a.defaultPageTemplateStore.state,transaction:o,from:{createBlock:"workflow_template"},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache}),i=[n];return(0,y().L)({environment:t,store:r,properties:{title:[i]},transaction:o}),r}const re={assigneeProperty:"notion://tasks/assign_property",statusProperty:"notion://tasks/status_property",dueDateProperty:"notion://tasks/due_date_property"};function ie(e){let{environment:t,transaction:o,collectionStore:a,collectionViewBlockStore:r}=e;const i=n().dC,s=n().d0,d=(0,j().Sl)({environment:t,collectionStore:a}),l={};for(const[n,c]of Object.entries(re)){const e=d.find((e=>e.templateId.includes(n)));if(!e)return;l[c]=e.instancePointer.id}g().zA({stores:[a],update:{app_config_uri:i,app_uri_map:l},transaction:o}),g().zA({stores:[r],update:{app_id:c().JW(),app_config_uri:s,app_uri_map:{[i]:a.id,[s]:r.id}},transaction:o})}function se(e){let{template:t,environment:o}=e;const a=$().A.state;a.open&&a.collectionTemplate&&$().A.setState({...a,userCustomizations:(0,q().Ll)({userCustomizations:a.userCustomizations,templateId:t.templateId})})}function ce(e){let{environment:t,transaction:o,parentStore:a,collectionTemplate:n,spaceViewStore:r}=e;const i=v().Wv({environment:t,type:s().xd.collectionViewPage,spaceId:a.getSpaceId(),format:{collection_view_sub_type:"workflow_template_placeholder",placeholder_workflow_template_id:n.templateId,page_icon:n.value.targetCollection.icon},properties:{title:(0,d().x9d)(n.value.targetCollection.name)},inMemoryRecordCache:a.inMemoryRecordCache,transaction:o});v().zv({store:i,data:{parent_id:a.id,parent_table:a.table,alive:!0},transaction:o});const c=E().Bv.createChildStore(a,i.pointer);return(0,B().Ls)({environment:t,parentStore:a,collectionViewBlockStore:c,transaction:o,appendOrPrepend:"append",spaceViewStore:r}),c}function de(e){let{environment:t,collectionTemplate:o,collectionViewBlockStore:n}=e;const r=n.getParentStore(),i=r&&(0,Z().u)(r)?r:n;if(t.device.isMobile)return te({environment:t,template:o,parentStore:i,existingCollectionInfo:{collectionViewBlockStore:n,collectionStore:void 0,collectionViewStore:void 0},relationInfos:[]}),I().uK({environment:t,store:n,visitType:h().ig.Link,pageVisitSource:a().y8.WorkflowTemplateOnboarding}),{didOpenOnboardingModal:!1};const s="placeholder_block",c=(0,q().gM)((0,q().C8)({collectionTemplate:o,origin:s,flowId:void 0,parentStore:i}));return(0,P().os)({environment:t,eventProperties:{...c,from_modal_template_picker:!1,selected_index:0,collection_template_ids_shown:[o.templateId]}}),X({environment:t,template:o,origin:s,parentStore:i,aiPrompt:void 0,flowId:c.flow_id,existingCollectionInfo:{collectionViewBlockStore:n,collectionStore:void 0,collectionViewStore:void 0}}),{didOpenOnboardingModal:!0}}function le(e){const t=$().A.state;if(!t.open)return;const o=t.setupGenerator;o&&(o.discardLatestSetup(),void 0===o.store.state.setup&&ue(e))}function pe(e){const t=$().A.state;t.open&&$().A.setState({...t,isFollowUpInputFocused:e})}function ue(e){const t=$().A.state;if(!t.open)return;const o=(0,q().Wm)(t),a=(0,q().gP)(t,e),n=o[a];if(a>=0){var i,s;if("setupGeneratorInput"===n||"templateSelection"===n)null==t||null===(i=t.setupGenerator)||void 0===i||i.discardAllSetups(),null==t||null===(s=t.setupGenerator)||void 0===s||s.stopGenerating();const e={...t,isFollowUpInputFocused:!1,currentStepIndex:a};"templateSelection"===n&&(e.collectionTemplate=r().XK,"land_on_app_from_new_user_onboarding"===t.origin&&(e.version="new_user_template_onboarding")),$().A.setState(e)}}function fe(e){const t=$().A.state;if(!t.open)return;const o=(0,q().aO)(t,e);o>=0&&$().A.setState({...t,isFollowUpInputFocused:!1,currentStepIndex:o})}},322920:(e,t,o)=>{o.r(t),o.d(t,{getContextualizedOnboardingFlowName:()=>i,getMobileTutorialStages:()=>s});var a=()=>o(820103),n=()=>o(47373),r=()=>o(71666);function i(e,t){for(const o of a().uL){if(r().onboardingFlowNameToFlowConfig[o].shouldShowFlowToUser(e,t))return o}return a().JT}function s(e){switch((0,n().DV)({environment:e})){case"v1":return["mobile_onboarding_home","mobile_onboarding_creation","mobile_onboarding_share","mobile_onboarding_multi_platform"];case"v2":return["mobile_onboarding_home","mobile_onboarding_creation","mobile_onboarding_share"];case"v3":return["mobile_onboarding_skill_mab","mobile_onboarding_skill_filing","mobile_onboarding_skill_swipe"];default:return["mobile_onboarding_editor","mobile_onboarding_sidebar","mobile_onboarding_desktop","mobile_onboarding_web_clipper","mobile_onboarding_app_download"]}}},323063:(e,t,o)=>{o.d(t,{HO:()=>f,V5:()=>c,Vr:()=>d,ef:()=>u,gL:()=>l,ng:()=>b,vH:()=>p,vk:()=>g,z2:()=>m});o(16280),o(269479),o(898992),o(354520),o(672577),o(581454),o(737550);var a=()=>o(720665),n=()=>o(762433),r=()=>o(47273),i=()=>o(622963),s=()=>o(979340);function c(e,t){return f(e.items,t.items).some((e=>{let[t,o]=e;return function(e,t){if(!e)return!1;if(!t)return!0;const o=n().xp(e),a=n().xp(t);if(!o||!a)return!1;return s().o3[o]>s().o3[a]}(t,o)}))}function d(e,t,o){let{trialEnd:a,items:n}=t;return{trialEnd:a,items:n.map((t=>{const a=t.price.product,n=t.price.unitAmount.currencyCode,r=g(e,{interval:o,product:a,currency:n});return{...t,price:r}}))}}function l(e,t){const o=e.items.filter((e=>n().IE(e)!==t));return{...e,items:o}}function p(e,t,o){const{isMay13PackagingChangesEnabled:a}=o,r=n().IE(t),i=t.price.product,s=e.items.filter((e=>{const t=e.price.product,o=n().IE(e);return!(r===o)&&!(a&&"ai"===t&&("business"===i||"enterprise"===i))}));return{...e,items:s.concat([t])}}function u(e){const{state:t,prices:o,quantities:a,params:{interval:r,currency:i},products:s,flags:{isMay13PackagingChangesEnabled:c}}=e,d=s.map((e=>function(e){if("personal_free"===e||"team_free"===e)return"free";return e}(e))),l=d.map((e=>n().Mr(e))),p=t.items.filter((e=>{const t=e.price.product,o=n().IE(e),a=l.includes(o),r=c&&"ai"===t&&(d.includes("business")||d.includes("enterprise"));return!a&&!r})),u=d.map((e=>b(g(o,{interval:r,currency:i,product:e}),a)));return{...t,items:p.concat(u)}}function f(e,t){return(0,a().Z4)(e,(e=>n().IE(e)),t,(e=>n().IE(e)))}function m(e){const{prices:t,billingData:o,product:a}=e,i=n().Ry(o),s=n().lQ(o),c=r().yw(s),d=n().q8(o),l=c??d;return t.find((e=>e.product===a&&e.billingInterval===l&&e.unitAmount.currencyCode===i))}function g(e,t){let{interval:o,product:a,currency:n}=t;return function(e,t){if(null==e)throw new Error(t);return e}(e.find((e=>e.product===a&&e.billingInterval===o&&e.unitAmount.currencyCode===n)),`Unable to find price with interval: ${o}, product: ${a}, currency: ${n}`)}function b(e,t){const{numSeats:o,numCustomHostnames:a}=t;return"public_domain_custom_hostnames"===(0,i().vK)(e.product)?{price:e,quantity:a}:{price:e,quantity:o}}},324587:(e,t,o)=>{o.r(t),o.d(t,{addAutomationAction:()=>z,clearInvalidVariables:()=>q,createAutomation:()=>B,deleteAutomation:()=>X,disableAutomation:()=>H,duplicateAutomation:()=>W,duplicateAutomationAction:()=>Q,enableAutomation:()=>J,insertEmptyTextInDuplicateBlockAction:()=>G,messages:()=>F,removeAutomationAction:()=>L,reorderAutomationActions:()=>j,restartAutomation:()=>Z});o(16280),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577),o(803949),o(581454);var a=o.n(o(794148)),n=()=>o(244641),r=()=>o(908006),i=()=>o(422540),s=()=>o(890409),c=()=>o(192845),d=()=>o(390527),l=()=>o(522328),p=()=>o(433519),u=()=>o(247331),f=()=>o(134025),m=()=>o(696706),g=()=>o(912720),b=()=>o(199378),v=()=>o(161479),I=()=>o(919709),w=()=>o(496603),S=()=>o(183558),y=()=>o(973647),h=()=>o(534177),_=()=>o(722101),T=()=>o(44729),k=()=>o(246826),C=()=>o(725614),R=()=>o(751156),A=()=>o(780054),P=()=>o(183324),M=()=>o(989423),D=()=>o(909470),N=()=>o(594794),O=()=>o(695625),U=()=>o(546461),x=()=>o(301782),E=()=>o(770586),V=()=>o(190019);const F=(0,o(959013).YK)({genericErrorMessage:{id:"automations.buttonTrigger.genericErrorMessage",defaultMessage:"Button failed to execute"},open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"},defaultConfirmationWorkflowText:{defaultMessage:"Are you sure you want to continue?",id:"automations.buttonTrigger.defaultConfirmationWorkflowText"},defaultContinueWorkflowMessage:{defaultMessage:"Continue",id:"automations.buttonTrigger.defaultContinueWorkflowMessage"},defaultStopWorkflowMessage:{defaultMessage:"Cancel",id:"automations.buttonTrigger.defaultStopWorkflowMessage"},errorQueryCollectionTooManyPages:{defaultMessage:"Button impacts too many pages",id:"automations.buttonTrigger.errorQueryCollectionTooManyPages"},errorRecordInTrash:{id:"automations.buttonTrigger.errorRecordInTrash",defaultMessage:"Button is editing a page in trash"}});function B(e){const{actionIds:t,automationId:o,automationName:n,environment:r,inMemoryRecordCache:i,parentPointer:s,transaction:c,trigger:d}=e,l=o??(0,N().Z1)({environment:r,table:g().yB,spaceId:s.spaceId}),p=k().eC({environment:r,inMemoryRecordCache:i??r.defaultRecordCache.inMemoryRecordCache,table:g().yB,transaction:c,value:{action_ids:t,alive:!0,id:l,parent_id:s.id,parent_table:s.table,properties:{name:n},space_id:s.spaceId,status:"active",trigger:d}});return a()(p.isTriggerType(d.type),"Trigger type mismatch"),p}function z(e){const{actionId:t,environment:o,intl:n,automationStore:i,actionType:c,transaction:d,insertionPoint:l,config:p,createDuplicateBlocksContainer:u=!0,builderType:f="sidebar"}=e,v=i.getSpaceId();if(!v)return;let w;if("duplicate_blocks"===c&&u){w=k().Wv({environment:o,inMemoryRecordCache:i.inMemoryRecordCache,transaction:d,type:"text"});const e=G({environment:o,contentStore:w.getContentStore(),transaction:d});r().default.afterNextFlush((()=>{const t=O().T.find((t=>m().L3.isEqual(t.props.store.pointer,e.pointer)));t&&C().setSelectionAtStart({store:t.props.store.getBlockTitleStore()})}))}const y=p??function(e){const{actionType:t,automationStore:o,intl:a}=e;if("modal_confirmation"===t)return{continue_button:{text:a.formatMessage(F.defaultContinueWorkflowMessage)},cancel_button:{text:a.formatMessage(F.defaultStopWorkflowMessage)},text:{type:"simple",value:(0,I().x9d)(a.formatMessage(F.defaultConfirmationWorkflowText))}};if("define_variables"===t){const e=(0,S().Ay)();return{values:{[e]:{name:(0,E().v)(o.getActionStores(),a.formatMessage(b().xC)),value:{type:"simple",value:[[""]]}}},variableIds:[e]}}}({actionType:c,automationStore:i,intl:n})??{},T=k().eC({environment:o,inMemoryRecordCache:i.inMemoryRecordCache,table:b().SC,transaction:d,value:{id:t,type:c,parent_id:i.id,parent_table:g().yB,alive:!0,space_id:v,config:y,blocks:w?[w.id]:[]}});return w&&_().BC({transaction:d,parentStore:T.getKeyStore("blocks"),appendStore:w}),!l||"afterActionId"in l?_().BC({transaction:d,parentStore:i.getActionIdsStore(),appendStore:T,after:null==l?void 0:l.afterActionId}):"beforeActionId"in l?_().Hs({transaction:d,parentStore:i.getActionIdsStore(),prependStore:T,before:l.beforeActionId}):(0,h().HB)(l),$({transaction:d,automationStore:i}),(0,x().CM)(((e,t,a)=>{const n=(0,M().ik)(o),r=(0,x().zc)({automationActionStore:T,formulaAnalyticsModule:t,formulasModule:e,simpleFormulasModule:a});(0,h().O9)(r)&&(0,s().dW)(n,{automation_action:r,automation_action_id:T.id,automation_id:T.getParentId(),builder_type:f}),T.isDefined()&&(0,s().c_)(n,{automation_action_id:T.id,automation_action_type:T.getType(),automation_id:i.id,builder_type:f})})),a()(T.isType(c),"Action type mismatch"),T}function Z(e){var t,o;const{automationStore:a,transaction:r}=e,i=a.getRecurrence();if(!i)return;const s=n().c9.now().plus({day:1}).startOf("day"),c={...i,start_date:s.toMillis(),end_condition:"date"===(null===(t=i.end_condition)||void 0===t?void 0:t.type)?{type:"date",end_at:(0,d().getNewEndTimestamp)(s,i.start_date,null===(o=i.end_condition)||void 0===o?void 0:o.end_at).toMillis()}:i.end_condition};k().zv({store:a,transaction:r,data:{status:"active"}}),k().zv({store:a.getKeyStore("trigger"),transaction:r,data:{recurrence:(0,d().convertFromUnpersistedRecurrenceConfig)(c)}})}function W(e){const{actorPointer:t,environment:o,includeParenting:a,sourceAutomationStore:n,targetAutomationId:r,transaction:i}=e,s=n.getParentStore();if(!s||!s.isReady())throw new Error("Automation parent store not ready");const c=n.getValue(),d=n.getSpaceId();if(!(0,h().O9)(c)||!(0,h().O9)(d))throw new Error("Undefined automation value or space id");const l={},u={...(0,w().mg)(c),id:r??(0,N().Z1)({environment:o,table:g().yB,spaceId:(0,v().e)(d)})};l[n.id]=u.id,(0,h().O9)(u.action_ids)&&(0,h().EI)(u.action_ids)&&u.action_ids.forEach((e=>l[e]=(0,N().Z1)({environment:o,table:b().SC,spaceId:(0,v().e)(d)})));const f=e=>{let{requested:t}=e;const o=l[t.id];return(0,h().O9)(o)?{...t,id:o}:t};(0,p().i)({actor:t,duplicateRecord:u,options:{},mapper:f,originalRecord:c});const m=k().eC({environment:o,inMemoryRecordCache:n.inMemoryRecordCache,table:g().yB,transaction:i,value:u});a&&T().NI({childStore:m,parentStore:s,transaction:i});const I=n.getActionStores(),S=Promise.all(I.map((e=>{const t=l[e.id],{automationActionStore:a,onComplete:n}=Q({environment:o,includeParenting:!1,mapper:f,sourceActionStore:e,targetAutomationActionId:t,transaction:i});return T().NI({childStore:a,parentStore:m,transaction:i}),n}))),y=S.then((e=>e.flat()));return{automationStore:m,onComplete:y}}function Q(e){const{environment:t,includeParenting:o,insertionPoint:a,mapper:n,sourceActionStore:r,targetAutomationActionId:i,transaction:c}=e,d=r.getParentStore();if(!d||!d.isReady())throw new Error("Automation store is not ready");const p=r.getValue(),u=r.getSpaceId();if(!(0,h().O9)(p)||!(0,h().O9)(u))throw new Error("Undefined action value or space id");const f={...(0,w().mg)(p),id:i??(0,N().Z1)({environment:t,table:b().SC,spaceId:(0,v().e)(u)})},m=t.currentUser.id,g=r.inMemoryRecordCache.makeGetRecordRoleFn(m);(0,l().I)({duplicateRecord:f,getRecordRole:g,originalRecord:p,mapper:e=>(null==n?void 0:n(e))??e.requested,options:{},originOptions:{baseUrl:A().A.domainBaseUrl,publicDomainName:A().A.publicDomainName},duplicateBlocks:!1});const I=k().eC({environment:t,inMemoryRecordCache:r.inMemoryRecordCache,table:b().SC,transaction:c,value:f});o&&(!a||"afterActionId"in a?T().NI({after:null==a?void 0:a.afterActionId,childStore:I,parentStore:d,transaction:c}):"beforeActionId"in a?T().Ti({before:null==a?void 0:a.beforeActionId,childStore:I,parentStore:d,transaction:c}):(0,h().HB)(a),$({transaction:c,automationStore:d}));const S=Promise.all(r.getBlockStores().map((e=>{const{blockStores:o,onComplete:a}=P().duplicateBlock({environment:t,preferDuplicateLocation:"local",stores:[e],targetSpaceId:(0,v().e)(e.pointer.spaceId),transaction:c,options:{addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1}}),n=o[0];return T().NI({childStore:n,parentStore:I,transaction:c}),a}))),y=I.getModel();return(0,h().O9)(y)&&(0,x().CM)(((e,o,a)=>{const n=(0,M().ik)(t),r=(0,x().zc)({automationActionStore:I,formulaAnalyticsModule:o,formulasModule:e,simpleFormulasModule:a});(0,h().O9)(r)&&(0,s().dW)(n,{automation_action:r,automation_action_id:y.id,automation_id:y.parent_id,from:"duplicate"}),(0,s().c_)(n,{automation_action_id:y.id,automation_action_type:y.type,automation_id:d.id,from:"duplicate"})})),{automationActionStore:I,onComplete:S}}function j(e){const{automationStore:t,automationTypecheckModule:o,contextType:a,environment:n,formulasModule:r,from:i,intl:s,isSubscribed:c,movedActionId:d,newActionIds:l,transaction:p}=e;k().zv({store:t,transaction:p,data:{action_ids:l}}),$({automationStore:t,transaction:p});K({automationStore:t,transaction:p,typecheckResult:(0,V().Z)({environment:n,automationStore:t,automationTypecheckModule:o,contextType:a,formulasModule:r,intl:s,isSubscribed:c})}),(0,M().u4)({environment:n,event:{eventName:"automation_action_move",eventProperties:{automation_id:t.id,automation_action_id:d,from:i}}})}function L(e){const{actionStore:t,automationStore:o,automationTypecheckModule:a,contextType:n,environment:r,formulasModule:i,intl:c,isSubscribed:d,transaction:l}=e,p=(0,V().Z)({environment:r,automationStore:o,automationTypecheckModule:a,contextType:n,formulasModule:i,intl:c,isSubscribed:d});!function(e){const{automationActionStore:t,automationStore:o,environment:a,transaction:n,hasError:r=!1}=e;let i=t.getParentStore();if((0,h().O9)(o)){const e=t.getParentPointer();if(!(0,h().O9)(e))throw new Error("Automation action does not have a parent pointer");if(!m().L3.isEqual(e,o.pointer))throw new Error(`Automation action parent pointer does not match argument: ${m().L3.toKey(e)}, ${m().L3.toKey(o.pointer)}`);i=o}else if(!(0,h().O9)(i))throw new Error("Automation store is undefined");T().zz({childStore:t,parentStore:i,transaction:n});const c=t.getModel();(0,h().O9)(c)&&(0,x().CM)(((e,o,n)=>{const d=(0,M().ik)(a),l=(0,x().zc)({automationActionStore:t,formulaAnalyticsModule:o,formulasModule:e,simpleFormulasModule:n});(0,h().O9)(l)&&(0,s().YO)(d,{automation_action:l,automation_action_id:c.id,automation_id:c.parent_id,has_error:r}),(0,s().gW)(d,{automation_action_id:c.id,automation_action_type:c.type,automation_id:i.id,has_error:r})}))}({automationActionStore:t,environment:r,transaction:l,hasError:(y().Q.isSuccess(p)&&p.value.actionValidationFailures[t.id]||[]).length>0}),K({automationStore:o,transaction:l,typecheckResult:p})}function q(e){const{environment:t,automationStore:o,automationTypecheckModule:a,contextType:n,formulasModule:r,intl:i,isSubscribed:s,transaction:c}=e;K({automationStore:o,transaction:c,typecheckResult:(0,V().Z)({environment:t,automationStore:o,automationTypecheckModule:a,contextType:n,formulasModule:r,intl:i,isSubscribed:s})})}function $(e){const{automationStore:t,transaction:o}=e;t.getSpaceId()&&t.getActionStores().forEach(((e,t)=>{var a;if(!e.isDefined())return;const n=e.getModel();n.isType("open_page")&&"url"===(null===(a=n.getConfig())||void 0===a||null===(a=a.target)||void 0===a?void 0:a.type)&&!(0,i().cQ)(t)&&k().zv({store:e.getConfigStore(),transaction:o,data:{target:null}})}))}function K(e){const{automationStore:t,transaction:o,typecheckResult:a}=e,n=t.getSpaceId(),r=t.getModel();if(n&&r&&!y().Q.isFail(a))for(const i of r.getActionIds()){const e=t.getRecordStore(t,{table:b().SC,id:i,spaceId:n});if(!e.isDefined())continue;const r=e.getModel(),s=new Set(a.value.actionInputValueTypes[i].map((e=>{if(e.kind===u().FormulaContextValueKind.Binding||e.kind===u().FormulaContextValueKind.ContextValue)return e.id;e.kind!==u().FormulaContextValueKind.ThisRow&&(0,h().HB)(e)})).filter(h().O9)),{value:d}=(0,c().G)({automationActionModel:r,baseUrl:A().A.domainBaseUrl,preventClearingConfig:!0,publicDomainName:A().A.publicDomainName,sourceSpaceId:n,visitors:{visitCollectionProperty:void 0,visitCollectionPropertyPointer:void 0,visitFormulaContextValue:e=>s.has(e)?{type:"keep"}:{type:"replace",value:void 0},visitFormulaPageProperty:void 0,visitRecordPointer:void 0}}),l=f().op.update({pointer:e.pointer,path:["config"],args:d.getConfig()??{}});R().applyOperation({store:e,operation:l,transaction:o})}}function G(e){const{environment:t,contentStore:o,transaction:a}=e,n=k().Wv({environment:t,type:"text",inMemoryRecordCache:o.inMemoryRecordCache,transaction:a,spaceId:o.pointer.spaceId});return _().BC({parentStore:o,appendStore:n,transaction:a}).childStore}function J(e){const{automationStore:t,environment:o,transaction:a}=e;k().zv({store:t,data:{status:"active"},transaction:a});const n=t.getModel();(0,h().O9)(n)&&(0,x().CM)(((e,a,r)=>{const i=(0,U().To)(t);let c=[];i&&y().Q.isSuccess(i)&&(c=i.value.valueTypes);const d=(0,M().ik)(o),l=(0,s().sp)({automationModel:n,formulaAnalyticsModule:a,formulasModule:e,formulaTypecheckContextValues:c,getRecordModel:t.getRecordModel,featureGates:(0,D().i)(),simpleFormulasModule:r});(0,s().Ah)(d,l)}))}function H(e){const{automationStore:t,environment:o,status:a,transaction:n}=e,r=a??"disabled";k().zv({store:t,data:{status:r},transaction:n}),t.isTriggerType("recurrence")&&k().zv({store:t,data:{run_at:void 0},transaction:n});const i=t.getModel();(0,h().O9)(i)&&(0,x().CM)(((e,a,n)=>{const r=(0,U().To)(t);let c=[];r&&y().Q.isSuccess(r)&&(c=r.value.valueTypes);const d=(0,M().ik)(o),l=(0,s().sp)({automationModel:i,formulaAnalyticsModule:a,formulasModule:e,formulaTypecheckContextValues:c,getRecordModel:t.getRecordModel,featureGates:(0,D().i)(),simpleFormulasModule:n});(0,s().vN)(d,l)}))}function X(e){const{automationStore:t,environment:o,transaction:a}=e;k().zv({store:t,data:{alive:!1},transaction:a});const n=t.getModel();(0,h().O9)(n)&&(0,x().CM)(((e,a,r)=>{const i=(0,U().To)(t);let c=[];i&&y().Q.isSuccess(i)&&(c=i.value.valueTypes);const d=(0,M().ik)(o),l=(0,s().sp)({automationModel:n,formulaAnalyticsModule:a,formulasModule:e,formulaTypecheckContextValues:c,getRecordModel:t.getRecordModel,featureGates:(0,D().i)(),simpleFormulasModule:r});(0,s().Iv)(d,l)}))}},331119:(e,t,o)=>{o.d(t,{RB:()=>I,U5:()=>l,W6:()=>p,ke:()=>m,nx:()=>b,t7:()=>g,x3:()=>v});o(16280),o(18107),o(944114),o(898992),o(354520),o(672577),o(581454);var a=()=>o(496603),n=()=>o(973647),r=()=>o(534177),i=()=>o(251582),s=()=>o(181856),c=()=>o(832443);const d=i().p.satisfy((0,r().u0)((e=>"element"===e.type?{true:e}:{false:e})));function l(e){return i().p.describe(i().p.filter(d,(t=>t.tagName===e)),(()=>new(s().gJ)(e)))}const p=i().p.satisfy((0,r().u0)((e=>"text"===e.type?{true:e}:{false:e}))),u=i().p.satisfy((e=>"text"===e.type&&""===e.value.trim()));function f(e){const{prefixMappingMode:t,baseHref:o}=e;return"query_database_result_counter"===t?`query_database_result_counter:/${c().tD.blockIdToHref(o)}`:"href_counter"===t?o:void(0,r().HB)(t)}function m(e){const{inputAttributes:t={},definitions:o,tagName:i,validateRequiredAttributes:d=!0,mapCounterToKey:l}=e,p=Object.keys(t),u=Object.keys(o),m=a().R9(p,u);if(m.length>0)return{error:new(s().LN)({attributeNames:m,tagName:i})};if(d)for(const[a,n]of Object.entries(o))if(n.required&&!p.includes(a))return{error:new(s().HQ)({attributeName:a,tagName:i})};const g=a().o8(t);for(const[a,b]of Object.entries(t)){const e=o[a];if((0,r().O9)(e.mappingMode)){if("href_counter"!==e.mappingMode&&!(0,c().D4)(b))return{error:new(s().qW)(a,b)};if((0,r().O9)(l)&&"href_counter"===e.mappingMode){let e;const t=["href_counter","query_database_result_counter"];for(const o of t)if(e=c().tD.mapCounterToKeyInMode({mapCounterToKey:l},b,o,i),n().Q.isSuccess(e)){g[a]=f({prefixMappingMode:o,baseHref:e.value});break}if(n().Q.isFail(e))return{error:new(s().wL)("unmapped_id",e.error.message,e.error)}}else if((0,r().O9)(l)){const t=c().tD.mapCounterToKeyInMode({mapCounterToKey:l},b,e.mappingMode,i);if(n().Q.isFail(t))return{error:new(s().wL)("unmapped_id",t.error.message,t.error)};g[a]=t.value}}if(!0!==e.values&&!e.values.includes(b))return{error:new(s().GW)({attributeName:a,receivedValue:b,tagName:i})}}return{value:g}}function g(e,t){if(0===e.length)throw new Error("Must provide at least 1 label and type guard");const o=[...e],a=[[]];for(const r of t){const[t,i]=o[0];if(!i(r)){for(;o.length>0;){o.shift();const e=o[0];if(a.push([]),e&&e[1](r))break}if(0===o.length){var n;const o=null===(n=e.find((e=>{let[,t]=e;return t(r)})))||void 0===n?void 0:n[0];if(!o)throw new Error(`Item did not match any type guards: ${JSON.stringify(r)}`);return{error:{incorrectLabel:o,lastLabel:t}}}}a.at(-1).push(r)}for(;a.length<e.length;)a.push([]);return{value:a}}function b(e,t,o){const{allowUnmatchedText:n=!1}=o??{},r=i().p.manyTill(i().p.choice([...t,...n?[i().p.map(u,(e=>{}))]:[],i().p.fail((t=>new(s().RR)({tagName:e,unexpectedNode:a().$1(t)})))]),i().p.eof());return i().p.map(r,(e=>a().oE(e)))}function v(e){return e.children&&e.children.length>0?{error:new(s().RR)({tagName:e.tagName,unexpectedNode:e.children[0]})}:{value:void 0}}function I(e){const{tagName:t,attributeDefinitions:o,mapCounterToKey:a}=e;return i().p.mapResult(l(t),(e=>{const r=m({tagName:t,inputAttributes:e.attributes,definitions:o,mapCounterToKey:a});if(n().Q.isFail(r))return r;const i=v(e);return n().Q.isFail(i)?i:{value:{attributes:r.value}}}))}},349379:(e,t,o)=>{o.d(t,{DF:()=>p,If:()=>l,Vd:()=>d,g2:()=>c,os:()=>i,ux:()=>s});var a=()=>o(116225),n=()=>o(989423),r=()=>o(508496);function i(e){let{environment:t,eventProperties:o}=e;const a="suggested_collection_template_clicked";(0,n().u4)({environment:t,event:{eventName:a,eventProperties:o}}),r().default.logEvent(a,o.collection_template_id,o)}function s(e){let{environment:t,eventProperties:o}=e;(0,n().u4)({environment:t,event:{eventName:"suggested_personal_school_template_clicked",eventProperties:o}})}function c(e){let{environment:t,eventProperties:o,modalState:i}=e;const s="workflow_template_onboarding_done";var c;((0,n().u4)({environment:t,event:{eventName:s,eventProperties:o}}),r().default.logEvent(s,o.collection_template_id,o),a().u4({name:"collection_created_from_workflow_template",args:{template_id:o.collection_template_id??"",origin:o.origin,experiment_group:"personalized"}}),i.collectionTemplate.isAiGenerated)&&(null===(c=i.setupGenerator)||void 0===c||c.trackSessionEnded({reason:"instantiated"}))}function d(e){let{environment:t,eventProperties:o}=e;const a="setup_generator_session_started";(0,n().u4)({environment:t,event:{eventName:a,eventProperties:o}}),r().default.logEvent(a,void 0,o)}function l(e){let{environment:t,eventProperties:o}=e;const a="setup_generator_generated_setup";(0,n().u4)({environment:t,event:{eventName:a,eventProperties:o}}),r().default.logEvent(a,void 0,o)}function p(e){let{environment:t,eventProperties:o}=e;const a="template_picker_opened";(0,n().u4)({environment:t,event:{eventName:a,eventProperties:o}}),r().default.logEvent(a,o.origin,o)}},370657:(e,t,o)=>{o.d(t,{Ke:()=>g,RD:()=>f,Sw:()=>p,Vf:()=>l,_z:()=>c,cZ:()=>v,d7:()=>w,dL:()=>u,hx:()=>n,iC:()=>b,lA:()=>m,qG:()=>d,s8:()=>I,vW:()=>r});var a=()=>o(496603);const n=[{type:"search",scopeForNextSearch:{type:"everything"},searchSessionId:void 0},{type:"researcher",searchScope:{type:"everything"},useWebSearch:!0},{type:"setup-generator"},{type:"workflow"},{type:"markdown-chat"},{type:"fast-researcher"}],r={maxIterations:8,runInQueue:!0,multiturnIterations:1,filterArtifacts:!1,skipSummarize:!1,thinkingTokens:1024,filterToSpaceSharedResults:!1},i=["search","researcher","setup-generator"],s=["workflow","setup-generator","fast-researcher","tool-markdown-chat","fast-agent"],c=["markdown-chat","search","researcher","workflow","setup-generator"];function d(e){const{agentEnabled:t}=e,o=a().oE([...i,t?"workflow":void 0]);return n.filter((e=>o.includes(e.type)))}const l=[{type:"route-inference-transcript",configs:n.filter((e=>c.includes(e.type)))},...n.filter((e=>s.includes(e.type)))],p=["slack","google-drive","github","gmail","helpdocs","helpdoc-section","webpage","jira","microsoftTeams","notion","sharepoint","linear"],u="searchAgent",f="unifiedFindAgent",m="readingAgent",g="taskAgent",b="databaseAgent",v="databaseBulkReadContentAgent",I={originalOutput:[],feedback:"",inputSummary:"",promptFeedback:"",testInstructions:"",originalOutputPassesTest:!1,originalOutputTestResults:[],correctedOutputs:[],verified:!1},w=["Eval","Prompt"];"\n'Chat with AI':\n\nRouting Instructions:\n- If this mode is selected, the user will receive an AI response without a search being conducted.\n- Route to this mode when the user asks for general knowledge, chatting, or writing content that does not require additional information not already in the context.\n- Do NOT route to this mode when the query requires current statistics, facts, or up-to-date information.\n- Do NOT route to this mode when the query requires searching the user's workspace.\n- Do NOT route to this mode when the user wants to build a specific system or application in Notion.\n\nExamples:\n<example>\nINPUT: Tell me a bedtime story about a robot who learns to dream.\nOUTPUT: 0\n</example>\n<example>\nINPUT: What are some key ideas behind design thinking?\nOUTPUT: 0\n</example>\n<example>\nINPUT: largest mammal\nOUTPUT: 0\n</example>\n<example>\nINPUT: write a haiku about the first snowfall\nOUTPUT: 0\n</example>\n<example>\nINPUT: Who was Joan of Arc?\nOUTPUT: 0\n</example>\n<example>\nINPUT: create a plan for an 80th birthday party\nOUTPUT: 0\n</example>\n".trim(),"\n'Quick search':\n\nRouting Instructions:\n- If this mode is selected, a single search will be conducted and an AI response will be provided that takes the search results into consideration.\n- Route to this mode if you need to find information across the Notion workspace, Slack, Google Drive, Github, or Jira to handle the user's request.\n- Route to this mode when the query seeks a single, specific fact, definition, or data point, or when the user needs current or time-sensitive information.\n- Route to this mode if the user seems to be searching for a specific document in their workspace.\n- Route to this mode if the user needs support: e.g. if they are mentioning getting support, requesting help, asking for customer service, reporting a problem with the product, or requesting a feature - we may be able to find some relevant content in the Notion Help Center\n- Do NOT route to this mode when the request requires synthesizing multiple pieces of information or generating a detailed research report.\n- Do NOT route to this mode when the user wants to build a specific system or application in Notion.\n\nExamples:\n<example>\nINPUT: automated checkout PRD\nOUTPUT: 1\n</example>\n<example>\nINPUT: Who leads the podiatry dept?\nOUTPUT: 1\n</example>\n<example>\nINPUT: overnight parking policy\nOUTPUT: 1\n</example>\n<example>\nINPUT: When are we going to release our documentary about polar bears in the Arctic?\nOUTPUT: 1\n</example>\n<example>\nINPUT: Find my PR that enables dynamic builds.\nOUTPUT: 1\n</example>\n".trim(),"\n'Research Mode':\n\nRouting Instructions:\n- Route to this mode when the query explicitly requests research, analysis, or in-depth exploration.\n- Route to this mode when the query requires conducting multiple searches or synthesizing information from multiple sources or on multiple topics.\n- Do NOT route to this mode when the query can be answered with a single search.\n- Do NOT route to this mode when the user wants to build a specific system or application in Notion.\n\nExamples:\n<example>\nINPUT: Whose work is most UX focused between Amy, Paula, and Xochitl?\nOUTPUT: 2\n</example>\n<example>\nINPUT: Write profiles for 10 of our biggest north African customers.\nOUTPUT: 2\n</example>\n<example>\nINPUT: Can you put together some recommendations for how to move forward with the Lumi deal? Check our recent Slack discussions for context. Write your recommendations in a similar style to how I have written them in the past.\nOUTPUT: 2\n</example>\n<example>\nINPUT: detailed comparison of the healthcare systems of Canada, the UK, Germany, and Singapore in terms of efficiency and accessibility\nOUTPUT: 2\n</example>\n<example>\nINPUT: What are the trends and geopolitical implications of the global semiconductor supply chain?\nOUTPUT: 2\n</example>\n\n".trim(),"\n'App builder':\n\nRouting Instructions:\n- Route to this mode when the query explicitly asks to build an app or system, or when the request involves automating processes within Notion or external tools.\n- Do NOT route to this mode when the user is seeking information rather than building a system or when the request is for creative content or general conversation.\n\nExamples:\n<example>\nINPUT: Create a task management app with deadlines and team assignments.\nOUTPUT: 3\n</example>\n<example>\nINPUT: Develop a CRM that tracks client interactions and schedules follow-ups.\nOUTPUT: 3\n</example>\n<example>\nINPUT: design an invoice system that sends payment reminders\nOUTPUT: 3\n</example>\n<example>\nINPUT: could you build a knowledge base that categorizes notes by topic automatically?\nOUTPUT: 3\n</example>\n<example>\nINPUT: Set up a content calendar for social media posts\nOUTPUT: 3\n</example>\n<example>\nINPUT: Create a recruitment pipeline for interview stages.\nOUTPUT: 3\n</example>\n<example>\nINPUT: I want a dashboard for visualizing Notion database metrics\nOUTPUT: 3\n</example>\n<example>\nINPUT: a way to process and categorize customer feedback automatically\nOUTPUT: 3\n</example>\n".trim(),"\n<example>\nINPUT: Create a database to track my job applications\nOUTPUT: 3\n</example>\n<example>\nINPUT: I need a way to organize my project tasks and deadlines\nOUTPUT: 3\n</example>\n<example>\nINPUT: Help me keep track of my fitness progress over time\nOUTPUT: 3\n</example>\n<example>\nINPUT: I want to build a system for managing my inventory\nOUTPUT: 3\n</example>\n<example>\nINPUT: I need something to organize all my recipes and ingredients\nOUTPUT: 3\n</example>\n<example>\nINPUT: Can you help me set up a customer relationship management system?\nOUTPUT: 3\n</example>\n<example>\nINPUT: [pasted CSV or similar structured data]\nOUTPUT: 3\n</example>\n<example>\nINPUT: I need to organize my collection of books\nOUTPUT: 3\n</example>\n".trim()},382055:(e,t,o)=>{o.d(t,{$3:()=>p,AQ:()=>d,Ae:()=>c,BL:()=>l,FL:()=>s,FX:()=>n,Vp:()=>i,XL:()=>r,nY:()=>u});var a=()=>o(989423);function n(e,t){a().vd(e,"workspace_creation_ability",t)}function r(e,t){a().vd(e,"workspace_creation_setting_updated",t)}function i(e,t){a().vd(e,"claimable_spaces_viewed",t)}function s(e,t){a().vd(e,"space_transfer_requested",t)}function c(e,t){a().vd(e,"space_transfer_completed",t)}function d(e,t){a().vd(e,"space_claim_upgrade_requested",t)}function l(e,t){a().vd(e,"space_claim_upgrade_completed",t)}function p(e,t){a().vd(e,"space_claim_deletion_started",t)}function u(e,t){a().vd(e,"space_claim_deletion_canceled",t)}},458097:(e,t,o)=>{o.d(t,{A:()=>r});class a extends(()=>o(757695))().default{getInitialState(){return{open:!1,isShowingLoadingState:!1}}updateUserCustomizations(e,t){this.state.open&&this.state.collectionTemplate&&this.setState({...this.state,userCustomizations:{...this.state.userCustomizations,[e]:t}})}updateCollectionTemplate(e){this.state.open&&this.state.collectionTemplate&&this.setState({...this.state,collectionTemplate:e})}updatePreviewFocusViewTemplateId(e){this.state.open&&this.state.collectionTemplate&&this.state.previewCollectionInfo&&this.state.previewCollectionInfo.focusViewTemplateId!==e&&this.setState({...this.state,previewCollectionInfo:{...this.state.previewCollectionInfo,focusViewTemplateId:e}})}updatePreviewCollectionContextStore(e){this.state.open&&this.state.collectionTemplate&&this.state.previewCollectionInfo&&this.state.previewCollectionInfo.collectionContextStore!==e&&this.setState({...this.state,previewCollectionInfo:{...this.state.previewCollectionInfo,collectionContextStore:e}})}getPreviewCollectionContextStore(){if(this.state.open&&this.state.collectionTemplate&&this.state.previewCollectionInfo)return this.state.previewCollectionInfo.collectionContextStore}getParentStore(){return this.state.open?this.state.parentStore:void 0}getShouldShowExpandedTemplateList(){return this.state.open&&this.state.shouldShowExpandedTemplateList}setShouldShowExpandedTemplateList(e){this.state.open&&this.setState({...this.state,shouldShowExpandedTemplateList:e})}close(e){var t,o;this.state.open&&(null===(t=(o=this.state).onClose)||void 0===t||t.call(o,e),this.setState({open:!1,isShowingLoadingState:!1}))}reset(){this.setState(this.getInitialState())}}const n=new a;(0,o(604341).exposeDebugValue)("InitializeWorkflowTemplateModalStore",n);const r=n},460744:(e,t,o)=>{o.d(t,{vK:()=>s,uF:()=>l,Mt:()=>p,q1:()=>c,RM:()=>d});o(813451),o(944114),o(898992),o(354520),o(737550);var a=()=>o(534177),n=()=>o(724639),r=()=>o(465498),i=()=>o(915671);const s={id:"32983546-2835-4c6b-9101-25f10781415c",name:"inference-saved-examples"};function c(e){return e.some((e=>"config"===e.type&&"workflow"===e.value.type))}function d(e,t){const o={};for(const a of e)"registered-tool-grouping"===a.type&&(o[a.toolCallId]=a);let s=[...e];if("config"===t.type||"user"===t.type||"error"===t.type||"context"===t.type||"workflow-error"===t.type||"title"===t.type||"retry"===t.type||"autocorrect"===t.type||"search-observation"===t.type||"researcher-text-observation"===t.type||"debug-inference"===t.type||"fast-researcher-plan"===t.type||"fast-researcher-search-results"===t.type||"memory-agent"===t.type||"summarize-transcript"===t.type||"summarize-transcript-record-map"===t.type||"summarize-transcript-error"===t.type||"workflow-run-investigation"===t.type||"workflow-runs"===t.type||"workflow-function-call-request"===t.type||"workflow-function-edit-request"===t.type||(0,n().P0)(t)||"researcher-agent-group"===t.type||"fast-agent-search-results"===t.type||"workflow-view-files"===t.type||"workflow-updated-metadata"===t.type||"workflow-updated-code"===t.type||"workflow-ran-tests"===t.type||"workflow-updated-modules"===t.type||"workflow-updated-views"===t.type||"workflow-updated-triggers"===t.type||"workflow-updated-functions"===t.type||"workflow-added-module-types"===t.type||"agent-debug-error"===t.type||"agent-user-action"===t.type||"attachment"===t.type||"agent-transcript-summary"===t.type)s.push({...t});else if("workflow-inference"===t.type||"search"===t.type||"agent-inference"===t.type||"agent-tool-result"===t.type)s=[...s.filter((e=>e.id!==t.id)),{...t}];else if("workflow-function-call-results"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"workflow-function-call-results"===s[e].type){const o=s[e];s[e]={...o,value:[...o.value,...t.value]}}else s.push({...t})}else if("markdown-chat"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"markdown-chat"===s[e].type){const o=s[e];s[e]={...o,value:`${o.value}${t.value}`}}else s.push({...t})}else if("fast-agent-inference"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"fast-agent-inference"===s[e].type){const o=s[e];s[e]={...o,value:`${o.value}${t.value}`}}else s.push({...t})}else if("search-chat"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"search-chat"===s[e].type){const o=s[e];s[e]={...o,value:`${o.value}${t.value}`}}else s.push({...t})}else if("fast-researcher-chat"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"fast-researcher-chat"===s[e].type){const o=s[e];s[e]={...o,value:`${o.value}${t.value}`}}else s.push({...t})}else if("workflow"===t.type){const e=s.findLastIndex((e=>e.id===t.id));-1!==e&&"workflow"===s[e].type?s[e]={...t}:s.push({...t})}else if("workflow-progress"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"workflow-progress"===s[e].type){const o=function(e,t){const o=[...e];for(const a of t){const e=(0,i().v1)(a),t=o.findIndex((t=>(0,i().v1)(t)===e&&!t.completed));if(-1!==t&&a.completed){o[t]=a;continue}const n=o.findIndex((t=>(0,i().v1)(t)===e));if(-1===n)o.push(a);else{const e=o[n];e.completed&&!a.completed?o.push(a):!e.completed&&a.completed&&(o[n]=a)}}return o}(s[e].items,t.items);s[e]={...s[e],items:o,completed:t.completed,durationMs:t.durationMs}}else s.push({...t})}else if("setup"===t.type){const e=s.findLastIndex((e=>e.id===t.id));-1!==e&&"setup"===s[e].type?s[e]=t:s.push({...t})}else if("researcher-report"===t.type){const e=s.findLastIndex((e=>e.id===t.id));if(-1!==e&&"researcher-report"===s[e].type){const o=s[e];s[e]={...o,value:`${o.value}${t.value}`,citationInfo:(0,r().Mi)(o.citationInfo,t.citationInfo)}}else s.push({...t})}else if("researcher-agent"===t.type){const e=s.findIndex((e=>e.id===t.id));-1!==e&&"researcher-agent"===s[e].type?s[e]={...s[e],value:Object.assign(s[e].value,t.value)}:s.push({...t})}else if("researcher-next-steps"===t.type){const e=s.findIndex((e=>e.id===t.id));-1!==e?s[e]={...t}:s.push({...t})}else if("registered-tool-call"===t.type||"registered-tool-output"===t.type||"registered-tool-error"===t.type){let e=o[t.toolCallId];e||(e={id:t.toolCallId,type:"registered-tool-grouping",toolName:t.toolName,toolCallId:t.toolCallId,steps:[]},o[t.toolCallId]=e,s.push(e));const a={...t};e.steps.push(a)}else if("registered-tool-grouping"===t.type)o[t.toolCallId]||(o[t.toolCallId]=t,s.push({...t}));else if("setup-operations"===t.type){const e=s.findLastIndex((e=>e.id===t.id)),o=s[e];(null==o?void 0:o.type)===t.type?s[e]={...o,operations:[...o.operations,...t.operations]}:s.push({...t})}else(0,a().HB)(t);return s}const l="inferenceTranscript";function p(e){return"object"==typeof e&&null!==e&&"transcript"in e}},465498:(e,t,o)=>{o.d(t,{ut:()=>l,Mi:()=>c,y5:()=>s});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577),o(581454),o(737550);var a=()=>o(754093),n=()=>o(832443),r=()=>o(252050),i=()=>o(706461);function s(e){let t=1;return e.replace(/\[(.*?),(.*?),(.*?)\]/g,((e,o,a,n)=>{const r=encodeURIComponent(o),i=encodeURIComponent(a),s=encodeURIComponent(n),c=encodeURIComponent(",");return`[**[${t++}]**](#citation:${r}${c}${i}${c}${s})`}))}function c(e,t){const o={stepCitations:{...e.stepCitations}};for(const[a,n]of Object.entries(t.stepCitations)){if(!o.stepCitations[a]){o.stepCitations[a]={claims:[...n.claims],artifacts:[...n.artifacts]};continue}const e=new Set(o.stepCitations[a].claims.map((e=>e.id)));for(const r of n.claims)e.has(r.id)||o.stepCitations[a].claims.push(r);const t=new Set(o.stepCitations[a].artifacts.map((e=>e.id)));for(const r of n.artifacts)t.has(r.id)||o.stepCitations[a].artifacts.push(r)}return o}const d={"slack-result":"slack","google-drive-result":"google-drive","helpdoc-result":"helpdoc","github-result":"github","webpage-result":"webpage","jira-result":"jira","microsoft-teams-result":"microsoftTeams","sharepoint-result":"sharepoint"};function l(e,t){const o=[],s=(0,a().BD)(e.value,!1,{parseNoneClosedTags:!0})[0];if("element"!==s.type)return o;for(const a of s.children){if("element"!==a.type)continue;let e;const s=t.mapCounterToKey((0,r().VB)(a.attributes.id));if("element"!==a.type||"page"!==a.tagName&&"block"!==a.tagName){if("element"===a.type&&("slack-result"===a.tagName||"github-result"===a.tagName||"google-drive-result"===a.tagName||"jira-result"===a.tagName||"sharepoint-result"===a.tagName||"microsoft-teams-result"===a.tagName||"webpage"===a.tagName||"helpdoc"===a.tagName)){var c;const t=n().tD.parseAssistantHref(s.key),o="text"===(null===(c=a.children[0])||void 0===c?void 0:c.type)?a.children[0].value:"",r="slack-result"===a.tagName||"microsoft-teams-result"===a.tagName?a.attributes.channel:a.attributes.title;e={citationType:"universal_search",target:d[a.tagName],href:s.key,title:r,text:o,number:Number(a.attributes.id),...t}}}else{const o=t.mapCounterToKey((0,r().VB)(null==a?void 0:a.attributes.id));e={citationType:"notion",pageId:o.key,blockId:"block"===a.tagName?s.key:o.key,number:Number(a.attributes.id)}}o.push({id:a.attributes.id,artifactType:"text",content:(0,i()._o)(a),citationInfo:e})}return o}},476219:(e,t,o)=>{o.d(t,{Kg:()=>c,Pg:()=>d,nN:()=>l,vW:()=>p});o(944114),o(898992),o(672577);var a=()=>o(663077),n=()=>o(970013),r=()=>o(496603),i=()=>o(534177),s=()=>o(247211);function c(e){var t;let{propertyId:o,propertyTemplate:a,firstTableViewInfo:n}=e;const r=null==n||null===(t=n.format.table_properties)||void 0===t?void 0:t.find((e=>e.property===o));if(r){const{property:e,...t}=r;a.tablePropertyFormat=t}}function d(e){const{type:t}=e;switch(t){case"title":case"text":case"checkbox":case"number":case"person":case"file":case"url":case"email":case"phone_number":case"created_time":case"created_by":case"last_edited_time":case"last_edited_by":case"last_visited_time":case"date":case"select":case"multi_select":case"status":case"formula":case"relation":case"auto_increment_id":case"button":return!0;case"rollup":case"location":case"verification":case"geo_point":return!1;default:(0,i().HB)(t)}}function l(e){if("relation"===e.type)return{type:"relation",name:e.name,autoRelate:e.autoRelate};const t=(0,r().mg)(e);if(delete t.workflow_template_instance,(0,n().DQ)(t)&&t.options)for(const o of t.options)delete o.collectionIds;return t}function p(e){let{propertyTemplateValue:t,mapper:o}=e;const n=[];if((0,a().$G)({object:t,callback:e=>{const t=e.property;n.push(t)}}),0===n.length)return;const r={};for(const a of n)o.populateDependencyMap((0,s().vO)({type:"property",id:a}),r);return r}},555102:(e,t,o)=>{o.d(t,{Kf:()=>m,WM:()=>p,XZ:()=>g,Xd:()=>v,nD:()=>b,r6:()=>f});o(944114),o(898992),o(354520);var a=()=>o(244641),n=()=>o(416504),r=()=>o(155792),i=()=>o(919709),s=()=>o(498212),c=()=>o(534177),d=()=>o(594794),l=()=>o(508496);function p(e){const{environment:t,userStore:o,spaceStore:i,spaceViewStore:s,blockStore:c}=e,p=(0,d().Z1)({environment:t,table:r().mS,spaceId:i.id}),u={...c&&c.isCollectionView()?{collectionViewBlockId:c.id}:void 0,...c&&!c.isCollectionView()?{blockId:c.id}:void 0};return l().default.checkGate({gateName:"workflows_inference_replay"})?{id:p,type:"context",value:{timezone:"America/Los_Angeles",userName:"Test User",userId:"test-user-id",spaceName:"Test Space",spaceId:i.id,spaceViewId:s.id,currentDatetime:"2024-01-01T00:00:00.000Z",...u}}:{id:p,type:"context",value:{timezone:(0,n().P)(),userName:o.getName(),userId:o.id,spaceName:i.getName(),spaceId:i.id,spaceViewId:s.id,currentDatetime:a().c9.now().toISO(),...u}}}function u(e){const{environment:t,spaceStore:o,config:a}=e;return{id:(0,d().Z1)({environment:t,table:r().mS,spaceId:o.id}),type:"config",value:a}}function f(e){let{environment:t,spaceStore:o,userAction:a}=e;return{id:(0,d().Z1)({environment:t,table:r().mS,spaceId:o.id}),type:"agent-user-action",userAction:a}}function m(e){const{environment:t,spaceStore:o,value:a,userStore:n}=e,s=(0,i().bBR)(a);return{id:(0,d().Z1)({environment:t,table:r().mS,spaceId:o.id}),type:"user",value:s,userId:n.id}}function g(e){const{environment:t,spaceStore:o,functionKey:a,runId:n,message:i}=e;return{id:(0,d().Z1)({environment:t,table:r().mS,spaceId:o.id}),type:"workflow-function-edit-request",functionKey:a,runId:n,message:i,traceId:(0,s().lZ)()}}function b(e){const{environment:t,spaceStore:o,workflowFunction:a,functionArgs:n,from:i}=e;return{id:(0,d().Z1)({environment:t,table:r().mS,spaceId:o.id}),type:"workflow-function-call-request",functionLabel:a.name,functionCall:{toolCallId:(0,s().lZ)(),key:a.key,args:n},from:i,traceId:(0,s().lZ)()}}function v(e){const{environment:t,spaceStore:o,userStore:a,config:n,addSteps:r,blockStore:i,spaceViewStore:s}=e,d=[u({environment:t,spaceStore:o,config:n}),p({environment:t,userStore:a,spaceStore:o,spaceViewStore:s,blockStore:i})];return r&&d.push(...r),d.filter(c().O9)}},592933:(e,t,o)=>{o.d(t,{Vf:()=>a});o(410838),o(944114),o(898992),o(354520),o(581454),o(737550);function a(e){return"inference"!==e.type&&"queue-handoff"!==e.type&&"record-map"!==e.type}},616385:(e,t,o)=>{o.r(t),o.d(t,{applyPerfmarkTrial:()=>Ne,completeDesktopOnboardingForTeamPlan:()=>Oe,createSpaceWithTemplates:()=>Ce,getInitialState:()=>pe,getRedirectDataUpdate:()=>Pe,getWorkflowTemplateForUseCase:()=>xe,getWorkflowTemplatesForUseCases:()=>Ue,joinTeamSpaceWithTemplates:()=>Re,messages:()=>le,navigateWithRedirectData:()=>_e,redirectAfterOnboardingComplete:()=>he,timedTrialUpsellNextState:()=>we,updateAndGetNextState:()=>ue,updateAndGetPreviousState:()=>fe});o(16280),o(898992),o(354520),o(581454);var a=()=>o(584262),n=()=>o(660237),r=()=>o(715256),i=()=>o(857639),s=()=>o(416845),c=()=>o(206267),d=()=>o(386164),l=()=>o(388821),p=()=>o(179034),u=()=>o(519831),f=()=>o(96689),m=()=>o(84520),g=()=>o(677338),b=()=>o(994310),v=()=>o(496603),I=()=>o(502800),w=()=>o(534177),S=()=>o(337240),y=()=>o(382055),h=()=>o(796756),_=()=>o(148024),T=()=>o(449506),k=()=>o(934839),C=()=>o(705540),R=()=>o(496414),A=()=>o(816074),P=()=>o(666144),M=()=>o(857783),D=()=>o(435009),N=()=>o(426116),O=()=>o(185544),U=()=>o(751156),x=()=>o(755199),E=()=>o(617254),V=()=>o(519839),F=()=>o(26388),B=()=>o(59424),z=()=>o(235921),Z=()=>o(440209),W=()=>o(989423),Q=()=>o(186445),j=()=>o(680074),L=()=>o(972435),q=()=>o(640653),$=()=>o(628315),K=()=>o(406792),G=()=>o(351360),J=()=>o(508496),H=()=>o(150193),X=()=>o(630116),Y=()=>o(224701),ee=()=>o(807778),te=()=>o(655765),oe=()=>o(162342),ae=()=>o(151168),ne=()=>o(846955),re=()=>o(144114),ie=()=>o(607859),se=()=>o(12145),ce=()=>o(770769),de=()=>o(1130);const le=(0,o(959013).YK)({joiningWorkspace:{id:"onboardingStateActions.joiningWorkspace.loadingMessage",defaultMessage:"Joining team…"},creatingWorkspace:{id:"onboardingStateActions.creatingWorkspace.loadingMessage",defaultMessage:"Getting ready…"},creatingWorkflowTemplate:{id:"onboardingStateActions.creatingWorkflowTemplate.loadingMessage",defaultMessage:"Getting ready…"},navigatingToWorkspace:{id:"onboardingStateActions.navigatingToWorkspace.loadingMessage",defaultMessage:"Taking you to your workspace…"},errorNoAction:{id:"onboardingStateActions.errorMessage.noActionToPerform",defaultMessage:"No action to perform for {onboardingRedirectType}"},errorWorkspaceCreationPreventedWithEmail:{id:"onboardingStateActions.errorMessage.domainClaim.workspaceCreationPreventedWithEmail",defaultMessage:"You are signed in to {userEmailAddress} and do not have access to any workspaces. Please reach out to your IT department for access to Notion."},errorWorkspaceCreationPrevented:{id:"onboardingStateActions.errorMessage.domainClaim.workspaceCreationPrevented",defaultMessage:"You do not have access to any workspaces. Please reach out to your IT department for access to Notion."},errorWorkspaceDoesNotExist:{id:"onboardingStateActions.errorMessage.spaceDoesNotExist",defaultMessage:"Workspace does not exist."},errorWorkspaceDidNotLoad:{id:"onboardingStateActions.errorMessage.spaceDidNotLoad",defaultMessage:"Failed to load workspace."}});async function pe(e){let{environment:t,startOnboardingArgs:o,onboardingData:a,redirectData:r}=e;const i=t.currentUser.id;if(void 0===i)throw new Error("Environment currentUserId not defined.");const{type:d,redirectUrl:l,disableRedirectUrl:p}=o,u=t.device.isMobile,{currentUserRootStore:f}=G().default.state,m=0===(f&&f.isReady()?v().sb(f.getSpaceViewStores().filter((e=>e.getJoined())).map((e=>e.getSpaceId()))).length:0),g=(0,ae().Os)()?"perfmark":void 0,b={onboardingData:a,redirectData:r,isOnboarding:!0,isLoading:!1,flowId:c().JW(),currentUserId:i,isNewUser:m,stageNumber:0,spaceId:void 0,historicalStages:void 0,onboardingExperiments:{},stageStats:{startedTimeStampMs:Date.now()},trialId:g,performanceMarketingTerm:a.performanceMarketingTerm};if("new-user"===d){const e=a.joinableSpaceData.results.length>0;let o;o=u?l&&!p?"mobile_redirect":e?"mobile_joinable_spaces":"mobile_cold_start":l&&!p?"desktop_redirect":e?"desktop_joinable_spaces":"desktop_cold_start";const r={...b,flow:o,stage:"profile",uploadingProfilePhoto:!1,profilePhoto:null,prefilled:!1,passwordErrorData:null,emailOptIn:(0,n().eh)(a.countryCode).defaultOptIn},i=re().TV({userStore:a.userStore});return i?me({...r,...i},t):r}if("create-or-join"===d){const e=re().md({onboardingData:a,isNewUserFlow:!1}),o=u?"mobile_join_or_create_space":"desktop_join_or_create_space";if(e.length>0)return{...b,flow:o,stage:"workspace_choose",joinableSpaces:e,prefilled:!1};if(a.canUserCreateSpace)return{...De(b),...b,flow:o,stage:"workspace_plan_choose",prefilled:!1,spaceJoinOrCreate:"create",useCases:[],collaborativeIntent:void 0};{y().FX(t,{can_user_create_space:!1,is_new_user:!1,has_joinable_spaces:!1,onboarding_stage:void 0});const e=a.userStore.getEmail();throw ie().default.setState({...b,flow:o,stage:"error"}),new(s().Xgk)(e?L().A.formatMessage(le.errorWorkspaceCreationPreventedWithEmail,{userEmailAddress:e}):L().A.formatMessage(le.errorWorkspaceCreationPrevented),{newUser:!1})}}if("mobile-onboarding"===d)return{...b,flow:"mobile_existing_user",stage:"mobile_editor",spaceJoinOrCreate:"join"};w().HB(d)}async function ue(e,t){if(!e.isOnboarding)return{isOnboarding:!1,isLoading:!1,currentUserId:t.currentUser.id};const o={...e,stageNumber:e.stageNumber+1};switch(re().zX(t),o.stage){case"profile":return me(o,t);case"workspace_plan_choose":return be(o,t);case"workspace_collaborative_intent_choose":return function(e,t){return be({...e,stage:"workspace_plan_choose"},t,!0)}(o,t);case"workspace_choose":return async function(e,t){const{redirectData:o}=e;if("guest_redirect"===o.type)return Me(e,o,"guest",t);if("create"===e.spaceJoinOrCreate)return{...De(e),planSelection:void 0,...e,stage:"workspace_plan_choose",useCases:[],collaborativeIntent:void 0};{const o=K().default.DO_NOT_USE_markLegacy("onboarding.join_space"),{spaceStore:a,spaceViewStore:n,...r}=await ke(e,t);re().BH({environment:t,state:{onboardingExperiments:e.onboardingExperiments,userPersona:"userPersona"in e?e.userPersona:void 0,userRole:"userRole"in e?e.userRole:void 0,companySize:void 0,useCases:void 0,planSelection:void 0,categories:void 0,userEducationRole:void 0,userEducationLevel:void 0,notionUseFrequency:void 0,collaborativeIntent:void 0},spaceStore:void 0,spaceViewStore:n});const{spaceId:i,spaceViewId:s,redirectData:c}=r,{flow:d}=e;switch(d){case"desktop_cold_start":case"desktop_join_or_create_space":case"desktop_redirect":case"desktop_joinable_spaces":return await he({environment:t,onboardingData:e.onboardingData,spaceId:i,spaceViewId:s,spaceJoinOrCreate:e.spaceJoinOrCreate,redirectData:c,onboardingFlow:d,onboardingState:e}),K().default.DO_NOT_USE_measureLegacy(o,{environment:t,data:{flow:e.flow,onboarding_complete_data:{stage:e.stage,redirect_data:c,is_new_user:re().ze(e),permission_level:"guest_redirect"===c.type?"guest":"member"}}}),{isOnboarding:!1,isLoading:!1,currentUserId:t.currentUser.id};case"mobile_join_or_create_space":{const o={...e,...r};return Se(e.onboardingData,o,t)}case"mobile_cold_start":case"mobile_joinable_spaces":case"mobile_redirect":{const a={...e,...r};return K().default.DO_NOT_USE_measureLegacy(o,{environment:t,data:{flow:e.flow,onboarding_complete_data:{stage:e.stage,redirect_data:c,is_new_user:re().ze(e),permission_level:"guest_redirect"===c.type?"guest":"member"}}}),ye({onboardingState:a,environment:t,flow:d})}default:return w().HB(d)}}}(o,t);case"persona_survey":return ge(o,t);case"workspace_create":return ve(o,t);case"invite":return Ie(o,t);case"timed_trial_upsell":return we(o,t);case"template_optout":return function(e,t){return{isOnboarding:!1,isLoading:!1,currentUserId:t.currentUser.id}}(0,t);case"workspace_setup":return async function(e,t){const{flow:o}=e;switch(o){case"desktop_cold_start":case"desktop_join_or_create_space":case"desktop_joinable_spaces":case"desktop_redirect":return await he({environment:t,onboardingData:e.onboardingData,spaceId:e.spaceId,spaceViewId:e.spaceViewId,spaceJoinOrCreate:e.spaceJoinOrCreate,redirectData:e.redirectData,onboardingFlow:e.flow,onboardingState:e}),{isOnboarding:!1,isLoading:!1,currentUserId:t.currentUser.id};case"mobile_join_or_create_space":return Se(e.onboardingData,e,t);case"mobile_cold_start":case"mobile_joinable_spaces":case"mobile_redirect":return D().kc(t),ye({onboardingState:e,environment:t,flow:o});default:return w().HB(o)}}(o,t);case"mobile_editor":return function(e){return{...e,stage:"mobile_sidebar"}}(o);case"mobile_sidebar":return function(e,t){if(re().FP(t))return{...e,stage:"mobile_app_download"};return{...e,stage:"mobile_desktop"}}(o,t);case"mobile_desktop":return function(e,t){return{...e,stage:"mobile_web_clipper"}}(o);case"mobile_web_clipper":return function(e,t){if("mobile_existing_user"===e.flow)return Ae(e,t);return Se(e.onboardingData,e,t)}(o,t);case"mobile_app_download":return async function(e,t){if("mobile_existing_user"===e.flow)return Ae(e,t);return Se(e.onboardingData,e,t)}(o,t);case"error":return function(e){return{isOnboarding:!1,isLoading:!1,currentUserId:e.currentUser.id}}(t);default:w().HB(o)}}function fe(e,t){if(!e.isOnboarding)throw new Error("Trying to go back on step which is not onboarding.");const o={...e,stageNumber:e.stageNumber-1};if(!ie().onboardingStagesWithBack.includes(e.stage))throw new Error(`Trying to go back in onboarding on step where back is not supported. Stage: ${e.stage}`);switch(o.stage){case"workspace_plan_choose":return function(e){const t=re().ze(e),o=re().md({onboardingData:e.onboardingData,isNewUserFlow:t});if(o.length>0)return{...e,joinableSpaces:o,stage:"workspace_choose"};if(t)throw new Error("Trying to go back to profile step from plan choose for new user!");throw new Error("Trying to go back on plan choose step for existing user with no joinable spaces!")}(o);case"workspace_collaborative_intent_choose":return function(e){return{...e,stage:"workspace_plan_choose",collaborativeIntent:void 0}}(o);case"persona_survey":return function(e){return{...e,stage:"workspace_collaborative_intent_choose"}}(o);case"workspace_create":return function(e){const t=re().ze(e);if("school"===e.planSelection||"personal"===e.planSelection)return{...e,skip:!1,prefilled:e.prefilled,previousStage:"workspace_create",userPersona:e.userPersona,spaceName:e.spaceName,stage:"persona_survey"};return t&&"team"===e.planSelection?{...e,prefilled:e.prefilled,previousStage:"workspace_create",skip:!1,userPersona:e.userPersona,spaceName:e.spaceName,stage:"persona_survey"}:{...e,stage:"workspace_collaborative_intent_choose"}}(o);case"timed_trial_upsell":return function(e){const t=re().qg(e.onboardingData);return{...e,flow:e.flow,stage:"invite",isChecked:!0,emails:[],spaceSetupCompleted:!0,joinableUserEmailDomain:t,spaceJoinOrCreate:"create",inviteLinkUrl:e.inviteLinkUrl,shouldTriggerPostInviteAnimations:!1,isBulkInvite:!1,planSelection:e.planSelection,collaborativeIntent:e.collaborativeIntent}}(o);case"mobile_editor":return function(e){const t=re().qg(e.onboardingData);return{...e,flow:e.flow,stage:"invite",isChecked:!0,emails:[],spaceSetupCompleted:!0,joinableUserEmailDomain:t,spaceJoinOrCreate:"create",shouldTriggerPostInviteAnimations:!1,isBulkInvite:!1,teamStoreId:e.teamStoreId,inviteLinkUrl:e.inviteLinkUrl,spaceViewId:e.spaceViewId,planSelection:e.planSelection,collaborativeIntent:e.collaborativeIntent}}(o);case"mobile_sidebar":return function(e){return{...e,stage:"mobile_editor"}}(o);case"mobile_desktop":case"mobile_app_download":return function(e){return{...e,stage:"mobile_sidebar"}}(o);case"mobile_web_clipper":return function(e,t){return{...e,stage:"mobile_desktop"}}(o);case"workspace_choose":case"invite":case"template_optout":case"workspace_setup":case"profile":case"error":return null;default:w().HB(o)}}async function me(e,t){await re().cp(e,t);const{password:o,...n}=e,r=b().A.get(re().Zz),{onboardingData:i,redirectData:c}=n,d=re().md({onboardingData:i,isNewUserFlow:re().up(n)});if("guest_redirect"===c.type)return Me(n,c,"guest",t);if("redirect_page"===c.type||"redirect_space"===c.type)return Me(n,c,"member",t);if("public_access_page_redirect"===c.type)return function(e,t,o){return Te({environment:o,permissionLevel:"public",onboardingState:e}),M().uK({environment:o,store:new(X().Bv)(o,{table:p().ev,id:t.pageId}),pageVisitSource:a().y8.Onboarding}),{isOnboarding:!1,isLoading:!1,currentUserId:o.currentUser.id}}(n,c,t);if(r){const e=await T().callApi({eventName:"getPublicSpaceForInvite",environment:t,data:{type:"invite-link",inviteLinkCode:r}});if("success"===e.type){const{data:o}=e,{result:a}=o;if(a)return Me(n,{type:"team_invite_redirect",spaceId:a.id,inviteCode:r},"member",t);throw new Error(L().A.formatMessage(le.errorWorkspaceDoesNotExist))}throw new Error(L().A.formatMessage(le.errorWorkspaceDidNotLoad))}if(d.length>0)return{...n,joinableSpaces:d,stage:"workspace_choose"};if(i.canUserCreateSpace){if(re().OU({state:n})){return{...n,spaceJoinOrCreate:"create",userPersona:void 0,useCases:[],stage:"workspace_plan_choose",planSelection:void 0,collaborativeIntent:void 0}}return{spaceName:void 0,...n,spaceJoinOrCreate:"create",userPersona:void 0,userRole:void 0,companySize:void 0,useCases:[],categories:[],stage:"persona_survey",skip:!1,previousStage:"profile",planSelection:void 0,collaborativeIntent:void 0}}{y().FX(t,{can_user_create_space:!1,is_new_user:!0,has_joinable_spaces:!1,onboarding_stage:n.stage});const o=i.userStore.getEmail();throw ie().default.setState({...e,stage:"error"}),new(s().Xgk)(o?L().A.formatMessage(le.errorWorkspaceCreationPreventedWithEmail,{userEmailAddress:o}):L().A.formatMessage(le.errorWorkspaceCreationPrevented),{newUser:!0})}}function ge(e,t){!e.skip&&e.isNewUser&&function(e,t){const{onboardingData:o,userPersona:a,userRole:n,useCases:r,companySize:i}=t;U().createAndCommit({userAction:"onboardingStateActions.setUserPersonaRoleAndUseCases",environment:e,canUndo:!0,perform:e=>{x().mJ({userSettingsStore:o.userSettingsStore,data:{persona:a,team_role:n,use_cases:r,company_size:i,persona_version:{version:"V4",timestamp:(new Date).getTime()}},transaction:e})}})}(t,e);const{onboardingData:o}=e,a=L().A.getIntl(),n={spaceIcon:null,uploadingSpaceIcon:!1,...De(e),...e,spaceJoinOrCreate:"create",userPersona:e.userPersona,stage:"workspace_create"},r=o.userStore.getFullName(a);if("planSelection"in n&&["personal","school"].includes(n.planSelection||"")&&r){const e=o.userStore.getProfilePhoto();return ve({...n,userPersona:n.userPersona||"unfilled",spaceName:re().JR(r,a),spaceIcon:e||null},t)}return n}function be(e,t,o){const a="school"===e.planSelection||"personal"===e.planSelection,n=re().OU({state:e}),r={userRole:void 0,companySize:void 0,spaceName:void 0,categories:[],...e,skip:!1,stage:"persona_survey",previousStage:"workspace_plan_choose"};if(!o)return{...r,collaborativeIntent:void 0,stage:"workspace_collaborative_intent_choose"};if(n||a)return"team"===e.planSelection||a?r:ge({...e,skip:!0,userPersona:void 0,userRole:void 0,companySize:void 0,useCases:[],categories:[],previousStage:"workspace_plan_choose",spaceName:void 0,stage:"persona_survey",collaborativeIntent:void 0},t);{if("team"===e.planSelection)return r;const o={userRole:void 0,companySize:void 0,...e,spaceJoinOrCreate:"create",useCases:[],categories:[],stage:"workspace_create",spaceIcon:null,uploadingSpaceIcon:!1},{onboardingData:a}=e,n=L().A.getIntl(),i=a.userStore.getFullName(n),s=a.userStore.getProfilePhoto();if("planSelection"in e&&["personal","school"].includes(e.planSelection||"")&&i){return ve({...o,userPersona:e.userPersona||"unfilled",spaceName:re().JR(i,n),spaceIcon:s||null,useCases:e.useCases},t)}return o}}async function ve(e,t){const{flow:o,spaceJoinOrCreate:a,onboardingData:n}=e,r=K().default.DO_NOT_USE_markLegacy("onboarding.create_space"),{spaceStore:i,spaceViewStore:s,...c}=await ke(e,t);if(re().BH({environment:t,state:{...e,userEducationRole:void 0,userEducationLevel:void 0,notionUseFrequency:void 0},spaceStore:i,spaceViewStore:s}),"team"===e.planSelection){const o=re().qg(e.onboardingData),{spaceId:a,inviteLinkCode:n}=c;if(K().default.DO_NOT_USE_measureLegacy(r,{environment:t,data:{flow:e.flow,onboarding_complete_data:{stage:e.stage,redirect_data:e.redirectData,is_new_user:re().ze(e),permission_level:"guest_redirect"===e.redirectData.type?"guest":"member",plan:e.planSelection}}}),e.collaborativeIntent&&"multiplayer"!==e.collaborativeIntent){return Ie({...e,isChecked:!1,stage:"invite",isBulkInvite:!1,spaceSetupCompleted:!0,shouldTriggerPostInviteAnimations:!1,inviteLinkUrl:void 0,emails:[],spaceViewId:s.id,joinableUserEmailDomain:void 0,teamStoreId:void 0},t)}return{...e,...c,isChecked:!0,spaceId:a,emails:[],joinableUserEmailDomain:o,inviteLinkUrl:n&&(0,q().X$)(t,a,n),stage:"invite",isBulkInvite:!1,shouldTriggerPostInviteAnimations:!1,spaceSetupCompleted:!0}}switch(o){case"desktop_cold_start":case"desktop_join_or_create_space":case"desktop_joinable_spaces":case"desktop_redirect":const{spaceId:i,spaceViewId:d,redirectData:l}=c;if(e.collaborativeIntent&&"multiplayer"===e.collaborativeIntent){return{...e,isChecked:!1,stage:"invite",isBulkInvite:!1,spaceSetupCompleted:!0,shouldTriggerPostInviteAnimations:!1,inviteLinkUrl:void 0,emails:[],spaceViewId:s.id,joinableUserEmailDomain:void 0,teamStoreId:void 0}}return R().m({message:le.navigatingToWorkspace}),await he({environment:t,onboardingData:n,spaceId:i,spaceViewId:d,spaceJoinOrCreate:a,redirectData:l,onboardingFlow:o,onboardingState:e}),R().V(),K().default.DO_NOT_USE_measureLegacy(r,{environment:t,data:{flow:e.flow,onboarding_complete_data:{stage:e.stage,redirect_data:e.redirectData,is_new_user:re().ze(e),permission_level:"guest_redirect"===e.redirectData.type?"guest":"member",plan:e.planSelection}}}),{...e,spaceId:i,spaceViewId:d,flow:o,stage:"template_optout"};case"mobile_join_or_create_space":return Se(e.onboardingData,{...e,...c},t,r);case"mobile_cold_start":case"mobile_joinable_spaces":case"mobile_redirect":return ye({onboardingState:{...e,...c},environment:t,flow:o});default:return w().HB(o)}}async function Ie(e,t){const o=K().default.DO_NOT_USE_markLegacy("invite_next_state");await re().TM(e,t);const{flow:a,isNewUser:n,trialId:r}=e;switch(a){case"desktop_cold_start":case"desktop_join_or_create_space":case"desktop_joinable_spaces":if("team"!==e.planSelection)return await he({environment:t,onboardingData:e.onboardingData,spaceId:e.spaceId,spaceViewId:e.spaceViewId,spaceJoinOrCreate:e.spaceJoinOrCreate,redirectData:e.redirectData,onboardingFlow:e.flow,onboardingState:e}),K().default.DO_NOT_USE_measureLegacy(o,{environment:t,data:{numInvitesSent:e.emails.length}}),{isOnboarding:!1,isLoading:!1,currentUserId:t.currentUser.id};return n&&"perfmark"===r||(0,ee().i4)(t)?(await he({environment:t,onboardingData:e.onboardingData,spaceId:e.spaceId,spaceViewId:e.spaceViewId,spaceJoinOrCreate:e.spaceJoinOrCreate,redirectData:e.redirectData,onboardingFlow:e.flow,onboardingState:e}),K().default.DO_NOT_USE_measureLegacy(o,{environment:t,data:{numInvitesSent:e.emails.length}}),Oe(e,t)):{...e,stage:"timed_trial_upsell"};case"desktop_redirect":return await he({environment:t,onboardingData:e.onboardingData,spaceId:e.spaceId,spaceViewId:e.spaceViewId,spaceJoinOrCreate:e.spaceJoinOrCreate,redirectData:e.redirectData,onboardingFlow:e.flow,onboardingState:e}),K().default.DO_NOT_USE_measureLegacy(o,{environment:t,data:{numInvitesSent:e.emails.length}}),"team"===e.planSelection?Oe(e,t):{isOnboarding:!1,isLoading:!1,currentUserId:t.currentUser.id};case"mobile_join_or_create_space":const i=Se(e.onboardingData,e,t);return K().default.DO_NOT_USE_measureLegacy(o,{environment:t,data:{mobileOnboardingState:a}}),i;case"mobile_cold_start":case"mobile_joinable_spaces":case"mobile_redirect":const s=ye({onboardingState:e,environment:t,flow:a});return K().default.DO_NOT_USE_measureLegacy(o,{environment:t,data:{mobileOnboardingState:a}}),s;default:return w().HB(a)}}async function we(e,t){return await he({environment:t,onboardingData:e.onboardingData,spaceId:e.spaceId,spaceViewId:e.spaceViewId,spaceJoinOrCreate:e.spaceJoinOrCreate,redirectData:e.redirectData,onboardingFlow:e.flow,onboardingState:e}),Oe(e,t)}async function Se(e,t,o,a){return await he({environment:o,onboardingData:e,spaceId:t.spaceId,spaceViewId:t.spaceViewId,spaceJoinOrCreate:t.spaceJoinOrCreate,redirectData:t.redirectData,onboardingFlow:t.flow,onboardingState:t}),a&&K().default.DO_NOT_USE_measureLegacy(a,{environment:o,data:{flow:t.flow,onboarding_complete_data:{stage:t.stage,redirect_data:t.redirectData,is_new_user:re().ze(t),permission_level:"guest_redirect"===t.redirectData.type?"guest":"member"}}}),{isOnboarding:!1,isLoading:!1,currentUserId:o.currentUser.id}}function ye(e){const{onboardingState:t,environment:o,flow:a}=e;if("oauth_authorization_redirect"===t.redirectData.type){const{responseType:e,integrationId:a,redirectUri:n,state:r,owner:i,userId:s,spaceId:c}=t.redirectData;A().t({environment:o,responseType:e,integrationId:a,redirectUri:n,state:r,owner:i,userId:s,spaceId:c})}return{...t,flow:a,stage:"mobile_editor"}}async function he(e){const{environment:t,redirectData:o,spaceViewId:a,spaceId:n,onboardingData:r,spaceJoinOrCreate:i,onboardingFlow:s,onboardingState:c}=e;await _e({environment:t,redirectData:o,spaceViewId:a,spaceId:n,onboardingData:r,spaceJoinOrCreate:i,onboardingFlow:s}),Te({environment:t,spaceJoinOrCreate:i,permissionLevel:"member",onboardingState:c})}async function _e(e){const{environment:t,redirectData:o,spaceViewId:n,spaceId:r,onboardingData:i,spaceJoinOrCreate:s,onboardingFlow:c}=e;k().zA({bannerStore:H().A,id:"SubscriptionEditingBlocker"}),t.device.isMobile&&U().createAndCommit({userAction:"onboardingStateActions.navigateWithRedirectData",environment:t,canUndo:!0,perform:e=>{de().PF({userStore:i.userStore,transaction:e})}});const f=n?X().vH.createChildStore(i.userRootStore,{table:m().mu,id:n}):void 0,b=g().dw();if("fork_page"===o.type&&f)await N().tR({environment:t,spaceViewStore:f,redirectPageId:o.pageId,userSettingsStore:i.userSettingsStore,userRootStore:i.userRootStore,isNewlyCreatedSpace:"create"===s,pageVisitSource:a().y8.Onboarding,navigationType:"joiningOrCreatingSpace"});else if(b&&!i.onboardingCompleted)g().dC(),D().oo({environment:t,url:b,redirect:!0});else if("home"===o.type&&null!=f&&f.isDefined()){const e=await T().callApi({eventName:"getUserHomePages",environment:t,data:{spaceViewId:f.id,spaceId:f.getSpaceId()},headers:(0,d().WS)({cellId:void 0,recordId:f.id,spaceId:f.getSpaceId()})}),{recordMap:o,homePageId:n}="success"===e.type?{recordMap:l().RecordMapWithRole.create(e.data.recordMap),homePageId:e.data.homePageId}:{recordMap:void 0,homePageId:void 0},r=f.pointer;o&&P().PC({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:r,model:o.getModel(r),role:o.getRole(r)||"none",updatePaths:[["settings","personal_home"]],debugSource:"onboardingStateActions.navigateWithRedirectData",force:!0}),await N().tR({environment:t,redirectPageId:n,spaceViewStore:f,userSettingsStore:i.userSettingsStore,userRootStore:i.userRootStore,isNewlyCreatedSpace:"create"===s,pageVisitSource:a().y8.Onboarding,navigationType:"joiningOrCreatingSpace"})}else if("redirect_page"===o.type&&o.spaceId===r&&f)await P().sy({environment:t,pointer:{table:p().ev,id:o.pageId},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,userId:t.currentUser.id}),await N().tR({environment:t,spaceViewStore:f,redirectPageId:o.pageId,userSettingsStore:i.userSettingsStore,userRootStore:i.userRootStore,isNewlyCreatedSpace:"create"===s,pageVisitSource:a().y8.Onboarding,navigationType:"joiningOrCreatingSpace"});else if("redirect_space"===o.type&&o.spaceId===r&&f)await N().tR({environment:t,spaceViewStore:f,userSettingsStore:i.userSettingsStore,userRootStore:i.userRootStore,isNewlyCreatedSpace:"create"===s,pageVisitSource:a().y8.Onboarding,navigationType:"joiningOrCreatingSpace"});else if("mobile_native_home"===o.type&&f)await N().tR({environment:t,spaceViewStore:f,redirectPageId:void 0,userSettingsStore:i.userSettingsStore,userRootStore:i.userRootStore,isNewlyCreatedSpace:"create"===s,pageVisitSource:a().y8.Onboarding,navigationType:"joiningOrCreatingSpace"});else if("getting_started_page"!==o.type&&"redirect_space"!==o.type&&"performance_marketing_template"!==o.type||!f)if("oauth_authorization_redirect"===o.type&&"mobile_cold_start"!==c&&"mobile_joinable_spaces"!==c&&"mobile_redirect"!==c){const{responseType:e,integrationId:a,redirectUri:n,state:r,owner:i,userId:s,spaceId:c}=o;A().t({environment:t,responseType:e,integrationId:a,redirectUri:n,state:r,owner:i,userId:s,spaceId:c})}else if(f)await N().tR({environment:t,spaceViewStore:f,userSettingsStore:i.userSettingsStore,userRootStore:i.userRootStore,isNewlyCreatedSpace:"create"===s,pageVisitSource:a().y8.Onboarding,navigationType:"joiningOrCreatingSpace"});else{if(!i.firstSpaceView)throw new Error(L().A.formatMessage(le.errorNoAction,{onboardingRedirectType:o.type}));await N().tR({environment:t,spaceViewStore:i.firstSpaceView,userSettingsStore:i.userSettingsStore,userRootStore:i.userRootStore,isNewlyCreatedSpace:"create"===s,pageVisitSource:a().y8.Onboarding,navigationType:"joiningOrCreatingSpace"})}else{let e;if("getting_started_page"===o.type&&o.collectionId){const a=X().md.createChildStore(f.getSpaceStore(),{table:u().Vl,id:o.collectionId});e=(await(0,V().VZ)({environment:t,collectionStore:a})).collectionViewBlockStore()}await N().tR({environment:t,spaceViewStore:f,redirectPageId:o.pageId,userSettingsStore:i.userSettingsStore,userRootStore:i.userRootStore,isNewlyCreatedSpace:"create"===s,pageVisitSource:a().y8.Onboarding,navigationType:"joiningOrCreatingSpace",navigateToStore:e})}}function Te(e){const{environment:t,onboardingState:o}=e;if(t.device.isElectron&&C().quickSearchRefresh(),!o.isOnboarding)return;const{onboardingData:{userStore:a}}=o;U().createAndCommit({userAction:"onboardingStateActions.setAndTrackOnboardingComplete",environment:t,canUndo:!0,perform:e=>{de().LC({userStore:a,transaction:e})}}),h().IA(t,{...re().M6(o),initial_workspace_type:"public"!==e.permissionLevel?e.spaceJoinOrCreate:void 0,permission_level:e.permissionLevel}),_().Kc(t)}async function ke(e,t){if("join"===e.spaceJoinOrCreate){R().m({message:le.joiningWorkspace});const o=await Re({environment:t,onboardingData:e.onboardingData,redirectData:e.redirectData,spaceId:e.spaceId||"",isNewUserOnboarding:re().ze(e)});return R().V(),o}{R().m({message:le.creatingWorkspace});const o=await Ce({environment:t,isNewUserOnboarding:re().ze(e),onboardingData:e.onboardingData,userPersona:e.userPersona,redirectData:e.redirectData,spaceName:e.spaceName,spaceIcon:e.spaceIcon,planSelection:e.planSelection,isPrivate:"team"!==e.planSelection,useCases:e.useCases,categories:e.categories,hasTrialId:Boolean(e.trialId),selectedWorkflowTemplates:[]}),a=e.isNewUser&&"perfmark"===e.trialId;if(!a&&(0,ee().i4)(t)&&"team"===e.planSelection){await(0,te().applyReversePlusTrial)(o.spaceId,t,"onboarding")&&(0,$().UW)(t,"onboarding_reverse_trial_sidebar")}if(a&&e.planSelection&&re().ze(e)){const a=await Ne(o.spaceId,e.planSelection,t),{enableTrialInfoModal:n,enableTrialIneligibleToast:r}=a;n&&(0,oe().fR)({openedFrom:"onboarding"}),r&&se().A.setState({open:!0,isExistingUser:!1})}return R().V(),o}}async function Ce(e){const{environment:t,onboardingData:o,userPersona:a,redirectData:n,spaceName:i,planSelection:s,spaceIcon:c,isPrivate:d,useCases:l,categories:p,isNewUserOnboarding:u,selectedWorkflowTemplates:f,collaborativeIntent:m,source:g,createTemplates:b=!0}=e,v="team"===s?"team":"personal",I=K().default.DO_NOT_USE_markLegacy("create_space_with_templates"),{spaceStore:w,spaceViewStore:S,inviteLinkCode:y,teamStore:_}=await N().bz({environment:t,planType:v,planSelection:s,name:i,userRootStore:o.userRootStore,analyticsFrom:"onboarding",icon:c||void 0,userPersona:a,collaborativeIntent:m,source:g}),T=w.getCreatedById()===t.currentUser.id;let k;(0,Z().f1)({environment:t,experimentId:"adoption_hide_features_v2",variant:[...r().Dx.adoption_hide_features_v2],isUserWorkspaceOwner:T,isDesktop:t.device.isDesktop})&&x().Mg({environment:t,experimentId:"adoption_hide_features_v2"}),ie().default.setState({...ie().default.state,spaceId:w.id}),await Y().$D({environment:t,spaceId:w.id,isNewlyCreatedSpace:!0}),!(0,B().isAiOnboardingFlow)(z().A.state.flowName)&&J().default.checkGate({gateName:"enable_write_survey_data_optimization"})&&((0,F().setUserAndSpaceSurveyData)({environment:t,onboardingState:z().A.state,planSelection:s,spaceStore:w,spaceViewStore:S}),(0,F().DO_NOT_USE_setUserPersonaRoleAndUseCases)(t,z().A.state));let C=[],R={};if(b&&re().sr(v)&&!o.performanceMarketingTerm){let e=[],o=[],a=[];(0,B().isWorkflowTemplatesEnabledForOnboarding)(t)?(a=[...f??[],...Ue(l)],e=l.includes("wikis")?[E().wikiAppTemplateUri]:[]):(e=(0,E().getAppTemplatePresetsForUseCases)(l),o=(0,ce().getPageTemplatesForUseCases)(l,L().A.getIntl())),R={appTemplates:e,pageTemplates:o,workflowTemplates:a}}else if(b){let e=[];e=o.performanceMarketingTerm?(0,ce().getPerformanceMarketingSearchTermTemplates)(o.performanceMarketingTerm,L().A.getIntl()):ce().getStarterTemplatesForSpace({environment:t,onboardingPlanType:s,categories:p,intl:L().A.getIntl()}),e&&(C=e.map((e=>e.rootId))),R={pageTemplates:e}}k=await ce().createTemplatePagesInSpace({environment:t,redirectData:n,spaceViewStore:S,userSettingsStore:o.userSettingsStore,userRootStore:o.userRootStore,isPrivate:d,templatesToCreateInSpace:R,planType:v,spaceJoinOrCreate:"create",teamStore:_,useCases:l,userPersona:a,isNewUserOnboarding:u}),h().rn(t,{plan_selection:s,user_persona:a,initial_workspace_type:"create",space_id:w.id,onboarding_templates:C}),K().default.DO_NOT_USE_measureLegacy(I,{environment:t,data:{}});const A=Pe(n,k,t),P="pageId"in A?A.pageId:void 0;return z().A.setState({...z().A.state,onboardingData:{...o,redirectPageId:P}}),{redirectData:A,spaceId:w.id,spaceViewId:S.id,inviteLinkCode:y,spaceStore:w,spaceViewStore:S,teamStoreId:null==_?void 0:_.id}}async function Re(e){const{environment:t,onboardingData:o,spaceId:a,redirectData:n,isNewUserOnboarding:r}=e,i="team_invite_redirect"===n.type?n.inviteCode:void 0,{spaceViewStore:s}=await N().DT({environment:t,spaceId:a,userRootStore:o.userRootStore,analyticsFrom:"onboarding",userSettingsStore:o.userSettingsStore,inviteCode:i,isOnboarding:!0});G().default.state.currentSpaceStore||G().default.setState({...G().default.state,currentSpaceStore:s.getSpaceStore()});const c=ce().getStarterTemplatesForSpace({environment:t,onboardingPlanType:"team",categories:[],isJoiner:!0,intl:L().A.getIntl()}),d=await ce().createTemplatePagesInSpace({environment:t,redirectData:n,spaceViewStore:s,isPrivate:!0,userSettingsStore:o.userSettingsStore,userRootStore:o.userRootStore,templatesToCreateInSpace:{pageTemplates:c},planType:"team",spaceJoinOrCreate:"join",useCases:[],userPersona:"unfilled",isNewUserOnboarding:r});h().xs(t,{initial_workspace_type:"join",space_id:a,onboarding_templates:null==c?void 0:c.map((e=>e.rootId))});return{redirectData:Pe(n,d,t),spaceId:a,spaceViewId:s.id,inviteLinkCode:void 0,spaceStore:void 0,spaceViewStore:s,teamStoreId:void 0}}async function Ae(e,t){const o=await async function(e,t){const o="spaceId"in e.redirectData&&e.redirectData.spaceId,{onboardingData:a,redirectData:n}=e;if(o){const r=await Re({environment:t,onboardingData:a,redirectData:n,spaceId:o,isNewUserOnboarding:re().ze(e)});return{...e,...r,spaceId:o}}if("fork_page"===n.type){const o=Q().jU(a.userRootStore);if(o.length>0){const r=o[0].getSpaceId();if(r){const i=X().SL.createChildStore(a.userRootStore,{table:f().NX,id:r}),s=Pe(n,await O().sg({environment:t,userRootStore:a.userRootStore,isPrivate:!0,forkedPageId:n.pageId,spaceStore:i,spaceViewStore:o[0]}),t);return{...e,redirectData:s,spaceViewId:o[0].id,spaceId:r}}}}return e}(e,t);return Se(e.onboardingData,o,t)}function Pe(e,t,o){if(t){if("redirect_space"===e.type)return{type:e.type,pageId:t.id,spaceId:e.spaceId};if("getting_started_page"===e.type)return re().zX(o)?{type:"mobile_native_home"}:{type:e.type,pageId:t.id};if("fork_page"===e.type)return{type:e.type,pageId:t.id};if("performance_marketing_template"===e.type)return{type:e.type,pageId:t.id}}return e}async function Me(e,t,o,a){const{onboardingData:n}=e,r=K().default.DO_NOT_USE_markLegacy("onboarding.join_space");if("guest"===o){if(Te({environment:a,spaceJoinOrCreate:"join",permissionLevel:o,onboardingState:e}),"team_invite_redirect"===t.type)throw new Error("Cannot invite guests to workspace from invite links.");await N().DT({environment:a,spaceId:t.spaceId,userRootStore:n.userRootStore,analyticsFrom:"onboarding",userSettingsStore:n.userSettingsStore,navigate:!0,redirectPageId:t.pageId})}else{const o=await Re({environment:a,onboardingData:n,redirectData:t,spaceId:t.spaceId,isNewUserOnboarding:re().ze(e)});await he({environment:a,onboardingData:n,spaceId:o.spaceId,spaceViewId:o.spaceViewId,spaceJoinOrCreate:"join",redirectData:o.redirectData,onboardingFlow:e.flow,onboardingState:e})}return K().default.DO_NOT_USE_measureLegacy(r,{environment:a,data:{flow:e.flow,onboarding_complete_data:{stage:e.stage,redirect_data:t,is_new_user:re().ze(e),permission_level:o}}}),{isOnboarding:!1,isLoading:!1,currentUserId:a.currentUser.id}}function De(e){let t;e.onboardingData.isEducationPlanEligible&&(t="student");const{function:o}=(0,q().p3)();return o&&(t=o),{userPersona:t}}async function Ne(e,t,o){let a=!1,n=!1;const r=await T().callApi({eventName:"checkAndApplyPerfmarkTrial",environment:o,data:{spaceId:e}});if("success"===r.type){const e="success"===r.data.status;(0,W().u4)({environment:o,event:{eventName:"trial_apply_attempt",eventProperties:{trial_id:"perfmark",success:e,planType:t,..."error"===r.data.status&&{reason:r.data.reason}}}}),S().D$(o,{trial_id:"perfmark",success:e,planType:t,domainType:(0,j().FX)()}),"success"===r.data.status?a=!0:n=!0}else(0,W().u4)({environment:o,event:{eventName:"trial_apply_attempt",eventProperties:{trial_id:"perfmark",success:!1,planType:t,reason:r.error.name}}}),S().D$(o,{trial_id:"perfmark",success:!1,planType:t}),i().log({level:"error",from:"onboardingActions",type:"applyPerfmarkTrialError",error:(0,I().convertErrorToLog)(r.error)});return(0,ae().Q8)(),{enableTrialInfoModal:a,enableTrialIneligibleToast:n}}function Oe(e,t,o,a){return"create"===e.spaceJoinOrCreate&&e.isNewUser&&!o&&ne().default.setState({type:"team_creator",step:"welcome",initialTeamStoreId:e.teamStoreId}),"modal"===o&&(0,oe().fR)({openedFrom:"onboarding"}),"sidebar"===o&&(0,$().UW)(t,"onboarding_reverse_trial_sidebar"),a&&se().A.setState({open:!0,isExistingUser:!1}),{isOnboarding:!1,isLoading:!1,currentUserId:t.currentUser.id}}function Ue(e){return e.map((e=>xe(e))).filter((e=>void 0!==e))}function xe(e){switch(e){case"docs":return"docsCollection";case"project":return"projectsCollection";case"notes":return"meetingNotesCollection";case"goals":return"goalsCollection";default:return}}},655765:(e,t,o)=>{o.r(t),o.d(t,{applyMultiplayerReverseTrialIfEligible:()=>d().V_,applyReverseBusinessTrial:()=>d().xX,applyReversePlusTrial:()=>d().xE,handleTrialUpgradeFromOnboarding:()=>d().WR,handleTrialUpgradeFromOnboardingImpl:()=>d().eu,isEligibleForBlockLimitTimedTrial:()=>c});var a=()=>o(130382),n=()=>o(762433),r=()=>o(57605),i=()=>o(128265),s=()=>o(749356);async function c(e,t){const o=await r().A.awaitData(e,{spaceId:null==t?void 0:t.id});if("free"!==(0,n().AI)(o))return!1;const c=null==t?void 0:t.getSetting("reach_block_limit_time");if(!c||(0,a().Mn)(c)<3)return!1;if(await(0,i().G)(e))return!1;const d=t.getSpaceId();return!!(await(0,s().L6)({environment:e,spaceId:d,offerCampaign:"default"}))}var d=()=>o(66460)},691093:(e,t,o)=>{o.r(t),o.d(t,{closeWorkflowEditor:()=>u,onConfigItemClick:()=>l,showWorkflowEditor:()=>p});var a=()=>o(496603),n=()=>o(435009),r=()=>o(118078),i=()=>o(890754),s=()=>o(492414),c=()=>o(351360),d=()=>o(564037);function l(e){const{environment:t,navigationState:o,parentStore:n}=e,r=(0,d().getCurrentWorkflowNavigationState)(t);(0,a().n4)(r,o)?p({environment:t,navigationState:{isOpen:!0,type:"configure"},parentStore:n}):p({environment:t,navigationState:o,parentStore:n})}function p(e){const{environment:t,parentStore:o,redirect:a}=e,l=(0,d().getMergedWorkflowNavigationState)({defaultNavigationState:(0,d().getDefaultOpenNavigationState)(),currentNavigationState:(0,d().getCurrentWorkflowNavigationState)(t),newNavigationState:e.navigationState}),p=(0,i().getMergedChatSidebarState)({environment:t,update:e.chatSidebarState}),u=(0,d().routeArgsGivenNavigationState)(l),f=(0,i().routeArgsGivenChatSidebarState)(p);(0,r().maybeCloseNotionSidebar)({environment:t});const m=(0,s().Ef)({environment:t,updates:{...u,...f,store:o}}),g=void 0!==o&&c().default.state.mainEditorCurrentBlockStore!==o;n().oo({environment:t,url:m,redirect:a??!g})}function u(e){const{environment:t,newStore:o,redirect:a}=e,c=(0,d().routeArgsGivenNavigationState)((0,d().getDefaultClosedNavigationState)()),l=(0,i().routeArgsGivenChatSidebarState)(i().CLOSED_CHAT_SIDEBAR_STATE),p=(0,s().Ef)({environment:t,updates:{...c,...l,store:o}});(0,r().maybeOpenNotionSidebar)(),n().oo({environment:t,url:p,redirect:a??!0})}},706461:(e,t,o)=>{o.d(t,{PJ:()=>f,_o:()=>u,dK:()=>s,sD:()=>p,uS:()=>i});o(16280),o(944114),o(898992),o(430670),o(803949),o(581454);var a=()=>o(496603),n=()=>o(534177),r=()=>o(252050);const i="\x3c!--<selection>--\x3e",s="\x3c!--</selection>--\x3e";function c(e){const{node:t,selection:o,path:p,onlyAllowPropertyTypes:u,namespace:f}=e;if(p.includes(t))throw new Error("Circular reference detected!");const m=[...p,t],g=[];if("text"===t.type)for(const a of t.value)g.push(a);else{let e="";e+=`<${t.tagName}`;for(const[o,a]of Object.entries(t.attributes||{}))void 0!==a&&(e+=` ${o}="${a}"`);const p=`</${t.tagName}>`;if("block"===t.type){const r="block"===t.type&&"block"===(null==o?void 0:o.type)&&o.blockIds[0]===t.attributes.id,b="block"===t.type&&"block"===(null==o?void 0:o.type)&&o.blockIds[o.blockIds.length-1]===t.attributes.id,v="block"===t.type&&"text"===(null==o?void 0:o.type)&&(o.start.blockId===t.attributes.id||o.end.blockId===t.attributes.id);r&&g.push(i);if(0===t.text.length&&0===Object.values(t.properties).length&&0===Object.values(t.schemas).length&&0===t.children.length&&!v)g.push(`${e}/>`);else{g.push(`${e}>`);const r=[];if(t.text)for(const e of t.text){const t=c({node:e,selection:o,path:m,onlyAllowPropertyTypes:u,namespace:f});for(const e of t)r.push(e)}let b,v;"text"===(null==o?void 0:o.type)&&o.start.blockId===t.attributes.id&&(b=o.start.index),"text"===(null==o?void 0:o.type)&&o.end.blockId===t.attributes.id&&(v=o.end.index);for(let e=0;e<r.length;e++){const t=r[e];let a="";(0,n().O9)(o)&&e===b&&(a+=i),(0,n().O9)(o)&&e===v&&(a+=s),a+=t,g.push(a)}if((0,n().O9)(o)&&b===r.length&&g.push(i),(0,n().O9)(o)&&v===r.length&&g.push(s),"end_to_end"!==f&&"tr"===t.tagName){a().Ul(Object.values(t.properties),(e=>Number(e.attributes.name))).forEach(((e,a)=>{const n=t.parent&&"table"===t.parent.tagName?t.parent:void 0,r=n&&n.attributes["header-row"],i=n&&"table"===n.tagName&&n.attributes["header-column"],s=n&&0===n.children.indexOf(t),d=r&&0===a||i&&s?"th":"td";g.push(`<${d}>`),g.push(...e.children.flatMap((e=>c({node:e,selection:o,path:m,onlyAllowPropertyTypes:u,namespace:f})))),g.push(`</${d}>`)}))}else{const e=function(e){const{tagName:t,properties:o}=e;if("tr"===t)return o;const a=[];for(const n of o){const e=l(n),o="page"===t;("property-title"===n.tagName||!e||o&&a.length<d)&&a.push(n)}return a}({tagName:t.tagName,properties:Object.values(t.properties)});for(const t of e)u&&!u.includes(t.tagName)||g.push(...c({node:t,selection:o,path:m,onlyAllowPropertyTypes:u,namespace:f}))}for(const e of Object.values(t.schemas))g.push(...c({node:e,selection:o,path:m,onlyAllowPropertyTypes:u,namespace:f}));if(t.children)for(const e of t.children){const t=c({node:e,selection:o,path:m,onlyAllowPropertyTypes:u,namespace:f});for(const e of t)g.push(e)}g.push(p)}(0,n().O9)(o)&&b&&g.push(s)}else if("collection"===t.type){g.push(`${e}>`);for(const e of Object.values(t.properties))u&&!u.includes(e.tagName)||g.push(...c({node:e,selection:o,path:m,onlyAllowPropertyTypes:u,namespace:f}));for(const e of Object.values(t.schemas))g.push(...c({node:e,selection:o,path:m,onlyAllowPropertyTypes:u,namespace:f}));g.push(p)}else{const a=(0,n().u0)((e=>"collection"===e.type||"collectionView"===e.type?{true:e}:{false:e}));if(a(t)||0===t.children.length)g.push(`${e}/>`);else{const i=[];if(!a(t)&&t.children)for(const e of t.children){const t=c({node:e,selection:o,path:m,onlyAllowPropertyTypes:u,namespace:f});for(const e of t)i.push(e)}if(i.length<=1||(0,n().O)(r()._S,t.tagName)&&r()._S[t.tagName].isToken)g.push(`${e}>${i.join("")}${p}`);else for(let t=0;t<i.length;t++){const o=i[t];0===t?g.push(`${e}>${o}`):t===i.length-1?g.push(o+p):g.push(o)}}}}return g}const d=20;function l(e){return"property-checkbox"!==e.tagName&&("property-number"===e.tagName?!e.attributes.number:0===e.children.length)}function p(e){const{node:t,selection:o,onlyAllowPropertyTypes:a,namespace:n}=e;return c({node:t,selection:o,path:[],onlyAllowPropertyTypes:a,namespace:n}).join("")}function u(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r="";if(t){r+="\n";for(let e=0;e<o;e++)r+="\t"}if("text"===e.type)r+=n?a().ih(e.value):e.value;else{r+=`<${e.tagName}`;for(const[t,o]of Object.entries(e.attributes||{}))r+=` ${t}="${o}"`;if(e.children&&e.children.length>0){r+=">";for(const a of e.children)r+=u(a,t,o+1,n);if(t){r+="\n";for(let e=0;e<o;e++)r+="\t"}r+=`</${e.tagName}>`}else r+="/>"}return r}function f(e){return e.map((e=>u(e))).join("")}},717375:(e,t,o)=>{o.d(t,{Ol:()=>c,ak:()=>l,bl:()=>u,xm:()=>p});o(898992),o(354520),o(581454);var a=()=>o(370657),n=()=>o(534177),r=()=>o(640653),i=()=>o(508496),s=()=>o(46986);function c(e){const{spaceStore:t,config:o}=e;if("researcher"===o.type){const e=i().default.checkGate({gateName:"ai_research_mode_web_search"});return{...o,useWebSearch:e&&!(0,r().Ar)(t)}}return o}function d(e){const{spaceStore:t,configs:o}=e;return o.map((e=>c({spaceStore:t,config:e}))).filter(n().O9)}function l(e){const{spaceStore:t}=e;return d({spaceStore:t,configs:(0,a().qG)({agentEnabled:(0,s().aj)()})})}function p(e){const{spaceStore:t}=e;return d({spaceStore:t,configs:a().hx})}function u(e){return a().Vf}},731638:(e,t,o)=>{o.d(t,{CF:()=>s,f:()=>r});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(581454);var a=()=>o(247211),n=()=>o(204067);function r(e){let{collectionStore:t,modules:o,dependencyMap:a}=e;return c({modules:o,mapper:i(t,a)})}function i(e,t){return o=>(0,n().CB)({collectionStore:e,sourceTemplateType:"property",sourcePrimitiveId:o,dependencyMap:t})}function s(e){const t=new Set;return c({modules:e,mapper:e=>(t.add((0,a().vO)({type:"property",id:e})),e)}),t}function c(e){let{modules:t,mapper:o}=e;const a=e=>e?e.map((e=>function(e){let{module:t,mapper:o}=e;switch(t.type){case"bottomControls":case"relationsGroup":case"cover":case"discussions":case"editor":case"expandedBacklinks":case"formQuestion":case"formSubmit":case"formTitle":case"inlinePageSections":case"placeholder":case"properties":case"transcript":case"viewsMain":return t;case"property":return{...t,propertyId:o(t.propertyId)};case"titleWithIcon":return{...t,propertyIds:t.propertyIds?t.propertyIds.map(o):void 0};case"views":return{...t,relation_pointer:t.relation_pointer?{...t.relation_pointer,property:o(t.relation_pointer.property)}:void 0}}return t}({module:e,mapper:o}))):void 0;return{page_layout_schema:a(t.page_layout_schema),page_info_layout_schema:a(t.page_info_layout_schema),form_layout_schema:a(t.form_layout_schema),person_profile_page_main:a(t.person_profile_page_main),person_profile_page_details:a(t.person_profile_page_details)}}},749356:(e,t,o)=>{o.d(t,{VY:()=>u,Qm:()=>f,z6:()=>p,OC:()=>b,L6:()=>m,Zc:()=>v,x3:()=>g});var a=()=>o(857639),n=()=>o(386164);const r={plans_page:["lic_25","lic_50","resurrection_offer","ai_fifty_percent_upgrade"],sidebar_upsell:["lic_25","lic_50"]};var i=()=>o(502800),s=()=>o(449506),c=()=>o(901389),d=()=>o(989423),l=()=>o(351360);async function p(e,t){var o;const{spaceId:a,offerCampaign:n}=t;if(!a||!n||null===(o=l().default.state.currentSpaceStore)||void 0===o||!o.canAdmin())return;const r=await s().callApi({eventName:"getCustomerOffer",environment:e,data:{spaceId:a,offerCampaign:n}});return"failed"!==r.type&&"offer"in r.data&&r.data.offer?r.data.offer:void 0}async function u(e){const{environment:t,spaceId:o,offerCampaign:a,entrypoint:n}=e,r=await s().callApi({eventName:"applyCustomerOffer",environment:t,data:{spaceId:o,offerCampaign:a,entrypoint:n??"unknown"}});if("failed"!==r.type)return r;c().Qg(r)}async function f(e,t){const o=await s().callApi({eventName:"applyCustomerOffer",environment:e,data:{...t}});if("failed"!==o.type)return o;c().Qg(o)}async function m(e){const{environment:t,spaceId:o,offerCampaign:a}=e;return void 0!==await p(t,{spaceId:o,offerCampaign:a})}async function g(e){var t;const{environment:o,hasReceived:r,offerType:c,newPlan:d,coupon:p}=e,u=null===(t=l().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId();if(!u)return;const f=await s().callApi({eventName:"updateCustomerOffer",environment:o,data:{spaceId:u,hasReceived:r,offerType:c,newPlan:d,coupon:p},headers:(0,n().WS)({cellId:void 0,spaceId:u})});"failed"===f.type&&a().log({level:"error",from:"offerActions",type:"updateLegacyCustomerOfferFailed",error:(0,i().convertErrorToLog)(f.error)})}async function b(e,t,o){const a=function(e){if(r.hasOwnProperty(e))return r[e]}(o);if(a)for(const n of a){const o=await p(e,{spaceId:t,offerCampaign:n});if((null==o?void 0:o.campaign)===n)return o}}function v(e){let{environment:t,spaceName:o,offerCampaign:a}=e;if(o)switch(a){case"lic_25":case"lic_50":(0,d().WU)(t,"lic_offer_eligible","lic_offer_eligible",3600,{workspace_name:o,lic_25:"lic_25"===a,lic_50:"lic_50"===a});break;case"resurrection_offer":(0,d().WU)(t,"resurrection_offer_eligible","resurrection_offer_eligible",3600,{workspace_name:o});break;default:return}}},754093:(e,t,o)=>{o.d(t,{BD:()=>r});o(581454);var a=()=>o(736192),n=(a(),()=>o(496603));function r(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0;return(0,a().parse)(e,o).childNodes.map((e=>i(e,t)))}function i(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.nodeType===a().NodeType.TEXT_NODE?{type:"text",value:t?n().x4(e.textContent):e.textContent}:{type:"element",tagName:e.tagName.toLowerCase(),attributes:e.attributes||{},children:e.childNodes.map((e=>i(e,t)))||[]}}},758417:(e,t,o)=>{o.d(t,{Y$:()=>f,dy:()=>u,fw:()=>m});o(16280),o(944114);var a=()=>o(943387),n=()=>o(155792),r=()=>o(498212),i=()=>o(555102),s=()=>o(594794),c=()=>o(351360),d=()=>o(508496),l=()=>o(205605),p=()=>o(790068);function u(e){const{operations:t}=e;return{id:(0,r().lZ)(),type:"workflow-operation",workflowOperations:[],threadOperations:(0,a().eB)({operations:t})}}function f(e){const{environment:t,spaceStore:o,userStore:a,workflowStore:u,addSteps:f=[],spaceViewStore:m,store:g}=e,b=[];if(!d().default.checkGate({gateName:"workflows_use_agent"})){const e=function(e){const{environment:t,spaceStore:o,parentStore:a,workflowStore:i}=e,c=(0,l().$e)({workflowStore:i,store:a});return{id:(0,s().Z1)({environment:t,table:n().mS,spaceId:o.id}),type:"workflow",workflow_block_id:a.id,value:c,traceId:(0,r().lZ)(),saved:!0,tag:"initial-value"}}({environment:t,spaceStore:o,parentStore:g,workflowStore:u});b.push(e)}return(0,i().Xd)({environment:t,userStore:a,spaceStore:o,spaceViewStore:m,config:(0,p().K)({store:g}),addSteps:[...b,...f],blockStore:c().default.state.mainEditorCurrentBlockStore})}function m(e){const{environment:t,spaceStore:o,runStore:a}=e,i=a.getData();if(!i)throw new Error("Run data is undefined");const c=a.getCreatedAt();return{id:(0,s().Z1)({environment:t,table:n().mS,spaceId:o.id}),type:"workflow-runs",value:[{id:a.id,created_at:c,data:i}],traceId:(0,r().lZ)()}}},770586:(e,t,o)=>{o.d(t,{v:()=>a});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(908872);function a(e,t){const o=e.reduce(((e,t)=>{if(t.isType("define_variables")){var o;const a=null===(o=t.getModel())||void 0===o?void 0:o.getVariables();if(a)for(const t of Object.values(a))e.add(t.name)}return e}),new Set),a=t.replace(/\s*\d+$/,"");let n=1,r=`${a} ${n}`;for(;o.has(r);)r=`${a} ${n}`,n++;return r}},770769:(e,t,o)=>{o.r(t),o.d(t,{createGettingStartedPageInSpace:()=>X,createTemplatePagesInSpace:()=>K,getAIUpgradeTemplate:()=>ne,getInitialRedirectPage:()=>G,getJoinerTemplates:()=>te,getNormalizedTemplatePreviewItemSources:()=>oe,getPageTemplatesForUseCases:()=>re,getPerformanceMarketingSearchTermTemplates:()=>ee,getStarterTemplatesForSpace:()=>Y});o(16280),o(944114),o(898992),o(354520),o(581454),o(908872);var a=()=>o(857639),n=()=>o(402390),r=()=>o(386164),i=()=>o(388821),s=()=>o(96689),c=()=>o(837384),d=()=>o(679927),l=()=>o(544008);const p={educationClassNotes:{emoji:"📝",icon:"/icons/notebook_lightgray.svg",nameMessage:l().DZ.classNotes,sources:{"en-US":{previewRootId:"d2a04837-c9f5-4b05-aa67-4b233246c733",rootId:"d2a04837-c9f5-4b05-aa67-4b233246c733",spaceId:d().rQ}}},educationStudentJobApplication:{emoji:"🎓",icon:"/icons/briefcase_lightgray.svg",nameMessage:l().DZ.jobApplications,sources:{"en-US":{previewRootId:"88f0d992-0b5d-4781-b266-de59cf254272",rootId:"88f0d992-0b5d-4781-b266-de59cf254272",spaceId:d().rQ}}},educationNonStudentJobApplication:{emoji:"💼",icon:"/icons/briefcase_lightgray.svg",nameMessage:l().DZ.jobApplications,sources:{"en-US":{previewRootId:"7c1a9f4a-de79-439f-932f-dd8cc44beb3d",rootId:"7c1a9f4a-de79-439f-932f-dd8cc44beb3d",spaceId:d().rQ}}},educationClubs:{emoji:"🎭",icon:"/icons/group_lightgray.svg",nameMessage:l().DZ.clubHomepage,sources:{"en-US":{previewRootId:"7b25a753-8896-434c-9728-2bd038e9d96d",rootId:"7b25a753-8896-434c-9728-2bd038e9d96d",spaceId:d().rQ}}},educationGroupProjects:{emoji:"👥",icon:"/icons/project_lightgray.svg",nameMessage:l().DZ.groupProjects,sources:{"en-US":{previewRootId:"0617fe07-f3b4-4e30-8ef5-175eece9afe4",rootId:"0617fe07-f3b4-4e30-8ef5-175eece9afe4",spaceId:d().rQ}}},educationProjectsAndTasks:{emoji:"📊",icon:"/icons/task_lightgray.svg",nameMessage:l().DZ.projectManagement,sources:{"en-US":{previewRootId:"b73ce09e-8c61-416d-ba67-7712d9661dab",rootId:"b73ce09e-8c61-416d-ba67-7712d9661dab",spaceId:d().rQ}}},educationWebsiteBuilding:{emoji:"🌐",icon:"/icons/website_lightgray.svg",nameMessage:l().DZ.websiteBuilder,sources:{"en-US":{previewRootId:"e2cf37c4-30ed-4592-90ed-823551fd0e28",rootId:"e2cf37c4-30ed-4592-90ed-823551fd0e28",spaceId:d().rQ}}},educationLessonPlans:{emoji:"📚",icon:"/icons/book_lightgray.svg",nameMessage:l().DZ.lessonPlans,sources:{"en-US":{previewRootId:"794d433b-8668-49c1-be36-c890b5447910",rootId:"794d433b-8668-49c1-be36-c890b5447910",spaceId:d().rQ}}},educationClassroomManagement:{emoji:"🏫",icon:"/icons/classroom_lightgray.svg",nameMessage:l().DZ.classroomManagement,sources:{"en-US":{previewRootId:"c4039f1c-0ced-477c-8644-58a1ff6222fc",rootId:"c4039f1c-0ced-477c-8644-58a1ff6222fc",spaceId:d().rQ}}},educationResearch:{emoji:"🔬",icon:"/icons/research_lightgray.svg",nameMessage:l().DZ.research,sources:{"en-US":{previewRootId:"c1c34ceb-a820-428e-8276-1467b1fa3ae7",rootId:"c1c34ceb-a820-428e-8276-1467b1fa3ae7",spaceId:d().rQ}}},educationBudget:{emoji:"💰",icon:"/icons/budget_lightgray.svg",nameMessage:l().DZ.simpleBudget,sources:{"en-US":{previewRootId:"5049ce6a-2d27-4e49-b624-c1305401c603",rootId:"5049ce6a-2d27-4e49-b624-c1305401c603",spaceId:d().rQ}}},educationHabitTracker:{emoji:"📅",icon:"/icons/habit_lightgray.svg",nameMessage:l().DZ.habitTracker,sources:{"en-US":{previewRootId:"d6294a04-9e9e-4e60-8269-e522a44a6a1e",rootId:"d6294a04-9e9e-4e60-8269-e522a44a6a1e",spaceId:d().rQ}}},educationTravel:{emoji:"✈️",icon:"/icons/travel_lightgray.svg",nameMessage:l().DZ.travelPlanner,sources:{"en-US":{previewRootId:"6f3c3842-e15b-4568-9091-2576ffbed943",rootId:"6f3c3842-e15b-4568-9091-2576ffbed943",spaceId:d().rQ}}},educationHobbies:{emoji:"🎨",icon:"/icons/hobby_lightgray.svg",nameMessage:l().DZ.hobbies,sources:{"en-US":{previewRootId:"8a53a9a6-8eb2-4501-8849-02d1e37de1dc",rootId:"8a53a9a6-8eb2-4501-8849-02d1e37de1dc",spaceId:d().rQ}}}},u={notes:p.educationClassNotes,internshipApplications:p.educationStudentJobApplication,jobApplications:p.educationNonStudentJobApplication,clubs:p.educationClubs,groupProjects:p.educationGroupProjects,projectManagement:p.educationProjectsAndTasks,websiteBuilding:p.educationWebsiteBuilding,lessonPlans:p.educationLessonPlans,classroomManagement:p.educationClassroomManagement,research:p.educationResearch,budget:p.educationBudget,habitTracker:p.educationHabitTracker,travel:p.educationTravel,hobbies:p.educationHobbies},f={onboardingPlanner:{nameMessage:l().DZ.lessonPlans,sources:{"en-US":{previewRootId:"3f94d43b-0047-462d-8a4d-bbf7723dff02",rootId:"3f94d43b-0047-462d-8a4d-bbf7723dff02",spaceId:d().rQ},"es-ES":{previewRootId:"c4198fd0-a2ee-46b9-a603-83de8366fb6f",rootId:"c4198fd0-a2ee-46b9-a603-83de8366fb6f",spaceId:d().rQ},"de-DE":{previewRootId:"652e3a2d-7303-46c0-88f6-4d934b876cd5",rootId:"652e3a2d-7303-46c0-88f6-4d934b876cd5",spaceId:d().rQ},"ko-KR":{previewRootId:"3d2c6bff-55b0-4cf0-8ac4-4ad5c28a7894",rootId:"3d2c6bff-55b0-4cf0-8ac4-4ad5c28a7894",spaceId:d().rQ},"pt-BR":{previewRootId:"b7ee6aed-2353-4f81-ace9-cf1c0bd78dff",rootId:"b7ee6aed-2353-4f81-ace9-cf1c0bd78dff",spaceId:d().rQ},"fr-FR":{previewRootId:"c11fd279-85cb-4d6a-83a1-62debae1f4ba",rootId:"c11fd279-85cb-4d6a-83a1-62debae1f4ba",spaceId:d().rQ},"es-LA":{previewRootId:"df42f054-27ea-43f1-a0d2-725b9db3b09c",rootId:"df42f054-27ea-43f1-a0d2-725b9db3b09c",spaceId:d().rQ},"ja-JP":{previewRootId:"555ad29a-ba60-46a4-af15-e7ca9ab725e4",rootId:"555ad29a-ba60-46a4-af15-e7ca9ab725e4",spaceId:d().rQ}}},onboardingNotes:{nameMessage:l().DZ.notes,sources:{"en-US":{previewRootId:"ab3878e7-a6ca-46b6-ad4b-31ab92539a84",rootId:"ab3878e7-a6ca-46b6-ad4b-31ab92539a84",spaceId:d().rQ},"ko-KR":{previewRootId:"f6cdf333-bfca-4b13-94ba-6092dc658a56",rootId:"f6cdf333-bfca-4b13-94ba-6092dc658a56",spaceId:d().rQ},"fr-FR":{previewRootId:"d3f070e9-a9f6-42ca-bd3d-41ac09a79af3",rootId:"d3f070e9-a9f6-42ca-bd3d-41ac09a79af3",spaceId:d().rQ},"ja-JP":{previewRootId:"b46e6751-35e9-4eac-b833-ae6700a7acb4",rootId:"b46e6751-35e9-4eac-b833-ae6700a7acb4",spaceId:d().rQ},"de-DE":{previewRootId:"b1dfa48e-c017-4c12-9c9c-26e3686fb7ef",rootId:"b1dfa48e-c017-4c12-9c9c-26e3686fb7ef",spaceId:d().rQ},"es-ES":{previewRootId:"b95cbe07-b61a-4b25-877d-540b8e67cd32",rootId:"b95cbe07-b61a-4b25-877d-540b8e67cd32",spaceId:d().rQ},"es-LA":{previewRootId:"eadf3d08-0f81-4ece-95d7-eea9ecd60cc5",rootId:"eadf3d08-0f81-4ece-95d7-eea9ecd60cc5",spaceId:d().rQ},"pt-BR":{previewRootId:"6beccf8b-9dc8-4f21-8c26-9fd88e21eabb",rootId:"6beccf8b-9dc8-4f21-8c26-9fd88e21eabb",spaceId:d().rQ}}},onboardingResearch:{nameMessage:l().DZ.userResearch,sources:{"en-US":{previewRootId:"6b57bf0e-d17d-4e98-a553-47b2ae7b2bda",rootId:"6b57bf0e-d17d-4e98-a553-47b2ae7b2bda",spaceId:d().rQ},"es-ES":{previewRootId:"90bc461a-4b03-4ee6-94f4-7b65dae2b1d9",rootId:"90bc461a-4b03-4ee6-94f4-7b65dae2b1d9",spaceId:d().rQ},"de-DE":{previewRootId:"2a892324-85e3-43b6-ad04-ecd46562f386",rootId:"2a892324-85e3-43b6-ad04-ecd46562f386",spaceId:d().rQ},"ko-KR":{previewRootId:"90d150a7-7b16-418e-9dfb-b34e95ac15f7",rootId:"90d150a7-7b16-418e-9dfb-b34e95ac15f7",spaceId:d().rQ},"pt-BR":{previewRootId:"95a3bead-c8ef-430b-ba41-0d07faeb5893",rootId:"95a3bead-c8ef-430b-ba41-0d07faeb5893",spaceId:d().rQ},"fr-FR":{previewRootId:"4d452d93-4419-41af-bc4f-1c189b6218b5",rootId:"4d452d93-4419-41af-bc4f-1c189b6218b5",spaceId:d().rQ},"es-LA":{previewRootId:"32b5787c-9c58-4bde-8b89-c52eab327b4e",rootId:"32b5787c-9c58-4bde-8b89-c52eab327b4e",spaceId:d().rQ},"ja-JP":{previewRootId:"f72d11e3-b4a7-40f4-af87-9584419004e8",rootId:"f72d11e3-b4a7-40f4-af87-9584419004e8",spaceId:d().rQ}}},onboardingClubs:{nameMessage:l().DZ.clubHomepage,sources:{"en-US":{previewRootId:"9aba278e-bfd4-48f7-926d-d5aec58ca86e",rootId:"9aba278e-bfd4-48f7-926d-d5aec58ca86e",spaceId:d().rQ},"es-ES":{previewRootId:"def5148f-2f45-47bf-99ca-da93e1c0cb57",rootId:"def5148f-2f45-47bf-99ca-da93e1c0cb57",spaceId:d().rQ},"de-DE":{previewRootId:"bc33c5fb-a6aa-4c8f-a98f-ece2d120d632",rootId:"bc33c5fb-a6aa-4c8f-a98f-ece2d120d632",spaceId:d().rQ},"ko-KR":{previewRootId:"2f38622d-003d-45da-b6fc-1c5accf7a998",rootId:"2f38622d-003d-45da-b6fc-1c5accf7a998",spaceId:d().rQ},"pt-BR":{previewRootId:"ca6f6c1e-43f6-4811-a321-174adc67c44a",rootId:"ca6f6c1e-43f6-4811-a321-174adc67c44a",spaceId:d().rQ},"fr-FR":{previewRootId:"81ddb5c6-3b74-4ee3-ab27-a021f4d2a0b1",rootId:"81ddb5c6-3b74-4ee3-ab27-a021f4d2a0b1",spaceId:d().rQ},"es-LA":{previewRootId:"c9f3ca4d-3348-4575-ab58-650f3ff8a112",rootId:"c9f3ca4d-3348-4575-ab58-650f3ff8a112",spaceId:d().rQ},"ja-JP":{previewRootId:"576c3353-fdaf-492f-8305-12c8dc09f85e",rootId:"576c3353-fdaf-492f-8305-12c8dc09f85e",spaceId:d().rQ}}},onboardingTeachingLessonPlans:{nameMessage:l().DZ.lessonPlans,sources:{"en-US":{previewRootId:"9d19bcd2-42ca-471a-847c-1dfd48be22bc",rootId:"9d19bcd2-42ca-471a-847c-1dfd48be22bc",spaceId:d().rQ},"ko-KR":{previewRootId:"92f2aef0-652a-4d26-950f-e0b7cdd5934c",rootId:"92f2aef0-652a-4d26-950f-e0b7cdd5934c",spaceId:d().rQ},"fr-FR":{previewRootId:"fe4d6143-aeec-4c43-9e2e-ec2c956e125e",rootId:"fe4d6143-aeec-4c43-9e2e-ec2c956e125e",spaceId:d().rQ},"ja-JP":{previewRootId:"713f3cf6-5bc7-476d-8824-3ab0231d6995",rootId:"713f3cf6-5bc7-476d-8824-3ab0231d6995",spaceId:d().rQ},"de-DE":{previewRootId:"bbe80035-6495-44f3-889c-148e59b184ec",rootId:"bbe80035-6495-44f3-889c-148e59b184ec",spaceId:d().rQ},"es-ES":{previewRootId:"7ea4575f-e19d-4ad1-91fb-0389b80e4d69",rootId:"7ea4575f-e19d-4ad1-91fb-0389b80e4d69",spaceId:d().rQ},"es-LA":{previewRootId:"4095f817-875b-476d-8bf4-2fd38446dbff",rootId:"4095f817-875b-476d-8bf4-2fd38446dbff",spaceId:d().rQ},"pt-BR":{previewRootId:"d55fd559-5f96-42ff-8686-75068c1107f8",rootId:"d55fd559-5f96-42ff-8686-75068c1107f8",spaceId:d().rQ}}},onboardingTeachingClassroomManagement:{nameMessage:l().DZ.classroomHome,sources:{"en-US":{previewRootId:"ec5765d2-b548-453c-a963-854499478a0c",rootId:"ec5765d2-b548-453c-a963-854499478a0c",spaceId:d().rQ},"es-ES":{previewRootId:"e8ee2851-a69b-4aa0-bcd6-07d9630bdcd9",rootId:"e8ee2851-a69b-4aa0-bcd6-07d9630bdcd9",spaceId:d().rQ},"de-DE":{previewRootId:"b0df934b-cca8-423a-8361-23852ba09921",rootId:"b0df934b-cca8-423a-8361-23852ba09921",spaceId:d().rQ},"ko-KR":{previewRootId:"83aed70f-b0c5-4f1f-84bc-dc3b84e60f48",rootId:"83aed70f-b0c5-4f1f-84bc-dc3b84e60f48",spaceId:d().rQ},"pt-BR":{previewRootId:"7cc04c0e-8b5e-417c-bacd-167de9954af4",rootId:"7cc04c0e-8b5e-417c-bacd-167de9954af4",spaceId:d().rQ},"fr-FR":{previewRootId:"d9a35553-ed95-409a-a696-70b60dca619e",rootId:"d9a35553-ed95-409a-a696-70b60dca619e",spaceId:d().rQ},"es-LA":{previewRootId:"edf370fe-f2da-481d-a0a2-52b2c0d93ad0",rootId:"edf370fe-f2da-481d-a0a2-52b2c0d93ad0",spaceId:d().rQ},"ja-JP":{previewRootId:"1e42faba-0303-481f-a602-918b0456eef9",rootId:"1e42faba-0303-481f-a602-918b0456eef9",spaceId:d().rQ}}},onboardingWebsiteBuildingForSchool:{nameMessage:l().DZ.blogPost,sources:{"en-US":{previewRootId:"9faf7ffc-f59c-4828-8478-5f92295ef84d",rootId:"9faf7ffc-f59c-4828-8478-5f92295ef84d",spaceId:d().rQ},"es-ES":{previewRootId:"f973e339-a978-432d-982c-124c5d0cc77c",rootId:"f973e339-a978-432d-982c-124c5d0cc77c",spaceId:d().rQ},"de-DE":{previewRootId:"69c06907-cf19-412a-9464-9166ef5a3880",rootId:"69c06907-cf19-412a-9464-9166ef5a3880",spaceId:d().rQ},"ko-KR":{previewRootId:"63f549ae-1c59-4275-95c3-e55e96d489f9",rootId:"63f549ae-1c59-4275-95c3-e55e96d489f9",spaceId:d().rQ},"pt-BR":{previewRootId:"802ce65d-eeb1-458f-bc6f-5f560fd9719d",rootId:"802ce65d-eeb1-458f-bc6f-5f560fd9719d",spaceId:d().rQ},"fr-FR":{previewRootId:"29074b4a-cb38-44c3-9c0c-2c85e6d598e8",rootId:"29074b4a-cb38-44c3-9c0c-2c85e6d598e8",spaceId:d().rQ},"es-LA":{previewRootId:"e0ad03f6-8cf8-496f-be0e-126461e01adb",rootId:"e0ad03f6-8cf8-496f-be0e-126461e01adb",spaceId:d().rQ},"ja-JP":{previewRootId:"9fdbdd6d-69bd-4dc7-83fb-4be00dc0efb9",rootId:"9fdbdd6d-69bd-4dc7-83fb-4be00dc0efb9",spaceId:d().rQ}}},onboardingInternshipApplications:{nameMessage:l().DZ.jobApplications,sources:{"en-US":{previewRootId:"782fb58c-5741-4c7d-9e66-a840040afc09",rootId:"782fb58c-5741-4c7d-9e66-a840040afc09",spaceId:d().rQ},"es-ES":{previewRootId:"61db601f-9480-40bd-9dc1-1512cbad7c96",rootId:"61db601f-9480-40bd-9dc1-1512cbad7c96",spaceId:d().rQ},"de-DE":{previewRootId:"c76c593d-7064-4f3c-90c3-58e9d1e3eca9",rootId:"c76c593d-7064-4f3c-90c3-58e9d1e3eca9",spaceId:d().rQ},"ko-KR":{previewRootId:"67ac51cc-f138-4f7a-ad11-75aba9b444a4",rootId:"67ac51cc-f138-4f7a-ad11-75aba9b444a4",spaceId:d().rQ},"pt-BR":{previewRootId:"f88254a4-735e-4823-b52c-ce367efccb65",rootId:"f88254a4-735e-4823-b52c-ce367efccb65",spaceId:d().rQ},"fr-FR":{previewRootId:"8019f228-4e8a-4a46-9610-0a29cc9d1301",rootId:"8019f228-4e8a-4a46-9610-0a29cc9d1301",spaceId:d().rQ},"es-LA":{previewRootId:"681aab28-43cf-44bb-b4f0-3fe588b5ec53",rootId:"681aab28-43cf-44bb-b4f0-3fe588b5ec53",spaceId:d().rQ},"ja-JP":{previewRootId:"cf854805-757f-4294-8898-510e50ffecea",rootId:"cf854805-757f-4294-8898-510e50ffecea",spaceId:d().rQ}}},onboardingGroupProjects:{nameMessage:l().DZ.projectManagement,sources:{"en-US":{previewRootId:"095c36ce-6159-4f4f-be88-2d3814d83073",rootId:"095c36ce-6159-4f4f-be88-2d3814d83073",spaceId:d().rQ},"es-ES":{previewRootId:"79fd331c-0d94-445f-9cdf-b5a928d3318a",rootId:"79fd331c-0d94-445f-9cdf-b5a928d3318a",spaceId:d().rQ},"de-DE":{previewRootId:"3c057007-9fbb-464d-99e4-c8c58996d554",rootId:"3c057007-9fbb-464d-99e4-c8c58996d554",spaceId:d().rQ},"ko-KR":{previewRootId:"c197eb41-4b65-4e43-be0e-d315217f30ba",rootId:"c197eb41-4b65-4e43-be0e-d315217f30ba",spaceId:d().rQ},"pt-BR":{previewRootId:"99e41bf1-4a76-4fba-9697-ac4e0fe6ab89",rootId:"99e41bf1-4a76-4fba-9697-ac4e0fe6ab89",spaceId:d().rQ},"fr-FR":{previewRootId:"71b1d5b6-6bb9-4dc7-813b-9af3c5abdbd2",rootId:"71b1d5b6-6bb9-4dc7-813b-9af3c5abdbd2",spaceId:d().rQ},"es-LA":{previewRootId:"cc9f08ac-fec7-4f0c-a769-61a02a4d11b4",rootId:"cc9f08ac-fec7-4f0c-a769-61a02a4d11b4",spaceId:d().rQ},"ja-JP":{previewRootId:"fbb3bd76-e59c-44e5-adad-2faa646b653b",rootId:"fbb3bd76-e59c-44e5-adad-2faa646b653b",spaceId:d().rQ}}},onboardingTodos:{nameMessage:l().DZ.weeklyTodo,sources:{"en-US":{previewRootId:"5bea1ec0-dec9-4d1d-b1de-25d039122e3d",rootId:"5bea1ec0-dec9-4d1d-b1de-25d039122e3d",spaceId:d().rQ},"es-ES":{previewRootId:"de46061f-72c5-4863-8d00-05db2107f1a0",rootId:"de46061f-72c5-4863-8d00-05db2107f1a0",spaceId:d().rQ},"de-DE":{previewRootId:"760c5b02-8297-47e2-ac8a-504737f2b1d2",rootId:"760c5b02-8297-47e2-ac8a-504737f2b1d2",spaceId:d().rQ},"ko-KR":{previewRootId:"672c9633-369e-4d46-8928-dc8c26326f23",rootId:"672c9633-369e-4d46-8928-dc8c26326f23",spaceId:d().rQ},"pt-BR":{previewRootId:"beff1a8f-ed5d-4e4d-b6cd-ba5b9a4ba028",rootId:"beff1a8f-ed5d-4e4d-b6cd-ba5b9a4ba028",spaceId:d().rQ},"fr-FR":{previewRootId:"03390df0-3875-47ef-8b19-4d39b07f1aa4",rootId:"03390df0-3875-47ef-8b19-4d39b07f1aa4",spaceId:d().rQ},"es-LA":{previewRootId:"e2e9a4be-5d57-4d0a-b224-53bacc4c3c5a",rootId:"e2e9a4be-5d57-4d0a-b224-53bacc4c3c5a",spaceId:d().rQ},"ja-JP":{previewRootId:"5df04d3e-caff-4287-9e1a-4983357c48bf",rootId:"5df04d3e-caff-4287-9e1a-4983357c48bf",spaceId:d().rQ}}},onboardingProjectsTasks:{nameMessage:l().DZ.projectManagement,sources:{"en-US":{previewRootId:"a614583c-c2a9-4064-a92a-c674b354c42e",rootId:"a614583c-c2a9-4064-a92a-c674b354c42e",spaceId:d().rQ},"es-ES":{previewRootId:"5652679d-97ed-4ab6-8143-9d085491b907",rootId:"5652679d-97ed-4ab6-8143-9d085491b907",spaceId:d().rQ},"de-DE":{previewRootId:"f793d369-2d85-425b-9e3e-59856786ecde",rootId:"f793d369-2d85-425b-9e3e-59856786ecde",spaceId:d().rQ},"ko-KR":{previewRootId:"3f2246ce-df2e-4a68-963e-477d214d5b91",rootId:"3f2246ce-df2e-4a68-963e-477d214d5b91",spaceId:d().rQ},"pt-BR":{previewRootId:"ef9efb01-41c4-473f-9318-5ea2e0978883",rootId:"ef9efb01-41c4-473f-9318-5ea2e0978883",spaceId:d().rQ},"fr-FR":{previewRootId:"9eecb8a9-f121-4727-a83f-27bf61f2b28f",rootId:"9eecb8a9-f121-4727-a83f-27bf61f2b28f",spaceId:d().rQ},"es-LA":{previewRootId:"f1779318-dc4a-477f-b208-4a7a489dca0a",rootId:"f1779318-dc4a-477f-b208-4a7a489dca0a",spaceId:d().rQ},"ja-JP":{previewRootId:"097a1243-1983-4f87-94e4-555a8a9afc17",rootId:"097a1243-1983-4f87-94e4-555a8a9afc17",spaceId:d().rQ}}},onboardingHabitWellness:{nameMessage:l().DZ.habitTracker,sources:{"en-US":{previewRootId:"cc760260-ec1a-4e31-b2ec-c3451d320bd3",rootId:"cc760260-ec1a-4e31-b2ec-c3451d320bd3",spaceId:d().rQ},"es-ES":{previewRootId:"d71ee884-c3e6-4baa-8a61-a3c0a64b6071",rootId:"d71ee884-c3e6-4baa-8a61-a3c0a64b6071",spaceId:d().rQ},"de-DE":{previewRootId:"baf27f89-f10c-455f-9230-7ed49b88cc52",rootId:"baf27f89-f10c-455f-9230-7ed49b88cc52",spaceId:d().rQ},"ko-KR":{previewRootId:"f11aa5f8-085e-45fa-a265-8d1cabf720c4",rootId:"f11aa5f8-085e-45fa-a265-8d1cabf720c4",spaceId:d().rQ},"pt-BR":{previewRootId:"2311bf16-e0b3-454a-afde-2b638350b2ea",rootId:"2311bf16-e0b3-454a-afde-2b638350b2ea",spaceId:d().rQ},"fr-FR":{previewRootId:"d51be887-fcbb-43b7-8ed9-d6c844fbeef8",rootId:"d51be887-fcbb-43b7-8ed9-d6c844fbeef8",spaceId:d().rQ},"es-LA":{previewRootId:"28df247f-4924-4735-99e0-a97d29f26ae4",rootId:"28df247f-4924-4735-99e0-a97d29f26ae4",spaceId:d().rQ},"ja-JP":{previewRootId:"cffc7e70-f56c-4b0c-b7a8-824afdfd2b84",rootId:"cffc7e70-f56c-4b0c-b7a8-824afdfd2b84",spaceId:d().rQ}}},onboardingBudgetPersonalFinance:{nameMessage:l().DZ.simpleBudget,sources:{"en-US":{previewRootId:"ad07f7b9-d28c-48b4-ab10-7fd61d352ea5",rootId:"ad07f7b9-d28c-48b4-ab10-7fd61d352ea5",spaceId:d().rQ},"es-ES":{previewRootId:"3ddaf352-e5fe-46d9-b5d7-7af8fee5350e",rootId:"3ddaf352-e5fe-46d9-b5d7-7af8fee5350e",spaceId:d().rQ},"de-DE":{previewRootId:"b169172c-cc26-41d4-bd00-2d4a11bce583",rootId:"b169172c-cc26-41d4-bd00-2d4a11bce583",spaceId:d().rQ},"ko-KR":{previewRootId:"f0c56c80-c61f-4b5c-8ec8-6acccacf54f4",rootId:"f0c56c80-c61f-4b5c-8ec8-6acccacf54f4",spaceId:d().rQ},"pt-BR":{previewRootId:"dab3aa80-24f9-4dd7-ba9c-9c8df59ad69a",rootId:"dab3aa80-24f9-4dd7-ba9c-9c8df59ad69a",spaceId:d().rQ},"fr-FR":{previewRootId:"a4512fdb-9927-4747-98e3-ebee0de266bc",rootId:"a4512fdb-9927-4747-98e3-ebee0de266bc",spaceId:d().rQ},"es-LA":{previewRootId:"1ead1fd1-d836-4035-932e-d9cfeffbfd3c",rootId:"1ead1fd1-d836-4035-932e-d9cfeffbfd3c",spaceId:d().rQ},"ja-JP":{previewRootId:"e6fe0a55-1f68-4818-91a2-533c91f9dd63",rootId:"e6fe0a55-1f68-4818-91a2-533c91f9dd63",spaceId:d().rQ}}},onboardingTravel:{nameMessage:l().DZ.travelPlanner,sources:{"en-US":{previewRootId:"2da45526-3996-44b1-9557-d7a85c800346",rootId:"2da45526-3996-44b1-9557-d7a85c800346",spaceId:d().rQ},"es-ES":{previewRootId:"ba4001ee-c740-45cc-8506-7ca55f642479",rootId:"ba4001ee-c740-45cc-8506-7ca55f642479",spaceId:d().rQ},"de-DE":{previewRootId:"710c9642-f5c6-490d-9905-2d75003e0d8a",rootId:"710c9642-f5c6-490d-9905-2d75003e0d8a",spaceId:d().rQ},"ko-KR":{previewRootId:"823a07cf-d498-4214-b873-84dc6035d1bf",rootId:"823a07cf-d498-4214-b873-84dc6035d1bf",spaceId:d().rQ},"pt-BR":{previewRootId:"68038622-1f1c-4bf1-9f4c-447104136ce4",rootId:"68038622-1f1c-4bf1-9f4c-447104136ce4",spaceId:d().rQ},"fr-FR":{previewRootId:"373f749d-05af-46c4-bd0b-f5d6b8a725c3",rootId:"373f749d-05af-46c4-bd0b-f5d6b8a725c3",spaceId:d().rQ},"es-LA":{previewRootId:"e8c4b61b-071c-4232-b943-74f9cda904e9",rootId:"e8c4b61b-071c-4232-b943-74f9cda904e9",spaceId:d().rQ},"ja-JP":{previewRootId:"097a1243-1983-4f87-94e4-555a8a9afc17",rootId:"097a1243-1983-4f87-94e4-555a8a9afc17",spaceId:d().rQ}}},onboardingHobbies:{nameMessage:l().DZ.personalHome,sources:{"en-US":{previewRootId:"66e16cde-3919-4003-878a-a809a6e25cb3",rootId:"66e16cde-3919-4003-878a-a809a6e25cb3",spaceId:d().rQ},"es-ES":{previewRootId:"dc0abbb9-10a0-48e1-aff5-8b542cac108b",rootId:"dc0abbb9-10a0-48e1-aff5-8b542cac108b",spaceId:d().rQ},"de-DE":{previewRootId:"1f61390b-59ea-4fa5-b183-3d4725c27a32",rootId:"1f61390b-59ea-4fa5-b183-3d4725c27a32",spaceId:d().rQ},"ko-KR":{previewRootId:"7be8f2f6-60ae-4b85-ad71-391f32eada5d",rootId:"7be8f2f6-60ae-4b85-ad71-391f32eada5d",spaceId:d().rQ},"pt-BR":{previewRootId:"db72ebcd-d567-4367-9f46-25e7ccc72453",rootId:"db72ebcd-d567-4367-9f46-25e7ccc72453",spaceId:d().rQ},"fr-FR":{previewRootId:"f5ff1633-e63a-42cd-808d-84412beb43ac",rootId:"f5ff1633-e63a-42cd-808d-84412beb43ac",spaceId:d().rQ},"es-LA":{previewRootId:"e9ae16c1-dd69-4284-8e2a-95e39bbac429",rootId:"e9ae16c1-dd69-4284-8e2a-95e39bbac429",spaceId:d().rQ},"ja-JP":{previewRootId:"75423d96-0edc-48ce-828e-be5b9c5af055",rootId:"75423d96-0edc-48ce-828e-be5b9c5af055",spaceId:d().rQ}}},onboardingCareerBuilding:{nameMessage:l().DZ.jobBoard,sources:{"en-US":{previewRootId:"9e5301a8-5b79-4537-aaf1-32b5bb99c695",rootId:"9e5301a8-5b79-4537-aaf1-32b5bb99c695",spaceId:d().rQ},"es-ES":{previewRootId:"d18ce886-ee85-47ce-9b18-699d893c5b94",rootId:"d18ce886-ee85-47ce-9b18-699d893c5b94",spaceId:d().rQ},"de-DE":{previewRootId:"c36f3d41-72ee-4de5-b866-a8ee8d4480fb",rootId:"c36f3d41-72ee-4de5-b866-a8ee8d4480fb",spaceId:d().rQ},"ko-KR":{previewRootId:"cf4fc2a5-d77c-4adb-aea6-44126023c19d",rootId:"cf4fc2a5-d77c-4adb-aea6-44126023c19d",spaceId:d().rQ},"pt-BR":{previewRootId:"54761a16-7c25-4af8-be75-e92a3f954ea5",rootId:"54761a16-7c25-4af8-be75-e92a3f954ea5",spaceId:d().rQ},"fr-FR":{previewRootId:"bf7cd446-0e8b-4481-b2a7-f87789085405",rootId:"bf7cd446-0e8b-4481-b2a7-f87789085405",spaceId:d().rQ},"es-LA":{previewRootId:"a53cd4da-2ee9-4175-ac6e-2d8b2dbc03fd",rootId:"a53cd4da-2ee9-4175-ac6e-2d8b2dbc03fd",spaceId:d().rQ},"ja-JP":{previewRootId:"16574610-9099-4120-8cb4-ee651ba3175a",rootId:"16574610-9099-4120-8cb4-ee651ba3175a",spaceId:d().rQ}}},onboardingFoodNutrition:{nameMessage:l().DZ.personalHome,sources:{"en-US":{previewRootId:"7c16e837-578c-45d5-b4e2-fbc275ab9cd0",rootId:"7c16e837-578c-45d5-b4e2-fbc275ab9cd0",spaceId:d().rQ},"es-ES":{previewRootId:"9ad62304-6c4f-46a6-b2ab-9af0b078b89d",rootId:"9ad62304-6c4f-46a6-b2ab-9af0b078b89d",spaceId:d().rQ},"de-DE":{previewRootId:"5ae0fcc5-fb33-4e74-8219-83ae4c15cecb",rootId:"5ae0fcc5-fb33-4e74-8219-83ae4c15cecb",spaceId:d().rQ},"ko-KR":{previewRootId:"0d2f66d1-c7f7-44ab-855d-98bf73d92e28",rootId:"0d2f66d1-c7f7-44ab-855d-98bf73d92e28",spaceId:d().rQ},"pt-BR":{previewRootId:"57a996b9-bc60-48d5-98b8-046ffeeee139",rootId:"57a996b9-bc60-48d5-98b8-046ffeeee139",spaceId:d().rQ},"fr-FR":{previewRootId:"0ff64222-74a2-4891-8240-1fa271ea768a",rootId:"0ff64222-74a2-4891-8240-1fa271ea768a",spaceId:d().rQ},"es-LA":{previewRootId:"7acb6363-3448-4171-a82e-4e2edae4d726",rootId:"7acb6363-3448-4171-a82e-4e2edae4d726",spaceId:d().rQ},"ja-JP":{previewRootId:"de24231f-784d-460d-a791-a5c38bfaf294",rootId:"de24231f-784d-460d-a791-a5c38bfaf294",spaceId:d().rQ}}},onboardingWebsiteBuildingForLife:{nameMessage:l().DZ.blogPost,sources:{"en-US":{previewRootId:"958bba61-c844-4404-b226-d7254fd4464a",rootId:"958bba61-c844-4404-b226-d7254fd4464a",spaceId:d().rQ},"es-ES":{previewRootId:"944463b4-445e-4fae-b7be-f0d8f63cc941",rootId:"944463b4-445e-4fae-b7be-f0d8f63cc941",spaceId:d().rQ},"de-DE":{previewRootId:"51c2db68-d248-4224-b1bd-bb0a867c500a",rootId:"51c2db68-d248-4224-b1bd-bb0a867c500a",spaceId:d().rQ},"ko-KR":{previewRootId:"81374d2a-3bba-418c-a1f7-51453fbaa44e",rootId:"81374d2a-3bba-418c-a1f7-51453fbaa44e",spaceId:d().rQ},"pt-BR":{previewRootId:"75910e78-40ca-4fe3-ae0d-da44f88766f2",rootId:"75910e78-40ca-4fe3-ae0d-da44f88766f2",spaceId:d().rQ},"fr-FR":{previewRootId:"8ee4a217-ad5f-457b-a4cc-133a3102c333",rootId:"8ee4a217-ad5f-457b-a4cc-133a3102c333",spaceId:d().rQ},"es-LA":{previewRootId:"e1c3a7ae-fa2a-4b28-b91b-8208ccddee4c",rootId:"e1c3a7ae-fa2a-4b28-b91b-8208ccddee4c",spaceId:d().rQ},"ja-JP":{previewRootId:"2fbcc570-cbeb-4908-9586-5b0baf2abc48",rootId:"2fbcc570-cbeb-4908-9586-5b0baf2abc48",spaceId:d().rQ}}},onboardingEntertainment:{nameMessage:l().DZ.blogPost,sources:{"en-US":{previewRootId:"77c309a0-092e-410c-8b4b-fed51d7ea815",rootId:"77c309a0-092e-410c-8b4b-fed51d7ea815",spaceId:d().rQ},"es-ES":{previewRootId:"3b7cbb37-2894-44f5-9549-b033d6ddf4b0",rootId:"3b7cbb37-2894-44f5-9549-b033d6ddf4b0",spaceId:d().rQ},"de-DE":{previewRootId:"5f88da8a-86a9-4ece-923c-bc86acad5c7c",rootId:"5f88da8a-86a9-4ece-923c-bc86acad5c7c",spaceId:d().rQ},"ko-KR":{previewRootId:"a8fb1eed-7f14-4895-94a1-d5549f1310cb",rootId:"a8fb1eed-7f14-4895-94a1-d5549f1310cb",spaceId:d().rQ},"pt-BR":{previewRootId:"ad36da0e-d650-46f9-9979-b349bac4de3d",rootId:"ad36da0e-d650-46f9-9979-b349bac4de3d",spaceId:d().rQ},"fr-FR":{previewRootId:"9c922de9-25d6-488c-a859-e7974ad0b533",rootId:"9c922de9-25d6-488c-a859-e7974ad0b533",spaceId:d().rQ},"es-LA":{previewRootId:"8f871243-3f44-4877-a0dc-157bdfb37916",rootId:"8f871243-3f44-4877-a0dc-157bdfb37916",spaceId:d().rQ},"ja-JP":{previewRootId:"247621a1-4107-4553-8de6-bc1f6880ad10",rootId:"247621a1-4107-4553-8de6-bc1f6880ad10",spaceId:d().rQ}}}},m={onboardingPlanner:{nameMessage:l().DZ.lessonPlans,sources:{"en-US":{previewRootId:"8d44f3a8-4e9f-4f2e-ba1d-e9df78ae9912",rootId:"8d44f3a8-4e9f-4f2e-ba1d-e9df78ae9912",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-8184-ac8d-d243f5312577",rootId:"143efdee-ad05-8184-ac8d-d243f5312577",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-819f-b74c-eec585ea4de8",rootId:"143efdee-ad05-819f-b74c-eec585ea4de8",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-81ff-9c1b-c7481b9a783e",rootId:"143efdee-ad05-81ff-9c1b-c7481b9a783e",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-818e-bd36-cb3328a05753",rootId:"143efdee-ad05-818e-bd36-cb3328a05753",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-8140-84fa-d9b0808be61d",rootId:"143efdee-ad05-8140-84fa-d9b0808be61d",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-8143-b2d8-e23c013cfdcc",rootId:"143efdee-ad05-8143-b2d8-e23c013cfdcc",spaceId:s().Zz},"zh-TW":{previewRootId:"143efdee-ad05-8182-80a1-c5528633c694",rootId:"143efdee-ad05-8182-80a1-c5528633c694",spaceId:s().Zz}}},onboardingNotes:{nameMessage:l().DZ.notes,sources:{"en-US":{previewRootId:"100efdee-ad05-8037-b3e2-dd5710fc4728",rootId:"100efdee-ad05-8037-b3e2-dd5710fc4728",spaceId:s().Zz},"ko-KR":{previewRootId:"152efdee-ad05-8034-a73b-c8f3e29c444d",rootId:"152efdee-ad05-8034-a73b-c8f3e29c444d",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81a2-86a0-e1150ad83cfa",rootId:"143efdee-ad05-81a2-86a0-e1150ad83cfa",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-8124-a0df-f60ab14c544a",rootId:"143efdee-ad05-8124-a0df-f60ab14c544a",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-811f-847e-c60eaf5b9ba5",rootId:"143efdee-ad05-811f-847e-c60eaf5b9ba5",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-8152-b4c1-c5f59a0604e0",rootId:"143efdee-ad05-8152-b4c1-c5f59a0604e0",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-8157-becf-d472026ff396",rootId:"143efdee-ad05-8157-becf-d472026ff396",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-800f-916e-e1c855443ed8",rootId:"156efdee-ad05-800f-916e-e1c855443ed8",spaceId:s().Zz}}},onboardingResearch:{nameMessage:l().DZ.userResearch,sources:{"en-US":{previewRootId:"2de4da75-3cad-4c0a-a4ff-003d7ad8837e",rootId:"2de4da75-3cad-4c0a-a4ff-003d7ad8837e",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-818b-87f2-c63ffaa1b0f8",rootId:"143efdee-ad05-818b-87f2-c63ffaa1b0f8",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81f0-aa99-dc3f0eb1e3e0",rootId:"143efdee-ad05-81f0-aa99-dc3f0eb1e3e0",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-81d8-a562-e85409c73c99",rootId:"143efdee-ad05-81d8-a562-e85409c73c99",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-81a8-ab4d-fff7f1cee489",rootId:"143efdee-ad05-81a8-ab4d-fff7f1cee489",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-81bf-8a04-e0d023eb2d70",rootId:"143efdee-ad05-81bf-8a04-e0d023eb2d70",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-81ee-899f-d91893d9c73f",rootId:"143efdee-ad05-81ee-899f-d91893d9c73f",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-8009-a814-f049b00afef0",rootId:"156efdee-ad05-8009-a814-f049b00afef0",spaceId:s().Zz}}},onboardingClubs:{nameMessage:l().DZ.clubHomepage,sources:{"en-US":{previewRootId:"fb156a4d-5f13-4df2-affd-d99276e8076c",rootId:"fb156a4d-5f13-4df2-affd-d99276e8076c",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-81ba-8ae0-e807e495bfd6",rootId:"143efdee-ad05-81ba-8ae0-e807e495bfd6",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-8100-bb2e-d32c789eb036",rootId:"143efdee-ad05-8100-bb2e-d32c789eb036",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-8196-8f36-d641534cb258",rootId:"143efdee-ad05-8196-8f36-d641534cb258",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-814e-8427-fcde744e9714",rootId:"143efdee-ad05-814e-8427-fcde744e9714",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-8117-9ea2-df755f72607d",rootId:"143efdee-ad05-8117-9ea2-df755f72607d",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-81b2-bab9-d984d16a3b27",rootId:"143efdee-ad05-81b2-bab9-d984d16a3b27",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-8003-8485-c07b0c46b88d",rootId:"156efdee-ad05-8003-8485-c07b0c46b88d",spaceId:s().Zz}}},onboardingTeachingLessonPlans:{nameMessage:l().DZ.lessonPlans,sources:{"en-US":{previewRootId:"1b8443dc-1b43-4d5f-8e1e-63fcbcf01910",rootId:"1b8443dc-1b43-4d5f-8e1e-63fcbcf01910",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-81cc-aafc-f7554875630e",rootId:"143efdee-ad05-81cc-aafc-f7554875630e",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-8142-a004-c24e683c73ff",rootId:"143efdee-ad05-8142-a004-c24e683c73ff",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-814c-9c2d-d066c2f3a49e",rootId:"143efdee-ad05-814c-9c2d-d066c2f3a49e",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-81a9-9247-ca2c9816b051",rootId:"143efdee-ad05-81a9-9247-ca2c9816b051",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-8170-80b9-db81fde1ca0f",rootId:"143efdee-ad05-8170-80b9-db81fde1ca0f",spaceId:s().Zz},"pt-BR":{previewRootId:"144efdee-ad05-804d-a9b7-e0c75041c513",rootId:"144efdee-ad05-804d-a9b7-e0c75041c513",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-8030-84e1-d67a8d9fb409",rootId:"156efdee-ad05-8030-84e1-d67a8d9fb409",spaceId:s().Zz}}},onboardingTeachingClassroomManagement:{nameMessage:l().DZ.classroomHome,sources:{"en-US":{previewRootId:"1d89b11d-e41e-4713-a45c-64d96dcde7d2",rootId:"1d89b11d-e41e-4713-a45c-64d96dcde7d2",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-812b-85fc-c09466d26285",rootId:"143efdee-ad05-812b-85fc-c09466d26285",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-8184-ae51-c37920ccc6d1",rootId:"143efdee-ad05-8184-ae51-c37920ccc6d1",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-810b-a54e-db202a8ac417",rootId:"143efdee-ad05-810b-a54e-db202a8ac417",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-8195-be61-c331b66b76a1",rootId:"143efdee-ad05-8195-be61-c331b66b76a1",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-81c3-a77a-df3bc327aa92",rootId:"143efdee-ad05-81c3-a77a-df3bc327aa92",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-81a3-b3f6-fd982723abd4",rootId:"143efdee-ad05-81a3-b3f6-fd982723abd4",spaceId:s().Zz},"zh-TW":{previewRootId:"143efdee-ad05-8157-8683-dd2d7ab8d6de",rootId:"143efdee-ad05-8157-8683-dd2d7ab8d6de",spaceId:s().Zz}}},onboardingWebsiteBuildingForSchool:{nameMessage:l().DZ.blogPost,sources:{"en-US":{previewRootId:"6980f354-76bb-49d7-b0c0-ce7210067a9a",rootId:"6980f354-76bb-49d7-b0c0-ce7210067a9a",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-81e3-8a3b-f79a5cfa4dd2",rootId:"143efdee-ad05-81e3-8a3b-f79a5cfa4dd2",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-811b-ac01-dd49ed3c08fc",rootId:"143efdee-ad05-811b-ac01-dd49ed3c08fc",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-811e-b989-c162569b025b",rootId:"143efdee-ad05-811e-b989-c162569b025b",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-81c0-a122-c1728fd6e494",rootId:"143efdee-ad05-81c0-a122-c1728fd6e494",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-81b0-8977-f68ce78d7d99",rootId:"143efdee-ad05-81b0-8977-f68ce78d7d99",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-8111-b0c9-d1a8bb893a80",rootId:"143efdee-ad05-8111-b0c9-d1a8bb893a80",spaceId:s().Zz},"zh-TW":{previewRootId:"155efdee-ad05-807a-b877-d9fdee75fb61",rootId:"155efdee-ad05-807a-b877-d9fdee75fb61",spaceId:s().Zz}}},onboardingInternshipApplications:{nameMessage:l().DZ.jobApplications,sources:{"en-US":{previewRootId:"2efd56c2-0a35-4bb2-82f7-806cc8897475",rootId:"2efd56c2-0a35-4bb2-82f7-806cc8897475",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-81cb-b9d0-f271a642c54f",rootId:"143efdee-ad05-81cb-b9d0-f271a642c54f",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81ad-aec7-fd46734c5116",rootId:"143efdee-ad05-81ad-aec7-fd46734c5116",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-8102-8a5e-db9c601db0d0",rootId:"143efdee-ad05-8102-8a5e-db9c601db0d0",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-8138-8bc4-c026575c1a5a",rootId:"143efdee-ad05-8138-8bc4-c026575c1a5a",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-81ff-9e94-daddcf254276",rootId:"143efdee-ad05-81ff-9e94-daddcf254276",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-8184-9c4a-d4c5e2864553",rootId:"143efdee-ad05-8184-9c4a-d4c5e2864553",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-8079-955a-ffed1bc03180",rootId:"156efdee-ad05-8079-955a-ffed1bc03180",spaceId:s().Zz}}},onboardingGroupProjects:{nameMessage:l().DZ.projectManagement,sources:{"en-US":{previewRootId:"57fb8021-9ca4-4433-ba46-9dcef774a280",rootId:"57fb8021-9ca4-4433-ba46-9dcef774a280",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-8106-9cc4-c4e5271898ac",rootId:"143efdee-ad05-8106-9cc4-c4e5271898ac",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81ac-9117-e8bf31e1dbcd",rootId:"143efdee-ad05-81ac-9117-e8bf31e1dbcd",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-81db-ae0b-d5e40440248e",rootId:"143efdee-ad05-81db-ae0b-d5e40440248e",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-8109-97f5-c83ecd0f8528",rootId:"143efdee-ad05-8109-97f5-c83ecd0f8528",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-81bf-82de-e7b262a7828a",rootId:"143efdee-ad05-81bf-82de-e7b262a7828a",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-816a-b025-d52699cdb6cf",rootId:"143efdee-ad05-816a-b025-d52699cdb6cf",spaceId:s().Zz},"zh-TW":{previewRootId:"143efdee-ad05-81af-b314-d6dd6307b9ad",rootId:"143efdee-ad05-81af-b314-d6dd6307b9ad",spaceId:s().Zz}}},onboardingTodos:{nameMessage:l().DZ.weeklyTodo,sources:{"en-US":{previewRootId:"100efdee-ad05-807b-a52d-f1f55c5b017e",rootId:"100efdee-ad05-807b-a52d-f1f55c5b017e",spaceId:s().Zz},"ko-KR":{previewRootId:"13fefdee-ad05-8189-9104-c2046861495c",rootId:"13fefdee-ad05-8189-9104-c2046861495c",spaceId:s().Zz},"ja-JP":{previewRootId:"13fefdee-ad05-81b7-af84-fd86d8fc68bc",rootId:"13fefdee-ad05-81b7-af84-fd86d8fc68bc",spaceId:s().Zz},"fr-FR":{previewRootId:"13fefdee-ad05-814a-bc42-e93a1ed5b0e1",rootId:"13fefdee-ad05-814a-bc42-e93a1ed5b0e1",spaceId:s().Zz},"de-DE":{previewRootId:"13fefdee-ad05-81b4-808b-e0c5709345ee",rootId:"13fefdee-ad05-81b4-808b-e0c5709345ee",spaceId:s().Zz},"es-LA":{previewRootId:"13fefdee-ad05-8151-83de-fe1c2acacc02",rootId:"13fefdee-ad05-8151-83de-fe1c2acacc02",spaceId:s().Zz},"pt-BR":{previewRootId:"13fefdee-ad05-8100-9215-e984d0a11a94",rootId:"13fefdee-ad05-8100-9215-e984d0a11a94",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-80ef-92c7-ec3adbdaf5f7",rootId:"156efdee-ad05-80ef-92c7-ec3adbdaf5f7",spaceId:s().Zz}}},onboardingProjectsTasks:{nameMessage:l().DZ.projectManagement,sources:{"en-US":{previewRootId:"d31296ec-615d-48fb-8d78-c0f120434124",rootId:"d31296ec-615d-48fb-8d78-c0f120434124",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-81a9-a8f3-c60db17ef328",rootId:"143efdee-ad05-81a9-a8f3-c60db17ef328",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81ac-8817-f6e9fe69f0da",rootId:"143efdee-ad05-81ac-8817-f6e9fe69f0da",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-815a-8209-f89dded4ee01",rootId:"143efdee-ad05-815a-8209-f89dded4ee01",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-81e8-84a7-f025d8e62149",rootId:"143efdee-ad05-81e8-84a7-f025d8e62149",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-817f-8205-ca74a302a56e",rootId:"143efdee-ad05-817f-8205-ca74a302a56e",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-8173-b8e5-c90c05e2defd",rootId:"143efdee-ad05-8173-b8e5-c90c05e2defd",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-8054-8e35-c7a4797097e5",rootId:"156efdee-ad05-8054-8e35-c7a4797097e5",spaceId:s().Zz}}},onboardingHabitWellness:{nameMessage:l().DZ.habitTracker,sources:{"en-US":{previewRootId:"1ce7e74a-0cb8-4380-ac57-275cc870489b",rootId:"1ce7e74a-0cb8-4380-ac57-275cc870489b",spaceId:s().Zz},"ko-KR":{previewRootId:"13fefdee-ad05-8163-ae75-df0174c7c430",rootId:"13fefdee-ad05-8163-ae75-df0174c7c430",spaceId:s().Zz},"ja-JP":{previewRootId:"13fefdee-ad05-81a3-a3b9-e04e61488066",rootId:"13fefdee-ad05-81a3-a3b9-e04e61488066",spaceId:s().Zz},"fr-FR":{previewRootId:"13fefdee-ad05-8135-882b-e2890e63a8c2",rootId:"13fefdee-ad05-8135-882b-e2890e63a8c2",spaceId:s().Zz},"de-DE":{previewRootId:"13fefdee-ad05-812c-a584-ce3c29c48810",rootId:"13fefdee-ad05-812c-a584-ce3c29c48810",spaceId:s().Zz},"es-LA":{previewRootId:"13fefdee-ad05-81ab-a7e6-d7efb7d41f80",rootId:"13fefdee-ad05-81ab-a7e6-d7efb7d41f80",spaceId:s().Zz},"pt-BR":{previewRootId:"13fefdee-ad05-8199-95d6-c57460ec8124",rootId:"13fefdee-ad05-8199-95d6-c57460ec8124",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-805b-a670-fe13b866cafb",rootId:"156efdee-ad05-805b-a670-fe13b866cafb",spaceId:s().Zz}}},onboardingBudgetPersonalFinance:{nameMessage:l().DZ.simpleBudget,sources:{"en-US":{previewRootId:"01e1651c-ae3c-4c16-882c-a5951acc5c17",rootId:"01e1651c-ae3c-4c16-882c-a5951acc5c17",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-8150-8695-c883cecf18a3",rootId:"143efdee-ad05-8150-8695-c883cecf18a3",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81ae-a900-f6d65504f2ec",rootId:"143efdee-ad05-81ae-a900-f6d65504f2ec",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-81fc-a087-e161a046bab9",rootId:"143efdee-ad05-81fc-a087-e161a046bab9",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-81ae-8aa3-e6ed50bfb9b4",rootId:"143efdee-ad05-81ae-8aa3-e6ed50bfb9b4",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-81a3-b15a-cd149d57b639",rootId:"143efdee-ad05-81a3-b15a-cd149d57b639",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-8154-8fbc-dfb5b6a28e16",rootId:"143efdee-ad05-8154-8fbc-dfb5b6a28e16",spaceId:s().Zz},"zh-TW":{previewRootId:"155efdee-ad05-8086-8830-e8742b0fae03",rootId:"155efdee-ad05-8086-8830-e8742b0fae03",spaceId:s().Zz}}},onboardingTravel:{nameMessage:l().DZ.travelPlanner,sources:{"en-US":{previewRootId:"0377a864-3392-4c3d-8fb4-93a7090da36d",rootId:"0377a864-3392-4c3d-8fb4-93a7090da36d",spaceId:s().Zz},"ko-KR":{previewRootId:"152efdee-ad05-803f-8539-c04282f8a5f1",rootId:"152efdee-ad05-803f-8539-c04282f8a5f1",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81c9-bf43-c677fb843a97",rootId:"143efdee-ad05-81c9-bf43-c677fb843a97",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-8144-9290-cc99fe767cc2",rootId:"143efdee-ad05-8144-9290-cc99fe767cc2",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-814e-ad6f-f4b4018bcf01",rootId:"143efdee-ad05-814e-ad6f-f4b4018bcf01",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-8161-8c70-dc7e7b67f385",rootId:"143efdee-ad05-8161-8c70-dc7e7b67f385",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-81c0-b3c6-fe32127494af",rootId:"143efdee-ad05-81c0-b3c6-fe32127494af",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-80c6-a6bf-fe009f1a8f47",rootId:"156efdee-ad05-80c6-a6bf-fe009f1a8f47",spaceId:s().Zz}}},onboardingHobbies:{nameMessage:l().DZ.personalHome,sources:{"en-US":{previewRootId:"100efdee-ad05-80f9-9e2f-e1cc18377400",rootId:"100efdee-ad05-80f9-9e2f-e1cc18377400",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-81c8-ac14-e5e5e1ef2f81",rootId:"143efdee-ad05-81c8-ac14-e5e5e1ef2f81",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-8100-906f-c98376fef3d7",rootId:"143efdee-ad05-8100-906f-c98376fef3d7",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-8189-8be8-c0077def8c7c",rootId:"143efdee-ad05-8189-8be8-c0077def8c7c",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-81fd-a9ec-cd4f67931f0d",rootId:"143efdee-ad05-81fd-a9ec-cd4f67931f0d",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-811f-bfdd-d926f115eeed",rootId:"143efdee-ad05-811f-bfdd-d926f115eeed",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-815b-bfeb-eb65424473f4",rootId:"143efdee-ad05-815b-bfeb-eb65424473f4",spaceId:s().Zz},"zh-TW":{previewRootId:"143efdee-ad05-81ab-bdcb-c59f61a23634",rootId:"143efdee-ad05-81ab-bdcb-c59f61a23634",spaceId:s().Zz}}},onboardingCareerBuilding:{nameMessage:l().DZ.jobBoard,sources:{"en-US":{previewRootId:"296d5b43-9e4c-408a-8ba2-e202d9f38b20",rootId:"296d5b43-9e4c-408a-8ba2-e202d9f38b20",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-8197-9f58-d07e2737d50b",rootId:"143efdee-ad05-8197-9f58-d07e2737d50b",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-817c-8e7a-e50f07f77747",rootId:"143efdee-ad05-817c-8e7a-e50f07f77747",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-8101-88dc-c024930282a2",rootId:"143efdee-ad05-8101-88dc-c024930282a2",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-8150-806c-fb5c0f3e6c0a",rootId:"143efdee-ad05-8150-806c-fb5c0f3e6c0a",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-815f-b224-d7b564a11406",rootId:"143efdee-ad05-815f-b224-d7b564a11406",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-81e5-be5b-c15caf22f82c",rootId:"143efdee-ad05-81e5-be5b-c15caf22f82c",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-8006-898b-dfc3a03e9052",rootId:"156efdee-ad05-8006-898b-dfc3a03e9052",spaceId:s().Zz}}},onboardingFoodNutrition:{nameMessage:l().DZ.personalHome,sources:{"en-US":{previewRootId:"100efdee-ad05-806d-909f-dafc0f1fef48",rootId:"100efdee-ad05-806d-909f-dafc0f1fef48",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-81f5-a0ad-f619d1607c29",rootId:"143efdee-ad05-81f5-a0ad-f619d1607c29",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81db-a853-d677b6292636",rootId:"143efdee-ad05-81db-a853-d677b6292636",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-812b-b3c1-f7b5e8f8f7d7",rootId:"143efdee-ad05-812b-b3c1-f7b5e8f8f7d7",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-8156-b426-d739a3f9da5f",rootId:"143efdee-ad05-8156-b426-d739a3f9da5f",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-81aa-a5d9-ecf9472ba97d",rootId:"143efdee-ad05-81aa-a5d9-ecf9472ba97d",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-81c8-9f83-c88e756bd26d",rootId:"143efdee-ad05-81c8-9f83-c88e756bd26d",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-80aa-8d1c-e16d660b6371",rootId:"156efdee-ad05-80aa-8d1c-e16d660b6371",spaceId:s().Zz}}},onboardingWebsiteBuildingForLife:{nameMessage:l().DZ.blogPost,sources:{"en-US":{previewRootId:"0ffefdee-ad05-80be-88ce-d77fc8e93fff",rootId:"0ffefdee-ad05-80be-88ce-d77fc8e93fff",spaceId:s().Zz},"ko-KR":{previewRootId:"143efdee-ad05-8174-a5e7-e1a2732303b9",rootId:"143efdee-ad05-8174-a5e7-e1a2732303b9",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81fa-99dd-d257c4e9b1c2",rootId:"143efdee-ad05-81fa-99dd-d257c4e9b1c2",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-81a9-8236-ee31b552b18f",rootId:"143efdee-ad05-81a9-8236-ee31b552b18f",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-812f-96ab-c3c12fbb71b7",rootId:"143efdee-ad05-812f-96ab-c3c12fbb71b7",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-8172-9406-dd5f6eb17e05",rootId:"143efdee-ad05-8172-9406-dd5f6eb17e05",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-81a8-9f8f-e0ce84feb984",rootId:"143efdee-ad05-81a8-9f8f-e0ce84feb984",spaceId:s().Zz},"zh-TW":{previewRootId:"156efdee-ad05-805a-8e31-ea80d88a8629",rootId:"156efdee-ad05-805a-8e31-ea80d88a8629",spaceId:s().Zz}}},onboardingEntertainment:{nameMessage:l().DZ.blogPost,sources:{"en-US":{previewRootId:"0f536756-d4b0-4ef9-a6fa-a9836163fe96",rootId:"0f536756-d4b0-4ef9-a6fa-a9836163fe96",spaceId:s().Zz},"ko-KR":{previewRootId:"14cefdee-ad05-808e-9421-fc83eb34c288",rootId:"14cefdee-ad05-808e-9421-fc83eb34c288",spaceId:s().Zz},"ja-JP":{previewRootId:"143efdee-ad05-81d3-b4c8-c24f10c4002b",rootId:"143efdee-ad05-81d3-b4c8-c24f10c4002b",spaceId:s().Zz},"fr-FR":{previewRootId:"143efdee-ad05-8172-8bc3-d484af0f7cef",rootId:"143efdee-ad05-8172-8bc3-d484af0f7cef",spaceId:s().Zz},"de-DE":{previewRootId:"143efdee-ad05-81ae-a2d8-e7efe2fc8740",rootId:"143efdee-ad05-81ae-a2d8-e7efe2fc8740",spaceId:s().Zz},"es-LA":{previewRootId:"143efdee-ad05-8114-bd29-d5d5e28509b8",rootId:"143efdee-ad05-8114-bd29-d5d5e28509b8",spaceId:s().Zz},"pt-BR":{previewRootId:"143efdee-ad05-8132-96c1-dd872b390408",rootId:"143efdee-ad05-8132-96c1-dd872b390408",spaceId:s().Zz},"zh-TW":{previewRootId:"155efdee-ad05-80fa-a77d-d609b51ad439",rootId:"155efdee-ad05-80fa-a77d-d609b51ad439",spaceId:s().Zz}}}},g={planner:{desktop:f.onboardingPlanner,mobile:m.onboardingPlanner},notes:{desktop:f.onboardingNotes,mobile:m.onboardingNotes},research:{desktop:f.onboardingResearch,mobile:m.onboardingResearch},clubs:{desktop:f.onboardingClubs,mobile:m.onboardingClubs},teachingLessonPlans:{desktop:f.onboardingTeachingLessonPlans,mobile:m.onboardingTeachingLessonPlans},teachingClassroomManagement:{desktop:f.onboardingTeachingClassroomManagement,mobile:m.onboardingTeachingClassroomManagement},websiteBuildingForSchool:{desktop:f.onboardingWebsiteBuildingForSchool,mobile:m.onboardingWebsiteBuildingForSchool},internshipApplications:{desktop:f.onboardingInternshipApplications,mobile:m.onboardingInternshipApplications},groupProjects:{desktop:f.onboardingGroupProjects,mobile:m.onboardingGroupProjects},todos:{desktop:f.onboardingTodos,mobile:m.onboardingTodos},projectsTasks:{desktop:f.onboardingProjectsTasks,mobile:m.onboardingProjectsTasks},habitWellness:{desktop:f.onboardingHabitWellness,mobile:m.onboardingHabitWellness},budgetPersonalFinance:{desktop:f.onboardingBudgetPersonalFinance,mobile:m.onboardingBudgetPersonalFinance},travel:{desktop:f.onboardingTravel,mobile:m.onboardingTravel},hobbies:{desktop:f.onboardingHobbies,mobile:m.onboardingHobbies},careerBuilding:{desktop:f.onboardingCareerBuilding,mobile:m.onboardingCareerBuilding},foodNutrition:{desktop:f.onboardingFoodNutrition,mobile:m.onboardingFoodNutrition},websiteBuildingForLife:{desktop:f.onboardingWebsiteBuildingForLife,mobile:m.onboardingWebsiteBuildingForLife},entertainment:{desktop:f.onboardingEntertainment,mobile:m.onboardingEntertainment}},b={desktop:[f.onboardingTodos,f.onboardingBudgetPersonalFinance],mobile:[m.onboardingTodos,m.onboardingBudgetPersonalFinance]},v={desktop:[f.onboardingPlanner,f.onboardingNotes],mobile:[m.onboardingPlanner,m.onboardingNotes]},I=[p.educationClassNotes,p.educationGroupProjects];var w=()=>o(529316),S=()=>o(959013);const y=(0,S().YK)({gantt:{defaultMessage:"Gantt chart ",id:"templateHelpers.gantt"},crm:{defaultMessage:"CRM",id:"templateHelpers.crm"},projectManagement:{defaultMessage:"Project management",id:"templateHelpers.projectManagement"}}),h={onboardingGantt:{nameMessage:y.gantt,sources:{"en-US":{previewRootId:"13c17954-d9c2-80c1-9ef2-c69951bd98e0",rootId:"13c17954-d9c2-80c1-9ef2-c69951bd98e0",spaceId:d().rQ}}},onboardingCrm:{nameMessage:y.crm,sources:{"en-US":{previewRootId:"14517954-d9c2-801e-990c-cf21ecd51949",rootId:"14517954-d9c2-801e-990c-cf21ecd51949",spaceId:d().rQ}}},onboardingProjectManagement:{nameMessage:y.projectManagement,sources:{"en-US":{previewRootId:"14517954-d9c2-80a4-9fbf-d0581e8c6e3d",rootId:"14517954-d9c2-80a4-9fbf-d0581e8c6e3d",spaceId:d().rQ}}}};var _=()=>o(797573);const T=["en-US","ko-KR","ja-JP","fr-FR","de-DE","en-ES","es-ES","es-LA","pt-BR","nb-NO","fi-FI","sv-SE","da-DK","nl-NL","zh-CN","zh-TW"];const k=["scratchpad","oneOnOneNotesV2"];var C=()=>o(872931),R=()=>o(496603),A=()=>o(452939),P=()=>o(160568),M=()=>o(449506),D=()=>o(413677),N=()=>o(246826),O=()=>o(666144),U=()=>o(185544),x=()=>o(751156),E=()=>o(767435),V=()=>o(235921),F=()=>o(855801),B=()=>o(611191),z=()=>o(972435),Z=()=>o(406792),W=()=>o(351360),Q=()=>o(227440),j=()=>o(508496),L=()=>o(913454),q=()=>o(317053);const $=(0,S().YK)({invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnCreateTemplate:{defaultMessage:"Invalid space view data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidStorage.message"},invalidUserSettings:{defaultMessage:"Invalid user settings data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidUserSettings.message"}});async function K(e){const{environment:t,spaceViewStore:o,isPrivate:r,userSettingsStore:i,redirectData:s,userRootStore:c,planType:d,spaceJoinOrCreate:l,teamStore:p,templatesToCreateInSpace:u,isNewUserOnboarding:f}=e,m=o.getSpaceStore();if(!m)throw new Error(z().A.formatMessage($.invalidSpaceStore));let g,b=[];if(i&&m&&(u.pageTemplates||u.appTemplates||u.workflowTemplates)){const t=j().default.getEligibleGroup({experimentId:"defer_onboarding_template_creation",defaultGroup:"control"}),o="performance_marketing_template"!==s.type&&"with_async"===t,n="performance_marketing_template"!==s.type&&"with_timeout"===t;if(o)H({...e,spaceStore:m,userSettingsStore:i,teamStore:p,isNewUserOnboarding:f});else if(n)try{const t=j().default.getConfigKey("onboarding_config","templatesDuplicationTimeoutInSeconds");let o=t;switch(j().default.getEligibleGroup({experimentId:"defer_onboarding_templates_timeout",defaultGroup:"control"})){case"2seconds":o=2;break;case"3seconds":o=3;break;case"4seconds":o=4;break;default:o=t}const a=H({...e,spaceStore:m,userSettingsStore:i,teamStore:p,isNewUserOnboarding:f});b=await Promise.race([a,new Promise((e=>{setTimeout((()=>e([])),1e3*o)}))])}catch(v){a().log({level:"error",from:"createOnboardingTemplatesActions",type:"createTemplatePagesInSpace",data:{miscDataToConvertToString:{error:v}}})}else b=await H({...e,spaceStore:m,userSettingsStore:i,teamStore:p,isNewUserOnboarding:f})}if(i)g=await async function(e){const{environment:t,spaceStore:o,spaceViewStore:a,userSettingsStore:r,planType:i,spaceJoinOrCreate:s,isNewUserOnboarding:c}=e;if(await Promise.all([o.load(),a.load(),r.load()]),!o.canEdit())return;if(!a.isDefined())throw new Error(z().A.formatMessage($.invalidSpaceStoreOnCreateTemplate));if(!r.isDefined())throw new Error(z().A.formatMessage($.invalidUserSettings));let d;d=t.device.isMobile?function(){if("v1"===j().default.getEligibleGroup({experimentId:"mobile_getting_started",defaultGroup:"control"}))return"mobileVariant1";return"mobile"}():"personal"===i?"desktopPersonal":"create"===s?function(e){if(!e)return"desktopTeamCreate";return"desktopPersonal"}(c):"desktopTeamJoin";if("en-US"===(0,n().H)(z().A.getIntl())&&!t.device.isMobile&&("desktopPersonal"===d||"desktopTeamJoin"===d)){const e={desktopPersonal:"adoption_personal_create_gs_embed_simple",desktopTeamJoin:"adoption_team_join_gs_embed_simple"}[d];switch(j().default.getEligibleGroup({experimentId:e,defaultGroup:"control"})){case"simplified_getting_started":d=`${d}EntrypointSimplified`;break;case"simplified_getting_started_with_embed":d=`${d}EntrypointSimplifiedWithEmbed`;break;case"simplified_getting_started_with_embed_and_visual":d=`${d}EntrypointSimplifiedWithVisual`}}if(!a.getCreatedGettingStarted())return X({environment:t,spaceStore:o,spaceViewStore:a,type:d,userSettingsStore:r});A().xL(t,{getting_started_page_type:d,spaceId:o.id,errorType:"createdGettingStartedPageAlreadyExists"})}({isNewUserOnboarding:f,environment:t,spaceStore:m,spaceViewStore:o,userSettingsStore:i,planType:d,spaceJoinOrCreate:l});else{const{currentUserSettingsStore:e}=W().default.state;A().xL(t,{errorType:"userSettingsStoreNotDefined",spaceId:m.id,errorMessage:e?"currentUserSettingsStore is defined but not userSettingsStore from onboarding data":"currentUserSettingsStore is not defined as well"})}return await G({environment:t,redirectData:s,spaceViewStore:o,spaceStore:m,userRootStore:c,isPrivate:r,createdGettingStartedPage:g,createdTemplatePages:b})}async function G(e){const{environment:t,spaceViewStore:o,isPrivate:a,redirectData:n,userRootStore:r,spaceStore:i,createdGettingStartedPage:s,createdTemplatePages:c}=e;if("performance_marketing_template"===n.type)return c[0];if("fork_page"===n.type){return await U().sg({environment:t,userRootStore:r,isPrivate:a,forkedPageId:n.pageId,spaceStore:i,spaceViewStore:o})}return s}function J(e){const{environment:t,success:o,template_id:a,template_block_id:n,target_space_id:r,public_template_name:i,target_page_id:s}=e;P().hB(t,{success:o,template_id:a,template_block_id:n,target_space_id:r,from:"onboarding",public_template_name:i,target_page_id:s})}async function H(e){const{spaceStore:t,spaceViewStore:o,userSettingsStore:a,teamStore:n,environment:r}=e;if(await Promise.all([t.load(),o.load(),a.load(),null==n?void 0:n.load()]),t.canEdit()){if(!o.isDefined())throw new Error(z().A.formatMessage($.invalidSpaceStoreOnCreateTemplate));if(!a.isDefined())throw new Error(z().A.formatMessage($.invalidUserSettings));if(!o.getCreatedOnboardingTemplates()){const t=Z().default.mark("onboarding_create_templates_latency");let o;o=j().default.checkGate({gateName:"use_initialize_page_template_api_onboarding"})?"initialize_template_api":j().default.checkGate({gateName:"use_local_duplication_for_onboarding"})?"server_backed_local_duplication":j().default.checkGate({gateName:"use_duplicate_block_sync"})?"server_synchronous_duplicate_block":"server_duplication";const a=await async function(e){const{environment:t,spaceStore:o,spaceViewStore:a,teamStore:n,templatesToCreateInSpace:r}=e,{workflowTemplates:i,pageTemplates:s,appTemplates:c}=r;let d=[];if(i&&i.length>0&&n&&x().createAndCommit({userAction:"workflowTemplatesOnboardingActions.createPlaceholderCollectionViewBlock",environment:t,canUndo:!0,perform:e=>{for(const o of i){const a=(0,L().getCollectionTemplateFromId)(o);a&&(0,q().createPlaceholderWorkflowTemplateBlock)({environment:t,transaction:e,parentStore:n,collectionTemplate:a})}}}),c&&c.length>0&&n&&(d=await E().installAppsInTeam({environment:t,presets:c,spaceStore:o,spaceViewStore:a,teamStore:n})),s&&s.length>0){const e=s.map((e=>{const r={environment:t,template_id:e.id,template_block_id:e.rootId,target_space_id:o.id,public_template_name:e.name};return n?D().createTemplateInstance({environment:t,item:e,spaceStore:o,spaceViewStore:a,useMinimalTemplates:!0,teamStore:n,type:"inTeam",from:"onboarding",isOnboarding:!0,onSuccess:e=>{J({...r,success:!0,target_page_id:e.id})},onError:e=>{J({...r,success:!1,target_page_id:(null==e?void 0:e.id)??""})}}):D().createTemplateInstance({environment:t,item:e,spaceStore:o,spaceViewStore:a,useMinimalTemplates:!0,type:"inSpace",isOnboarding:!0,onSuccess:e=>{J({...r,success:!0,target_page_id:e.id})},onError:e=>{J({...r,success:!1,target_page_id:(null==e?void 0:e.id)??""})}})}));d=[...d,...R().oE(await Promise.all(e))]}return(s&&s.length>0||c&&c.length>0)&&x().createAndCommit({userAction:"spaceActions.createOnboardingTemplatesInSpace",environment:t,canUndo:!0,perform:e=>{const t={created_onboarding_templates:!0};N().zv({store:a,data:t,transaction:e})}}),d}({...e});return Z().default.measure(t,{environment:r,data:{duplication_type:o}}),a}}return[]}async function X(e){const{environment:t,type:o,spaceStore:a,spaceViewStore:n,userSettingsStore:s}=e;if(!Q().A.state.online)return;const c=function(e,t){return(0,_().B)(w().yG[e],t)}(o,z().A.getIntl()),d=c.rootId,l=w().dy.includes(o),p=await M().callApi({eventName:"loadBlockSubtree",environment:t,data:{block:{id:d,spaceId:c.spaceId},shallow:!1},headers:(0,r().WS)({spaceId:c.spaceId})});let u;if("failed"===p.type)return void A().xL(t,{getting_started_page_type:o,errorType:"loadBlockSubtreeFailed",spaceId:a.id,errorMessage:p.error.message,copyPageId:d});u=i().RecordMapWithRole.create(p.data.subtreeRecordMap);const{loadLocalSubtree:f,localDuplicate:m}=await(0,F().D6)(),{messages:{createAndDuplicatePageError:g}}=await(0,F().nd)(),b="spaceActions.createGettingStartedPageInSpace",{performResult:v,serverCommitResult:I}=x().createAndCommit({userAction:b,environment:t,canUndo:!0,isTemplateInstantiationTransaction:!0,perform:e=>{const r=U().IT({environment:t,spaceStore:a,spaceViewStore:n,isPrivate:!0,prepend:!0,transaction:e});O()._O({environment:t,inMemoryRecordCache:r.inMemoryRecordCache,recordMap:u,debugSource:b});const i=f(t,{blockId:d,inMemoryRecordCache:r.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0,includeLegacyTransclusionBlockValues:(0,B().$J)(),includeDiscussions:l,includeComments:l}).recordMap;if(!i)throw A().xL(t,{getting_started_page_type:o,errorType:"createAndDuplicatePageFailed",spaceId:a.id}),new Error(z().A.formatMessage(g));m({environment:t,sourceBlockId:d,targetBlockPointer:r.pointer,sourceBlockSubtree:i,targetInMemoryRecordCache:r.inMemoryRecordCache,transaction:e,templateInstallationMetadata:{source:"onboarding"},duplicateDiscussions:l,options:{deepCopyTransclusionContainers:!0,isTemplateInstallation:!0,resolveTemplateVariables:!0,preventLegacyTransclusions:(0,B().$J)()}});const c={},p={};return"evernote"===o?p.created_evernote_getting_started=!0:c.created_getting_started=!0,Object.keys(c).length>0&&N().zv({store:n,data:c,transaction:e}),Object.keys(p).length>0&&N().zv({store:s.getSettingsStore(),data:p,transaction:e}),r}});return I.then((()=>{A().K5(t,{getting_started_page_type:o,getting_started_page_id:d,duplicated_from_page_id:d,duplicated_to_page_id:v.id})})),v}function Y(e){var t;const{environment:o,onboardingPlanType:a,categories:n,isJoiner:r,intl:i}=e;let s;const d=function(e,t){return"personal"===t?e.filter((e=>C()._N.includes(e))):"school"===t?e.filter((e=>C().gb.includes(e))):[]}(n,a);return s=(null===(t=V().A.state.planTypeAndSurveyInfo)||void 0===t||null===(t=t.surveyResponses)||void 0===t?void 0:t.educationRole)?function(){var e;const t=null===(e=V().A.state.planTypeAndSurveyInfo)||void 0===e||null===(e=e.surveyResponses)||void 0===e?void 0:e.categories;if(!t||0===t.length)return I;const o=[];for(const a of t){const e=u[a];e&&o.push(e)}return o}():"school"===a||"personal"===a?ae(o,a,d):r?te():c().Ck,(0,_().o)(s,i)}function ee(e,t){return"gantt"===e?(0,_().o)([h.onboardingGantt],t):"crm"===e?(0,_().o)([h.onboardingCrm],t):"projectManagement"===e?(0,_().o)([h.onboardingProjectManagement],t):[]}function te(){if(j().default.checkGate({gateName:"onboarding_templates_from_dynamic_configs"})){const t=j().default.getConfigKey("onboarding_templates","joiner"),o=[];for(const[a,n]of Object.entries(t)){if("string"!=typeof(e=a)||!k.includes(e))return c().mb;const t=oe(n.sources),r=c().Fx[a];o.push({sources:t,nameMessage:r})}return o}var e;return c().mb}function oe(e){return Object.keys(e).reduce(((t,o)=>{var a,n;if("string"!=typeof(n=o)||!T.includes(n))return t;const r=null===(a=e[o])||void 0===a?void 0:a.rootId;return t[o]={rootId:r,previewRootId:r,spaceId:d().rQ},t}),{})}function ae(e,t,o){const a=[],n=z().A.isEnglish(),r=e.device.isMobile&&n,i=e.device.isMobile&&!n&&"on"===j().default.getEligibleGroup({experimentId:"mobile_friendly_onboarding_templates_personal_non_en",defaultGroup:"control"}),s=r||i;for(const d of o)a.push(s?g[d].mobile:g[d].desktop);const c="school"===t?s?v.mobile:v.desktop:s?b.mobile:b.desktop;return 0===a.length&&a.push(...c),a}function ne(e){return(0,_().o)([c().nG],e.intl).pop()}function re(e,t){return(0,_().o)(e.map((e=>{if("goals"===e)return c().kx.goalsForTeam})).filter((e=>void 0!==e)),t)}},790068:(e,t,o)=>{o.d(t,{K:()=>i});o(898992),o(672577);var a=()=>o(59424),n=()=>o(235921),r=()=>o(508496);function i(e){const{store:t}=e,o=n().A.state,i=(0,a().isAiOnboardingFlow)(o.flowName)||r().default.checkGate({gateName:"workflows_simple_mode"}),s=r().default.checkGate({gateName:"workflows_config_module_available"}),c=r().default.checkGate({gateName:"workflows_custom_view_type"}),d=null==t?void 0:t.getCollectionViewStores().find((e=>"custom"===e.getType()));return{type:"workflow",workflowBlockId:null==t?void 0:t.id,enableCustomViews:!!d||!i&&c,enableFunctions:!i,enableConfigVariables:s}}},839754:(e,t,o)=>{o.d(t,{Bi:()=>f,My:()=>u,ZM:()=>m});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577),o(581454);var a=()=>o(663077),n=()=>o(919709),r=()=>o(686526),i=()=>o(896628),s=()=>o(319975),c=()=>o(751156),d=()=>o(180762),l=()=>o(799832),p=()=>o(204067);function u(e){var t;let{transaction:o,collectionStore:n,propertyTemplates:r}=e;const s=(null===(t=n.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewStores().filter((e=>"table"===e.getType())))??[];if(0===s.length)return;const c=[];for(const i of r){const e=(0,p().S1)({collectionStore:n,templateId:i.templateId,instancePointerType:"property"});e&&c.push({property:e.id,visible:!(0,a().Sz)(i),...i.tablePropertyFormat})}if(0!==c.length)for(const a of s){var d;const e=(null===(d=a.getPropertyFormatsStore("table_properties"))||void 0===d?void 0:d.getValue())??[],t=new Set(e.map((e=>e.property))),n=c.filter((e=>!t.has(e.property)));0!==n.length&&i().zA({stores:[a],update:{table_properties:[...e,...n]},transaction:o})}}function f(e){let{transaction:t,collectionStore:o,propertyTemplates:a}=e;const n=[];for(const i of a){const e=(0,p().S1)({collectionStore:o,templateId:i.templateId,instancePointerType:"property"});e&&n.push({property:e.id,visible:!0})}const r=o.getFormat().collection_page_properties??[],s=new Set(r.map((e=>e.property))),c=n.filter((e=>!s.has(e.property)));c.length&&i().zA({stores:[o],update:{collection_page_properties:[...r,...c]},transaction:t})}function m(e){let{environment:t,userAction:o,result:a,existingCollectionViewBlockStore:i,existingCollectionStore:p}=e;if("canceled"!==a.type){if("accepted_empty_collection"===a.type&&p){const e=p.getKeyStore("name"),r=(0,n().x9d)(a.newCollectionTitle);e&&c().createAndCommit({userAction:o,environment:t,canUndo:!0,perform:o=>s().R9({environment:t,store:e,transaction:o,value:r})})}if(i){var u;const e=null===(u=(0,l().U)(i))||void 0===u?void 0:u.settingsStore;e&&r().os({collectionSettingsStore:e})}if("accepted_template"===a.type&&null!=i&&i.isCollectionView()&&(null==i||!i.hasSingleSourceAndNoLinkedCollections())){const e=(0,l().U)(i),o=i.getCollectionViewStores().find((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===a.collectionId}));if(!e||!o)return;(0,d().t)({environment:t,collectionContextStore:e,collectionViewId:o.id,isFullScreen:e.isFullScreenStore.state,isRootChild:e.isRootChildStore.state,isInPeekRenderer:e.isInPeekRendererStore.state})}}}},846199:(e,t,o)=>{o.d(t,{A:()=>a});const a=o(757695).default.createValue({open:!1},{name:"TrialInfoModalStore"})},872931:(e,t,o)=>{o.d(t,{$u:()=>s,Kn:()=>c,_N:()=>r,gb:()=>n,mQ:()=>d,tR:()=>i});var a=()=>o(638681);const n=["planner","notes","research","clubs","teachingLessonPlans","teachingClassroomManagement","websiteBuildingForSchool","internshipApplications","groupProjects"],r=["todos","projectsTasks","habitWellness","budgetPersonalFinance","travel","hobbies","careerBuilding","foodNutrition","websiteBuildingForLife","entertainment"],i=["k-12","undergraduate","graduate"],s=["never","a few times"],c=["Illegal activities","Graphic and harmful content","Child exploitation","Harassment, bullying, defamation, and threats","Hateful content","Intellectual property","Malicious and deceptive practices","Personal and confidential information","Interference with the Services","Content subject to additional scrutiny","Billing fraud","Sanctions regulations","Card testing","Account Lockout","Other"],d=(a().literals(...c),["Violent or obscene content","Sexually explicit","Promotes self-harm","Promotes terrorist activity","Misinformation","Get rich quick","Gambling services or products","Price-gauging","Online or day trading","Multi-level marketing or affiliate marketing","Credit abuse","Payments fraud","Specially Designated National (SDN) screening","User must contact support to manually verify account ownership"]);a().literals(...d)},896326:(e,t,o)=>{o.d(t,{C8:()=>u,ET:()=>p,Ll:()=>T,OX:()=>m,QT:()=>b,Rh:()=>S,UA:()=>l,Wm:()=>v,XM:()=>d,aO:()=>w,bd:()=>f,gM:()=>g,gP:()=>h,hq:()=>I,pp:()=>y});o(16280),o(944114),o(898992),o(354520),o(672577),o(581454);var a=()=>o(663077),n=()=>o(921756),r=()=>o(498212),i=()=>o(534177),s=()=>o(913454);const c=3;function d(e){let{origin:t,parentStore:o,flowId:a}=e;return{collectionTemplate:void 0,origin:t,flowId:a??(0,r().Ay)(),collectionTemplatesSearchQuery:void 0,parentStore:o}}function l(e){let{collectionViewTemplates:t,featureTemplateSelections:o}=e;const n=[];for(const r of t)n.push(...(0,a().CA)({template:r,dependencyMap:r.dependencyMap||{}}).map((e=>e.templateId)));return o.filter((e=>"required"!==e.optionality&&!n.includes(e.template.templateId)&&b(e.template)))}function p(e){let{template:t}=e;return{recordTitles:new Array(c).fill(""),featureTemplateSelections:t.value.templateItems.map((e=>f(e.pointer,e.optionality)))}}function u(e){const{collectionTemplate:t,origin:o,flowId:a,parentStore:n}=e;return{collectionTemplate:t,userCustomizations:p({template:t}),origin:o,flowId:a??(0,r().Ay)(),parentStore:n,collectionTemplatesSearchQuery:void 0,previewCollectionInfo:void 0}}function f(e,t){const o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:s().globalWorkflowTemplates).fromId(e);if(!(0,a().Jb)(o))throw new Error(`Template ${e} in collection template is not a feature template`);return"required"===t?{template:o,optionality:"required",selected:!0}:"optionalDefaultOn"===t?{template:o,optionality:"optionalDefaultOn",selected:!0}:"optionalDefaultOff"===t?{template:o,optionality:"optionalDefaultOff",selected:!1}:void(0,i().HB)(t)}function m(e){if(!e.collectionTemplate)throw new Error("Collection template cannot be undefined");return{collectionTemplate:e.collectionTemplate,userCustomizations:e.userCustomizations,origin:e.origin,flowId:e.flowId,collectionTemplatesSearchQuery:e.collectionTemplatesSearchQuery,parentStore:e.parentStore,previewCollectionInfo:e.previewCollectionInfo}}function g(e){var t,o,a,n;return{origin:e.origin,has_selection_modal_search_query:((null===(t=e.collectionTemplatesSearchQuery)||void 0===t?void 0:t.length)??0)>0,flow_id:e.flowId,collection_template_id:null===(o=e.collectionTemplate)||void 0===o?void 0:o.templateId,destination_type:null===(a=e.parentStore)||void 0===a?void 0:a.table,destination_id:null===(n=e.parentStore)||void 0===n?void 0:n.id}}function b(e){return"property"===e.type&&"relation"!==e.value.type||"compound"===e.type}function v(e){const{version:t}=e;return n().s[t]}function I(e){const{currentStepIndex:t}=e;return v(e)[t]}function w(e,t){const{currentStepIndex:o,collectionTemplate:a}=e,n=v(e);for(let r=o+1;r<n.length;r++){const e=n[r];if(!(a&&_({step:e,template:a,action:"next",isPhone:t})))return r}return-1}function S(e,t){return w(e,t)>=0}function y(e,t){return h(e,t)>=0}function h(e,t){const{currentStepIndex:o,collectionTemplate:a}=e,n=v(e);for(let r=o-1;r>=0;r--){const e=n[r];if(!(a&&_({step:e,template:a,action:"previous",isPhone:t})))return r}return-1}function _(e){let{step:t,template:o,action:a,isPhone:n}=e;switch(t){case"viewsSelection":return n||s().globalWorkflowTemplates.allOfType({templateIds:o.value.templateItems.map((e=>e.pointer)),type:"collection_view"}).length<=1;case"templateSelection":case"features":case"setupGeneratorInput":return!1;case"setupGeneratorBuilding":return"previous"===a;default:(0,i().HB)(t)}}function T(e){let{userCustomizations:t,templateId:o}=e;const a=t.featureTemplateSelections,n=a.find((e=>e.template.templateId===o));if(!n||"required"===n.optionality)return t;const r={...n,selected:!n.selected};return{...t,featureTemplateSelections:a.map((e=>e.template.templateId===o?r:e)),prevFeatureTemplateSelections:a}}},921756:(e,t,o)=>{o.d(t,{N:()=>a,s:()=>n});const a=["pre_signup_build_with_ai"],n={select_and_customize_template:["templateSelection","features","viewsSelection"],customize_template:["features","viewsSelection"],select_and_build_with_ai:["templateSelection","setupGeneratorInput","setupGeneratorBuilding","features","viewsSelection"],build_with_ai:["setupGeneratorInput","setupGeneratorBuilding","features","viewsSelection"],new_user_template_onboarding:["templateSelection","setupGeneratorBuilding","features","viewsSelection"],pre_signup_build_with_ai:["setupGeneratorInput","setupGeneratorBuilding","features","viewsSelection"]}}}]);