"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[2703,70593],{86465:(e,t,n)=>{n.d(t,{N:()=>o});n(296540);var r=n(474848);const o=(0,n(340498).wt)("share",{viewBox:"0 0 13 16",svg:(0,r.jsx)("path",{d:"M6.494 10.093a.59.59 0 01-.584-.578V3.123l.05-.946-.4.464-.888.952a.538.538 0 01-.4.171.504.504 0 01-.52-.508c0-.152.063-.266.17-.374L6.057.832a.577.577 0 01.882 0l2.133 2.05a.5.5 0 01.165.374.504.504 0 01-.52.508.524.524 0 01-.394-.171l-.895-.952-.394-.464.051.946v6.392a.59.59 0 01-.59.578zm-3.65 5.059c-1.371 0-2.082-.705-2.082-2.057V6.843c0-1.352.71-2.057 2.082-2.057h1.84V6.03H2.92c-.59 0-.914.305-.914.92v6.037c0 .616.324.92.914.92h7.154c.584 0 .914-.304.914-.92V6.951c0-.616-.33-.92-.914-.92H8.309V4.785h1.84c1.372 0 2.083.705 2.083 2.057v6.252c0 1.352-.711 2.057-2.082 2.057H2.844z"})})},88291:(e,t,n)=>{n.d(t,{$:()=>r});const r=new(n(848776).U)((()=>"aiPickableModels"),(async e=>{const t=await Promise.resolve().then(n.bind(n,449506)),r=await t.callApi({eventName:"getAiPickableModels",environment:e,data:{}});return"success"===r.type?r.data.models:[]}));n(604341).exposeDebugValue("AiPickableModelsStore",r)},218602:(e,t,n)=>{function r(e){return`${e.environmentName}-${e.suffix}`}n.d(t,{W:()=>r})},277942:(e,t,n)=>{n.d(t,{J1:()=>a,M4:()=>c,NV:()=>d,_:()=>i,ev:()=>u,j5:()=>l,rm:()=>s});var r=()=>n(645873);const o={FullPageAI:new(r().O2)("FullPageAI",(()=>Promise.all([n.e(75134),n.e(43380),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(85515),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(95699)]).then(n.bind(n,130145)))),AIModePicker:new(r().O2)("AIModePicker",(()=>n.e(82926).then(n.bind(n,546716)))),AgentModelPicker:new(r().O2)("AgentModelPicker",(()=>n.e(8243).then(n.bind(n,843970)))),AIChatInput:new(r().O2)("AIChatInput",(()=>Promise.all([n.e(75134),n.e(43380),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(85515),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(16716),n.e(67333)]).then(n.bind(n,397693)))),AIChatView:new(r().O2)("AIChatView",(()=>Promise.all([n.e(75134),n.e(43380),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(85515),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(31611),n.e(91078),n.e(47108)]).then(n.bind(n,475685)))),AgentChatView:new(r().O2)("AgentChatView",(()=>Promise.all([n.e(75134),n.e(43380),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(85515),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(31611),n.e(91078),n.e(46283)]).then(n.bind(n,126382)))),AgentChatInput:new(r().O2)("AgentChatInput",(()=>Promise.all([n.e(75134),n.e(43380),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(85515),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(16716),n.e(90068)]).then(n.bind(n,333470))))},a=(0,r()._h)(o.FullPageAI,(e=>e.FullPageAI)),i=(0,r()._h)(o.AIModePicker,(e=>e.AIModePicker)),s=(0,r()._h)(o.AgentModelPicker,(e=>e.AgentModelPicker)),l=(0,r()._h)(o.AIChatInput,(e=>e.AIChatInput)),c=(0,r()._h)(o.AIChatView,(e=>e.AIChatView)),d=(0,r()._h)(o.AgentChatView,(e=>e.AgentChatView)),u=(0,r()._h)(o.AgentChatInput,(e=>e.AgentChatInput))},354936:(e,t,n)=>{n.d(t,{Y:()=>S});n(581454),n(296540);var r=()=>n(484714),o=()=>n(847249),a=()=>n(401497),i=()=>n(284371),s=()=>n(704152),l=()=>n(493823),c=()=>n(760217),d=()=>n(406699),u=()=>n(928600),p=()=>n(939740),m=()=>n(89924),f=()=>n(859428),h=()=>n(722872),y=()=>n(553965),g=()=>n(962730),v=()=>n(88291),b=n(474848);function S(e){const t=e.model,n=(0,r().v3)(),S=(0,a().IS)((e=>({badge:{fontSize:12,fontWeight:500,padding:"1px 6px",backgroundColor:e.cardHoveredBackground,color:e.text.tertiary,borderRadius:4,...i().RC}})),[]),_=(0,o().K8)((()=>v().$.getData(n,{})||[]),[n]),k=e.model?x[e.model]||e.model:"Default model";return(0,b.jsx)(d().Ay,{popupType:d().z7.Popup,placementToOrigin:d().sx.Bottom,alignmentToOrigin:d().yP.Start,renderOrigin:t=>(0,b.jsx)(f().A,{renderTooltip:()=>(0,b.jsx)("div",{children:"Select a model"}),placement:g().W.Bottom,alignment:g().C.Center,render:n=>"button"===e.format?(0,b.jsx)(l().p,{...(0,y().A)(t,n),children:k}):(0,b.jsx)(s().A,{...(0,y().A)(t,n),ignoreLocalHoverState:!0,children:(0,b.jsx)("div",{style:S.badge,children:k})})}),render:n=>(0,b.jsx)(u().A,{menuType:h().gu.Popup,children:(0,b.jsx)(p().Ay,{type:p().Oh.Vertical,initialFocus:0,sections:[{key:"models",render:e=>(0,b.jsx)(m().A,{...e,title:"Models",shouldShowBottomDivider:!0}),items:_.map((r=>({key:r,action:()=>{e.setModel(r),n.close()},render:e=>(0,b.jsx)(c().A,{...e,title:x[r]||r,isChecked:r===t})})))}]})})})}const x={default:"Default model","openai-gpt-4o":"OpenAI GPT-4o","openai-chatgpt-4o-latest":"OpenAI ChatGPT-4o-latest","openai-gpt-4o-mini":"OpenAI GPT-4o-mini","openai-o1":"OpenAI o1","openai-o1-mini":"OpenAI o1-mini","openai-o3-mini":"OpenAI o3-mini","openai-o3":"OpenAI o3","openai-o4-mini":"OpenAI o4-mini","openai-gpt-4.1":"OpenAI GPT-4.1","openai-gpt-4.1-mini":"OpenAI GPT-4.1-mini","openai-gpt-4.1-nano":"OpenAI GPT-4.1-nano","anthropic-haiku":"Anthropic Haiku","anthropic-sonnet-3.5":"Anthropic Sonnet 3.5","anthropic-sonnet-3.7":"Anthropic Sonnet 3.7","anthropic-opus":"Anthropic Opus","vertex-gemini-1.5-pro":"Vertex Gemini 1.5 Pro","vertex-gemini-1.5-flash":"Vertex Gemini 1.5 Flash","vertex-gemini-2.0-flash":"Vertex Gemini 2.0 Flash","vertex-gemini-2.5-pro":"Vertex Gemini 2.5 Pro","vertex-gemini-2.5-flash":"Vertex Gemini 2.5 Flash","groq-gemma2-9b-it":"Groq Gemma2 9b It","groq-gemma-7b-it":"Groq Gemma 7b It","groq-llama-70b":"Groq Llama 70b","groq-llama-8b":"Groq Llama 8b","groq-mixtral":"Groq Mixtral","fireworks-llama3.1-405b":"Llama 3.1 405b","fireworks-llama3.1-70b":"Llama 3.1 70b","fireworks-llama3.3-70b":"Llama 3.3 70b","fireworks-llama3.3-70b-dedicated":"Llama 3.3 70b Dedicated","fireworks-llama3.1-8b":"Llama 3.1 8b","fireworks-llama3-70b":"Llama 3.70b","fireworks-mixtral-22b":"Mixtral 22b","fireworks-mixtral-7b":"Mixtral 7b","fireworks-ft-router-101":"FT Router 101","fireworks-ft-router-102":"FT Router 102","fireworks-deepseek-v3":"DeepSeek V3","fireworks-deepseek-r1":"DeepSeek R1","fireworks-llama-8b-finetune-incl-translated-thumbsupdown-v07--judge-0-9-p50":"Llama 8b Finetune V07 P50","fireworks-llama-8b-finetune-incl-translated-thumbsupdown-v07--judge-0-9-p20":"Llama 8b Finetune V07 P20","cerebras-llama3.1-8b":"Cerebras Llama 3.1 8b","cerebras-llama3.3-70b":"Cerebras Llama 3.3 70b","cerebras-deepseek-r1-distill-llama-70b":"Cerebras DeepSeek R1 Distill Llama 70b","bedrock-nova-pro":"Bedrock Nova Pro","bedrock-nova-lite":"Bedrock Nova Lite","bedrock-nova-micro":"Bedrock Nova Micro"}},390527:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>j,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>k,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>_,MAX_RECURRENCE_INTERVAL:()=>g,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>v,RRULE_WEEKDAYS_MAP:()=>y,adjustedStartDateIfPossible:()=>C,areRecurrenceSchedulesEqual:()=>V,convertFromUnpersistedRecurrenceConfig:()=>R,convertToUnpersistedRecurrenceConfig:()=>D,getFormattedEndCondition:()=>P,getFormattedNextRecurrenceTime:()=>T,getNewEndTimestamp:()=>E,getNextDateUtc:()=>M,getRecurrenceAfter:()=>A,isRunningBetweenMidnightAnd3AM:()=>I,isValidRecurrenceInterval:()=>b,isValidRecurrenceNumberOfRuns:()=>S,rruleFromRecurrence:()=>x,templateAncestorsViolateRecurrenceNesting:()=>w});n(898992),n(354520),n(581454);var r=()=>n(244641);n(944114);function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(0===n.length)return e.map((e=>[e]));const a=[];for(const i of e)a.push(...o(n[0],...n.slice(1)).map((e=>[i,...e])));return a}var a=()=>n(496603),i=()=>n(534177),s=()=>n(720665),l=()=>n(597777),c=()=>n(869190),d=()=>n(416504),u=()=>n(402390);class p extends(()=>n(896346))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var m=()=>n(912720);const f=(0,n(959013).YK)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),h={day:p.DAILY,week:p.WEEKLY,month:p.MONTHLY,year:p.YEARLY},y={MO:p.MO,TU:p.TU,WE:p.WE,TH:p.TH,FR:p.FR,SA:p.SA,SU:p.SU},g=99,v=999;function b(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=g}function S(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=v}function x(e){const{start_date:t,frequency:n,interval:r,weekdays:a,timezone:s,hour:c,minute:d}=e,u="week"===n&&a?a.map((e=>y[e])):void 0,m={};return(0,i().O9)(e.end_condition)&&("date"===e.end_condition.type?m.until=(0,l().eU)(e.end_condition.end_at):"number"===e.end_condition.type?m.count=e.end_condition.number_of_occurrences:(0,i().HB)(e.end_condition)),"month"===e.frequency&&(0,i().O9)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?m.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?m.byweekday=o(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return y[t].nth(n)})):(0,i().HB)(e.monthly_restriction)),new p({freq:h[n],dtstart:(0,l().eU)(t),interval:r,byweekday:u,tzid:s,byhour:c??0,byminute:d??0,bysecond:0,...m})}const _=1,k=1;function w(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),r=e.length,o=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,a=r>_,i=n.length>=k;return{violatesConstraint:a||i,templateNestingExceedsMaxDepth:a,ancestorHasDailyTemplate:i,nestedDepthOfAutomationAncestors:r,immediateAncestorRecurrenceType:o}}function C(e){var t;const{recurrence:n,afterDate:o}=e;if("number"===(null===(t=n.end_condition)||void 0===t?void 0:t.type)||n.start_date>=o)return n;let a=r().c9.fromMillis(n.start_date,{zone:"utc"});const i=r().c9.fromMillis(o,{zone:"utc"});switch(n.frequency){case"year":{const e=Math.floor(i.diff(a,"years").years/n.interval);a=a.plus({years:e*n.interval});break}case"month":{const e=Math.floor(i.diff(a,"months").months/n.interval);a=a.plus({months:e*n.interval});break}case"week":{const e=Math.floor(i.diff(a,"weeks").weeks/n.interval);a=a.plus({weeks:e*n.interval});break}case"day":{const e=Math.floor(i.diff(a,"days").days/n.interval);a=a.plus({days:e*n.interval});break}}return{...n,start_date:(0,l().DH)(a.toMillis())}}function A(e){const{recurrence:t,afterDate:n}=e;if((0,m().wt)(t)){const e=(0,l().l1)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=x(C({recurrence:t,afterDate:n})).after((0,l().eU)(n));if(!e)return;return(0,l().h1)(e)}}function I(e){return 0===e.hour||1===e.hour||2===e.hour}function M(e){return x(e).after((0,l().eU)((0,l().Rz)()))||void 0}function T(e){const{recurrence:t,intl:n}=e,o=M(R(t));if(!o)return;const a=I(t),i=r().c9.fromJSDate(o).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,u().H)(n)).setZone(t.timezone),s=(0,c().Yq)({date:i,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(a)return n.formatMessage(f.dateBetweenMidnightAnd3AM,{date:s});{let e=i.toLocaleString(r().c9.TIME_SIMPLE);return t.timezone!==(0,d().P)()&&(e+=` ${i.toFormat("ZZZZ")}`),n.formatMessage(f.dateAtTime,{date:s,time:e})}}function P(e,t){return(0,i().O9)(e)?"number"===e.type?t.formatMessage(f.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,c().Yq)({date:r().c9.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,i().HB)(e):t.formatMessage(f.noEndCondition)}const j=100;function D(e){return{...e,start_date:(0,l().l1)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,l().l1)(e.end_condition.end_at)}:(0,i().HB)(e.end_condition):void 0}}function E(e,t,n){return e.plus(n-t)}function O(e,t){const n=r().c9.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,l().Rz)(n.toJSDate())}}function R(e){return{...e,start_date:(0,l().Rz)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?O(e,e.end_condition):(0,i().HB)(e.end_condition):void 0}}function V(e,t){const n=a().fN(e,(e=>void 0!==e)),r=a().fN(t,(e=>void 0!==e));return a().n4(n,r)}},410930:(e,t,n)=>{n.d(t,{z:()=>a});var r=()=>n(645873);const o={CollapsiblePanel:new(r().O2)("CollapsiblePanel",(()=>n.e(35905).then(n.bind(n,829298))))},a=(0,r()._h)(o.CollapsiblePanel,(e=>e.CollapsiblePanel))},422540:(e,t,n)=>{n.d(t,{$0:()=>y,Fx:()=>k,Ge:()=>m,I3:()=>u,Kj:()=>x,PP:()=>w,TK:()=>C,Yy:()=>d,aE:()=>A,cQ:()=>_,kH:()=>f,m7:()=>p,nq:()=>b,nv:()=>g,tj:()=>h});n(898992),n(354520),n(737550);var r=()=>n(496603),o=()=>n(534177),a=()=>n(970013),i=()=>n(651124),s=()=>n(349835),l=()=>n(390066);(0,o().u0)((e=>(0,o().O9)(e)&&(0,o().O9)(e.target)&&(0,o().O9)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target,custom_message:e.custom_message}}:{false:e}));const c={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1},d={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function u(e){return Boolean(c[e.type]&&!(0,a().UU)(e)&&(!(0,a().$M)(e)||void 0===(0,a().om)(e)))}function p(e){const{collectionFormat:t,collectionSchema:n,filter:s,sort:c,sourcePropertyIds:d}=e,p=(d??(0,o().uv)(n)).filter(((t,r,o)=>{const i=n[t];return!(!i||!u(i))&&(("relation"!==i.type||!e.restrictCrossSpace||!(0,a().o2)(e.spaceId,i))&&(!s||s([t,i],r,n)))}));if(0===p.length)return[];if(!t||!1===c)return p;const m=(0,l().L)(t,n,void 0,i().jf.Page).collection_page_properties||[];return r().Ul(p,(e=>m.findIndex((t=>t.property===e))))}function m(e){const{collectionFormat:t,collectionSchema:n,sort:s}=e,c=(0,o().uv)(n).filter(((e,t,r)=>{const o=n[e];return!(!o||!(0,a().JY)(o))}));if(0===c.length)return[];if(!t||!1===s)return c;const d=(0,l().L)(t,n,void 0,i().jf.Page).collection_page_properties||[];return r().Ul(c,(e=>d.findIndex((t=>t.property===e))))}function f(e){return e.type===s().M9.InvalidCharacter?{type:e.type,character:e.character}:e.type===s().M9.TokenExpected?{type:e.type,token:e.token}:e.type===s().uW.MissingSchemaPropertyOnThisRow||e.type===s().uW.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===s().uW.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===s().uW.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===s().uW.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===s().uW.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===s().uW.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===s().uW.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer,node:e.node}:e.type===s().uW.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===s().uW.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===s().uW.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===s().uW.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===s().uW.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===s().uW.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const h={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,geo_point:!1};function y(e){return Boolean(h[e.type])}function g(e){const{collectionFormat:t,collectionSchema:n,filter:s,sort:c}=e,d=(0,o().uv)(n).filter(((e,t,r)=>{var o;const i=n[e];return!(!i||!h[i.type])&&((!(0,a().$M)(i)||null===(o=(0,a().om)(i))||void 0===o||!o.auto_update_on_edit)&&(!s||s([e,i],t,n)))}));if(0===d.length)return[];if(!t||!1===c)return d;const u=(0,l().L)(t,n,void 0,i().jf.Page).collection_page_properties||[];return r().Ul(d,(e=>u.findIndex((t=>t.property===e))))}const v={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function b(e){return v[e.type]}const S={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function x(e){return S[e.type]}function _(e){return 0===e}function k(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function w(e){const{property:t,collectionSchema:n}=e;return!!n&&!n[t]}function C(e){const{collectionSchema:t,property:n,type:r}=e,o=null==t?void 0:t[n];return!o||("action"===r?!u(o):!h[o.type])}function A(e){let{automationTrigger:t,collectionSchema:n}=e;if("event"===(null==t?void 0:t.type)){const{pagesAdded:e,pagePropertiesEdited:r,source:a,relativeDate:i}=t.event;if(void 0===a)return!1;const s="some"===r.type&&r.some,l="all"===r.type&&r.all;if((s||l||[]).some((e=>w({collectionSchema:n,property:e.property})||C({collectionSchema:n,property:e.property,type:"trigger"}))))return!1;const c="some"===r.type&&(!(0,o().O9)(r.some)||0===r.some.length),d="all"===r.type&&(!(0,o().O9)(r.all)||0===r.all.length);if(!e&&("none"===r.type||c||d)&&!i)return!1}else{if("recurrence"!==(null==t?void 0:t.type))return!1;if(!t.recurrence)return!1}return!0}},459129:(e,t,n)=>{n.d(t,{Ou:()=>m,WB:()=>p,Wd:()=>f,wm:()=>h});n(16280),n(944114),n(581454);var r=()=>n(362750),o=()=>n(386164),a=()=>n(155792),i=()=>n(532659),s=()=>n(498212),l=()=>n(449506),c=()=>n(901389),d=()=>n(594794),u=()=>n(351360);function p(e){const{environment:t,feedbackType:n,userComment:r,spaceId:a,traceId:i,type:s,threadId:c,stepId:d}=e;l().callApi({eventName:"saveInferenceTranscriptFeedback",environment:t,data:{type:s,traceId:i,spaceId:a,feedbackType:n,userComment:r,threadId:c,stepId:d},headers:(0,o().WS)({spaceId:a})})}async function m(e){const{environment:t,clientStore:n,inference:p,threadId:m}=e,f=n.getClientAIChatThreadStore(m),h=f.state.inferenceKeysToAnnotations[p.key],y=n.state.model,g=u().default.state.currentSpaceStore;if(!g)throw new Error("No current space store");if(!y)return void c().rG({message:"No model selected"});const v=await l().callStreamApi({eventName:"runInferenceTranscript",environment:t,data:{transcript:[{id:(0,d().Z1)({environment:t,table:a().mS,spaceId:g.id}),type:"config",value:{type:"debug-inference",inference:{...p.value,input:{...p.value.input,...h?{annotation:h}:void 0}},model:y}}],traceId:(0,s().Ay)(),spaceId:g.id,generateTitle:!1},headers:(0,o().WS)({spaceId:g.id})});if("failed"===v.type)throw v.error;const b=[];if(i().hS.is(v.data))for await(const o of v.data)if("debug-inference"===o.type)b.push(o.value),f.setState({...f.state,inferences:f.state.inferences.map((e=>e.key===p.key?{...e,value:{...e.value,expected:(0,r().Zl)(b)}}:e))});else if("error"===o.type)throw o.message}async function f(e){const{environment:t,request:n,memory:r,onChange:p,clientStore:m}=e,f=m.state.model,h=u().default.state.currentSpaceStore;if(!h)throw new Error("No current space store");if(!f)return void c().rG({message:"No model selected"});if(!r.feedback)return void c().rG({message:"No feedback found"});const y=await l().callStreamApi({eventName:"runInferenceTranscript",environment:t,data:{transcript:[{id:(0,d().Z1)({environment:t,table:a().mS,spaceId:h.id}),type:"config",value:{type:"memory-agent",request:n,feedback:r.feedback,model:f}}],traceId:(0,s().Ay)(),spaceId:h.id,generateTitle:!1},headers:(0,o().WS)({spaceId:h.id})});if("failed"!==y.type){if(i().hS.is(y.data))for await(const o of y.data)"memory-agent"===o.type?p(o.value):"error"===o.type&&c().rG({message:o.message})}else c().Qg(y)}async function h(e){const{environment:t,inference:n,project:r,dataset:o}=e;await l().callApi({eventName:"insertIntoBraintrustDataset",environment:t,data:{project:r,dataset:o,value:n}}),c().rG({message:`Saved to project: ${r}, dataset: ${o}`})}},465364:(e,t,n)=>{n.d(t,{$N:()=>T,D5:()=>P,GB:()=>A,M9:()=>w,Pt:()=>M,eW:()=>I,jo:()=>j,v7:()=>C});n(944114),n(898992),n(803949),n(581454);var r=()=>n(244641),o=()=>n(787626),a=()=>n(713998),i=()=>n(597777),s=()=>n(604995),l=()=>n(416504),c=()=>n(519831),d=()=>n(496603),u=()=>n(534177),p=()=>n(299709),m=()=>n(317001),f=()=>n(520861),h=()=>n(878060),y=()=>n(44729),g=()=>n(246826),v=()=>n(319975),b=()=>n(519839),S=()=>n(695625),x=()=>n(397248),_=()=>n(630116),k=()=>n(747671);function w(e){const{environment:t,droppedStores:n,duplicate:a,calendarBy:d,transaction:u,collectionContextStore:h,duplicateActions:g}=e,v=r().c9.fromMillis(e.startOfDay);let S=!0;for(const r of n){const t=e.collectionStore?e.collectionStore:(0,b().Dj)({store:r,collectionContextStore:h});if(r.getParentTable()===c().Vl||!t){S=!1;break}y().X$({childStore:r,parentStore:t,transaction:u})||(S=!1)}const x=(0,f().T)({environment:t,droppedStores:n,duplicate:a,transaction:u,collectionStore:e.collectionStore,duplicateActions:g});for(const r of x){const n=e.collectionStore?e.collectionStore:(0,b().Dj)({store:r,collectionContextStore:h});if(!n)continue;const a=n.getMappedProperty(d),c=r.getPropertyStore(a),f=(0,o().b)(c.getValue())||s().Ec((0,l().P)()),y=s().kW(f,(0,l().P)()),g=v.toFormat(s().tr);let x;if("date"===y.type||"datetime"===y.type)x={...y,start_date:g};else{const e=s().AA(y,(0,l().P)());if(!e.end)return;const t={...y,start_date:g},n=s().AA(t,(0,l().P)()).start.diff(e.start,"days"),r=e.end.plus(n).toFormat(s().tr);x={...y,start_date:g,end_date:r}}const _=s().kW(x,i().$K(f)||(0,l().P)());(0,m().j)({environment:t,store:r,collectionStore:n,collectionContextStore:h,shouldCoerce:!0,groupsPointer:[],transaction:u,alreadyMovedToCollection:S}),P({environment:t,type:"dateValue",propertyId:a,store:r,transaction:u,dateValue:_}),(0,p().E)({environment:t,collectionContextStore:h,block_id:r.id,property:a,property_type:"date",from:"calendar"})}}function C(e){const{calendarStore:t,direction:n,targetStore:r}=e;t.setState({...t.state,isDragging:!0,targetStore:r,direction:n,temporaryValue:void 0})}function A(e){const{calendarStore:t,x:n,y:a,calendarBy:c}=e,u=t.state;if(u.isDragging){const e=(0,o().b)(u.targetStore.getPropertyStore(c).getValue());if(!e)return;const p=s().kW(e,(0,l().P)()),m=u.temporaryValue||e,f=s().kW(m,(0,l().P)()),h=[];u.dayStoreMap.forEach(((e,t)=>{h.push({store:e,timestamp:t})}));const y=h.find((e=>{let{store:t}=e;const r=S().T.getRectFromStore(t);return Boolean(r&&x().ux(r,n,a))}));let g;if(y){const e=r().c9.fromMillis(y.timestamp),t=e.endOf("day"),n=e.toFormat(s().tr);if(p){const o=s().AA(p,(0,l().P)());if(u.direction===k().Q.Left)if(r().IX.fromDateTimes(e,t).contains(o.start))g=p;else{let e;e="datetimerange"===p.type||"daterange"===p.type?{...p,start_date:n,end_date:p.end_date}:"datetime"===p.type?{type:"datetimerange",start_date:n,start_time:p.start_time,end_date:p.start_date,end_time:p.start_time,time_zone:p.time_zone,reminder:p.reminder}:{type:"daterange",start_date:n,end_date:p.start_date,reminder:p.reminder};const t=s().AA(e,(0,l().P)());g=!o.end&&t.start>o.start||o.end&&t.start>o.end?f:e}else if(o.end?r().IX.fromDateTimes(e,t).contains(o.end):r().IX.fromDateTimes(e,t).contains(o.start))g=p;else{let e;e="date"===p.type?{...p,type:"daterange",end_date:n}:"datetime"===p.type?{...p,type:"datetimerange",end_date:n,end_time:"00:00"}:{...p,end_date:n};const t=s().AA(e,(0,l().P)());g=t.end&&t.end<t.start?f:e}}}if(g&&!d().n4(f,g)){const e=s().kW(g,i().$K(m)||(0,l().P)());t.setState({...u,temporaryValue:e})}}}function I(e){const{environment:t,calendarStore:n,calendarBy:r,transaction:o}=e,a=n.state;a.isDragging&&a.temporaryValue&&(P({type:"dateValue",environment:t,dateValue:a.temporaryValue,propertyId:r,store:a.targetStore,transaction:o}),n.setState({...n.state,isDragging:!1}))}function M(e){const{calendarStore:t}=e,n=t.state;n.isDragging&&t.setState({...n,isDragging:!1})}function T(e){const{environment:t,store:n,collectionStore:o,collectionContextStore:i,startDayOfWeek:c,transaction:d}=e,u=i.dateRangeStartStore.state,p=(0,l().P)(),f=i.normalizedQueryStore.state;if(!f||!f.calendar_by)return;const h=(null==o?void 0:o.getMappedProperty(f.calendar_by))??f.calendar_by,y=s().hp(u,c,p),v=y.startOf("month"),b=y.endOf("month"),S=r().c9.now().startOf("day");let x;return x=r().IX.fromDateTimes(v,b).contains(S)?s().p6(S.valueOf(),p):s().p6(s().iB(u,c,p).valueOf(),p),g().zv({store:n.getPropertiesStore(),data:{[h]:a().m5(x)},transaction:d}),(0,m().j)({environment:t,store:n,collectionStore:o,collectionContextStore:i,shouldCoerce:!0,groupsPointer:[],transaction:d}),n}function P(e){const{environment:t,store:n,propertyId:r,transaction:o}=e;let i;"timestamp"===e.type?i=s().p6(e.timestampMs.valueOf(),(0,l().P)()):"dateValue"===e.type?i=e.dateValue:(0,u().HB)(e);const c=n.getPropertyValue(r),d=a().m5(i);g().zv({store:n.getPropertiesStore(),data:{[r]:d},transaction:o}),h().O({environment:t,store:n,dateProperty:{id:r,oldValue:c,newValue:d}})}function j(e){const{environment:t,collectionStore:n,calendarBy:r,store:o,insertStores:a,collectionContextStore:i,transaction:s}=e,l=o.getPropertyStore(r).getValue();for(const c of a)(0,m().j)({environment:t,store:c,collectionStore:n,collectionContextStore:i,shouldCoerce:!0,groupsPointer:[],transaction:s}),v().R9({environment:t,store:c.getPropertyStore(r),value:l,transaction:s});return a.map((e=>_().Bv.createChildStore(n,e.pointer)))}},520861:(e,t,n)=>{n.d(t,{T:()=>o});n(944114),n(898992),n(908872);var r=()=>n(415651);function o(e){const{environment:t,collectionStore:n,duplicate:o,droppedStores:a,transaction:i,duplicateActions:s}=e,{movedStores:l,reparentedStores:c}=a.reduce(((e,t)=>(o||t.getAssociatedCollectionId()!==(null==n?void 0:n.id)?e.reparentedStores.push(t):e.movedStores.push(t),e)),{movedStores:[],reparentedStores:[]});return[...l,...r().MS({environment:t,droppedStores:c,duplicate:o,transaction:i,resolveTemplateVariables:!1,duplicateActions:s})]}},546461:(e,t,n)=>{n.d(t,{EC:()=>_,To:()=>x,YC:()=>k,or:()=>S,u:()=>b});n(16280);var r=n(296540),o=()=>n(484714),a=()=>n(847249),i=()=>n(496506),s=()=>n(322867),l=()=>n(959013),c=()=>n(534177),d=()=>n(813297),u=()=>n(862292),p=()=>n(698331),m=()=>n(645873),f=()=>n(190019),h=()=>n(76190),y=n(474848);const g=new WeakMap,v=(0,r.createContext)({automationStore:void 0,contextType:void 0,defined:!1,typecheckResult:void 0});v.displayName="AutomationContext";function b(e){const{automationStore:t,children:n,contextType:r}=e,b=(0,o().v3)(),S=(0,l().tz)(),{value:x}=(0,m().fJ)(u().T.formulas),{value:_}=(0,m().fJ)(d().QV.automationTypecheck),k=(0,h().n)(t),w=(0,a().K8)((()=>{if(!x)return{error:new(s().N9)("Missing formulas dependency")};if(!_)return{error:new(s().N9)("Missing automation dependency")};const e=function(e){const{environment:t,automationStore:n,automationTypecheckModule:r,contextType:o,formulasModule:a,intl:s,isSubscribed:l}=e,d=g.get(n);if(d)return d;{const e=new(i().default)((()=>{const e=n.getTriggerType();let i=o;return(0,c().O9)(e)&&(0,p().x2)(e)&&(i=(0,p().H8)(e)),(0,f().Z)({environment:t,automationStore:n,automationTypecheckModule:r,contextType:i,formulasModule:a,intl:s,isSubscribed:l})}),{debugName:"automationContextTypecheckResultCachedStore"});return g.set(n,e),e}}({environment:b,automationStore:t,automationTypecheckModule:_,contextType:r,formulasModule:x,intl:S,isSubscribed:k});return e.state}),[b,t,_,r,x,S,k]);return(0,y.jsx)(v.Provider,{value:{automationStore:t,typecheckResult:w,contextType:r,defined:!0},children:n})}function S(e){const{automationStore:t,children:n}=e,r=(0,a().K8)((()=>{var e;return null===(e=t.getTrigger())||void 0===e?void 0:e.type}),[t]);return(0,y.jsx)(b,{automationStore:t,contextType:(0,p().H8)(r??"event"),children:n})}function x(e){var t;return null===(t=g.get(e))||void 0===t?void 0:t.state}function _(){const e=r.useContext(v);if(!1===e.defined)throw new Error("No automation context found!");return e}function k(){return r.useContext(v)}},562936:(e,t,n)=>{n.d(t,{b:()=>l});var r=n(296540),o=()=>n(401497),a=()=>n(803960),i=()=>n(920773),s=n(474848);function l(e){var t;const[n,l]=r.useState(e.defaultOpen??!1),c=(0,o().IS)((t=>({wrap:{cursor:"pointer",...e.style},header:{display:"flex",alignItems:"center",gap:8,...!1===e.isToggleEnabled?{whiteSpace:"nowrap",height:28,paddingLeft:8,paddingRight:8}:{},...e.headerStyle},text:{minWidth:0,flexShrink:1,overflow:"hidden",textOverflow:"ellipsis"},content:{cursor:"auto",marginTop:12},icon:{width:16,height:16,fill:t.regularIconColor},chevronDownIcon:{width:16,height:16,fill:t.mediumIconColor,transition:"transform 0.2s ease-in-out",transformOrigin:"center",transform:n?"rotate(0deg)":"rotate(-90deg)"}})),[e.style,e.headerStyle,n,e.isToggleEnabled]),d=(0,r.useCallback)((()=>l(!n)),[n]),u=(0,s.jsxs)(s.Fragment,{children:[e.left,null===(t=e.icon)||void 0===t?void 0:t.call(e,{...c.icon,...e.iconStyle}),(0,s.jsx)("span",{style:c.text,children:e.label}),(0,s.jsx)("div",{style:{flexGrow:1}}),e.right]});return!1===e.isToggleEnabled?(0,s.jsx)("div",{style:e.style,children:(0,s.jsx)("div",{style:c.header,children:u})}):(0,s.jsxs)("div",{style:c.wrap,children:[(0,s.jsxs)(i().p,{onClick:d,style:c.header,children:[u,(0,a().arrowChevronSingleDownIcon)(c.chevronDownIcon)]}),n&&(0,s.jsx)("div",{style:c.content,children:e.children})]})}},577466:(e,t,n)=>{n.d(t,{B:()=>a});var r=()=>n(401497),o=()=>n(100622);function a(e){return(0,r().IS)((t=>({wrapper:{background:e?(0,o().qh)(e,t).color:t.surface.wash,borderRadius:5,padding:"8px 12px",userSelect:"none",width:"100%"}})),[e])}},650843:(e,t,n)=>{n.r(t),n.d(t,{LargeSurfaceRenderError:()=>s});n(296540);var r=()=>n(167355),o=()=>n(840071),a=()=>n(113414),i=n(474848);function s(e){return(0,i.jsx)(o().L,{...e,iconGroup:r().F,children:(0,i.jsx)(a().g,{})})}},698331:(e,t,n)=>{n.d(t,{$X:()=>a,H8:()=>i,x2:()=>o});var r=()=>n(534177);function o(e){return"event"===e||"recurrence"===e}function a(e){const t=e.getTrigger();return(0,r().O9)(t)&&o(t.type)}function i(e){return"event"===e?"event":"recurrence"===e?"recurrence":void(0,r().HB)(e)}},725649:(e,t,n)=>{function r(e){return!(!e||"askUserToPick"in e)}function o(e){if(!e||!("askUserToPick"in e))return e}function a(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}n.d(t,{DK:()=>o,K$:()=>r,j6:()=>a})},747671:(e,t,n)=>{n.d(t,{Q:()=>r,a:()=>o});let r=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class o extends(()=>n(757695))().default{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}}},803960:(e,t,n)=>{n.r(t),n.d(t,{arrowChevronSingleDownIcon:()=>o,iconDefinition:()=>r});n(296540);const r={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"M9.558 13.442c.244.244.64.244.884 0l5.4-5.4a.625.625 0 1 0-.884-.884L10 12.116 5.042 7.158a.625.625 0 0 0-.884.884z"})},o=(0,n(340498).wt)("arrowChevronSingleDown",r)},840071:(e,t,n)=>{n.d(t,{L:()=>s});n(296540);var r=()=>n(84817),o=()=>n(577466),a=()=>n(434663),i=n(474848);function s(e){let{backgroundColor:t,children:n,...s}=e;const l=(0,o().B)(t),c={wrapper:{...l.wrapper,background:t?l.wrapper.background:"initial",height:"100%",padding:"20px 12px"}};return(0,i.jsx)(r().Y1,{style:c.wrapper,align:"center",children:(0,i.jsx)(a().r,{...s,direction:"vertical",overrideSize:()=>48,children:n})})}},942646:(e,t,n)=>{n.r(t),n.d(t,{ChatSidebar:()=>j});var r=n(296540),o=()=>n(484714),a=()=>n(847249),i=()=>n(401497),s=()=>n(591779),l=()=>n(72307),c=()=>n(277942),d=()=>n(201647),u=()=>n(166442),p=()=>n(410930),m=()=>n(84817),f=()=>n(297872),h=()=>n(581495),y=()=>n(112995),g=()=>n(650843),v=()=>n(58293),b=()=>n(346),S=()=>n(567121),x=()=>n(644914),_=()=>n(351360),k=()=>n(691093),w=()=>n(790068),C=()=>n(46986),A=()=>n(564037),I=()=>n(118078),M=()=>n(890754),T=()=>n(590027),P=n(474848);function j(){const e=(0,M().useChatSidebarState)(),t=(0,b().n_)(),{isFullWidthMode:n}=(0,a().O$)(T().M),r=(0,i().IS)((e=>({container:{order:l().A.appCursorListener.secondarySidebar,cursor:"default",zIndex:1e3,height:t?`calc(100% - ${S().ls}px)`:"100%",position:"fixed",right:0,top:0,display:"flex",flexDirection:"row",justifyContent:"flex-end"}})),[t]);return(0,a().K8)((()=>(0,C().sx)()),[])&&e?(0,P.jsx)(f().A,{debugName:"ChatSidebar",capture:(null==e?void 0:e.isOpen)??!1,allowEsc:!0,allowOpenLinkMenu:!0,allowSearch:!0,render:()=>(0,P.jsxs)("div",{style:r.container,children:[n?null:(0,P.jsx)(O,{chatSidebarState:e}),(0,P.jsx)(D,{chatSidebarState:e})]})}):null}function D(e){const{chatSidebarState:t}=e,n=(0,s().ZC)(t),l=t??n,{isFullWidthMode:c}=(0,a().O$)(T().M),d=(0,a().K8)((()=>T().B.getState()??400),[]),u=(0,i().IS)((e=>({chatPanelContent:{position:"relative",height:"100%",width:"100%",background:e.surface.wash},content:{position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",flexDirection:"column",overflow:"visible"}})),[]),f=(0,o().v3)(),v=(0,a().K8)((()=>{const e=(0,x().km)(f);return f.WindowSizeStore.state.width-e}),[f]),b=(0,r.useCallback)((()=>{(0,A().getIsWorkflowEditorOpen)(f)?(0,k().closeWorkflowEditor)({environment:f}):(0,I().closeChatSidebar)({environment:f})}),[f]);return(0,P.jsx)(p().z,{isOpen:t.isOpen,isResizable:!c,width:{size:c?v:d,speed:"animate"},anchorToSide:"right",minSize:c?v:300,maxSize:c?v:700,onWidthChange:e=>{c||(T().M.setState({...T().M.state}),T().B.setState(e.size))},children:(0,P.jsx)(y().K,{from:"ChatSidebar",fallback:e=>{let{error:t,errorId:n}=e;return(0,P.jsx)(g().LargeSurfaceRenderError,{error:t,errorId:n})},children:(0,P.jsx)(h().eh.Provider,{value:b,children:(0,P.jsx)("div",{className:"chatPanelContent",style:u.chatPanelContent,children:(0,P.jsx)("div",{className:"content",style:u.content,children:(0,P.jsx)(m().Y1,{direction:"vertical",height:"fill",width:"fill",children:(0,P.jsx)(E,{chatSidebarState:l})})})})})})})}function E(e){const{chatSidebarState:t}=e,n=(0,o().v3)(),i=(0,v().r)(),s=(0,a().K8)((()=>T().M.state.isFullWidthMode),[]),l=(0,a().K8)((()=>{if(i&&t)return(0,M().getCurrentThreadStore)({spaceStore:i,chatSidebarState:t})}),[i,t]),d=(0,a().K8)((()=>(0,w().K)({store:_().default.state.mainEditorCurrentBlockStore})),[]),p=(0,r.useCallback)((e=>{const t=_().default.state.mainEditorCurrentBlockStore;t&&(0,I().showChatSidebar)({environment:n,store:t,chatSidebarState:e?{isOpen:!0,threadId:e.id}:{isOpen:!0,isNewThread:!0}})}),[n]);return i?(0,P.jsx)(c().NV,{aiChatFeature:s?"workflows_full_page":"workflows",threadStore:l,clientStore:u().Kd,onThreadChange:p,parentStore:i,config:d}):null}function O(e){const{chatSidebarState:t}=e,{debugSidebarWidth:n}=(0,a().O$)(T().M),o=(0,a().K8)((()=>u().Kd.state.showDebug),[]);(0,r.useEffect)((()=>{T().M.setState({...T().M.state,isDebugSidebarOpen:o})}),[o]);const s=(0,v().r)(),l=(0,a().K8)((()=>{if(s&&t)return(0,M().getCurrentThreadStore)({spaceStore:s,chatSidebarState:t})}),[s,t]),c=(0,i().IS)((e=>({debugPanelContent:{position:"relative",height:"100%",width:"100%",background:e.contentBackground},content:{position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",flexDirection:"column",overflow:"visible"}})),[]);return(0,P.jsx)(p().z,{isOpen:t.isOpen&&o,isResizable:!0,width:{size:n,speed:"animate"},anchorToSide:"right",minSize:300,maxSize:700,onWidthChange:e=>{T().M.setState({...T().M.state,debugSidebarWidth:e.size})},children:(0,P.jsx)("div",{style:c.debugPanelContent,children:(0,P.jsx)("div",{style:c.content,children:(0,P.jsx)(d().m,{clientStore:u().Kd,threadStore:l})})})})}},981928:(e,t,n)=>{n.d(t,{X:()=>k,O:()=>_});n(16280);var r=n(296540),o=()=>n(484714),a=()=>n(401497),i=()=>n(959013),s=()=>n(901389),l=()=>n(725614),c=()=>n(493823),d=()=>n(297872),u=()=>n(623580),p=()=>n(354584),m=()=>n(645873),f=()=>n(963589),h=()=>n(591779),y=()=>n(187174);const g={SimpleMonacoWrapper:new(m().O2)("SimpleMonacoWrapper",(async()=>{const[e,t,r]=await Promise.all([n.e(89440).then(n.bind(n,201452)).then((e=>e.default)),n.e(98814).then(n.bind(n,668553)).then((e=>e.loader)),n.e(62989).then(n.bind(n,374353))]);return t.config({monaco:e}),r}))},v=(0,m()._h)(g.SimpleMonacoWrapper,(e=>e.SimpleMonacoWrapper));var b=n(474848);function S(e){const{value:t,onSave:n,disabled:o,language:l="typescript",onFocus:d,onBlur:u,onChange:p,fetchTypescriptImports:m,fillHeight:f}=e,g=(0,r.useRef)(null),[S,x]=r.useState(t),_=(0,h().ZC)(t);r.useEffect((()=>{var e;_===S&&t!==_&&(x(t),null===(e=g.current)||void 0===e||e.setValue(t))}),[S,_,t]);const k=(0,r.useCallback)((()=>{if(S!==t)try{null==n||n(S)}catch(e){console.error(e),e instanceof Error&&s().rG({message:e.message})}}),[n,S,t]),w=(0,r.useCallback)((()=>{var e;x(t),null===(e=g.current)||void 0===e||e.setValue(t)}),[t]),C=(0,r.useCallback)((e=>{x(e??""),null==p||p(e??"")}),[p]),A=(0,r.useCallback)((e=>{g.current=e}),[]),[I,M]=r.useState(void 0);(0,y().Yb)((async()=>{if(m){const e=await m();M(e)}}),[m]);const T=(0,a().IS)((e=>({container:{position:"relative",borderRadius:f?0:8,overflow:"hidden",height:f?"100%":"50vh",display:"flex",flexDirection:"column",minHeight:400},controls:{position:"absolute",top:8,right:12,display:"flex",gap:8,zIndex:1}})),[f]);return(0,b.jsxs)("div",{style:T.container,children:[t!==S&&(0,b.jsxs)("div",{style:T.controls,children:[(0,b.jsx)(c().p,{onClick:w,children:(0,b.jsx)(i().sA,{defaultMessage:"Discard",id:"workflow.monacoCodeBlock.discard"})}),(0,b.jsx)(c().p,{onClick:k,children:(0,b.jsx)(i().sA,{defaultMessage:"Save changes",id:"workflow.monacoCodeBlock.save"})})]}),(0,b.jsx)(v,{language:l,value:S,disabled:o,onChange:C,onMount:A,onFocus:d,onBlur:u,imports:I})]})}function x(e){const{value:t,onSave:n,disabled:o,onFocus:l,onBlur:d}=e,[p,m]=r.useState(!1),[f,h]=r.useState(void 0),y=(0,a().IS)((e=>({container:{position:"relative",background:e.codeBlockBackground,padding:16,borderRadius:12},input:{whiteSpace:"pre-wrap",wordWrap:"break-word",fontFamily:"monospace",color:e.text.primary,margin:0,marginBottom:12,fontSize:12},controls:{position:"absolute",top:8,right:8,display:"flex",gap:8,zIndex:1}})),[]),g=(0,r.useCallback)((e=>{h(e.target.value)}),[]),v=(0,r.useCallback)((()=>{if(void 0!==f)try{null==n||n(f),h(void 0),m(!1)}catch(e){console.error(e),e instanceof Error&&s().rG({message:e.message})}}),[n,f]),S=(0,r.useCallback)((()=>{h(void 0),m(!1)}),[]),x=(0,r.useCallback)((()=>{m(!0),h(t)}),[t]);return o?(0,b.jsx)(_,{...e}):(0,b.jsxs)("div",{style:y.container,children:[(0,b.jsx)("div",{style:y.controls,children:p?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c().p,{onClick:S,children:(0,b.jsx)(i().sA,{defaultMessage:"Discard",id:"workflow.codeBlock.discard"})}),(0,b.jsx)(c().p,{onClick:v,children:(0,b.jsx)(i().sA,{defaultMessage:"Save",id:"workflow.codeBlock.save"})})]}):(0,b.jsx)(c().p,{onClick:x,children:(0,b.jsx)(i().sA,{defaultMessage:"Edit",id:"workflow.codeBlock.edit"})})}),p?(0,b.jsx)(u().A,{value:void 0!==f?f:t,onChange:g,textarea:!0,style:y.input,autosize:!0,autosizeMinHeight:80,onFocus:l,onBlur:d}):(0,b.jsx)(_,{...e})]})}function _(e){const{value:t,language:n="typescript",styles:o}=e,{value:i}=(0,m().fJ)(p().y),s=(0,a().IS)((e=>({codeDisplay:{whiteSpace:"pre-wrap",wordWrap:"break-word",fontFamily:"monospace",margin:0,fontSize:12,"& code":{fontFamily:"inherit",fontSize:"inherit",padding:0,background:"none"}}})),[]),l=r.useMemo((()=>{if(!i)return t;return i.highlight(t,i.languages[n]||i.languages.javascript,n)}),[i,t,n]);return(0,b.jsx)("div",{style:{...s.codeDisplay,...o},dangerouslySetInnerHTML:{__html:l}})}function k(e){const t=(0,o().v3)(),[n,a]=(0,r.useState)(!1),i=(0,r.useCallback)((()=>{a(!0),l().clear({environment:t})}),[t]),s=(0,r.useCallback)((()=>{a(!1)}),[]),c=((0,f().X)("ai_workflows_monaco_code_editor"),!1);return(0,b.jsx)(d().A,{capture:n,debugName:"SimpleCodeBlock",render:()=>c?(0,b.jsx)(S,{...e,onFocus:i,onBlur:s}):(0,b.jsx)(x,{...e,onFocus:i,onBlur:s})})}}}]);