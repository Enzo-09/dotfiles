"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[7005],{44750:(e,t,o)=>{o.d(t,{Z:()=>_,p:()=>j});o(16280),o(581454),o(296540);var n=()=>o(484714),i=()=>o(847249),r=()=>o(401497),a=()=>o(663077),l=()=>o(970013),s=()=>o(534177),c=()=>o(686526),d=()=>o(751156),p=()=>o(736982),u=()=>o(403905),m=()=>o(989423),g=()=>o(972435),y=()=>o(317053),f=()=>o(101926),S=()=>o(513349),h=()=>o(922952),b=()=>o(913454),v=()=>o(204067),x=()=>o(272752),A=()=>o(362941),C=()=>o(960127),w=()=>o(342288),T=()=>o(902842),I=o(474848);function _(e){let{environment:t,template:o,isInSuggestedSection:n,collectionContextStore:i}=e;return{key:o.templateId,action:()=>{if(n)j({environment:t,template:o,collectionContextStore:i,suggestedFeatureAnalytics:void 0});else{const{collectionStore:e,collectionViewStore:n,collectionSettingsStore:r}=(0,x().i)(i);(0,S().UD)({template:o,environment:t,collectionStore:e,collectionViewStore:n,collectionSettingsStore:r,collectionContextStore:i})}},render:e=>(0,I.jsx)(k,{buttonMenuItemProps:e,template:o,isInSuggestedSection:n})}}function j(e){let{environment:t,collectionContextStore:o,template:n,suggestedFeatureAnalytics:i}=e;const r=o.collectionStore();if(!r)throw new Error("collectionStore not found");const l=r.getWorkflowTemplateId();i&&(0,m().u4)({environment:t,event:{eventName:"suggested_feature_template_clicked",eventProperties:{origin:i.origin,selected_index:i.selectedIndex,template_ids_shown:i.shownTemplateIds,template_id_clicked:n.templateId,collection_template_id:l}}});const s=o.settingsStore;if((0,C().isWorkflowTemplateWithConfirmStep)(n))c().a2({collectionSettingsStore:s,item:{type:"confirmAddTemplate",template:n}});else if((0,a().Sz)(n)){const{relatedCollectionTemplateId:e}=n;!function(e){var t;let{environment:o,template:n,collectionStore:i,relatedCollectionTemplateId:r}=e;const a=null===(t=i.getParentBlockStore())||void 0===t?void 0:t.getParentStore();if(!a)throw new Error(`parentStore not found for ${i.id}`);if(!(0,h().u)(a))throw new Error(`Incorrect parent store: ${a.table} ${a.id}`);const l=b().globalWorkflowTemplates.fromIdOfType({templateId:r,type:"collection"});(0,y().openSelectedTemplateOnboardingModalForInAppFlows)({environment:o,template:l,origin:"suggested_feature_template",parentStore:a,navigateToOnFinish:"skip",relationInfos:[{type:"source",collectionStore:i,relationPropertyTemplate:n}],aiPrompt:void 0})}({environment:t,template:n,collectionStore:r,relatedCollectionTemplateId:e})}else d().createAndCommit({userAction:"FeatureTemplateMenuItem.addFeatureTemplateToTarget",environment:t,canUndo:!0,perform:e=>{f().ai({environment:t,transaction:e,collectionStore:r,template:n,logger:new(b().WorkflowTemplateLogger),origin:"suggested_feature"}),i&&(0,m().u4)({environment:t,event:{eventName:"suggested_feature_template_added",eventProperties:{origin:i.origin,template_id_added:n.templateId,collection_template_id:l}}});const a=o.collectionViewStore();a&&S().UD({template:n,environment:t,collectionStore:r,collectionViewStore:a,collectionSettingsStore:s,collectionContextStore:o})}})}function k(e){let{buttonMenuItemProps:t,template:o,isInSuggestedSection:a}=e;const c=(0,r().IS)((e=>({iconContainer:{height:28,width:28,display:"flex",alignItems:"center",justifyContent:"center"},icon:{fill:e.regularIconColor}})),[]),{collectionStore:d}=(0,x().V)(),m=(0,n().v3)(),y=(0,i().K8)((()=>(0,v().NU)({environment:m,collectionStore:d,templateId:o.templateId})),[m,d,o.templateId]),f=(0,i().K8)((()=>function(e){let{template:t,collectionStore:o}=e;const{type:n}=t;switch(n){case"property":const{value:e}=t;if((0,l().DQ)(e)){const n=function(e){let{templateId:t,propertyTemplateSchema:o,collectionStore:n}=e;const i=(0,v().S1)({collectionStore:n,templateId:t,instancePointerType:"property"});if(!i)return o.options??[];const r=n.getSchema()[i.id];if(!r||!(0,l().DQ)(r))return[];return r.options??[]}({templateId:t.templateId,propertyTemplateSchema:e,collectionStore:o}).map((e=>e.value));return(0,b().getWorkflowTemplateItemsCaption)(n)}return;case"collection_view":return`${g().A.formatMessage(u().X[t.value.type])} view`;case"compound":return;default:(0,s().HB)(n)}}({template:o,collectionStore:d})),[o,d]),S=(0,b().getWorkflowTemplateName)(o);return a?(0,I.jsx)(p().I,{buttonMenuItemProps:t,title:S,icon:(0,I.jsx)(T().n,{template:o}),right:(0,I.jsx)(w().z,{isAdded:y})}):(0,I.jsx)(p().I,{buttonMenuItemProps:t,title:S,caption:f,icon:(0,I.jsx)("div",{style:c.iconContainer,children:(0,I.jsx)(T().z,{template:o,iconStyle:c.icon})}),right:(0,I.jsx)(A()._,{})})}},135986:(e,t,o)=>{o.d(t,{A$:()=>Me,DZ:()=>at,xl:()=>Qe,HJ:()=>He,L7:()=>De,Re:()=>Oe,bj:()=>Le,D1:()=>Ue,b9:()=>We,f1:()=>Ge,p1:()=>ze,Dm:()=>Ve,D9:()=>Re,ds:()=>Fe});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(823215),o(354520),o(672577),o(803949),o(581454),o(737550);var n=o(296540),i=()=>o(484714),r=()=>o(847249),a=()=>o(401497),l=()=>o(66689),s=()=>o(128914),c=()=>o(428045),d=()=>o(663077),p=()=>o(716016),u=()=>o(970013),m=()=>o(713998),g=()=>o(455348),y=()=>o(743176),f=()=>o(617871),S=()=>o(412237),h=()=>o(668725),b=()=>o(344417),v=()=>o(340498),x=()=>o(386164),A=()=>o(784438),C=()=>o(931075),w=()=>o(959013),T=()=>o(100622),I=()=>o(496603),_=()=>o(534177),j=()=>o(416726),k=()=>o(449506),P=()=>o(686526),M=()=>o(36629),B=()=>o(896628),D=()=>o(751156),F=()=>o(67103),R=()=>o(617254),O=()=>o(374562),K=()=>o(313892),E=()=>o(551882),N=()=>o(13898),z=()=>o(760217),H=()=>o(364280),V=()=>o(285790),U=()=>o(419357),W=()=>o(710149),L=()=>o(147294),G=()=>o(89924),q=()=>o(933117),$=()=>o(859428),Y=()=>o(125565),X=()=>o(175116),J=()=>o(989423),Q=()=>o(921855),Z=()=>o(682146),ee=()=>o(68465),te=()=>o(521488),oe=()=>o(148307),ne=()=>o(508496),ie=()=>o(53137),re=()=>o(252833);const ae=[f().ob,f().Hd,f().e1,f().io,f().k0,f().zG];var le=()=>o(898486),se=()=>o(972435),ce=()=>o(553965),de=()=>o(470928),pe=()=>o(817126),ue=()=>o(963589),me=()=>o(176983),ge=()=>o(255824),ye=()=>o(962730),fe=()=>o(351360),Se=()=>o(463830),he=()=>o(227440),be=()=>o(991249),ve=()=>o(112698),xe=()=>o(118849),Ae=()=>o(44750),Ce=()=>o(902842),we=()=>o(913454),Te=()=>o(204067),Ie=()=>o(265793),_e=()=>o(393695),je=()=>o(759709),ke=()=>o(878665),Pe=o(474848);const Me=4,Be=10;function De(e){let{collectionContextStore:t,onAccept:o}=e;const n=(0,i().v3)(),l=(0,w().tz)(),s=(0,a().IS)((e=>({iconStyle:{fill:e.aiPurpleColor}})),[]),c=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),d=(0,r().K8)((()=>(0,ee().QV)()),[]),p=!(0,r().O$)(he().e),u=(0,r().K8)((()=>{if(p)return[];if(d){return rt((0,Z().lO)({environment:n,collectionContextStore:t}),c)}return[]}),[t,c,n,d,p]);return(0,r().K8)((()=>Object.fromEntries(u.map((e=>[Z().dC[e.propertyType].toLowerCase(),Qe({collectionContextStore:t,propertyType:e.propertyType,propertyName:Z().dC[e.propertyType],disablePropertyTooltip:!0,intl:l,iconStyle:s.iconStyle,onAccept:o,isSuggestedProperty:!0,isOffline:p})])))),[t,l,o,s.iconStyle,u,p])}function Fe(e){let{collectionContextStore:t,propertySchema:o,disableSuggestions:c,hasAiEnabled:d,showAiSuggestions:p,getFilteredSuggestedItemKeys:u,onAccept:m,iconStyle:y}=e;const f=(0,i().v3)(),S=(0,a().DP)(),h=(0,w().tz)(),b=(0,a().IS)((e=>({aiIconStyle:{fill:e.aiPurpleColor},defaultIconStyle:{fill:e.regularIconColor}})),[]),v=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,K().lS)((0,R().appConfigs)(),o):void 0}),[t]);(0,Ie().b)(t);const A=(0,_e().Y)(t),C=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),T=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat()}),[t]),_=function(e){let{collectionContextStore:t,showAiSuggestions:o}=e;const a=(0,i().v3)(),l=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema();return o?I().oE(Object.values(o).map((e=>null==e?void 0:e.name.toLocaleLowerCase()))):[]}),[t]),s=(0,n.useCallback)((e=>e.filter((e=>!l.includes(e.name.toLocaleLowerCase())))),[l]),c=(0,r().K8)((()=>{const e=t.collectionStore(),o=null==e?void 0:e.getFormat();if(null!=o&&o.ai_suggested_properties&&(null==o?void 0:o.ai_suggested_properties.length)>0)return s(null==o?void 0:o.ai_suggested_properties)}),[t,s]),[d,p]=(0,n.useState)(c||"loading"),u=(0,n.useRef)(!1);return(0,n.useEffect)((()=>{if(u.current||c)return;(async()=>{const e=t.collectionStore(),o=null==e?void 0:e.getSpaceId(),n=null==e?void 0:e.id,i=[];if(o&&n&&e.getName()){const t=await k().callApi({eventName:"getAiSuggestedProperties",environment:a,data:{spaceId:null==e?void 0:e.getSpaceId(),collectionId:null==e?void 0:e.id,schema:I().oE(Object.values(e.getSchema())),collectionName:(0,Q().r4)(e.getName(),e),numSuggestion:Be},headers:(0,x().WS)({spaceId:o})});if("success"===t.type){const o=t.data.properties.filter((e=>!l.includes(e.name.toLocaleLowerCase())));i.push(...o),D().createAndCommit({environment:a,perform:t=>{B().zA({stores:[e],update:{ai_suggested_properties:o},transaction:t})},canUndo:!0,userAction:"propertyType.generateAiSuggestion"})}}const r=s(i);p(r)})(),u.current=!0}),[t,a,d,o,c,l,s]),d}({collectionContextStore:t,showAiSuggestions:p}),j=(0,r().K8)((()=>(0,ee().QV)()),[]),P=!(0,r().O$)(he().e),M=(0,r().K8)((()=>{if(o||c||P)return[];const e=A.filter((e=>(0,we().shouldShowInSuggestedProperties)(e)));if(v){const e=function(e){let{appConfig:t,collectionFormat:o,collectionSchema:n,hasAiEnabled:i}=e;if(!o||!n)return[];const r=e=>{const t=o.app_config_uri,r=g().u9.derivePropertyUris(n??{},o.app_uri_map);if(e.collectionUri!==t)return!1;let a=!0;e.uri===(0,O().Jb)().uri&&r.has(l().yx.GithubPrsRelation)&&(a=!1);return e.dependencies.some((e=>"property"===e.type&&e.collectionUri===t&&(0,s().LE)(e.uri)&&!r.has(e.uri)))&&(!e.isAi||i)&&a},a={};t.allFeatures.forEach((e=>{(0,K().$n)(e)&&e.variants.every((e=>Boolean(t.allFeatures.find((t=>t.uri===e&&(0,K().lK)(t)&&r(t))))))&&(a[e.uri]=e.variants)}));const c=Object.values(a).flat(),d=t.allFeatures.filter((e=>(0,K().lK)(e)&&!c.find((t=>t===e.uri))?r(e):!!(0,K().$n)(e)&&Boolean(a[e.uri])));return d.sort(((e,t)=>(0,K().$n)(e)?-1:(0,K().$n)(t)?1:e.dependencies.length-t.dependencies.length))}({appConfig:v,collectionFormat:T,collectionSchema:C,hasAiEnabled:d});return(j?e.filter((e=>"notion://tasks/task_summary_feature"!==e.uri)):e).map((e=>({type:"typed",appConfigFeature:e})))}if(e.length>0)return e.map((e=>({type:"workflow",template:e})));if(p)return"loading"===_?"loading":_.map((e=>({type:"ai_suggestion",propertySchema:e})));if(!j){return rt((0,Z().lO)({environment:f,collectionContextStore:t}),C)}return[]}),[o,c,A,v,p,j,T,C,d,_,f,t,P]),F=(0,n.useMemo)((()=>{if("loading"===M)return[];const e=M.filter((e=>"workflow"===e.type)).map((e=>$e(e.template.templateId)));return u(e).map(Ye)}),[M,u]);(0,je().O)({collectionContextStore:t,origin:"suggested_properties",shownTemplateIds:F});return(0,r().K8)((()=>"loading"===M?"loading":Object.fromEntries(M.map(((e,o)=>{switch(e.type){case"ai_suggestion":return[e.propertySchema.name.toLowerCase(),Qe({collectionContextStore:t,propertyType:e.propertySchema.type,propertyName:e.propertySchema.name,disablePropertyTooltip:!0,intl:h,onAccept:m,isSuggestedProperty:!0,iconStyle:y,isOffline:P})];case"typed":return[e.appConfigFeature.name.toLowerCase(),Je({appConfig:v,suggestedProperty:e.appConfigFeature,isDisabled:!1,environment:f,collectionContextStore:t,theme:S,iconStyle:y??b.defaultIconStyle})];case"workflow":return[(0,we().getWorkflowTemplateName)(e.template).toLowerCase(),Xe({environment:f,template:e.template,collectionContextStore:t,iconStyle:y??b.defaultIconStyle,suggestedFeatureAnalytics:{origin:"suggested_properties",selectedIndex:F.indexOf(e.template.templateId),shownTemplateIds:F}})];case"derived_ai_property":return[Z().dC[e.propertyType].toLowerCase(),Qe({collectionContextStore:t,propertyType:e.propertyType,propertyName:Z().dC[e.propertyType],disablePropertyTooltip:!0,intl:h,iconStyle:b.aiIconStyle,onAccept:m,isSuggestedProperty:!0,isOffline:P})]}})))),[v,t,f,h,M,S,m,F,y,b,P])}function Re(e){const{hasMoreSuggestions:t,filteredSuggestedPropertyItems:o,showAiSuggestions:i,setIsShowingMoreSuggestions:r,hasSearchInput:l,disableSuggestions:s,isLoading:c,title:d,desktopTitleStyle:p}=e,u=(0,ue().X)("db_ux_properties"),m=(0,a().IS)((e=>({loadingShimmer:{height:10,borderRadius:4,margin:"12px 14px",backgroundColor:e.lightDividerColor},loadingText:{color:e.text.secondary},moreSuggestionsButtonContainer:{display:"flex",alignItems:"center",lineHeight:1.2,color:e.text.secondary,fontSize:12},titleContainer:{display:"flex",alignItems:"center"},aiIcon:{display:"inline-flex",width:v().Ev.sm,height:v().Ev.sm,fill:e.icon.secondary,marginRight:6}})),[]),g=(0,n.useMemo)((()=>({key:"suggested",render:e=>(0,Pe.jsx)(G().A,{...e,title:(0,Pe.jsxs)("span",{style:m.titleContainer,children:[(0,S().aiFaceSmallIcon)(m.aiIcon),(0,Pe.jsx)("span",{className:"notion-shimmer-text-darker",style:m.loadingText,children:(0,Pe.jsx)(w().sA,{...at.loadingSuggestedSectionTitle})})]}),disableMobileBorders:!0}),items:[]})),[m.aiIcon,m.loadingText,m.titleContainer]),y=(0,n.useMemo)((()=>({key:"suggested",render:e=>(0,Pe.jsxs)(G().A,{...e,title:se().A.formatMessage(at.suggestedSectionTitle),disableMobileBorders:!0,children:[(0,Pe.jsx)(W().A,{style:{width:"80%",...m.loadingShimmer}}),(0,Pe.jsx)(W().A,{style:{width:"50%",...m.loadingShimmer}}),(0,Pe.jsx)(W().A,{style:{width:"60%",...m.loadingShimmer}}),(0,Pe.jsx)(W().A,{style:{width:"50%",...m.loadingShimmer}})]}),items:[]})),[m.loadingShimmer]),f=(0,n.useMemo)((()=>u?g:y),[u,g,y]),b=(0,n.useMemo)((()=>({key:"more-suggestions",render:e=>(0,Pe.jsx)(z().A,{...e,title:(0,Pe.jsxs)("div",{style:m.moreSuggestionsButtonContainer,children:[(0,Pe.jsx)(w().sA,{id:"database.collectionsettings.propertySuggestions.more",defaultMessage:"More"}),(0,h().b)({fill:T().Ay.uiGray,width:12,height:12,marginLeft:4})]})}),action:e=>{r(!0),e.event&&"stopPropagation"in e.event&&e.event.stopPropagation()}})),[r,m.moreSuggestionsButtonContainer]);return(0,n.useMemo)((()=>s?{key:"suggested",render:()=>null,items:[]}:o.length?{key:"suggested",render:e=>(0,Pe.jsx)(G().A,{...e,title:u?(0,Pe.jsxs)("span",{style:m.titleContainer,children:[(0,S().aiFaceSmallIcon)(m.aiIcon),(0,Pe.jsx)("span",{children:d})]}):d,desktopTitleStyle:p}),items:t&&!l?[...o,b]:o}:c&&i&&!l?f:{key:"suggested",render:()=>null,items:[]}),[s,o,t,l,b,c,i,f,u,m.titleContainer,m.aiIcon,d,p])}function Oe(e){let{environment:t,collectionContextStore:o,propertySchema:i,onAccept:a,intl:l,section:s,iconStyle:c}=e;const d=(0,r().K8)((()=>(0,Z().xm)({collectionContextStore:o,environment:t})),[o,t]),p=(0,n.useMemo)((()=>{switch(s){case"basic":return Ke;case"advanced":return Ee;case"metadata":return Ne;case"all":return d;default:(0,_().HB)(s)}}),[s,d]),u=!(0,r().O$)(he().e);return(0,r().K8)((()=>Object.fromEntries(p.map((e=>[Z().dC[e].toLowerCase(),Qe({propertyType:e,propertyName:Z().dC[e],collectionContextStore:o,onAccept:a,intl:l,propertySchema:i,isSuggestedProperty:!1,iconStyle:c,isOffline:u})])))),[o,l,a,i,p,c,u])}const Ke=["text","number","select","multi_select","status","date","person","file","checkbox","url","phone_number","email"],Ee=["relation","rollup","formula","button","auto_increment_id"],Ne=["created_time","last_edited_time","created_by","last_edited_by"];function ze(e){const t=(0,i().v3)(),o=(0,X().ET)(),n=(0,a().IS)((e=>({defaultIconStyle:{fill:e.regularIconColor}})),[]),l=(0,r().K8)((()=>{const i=function(e){var t;let{environment:o,collectionContextStore:n,spaceStore:i}=e;if(!(0,de().Io)())return!1;const r=null==i?void 0:i.getModel();if(!r||!(0,C().Xi)(r))return!1;const a=null===(t=n.collectionViewBlockStore())||void 0===t?void 0:t.isCollectionViewPageWithContent();if(a)return!1;const l=n.collectionStore();if(!l)return!1;const s=(0,Te().NU)({environment:o,collectionStore:l,templateId:c().z$});if(s)return!1;return!0}({environment:t,collectionContextStore:o,spaceStore:fe().default.getState().currentSpaceStore}),r=(0,de().$3)({environment:t,collectionStore:o.collectionStore()});if(!i&&!r)return{};const a=we().globalWorkflowTemplates.fromId(c().z$);if(!(0,d().bz)(a))return{};const l=(0,de().xE)(t),s="verification_upsell_item_collection_entrypoint",p=r?(0,Pe.jsx)(xe().A,{subscriptionTier:"business",analyticsName:s}):l?(0,Pe.jsx)(L().E,{style:{marginLeft:2},newBadgeKey:"verification",didUserEngage:!1,keyType:"date"}):void 0;return{[a.templateId]:Xe({environment:t,template:a,collectionContextStore:o,suggestedFeatureAnalytics:void 0,titleBadge:p,onAccept:()=>{var e,n;r?(0,be().K)(t,{from:s,upsell:{type:"product",product:"business",limit:{type:"none"},trialability:"none"}}):(0,J().u4)({environment:t,event:{eventName:"page_verification_property_added",eventProperties:{space_id:null===(e=fe().default.getState().currentSpaceStore)||void 0===e?void 0:e.id,collection_id:null===(n=o.collectionStore())||void 0===n?void 0:n.id}}})},titleOverride:se().A.formatMessage(F().Gl.verificationPropertyName),isUpsell:r,tooltip:(0,Pe.jsx)(w().sA,{...lt.verification}),iconStyle:e??n.defaultIconStyle})}}),[o,t,e,n.defaultIconStyle]);return l}function He(e){let{filteredAiDerivedPropertyItems:t}=e;return(0,n.useMemo)((()=>t.length?{key:"autofill",render:e=>(0,Pe.jsx)(G().A,{...e,title:se().A.formatMessage(at.autofillSectionTitle)}),items:t}:{key:"autofill",render:()=>null,items:[]}),[t])}function Ve(e){let{filteredStandardPropertyItems:t,key:o,desktopStyle:i,title:r,topBorder:l,desktopTitleStyle:s,searchProperties:c}=e;const d=(0,ue().X)("db_ux_properties"),p=(0,a().IS)((()=>({titleContainer:{display:"flex",alignItems:"center"},titleText:{marginRight:4},icon:{width:v().Ev.sm,height:v().Ev.sm}})),[]),u=(0,n.useMemo)((()=>{if(!d)return t;if(!c)return t;const{searchInput:e,showSearchInput:o,handleSearchInputChange:n}=c;if(!o)return t;return[{key:"search-input",render:t=>(0,Pe.jsx)(U().Ay,{...t,placeholder:se().A.formatMessage(at.newSearchPlaceholder),value:e,onChange:n}),action:()=>{}},...t]}),[t,d,c]);return(0,n.useMemo)((()=>u.length?d?{key:"standard",render:e=>(0,Pe.jsx)(G().A,{...e,topBorder:l,desktopStyle:i,desktopTitleStyle:{marginBottom:null!=c&&c.showSearchInput?0:void 0,...s},title:(0,Pe.jsxs)("span",{style:p.titleContainer,children:[(0,Pe.jsx)("span",{style:p.titleText,children:r}),(0,Pe.jsx)(V().A,{ariaLabel:se().A.formatMessage(at.searchPlaceholder),icon:b().u,iconStyle:p.icon,onClick:null==c?void 0:c.handleToggleSearchInput})]})}),items:u}:{key:o,render:e=>(0,Pe.jsx)(G().A,{...e,topBorder:l,title:r,desktopStyle:i,desktopTitleStyle:s}),items:u}:{key:o,render:()=>null,items:[]}),[u,d,o,l,i,null==c?void 0:c.showSearchInput,null==c?void 0:c.handleToggleSearchInput,s,p.titleContainer,p.titleText,p.icon,r])}function Ue(e){let{collectionContextStore:t,propertySchema:o,propertyGroupId:a,from:s}=e;const c=(0,i().v3)(),d=(0,w().tz)(),p=(0,r().K8)((()=>ie().A.bots.state),[]),u=(0,r().K8)((()=>t.collectionStore()),[t]),g=(0,r().K8)((()=>(null==u?void 0:u.getSchema())??{}),[u]),y=(0,r().K8)((()=>Boolean(null==u?void 0:u.isPageTreeCollection())),[u]),S=(0,r().K8)((()=>t.databaseType),[t]),h=(0,r().K8)((()=>{var e;return null===(e=fe().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),b=(0,r().K8)((()=>{if(void 0===o)return function(e,t){if(!e)return[];const o=ne().default.checkGate({gateName:"cron_connected_relation"}),n=ne().default.checkGate({gateName:"connected_relation"}),i=ne().default.checkGate({gateName:"slack_connected_relation"}),r=ne().default.checkGate({gateName:"salesforce_connected_relation_database_actions_enabled"}),a=e.getDatabaseType()===l().dC,s=ie().A.state;if(!s.loaded)return[];const c=s.integrations,d={};if(!a){const e=c.find((e=>e.id===f().ob)),t=(0,O().Jb)();var p;e&&(d[t.name]={name:t.name,pattern:te().Y,integration:e,tooltipImage:{img:oe().A.images.tooltips.properties.githubSyncPullStatusPng,scale:.5},description:t.description,canOnlyAdminAuth:{disabledPropertyTooltipMessage:null===(p=t.canOnlyAdminAuth)||void 0===p?void 0:p.disabledPropertyTooltipMessage}})}const u=[];if(t&&(u.push(f().Hd,f().e1,f().k0),i&&u.push(f().zG)),o&&u.push(f().io),u.forEach((e=>{const t=c.find((t=>t.id===e));if(null!=t&&t.info.original_url_patterns)for(const n of t.info.original_url_patterns){var o;null!==(o=n.additional_types)&&void 0!==o&&o.connectedRelation&&(d[n.name]||(d[n.name]={name:(0,re().Fe)({pattern:n,integration:t}),pattern:n,integration:t}))}})),!n)return Object.values(d);for(const l of c)if(l.info.original_url_patterns&&t&&![...ae,f().F6].includes(l.id))for(const e of l.info.original_url_patterns){var m;null!==(m=e.additional_types)&&void 0!==m&&m.connectedRelation&&(d[e.name]||(l.id===f().mn&&r?d[l.name]={name:l.name,pattern:e,integration:l}:d[e.name]={name:(0,re().Fe)({pattern:e,integration:l}),pattern:e,integration:l}))}return Object.values(d)}(u,h)}),[u,o,h]),v=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[t]),x=(0,r().K8)((()=>{var e;return null===(e=fe().default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),C=(0,pe().Ld)({spaceId:v,userId:x}),T=(0,r().K8)((()=>Boolean(null==u?void 0:u.isSyncedCollection())),[u]),I=(0,me().J)(),j=(0,ge().a)(),k=!(0,r().O$)(he().e),P=(0,n.useMemo)((()=>{if(null!=b&&b.length&&!j&&!k)return Object.fromEntries(b.map((e=>{const{isDisabled:o,featureAvailability:n,propertyDisabledTooltip:i}=function(e){let{propertyConfig:t,databaseType:o,bots:n,isSpaceAdmin:i,isMobile:r,isWikiCollection:a,isSyncedCollection:s,schema:c,intl:d,featureAvailabilities:p}=e;const u="integration"in t?t.integration.id:t.integrationId;if(!u)return{isDisabled:!1};const g=p[u];if(g&&!(0,A().e2)(g))return{isDisabled:!0,featureAvailability:g,propertyDisabledTooltip:d.formatMessage(at.upgradeRequired)};var y;if((0,m().iY)({isAuthed:Boolean(n.find((e=>e.integration_id===u))),isSpaceAdmin:i,isPropertyAdminAuthOnly:Boolean(t.canOnlyAdminAuth),isMobile:r}))return{isDisabled:!0,propertyDisabledTooltip:null===(y=t.canOnlyAdminAuth)||void 0===y?void 0:y.disabledPropertyTooltipMessage};if(u===f().ob){if(ot(c,f().ob))return{isDisabled:!0,propertyDisabledTooltip:d.formatMessage(at.duplicateGithubPropertyTooltip)};if(a)return{isDisabled:!0,propertyDisabledTooltip:d.formatMessage(at.wikiGithubPropertyTooltip)};if(s)return{isDisabled:!0,propertyDisabledTooltip:d.formatMessage(at.syncedDatabaseGithubPropertyTooltip)}}else if(u===f().io){if(ot(c,f().io),o!==l().TC)return{isDisabled:!0,propertyDisabledTooltip:d.formatMessage(at.nonMeetingsCronPropertyTooltip)};if(ot(c,f().io))return{isDisabled:!0,propertyDisabledTooltip:d.formatMessage(at.duplicateCronEventPropertyTooltip)}}return{isDisabled:!1}}({propertyConfig:e,bots:p,isSpaceAdmin:I,environment:c,isWikiCollection:y,databaseType:S,isSyncedCollection:T,schema:g,intl:d,isMobile:c.device.isMobile,featureAvailabilities:C});return[e.name.toLowerCase(),Ze({connectedRelationProperty:e,isDisabled:o,propertyDisabledTooltip:i,environment:c,intl:d,collectionContextStore:t,propertyGroupId:a,featureAvailability:n,from:s})]})).filter(_().O9))}),[b,j,p,I,c,y,S,T,g,d,t,a,C,s,k]);return P}function We(e){const{collectionContextStore:t}=e,o=(0,i().v3)(),a=(0,r().K8)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema())??{}}),[t]),l=(0,ue().X)("connected_relations_database_actions_enabled"),s=!(0,r().O$)(he().e),[c,d]=(0,n.useMemo)((()=>{if(!l)return[{},[]];const e={};for(const[n,i]of Object.entries(a)){if(!i||!(0,u().UU)(i))continue;const r=i.connectedRelation.integration_id;if(!r||!(0,f().KB)(r))continue;const a=et({propertySchema:i,environment:o,collectionContextStore:t,propertyId:n,integrationId:r,isOffline:s});e[r]||(e[r]={}),e[r][i.name.toLowerCase()]=a}return[e,Object.values(e).flat()]}),[a,l,o,t,s]);return[c,d]}function Le(e){let{filteredConnectedPropertyItems:t,hideTitle:o,desktopStyle:i}=e;return(0,n.useMemo)((()=>t.length?{key:"connected",render:e=>(0,Pe.jsx)(G().A,{...e,title:se().A.formatMessage(at.connectedRelationSectionTitle),hideTitle:o,topBorder:o,desktopStyle:i}),items:t}:{key:"connected",render:()=>null,items:[]}),[t,o,i])}function Ge(e){let{filteredConnectedPropertyItemsPerIntegration:t}=e;return(0,n.useMemo)((()=>0===Object.keys(t).length?[{key:"existingConnectedRelations",render:()=>null,items:[]}]:Object.entries(t).map((e=>{let[t,o]=e;return 0===o.length?{key:t,render:()=>null,items:[]}:{key:t,render:e=>(0,Pe.jsx)(G().A,{...e,title:se().A.formatMessage(at.existingConnectedRelationSectionTitle,{integrationName:(0,f().mi)(t)})}),items:o}}))),[t])}const qe="workflow.";function $e(e){return`${qe}${e}`}function Ye(e){return e.replace(qe,"")}function Xe(e){let{environment:t,template:o,collectionContextStore:n,suggestedFeatureAnalytics:i,titleBadge:r,titleOverride:a,isUpsell:l,onAccept:s,tooltip:c,iconStyle:d}=e;const p=a||(0,we().getWorkflowTemplateName)(o);return{key:$e(o.templateId),action:()=>{l||(0,Ae().p)({environment:t,template:o,collectionContextStore:n,suggestedFeatureAnalytics:i}),s&&s()},render:e=>(0,Pe.jsx)($().A,{style:{whiteSpace:"break-spaces"},placement:ye().W.Left,renderTooltip:()=>c,disableTooltip:!c,render:t=>(0,Pe.jsx)(z().A,{...(0,ce().A)(t,e),title:(0,Pe.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,Pe.jsx)(Y().A,{style:{marginRight:4},children:p}),r]}),icon:(0,Pe.jsx)(Ce().z,{template:o,size:16,iconStyle:d})})})}}function Je(e){let{appConfig:t,suggestedProperty:o,isDisabled:n,propertyDisabledTooltip:i,environment:r,collectionContextStore:a,theme:l,iconStyle:c}=e;const d=a.collectionStore(),p=g().u9.derivePropertyUris((null==d?void 0:d.getSchema())??{},null==d?void 0:d.getPropertyMapping()),m=(e,t,o,i)=>{const r=o.dependencies.find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==d||null===(t=d.getFormat())||void 0===t?void 0:t.app_config_uri)&&(0,s().LE)(e.uri)&&!p.has(e.uri)})),a=o.dependencies.find((e=>"property"===e.type&&(0,u().$M)(e.propertySchema)&&(0,u().om)(e.propertySchema)));if(r)return(0,Pe.jsx)(z().A,{...e,disabled:n,disabledFeedback:n,title:(0,Pe.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t,a?(0,Pe.jsx)(E().A,{}):null,o.isNew?"notion://projects/tasks_with_sprints_feature"===o.uri&&(0,Pe.jsx)(N().A,{}):null]}),icon:(0,Pe.jsx)(y().zB,{type:r.propertySchema.type,theme:l,icon:i,size:16,style:c})})},f=new(Se().A);return{key:o.name,render:e=>{var n,l;return(0,Pe.jsx)(ke().A,{showImage:!i,caption:i??o.description,tooltipImage:i||null===(n=o.tooltipImage)||void 0===n?void 0:n.img,tooltipImageScale:null===(l=o.tooltipImage)||void 0===l?void 0:l.scale,render:n=>{if((0,K().lK)(o))return m({...(0,ce().A)(e,n)},o.name,o,o.icon);{const i=I().oE(o.variants.map((e=>{const o=null==t?void 0:t.allFeatures.find((t=>t.uri===e));if(o&&(0,K().lK)(o))return o})));return(0,Pe.jsx)(q().A,{buttonPopupStore:f,items:i,getKey:e=>e.name,onSelect:async e=>{await M().h3({environment:r,feature:e,collectionContextStore:a,addFeatureFrom:"new_property"}),P().os({collectionSettingsStore:a.settingsStore})},selectedItem:void 0,renderOrigin:t=>m({focused:Boolean(e.focused),...(0,ce().A)(I().cJ(e,"onClick","focused"),(0,ce().A)(n,t))},o.name,i[0],o.icon),renderItem:e=>(0,Pe.jsx)(z().A,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0})})}}})},action:async()=>{(0,K().lK)(o)?(await M().h3({environment:r,feature:o,collectionContextStore:a,addFeatureFrom:"new_property"}),P().os({collectionSettingsStore:a.settingsStore})):f.setState({open:!0})}}}function Qe(e){let{collectionContextStore:t,propertySchema:o,propertyName:n,propertyType:i,disablePropertyTooltip:r,intl:a,onAccept:l,iconStyle:s,isSuggestedProperty:c,isOffline:d}=e;const u={key:n,render:e=>{const l=o&&(null==o?void 0:o.type)===i,c=function(e){let{collectionContextStore:t,propertyType:o,propertySchema:n,isOffline:i}=e;if(i&&nt.includes(o))return se().A.formatMessage(j().AY.unavailableOfflineTooltip);if("auto_increment_id"===o){var r;if(null!=n&&n.type)return se().A.formatMessage(le().qh.convert_to_auto_increment_id_property);const e=t.collectionStore();if(null==e?void 0:e.isPageTreeCollection())return se().A.formatMessage(le().qh.wiki_forbidden_auto_increment_id_property);if(Boolean(null==e?void 0:e.isSyncedCollection()))return se().A.formatMessage(le().qh.synced_database_forbidden_auto_increment_id_property);const o=e&&e.id,i=e&&e.getFormat(),a=e&&(null===(r=e.getSpaceStore())||void 0===r?void 0:r.id),l=e&&e.getSchema(),s=e&&e.getDeletedSchema();if(!(o&&i&&a&&l&&s))return;const c=e.getModel();if(c&&(0,p().N_)(c))return se().A.formatMessage(le().qh.duplicate_auto_increment_id_property)}}({collectionContextStore:t,propertyType:i,propertySchema:o,isOffline:d}),u=void 0!==c,m=!r&&lt.hasOwnProperty(i)&&"on"===ne().default.getEligibleGroup({experimentId:"property_creation_tooltips_exp",defaultGroup:"control"})?a.formatMessage(lt[i]):void 0;return(0,Pe.jsx)(tt,{isChecked:l,buttonMenuItemProps:e,propertyName:n,propertyType:i,isDisabled:u,tooltip:c??m,iconStyle:s})},action:()=>{l(i,c,n)}};return u}function Ze(e){let{connectedRelationProperty:t,isDisabled:o,propertyDisabledTooltip:n,environment:i,collectionContextStore:r,intl:a,propertyGroupId:l,featureAvailability:s,from:c}=e;return{key:t.name,render:e=>{const i=s&&!(0,A().e2)(s),r="grid"===c?{width:190}:i?{width:"fit-content"}:{};return(0,Pe.jsxs)(H().fI,{children:[(0,Pe.jsx)(tt,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",isDisabled:o,tooltip:n,icon:t.integration.info.icon,buttonStyle:r}),i&&(0,Pe.jsx)(ve().B,{upsell:s.upsell,analyticsName:"collection_connected_property",disableTooltip:!0})]})},action:async()=>{const e=ne().default.checkGate({gateName:"salesforce_connected_relation_database_actions_enabled"});if(t.integration.id===f().mn&&e){const e=r.collectionStore();(0,J().u4)({environment:i,event:{eventName:"salesforce_actions",eventProperties:{actionType:"navigate_to_object_selection",integrationId:t.integration.id,collectionId:null==e?void 0:e.id}}}),P().a2({collectionSettingsStore:r.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"ConnectedRelationObjectSelection",integrationId:t.integration.id}})}else await M().XO({environment:i,connectedRelationProperty:t,collectionContextStore:r,intl:a,from:"new_property",propertyGroupId:l})}}}function et(e){const{propertySchema:t,collectionContextStore:o,propertyId:n,integrationId:i,isOffline:r}=e;return{key:n,render:e=>(0,Pe.jsx)(tt,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",icon:t.icon,isDisabled:r,tooltip:r?se().A.formatMessage(j().AY.unavailableOfflineTooltip):void 0}),action:()=>{P().a2({collectionSettingsStore:o.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:n,integrationId:i,rootPropertySchema:t}})}}}const tt=n.memo((function(e){let{buttonMenuItemProps:t,isChecked:o,propertyName:i,propertyType:r,isDisabled:l,badge:s,tooltip:c,tooltipImage:d,tooltipImageScale:p,icon:u,iconStyle:m,buttonStyle:g}=e;const f=(0,a().DP)(),S=(0,a().IS)((e=>({container:{display:"inline-flex",alignItems:"center",maxWidth:"100%",overflow:"hidden"},span:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},defaultIconStyle:{fill:e.regularIconColor}})),[]),h=(0,n.useCallback)((e=>(0,Pe.jsx)(z().A,{...e?(0,ce().A)(t,e):t,disabled:l,disabledFeedback:l,title:(0,Pe.jsxs)("div",{style:S.container,children:[(0,Pe.jsx)("span",{style:S.span,children:i}),s]}),isChecked:o,icon:(0,Pe.jsx)(y().zB,{type:r,theme:f,icon:u,size:16,style:m??S.defaultIconStyle}),buttonStyle:g})),[t,l,i,s,o,r,u,g,S,f,m]);return c?(0,Pe.jsx)(ke().A,{showImage:!l,caption:c,tooltipImage:l?void 0:d,tooltipImageScale:p,render:e=>h(e)}):h(void 0)}));function ot(e,t){for(const n in e){var o;const i=e[n];if(i&&"connectedRelation"in i&&(null===(o=i.connectedRelation)||void 0===o?void 0:o.integration_id)===t)return!0}return!1}const nt=["button","formula","auto_increment_id"];const it=["ai_summary"];function rt(e,t){const o=t?function(e){const t=new Set;for(const n in e){const i=e[n];if(i&&"ai_inference"in i){var o;const e=null===(o=i.ai_inference)||void 0===o?void 0:o.type;if(e)switch(e){case"custom":t.add("ai_custom_prompt");break;case"summarize":t.add("ai_summary");break;case"extract":t.add("ai_extract");break;case"translate":t.add("ai_translate")}}else i&&"select_ai_inference"in i&&t.add("ai_keywords")}return t}(t):new Set;return e.map((e=>({type:"derived_ai_property",propertyType:e}))).filter((e=>!it.includes(e.propertyType)||!o.has(e.propertyType)))}const at=(0,w().YK)({searchPlaceholder:{defaultMessage:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},newSearchPlaceholder:{defaultMessage:"Search...",id:"database.viewSettings.propertyTypeSelect.newSearchPlaceholder"},searchToChangePlaceholder:{defaultMessage:"Search for property type",id:"database.viewSettings.propertyTypeSelect.searchToChangePlaceholder"},propertyNameInputPlaceholder:{defaultMessage:"Enter property name...",id:"database.viewSettings.propertyTypeSelect.propertyNameInputPlaceholder"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},loadingSuggestedSectionTitle:{defaultMessage:"Thinking...",id:"database.viewSettings.propertyTypeSection.loadingSuggested"},connectedRelationSectionTitle:{defaultMessage:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},existingConnectedRelationSectionTitle:{defaultMessage:"{integrationName}",id:"database.viewSettings.propertyTypeSection.existingConnectedIntegrationTitle"},typesSectionTitle:{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"},autofillSectionTitle:{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.autofillProperties"},newProperty:{defaultMessage:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{defaultMessage:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},changePropertyType:{defaultMessage:"Change property type",id:"database.viewSettings.changePropertyType"},selectToAddNewProperty:{defaultMessage:"Select to add",id:"database.viewSettings.selectToAdd"},newPill:{defaultMessage:"New",id:"database.viewSettings.newHighlightedFeature"},duplicateGithubPropertyTooltip:{defaultMessage:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{defaultMessage:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{defaultMessage:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},nonMeetingsCronPropertyTooltip:{defaultMessage:"The Cron Calendar property can only be added to a Meetings database",id:"database.viewSettings.propertyTab.nonMeetingsCronProperty.tooltip"},duplicateCronEventPropertyTooltip:{defaultMessage:"A database can only have one Cron Calendar event property",id:"database.viewSettings.propertyTab.duplicateCronEventProperty.tooltip"},upgradeRequired:{defaultMessage:"Please upgrade to use this property",id:"database.viewSettings.propertyTab.upgradeRequired"},selectType:{defaultMessage:"Select type",id:"database.viewSettings.propertyTabGrid.selectType"}}),lt=(0,w().YK)({text:{defaultMessage:"Add text that can be formatted. Great for summaries, notes, or descriptions.",id:"database.viewSettings.propertyTab.textProperty.tooltip"},number:{defaultMessage:"Accepts numbers. These can also be formatted as currency or progress bars. Useful for tracking counts, prices, and completion.",id:"database.viewSettings.propertyTab.numberProperty.tooltip"},select:{defaultMessage:"Select one option from a list of tags. Useful for categorization.",id:"database.viewSettings.propertyTab.selectProperty.tooltip"},multi_select:{defaultMessage:"Select one or more options from a list of tags. Useful for tagging items across multiple categories.",id:"database.viewSettings.propertyTab.multiSelectProperty.tooltip"},date:{defaultMessage:"Accepts a date or a date range (time optional). Useful for deadlines, especially with calendar and timeline views.",id:"database.viewSettings.propertyTab.dateProperty.tooltip"},formula:{defaultMessage:"Perform calculations based on other properties using Notion’s formula language.",id:"database.viewSettings.propertyTab.formulaProperty.tooltip"},relation:{defaultMessage:"Connect databases and mention database pages. Useful for connecting items across your workspace.",id:"database.viewSettings.propertyTab.relationProperty.tooltip"},rollup:{defaultMessage:"View and aggregate information about properties from relation properties. Useful for summarizing interconnected data.",id:"database.viewSettings.propertyTab.rollupProperty.tooltip"},person:{defaultMessage:"Tag anyone in your Notion workspace. Useful for assigning tasks or referencing relevant team members.",id:"database.viewSettings.propertyTab.personProperty.tooltip"},file:{defaultMessage:"Upload files and images for easy retrieval. Useful for storing documents and photos.",id:"database.viewSettings.propertyTab.filesProperty.tooltip"},checkbox:{defaultMessage:"Use a checkbox to indicate whether a condition is true or false. Useful for lightweight task tracking.",id:"database.viewSettings.propertyTab.checkboxProperty.tooltip"},url:{defaultMessage:"Accepts a link to a website and opens the link in a new tab when clicked.",id:"database.viewSettings.propertyTab.urlProperty.tooltip"},email:{defaultMessage:"Accepts an email address and launches your mail client when clicked.",id:"database.viewSettings.propertyTab.emailProperty.tooltip"},phone_number:{defaultMessage:"Accepts a phone number and prompts your device to call it when clicked.",id:"database.viewSettings.propertyTab.phoneNumberProperty.tooltip"},created_time:{defaultMessage:"Records the timestamp of an item’s creation. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdTimeProperty.tooltip"},created_by:{defaultMessage:"Automatically records the person who created the item. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdByProperty.tooltip"},last_edited_time:{defaultMessage:"Records the timestamp of an item’s last edit. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedTimeProperty.tooltip"},last_edited_by:{defaultMessage:"Records the person who edited the item last. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedByProperty.tooltip"},auto_increment_id:{defaultMessage:"Automatically creates a numerical ID for each item. IDs are unique and cannot be manually changed.",id:"database.viewSettings.propertyTab.uniqueIdProperty.tooltip"},status:{defaultMessage:"Track this item’s progress using status tags categorized by To-do, In progress, and Complete.",id:"database.viewSettings.propertyTab.statusProperty.tooltip"},verification:{defaultMessage:"Indicate whether a page has been verified by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.verificationProperty.tooltip"},button:{defaultMessage:"Trigger actions based on the item properties.",id:"database.viewSettings.propertyTab.buttonProperty.tooltip"},ai_summary:{defaultMessage:"Text property with AI summary set up for you. Generates a summary based on page content and properties.",id:"database.viewSettings.propertyTab.aiSummaryProperty.tooltip"},ai_translate:{defaultMessage:"Text property with AI translate set up for you. Translate a property to another language using AI. ",id:"database.viewSettings.propertyTab.aiTranslateProperty.tooltip"},ai_category:{defaultMessage:"Select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCategoryProperty.tooltip"},ai_keywords:{defaultMessage:"Multi-select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiKeywordsProperty.tooltip"},ai_custom_prompt:{defaultMessage:"Text property with a custom AI prompt. Generate content based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCustomPromptProperty.tooltip"},ai_extract:{defaultMessage:"Text property with a custom AI prompt. Extract key info based on the page content and properties.",id:"database.viewSettings.propertyTab.aiExtractProperty.tooltip"},title:{defaultMessage:"Add a title for your database item. This determines the page’s title.",id:"database.viewSettings.propertyTab.titleProperty.tooltip"},location:{defaultMessage:"Display the location of which database this item belongs to.",id:"database.viewSettings.propertyTab.locationProperty.tooltip"},last_visited_time:{defaultMessage:"Records the timestamp of the last time you visited this page. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastVisitedTimeProperty.tooltip"},geo_point:{defaultMessage:"Display a physical location on a map.",id:"database.viewSettings.propertyTab.geoPointProperty.tooltip"}})},200277:(e,t,o)=>{o.d(t,{$:()=>u,N:()=>d});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(430670),o(581454);var n=()=>o(428045),i=()=>o(663077),r=()=>o(496603),a=()=>o(534177),l=()=>o(299545),s=()=>o(913454),c=()=>o(204067);function d(e,t){const o=(0,c().Xg)(e,t),n=new Set(function(e){const t=e.getParentBlockStore();if(null==t||!t.isDefined())return[];return(null==t?void 0:t.getCollectionViewStores().map((e=>e.getName())).filter(a().O9))??[]}(t));return function(e){const t=new Set(e.map((e=>e.templateId))),o=[];for(const n of e)o.push(...p(n).filter((e=>!t.has(e))).map((e=>s().globalWorkflowTemplates.fromId(e))).filter(i().bz).filter((e=>!(0,i().Sz)(e))));return o}(o).filter((e=>"collection_view"!==e.type||!n.has(e.value.name??"")))}function p(e){return"compound"===e.type||"collection"===e.type?e.value.templateItems.filter((e=>"optionalDefaultOn"===e.optionality||"optionalDefaultOff"===e.optionality)).map((e=>e.pointer)):[]}function u(e){let{persona:t,parentStore:o}=e;const i=t?(0,n().Qf)({persona:t}):[],a=s().globalWorkflowTemplates.allOfType({templateIds:i??[],type:"collection"}),c=r().hS(function(e){let{collectionTemplates:t,parentStore:o}=e;if(!o)return t;if((0,l().Yu)(o))return t;const n=(0,l().$R)(o)?o.getTeamPageStores():o.getContentStores(),i=new Set((0,r().oE)(n.flatMap((e=>{var t;return(null===(t=e.getCollectionStores())||void 0===t?void 0:t.map((e=>e.getWorkflowTemplateId())))??[]})))),a=[],s=[];for(const r of t)i.has(r.templateId)?a.push(r):s.push(r);return[...s,...a]}({collectionTemplates:[...a,...s().globalWorkflowTemplates.allOfType({templateIds:(0,n().dj)(),type:"collection"})],parentStore:o}),(e=>e.templateId));return c}},272752:(e,t,o)=>{o.d(t,{V:()=>a,i:()=>l});var n=()=>o(847249),i=()=>o(220719),r=()=>o(175116);function a(){const e=(0,r().ET)(),{collectionStore:t,collectionViewStore:o,collectionSettingsStore:i}=(0,n().K8)((()=>l(e)),[e]);return{collectionStore:t,collectionViewStore:o,collectionSettingsStore:i,collectionContextStore:e}}function l(e){return{collectionStore:(0,i().o9)(e.collectionStore(),"collectionStore not found"),collectionViewStore:(0,i().o9)(e.collectionViewStore(),"collectionViewStore not found"),collectionSettingsStore:e.settingsStore}}},342288:(e,t,o)=>{o.d(t,{z:()=>l});o(296540);var n=()=>o(401497),i=()=>o(831310),r=()=>o(464699),a=o(474848);function l(e){let{isAdded:t}=e;const o=(0,n().IS)((e=>({circle:{height:24,width:24,borderRadius:50,display:"flex",alignItems:"center",justifyContent:"center",background:t?"dark"===e.mode?e.accentColors.blue[100]:e.accentColors.blue[50]:e.lightGrayButtonBackground},plusIcon:{height:15,width:15,fill:e.mediumIconColor},checkIcon:{height:12,width:12,fill:e.blueColor}})),[t]);return(0,a.jsx)("div",{style:o.circle,children:t?(0,i().o)(o.checkIcon):(0,r().b)(o.plusIcon)})}},362941:(e,t,o)=>{o.d(t,{_:()=>a});o(296540);var n=()=>o(401497),i=()=>o(742117),r=o(474848);function a(){const e=(0,n().IS)((e=>({icon:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out"}})),[]);return(0,r.jsx)(r.Fragment,{children:(0,i().V)(e.icon)})}},393695:(e,t,o)=>{o.d(t,{Y:()=>l});var n=()=>o(484714),i=()=>o(847249),r=()=>o(200277),a=()=>o(265793);function l(e){const t=(0,n().v3)();return(0,a().b)(e),(0,i().K8)((()=>{const o=e.collectionStore();return o?(0,r().N)(t,o):[]}),[t,e])}},412237:(e,t,o)=>{o.r(t),o.d(t,{aiFaceSmallIcon:()=>r,iconDefinition:()=>i});o(296540);var n=o(474848);const i={viewBox:"0 0 16 16",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M7.204 1.93a3.47 3.47 0 0 0-4.097.39.625.625 0 1 0 .834.931 2.22 2.22 0 0 1 3.16.202.625.625 0 0 0 .944-.818 3.5 3.5 0 0 0-.84-.705m6.018.976A3.47 3.47 0 0 0 8.463 4.1l-5.077 8.476a.625.625 0 0 0 .437.938l4.41.715a.625.625 0 0 0 .2-1.234l-3.5-.568 4.602-7.685a2.22 2.22 0 0 1 3.822.02.625.625 0 1 0 1.08-.63 3.46 3.46 0 0 0-1.214-1.226m-7.83 2.105a1.094 1.094 0 1 0-.35 2.159 1.094 1.094 0 0 0 .35-2.159"}),(0,n.jsx)("path",{d:"M10.762 5.881a1.093 1.093 0 1 0-.35 2.159 1.093 1.093 0 0 0 .35-2.159"})]})},r=(0,o(340498).wt)("aiFaceSmall",i)},419167:(e,t,o)=>{o.d(t,{Ay:()=>_,GI:()=>T,Ve:()=>k,am:()=>I,jD:()=>j});var n=o(296540),i=()=>o(847249),r=()=>o(401497),a=()=>o(651124),l=()=>o(116089),s=()=>o(340498),c=()=>o(72135),d=()=>o(959013),p=()=>o(534177),u=()=>o(416726),m=()=>o(312540),g=()=>o(497222),y=()=>o(981667),f=()=>o(921855),S=()=>o(227440),h=()=>o(508496),b=()=>o(807778),v=()=>o(577437),x=()=>o(135221),A=()=>o(8980),C=()=>o(859428),w=o(474848);function T(e){let{collectionStore:t,propertySchema:o,autofillFeatureAvailability:n}=e;const r=(0,i().K8)((()=>(0,b().Le)()),[]),a=(0,i().K8)((()=>(0,f().r4)(t.getName(),t)),[t]),l=r?(0,w.jsx)(d().sA,{...m().fillAllPagesMessages.fillAllPagesAddAiMessage}):(0,w.jsx)(d().sA,{...m().fillAllPagesMessages.fillAllPagesAddOnMessage});return(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,w.jsx)(d().sA,{...m().fillAllPagesMessages.fillAllPagesTooltip,values:{hasNames:Boolean(a)&&Boolean(o.name),collectionName:a,propertyName:o.name}})}),!(0,v().e2)(n)&&(0,w.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:l})]})}function I(e){let{updateAiInferencesTaskStatus:t,iconStyle:o,progressIconStyle:n}=e;return(0,y().getIsAutofillCurrentlyRunning)({taskRunningState:t})?(0,w.jsx)("div",{style:n,children:(0,w.jsx)(x().A,{})}):(0,w.jsx)("div",{style:{display:"flex",alignItems:"center",height:"100%"},children:(0,w.jsx)(A().I,{icon:l().magicWandIcon,color:"purplePrimary",style:o})})}function _(e){let{updateAiInferencesTaskStatus:t}=e;const o=(0,d().tz)(),a=(0,i().K8)((()=>h().default.checkGate({gateName:"autofill_all_pages_use_new_endpoint"})?(0,w.jsx)(d().sA,{defaultMessage:"Autofill this view",id:"aiAutofill.fillAllPagesInView.buttonTitle"}):(0,w.jsx)(d().sA,{defaultMessage:"Autofill all pages",id:"aiAutofill.fillAllPages.buttonTitle"})),[]),l=(0,n.useMemo)((()=>{switch(t.status){case"requested":return(0,w.jsx)(d().sA,{defaultMessage:"Requested Autofill",id:"AiAutofill.fillAllPages.requested"});case"notRunning":case"error":return a;case"running":return t.numPagesFilled===t.numPagesRequested?a:(0,w.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:(0,w.jsx)(d().sA,{defaultMessage:"{numPagesRequested, plural, one {Autofilling {numPagesFilled} of {numPagesRequested} page} other {Updating {numPagesFilled} of {numPagesRequested} pages}}",id:"aiAutofill.fillallPages.updatingAllPagesWithProgress",values:{numPagesFilled:(0,c().ZV)(t.numPagesFilled,"compact",o),numPagesRequested:(0,c().ZV)(t.numPagesRequested,"compact",o)}})});default:(0,p().HB)(t)}}),[a,o,t]),s=(0,r().IS)((()=>({textWrapper:{display:"flex",alignItems:"center",overflow:"hidden"}})),[]);return(0,w.jsx)("div",{style:s.textWrapper,children:l})}function j(e){let{updateAiInferencesTaskStatus:t}=e;const o=(0,r().IS)((e=>({inner:{background:e.accentColors.purple[400],height:"100%",transition:"width .5s"},outer:{background:e.accentColors.gray[100],height:3,borderRadius:2,minWidth:120,overflow:"hidden",marginTop:8}})),[]);switch(t.status){case"notRunning":case"requested":case"error":return null;case"running":break;default:(0,p().HB)(t)}const{numPagesFilled:n,numPagesRequested:i}=t;return 0===i||n===i?null:(0,w.jsx)("div",{style:o.outer,role:"progressbar",children:(0,w.jsx)("div",{style:{...o.inner,width:100*Math.min(n/i,1)+"%"}})})}function k(e){const{environment:t,collectionContextStore:o,collectionStore:r,property:l,propertySchema:c,autofillFeatureAvailability:p,isAutofillSetupEnabled:f}=e,h=!(0,i().O$)(S().e),b=(0,i().K8)((()=>{const e=o.collectionStore();return e?(0,a().Ts)(e.getFormat(),l):{status:"notRunning"}}),[o,l]),x=(0,n.useCallback)((async e=>{const n=o.collectionStore(),i=o.collectionViewStore();n&&c&&i&&((0,v().e2)(e)?await m().autofillPropertyForCollection({environment:t,collectionStore:n,propertySchema:c,property:l,collectionViewStore:i}):m().triggerAiAutofillUpsell({environment:t,from:"ai_autofill_fill_all_pages",upsell:e.upsell}))}),[t,c,l,o]),A=(0,y().getIsAutofillCurrentlyRunning)({taskRunningState:b});return(0,w.jsx)(C().A,{disableTooltip:(0,v().e2)(p),renderTooltip:()=>h?(0,w.jsx)(d().sA,{...u().AY.aiUnavailableOfflineTooltip}):(0,w.jsx)(T,{collectionStore:r,propertySchema:c,autofillFeatureAvailability:p}),render:e=>(0,w.jsx)(g().A,{icon:e=>(0,w.jsx)(I,{updateAiInferencesTaskStatus:b,iconStyle:e,progressIconStyle:{width:s().Ev.sm,marginTop:4,marginLeft:4,marginRight:2}}),title:(0,w.jsx)(_,{updateAiInferencesTaskStatus:b}),caption:A&&"requested"!==b.status&&(0,w.jsx)(j,{updateAiInferencesTaskStatus:b}),focused:!1,onClick:()=>x(p),disabled:A||!f||h,...e})})}},474434:(e,t,o)=>{o.d(t,{k:()=>b});o(296540);var n=()=>o(484714),i=()=>o(847249),r=()=>o(401497),a=()=>o(132855),l=()=>o(784438),s=()=>o(959013),c=()=>o(284371),d=()=>o(364280),p=()=>o(8980),u=()=>o(864943),m=()=>o(685889),g=()=>o(817126),y=()=>o(991249),f=()=>o(412236),S=o(474848);const h=(0,s().YK)({plus:{id:"subscriptionTier.plus",defaultMessage:"Plus"},business:{id:"subscriptionTier.business",defaultMessage:"Business"},enterprise:{id:"subscriptionTier.enterprise",defaultMessage:"Enterprise"}});function b(e){const{collectionContextStore:t,property:o,compact:n}=e,r=(0,i().K8)((()=>m().Jq(t,o)),[t,o]),a=(0,g().kg)(r);return a?(0,S.jsx)(v,{featureName:a,compact:n}):null}function v(e){const{featureName:t,compact:o}=e,i=(0,n().v3)(),m=(0,s().tz)(),b=(0,r().IS)((e=>({background:{backgroundColor:e.surface.wash,display:"flex",flexDirection:"row",marginLeft:8,marginRight:8,marginBottom:12,borderRadius:8,padding:"12px 14px",gap:8},icon:{width:20,height:20,padding:o?0:2,marginRight:2,marginLeft:o?0:2},title:{lineHeight:c().K_.UIRegular.desktop,fontSize:c().J.UIRegular.desktop,letterSpacing:"-0.15px",color:e.text.primary,marginBottom:4,display:"flex",flexDirection:"row"},description:{lineHeight:c().K_.UIRegular.desktop,fontSize:c().J.UIRegular.desktop,letterSpacing:"-0.15px",color:e.text.secondary,marginBottom:12},button:{width:"fit-content",padding:"4px 8px",marginBottom:2}})),[o]),v=(0,g().G9)({featureName:t});if(!v)return null;const x=(0,l().Xq)(v);if(!x||"product"!==x.type)return null;const A=x.product;if("plus"!==A&&"business"!==A&&"enterprise"!==A)return null;const C=(0,S.jsx)(p().I,{style:b.icon,icon:a().arrowInCircleUpFillIcon,color:"uiBluePrimary"});return(0,S.jsxs)("div",{style:b.background,children:[o?null:C,(0,S.jsxs)(d().VP,{gap:0,children:[(0,S.jsxs)("div",{style:b.title,children:[o?C:null,(0,S.jsx)(s().sA,{defaultMessage:"Upgrade to {subscriptionTier}",id:"collectionSettings.connectedRelationUpsell.title",values:{subscriptionTier:m.formatMessage(h[A])}})]}),(0,S.jsx)("div",{style:b.description,children:(0,S.jsx)(s().sA,{defaultMessage:"You will lose access to this feature on August 13. {learnMoreLink}",id:"collectionSettings.connectedRelationUpsell.description",values:{learnMoreLink:(0,S.jsx)(f().V,{})}})}),(0,S.jsx)(u().A,{style:b.button,onClick:()=>{y().K(i,{from:"collection_synced_database",upsell:x})},children:(0,S.jsx)(s().sA,{defaultMessage:"Upgrade",id:"collectionSettings.connectedRelationUpsell.upgrade"})})]})]})}},539148:(e,t,o)=>{o.d(t,{S:()=>g});o(296540);var n=()=>o(484714),i=()=>o(401497),r=()=>o(734410),a=()=>o(959013),l=()=>o(704152),s=()=>o(859428),c=()=>o(673730),d=()=>o(554283),p=()=>o(962730),u=o(474848);const m=(0,a().YK)({addDescriptionTooltip:{id:"database.description.addDescriptionTooltip",defaultMessage:"Add description"},editDescriptionTooltip:{id:"database.description.editDescriptionTooltip",defaultMessage:"Edit description"}});function g(e){let{onClick:t,description:o,showTooltip:g,addDescriptionText:y,editDescriptionText:f,disabled:S}=e;const{isMobile:h}=(0,n().Y0)(),[b,v]=(0,d().B)(),x=(0,a().tz)(),A=(0,i().IS)((e=>({button:{flexShrink:0,flexGrow:0,borderRadius:h?24:20,marginLeft:4},info:{width:h?18:16,height:h?18:16,fill:v&&!S?e.regularIconColor:e.mediumIconColor}})),[v,h,S]);return(0,u.jsx)(s().A,{renderTooltip:e=>(0,u.jsx)("div",{...e,children:Boolean(null==o?void 0:o.length)?o:y??x.formatMessage(m.addDescriptionTooltip)}),disableTooltip:!g||S,style:c().Q$,placement:p().W.Top,render:e=>(0,u.jsx)(l().A,{...e,ref:b,onClick:t,"aria-label":Boolean(null==o?void 0:o.length)?y:f??x.formatMessage(m.editDescriptionTooltip),style:A.button,disabled:S,disabledFeedback:S,children:(0,r().q)(A.info)})})}},551882:(e,t,o)=>{o.d(t,{A:()=>p});o(296540);var n=()=>o(484714),i=()=>o(847249),r=()=>o(959013),a=()=>o(68465),l=()=>o(351360),s=()=>o(411671),c=()=>o(464708),d=o(474848);function p(e){const{message:t}=e,o=(0,n().v3)();return(0,i().K8)((()=>{const e=l().default.state.mainEditorCurrentBlockStore,t=e&&s().A.getMode(o,e);return(0,a().ZE)(t)}),[o])?(0,d.jsx)(c().A,{color:"purple",style:{padding:"1px 4px",display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,...e.style},content:t??(0,d.jsx)(r().sA,{id:"aiBadgeComponent.label",defaultMessage:"AI"})}):null}},653259:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(959013),i=()=>o(100622),r=()=>o(125565),a=o(474848);function l(e){return(0,a.jsx)(r().A,{isMultiline:!0,style:{paddingTop:8,marginLeft:16,marginRight:16,color:i().Ay.red,...e.styles},children:(0,a.jsx)(n().sA,{id:"database.viewSettings.propertyTab.duplicatePropertyNameError",defaultMessage:"A property named {propertyName} already exists in this database.",values:{propertyName:e.propertyName}})})}},673964:(e,t,o)=>{o.d(t,{j:()=>r});var n=()=>o(953418),i=()=>o(129522);function r(e){const{collectionContextStore:t,environment:o,fit:r}=e,a=t.collectionViewBlockStore();if(a){const e=i().K.findCollectionViewBlockFromStore(a);if(e){const t=e.getNode();t instanceof HTMLElement&&(0,n().$v)({blockAlignment:"start",element:t,environment:o,behavior:"instant",additionalPadding:{top:"filtersBar"===r?64:128},verticalVisibilityRequirement:"topVisible",horizontalVisibilityRequirement:"none"})}}}},705602:(e,t,o)=>{o.d(t,{s:()=>p,y:()=>m});var n=o(296540),i=()=>o(484714),r=()=>o(401497),a=()=>o(959013),l=()=>o(419357),s=()=>o(89924),c=()=>o(673730),d=o(474848);const p=(0,a().YK)({descriptionHeader:{id:"database.viewSettings.propertyTab.description.title",defaultMessage:"Description"},addDescription:{id:"database.viewSettings.propertyTab.description.addDescription",defaultMessage:"Add a description..."}}),u=60;function m(e){let{initialDescription:t,handleSaveDescription:o,disableAutoSection:m}=e;const[g,y]=(0,n.useState)(t??""),f=(0,n.useRef)(g),{isMobile:S}=(0,i().Y0)(),h=(0,a().tz)(),b=(0,r().IS)((e=>({title:{display:"flex",alignItems:"center",gap:4,cursor:"default",color:e.text.secondary},descriptionInput:{lineHeight:"20px",fontSize:S?14:13}})),[S]),v=(0,n.useCallback)((()=>o(f.current)),[o]);(0,n.useEffect)((()=>()=>v()),[v]);const x=(0,n.useMemo)((()=>(0,d.jsx)(l().Ay,{value:g,onChange:e=>{y(e.target.value),f.current=e.target.value},onBlur:v,onSubmit:v,placeholder:h.formatMessage(p.addDescription),focusInitial:!0,disabled:!1,inputOuterStyle:b.descriptionInput,textarea:!0,textareaSubmitOnEnter:!0,maxlength:c().fy,autosize:!0,autosizeMaxHeight:u,showClearButton:!1})),[g,h,v,b.descriptionInput]);return S&&!m?(0,d.jsx)(s().A,{topBorder:!0,isInput:!0,title:(0,d.jsx)("span",{style:b.title,children:h.formatMessage(p.descriptionHeader)}),children:x}):x}},736982:(e,t,o)=>{o.d(t,{I:()=>d,h:()=>c});o(296540);var n=()=>o(484714),i=()=>o(401497),r=()=>o(284371),a=()=>o(760217),l=()=>o(115512),s=o(474848);function c(e){let{environment:t}=e;return{padding:t.device.isMobile?"12px 2px":"6px",alignItems:"center"}}function d(e){let{buttonMenuItemProps:t,title:o,caption:d,icon:p,onClick:u,right:m,isDisabled:g}=e;const y=(0,n().v3)(),f=(0,i().IS)((e=>({menuItem:{display:"flex",...c({environment:y}),opacity:g?.4:void 0},title:{fontSize:(0,l().ny)(y,"UIRegular"),...r().RC},caption:{fontSize:(0,l().ny)(y,"UISmall"),overflow:"hidden",color:e.text.secondary,whiteSpace:"nowrap",textOverflow:"ellipsis"}})),[y,g]),S={};return u&&(S.onClick=u),(0,s.jsx)(a().A,{...t,style:f.menuItem,disabled:g,title:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:f.title,children:o}),d&&(0,s.jsx)("div",{style:f.caption,children:d})]}),icon:p,right:m,...S})}},755735:(e,t,o)=>{o.d(t,{B:()=>d});var n=o(296540),i=()=>o(847249),r=()=>o(383594),a=()=>o(419357),l=()=>o(486666),s=o(474848);const c=o(757695).default.createClass("",{name:"InputStore"}),d=n.forwardRef((function(e,t){const{placeholder:d,focusInitial:p,selectAll:u,disabled:m,inputOuterStyle:g,iconButton:y,inputRightButton:f,initialValue:S,onBlur:h,onSubmit:b,onChange:v,maxLength:x,textWrapperStyle:A,textarea:C}=e,w=(0,o(484714).v3)(),T=(0,o(959013).tz)(),[I,_]=(0,n.useState)(S||""),j=(0,i().uB)(e.inputStore,c),k=(0,i().O$)(j)||I,P=(0,n.useCallback)((()=>{h(k)}),[k,h]),M=(0,n.useCallback)((()=>{b(k)}),[k,b]),B=(0,n.useCallback)((e=>{const t=e.target.value;_(t),j&&j.setState(t),v&&v(t)}),[j,v]),D=(0,n.useCallback)((e=>{if(!(y&&e.target instanceof Element))return;const{onSubmit:t,enforceIconColor:o,includeEmojiTab:n}=y;r().W(w,{originRect:e.target.getBoundingClientRect(),originGap:3,popupHeight:l().GF,popupWidth:l().jv,showArrow:!0,title:T.formatMessage({defaultMessage:"Icon",id:"mediaPicker.tabs.icon"}),currentTab:"icon",tabs:n?[{type:"emoji",onChange:(e,o)=>{t(e),o&&o.keepVisible||r().I()}},{type:"icon",enforceIconColor:o,onChange:(e,o)=>{t(e),o&&o.keepVisible||r().I()}}]:[{type:"icon",enforceIconColor:o,onChange:(e,o)=>{t(e),o&&o.keepVisible||r().I()}}],onDelete:()=>{t(),r().I()}})}),[w,y,T]),F=(0,o(336811).O)();(0,n.useEffect)((()=>{e.inputStore&&j.setState(S)}),[]),(0,n.useEffect)((()=>()=>{F.current&&S!==k&&h(k)}),[S,k,F,h]);const R=(0,o(401497).IS)((()=>({iconButton:{opacity:m?.4:void 0},textWrapper:{opacity:m?.4:void 0,...A}})),[m,A]);return(0,s.jsx)(a().Ay,{ref:t,focusInitial:p,autoFocus:!!p||void 0,selectAll:u,value:k,onChange:B,onBlur:P,onSubmit:M,placeholder:d,disabled:m,textWrapperStyle:R.textWrapper,maxlength:x,inputOuterStyle:g,left:y?(0,s.jsx)(a().KF,{icon:y.icon,iconStyle:y.iconStyle,onClick:D,disabled:m,style:R.iconButton,backgroundColor:y.backgroundColor}):null,showClearButton:!1,inputRight:f,textarea:C})}))},759709:(e,t,o)=>{o.d(t,{O:()=>l});var n=o(296540),i=()=>o(484714),r=()=>o(847249),a=()=>o(989423);function l(e){let{collectionContextStore:t,shownTemplateIds:o,origin:l}=e;const s=(0,i().v3)(),c=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getWorkflowTemplateId()}),[t]),d=(0,n.useRef)(!1);(0,n.useEffect)((()=>{!d.current&&o.length>0&&((0,a().u4)({environment:s,event:{eventName:"suggested_feature_templates_shown",eventProperties:{origin:l,collection_template_id:c,template_ids_shown:o}}}),d.current=!0)}))}},871114:(e,t,o)=>{o.d(t,{o:()=>i});o(296540);const n={viewBox:"0 0 20 20",svg:(0,o(474848).jsx)("path",{d:"M16.625 8A2.625 2.625 0 0 0 14 5.375h-1.42a.625.625 0 1 1 0-1.25H14a3.875 3.875 0 0 1 0 7.75H4.259l3.333 3.333a.625.625 0 0 1-.884.884l-4.4-4.4a.625.625 0 0 1 0-.884l4.4-4.4a.625.625 0 0 1 .884.884l-3.333 3.333H14A2.625 2.625 0 0 0 16.625 8"})},i=(0,o(340498).wt)("arrowUTurnDownLeft",n)},878665:(e,t,o)=>{o.d(t,{A:()=>d});var n=o(296540),i=()=>o(401497),r=()=>o(100622),a=()=>o(859428),l=()=>o(103448),s=()=>o(962730),c=o(474848);function d(e){const{render:t,showImage:o,caption:d,description:p,tooltipImage:u,placement:m,tooltipDelayThreshold:g,hideTooltipBeforeImageLoaded:y,imageContainerStyle:f}=e,S=e.tooltipImageScale||1,[h,b]=n.useState(!1),[v,x]=n.useState({width:0,height:0});n.useEffect((()=>{if(u){const e=new Image;e.src=u,e.onload=()=>{x({width:"number"==typeof S?e.width*S:S.widthPx,height:"number"==typeof S?e.width*S:S.heightPx}),b(!0)}}}),[u,S]);const A=(0,i().IS)((()=>({tooltip:{whiteSpace:"break-spaces"},description:{fontWeight:"normal",color:r().Ay.uiLightGray}})),[]),C=(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:d}),p&&(0,c.jsx)("div",{style:A.description,children:p})]});return(0,c.jsx)(a().A,{placement:m??s().W.Left,disableTooltip:void 0===d||!h&&y,delayThreshold:g,style:A.tooltip,render:t,renderTooltip:()=>u&&h&&o?(0,c.jsx)(l().A,{caption:C,imageURL:u,imageWidth:v.width,imageHeight:v.height,imageContainerStyle:f}):C})}},981667:(e,t,o)=>{o.r(t),o.d(t,{TableHeaderCellMenu:()=>W,getIsAutofillCurrentlyRunning:()=>U});o(944114),o(898992),o(672577),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(847249),a=()=>o(401497),l=()=>o(970013),s=()=>o(713998),c=()=>o(340498),d=o(474848);const p={viewBox:"0 0 20 20",svg:(0,d.jsx)("path",{d:"M16.975 3.525c.345 0 .625.28.625.625v11.7a.625.625 0 1 1-1.25 0V4.15c0-.345.28-.625.625-.625M9.658 5.158a.625.625 0 0 1 .884 0l4.4 4.4a.625.625 0 0 1 0 .884l-4.4 4.4a.625.625 0 1 1-.884-.884l3.333-3.333H3.025a.625.625 0 1 1 0-1.25h9.966L9.658 6.042a.625.625 0 0 1 0-.884"})},u=(0,c().wt)("arrowLineRight",p);const m={viewBox:"0 0 20 20",svg:(0,d.jsx)("path",{d:"m4.897 3.085-.122-.142a.625.625 0 0 0-.95.814l3.56 4.152-.013.131a4.625 4.625 0 0 0-2.997 4.33V13c0 .345.28.625.625.625h4.13v3.08c0 .158.035.317.1.46l.433.94a.35.35 0 0 0 .565.103l.063-.087.44-.956c.065-.142.1-.3.1-.46v-3.08h1.453l2.941 3.432a.625.625 0 0 0 1.042-.67L4.989 3.228a.6.6 0 0 1-.093-.144m3.258 6.007a.6.6 0 0 0 .169-.088l2.889 3.371H5.625v-.006c0-1.447.922-2.733 2.293-3.197zm7.259 4.379a.62.62 0 0 0 .212-.47v-.63a4.625 4.625 0 0 0-2.997-4.33l-.157-1.603.289-.258a3.63 3.63 0 0 0 1.212-2.705V3a.625.625 0 0 0-.625-.625H6.653a.62.62 0 0 0-.516.272l1.216 1.419a2.4 2.4 0 0 1-.07-.441h5.434a2.38 2.38 0 0 1-.79 1.621l-.525.47a.63.63 0 0 0-.206.527l.227 2.318a.63.63 0 0 0 .422.531l.237.08a3.375 3.375 0 0 1 2.291 3.084z"})},g=(0,c().wt)("pinSlash",m);var y=()=>o(798880),f=()=>o(959013),S=()=>o(496603),h=()=>o(534177),b=()=>o(416726),v=()=>o(901952),x=()=>o(436696),A=()=>o(187899),C=()=>o(235191),w=()=>o(686526),T=()=>o(4319),I=()=>o(751156),_=()=>o(673964),j=()=>o(419167),k=()=>o(760217),P=()=>o(928600),M=()=>o(939740),B=()=>o(8980),D=()=>o(89924),F=()=>o(859428),R=()=>o(662971),O=()=>o(673730),K=()=>o(68465),E=()=>o(722872),N=()=>o(553965),z=()=>o(963589),H=()=>o(962730);function V(e){const{property:t,propertySchema:a,extensionPopupButtonEvents:l,parent:s}=e,{isMobile:c}=(0,i().Y0)(),p=(0,f().tz)(),u=(0,o(175116).ET)(),m=(0,i().v3)(),g=(0,r().K8)((()=>u.collectionStore()),[u]),y=(0,n.useCallback)((e=>{g&&I().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:m,canUndo:!0,perform:o=>{C().Hj({environment:m,collectionStore:g,property:t,type:e,transaction:o})}})}),[g,m,t]),S=(0,o(135986).Re)({environment:m,collectionContextStore:u,propertySchema:a,onAccept:y,intl:p,section:"all"});let h;return h=c?{menuType:E().gu.ActionSheet}:{menuType:E().gu.Popup,width:200,height:400},(0,d.jsx)(P().A,{...h,...l,children:(0,d.jsx)(M().Ay,{type:M().Oh.Vertical,initialFocus:0,sections:[{key:"standard",render:e=>(0,d.jsx)(D().A,{...e}),items:Object.values(S)}],onAccept:s.close})})}function U(e){const{taskRunningState:t}=e;switch(t.status){case"requested":return!0;case"running":return t.numPagesFilled<t.numPagesRequested;case"error":case"notRunning":return!1;default:(0,h().HB)(t)}}const W=n.memo((function(e){const{allowHidingTitle:t,collectionContextStore:c,columnIndex:p,format:m,formatKey:W,parent:$,property:Y,schema:X}=e,J=(0,f().tz)(),Q=(0,i().v3)(),{isPhone:Z,isMobile:ee}=(0,i().Y0)(),te=(0,z().X)("db_ux_empty_states"),oe=(0,z().X)("db_ux_properties"),ne=(0,z().X)("nds_default_property_noticon"),ie=(0,a().DP)(),{collectionStore:re,collectionViewStore:ae,collectionSettingsStore:le,query:se,isNonEditableState:ce,collectionStoreFormat:de}=(0,r().K8)((()=>{const e=c.collectionStore(),t=c.collectionViewStore(),o=c.settingsStore,n=c.normalizedQueryStore.state,i=null==e?void 0:e.isNonEditableState(),r=null==e?void 0:e.getFormat();return{collectionStore:e,collectionViewStore:t,collectionSettingsStore:o,query:n,isNonEditableState:i,collectionStoreFormat:r}}),[c]),pe=(0,r().O$)(c.permissionScopesStore),ue=(0,r().O$)(c.isInHomeWidgetStore),me=(0,r().K8)((()=>null==ae?void 0:ae.getType()),[ae]),ge=(0,r().K8)((()=>"collectionTypedView"===c.contextType),[c]),ye=!(0,r().O$)(o(227440).e),fe=(0,r().K8)((()=>{const{frozenIndex:e}=c.frozoneStore.state;return Boolean(p===e)}),[c,p]),Se=(0,r().K8)((()=>{const{frozenIndex:e,scrollerWidth:t}=c.frozoneStore.state;if(void 0===e)return!1;const o=(null==ae?void 0:ae.getTableMaxFrozenColumnIndex(t,c.normalizedFormatStore.state))??-1;return p>o}),[c,ae,p]),he=(0,r().K8)((()=>{var e;return!(!ae||"timeline"===me)&&Boolean(ae.getFormat().table_wrap||(null===(e=G({format:m,formatKey:W,property:Y}))||void 0===e?void 0:e.wrap))}),[ae,m,W,Y,me]),be=(0,n.useMemo)((()=>o(651124).Ts(de,Y)),[de,Y]),ve=(0,r().K8)((()=>null==re?void 0:re.getSpaceId()),[re]),xe=(0,o(577437)._X)({name:"collection_property_autofill",spaceId:ve,userId:Q.currentUser.id,amount:"unknown"}),Ae=(0,r().K8)((()=>!re||(!!ye||(!(0,K().jq)(Q,o(411671).A.getMode(Q,re),re)||!!be&&U({taskRunningState:be})))),[re,Q,be,ye]),Ce=(0,r().K8)((()=>(0,K().O0)(Q)),[Q]),{isTypedProperty:we,databaseType:Te}=(0,r().K8)((()=>re?{isTypedProperty:re.isTypedProperty(Y),databaseType:re.getDatabaseType()}:{isTypedProperty:!1,databaseType:void 0}),[re,Y]),Ie=(0,r().uB)(void 0,o(463830).A),_e=(0,r().K8)((()=>{const e=X[Y];return o(685889).pg(c,e)}),[c,Y,X]),[je,ke]=(0,n.useState)(!1),[Pe,Me]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=X[Y];e&&Me(e.name||"")}),[Y,X]),(0,n.useEffect)((()=>{const e=X[Y];e&&"relation"===e.type&&(null==_e||_e.load())}),[Y,X,_e]);const Be=(0,n.useCallback)((e=>{!function(e){const{collectionContextStore:t,environment:o,inputValue:n,name:i,property:r,schema:a}=e;if(q({property:r,schema:a,inputValue:n}))return;const l=t.collectionStore();if(!l)return;const s=l.getSchema(),c=s[r];if((null==c?void 0:c.name)===i)return;I().createAndCommit({userAction:"TableHeaderCell.handlePropertyNameSubmit",environment:o,canUndo:!0,perform:e=>{C().YO({collectionStore:l,property:r,name:i,transaction:e})}}),(0,v().V)({environment:o,collectionContextStore:t,property:r,from:"view_settings",action:"rename"})}({collectionContextStore:c,environment:Q,inputValue:Pe,name:e,property:Y,schema:X})}),[c,Q,Pe,Y,X]),De=(0,n.useCallback)((e=>{Me(e)}),[]),Fe=(0,a().IS)((e=>({rightStyle:{display:"flex",alignItems:"center",color:e.text.tertiary,fill:e.lightIconColor,flexShrink:0},rightIconStyle:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out"}})),[]),Re=(0,r().K8)((()=>{const e=X[Y];if(!ae||!e)return[];const n=(0,o(443239).u)(Y),i="title"===e.type,r=[];if(n&&"person"===e.type){const t=[];r.push(t),t.push({key:"synced_person",render:t=>(0,d.jsx)(o(678553).Ay,{...t,title:e.name||"",icon:(0,d.jsx)(B().I,{icon:o(525884).A}),caption:(0,d.jsx)("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",minWidth:300,maxWidth:350},children:(0,d.jsx)(f().sA,{defaultMessage:"People synced from external sources may require additional set up. Visit <helpcenterlink>the help center</helpcenterlink> for more information.",id:"database.tableHeaderCell.syncedPersonPropertyCaption",values:{helpcenterlink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,d.jsx)(o(719147).A,{href:(0,o(836251).xS)("guides.syncedContent"),children:t})}}})})}),action:()=>{}})}const a=[];r.push(a),!pe.canConfigureCollection||n||pe.isExternallyImportedAndSyncedCollection||(a.push({key:"rename",render:t=>(0,d.jsx)("div",{style:ee?{}:{paddingTop:4},children:(0,d.jsx)(o(755735).B,{...t,initialValue:e.name||"",placeholder:o(972435).A.formatMessage(o(913687).A.inputPlaceholder),focusInitial:!ee,onChange:De,onBlur:Be,onSubmit:Be,iconButton:{icon:t=>(0,d.jsx)(o(743176).zB,{type:e.type,icon:e.icon,size:16,theme:ie,style:t,isDefaultNoticonEnabled:ne}),iconStyle:{fill:o(278238).l8[ie.mode].gray},enforceIconColor:"gray",onSubmit:(e,t)=>function(e,t,o,n,i){const r=t.collectionStore();if(!r)return;I().createAndCommit({userAction:"TableHeaderCell.handlePropertyIconSubmit",environment:o,canUndo:!0,perform:t=>{C().yC({collectionStore:r,property:e,icon:n,transaction:t})}}),(0,v().V)({environment:o,collectionContextStore:t,property:e,icon:n,from:"table",action:"change_icon"})}(Y,c,Q,e)},inputRightButton:(0,d.jsx)(o(539148).S,{description:e.description,showTooltip:!je,onClick:()=>ke(!je),addDescriptionText:J.formatMessage(O().Mo.addPropertyDescriptionTooltip),editDescriptionText:J.formatMessage(O().Mo.editPropertyDescriptionTooltip)})})}),action:()=>{(0,x().X)({environment:Q,collectionContextStore:c,action:"table_header_rename"}),(0,_().j)({collectionContextStore:c,environment:Q,fit:"settings"}),$.close()}}),je&&a.push({key:"description",render:t=>(0,d.jsx)(o(705602).y,{...t,initialDescription:e.description,handleSaveDescription:e=>function(e){var t;const{collectionContextStore:n,description:i,environment:r,property:a}=e,l=n.collectionStore(),s=null==l||null===(t=l.getSchema())||void 0===t?void 0:t[a];if(!l||void 0===s||i===s.description)return;I().createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:r,canUndo:!0,perform:e=>{(0,o(312296).F)({environment:r,collectionStore:l,update:{[a]:{...s,description:i}},transaction:e})}}),(0,v().V)({environment:r,collectionContextStore:n,property:a,from:"view_properties",action:"set_description"})}({collectionContextStore:c,description:e,environment:Q,property:Y}),disableAutoSection:!0}),action:S().lQ}),q({property:Y,schema:X,inputValue:Pe})&&a.push({key:"duplicate_error",render:e=>(0,d.jsx)(o(653259).A,{...e,propertyName:Pe,styles:ee?{paddingBottom:5,paddingLeft:16,paddingRight:16,margin:0,boxShadow:`inset 0 -1px 0 ${ie.regularDividerColor}`}:{}}),action:S().lQ}));const K=[];if(r.push(K),K.push({key:"connected_property_upsell",render:()=>(0,d.jsx)(o(474434).k,{collectionContextStore:c,property:Y,compact:!0}),action:()=>{$.close()}}),pe.canConfigureBlock&&!n&&!ce&&!pe.isExternallyImportedAndSyncedCollection)if((0,l().nu)(e)&&!oe){const t=ge||(0,s().Jf)({property:Y,propertySchema:e,isTypedProperty:we});K.push({key:"button_property_change_type",render:e=>(0,d.jsx)(F().A,{placement:H().W.Left,render:n=>(0,d.jsx)("div",{...(0,N().A)(e,n),role:"button",children:(0,d.jsx)(o(59400).Dy,{disabled:t,isTypedProperty:we,collectionUri:Te,collectionContextStore:c,formatKey:W,propertyTypeButtonPopupStore:Ie,property:Y})}),style:{whiteSpace:"normal"},renderTooltip:()=>(0,d.jsx)(f().sA,{defaultMessage:"Change property type",id:"database.tableHeaderCell.buttonPropertyChangeTypeTooltip"})}),action:()=>{$.close()}}),K.push({key:"button_property_edit_automation",render:e=>(0,d.jsx)(F().A,{placement:H().W.Left,render:t=>(0,d.jsx)(k().A,{title:(0,d.jsx)(f().sA,{defaultMessage:"Edit automation",id:"database.tableHeaderCell.buttonPropertyEditAutomationLeft"}),right:(0,d.jsx)("div",{style:Fe.rightStyle,children:(0,o(742117).V)(Fe.rightIconStyle)}),...(0,N().A)(e,t)}),style:{whiteSpace:"normal"},renderTooltip:()=>(0,d.jsx)(f().sA,{defaultMessage:"Edit button automation",id:"database.tableHeaderCell.buttonPropertyTooltip"})}),action:()=>{$.close(),o(837570).h({environment:Q,mode:"edit_button_property",collectionSettingsStore:le,collectionContextStore:c,propertyId:Y,propertySchema:e})}})}else{const t=!pe.canConfigureCollection;K.push({key:"edit_property",render:e=>(0,d.jsx)(F().A,{placement:H().W.Left,render:n=>(0,d.jsx)(k().A,{buttonStyle:{opacity:t?.5:1},disabled:t,title:(0,d.jsx)(f().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:t?(0,d.jsx)(B().I,{icon:o(90907).lockIcon}):(0,d.jsx)(B().I,{icon:o(735790).M}),...(0,N().A)(e,n)}),style:{whiteSpace:"normal"},renderTooltip:()=>t?(0,d.jsx)(f().sA,{defaultMessage:"You don't have permission to edit this property",id:"database.tableHeaderCell.editPropertyTooltipDisabled"}):(0,d.jsx)(f().sA,{defaultMessage:"Edit property name, type, and other options...",id:"database.tableHeaderCell.editPropertyTooltip"})}),action:()=>{(0,x().X)({environment:Q,collectionContextStore:c,action:"table_header_edit"}),(0,_().j)({collectionContextStore:c,environment:Q,fit:"settings"}),$.close(),w().Ow({collectionContextStore:c,collectionSettingsStore:le,initialStack:[{type:"properties",timelineViewTab:"table"},{type:"property",formatKey:W,property:Y}]})}});const n=ge||(0,s().Jf)({property:Y,propertySchema:e,isTypedProperty:we});oe&&!n&&K.push({key:"change_property_type",render:(t,n)=>(0,d.jsx)(R().A,{...t,renderOrigin:(e,t)=>(0,d.jsx)(k().A,{...e,ref:t,title:(0,d.jsx)(f().sA,{defaultMessage:"Change type",id:"database.tableHeaderCell.changePropertyType"}),icon:(0,d.jsx)(B().I,{icon:o(3284).arrowSquarePathUpDownIcon})}),renderExtension:t=>(0,d.jsx)(V,{property:Y,propertySchema:e,extensionPopupButtonEvents:t,parent:$}),onFocus:n.onFocus}),action:()=>{$.close()}})}if(pe.canConfigureCollection&&!n&&!pe.isExternallyImportedAndSyncedCollection&&re&&be&&Ce&&(0,l().$M)(e)){const t=(0,l().om)(e),n=U({taskRunningState:be});t?K.push({key:"fill_all_pages",render:t=>(0,d.jsx)(F().A,{placement:H().W.Left,renderTooltip:()=>ye?(0,d.jsx)(f().sA,{...b().AY.aiUnavailableOfflineTooltip}):(0,d.jsx)(j().GI,{collectionStore:re,propertySchema:e,autofillFeatureAvailability:xe}),render:e=>(0,d.jsx)(k().A,{titleStyle:{color:Ae?ie.text.tertiary:void 0},disabled:Ae,icon:(0,d.jsx)(j().am,{updateAiInferencesTaskStatus:be,progressIconStyle:{marginTop:1,marginLeft:0,marginRight:-3}}),title:(0,d.jsx)(j().Ay,{updateAiInferencesTaskStatus:be}),caption:n&&"requested"!==be.status&&(0,d.jsx)(j().jD,{updateAiInferencesTaskStatus:be}),...(0,N().A)(t,e)})}),action:async()=>{await o(312540).autofillPropertyForCollection({environment:Q,collectionStore:re,propertySchema:e,property:Y,collectionViewStore:ae})}}):K.push({key:"autofill_with_ai",render:e=>(0,d.jsx)(F().A,{placement:H().W.Left,renderTooltip:()=>{if(ye)return(0,d.jsx)(f().sA,{...b().AY.aiUnavailableOfflineTooltip})},disableTooltip:!ye,render:t=>(0,d.jsx)(k().A,{disabled:void 0===re||ye,disabledFeedback:void 0===re||ye,title:(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,d.jsx)(f().sA,{defaultMessage:"Set up AI autofill",id:"database.tableHeaderCell.autofillWithAI"}),(0,d.jsx)(o(515918).A,{style:{display:"inline-block"}})]}),icon:(0,d.jsx)(B().I,{icon:o(116089).magicWandIcon,color:"purplePrimary"}),...e,...t})}),action:()=>{re&&($.close(),w().Ow({collectionContextStore:c,collectionSettingsStore:le}),w().a2({collectionSettingsStore:le,item:{type:"properties",timelineViewTab:"table"}}),w().a2({collectionSettingsStore:le,item:{type:"property",formatKey:W,property:Y}}),"text"===e.type&&w().a2({collectionSettingsStore:le,item:{type:"propertyAiAutofill",propertySchema:e,property:Y}}))}})}const z=[];if(pe.canConfigureBlock&&((0,s().oH)(e)||(0,s().ah)(e))){r.push(z),(0,s().ah)(e)&&z.push({key:"filter",render:e=>(0,d.jsx)(k().A,{...e,title:(0,d.jsx)(f().sA,{defaultMessage:"Filter",id:"database.tableHeaderCell.filter"}),icon:(0,d.jsx)(B().I,{icon:o(170350).S})}),action:()=>{"collectionSystemView"!==c.contextType&&((0,x().X)({environment:Q,collectionContextStore:c,action:"table_header_filter"}),$.close(),function(e){const{collectionContextStore:t,environment:o,property:n,schema:i}=e,r=A().m({property:n,collectionContextStore:t,environment:o,schema:i});if(!r)return;const a=t.isInHomeWidgetStore.state;if(a)return void w().R8({collectionSettingsStore:t.settingsStore,item:{type:"filters"}});t.filtersBarOpenStore.setState(!0);const l=t.getFilterBarItemSettingsStore(r);w().R8({collectionSettingsStore:l,item:{type:"filter"}}),(0,_().j)({collectionContextStore:t,environment:o,fit:"filtersBar"})}({collectionContextStore:c,environment:Q,property:Y,schema:X}))}});const t={key:"sort_asc",render:e=>(0,d.jsx)(k().A,{...e,title:(0,d.jsx)(f().sA,{defaultMessage:"Sort ascending",id:"database.tableHeaderCell.sortAscending"}),icon:(0,d.jsx)(B().I,{icon:o(112282).s})}),action:()=>{(0,x().X)({environment:Q,collectionContextStore:c,action:"table_header_sort_asc"}),$.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:i}=e;L({collectionContextStore:o,environment:i,isAscending:!0,property:t,schema:n})}({collectionContextStore:c,environment:Q,property:Y,schema:X})}},n={key:"sort_desc",render:e=>(0,d.jsx)(k().A,{...e,title:(0,d.jsx)(f().sA,{defaultMessage:"Sort descending",id:"database.tableHeaderCell.sortDescending"}),icon:(0,d.jsx)(B().I,{icon:o(655923).v})}),action:()=>{(0,x().X)({environment:Q,collectionContextStore:c,action:"table_header_sort_desc"}),$.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:i}=e;L({collectionContextStore:o,environment:i,isAscending:!1,property:t,schema:n})}({collectionContextStore:c,environment:Q,property:Y,schema:X})}};(0,s().oH)(e)&&(oe?z.push({key:"sort",render:(e,i)=>(0,d.jsx)(R().A,{...e,renderOrigin:(e,t)=>(0,d.jsx)(k().A,{...e,ref:t,title:(0,d.jsx)(f().sA,{defaultMessage:"Sort",id:"database.tableHeaderCell.sort"}),icon:(0,d.jsx)(B().I,{icon:o(582684).C})}),renderExtension:e=>{let o;return o=Q.device.isMobile?{menuType:E().gu.ActionSheet}:{menuType:E().gu.Popup,width:200},(0,d.jsx)(P().A,{...o,...e,children:(0,d.jsx)(M().Ay,{type:M().Oh.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,d.jsx)(D().A,{...e}),items:[t,n]}],onAccept:$.close})})},onFocus:i.onFocus}),action:()=>{}}):(z.push(t),z.push(n))),te&&se&&z.push({key:"calculate",render:(e,t)=>(0,d.jsx)(R().A,{...e,renderOrigin:(e,t)=>(0,d.jsx)(k().A,{...e,ref:t,title:(0,d.jsx)(f().sA,{defaultMessage:"Calculate",id:"database.tableHeaderCell.calculate"}),icon:(0,d.jsx)(B().I,{icon:o(311894).K})}),renderExtension:(e,t)=>{var n;return(0,d.jsx)(o(195071).A,{property:Y,schema:X,currentAggregation:null===(n=se.aggregations)||void 0===n?void 0:n.find((e=>e.property===Y)),onChange:(e,t)=>{const n=e?{aggregator:e,property:Y,enforceMaxAggregationLimit:t}:void 0;(0,o(500733).I)({collectionContextStore:c,environment:Q,query:se,property:Y,newAggregation:n})},onClose:$.close,source:"tableAggregation"})},onFocus:t.onFocus}),action:()=>{}})}!pe.canConfigureBlock||ue||Z||z.push({key:"freeze_column",render:e=>(0,d.jsx)(F().A,{placement:H().W.Left,disableTooltip:!Se,renderTooltip:e=>(0,d.jsx)(f().sA,{...e,defaultMessage:"Insufficient space to freeze columns",id:"database.tableHeaderCell.freezePropertyTooltip",description:"If the width of the frozen columns is wider than the screen, show the user this tooltip warning."}),render:t=>(0,d.jsx)(k().A,{...e,...t,disabled:Se,buttonStyle:{color:Se?ie.text.quaternary:void 0},title:fe?(0,d.jsx)(f().sA,{defaultMessage:"{numberFrozenColumns, plural, one {Unfreeze column} other {Unfreeze columns}}",values:{numberFrozenColumns:p+1},id:"database.tableHeaderCell.unfreezeColumns"}):oe?(0,d.jsx)(f().sA,{defaultMessage:"Freeze",id:"database.tableHeaderCell.freeze"}):(0,d.jsx)(f().sA,{defaultMessage:"Freeze up to column",id:"database.tableHeaderCell.freezeUpToColumn"}),icon:fe?(0,d.jsx)(B().I,{icon:g}):(0,d.jsx)(B().I,{icon:o(230979).N})})}),action:()=>{!function(e){const{collectionContextStore:t,columnIndex:o,environment:n}=e;I().createAndCommit({userAction:"TableHeaderCell.handleFreezeColumns",environment:n,canUndo:!0,perform:e=>{T().sp({environment:n,collectionContextStore:t,currentIndex:o,transaction:e,entrypoint:"TableHeaderCell",propertyAction:"toggle"})}})}({collectionContextStore:c,columnIndex:p,environment:Q})}}),(t||"title"!==e.type)&&pe.canConfigureBlock&&z.push({key:"hide",render:e=>(0,d.jsx)(k().A,{...e,title:oe?(0,d.jsx)(f().sA,{defaultMessage:"Hide",id:"database.tableHeaderCell.hide"}):(0,d.jsx)(f().sA,{defaultMessage:"Hide in view",id:"database.tableHeaderCell.hideInView"}),icon:(0,d.jsx)(B().I,{icon:o(566910).e})}),action:()=>{(0,x().X)({environment:Q,collectionContextStore:c,action:"table_header_hide"}),$.close(),function(e){const{collectionContextStore:t,columnIndex:n,environment:i,format:r,formatKey:a,property:l}=e,s=t.collectionViewStore();if(!s)return;const c=r[a]||[],d=c.map((e=>e.property===l?{...e,visible:!1}:e)),p={...r,[a]:d};I().createAndCommit({userAction:"TableHeaderCell.updatePropertyFormat",environment:i,canUndo:!0,perform:e=>{(0,o(654062).F)({collectionViewStore:s,update:{format:p},transaction:e}),T().sp({environment:i,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"hide"})}})}({collectionContextStore:c,columnIndex:p,environment:Q,format:m,formatKey:W,property:Y})}}),pe.canConfigureBlock&&"timeline"!==me&&z.push({key:"wrap_cell",render:e=>(0,d.jsx)(k().A,{...e,title:he?(0,d.jsx)(f().sA,{defaultMessage:"Unwrap text",id:"database.tableHeaderCell.unwrapText"}):(0,d.jsx)(f().sA,{defaultMessage:"Wrap text",id:"database.tableHeaderCell.wrapText"}),icon:(0,d.jsx)(B().I,{icon:he?u:o(871114).o})}),action:()=>{T().Nv({currentValue:he,environment:Q,property:Y,collectionViewStore:ae,format:m,formatKey:W}),$.close(),(0,x().X)({environment:Q,collectionContextStore:c,action:"table_header_wrap_column"})}});const de=[];return r.push(de),!(0,l().vB)(e)||!pe.canConfigureCollection||n||i||pe.isExternallyImportedAndSyncedCollection||de.push({key:"duplicate",render:e=>(0,d.jsx)(k().A,{...e,title:(0,d.jsx)(f().sA,{defaultMessage:"Duplicate property",id:"database.tableHeaderCell.duplicateProperty"}),icon:(0,d.jsx)(B().I,{icon:o(764781).V})}),action:async()=>{(0,x().X)({environment:Q,collectionContextStore:c,action:"table_header_duplicate"}),$.close(),await async function(e){const{collectionContextStore:t,columnIndex:n,environment:i,format:r,formatKey:a,property:l}=e,s=G({format:r,formatKey:a,property:l}),c=t.collectionStore(),d=t.collectionViewStore(),p=t.normalizedFormatStore.state[a]||[],u=null==c?void 0:c.getSpaceId();if(!(c&&d&&u&&s))return;const m=c.getSchema(),g=m[l];if(!g)return;const f=c.getNormalizedPropertyGroups(),S=await(0,o(519839).W4)({environment:i,schema:m,property:l,properties:p,propertyGroups:f,parentStore:c,spaceId:u});if(!S)return;const b=i.currentUser.id,v=b?{id:b,table:y().oo}:void 0,{automationActions:A}=await o(813297).QV.automations.load(),C={...m,[S.newProperty]:S.newPropertySchema},w=c.getFormat(),_={...w,collection_page_properties:S.newProperties,property_groups:S.newPropertyGroups};I().createAndCommit({userAction:"TableHeaderCell.handleDuplicate",environment:i,canUndo:!0,perform:e=>{(0,o(797535).I)({environment:i,collectionStore:c,update:{schema:C,format:_},transaction:e}),T().sp({environment:i,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"duplicate"}),(0,h().O9)(S.automationUpdate)&&A.duplicateAutomation({actorPointer:v,environment:i,sourceAutomationStore:S.automationUpdate.sourceAutomationStore,targetAutomationId:S.automationUpdate.targetAutomationId,transaction:e}),a&&o(896628).zA({stores:[d],update:{[a]:S.newProperties},transaction:e})}}),(0,x().X)({environment:i,collectionContextStore:t,action:"duplicate_property",original_view_type:null==d?void 0:d.getType(),property_type:g.type})}({collectionContextStore:c,columnIndex:p,environment:Q,format:m,formatKey:W,property:Y})}}),!l().cN.includes(e.type)||!pe.canConfigureCollection||n||i||pe.isExternallyImportedAndSyncedCollection||de.push({key:"delete",render:e=>(0,d.jsx)(o(437426).$,{...e,property:Y,collectionContextStore:c}),action:async()=>{$.close(),await(0,o(358354).I)({collectionContextStore:c,columnIndex:p,updateFrozenColumnEntrypoint:"TableHeaderCell",updateFrozenColumn:!0,environment:Q,property:Y,schema:X,theme:ie,from:"table_column"})}}),r}),[te,oe,ne,se,t,xe,Ie,Se,c,le,re,ae,p,Te,Q,m,W,De,Be,Pe,J,Ae,Ce,ue,ee,ge,ce,ye,Z,fe,we,$,pe.canConfigureBlock,pe.canConfigureCollection,pe.isExternallyImportedAndSyncedCollection,Y,X,je,Fe.rightIconStyle,Fe.rightStyle,be,ie,me,he]),Oe=(0,n.useMemo)((()=>S().oE(Re.map(((e,t)=>{if(e.length>0)return{key:t,render:e=>(0,d.jsx)(D().A,{...e,topBorder:0!==t&&1!==t,style:0===t?{padding:0}:{}}),items:e}})))),[Re]),Ke=ee?{menuType:E().gu.Modal,minWidth:void 0,title:(0,d.jsx)(f().sA,{id:"database.tableHeaderCell.title",defaultMessage:"Edit property"})}:{menuType:E().gu.Popup,minWidth:220};return(0,d.jsx)(P().A,{...Ke,children:(0,d.jsx)(M().Ay,{type:M().Oh.Vertical,initialFocus:void 0,sections:Oe})})}));function L(e){const{collectionContextStore:t,environment:o,isAscending:n,property:i,schema:r}=e;if(!r[i])return;const a=[{property:i,direction:n?"ascending":"descending"}];t.filtersBarOpenStore.setState(!0),A().IU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:a}}}),(0,_().j)({collectionContextStore:t,environment:o,fit:"filtersBar"})}function G(e){var t;const{format:o,formatKey:n,property:i}=e;return null===(t=o[n])||void 0===t?void 0:t.find((e=>e.property===i))}function q(e){const{inputValue:t,property:o,schema:n}=e,i=Object.keys(n).find((e=>{var i;return e!==o&&(null===(i=n[e])||void 0===i?void 0:i.name)===t}));return Boolean(i)}}}]);