"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[16697,90871],{53528:(e,t,n)=>{n.d(t,{OH:()=>s,T2:()=>l,do:()=>c});var o=()=>n(597777),r=()=>n(869190),i=()=>n(604995),a=()=>n(416504);function s(e){const{dateTime:t,intl:n,shortenDateAndRange:o}=e,a=i().C6.toPersistedDate(t.valueOf());return r().ZF({value:a,allowRelativeDates:!0,intl:n,shortenDateAndRange:o,displayInUserTimezone:!0})}function l(e){const{dateTime:t,intl:n,userTimeZone:o,displayInUserTimezone:a,alwaysIncludeTimezone:s}=e,l=i().C6.toPersistedDateTime(t.valueOf(),t.zoneName);return r().ZF({value:l,allowRelativeDates:!0,intl:n,userTimeZone:o,displayInUserTimezone:a,alwaysIncludeTimezone:s})}function c(e){const{luxonRange:t,intl:n}=e,s=i().C6.toPersistedDateRange(t),l=r().ZF({value:s,allowRelativeDates:!1,shortenDateAndRange:!0,intl:n,displayInUserTimezone:!0}),c=t.end.setZone((0,a().P)()),d=r().fU({start_time:c.toFormat(o().GE),humanReadable:!1,intl:n});return n.formatMessage({id:"verification.timeRange",defaultMessage:"{formattedDateRange} at {formattedEndTime}"},{formattedDateRange:l,formattedEndTime:d})}},97059:(e,t,n)=>{n.d(t,{W:()=>y,w:()=>f});n(944114);var o=()=>n(585515),r=()=>n(577449),i=()=>n(161479),a=()=>n(545285),s=()=>n(763824),l=()=>n(780054),c=()=>n(870618),d=()=>n(670631),u=()=>n(227440),p=()=>n(508496),m=()=>n(540758);async function f(e){const{environment:t}=e;return(await s().lX(Object.keys(d().A.state.offlinePages||{}),100,(e=>async function(e){const{environment:t,pageId:n}=e,s={page:{id:n,spaceId:(0,i().e)(void 0)},baseUrl:l().A.domainBaseUrl,publicDomainName:l().A.publicDomainName,shouldTraverseToggleBlocks:!0,limit:1/0,cursor:{stack:[]},verticalColumns:!1},d=[];return await o().T(s,r().h.sideEffect((e=>((0,a().u)(e)&&d.push(e.id),Promise.resolve())),r().h.fromMonomorphicFunctionUnsafe((async e=>{const n=await c().h7({environment:t,pointer:e,useInMemoryCacheOnly:!1,skipAccessWrites:!0});return null==n?void 0:n.model})))),d}({environment:t,pageId:e})))).flat()}function y(e,t){return!u().A.state.online&&(e.device.isElectron||e.device.isMobileNative)&&p().default.checkGate({gateName:"download_for_offline"})&&!(0,m().Bd)(t)}},105819:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,pencilLineIcon:()=>r});n(296540);const o={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"m13.987 5.682-.684.684-1.288-1.288.692-.691a.91.91 0 0 1 1.28 0c.35.35.35.93 0 1.28zm-9.433 9.433 7.914-7.914-1.289-1.289-7.92 7.908c-.122.122-.214.29-.274.457l-.336 1.082c-.06.229.153.442.366.366l1.082-.335q.252-.07.457-.275m12.446.76H5.61l1.25-1.25H17a.625.625 0 1 1 0 1.25"})},r=(0,n(340498).wt)("pencilLine",o)},175116:(e,t,n)=>{n.d(t,{ET:()=>l,Ks:()=>c,RI:()=>s,p2:()=>a});n(16280);var o=n(296540);const r="collectionContextStore",i=(0,n(446943).C)({displayName:r,legacyContextKey:r,modernContextDefaultValue:void 0}),a=i.context,s=i.Provider;function l(){const e=o.useContext(a);if(void 0===e)throw new Error(`No context provided: ${r}`);return e}function c(){return o.useContext(a)}},178846:(e,t,n)=>{n.d(t,{xA:()=>S});var o=n(296540),r=()=>n(221844),i=()=>n(484714),a=()=>n(847249),s=()=>n(179034),l=()=>n(743246),c=()=>n(896628),d=()=>n(246826),u=()=>n(751156),p=()=>n(594794),m=()=>n(589994),f=()=>n(847),y=()=>n(363186),g=()=>n(671446);const v="workflowDataCache",h="userEditsCache";function S(e){const{collectionViewBlockStore:t}=e,n=(0,i().v3)(),{threadStore:S,workflowStore:w}=(0,y().$O)(),_=(0,g().J)(),b=(0,a().K8)((()=>{var e;if(!w)return;const t=null===(e=w.getData())||void 0===e?void 0:e.versionPointer,n=null==_?void 0:_.versionPointer;return(null==t?void 0:t.id)===(null==n?void 0:n.id)}),[w,_]),C=(0,a().K8)((()=>t.getSpaceId()),[t]),[x,k]=(0,o.useState)([]),T=(0,o.useCallback)((e=>{k((t=>[...t,e.operation]))}),[]),A=(0,o.useMemo)((()=>{const e=new(r().A)({isTemporaryData:!0,name:v});return e.addCacheFallback(n.defaultRecordCache.inMemoryRecordCache),e}),[n.defaultRecordCache.inMemoryRecordCache]),P=(0,o.useMemo)((()=>{const e=new(r().A)({isTemporaryData:!0,name:h});return e.addCacheFallback(A),e.onOperationCallback=T,e}),[T,A]),M=(0,o.useMemo)((()=>t.clone(A)),[t,A]),I=(0,o.useMemo)((()=>M.clone(P)),[M,P]);return(0,o.useEffect)((()=>{0!==x.length&&w&&w.getData()&&(m().transactionQueue.drain().then((()=>{f().addUnsavedOperations({environment:n,threadStore:S,workflowStore:w,collectionViewBlockStore:t,operations:x})})),k((e=>e.slice(x.length))))}),[n,w,S,x,t]),(0,o.useEffect)((()=>{A.clearCache(),P.clearCache(),k([]),_&&!b&&u().createAndCommit({userAction:"workflowData",environment:n,perform:e=>{const t=d().vt({environment:n,table:l().C0,args:{id:(0,p().Z1)({environment:n,table:l().C0,spaceId:C}),data:_,parentPointer:{table:s().ev,id:M.id},space_id:C},inMemoryRecordCache:A,transaction:e});c().zA({stores:[M],update:{workflow_id:t.id},transaction:e}),f().updateDatabasesAndViews({environment:n,store:M,workflowStore:t,previousWorkflow:void 0,newWorkflow:_,transaction:e,performPushToDatabases:!0})},canUndo:!1})}),[n,C,P,_,A,M,b]),I}},258651:(e,t,n)=>{n.r(t),n.d(t,{WorkflowEditorCollectionViewPage:()=>p});var o=n(296540),r=()=>n(847249),i=()=>n(167780),a=()=>n(106412),s=()=>n(46986),l=(n(898992),n(354520),()=>n(890754));var c=()=>n(178846),d=()=>n(363186),u=n(474848);function p(e){const{store:t}=e;return(0,u.jsx)(d().X9,{store:t,children:(0,u.jsx)(m,{...e})})}function m(e){const{store:t}=e,n=(0,c().xA)({collectionViewBlockStore:t}),d=(0,r().K8)((()=>{var e;return null===(e=n.inMemoryRecordCache)||void 0===e?void 0:e.name}),[n]),p=function(e){const t=(0,l().useCurrentThreadStore)(),n=(0,r().K8)((()=>(null==t?void 0:t.getTranscript().filter((e=>"workflow"===e.type&&"initial-value"!==e.tag)))??[]),[t]),o=e?n.findIndex((t=>t.id===e.id)):n.length,i=n.slice(0,o);let a=0;for(let r=i.length-1;r>=0&&void 0===i[r].userAction;r--)a++;return a}(),m=!!(0,r().K8)((()=>(0,s().aj)()),[])&&p>0;return(0,u.jsx)(a().tx,{value:{isPreviewing:!0,disablePageLinks:!0,disableAllPointerEvents:m,hideTableAggregationRow:!1,hideViewBlockSource:!1,location:"app_builder"},children:(0,o.createElement)(i().A,{...e,key:d,store:n,productUseCase:"workflow_editor",paddingLeft:e.paddingLeft,paddingRight:e.paddingRight,forceLocalQueryCollection:!0})})}},299177:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{}}}const r=new o;n(604341).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",r);const i=r},324577:(e,t,n)=>{n.d(t,{Y:()=>r});var o=()=>n(847249);function r(e){return(0,o().K8)((()=>null==e?void 0:e.getWorkflowStore()),[e])}},363186:(e,t,n)=>{n.d(t,{$O:()=>c,HH:()=>d,J5:()=>l,X9:()=>u,_o:()=>s});n(16280),n(944114),n(898992),n(823215);var o=n(296540),r=()=>n(847249),i=()=>n(847),a=n(474848);const s=(0,o.createContext)(null);s.displayName="WorkflowEditorContext";const l=(0,o.createContext)(!1);function c(){const e=(0,o.useContext)(s);(0,o.useContext)(l);if(!e)throw new Error("useWorkflowEditorContext must be used inside WorkflowEditorContextProvider");return e}function d(){return(0,o.useContext)(s)??void 0}l.displayName="DisallowWorkflowEditorContext";const u=o.memo((function(e){let{children:t,store:l}=e;const c=(0,n(484714).v3)(),d=n(166442).Kd,u=(0,n(324577).Y)(l),[p,m]=(0,o.useState)(!1),f=(0,r().K8)((()=>(0,n(46986).sx)()),[]);u||p||!f||(m(!0),n(751156).createAndCommit({userAction:"WorkflowActions.createWorkflowForCollectionViewBlock",environment:c,canUndo:!0,perform:e=>{i().createWorkflowForCollectionViewBlock({environment:c,transaction:e,store:l}),e.postSubmitCallbacks.push((e=>{e||m(!1)}))}}));const y=(0,n(890754).useCurrentThreadStore)(),g=(0,o.useCallback)((e=>{if(!u)throw new Error("Cannot save trigger without a workflow store");i().saveTrigger({workflowStore:u,trigger:e,environment:c,threadStore:y})}),[c,y,u]),v=(0,o.useCallback)((e=>{if(!u)throw new Error("Cannot save trigger without a workflow store");i().saveTriggers({workflowStore:u,triggers:e,environment:c,threadStore:y})}),[c,y,u]),h=(0,o.useCallback)((e=>{if(!u)throw new Error("Cannot save module without a workflow store");i().saveModule({workflowStore:u,module:e,environment:c,threadStore:y})}),[c,y,u]),S=(0,o.useCallback)((e=>{if(!u)throw new Error("Cannot remove module without a workflow store");i().removeModule({environment:c,module:e,threadStore:y,workflowStore:u})}),[c,y,u]),w=(0,o.useCallback)((e=>{if(!u)throw new Error("Cannot add module without a workflow store");i().addModule({workflowStore:u,module:e,environment:c,threadStore:y})}),[c,y,u]),_=(0,o.useCallback)((e=>{if(!u)throw new Error("Cannot save config variable without a workflow store");i().saveConfigVariable({workflowStore:u,value:e,environment:c,threadStore:y})}),[c,y,u]),b=(0,o.useCallback)((e=>{const{functionStore:t,fn:n}=e;if(!u)throw new Error("Cannot save function without a workflow store");i().saveFunction({functionStore:t,fn:n,environment:c,threadStore:y,workflowStore:u})}),[c,y,u]),C=(0,o.useCallback)((e=>{const{functionStore:t,test:n}=e;if(!u)throw new Error("Cannot save test without a workflow store");i().saveTest({functionStore:t,environment:c,test:n,threadStore:y,workflowStore:u})}),[c,y,u]),x=(0,o.useMemo)((()=>({store:l,workflowStore:u,threadStore:y,clientStore:d,removeModule:S,saveTrigger:g,saveTriggers:v,saveModule:h,addModule:w,saveConfigVariable:_,saveFunction:b,saveTest:C,config:n(780054).A})),[d,S,g,v,h,w,_,b,C,l,y,u]),k=(0,r().K8)((()=>[l,...(null==l?void 0:l.getCollectionStores())??[],...(null==l?void 0:l.getCollectionViewStores())??[]].every((e=>e.isReady()))),[l]);return k?(0,a.jsx)(s.Provider,{value:x,children:t}):null}))},390527:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>R,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>C,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>b,MAX_RECURRENCE_INTERVAL:()=>v,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>h,RRULE_WEEKDAYS_MAP:()=>g,adjustedStartDateIfPossible:()=>k,areRecurrenceSchedulesEqual:()=>F,convertFromUnpersistedRecurrenceConfig:()=>N,convertToUnpersistedRecurrenceConfig:()=>D,getFormattedEndCondition:()=>I,getFormattedNextRecurrenceTime:()=>M,getNewEndTimestamp:()=>E,getNextDateUtc:()=>P,getRecurrenceAfter:()=>T,isRunningBetweenMidnightAnd3AM:()=>A,isValidRecurrenceInterval:()=>S,isValidRecurrenceNumberOfRuns:()=>w,rruleFromRecurrence:()=>_,templateAncestorsViolateRecurrenceNesting:()=>x});n(898992),n(354520),n(581454);var o=()=>n(244641);n(944114);function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(0===n.length)return e.map((e=>[e]));const i=[];for(const a of e)i.push(...r(n[0],...n.slice(1)).map((e=>[a,...e])));return i}var i=()=>n(496603),a=()=>n(534177),s=()=>n(720665),l=()=>n(597777),c=()=>n(869190),d=()=>n(416504),u=()=>n(402390);class p extends(()=>n(896346))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var m=()=>n(912720);const f=(0,n(959013).YK)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),y={day:p.DAILY,week:p.WEEKLY,month:p.MONTHLY,year:p.YEARLY},g={MO:p.MO,TU:p.TU,WE:p.WE,TH:p.TH,FR:p.FR,SA:p.SA,SU:p.SU},v=99,h=999;function S(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=v}function w(e){return(0,s().Et)(e)&&Number.isInteger(e)&&e>0&&e<=h}function _(e){const{start_date:t,frequency:n,interval:o,weekdays:i,timezone:s,hour:c,minute:d}=e,u="week"===n&&i?i.map((e=>g[e])):void 0,m={};return(0,a().O9)(e.end_condition)&&("date"===e.end_condition.type?m.until=(0,l().eU)(e.end_condition.end_at):"number"===e.end_condition.type?m.count=e.end_condition.number_of_occurrences:(0,a().HB)(e.end_condition)),"month"===e.frequency&&(0,a().O9)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?m.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?m.byweekday=r(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,n]=e;return g[t].nth(n)})):(0,a().HB)(e.monthly_restriction)),new p({freq:y[n],dtstart:(0,l().eU)(t),interval:o,byweekday:u,tzid:s,byhour:c??0,byminute:d??0,bysecond:0,...m})}const b=1,C=1;function x(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),o=e.length,r=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,i=o>b,a=n.length>=C;return{violatesConstraint:i||a,templateNestingExceedsMaxDepth:i,ancestorHasDailyTemplate:a,nestedDepthOfAutomationAncestors:o,immediateAncestorRecurrenceType:r}}function k(e){var t;const{recurrence:n,afterDate:r}=e;if("number"===(null===(t=n.end_condition)||void 0===t?void 0:t.type)||n.start_date>=r)return n;let i=o().c9.fromMillis(n.start_date,{zone:"utc"});const a=o().c9.fromMillis(r,{zone:"utc"});switch(n.frequency){case"year":{const e=Math.floor(a.diff(i,"years").years/n.interval);i=i.plus({years:e*n.interval});break}case"month":{const e=Math.floor(a.diff(i,"months").months/n.interval);i=i.plus({months:e*n.interval});break}case"week":{const e=Math.floor(a.diff(i,"weeks").weeks/n.interval);i=i.plus({weeks:e*n.interval});break}case"day":{const e=Math.floor(a.diff(i,"days").days/n.interval);i=i.plus({days:e*n.interval});break}}return{...n,start_date:(0,l().DH)(i.toMillis())}}function T(e){const{recurrence:t,afterDate:n}=e;if((0,m().wt)(t)){const e=(0,l().l1)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=_(k({recurrence:t,afterDate:n})).after((0,l().eU)(n));if(!e)return;return(0,l().h1)(e)}}function A(e){return 0===e.hour||1===e.hour||2===e.hour}function P(e){return _(e).after((0,l().eU)((0,l().Rz)()))||void 0}function M(e){const{recurrence:t,intl:n}=e,r=P(N(t));if(!r)return;const i=A(t),a=o().c9.fromJSDate(r).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,u().H)(n)).setZone(t.timezone),s=(0,c().Yq)({date:a,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(i)return n.formatMessage(f.dateBetweenMidnightAnd3AM,{date:s});{let e=a.toLocaleString(o().c9.TIME_SIMPLE);return t.timezone!==(0,d().P)()&&(e+=` ${a.toFormat("ZZZZ")}`),n.formatMessage(f.dateAtTime,{date:s,time:e})}}function I(e,t){return(0,a().O9)(e)?"number"===e.type?t.formatMessage(f.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,c().Yq)({date:o().c9.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,a().HB)(e):t.formatMessage(f.noEndCondition)}const R=100;function D(e){return{...e,start_date:(0,l().l1)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,l().l1)(e.end_condition.end_at)}:(0,a().HB)(e.end_condition):void 0}}function E(e,t,n){return e.plus(n-t)}function V(e,t){const n=o().c9.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,l().Rz)(n.toJSDate())}}function N(e){return{...e,start_date:(0,l().Rz)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?V(e,e.end_condition):(0,a().HB)(e.end_condition):void 0}}function F(e,t){const n=i().fN(e,(e=>void 0!==e)),o=i().fN(t,(e=>void 0!==e));return i().n4(n,o)}},398842:(e,t,n)=>{n.d(t,{Jv:()=>h,Zr:()=>S,Rl:()=>w,mA:()=>v});var o=n(296540),r=()=>n(484714),i=()=>n(847249),a=()=>n(401497),s=()=>n(970013),l=()=>n(743176),c=()=>n(68465),d=()=>n(159588),u=()=>n(963589),p=()=>n(331542),m=n(474848);function f(){const e=(0,a().DP)();return(0,m.jsx)("span",{style:{marginLeft:6,fontSize:11,padding:"1px 4px",borderRadius:4,display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,marginTop:1,color:"light"===e.mode?e.accentColors.blue[500]:e.accentColors.blue[600]},children:(0,m.jsx)(p().A,{legacySize:14})})}var y=()=>n(399275);const g=function(){return(0,m.jsx)(n(464708).A,{color:"purple",style:{marginLeft:6,padding:"1px 4px",display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,marginTop:1},content:(0,m.jsx)(n(959013).sA,{defaultMessage:"AI",id:"database.property.aiAutofillEnabledIndicator"})})};const v=o.memo((function(e){const{propertySchema:t,showIcon:o,showDragIcon:i,hideName:s,badge:l,style:c,iconStyle:u,iconSize:p,dragHandleStyle:f,className:y,labelSizeVariant:g}=e,v=(0,r().v3)(),{device:h}=v,S=h.isMobile?16:14,_=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",lineHeight:"120%",minWidth:0,fontSize:S,...c},iconWrapper:{display:"grid",justifyContent:"center",alignItems:"center",marginRight:s?void 0:"small"===g||i?4:6,...u},dragHandle:{gridColumn:1,gridRow:1,opacity:i?1:0,transition:`opacity ${d().bM}`},itemIcon:{gridColumn:1,gridRow:1,opacity:i?0:1,transition:`opacity ${d().bM}`},dragIcon:{fill:e.icon.secondary}})),[S,s,u,g,i,c]);return(0,m.jsxs)("div",{className:y,style:_.container,children:[o&&(0,m.jsxs)("div",{style:_.iconWrapper,children:[(0,m.jsx)("div",{style:_.itemIcon,children:(0,m.jsx)(w,{propertySchema:t,iconSize:p,iconStyle:u})}),(0,m.jsx)("div",{style:_.dragHandle,children:(0,m.jsx)(n(57232).A,{style:f,iconSize:12,iconStyle:_.dragIcon})})]}),!s&&(0,m.jsx)("div",{style:{...n(284371).RC},children:t.name}),l]})}));function h(e){const{propertySchema:t}=e,n=(0,r().v3)();return(0,i().K8)((()=>(0,c().O0)(n)&&s().$M(t)&&s().om(t)),[n,t])?(0,m.jsx)(g,{}):null}function S(e){let{propertyId:t,collectionContextStore:n}=e;return(0,i().K8)((()=>{var e;const o=null===(e=n.collectionStore())||void 0===e?void 0:e.id;if(!o)return!1;const r=y().d.state.collectionsProperties[o];return!!r&&"Loading"===r[t]}),[n,t])?(0,m.jsx)(f,{}):null}function w(e){const{propertySchema:t,iconSize:n,iconStyle:o}=e,{isMobile:i}=(0,r().Y0)(),s=(0,a().DP)(),c=(0,u().X)("nds_default_property_noticon"),d=i?18:16;return(0,m.jsx)(l().zB,{type:t.type,icon:t.icon,size:n||d,theme:s,style:o,isDefaultNoticonEnabled:c})}},399275:(e,t,n)=>{n.d(t,{d:()=>r});n(898992),n(354520);class o extends(()=>n(757695))().default{getInitialState(){return{flowId:void 0,type:"connected_properties_setup",collectionsProperties:{}}}createNewFlowId(){const e=(0,n(206267).JW)();return this.setState({...this.state,flowId:e}),e}getFlowId(){return this.state.flowId?this.state.flowId:this.createNewFlowId()}addCollectionProperties(e,t){const n=this.state.collectionsProperties[e],o=n?{...n,...t}:t;this.setState({...this.state,collectionsProperties:{...this.state.collectionsProperties,[e]:o}})}removeCollectionProperties(e,t){const n=this.state.collectionsProperties[e];if(!n)return;const o=Object.fromEntries(Object.entries(n).filter((e=>{let[n]=e;return!t.has(n)})));if(0===Object.keys(o).length){const{[e]:t,...n}=this.state.collectionsProperties;this.setState({...this.state,collectionsProperties:n})}else this.setState({...this.state,collectionsProperties:{...this.state.collectionsProperties,[e]:o}})}}const r=new o;(0,n(604341).exposeDebugValue)("ConnectedPropertiesSyncStore",r)},406533:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>r,questionMarkCircleIcon:()=>i});n(296540);var o=n(474848);const r={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M9.978 7.154c-.804 0-1.333.456-1.438.874a.625.625 0 0 1-1.213-.303c.28-1.121 1.44-1.82 2.65-1.82 1.365 0 2.714.905 2.714 2.298 0 .812-.49 1.477-1.13 1.872l-.755.516a.84.84 0 0 0-.381.677.625.625 0 1 1-1.25 0c0-.688.36-1.318.921-1.706l.003-.002.784-.535.014-.008c.374-.228.544-.537.544-.814 0-.459-.517-1.049-1.463-1.049m.662 6.336a.8.8 0 1 1-1.6 0 .8.8 0 0 1 1.6 0"}),(0,o.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0M10 3.625a6.375 6.375 0 1 0 0 12.75 6.375 6.375 0 0 0 0-12.75"})]})},i=(0,n(340498).wt)("questionMarkCircle",r)},422540:(e,t,n)=>{n.d(t,{$0:()=>g,Fx:()=>C,Ge:()=>m,I3:()=>u,Kj:()=>_,PP:()=>x,TK:()=>k,Yy:()=>d,aE:()=>T,cQ:()=>b,kH:()=>f,m7:()=>p,nq:()=>S,nv:()=>v,tj:()=>y});n(898992),n(354520),n(737550);var o=()=>n(496603),r=()=>n(534177),i=()=>n(970013),a=()=>n(651124),s=()=>n(349835),l=()=>n(390066);(0,r().u0)((e=>(0,r().O9)(e)&&(0,r().O9)(e.target)&&(0,r().O9)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target,custom_message:e.custom_message}}:{false:e}));const c={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1},d={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function u(e){return Boolean(c[e.type]&&!(0,i().UU)(e)&&(!(0,i().$M)(e)||void 0===(0,i().om)(e)))}function p(e){const{collectionFormat:t,collectionSchema:n,filter:s,sort:c,sourcePropertyIds:d}=e,p=(d??(0,r().uv)(n)).filter(((t,o,r)=>{const a=n[t];return!(!a||!u(a))&&(("relation"!==a.type||!e.restrictCrossSpace||!(0,i().o2)(e.spaceId,a))&&(!s||s([t,a],o,n)))}));if(0===p.length)return[];if(!t||!1===c)return p;const m=(0,l().L)(t,n,void 0,a().jf.Page).collection_page_properties||[];return o().Ul(p,(e=>m.findIndex((t=>t.property===e))))}function m(e){const{collectionFormat:t,collectionSchema:n,sort:s}=e,c=(0,r().uv)(n).filter(((e,t,o)=>{const r=n[e];return!(!r||!(0,i().JY)(r))}));if(0===c.length)return[];if(!t||!1===s)return c;const d=(0,l().L)(t,n,void 0,a().jf.Page).collection_page_properties||[];return o().Ul(c,(e=>d.findIndex((t=>t.property===e))))}function f(e){return e.type===s().M9.InvalidCharacter?{type:e.type,character:e.character}:e.type===s().M9.TokenExpected?{type:e.type,token:e.token}:e.type===s().uW.MissingSchemaPropertyOnThisRow||e.type===s().uW.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===s().uW.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===s().uW.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===s().uW.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===s().uW.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===s().uW.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===s().uW.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer,node:e.node}:e.type===s().uW.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===s().uW.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===s().uW.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===s().uW.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===s().uW.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===s().uW.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const y={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,geo_point:!1};function g(e){return Boolean(y[e.type])}function v(e){const{collectionFormat:t,collectionSchema:n,filter:s,sort:c}=e,d=(0,r().uv)(n).filter(((e,t,o)=>{var r;const a=n[e];return!(!a||!y[a.type])&&((!(0,i().$M)(a)||null===(r=(0,i().om)(a))||void 0===r||!r.auto_update_on_edit)&&(!s||s([e,a],t,n)))}));if(0===d.length)return[];if(!t||!1===c)return d;const u=(0,l().L)(t,n,void 0,a().jf.Page).collection_page_properties||[];return o().Ul(d,(e=>u.findIndex((t=>t.property===e))))}const h={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function S(e){return h[e.type]}const w={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,geo_point:!1};function _(e){return w[e.type]}function b(e){return 0===e}function C(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function x(e){const{property:t,collectionSchema:n}=e;return!!n&&!n[t]}function k(e){const{collectionSchema:t,property:n,type:o}=e,r=null==t?void 0:t[n];return!r||("action"===o?!u(r):!y[r.type])}function T(e){let{automationTrigger:t,collectionSchema:n}=e;if("event"===(null==t?void 0:t.type)){const{pagesAdded:e,pagePropertiesEdited:o,source:i,relativeDate:a}=t.event;if(void 0===i)return!1;const s="some"===o.type&&o.some,l="all"===o.type&&o.all;if((s||l||[]).some((e=>x({collectionSchema:n,property:e.property})||k({collectionSchema:n,property:e.property,type:"trigger"}))))return!1;const c="some"===o.type&&(!(0,r().O9)(o.some)||0===o.some.length),d="all"===o.type&&(!(0,r().O9)(o.all)||0===o.all.length);if(!e&&("none"===o.type||c||d)&&!a)return!1}else{if("recurrence"!==(null==t?void 0:t.type))return!1;if(!t.recurrence)return!1}return!0}},465364:(e,t,n)=>{n.d(t,{$N:()=>M,D5:()=>I,GB:()=>T,M9:()=>x,Pt:()=>P,eW:()=>A,jo:()=>R,v7:()=>k});n(944114),n(898992),n(803949),n(581454);var o=()=>n(244641),r=()=>n(787626),i=()=>n(713998),a=()=>n(597777),s=()=>n(604995),l=()=>n(416504),c=()=>n(519831),d=()=>n(496603),u=()=>n(534177),p=()=>n(299709),m=()=>n(317001),f=()=>n(520861),y=()=>n(878060),g=()=>n(44729),v=()=>n(246826),h=()=>n(319975),S=()=>n(519839),w=()=>n(695625),_=()=>n(397248),b=()=>n(630116),C=()=>n(747671);function x(e){const{environment:t,droppedStores:n,duplicate:i,calendarBy:d,transaction:u,collectionContextStore:y,duplicateActions:v}=e,h=o().c9.fromMillis(e.startOfDay);let w=!0;for(const o of n){const t=e.collectionStore?e.collectionStore:(0,S().Dj)({store:o,collectionContextStore:y});if(o.getParentTable()===c().Vl||!t){w=!1;break}g().X$({childStore:o,parentStore:t,transaction:u})||(w=!1)}const _=(0,f().T)({environment:t,droppedStores:n,duplicate:i,transaction:u,collectionStore:e.collectionStore,duplicateActions:v});for(const o of _){const n=e.collectionStore?e.collectionStore:(0,S().Dj)({store:o,collectionContextStore:y});if(!n)continue;const i=n.getMappedProperty(d),c=o.getPropertyStore(i),f=(0,r().b)(c.getValue())||s().Ec((0,l().P)()),g=s().kW(f,(0,l().P)()),v=h.toFormat(s().tr);let _;if("date"===g.type||"datetime"===g.type)_={...g,start_date:v};else{const e=s().AA(g,(0,l().P)());if(!e.end)return;const t={...g,start_date:v},n=s().AA(t,(0,l().P)()).start.diff(e.start,"days"),o=e.end.plus(n).toFormat(s().tr);_={...g,start_date:v,end_date:o}}const b=s().kW(_,a().$K(f)||(0,l().P)());(0,m().j)({environment:t,store:o,collectionStore:n,collectionContextStore:y,shouldCoerce:!0,groupsPointer:[],transaction:u,alreadyMovedToCollection:w}),I({environment:t,type:"dateValue",propertyId:i,store:o,transaction:u,dateValue:b}),(0,p().E)({environment:t,collectionContextStore:y,block_id:o.id,property:i,property_type:"date",from:"calendar"})}}function k(e){const{calendarStore:t,direction:n,targetStore:o}=e;t.setState({...t.state,isDragging:!0,targetStore:o,direction:n,temporaryValue:void 0})}function T(e){const{calendarStore:t,x:n,y:i,calendarBy:c}=e,u=t.state;if(u.isDragging){const e=(0,r().b)(u.targetStore.getPropertyStore(c).getValue());if(!e)return;const p=s().kW(e,(0,l().P)()),m=u.temporaryValue||e,f=s().kW(m,(0,l().P)()),y=[];u.dayStoreMap.forEach(((e,t)=>{y.push({store:e,timestamp:t})}));const g=y.find((e=>{let{store:t}=e;const o=w().T.getRectFromStore(t);return Boolean(o&&_().ux(o,n,i))}));let v;if(g){const e=o().c9.fromMillis(g.timestamp),t=e.endOf("day"),n=e.toFormat(s().tr);if(p){const r=s().AA(p,(0,l().P)());if(u.direction===C().Q.Left)if(o().IX.fromDateTimes(e,t).contains(r.start))v=p;else{let e;e="datetimerange"===p.type||"daterange"===p.type?{...p,start_date:n,end_date:p.end_date}:"datetime"===p.type?{type:"datetimerange",start_date:n,start_time:p.start_time,end_date:p.start_date,end_time:p.start_time,time_zone:p.time_zone,reminder:p.reminder}:{type:"daterange",start_date:n,end_date:p.start_date,reminder:p.reminder};const t=s().AA(e,(0,l().P)());v=!r.end&&t.start>r.start||r.end&&t.start>r.end?f:e}else if(r.end?o().IX.fromDateTimes(e,t).contains(r.end):o().IX.fromDateTimes(e,t).contains(r.start))v=p;else{let e;e="date"===p.type?{...p,type:"daterange",end_date:n}:"datetime"===p.type?{...p,type:"datetimerange",end_date:n,end_time:"00:00"}:{...p,end_date:n};const t=s().AA(e,(0,l().P)());v=t.end&&t.end<t.start?f:e}}}if(v&&!d().n4(f,v)){const e=s().kW(v,a().$K(m)||(0,l().P)());t.setState({...u,temporaryValue:e})}}}function A(e){const{environment:t,calendarStore:n,calendarBy:o,transaction:r}=e,i=n.state;i.isDragging&&i.temporaryValue&&(I({type:"dateValue",environment:t,dateValue:i.temporaryValue,propertyId:o,store:i.targetStore,transaction:r}),n.setState({...n.state,isDragging:!1}))}function P(e){const{calendarStore:t}=e,n=t.state;n.isDragging&&t.setState({...n,isDragging:!1})}function M(e){const{environment:t,store:n,collectionStore:r,collectionContextStore:a,startDayOfWeek:c,transaction:d}=e,u=a.dateRangeStartStore.state,p=(0,l().P)(),f=a.normalizedQueryStore.state;if(!f||!f.calendar_by)return;const y=(null==r?void 0:r.getMappedProperty(f.calendar_by))??f.calendar_by,g=s().hp(u,c,p),h=g.startOf("month"),S=g.endOf("month"),w=o().c9.now().startOf("day");let _;return _=o().IX.fromDateTimes(h,S).contains(w)?s().p6(w.valueOf(),p):s().p6(s().iB(u,c,p).valueOf(),p),v().zv({store:n.getPropertiesStore(),data:{[y]:i().m5(_)},transaction:d}),(0,m().j)({environment:t,store:n,collectionStore:r,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:d}),n}function I(e){const{environment:t,store:n,propertyId:o,transaction:r}=e;let a;"timestamp"===e.type?a=s().p6(e.timestampMs.valueOf(),(0,l().P)()):"dateValue"===e.type?a=e.dateValue:(0,u().HB)(e);const c=n.getPropertyValue(o),d=i().m5(a);v().zv({store:n.getPropertiesStore(),data:{[o]:d},transaction:r}),y().O({environment:t,store:n,dateProperty:{id:o,oldValue:c,newValue:d}})}function R(e){const{environment:t,collectionStore:n,calendarBy:o,store:r,insertStores:i,collectionContextStore:a,transaction:s}=e,l=r.getPropertyStore(o).getValue();for(const c of i)(0,m().j)({environment:t,store:c,collectionStore:n,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:s}),h().R9({environment:t,store:c.getPropertyStore(o),value:l,transaction:s});return i.map((e=>b().Bv.createChildStore(n,e.pointer)))}},520861:(e,t,n)=>{n.d(t,{T:()=>r});n(944114),n(898992),n(908872);var o=()=>n(415651);function r(e){const{environment:t,collectionStore:n,duplicate:r,droppedStores:i,transaction:a,duplicateActions:s}=e,{movedStores:l,reparentedStores:c}=i.reduce(((e,t)=>(r||t.getAssociatedCollectionId()!==(null==n?void 0:n.id)?e.reparentedStores.push(t):e.movedStores.push(t),e)),{movedStores:[],reparentedStores:[]});return[...l,...o().MS({environment:t,droppedStores:c,duplicate:r,transaction:a,resolveTemplateVariables:!1,duplicateActions:s})]}},546461:(e,t,n)=>{n.d(t,{EC:()=>b,To:()=>_,YC:()=>C,or:()=>w,u:()=>S});n(16280);var o=n(296540),r=()=>n(484714),i=()=>n(847249),a=()=>n(496506),s=()=>n(322867),l=()=>n(959013),c=()=>n(534177),d=()=>n(813297),u=()=>n(862292),p=()=>n(698331),m=()=>n(645873),f=()=>n(190019),y=()=>n(76190),g=n(474848);const v=new WeakMap,h=(0,o.createContext)({automationStore:void 0,contextType:void 0,defined:!1,typecheckResult:void 0});h.displayName="AutomationContext";function S(e){const{automationStore:t,children:n,contextType:o}=e,S=(0,r().v3)(),w=(0,l().tz)(),{value:_}=(0,m().fJ)(u().T.formulas),{value:b}=(0,m().fJ)(d().QV.automationTypecheck),C=(0,y().n)(t),x=(0,i().K8)((()=>{if(!_)return{error:new(s().N9)("Missing formulas dependency")};if(!b)return{error:new(s().N9)("Missing automation dependency")};const e=function(e){const{environment:t,automationStore:n,automationTypecheckModule:o,contextType:r,formulasModule:i,intl:s,isSubscribed:l}=e,d=v.get(n);if(d)return d;{const e=new(a().default)((()=>{const e=n.getTriggerType();let a=r;return(0,c().O9)(e)&&(0,p().x2)(e)&&(a=(0,p().H8)(e)),(0,f().Z)({environment:t,automationStore:n,automationTypecheckModule:o,contextType:a,formulasModule:i,intl:s,isSubscribed:l})}),{debugName:"automationContextTypecheckResultCachedStore"});return v.set(n,e),e}}({environment:S,automationStore:t,automationTypecheckModule:b,contextType:o,formulasModule:_,intl:w,isSubscribed:C});return e.state}),[S,t,b,o,_,w,C]);return(0,g.jsx)(h.Provider,{value:{automationStore:t,typecheckResult:x,contextType:o,defined:!0},children:n})}function w(e){const{automationStore:t,children:n}=e,o=(0,i().K8)((()=>{var e;return null===(e=t.getTrigger())||void 0===e?void 0:e.type}),[t]);return(0,g.jsx)(S,{automationStore:t,contextType:(0,p().H8)(o??"event"),children:n})}function _(e){var t;return null===(t=v.get(e))||void 0===t?void 0:t.state}function b(){const e=o.useContext(h);if(!1===e.defined)throw new Error("No automation context found!");return e}function C(){return o.useContext(h)}},551619:(e,t,n)=>{n.d(t,{Hy:()=>I,NV:()=>P,O9:()=>D,Rg:()=>R,Sm:()=>V,dK:()=>N,f7:()=>E,l8:()=>F,n$:()=>O,no:()=>j,sx:()=>M});var o=()=>n(484714),r=()=>n(792485),i=()=>n(847249),a=()=>n(700500),s=()=>n(651124),l=()=>n(519831),c=()=>n(620689),d=()=>n(591197),u=()=>n(835066),p=()=>n(964345),m=()=>n(68465),f=()=>n(753199),y=()=>n(504836),g=()=>n(478726),v=()=>n(747100),h=()=>n(963589),S=()=>n(665579),w=()=>n(351360),_=()=>n(525569),b=()=>n(508496),C=()=>n(375447),x=()=>n(66496),k=()=>n(548821),T=()=>n(712505),A=()=>n(302022);function P(e){(0,f().SQ)({event:e,context:f().y$.EditorMouseDown,callback:()=>{}})}function M(e){(0,f().SQ)({event:e,context:f().y$.EditorClick,callback:()=>{}})}function I(e){return(0,i().K8)((()=>Boolean(A().A.state.pageMap[e.id])||x().A.state.pages.has(e.id)),[e.id])}function R(e,t){const n=(0,o().v3)(),a=(0,r().S)(),s=I(e),l=(0,i().K8)((()=>{var n,o;return t===k().Rr.Frame?Boolean(null===(n=w().default.state.currentLoadingContainerStore)||void 0===n?void 0:n.state.ready):t===k().Rr.PeekView&&T().default.state.open?Boolean(null===(o=T().default.state.loadingContainerStore)||void 0===o?void 0:o.state.ready):t===k().Rr.CollectionPageView||t===k().Rr.CollectionPageViewFullScreen?e.isReady():void 0}),[t,e]),c=E(e);return(0,i().K8)((()=>{if(!l)return!1;const t=n.currentUser.isLoggedIn(),o=a&&a.publicEditModeStore.state;return Boolean(e&&e.isDefined()&&!e.isNonEditableState()&&e.canEdit()&&!e.hasContent()&&t&&(!(null!=o&&o.hasPublicPermission)||"edit"===(null==o?void 0:o.permission))&&!s&&!c&&(!(0,m().ZE)(o)||"completionPopup"!==_().default.state.type))}),[n.currentUser,c,l,a,s,e])}function D(e,t){const n=(0,o().v3)(),a=(0,r().S)(),{isTablet:s}=(0,o().Y0)(),l=(0,h().X)("tablet_refresh_template_pills_gate");return(0,i().K8)((()=>{if(t===k().Rr.SitePreview)return!1;if(n.device.isMobile&&(!s||!l))return!1;if(!n.currentUser.isLoggedIn())return!1;const o=a&&a.publicEditModeStore.state;if(null!=o&&o.hasPublicPermission&&"edit"!==(null==o?void 0:o.permission))return!1;if(e.getContentLength()>1)return!1;if(!e.canEdit()||e.isNonEditableState())return!1;const r=e.getContentStores()[0];if(r&&!r.isEmptyTextBlock())return!1;if(e.getAssociatedCollectionStore())return!1;const i=p().gZ.state,c=p().Di.state;if(i&&e.id===c)return!1;return!((0,g().L5)(t)?d().VY.state:d().u3.state)}),[n,a,e,t,s,l])}function E(e){return(0,i().K8)((()=>{if(e.isCollectionView()){const t=e.getCollectionStoreIfSingleSource();return!!t&&t.isSyncedCollection()}return e.isType(a().xd.externalObjectInstancePage)}),[e])}function V(e){return(0,i().K8)((()=>{if(!(0,y().vL)())return!1;const t=e.getParentStore();if((null==t?void 0:t.table)===l().Vl){return!!t.getFormatStore().getKeyStore("external_collection_type").getValue()}return!1}),[e])}function N(e){return(0,i().K8)((()=>{if(!(0,y().pB)())return!1;var t;return!!e.isCollectionView()&&((null===(t=e.getCollectionStore())||void 0===t?void 0:t.getFormatStore().getKeyStore("external_collection_type").getValue())??!1)}),[e])}function F(e){return(0,i().K8)((()=>{if(!b().default.checkGate({gateName:"csvimport_faster_navigate_to_page_enabled"}))return!1;var t;return!!e.isCollectionView()&&(null===(t=e.getCollectionStore())||void 0===t?void 0:t.getFormatStore().getKeyStore("static_import_collection_type").getValue())===s().IE.CsvImport}),[e])}function O(e){const t=(0,o().v3)(),{device:n,WindowSizeStore:r}=t,a=(0,i().K8)((()=>{const e=r.state.height,o=n.isMobile&&C().A.state.open?e:0;return c().C6(t)+o}),[t,r,n.isMobile]);return(0,i().K8)((()=>"home-phone"===e?S().q3:n.isTablet?380:n.isIOS?Math.max(350,a):n.isMobile?400:"side-peek"===e||"center-peek"===e?v().ln:"home"===e?S().wH:"30vh"),[n,a,e])}function j(e){const t=(0,o().v3)(),n=(0,i().K8)((()=>(0,u().dC)(t,e)),[t,e]);return(0,i().K8)((()=>n&&!e.isFullWidth()?(0,u().Zy)(t,(0,v().cq)(e),(0,v().RX)(e)):0),[t,n,e])}},556048:(e,t,n)=>{n.d(t,{C8:()=>p,Dz:()=>l,GC:()=>f,GL:()=>y,YY:()=>m,dM:()=>d,h9:()=>c,jX:()=>s,oF:()=>u,uj:()=>a});var o=()=>n(645873);const r={JiraSyncInfoPopup:new(o().O2)("JiraSyncInfoPopup",(async()=>await Promise.all([n.e(75134),n.e(68744)]).then(n.bind(n,408453)))),ImproveJiraSyncPopup:new(o().O2)("ImproveJiraSyncPopup",(async()=>await Promise.all([n.e(75134),n.e(2686)]).then(n.bind(n,484967)))),JiraDCAuthModal:new(o().O2)("JiraDCAuthModal",(async()=>await n.e(28763).then(n.bind(n,992567)))),ExternalImportAndSyncIndicator:new(o().O2)("ExternalImportAndSyncIndicator",(async()=>await n.e(98288).then(n.bind(n,984289)))),JiraSyncedAllProjectsTooltip:new(o().O2)("JiraSyncedAllProjectsTooltip",(async()=>await n.e(21446).then(n.bind(n,470020)))),JiraSyncedAllIssuesTooltip:new(o().O2)("JiraSyncedAllIssuesTooltip",(async()=>await n.e(21446).then(n.bind(n,470020)))),JiraSyncedDatabaseViewsAndFiltersTooltip:new(o().O2)("JiraSyncedDatabaseViewsAndFiltersTooltip",(async()=>await n.e(21446).then(n.bind(n,470020)))),JiraSyncSourceTooltip:new(o().O2)("JiraSyncSourceTooltip",(async()=>await n.e(21446).then(n.bind(n,470020)))),JiraSyncedSettingsToSetupProjectsAndIssuesTooltip:new(o().O2)("JiraSyncedSettingsToSetupProjectsAndIssuesTooltip",(async()=>await n.e(21446).then(n.bind(n,470020))))},i={JiraSyncTeamSpaceModal:new(o().O2)("JiraSyncTeamSpaceModal",(async()=>n.e(56188).then(n.bind(n,604698))))},a=(0,o()._h)(i.JiraSyncTeamSpaceModal,(e=>e.default)),s=(0,o()._h)(r.JiraSyncedAllProjectsTooltip,(e=>e.JiraSyncedAllProjectsTooltip)),l=(0,o()._h)(r.JiraDCAuthModal,(e=>e.default)),c=(0,o()._h)(r.JiraSyncedAllIssuesTooltip,(e=>e.JiraSyncedAllIssuesTooltip)),d=(0,o()._h)(r.JiraSyncedDatabaseViewsAndFiltersTooltip,(e=>e.JiraSyncedDatabaseViewsAndFiltersTooltip)),u=(0,o()._h)(r.JiraSyncedSettingsToSetupProjectsAndIssuesTooltip,(e=>e.JiraSyncedSettingsToSetupProjectsAndIssuesTooltip)),p=(0,o()._h)(r.JiraSyncSourceTooltip,(e=>e.JiraSyncSourceTooltip)),m=(0,o()._h)(r.JiraSyncInfoPopup,(e=>e.JiraSyncInfoPopup)),f=(0,o()._h)(r.ImproveJiraSyncPopup,(e=>e.ImproveJiraSyncPopup)),y=(0,o()._h)(r.ExternalImportAndSyncIndicator,(e=>e.ExternalImportAndSyncIndicator));(0,n(340498).xh)("jira",{default:{loader:()=>n.e(60677).then(n.bind(n,460677)),size:20},small:{loader:()=>n.e(60677).then(n.bind(n,460677)),size:16},mini:{loader:()=>n.e(60677).then(n.bind(n,460677)),size:14},large:{loader:()=>n.e(60677).then(n.bind(n,460677)),size:24}})},591197:(e,t,n)=>{n.d(t,{VY:()=>s,ZJ:()=>i,u3:()=>a});var o=()=>n(496506);class r extends(()=>n(757695))().default{getInitialState(){return{popupRenderedInPage:!1,popupRenderedInPeekView:!1}}}const i=new r,a=new(o().default)((()=>!1!==i.state.popupRenderedInPage),{debugName:"AssistantWriterRenderedInPageStore"}),s=new(o().default)((()=>!1!==i.state.popupRenderedInPeekView),{debugName:"AssistantWriterRenderedInPeekViewStore"})},603815:(e,t,n)=>{n.d(t,{A$:()=>k,JQ:()=>T,Vn:()=>C,s4:()=>x});n(16280),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949),n(581454);var o=()=>n(857639),r=()=>n(585515),i=()=>n(577449),a=()=>n(388821),s=()=>n(179034),l=()=>n(545285),c=()=>n(534177),d=()=>n(449506),u=()=>n(780054),p=()=>n(989423),m=()=>n(870618),f=()=>n(303626),y=()=>n(14307),g=()=>n(245865),v=()=>n(540758),h=()=>n(670631),S=()=>n(508496),w=()=>n(571963),_=()=>n(603815),b=()=>n(108944);async function C(e){const{environment:t,request:n,abortSignal:o,prefetchCacheKey:r,headers:i}=e;return(0,w().updateLoadCachedPageChunkCalledAt)(),y().isConnected()||y().isConnecting()?d().callApi({eventName:"loadCachedPageChunkV2",environment:t,data:n,abortSignal:o,prefetchCacheKey:r,headers:i}):d().callApi({eventName:"loadPageChunkV2",environment:t,data:n,abortSignal:o,prefetchCacheKey:r,headers:i})}async function x(e){const{mode:t,environment:n,request:c,isFirstChunk:d,abortSignal:y}=e,g={...c,limit:30,cursor:c.cursor||{stack:[]},baseUrl:u().A.domainBaseUrl,publicDomainName:u().A.publicDomainName};if("inMemoryAndDiskCacheWithInexactPreload"===t&&(await _().A$(n,{id:c.page.id,table:s().ev}),null!=y&&y.aborted))throw new Error("Abort signal received");const S=a().RecordMapWithRole.create(),w=[];let b=!1;const C=new Set,x=await r().T(g,i().h.fromMonomorphicFunctionUnsafe((async e=>{const o=await m().h7({environment:n,pointer:e,abortSignal:y,useInMemoryCacheOnly:"inMemoryOnly"===t});if(null!=y&&y.aborted)throw new Error("Abort signal received");if(o)return S.setModelAndRole(e,o.model,o.role),o.model;if("inMemoryOnly"===t)throw new Error(`Record not found: ${e.table},${e.id}`);if((0,l().u)(e)&&!C.has(e.id)&&d){if(void 0===h().A.state.offlinePages)return w.push(e),void(b=!0);if(void 0===h().A.state.offlinePages||!v().Bd(c.page.id))throw new Error(`Record not found: ${e.table},${e.id}`);w.push(e)}})),((e,t,n,o)=>{f().N.enableLogging&&console.log(`Spidering from ${e.table}:${e.id} to ${t.table}:${t.id} (${n})`),null!=o&&o.suppressErrorOnClient&&C.add(t.id)}));if(b&&(await h().A.waitUntil((()=>void 0!==h().A.state.offlinePages)),!v().Bd(c.page.id))){const[e]=w;throw new Error(`Record not found: ${e.table},${e.id}`)}if(w.length>0&&(0,p().LM)({eventName:"offline_page_was_missing_records_in_cache",sampling:{behavior:"statsig",fallbackBehavior:"statsig",statsigNotAvailableBehavior:"drop"}}).then((e=>{(0,p().u4)({environment:n,event:{eventName:"offline_page_was_missing_records_in_cache",eventProperties:{}},opts:{sampling:{behavior:"decided",sampleDecision:e}}}),e&&o().log({level:"error",from:"loadingHelpers",type:"offlinePageWasMissingRecordsInCache",data:{pageId:c.page.id,missingRecords:w}})})),null!=y&&y.aborted)throw new Error("Abort signal received");return{recordMap:S.toJson(),cursor:x.cursorValue}}async function k(e,t){const n=e.currentUser.id;if(!n||!e.defaultRecordCache.persistedRecordCache)return Promise.resolve(void 0);(await e.defaultRecordCache.persistedRecordCache.getPageBlocksByParent({page:t,userId:n})).forEach((t=>{e.defaultRecordCache.inMemoryRecordCache.setRecord({pointer:t.pointer,userId:t.userId},t.value),e.defaultRecordCache.inMemoryRecordCache.emitRecord(t.pointer,[]),g().unsubscribeAfterDelay({environment:e,pointer:t.pointer,userId:t.userId})}))}function T(e){if(!S().default.checkGate({gateName:"load_page_chunk_omit_existing_record_versions"}))return;const t=a().RecordMapPolymorphic.create();let n=0;const o=()=>n>=50,r=e=>{"space"!==(null==e?void 0:e.table)&&(o()||e&&void 0===t.get(e.pointer)&&(t.set(e.pointer,e.getVersion()),n++))};if(e.isReady())for(const a of(0,b().E)(e))r(a);if(e.userId){const t=e.environment.defaultRecordCache.inMemoryRecordCache.data.getUserRecordMap(e.userId);r(t.getModel({table:"notion_user",id:e.userId}));let n=0;for(const e of t.getPointersByTable("notion_user")){if(o()||n>=10)break;n++,r(t.getModel(e))}}const i=Array.from(t).map((e=>{let{pointer:t,value:n}=e;if(void 0!==n)return{pointer:t,version:n}})).filter(c().O9);return i.length?i:void 0}},654734:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(296540),r=()=>n(869190),i=()=>n(604995),a=()=>n(416504),s=n(474848);const l=function(e){const t=(0,n(959013).tz)(),l=(0,n(401497).DP)(),u=(0,n(396182).I)(),p=(0,o.useRef)(),m=(0,o.useCallback)((()=>{const t=e.value;if(!t)return;const o=i().q8(t,(0,a().P)());if(!o)return;const r=o.valueOf(),s=r-Date.now();s<0||s>n(720665).nD||p.current&&p.current.timestamp===r||(p.current&&clearTimeout(p.current.timer),p.current={timestamp:r,timer:setTimeout((()=>u("DateBox","DateBox/createReminderTimer")),s)})}),[u,e.value]),f=(0,o.useCallback)((()=>{p.current&&(clearTimeout(p.current.timer),p.current=void 0)}),[]);(0,o.useEffect)((()=>{m()}),[m]),(0,o.useEffect)((()=>()=>{f()}),[f]);const{value:y,withComma:g}=e,v=(0,n(847249).K8)((()=>y?(0,r().ZF)({value:y,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,a().P)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:e.shortenDateAndRange,displayInUserTimezone:e.displayInUserTimezone,getToday:n(838924).x1}):void 0),[t,e.dateFormat,e.displayInUserTimezone,e.shortenDateAndRange,e.timeFormat,y]);if(!y)return null;const h=i().AA(y,(0,a().P)(),n(662303).locale);let S;if(y.reminder){const e=i().Zs(y,(0,a().P)());S=e?{color:l.errorText}:{color:n(100622).Ay.blue}}const w=(0,s.jsxs)(s.Fragment,{children:[v,y.reminder&&(0,n(599987).P)({display:"inline-block",width:"1em",marginLeft:6,marginRight:2,paddingBottom:4,verticalAlign:"middle"}),g?", ":null]});return e.disableTooltip?(0,s.jsx)("div",{className:e.className,style:{...e.style,...S},children:w}):(0,s.jsx)(n(859428).A,{renderTooltip:()=>(0,s.jsxs)(s.Fragment,{children:[e.tooltipHeader,(0,s.jsxs)("div",{style:d(l,e.tooltipHeader),children:[c(h.start),h.end?` → ${c(h.end)}`:""]})]}),render:t=>(0,s.jsx)("div",{className:e.className,style:{...e.style,...S},...t,children:w}),placement:e.tooltipPlacement})};function c(e){return(0,r().eV)({value:e,preset:"medium"})}function d(e,t){return t?{color:e.text.contrastSecondary}:{}}},671446:(e,t,n)=>{n.d(t,{J:()=>l});var o=()=>n(484714),r=()=>n(847249),i=()=>n(346923),a=()=>n(363186),s=()=>n(94522);function l(){const{workflowStore:e,clientStore:t,threadStore:n,store:l}=(0,a().$O)(),c=(0,o().v3)(),d=(0,r().K8)((()=>(0,s().n2)({workflowStore:e,clientStore:t,environment:c,threadStore:n,store:l})),[e,t,c,n,l]);return(0,i().l)(d)}},698331:(e,t,n)=>{n.d(t,{$X:()=>i,H8:()=>a,x2:()=>r});var o=()=>n(534177);function r(e){return"event"===e||"recurrence"===e}function i(e){const t=e.getTrigger();return(0,o().O9)(t)&&r(t.type)}function a(e){return"event"===e?"event":"recurrence"===e?"recurrence":void(0,o().HB)(e)}},725649:(e,t,n)=>{function o(e){return!(!e||"askUserToPick"in e)}function r(e){if(!e||!("askUserToPick"in e))return e}function i(e){return!(!e||!("askUserToPick"in e))&&e.askUserToPick}n.d(t,{DK:()=>r,K$:()=>o,j6:()=>i})},747671:(e,t,n)=>{n.d(t,{Q:()=>o,a:()=>r});let o=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class r extends(()=>n(757695))().default{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}}},888325:(e,t,n)=>{function o(e){return`${e.table}:${e.id}`}n.d(t,{_:()=>o})}}]);