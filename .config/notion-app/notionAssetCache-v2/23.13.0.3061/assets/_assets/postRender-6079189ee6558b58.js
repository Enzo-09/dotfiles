"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[209,21088,48486,61660,70593,75681,85515,95794],{369:(e,t,n)=>{n.d(t,{R:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("eyeHide",{viewBox:"0 0 16 12",svg:(0,o.jsx)("path",{d:"M12.2754 10.9346L3.08545 1.76074C2.91895 1.59424 2.91895 1.3042 3.08545 1.1377C3.25732 0.96582 3.53662 0.971191 3.7085 1.1377L12.8931 10.3169C13.0649 10.4888 13.0703 10.752 12.8931 10.9346C12.7212 11.1172 12.4473 11.1064 12.2754 10.9346ZM8 1.44922C12.4526 1.44922 15.4067 5.02637 15.4067 6.13281C15.4067 6.76123 14.4346 8.20605 12.7588 9.31787L11.8618 8.41553C13.167 7.58301 13.978 6.54102 13.978 6.13281C13.978 5.50977 11.3516 2.62012 8 2.62012C7.43066 2.62012 6.9043 2.70068 6.39404 2.84033L5.42188 1.86816C6.21143 1.61035 7.06006 1.44922 8 1.44922ZM8 10.811C3.60645 10.811 0.587891 7.22852 0.587891 6.13281C0.587891 5.48828 1.6084 4.0166 3.33789 2.89404L4.25635 3.8125C2.87598 4.67725 2.0166 5.77832 2.0166 6.13281C2.0166 6.87402 4.64307 9.64014 8 9.64014C8.6123 9.64014 9.18701 9.54883 9.73486 9.39307L10.707 10.3652C9.88525 10.6445 8.98291 10.811 8 10.811ZM10.6211 7.06201L7.06543 3.50635C7.35547 3.38818 7.66699 3.32373 8 3.32373C9.55762 3.32373 10.8145 4.56445 10.8145 6.12744C10.8145 6.45508 10.7446 6.77734 10.6211 7.06201ZM8 8.93652C6.43164 8.93652 5.18555 7.6582 5.18018 6.13281C5.18018 5.75146 5.26074 5.39697 5.41113 5.08008L9.04199 8.70557C8.7251 8.85059 8.37598 8.93652 8 8.93652Z"})})},5580:(e,t,n)=>{n.d(t,{n:()=>a});var o=()=>n(847249),i=()=>n(209199),s=()=>n(351360);function a(){return(0,o().K8)((()=>{var e;const t=(null===(e=s().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)??i().q;return(0,i().o_)(t)}),[])}},6027:(e,t,n)=>{n.d(t,{F:()=>Y});var o=()=>n(662303),i=()=>n(825237),s=()=>n(945778),a=()=>n(142748),r=()=>n(919709),l=()=>n(751735),d=()=>n(496603),c=()=>n(284371),u=()=>n(780054),p=()=>n(972435),m=()=>n(108944),g=()=>n(613735),f=()=>n(337567),h=()=>n(896628),y=()=>n(751156),v=()=>n(892632);const b=630,x=1200,S=(0,n(100622).O4)({theme:"light"}),M=240,A="white",w=200,k=96,j=150,C=184,I=100,T=145,_=23,P=347,B=24,R=100,L=100,D=100,O="black",N=96,E=68,U=S.text.tertiary,F=40,V=(0,n(959013).YK)({builtWithNotion:{id:"socialMediaPreview.madeWithNotion",defaultMessage:"Made with Notion"}}),K='"Apple Color Emoji","Segoe UI Emoji",NotoColorEmoji,"Noto Color Emoji","Segoe UI Symbol","Android Emoji",EmojiSymbols';function H(e){return new Promise(((t,n)=>{const o=new Image;o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.src=e}))}function z(e,t){return`${c().Wy.bold} ${t}px ${c().xf({pageFont:e,locale:o().locale})}`}function W(e){const t=c().Wy.medium,n=c().xf({pageFont:e,locale:o().locale});return`${t} ${F}px ${n}`}function G(e){let{context:t,text:n,font:o,color:i,x:s,y:a}=e;t.font=o,t.textAlign="left",t.textBaseline="top",t.fillStyle=i,t.fillText(n,s,a)}async function Y(e){var t;let{store:n,environment:o}=e;if(n.pathIsDead()||!(0,a().ot)(m().E(n))||(0,f().dL)(n)||n.inMemoryRecordCache.recordHasOverride({pointer:n.pointer,userId:o.currentUser.id}))return;const c=r().q4_(n.getTitleValue())||"",F=null===(t=n.getIcon())||void 0===t?void 0:t.icon,Y=function(e,t){var n;const o=null===(n=t.getCover())||void 0===n?void 0:n.cover;if(o)return i().wY({url:o,width:x,permissionRecord:t.pointer,stripGoogleIconQuery:!0,baseUrl:u().A.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id})}(o,n),q=n.getFormat(),$=new OffscreenCanvas(x,b),Q=$.getContext("2d"),[Z,X]=function(e,t){const n=document.createElement("div");n.style.width="auto",n.style.position="absolute",n.style.whiteSpace="nowrap",n.style.font=z(t,N),n.style.top="110vh",n.innerText=e;const o=x-R-L,i=document.body;if(i.appendChild(n),n.clientWidth<o)return i.removeChild(n),[e,N];if(n.style.font=z(t,E),n.clientWidth<o)return i.removeChild(n),[e,E];let s=e;for(;n.clientWidth>o;)s=s.substring(0,s.length-1),n.innerText=`${s}…`;return i.removeChild(n),[`${s}…`,E]}(c,q.page_font),J=z(q.page_font,X),ee=P+(F?_:0),te=ee+B+X;if(Q){!function(e){e.fillStyle=A,e.fillRect(0,0,x,b)}(Q),await async function(e){let{context:t,coverImageUrl:n,icon:o,coverPosition:i=.5}=e;if(n){const e=await H(n),o=e.width*(M/x),s=((0,d().Et)(i)?1-i:.5)*(e.height-o);t.drawImage(e,0,s,e.width,o,0,0,x,M)}else{const e=(0,g().b)({icon:o,theme:S}),n=e?(0,l().X4)(e,.1):S.home.cards.coverPhoto.base;t.fillStyle=n,t.fillRect(0,0,x,M),t.fillStyle="rgb(0,0,0,1)"}}({context:Q,coverImageUrl:Y,icon:F,coverPosition:q.page_cover_position}),await async function(e){let{context:t,store:n,icon:o}=e;if(o)if((0,s().A)(o))t.font=`${w}px ${K}`,t.textAlign="left",t.textBaseline="top",t.fillText(o,k,j);else{const e=i().wY({url:o,baseUrl:u().A.domainBaseUrl,fullyQualified:!0,permissionRecord:n.pointer,width:C,userId:void 0}),s=await H(e);t.drawImage(s,I,T,C,C)}}({context:Q,store:n,icon:F}),G({context:Q,text:Z,font:J,color:O,x:R,y:ee}),G({context:Q,text:p().A.formatMessage(V.builtWithNotion),font:W(q.page_font),color:U,x:D,y:te});const e=await $.convertToBlob();!function(e){let{store:t,file:n,environment:o}=e;v().QM({environment:o,file:n,bucket:"secure",record:t.pointer,isFileBlock:!1,onComplete:e=>{y().createAndCommit({userAction:"SocialMediaPreviewImageUploadStore.updateSocialMediaPreviewImage",environment:o,canUndo:!1,perform:n=>{h().lm({store:t,url:e,transaction:n})}})},retryWhenOffline:!0})}({store:n,environment:o,file:new File([e],"SocialMediaPreviewImage.png",{type:"image/png"})})}}},19606:(e,t,n)=>{n.d(t,{A:()=>m,z:()=>p});var o=n(296540),i=()=>n(847249),s=()=>n(959013),a=()=>n(705540),r=()=>n(204063),l=()=>n(780054),d=()=>n(351360),c=()=>n(645200),u=n(474848);const p=(0,s().YK)({getNotionCalendar:{id:"notionCalendarLaunchButton.getNotionCalendar",defaultMessage:"Get Notion Calendar"},downloadApp:{id:"notionCalendarLaunchButton.downloadApp",defaultMessage:"Download app"},openCalendar:{id:"notionCalendarLaunchButton.openCalendar",defaultMessage:"Open Calendar"}});const m=function(e){let{style:t,openCalendarFrom:m,getNotionCalendarFrom:g,onOpenCalendarClick:f,onGetNotionCalendarClick:h,onDownloadClick:y}=e;const v=(0,n(484714).v3)(),b=(0,n(401497).IS)((e=>({button:{marginLeft:8,whiteSpace:"nowrap",...t}})),[t]),x=(0,i().K8)((()=>(0,n(583238).mX)()),[]),S=(0,i().K8)((()=>d().default.state.currentSpaceStore&&(0,n(640653).dT)({env:"production",spaceStore:d().default.state.currentSpaceStore})),[]),[{value:M}]=(0,n(187174).Yb)((async()=>{var e;return!(null===(e=a().electronApi)||void 0===e||!e.isProtocolRegistered)&&a().electronApi.isProtocolRegistered(l().A.calendar.desktopProtocol)}),[]),A=(0,o.useCallback)((()=>{c().Op({environment:v,spaceStore:void 0,collectionViewStore:void 0,from:m}),null==f||f()}),[v,m,f]),w=(0,o.useCallback)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t}=d().default.state;e&&t&&(c().Op({environment:v,spaceStore:t,collectionViewStore:void 0,from:g}),null==h||h())}),[v,g,h]),k=(0,o.useCallback)((()=>{n(755636).f({environment:v,url:l().A.calendar.downloadUrl}),null==y||y()}),[v,y]);return v.device.isElectron?M?(0,u.jsx)(r().A,{style:b.button,size:"lg",onClick:A,children:(0,u.jsx)(s().sA,{...p.openCalendar})}):(0,u.jsx)(r().A,{style:b.button,size:"lg",onClick:k,children:(0,u.jsx)(s().sA,{...p.downloadApp})}):x||S?(0,u.jsx)(r().A,{style:b.button,size:"lg",onClick:A,children:(0,u.jsx)(s().sA,{...p.openCalendar})}):(0,u.jsx)(r().A,{style:b.button,color:"black",size:"lg",onClick:w,children:(0,u.jsx)(s().sA,{...p.getNotionCalendar})})}},26517:(e,t,n)=>{n.d(t,{Wf:()=>h,YB:()=>g,aj:()=>f,f3:()=>v,qg:()=>y});n(898992),n(354520),n(581454),n(296540);var o=()=>n(401497),i=()=>n(651124),s=()=>n(959013),a=()=>n(449195),r=()=>n(722872),l=()=>n(760217),d=()=>n(928600),c=()=>n(939740),u=()=>n(89924),p=()=>n(74263),m=n(474848);function g(e){const{currentVisibility:t,propertySchema:n,onSelect:o,onClose:r}=e;let l=[...i().vj];l=l.filter((e=>"section"!==e)),(0,a()._f)({propertySchema:n})||(l=l.filter((e=>"hide_if_empty"!==e)));const d=l.map((e=>({visibility:e,label:(0,m.jsx)(s().sA,{...p().gY[e]})})));return(0,m.jsx)(b,{currentVisibility:t,visibilityLevelsWithLabels:d,onSelect:o,onClose:r})}function f(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=(0,a().SB)(t),r=["always_show","section_collapsed","section_hide"].map((e=>({visibility:e,label:(0,m.jsx)(s().sA,{...p().vG[e]})})));return(0,m.jsx)(b,{currentVisibility:i,visibilityLevelsWithLabels:r,onSelect:n,onClose:o})}function h(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,a=i().OA.filter((e=>"section_hide"!==e)).map((e=>({visibility:e,label:(0,m.jsx)(s().sA,{...p().wV[e]})}))),r="section_hide"===t?void 0:t;return(0,m.jsx)(b,{currentVisibility:r,visibilityLevelsWithLabels:a,onSelect:n,onClose:o})}function y(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,a=i().qG.filter((e=>"section_collapsed"!==e)).map((e=>({visibility:e,label:(0,m.jsx)(s().sA,{...p().Bb[e]})}))),r="section_collapsed"===t?"section_show":t;return(0,m.jsx)(b,{currentVisibility:r,visibilityLevelsWithLabels:a,onSelect:n,onClose:o})}function v(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,a=i().RL.map((e=>({visibility:e,label:(0,m.jsx)(s().sA,{...p().PP[e]})})));return(0,m.jsx)(b,{currentVisibility:t,visibilityLevelsWithLabels:a,onSelect:n,onClose:o})}function b(e){const{currentVisibility:t,visibilityLevelsWithLabels:n,onSelect:o,onClose:i}=e,s=n.map((e=>{let{visibility:n,label:s}=e;return{key:n,render:e=>(0,m.jsx)(x,{buttonMenuItemProps:e,isChecked:n===t,label:s}),action:()=>{o(n),i&&i()}}})),a=[{key:"visibilityLevels",render:e=>(0,m.jsx)(u().A,{...e,topBorder:0!==e.index}),items:s}],l={menuType:r().gu.Popup,width:"auto",maxWidth:360};return(0,m.jsx)(d().A,{...l,children:(0,m.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:void 0,sections:a})})}function x(e){const{buttonMenuItemProps:t,label:n,isChecked:i}=e,s=(0,o().IS)((()=>({title:{display:"flex",alignItems:"center",width:150}})),[]),a=(0,m.jsx)("div",{style:s.title,children:n});return(0,m.jsx)(l().A,{...t,textWrapperStyle:{marginRight:0},title:a,isChecked:i})}},41432:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const i=new o},59110:(e,t,n)=>{n.r(t),n.d(t,{loadLocalSubtree:()=>A});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949);var o=()=>n(700500),i=()=>n(175482),s=()=>n(777447),a=()=>n(792071),r=()=>n(976618),l=()=>n(388821),d=()=>n(696706),c=()=>n(912720),u=()=>n(199378),p=()=>n(179034),m=()=>n(519831),g=()=>n(869558),f=()=>n(343666),h=()=>n(197959),y=()=>n(37165),v=()=>n(144081),b=()=>n(743246),x=()=>n(919709),S=()=>n(534177),M=()=>n(780054);function A(e,t){const{blockId:n,inMemoryRecordCache:A,allowCopyCollections:w,requireFullSubtree:k,skipTransclusionContainerChildren:j,allowCopyExternalObjectInstances:C,skipBlockContent:I,skipNavigableChildren:T,excludeCrdtData:_,includeLegacyTransclusionBlockValues:P,includeDiscussions:B,includeComments:R}=t,L=e.currentUser.id,D=l().RecordMap.create(),O=new Set,N=[{pointer:{table:p().ev,id:n},parentId:"doesn't matter"}];for(;N.length>0;){const e=N.shift();if(!e)continue;if(O.has(e.pointer.id))continue;const t=n===e.pointer.id;if((0,d().Yt)(e.pointer,p().ev)){var E,U,F,V;const n=A.getRecord({pointer:e.pointer,userId:L});if(null==n||!n.value){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}const r=_?i().ir(n.value):n.value;if(P){if(!t&&r.parent_id!==e.parentId&&!e.isBlockContentChild)continue}else if(!t&&r.parent_id!==e.parentId)continue;if(r.type===o().xd.externalObjectInstance&&!C)return{type:"error",reason:"encountered_external_object_instance",pointer:e.pointer};if(D.setValue(e.pointer,r),!T){const e=a().Bj6.fromBlock(r).getCollectionPointers();for(const t of e){const e=A.getRecord({pointer:t,userId:L});var K,H;if(e)(null===(K=e.value)||void 0===K?void 0:K.parent_table)===p().ev&&(null===(H=e.value)||void 0===H?void 0:H.parent_id)===r.id&&N.push({pointer:t,parentId:r.id});else if(k)return{type:"error",reason:"missing_record",pointer:t}}if(r.view_ids)for(const t of r.view_ids)N.push({pointer:{table:g().Gy,id:t,spaceId:r.space_id},parentId:r.id})}if(!(I||j&&"transclusion_container"===r.type||T&&(0,o().$I)(r.type))){const e=a().Bj6.fromBlock(r).getRenderableContentIds();for(const t of e)N.push({pointer:{table:p().ev,id:t},parentId:r.id,isBlockContentChild:!0})}const l=a().Bj6.fromBlock(r).getNonContentChildren();for(const e of l)N.push({pointer:{table:p().ev,id:e},parentId:r.id,isBlockContentChild:!0});if(r.type===o().xd.externalObjectInstance){var z,W;const e=(null===(z=r.format)||void 0===z?void 0:z.related_external_object_uris_to_instance_ids)&&Object.values(null===(W=r.format)||void 0===W?void 0:W.related_external_object_uris_to_instance_ids)||[];for(const t of e)N.push({pointer:{table:p().ev,id:t,spaceId:r.space_id},parentId:r.id})}if(!T&&r.properties){const e=Object.values(r.properties).filter(S().O9);for(const t of e)for(const e of t)for(const t of x().uPN(e)){if(x().jIt(t)){const e=x().v55(t);N.push({pointer:{table:p().ev,id:e},parentId:r.id})}if(x().sh$(t)){const e=x().cQR(t),n=(0,s().lX)({url:e,baseUrl:M().A.domainBaseUrl,publicDomainName:M().A.publicDomainName});n&&N.push({pointer:{table:p().ev,id:n},parentId:r.id})}if(x().N53(t)){const e=x().T$c(t);e&&N.push({pointer:{table:p().ev,id:e,spaceId:r.space_id},parentId:r.id})}}}if("form"===r.type&&null!==(E=r.format)&&void 0!==E&&E.form_layout_pointer&&N.push({pointer:r.format.form_layout_pointer,parentId:r.id}),null!==(U=r.format)&&void 0!==U&&U.automation_id&&N.push({pointer:{table:c().yB,id:r.format.automation_id,spaceId:r.space_id},parentId:r.id}),null!==(F=r.format)&&void 0!==F&&F.workflow_id&&N.push({pointer:{table:b().C0,id:r.format.workflow_id,spaceId:r.space_id},parentId:r.id}),null!==(V=r.format)&&void 0!==V&&V.ai_instructions_page_pointer&&N.push({pointer:r.format.ai_instructions_page_pointer,parentId:r.id}),B&&r.discussions)for(const e of r.discussions)N.push({pointer:{table:h().$Y,id:e,spaceId:r.space_id},parentId:r.id})}else if((0,d().Yt)(e.pointer,m().Vl)){var G,Y;if(!w)return{type:"error",reason:"encountered_collection",pointer:e.pointer};const t=A.getRecord({pointer:e.pointer,userId:L});if(null==t||!t.value){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}if(t.value.parent_id!==e.parentId)continue;const n=t.value;D.setValue(e.pointer,n),A.forEachRecord(L,(t=>{let{model:n}=t;n.table===p().ev&&n&&n.parent_id===e.pointer.id&&n.alive&&N.push({pointer:n.pointer,parentId:e.pointer.id})}));const o=(null===(G=n.format)||void 0===G?void 0:G.automation_ids)??[];for(const e of o)N.push({pointer:{table:c().yB,id:e,spaceId:n.space_id},parentId:n.id});n.schema&&Object.values(n.schema).forEach((e=>{e&&"button"===e.type&&e.automation_id&&N.push({pointer:{id:e.automation_id,spaceId:n.space_id,table:c().yB},parentId:n.id})})),null!==(Y=n.format)&&void 0!==Y&&Y.layout_pointer&&N.push({pointer:n.format.layout_pointer,parentId:n.id})}else if((0,d().Yt)(e.pointer,g().Gy)){var q;const t=A.getRecord({pointer:e.pointer,userId:L});if(null==t||!t.value){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}if(t.value.parent_id!==e.parentId)continue;"form_editor"===t.value.type&&null!==(q=t.value.format)&&void 0!==q&&q.form_block_pointer&&N.push({pointer:t.value.format.form_block_pointer,parentId:t.value.id}),D.setValue(e.pointer,t.value)}else if((0,d().Yt)(e.pointer,c().yB)){const t=A.getRecord({pointer:e.pointer,userId:L});if(null==t||!t.value){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}if(t.value.parent_id!==e.parentId)continue;D.setValue(e.pointer,t.value);for(const e of t.value.action_ids??[])N.push({pointer:{table:u().SC,id:e,spaceId:t.value.space_id},parentId:t.value.id})}else if((0,d().Yt)(e.pointer,u().SC)){const t=A.getRecord({pointer:e.pointer,userId:L});if(null==t||!t.value){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}if(t.value.parent_id!==e.parentId)continue;D.setValue(e.pointer,t.value);for(const e of t.value.blocks??[])N.push({pointer:{table:p().ev,id:e,spaceId:t.value.space_id},parentId:t.value.id})}else if((0,d().Yt)(e.pointer,b().C0)){const t=A.getRecord({pointer:e.pointer,userId:L});if(null==t||!t.value){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}if(t.value.parent_id!==e.parentId)continue;D.setValue(e.pointer,t.value)}else if((0,d().Yt)(e.pointer,h().$Y)){const t=A.getRecord({pointer:e.pointer,userId:L});if(null==t||!t.value){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}if(t.value.parent_id!==e.parentId)continue;if(D.setValue(e.pointer,t.value),R)for(const e of t.value.comments??[])N.push({pointer:{table:f().SN,id:e,spaceId:t.value.space_id},parentId:t.value.id})}else if((0,d().Yt)(e.pointer,f().SN)){const t=A.getRecord({pointer:e.pointer,userId:L});if(null==t||!t.value){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}if(t.value.parent_id!==e.parentId)continue;D.setValue(e.pointer,t.value);for(const e of t.value.content??[])N.push({pointer:{table:p().ev,id:e,spaceId:t.value.space_id},parentId:t.value.id})}else if((0,d().Yt)(e.pointer,v().zx)){const t=A.getRecord({pointer:e.pointer,userId:L}),n=null==t?void 0:t.value;if(!n){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}D.setValue(e.pointer,n);const o=a().Bj6.fromValue(v().zx,n);for(const i of o.getBlockChildrenPointers())N.push({pointer:i,parentId:e.pointer.id});(0,r().E)(n.modules,(t=>{if("formQuestion"===t.type){const o={id:t.formQuestionId,table:y().lo,spaceId:n.space_id};N.push({pointer:o,parentId:e.pointer.id})}}))}else if((0,d().Yt)(e.pointer,y().lo)){const t=A.getRecord({pointer:e.pointer,userId:L});if(null==t||!t.value){if(k)return{type:"error",reason:"missing_record",pointer:e.pointer};continue}D.setValue(e.pointer,t.value)}O.add(e.pointer.id)}return{type:"success",recordMap:D}}},64901:(e,t,n)=>{n.d(t,{A:()=>i});n(296540);var o=n(474848);const i=function(e){const t=(0,n(484714).v3)(),i=(0,n(401497).DP)();return(0,o.jsx)(n(187485).A,{style:{display:"flex",alignSelf:"stretch",width:36,...e.isRight?{marginRight:-8}:{marginLeft:-8}},external:!0,href:e.href,onClick:()=>n(148024).FH(t,{from:e.analyticsFrom}),children:(0,o.jsx)(n(704152).A,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,n(133033).$)({width:18,marginTop:1,fill:i.lightIconColor})})})}},68913:(e,t,n)=>{n.r(t),n.d(t,{alarmIcon:()=>s,iconDefinition:()=>i});n(296540);var o=n(474848);const i={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M5.791 1.886a.625.625 0 1 0-.801-.96L2.138 3.31a.625.625 0 1 0 .802.96zm4.834 3.839a.625.625 0 1 0-1.25 0v3.65H6.4a.625.625 0 0 0 0 1.25H10c.345 0 .625-.28.625-.625z"}),(0,o.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0M14.13 1.006a.625.625 0 0 0 .079.88l2.851 2.383a.625.625 0 1 0 .802-.96L15.01.927a.625.625 0 0 0-.88.079"})]})},s=(0,n(340498).wt)("alarm",i)},70423:(e,t,n)=>{n.d(t,{L:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("bellDisabled",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7 15.2285C6.48047 15.2285 6.02246 15.11 5.62598 14.873C5.23405 14.6406 4.92188 14.333 4.68945 13.9502C4.46159 13.5719 4.33854 13.1618 4.32031 12.7197H1.51074C1.15072 12.7197 0.868164 12.6331 0.663086 12.46C0.462565 12.2822 0.362305 12.0475 0.362305 11.7559C0.362305 11.5143 0.426107 11.2842 0.553711 11.0654C0.681315 10.8421 0.843099 10.6279 1.03906 10.4229C1.23958 10.2178 1.44466 10.015 1.6543 9.81445C1.8138 9.65951 1.93685 9.45671 2.02344 9.20605C2.11003 8.9554 2.17611 8.67969 2.22168 8.37891C2.26725 8.07812 2.30371 7.77051 2.33105 7.45605C2.34017 7.08691 2.36296 6.73828 2.39941 6.41016C2.44043 6.08203 2.49512 5.77669 2.56348 5.49414L3.73926 6.66992C3.71647 6.8431 3.69596 7.02539 3.67773 7.2168C3.66406 7.4082 3.65495 7.60872 3.65039 7.81836C3.63216 8.12826 3.60482 8.41536 3.56836 8.67969C3.5319 8.94401 3.48405 9.18555 3.4248 9.4043C3.36556 9.62305 3.29264 9.81901 3.20605 9.99219C3.12402 10.1654 3.02604 10.3158 2.91211 10.4434C2.80273 10.571 2.68652 10.6963 2.56348 10.8193C2.44499 10.9378 2.33561 11.0472 2.23535 11.1475C2.13965 11.2477 2.06217 11.3275 2.00293 11.3867V11.4688H8.54492L10.0078 12.9385H9.64551C9.59538 13.3532 9.45182 13.7337 9.21484 14.0801C8.98242 14.4264 8.6748 14.7044 8.29199 14.9141C7.91374 15.1237 7.48307 15.2285 7 15.2285ZM7 14.1348C7.38737 14.1348 7.70866 14.0072 7.96387 13.752C8.21908 13.4967 8.35807 13.1527 8.38086 12.7197H5.6123C5.63965 13.1527 5.78092 13.4967 6.03613 13.752C6.29134 14.0072 6.61263 14.1348 7 14.1348ZM4.01953 2.99902C4.15625 2.89421 4.30208 2.7985 4.45703 2.71191C4.61654 2.62533 4.78516 2.55241 4.96289 2.49316C5.09049 2.04199 5.33431 1.66374 5.69434 1.3584C6.05436 1.05306 6.48958 0.900391 7 0.900391C7.50586 0.900391 7.9388 1.05306 8.29883 1.3584C8.65885 1.66374 8.90495 2.04199 9.03711 2.49316C9.9349 2.81673 10.5889 3.41146 10.999 4.27734C11.4137 5.14323 11.6416 6.2666 11.6826 7.64746C11.7008 7.9209 11.7282 8.17383 11.7646 8.40625C11.8011 8.63411 11.849 8.84603 11.9082 9.04199C11.972 9.2334 12.0518 9.41113 12.1475 9.5752C12.2477 9.73926 12.3685 9.89648 12.5098 10.0469C12.7786 10.3021 13.0293 10.5664 13.2617 10.8398C13.4941 11.1133 13.6104 11.4027 13.6104 11.708C13.6104 11.9587 13.5329 12.166 13.3779 12.3301L10.6641 9.55469C10.5911 9.39518 10.5342 9.22884 10.4932 9.05566C10.4567 8.87793 10.4271 8.68424 10.4043 8.47461C10.3815 8.26497 10.361 8.03027 10.3428 7.77051C10.3245 6.80892 10.222 6.04557 10.0352 5.48047C9.84831 4.91081 9.60449 4.4847 9.30371 4.20215C9.00293 3.9196 8.66569 3.72819 8.29199 3.62793C8.20996 3.6097 8.14616 3.5778 8.10059 3.53223C8.05501 3.4821 8.02767 3.41146 8.01855 3.32031C8.00033 2.97396 7.90007 2.69368 7.71777 2.47949C7.54004 2.2653 7.30078 2.1582 7 2.1582C6.69922 2.1582 6.45768 2.2653 6.27539 2.47949C6.0931 2.69368 5.99284 2.97396 5.97461 3.32031C5.97005 3.41146 5.94271 3.4821 5.89258 3.53223C5.84701 3.5778 5.78548 3.6097 5.70801 3.62793C5.57585 3.66439 5.44824 3.70996 5.3252 3.76465C5.20671 3.81934 5.09277 3.88542 4.9834 3.96289L4.01953 2.99902ZM0.615234 2.35645C0.514974 2.25163 0.464844 2.12402 0.464844 1.97363C0.464844 1.81868 0.514974 1.6888 0.615234 1.58398C0.724609 1.47917 0.854492 1.42676 1.00488 1.42676C1.15983 1.42676 1.28971 1.47917 1.39453 1.58398L13.8086 13.9912C13.9134 14.096 13.9658 14.2236 13.9658 14.374C13.9658 14.5244 13.9134 14.6543 13.8086 14.7637C13.7038 14.8685 13.5739 14.9209 13.4189 14.9209C13.2686 14.9209 13.141 14.8685 13.0361 14.7637L0.615234 2.35645Z"})})},70463:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});n(898992),n(941795);var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(133033),l=()=>n(427704),d=()=>n(959013),c=()=>n(100622),u=()=>n(284371),p=()=>n(449506),m=()=>n(186445),g=()=>n(404141),f=()=>n(446242),h=()=>n(623580),y=()=>n(204063),v=()=>n(719147),b=n(474848);const x={padding:"24px 36px 24px",minWidth:300,maxWidth:400},S=n(757695).default.createClass(void 0,{name:"PromoErrorStore"});const M=function(){const e=(0,s().K8)((()=>f().A.state.open),[]);return(0,b.jsx)(n(676007).A,{open:e,innerStyle:x,preventHideChildrenWhileOpening:!0,render:()=>(0,b.jsx)(I,{}),onDismiss:w})};function A(){const e=(0,a().DP)();return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",color:e.text.tertiary,borderTop:`1px solid ${e.regularDividerColor}`,paddingTop:14},children:[(0,r().$)({width:14,marginTop:1,marginRight:6,fill:e.lightIconColor})," ",(0,b.jsx)("div",{children:(0,b.jsx)(d().sA,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,b.jsx)(v().A,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function w(){f().A.setState({open:!1})}function k(){w(),g().A.setState({open:!0,openedFrom:"student_not_eligible_modal",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function j(){const e=(0,a().DP)(),t=(0,i().v3)(),n=(0,s().K8)((()=>(0,m()._m)(t)),[t]),o=(0,s().K8)((()=>null==n?void 0:n.getEmail()),[n]);return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:e.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:e.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,b.jsx)("div",{style:{fontWeight:u().Wy.medium,marginTop:0},children:o}),(0,b.jsx)("div",{style:{color:e.text.secondary,marginTop:4},children:(0,b.jsx)(d().sA,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,b.jsx)(y().A,{style:{marginTop:12},onClick:k,size:"lg",children:(0,b.jsx)(d().sA,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}function C(){const e=(0,d().tz)(),t=(0,a().DP)(),n=(0,i().v3)(),r=(0,s().uB)(void 0,S),[l,u]=(0,o.useState)(""),m=(0,o.useCallback)((()=>async function(e,t,n,o){if(n){const i=await p().callApi({eventName:"getPromoCode",environment:e,data:{code:n}});"failed"!==i.type&&i.data.promo?f().A.state.open&&(await f().A.state.handlePromoCode(n),w()):o.setState(t.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:n}))}}(n,e,l,r)),[n,e,l,r]),g=(0,o.useCallback)((e=>function(e,t,n){t(e.target.value.toUpperCase()),n.setState(void 0)}(e,u,r)),[u,r]),v=(0,s().O$)(r),x=e.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:t.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:t.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,b.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,b.jsx)(h().A,{style:{marginRight:8,height:32},value:l,onChange:g,onSubmit:m,placeholder:x}),(0,b.jsx)(y().A,{onClick:m,disabled:!l,size:"lg",children:(0,b.jsx)(d().sA,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,b.jsx)("div",{style:{color:c().Ay.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:v})]})]})}function I(){return(0,b.jsxs)("div",{style:{fontSize:14},children:[(0,b.jsx)("div",{children:(0,b.jsx)(d().sA,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,b.jsx)("br",{}),p:e=>(0,b.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:o.Children.toArray(e)}),pricinglink:e=>(0,b.jsx)(v().A,{external:!0,href:l().eR.pricing,children:e})}})}),(0,b.jsx)(j,{}),(0,b.jsx)(C,{}),(0,b.jsx)(A,{})]})}},74263:(e,t,n)=>{n.d(t,{Bb:()=>s,PP:()=>r,gY:()=>m,vG:()=>d,wV:()=>u});var o=()=>n(959013);const i=(0,o().YK)({expanded:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),s={section_show:i.expanded,section_collapsed:i.expanded,section_hide:i.off},a=(0,o().YK)({default:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimal:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"}}),r={inline:a.default,minimal:a.minimal},l=(0,o().YK)({showOnHover:{id:"visibilityLevelMessages.backlinksPageSection.showOnHover",defaultMessage:"Show on hover"},alwaysShow:{id:"visibilityLevelMessages.backlinksPageSection.alwaysShow",defaultMessage:"Always show"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),d={always_show:l.alwaysShow,section_show:l.showOnHover,section_collapsed:l.showOnHover,section_hide:l.off,inline:l.off,minimal:l.off},c=(0,o().YK)({asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},minimal:{id:"visibilityLevelMessages.propertyPageSection.minimal",defaultMessage:"Minimal"}}),u={inline:c.asPageSection,minimal:c.minimal},p=(0,o().YK)({alwaysShow:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},alwaysHide:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hideWhenEmpty:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"}}),m={show:p.alwaysShow,hide:p.alwaysHide,hide_if_empty:p.hideWhenEmpty,section:p.asPageSection}},74355:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(334261),r=()=>n(377586),l=()=>n(351360),d=()=>n(796249),c=()=>n(712505),u=()=>n(401497),p=()=>n(651124),m=()=>n(390066),g=()=>n(142015),f=()=>n(49621),h=()=>n(642557),y=n(474848);const v={viewBox:"0 0 16 16",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{d:"M8 8.1a1.125 1.125 0 0 0-.575 2.092v.958a.575.575 0 0 0 1.15 0v-.958A1.125 1.125 0 0 0 8 8.1"}),(0,y.jsx)("path",{d:"M12.2 1.6a2.846 2.846 0 0 0-2.846 2.846V5.8H5.2a2.025 2.025 0 0 0-2.025 2.025v4.2c0 1.118.907 2.025 2.025 2.025h5.6a2.025 2.025 0 0 0 2.025-2.025v-4.2A2.025 2.025 0 0 0 10.8 5.8h-.196V4.446a1.596 1.596 0 1 1 3.192 0v1.63a.625.625 0 1 0 1.25 0v-1.63A2.846 2.846 0 0 0 12.2 1.6M4.425 7.825c0-.428.347-.775.775-.775h5.6c.428 0 .775.347.775.775v4.2a.775.775 0 0 1-.775.775H5.2a.775.775 0 0 1-.775-.775z"})]})},b=(0,n(340498).wt)("lockOpenSmall",v);var x=()=>n(358359),S=()=>n(959013),M=()=>n(284371),A=()=>n(246826),w=()=>n(751156),k=()=>n(989423),j=()=>n(449195),C=()=>n(722872),I=()=>n(600871),T=()=>n(557198),_=()=>n(455425),P=()=>n(493823),B=()=>n(678553),R=()=>n(8980),L=()=>n(89924),D=()=>n(946548),O=()=>n(867159);const N=function(e){let{store:t,useBottomSheetStyling:r}=e;const l=(0,i().v3)(),d=(0,S().tz)(),{device:c}=l,u=(0,s().K8)((()=>t.isLockedForAllUsers()),[t]),g=(0,s().K8)((()=>_().$.isTemporarilyUnlocked({userId:t.userId,blockId:t.id})),[t.id,t.userId]),f=(0,s().K8)((()=>t.isLocked()),[t]),h=(0,s().K8)((()=>t.isExternalObjectInstancePageBlockStore()),[t]);let v;v=c.isMobile?{menuType:C().gu.Modal,right:r?void 0:(0,y.jsx)(n(480095).DoneMenuText,{}),onClickRight:a().VN,title:d.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:C().gu.Popup,minWidth:300};const b=(0,s().K8)((()=>function(e,t){const n=e.getFormat();if(!t)return{};const o=(0,m().L)(n,t,void 0,p().jf.Collection);return o}(t,t.getSchema())),[t]),x=(0,o.useCallback)((()=>{g?_().$.relockBlock({userId:t.userId,blockId:t.id}):_().$.temporarilyUnlockBlock({userId:t.userId,blockId:t.id})}),[t.id,t.userId,g]);return(0,y.jsxs)(n(928600).A,{...v,children:[u&&(0,y.jsx)(H,{isTemporarilyUnlocked:g,onToggleLock:x}),(0,y.jsx)(E,{store:t,locked:f,format:b,isSyncedCollection:h,device:c})]})};function E(e){let{format:t,isSyncedCollection:n,store:o,locked:i,device:a}=e;const r=(0,s().K8)((()=>o.getSchema()),[o]),l=function(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}(t),{pageSectionVisibility:d}=l,c=(0,s().K8)((()=>(0,j().vk)(d)),[d]),u=(0,s().K8)((()=>o.isCollectionView()),[o]),p=(0,s().K8)((()=>!(0,I().LX)({device:a})),[a]),m=!a.isMobile&&!u;if(!r||!o)return null;if(!l)return null;if(!d)return null;const g={topLevelDiscussions:!n,backLinks:p,floatingTableOfContents:m,pageComments:!n},f={locked:i,store:o,format:t},h=(0,y.jsxs)(y.Fragment,{children:[g.backLinks&&(0,y.jsx)(F,{...f}),g.topLevelDiscussions&&(0,y.jsx)(U,{pageVisibility:d.comments,...f}),g.floatingTableOfContents&&(0,y.jsx)(V,{pageVisibility:d.comments,...f,store:o}),g.pageComments&&(0,y.jsx)(K,{pageVisibility:c,...f})]});return(0,y.jsx)(L().A,{style:{opacity:i?.5:1},children:(0,y.jsx)("div",{style:{marginLeft:2},children:h})})}function U(e){let{pageVisibility:t,locked:n,store:s,format:r}=e;const l=(0,i().v3)(),d="section_show"===t,c=(0,o.useCallback)((()=>{const e="section_show"===t?"section_hide":"section_show";a().OD({environment:l,pageSection:"comments",visibility:e,store:s,format:r})}),[l,r,t,s]),p=(0,u().IS)((()=>({switcherButtonContainer:{marginRight:4}})),[]);return(0,y.jsx)(B().Ay,{title:(0,y.jsx)(S().sA,{id:"customizePageMenu.pageSections.pageCommentsSwitcherTitle",defaultMessage:"Page discussions"}),icon:(0,y.jsx)(R().I,{icon:f().h}),right:(0,y.jsx)("div",{style:p.switcherButtonContainer,children:(0,y.jsx)(D().A,{disabled:n,on:d,onClick:c})})})}function F(e){let{locked:t,store:n,format:o}=e;const{backlinksVisibility:i,updateBacklinksVisibility:s}=(0,T().Ap)({store:n,format:o});return(0,y.jsx)(B().Ay,{title:(0,y.jsx)(S().sA,{id:"customizePageMenu.pageSections.backlinksSwitcherTitle",defaultMessage:"Backlinks"}),icon:(0,y.jsx)(R().I,{icon:g().D}),right:(0,y.jsx)(O().p7,{currentVisibility:i,onSelect:s,disabled:t})})}function V(e){let{pageVisibility:t,locked:n,store:a,format:r}=e;const l=(0,u().IS)((()=>({switcherButtonContainer:{marginRight:4}})),[]),d=(0,i().v3)(),c=(0,s().K8)((()=>{var e;return"off"!==(null===(e=a.getModel())||void 0===e?void 0:e.getFloatingTableOfContentsState())}),[a]),p=(0,o.useCallback)((()=>{w().createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:d,canUndo:!0,perform:e=>{A().zv({store:a.getFormatStore(),data:{page_floating_table_of_contents:{state:c?"off":"minimal"}},transaction:e})}}),(0,k().u4)({environment:d,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:!c}}})}),[a,d,c]);return(0,y.jsx)(B().Ay,{title:(0,y.jsx)(S().sA,{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"}),icon:(0,y.jsx)(R().I,{icon:x().L}),right:(0,y.jsx)("div",{style:l.switcherButtonContainer,children:(0,y.jsx)(D().A,{disabled:n,on:c,onClick:p})})})}function K(e){let{pageVisibility:t,locked:n,store:o,format:s}=e;const r=(0,i().v3)();return(0,y.jsx)(B().Ay,{title:(0,y.jsx)(S().sA,{id:"customizePageMenu.pageSections.inlineCommentsTitle",defaultMessage:"Inline comments"}),icon:(0,y.jsx)(R().I,{icon:f().h}),right:(0,y.jsx)(O().J8,{currentVisibility:t,disabled:n,onSelect:e=>{a().OD({environment:r,pageSection:"margin_comments",visibility:e,store:o,format:s})}})})}function H(e){let{isTemporarilyUnlocked:t,onToggleLock:n}=e;const o=(0,u().DP)();return(0,y.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${o.regularDividerColor}`,borderBottom:`1px solid ${o.regularDividerColor}`,background:o.surface.wash,color:o.text.secondary,paddingTop:6,paddingBottom:6},children:[(0,y.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:t?(0,y.jsx)(R().I,{icon:b,size:"sm",color:"secondary"}):(0,y.jsx)(R().I,{icon:h().lockSmallIcon,size:"sm",color:"secondary"})}),(0,y.jsx)(S().sA,{id:"customizePageMenu.locked.header",defaultMessage:"Page is locked."}),(0,y.jsx)(P().p,{style:{fontSize:12,color:o.text.secondary,fontWeight:M().Wy.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:n,children:t?(0,y.jsx)(S().sA,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,y.jsx)(S().sA,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock for me"})})]})}const z=function(){const e=(0,i().v3)(),{device:t}=e,o=(0,s().O$)(d().A);return(0,y.jsx)(n(897119).Ay,{popupType:t.isMobile?r().n.BottomSheet:r().n.Popup,bottomSheetInitialState:"half",alignmentToOrigin:n(962730).C.Center,open:o.isOpen,render:()=>(0,y.jsx)(W,{useBottomSheetStyling:t.isMobile}),originRect:o.isOpen?o.rect:void 0,onDismiss:()=>a().VN(),trapFocus:!0})};function W(e){let{useBottomSheetStyling:t}=e;const n=(0,s().O$)(d().A),o=(0,s().K8)((()=>c().default.state.open&&c().default.state.targetStore||l().default.state.mainEditorCurrentBlockStore),[]);return n.isOpen&&o?(0,y.jsx)(N,{store:o,useBottomSheetStyling:t}):null}},77279:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const i=new o},82926:(e,t,n)=>{n.d(t,{j8:()=>f,un:()=>m,p2:()=>p,WE:()=>u,n5:()=>h,Xn:()=>g});var o=()=>n(161479);const i=(0,n(583835).Dv)("restoreSnapshot");var s=()=>n(570323),a=()=>n(989423);var r=()=>n(136833);var l=()=>n(357625),d=()=>n(496414);const c=(0,n(959013).YK)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function u(e){const{environment:t,from:n,...o}=e;!function(e,t){a().vd(e,"open_history",{from:t})}(t,n),s().A.setState({...o,open:!0,size:50})}function p(){const e=s().A.state;e.open&&s().A.setState({...e,size:e.size+20})}function m(){s().A.setState({open:!1})}function g(e){const{environment:t,snapshot:n,nextFutureSnapshot:o}=e;!function(e,t){a().vd(e,"select_snapshot",{ageMs:(0,r().S)(t)})}(t,n);const i=s().A.state;i.open&&s().A.setState({...i,snapshot:n,nextFutureSnapshot:o,openSnapshotNearTimestamp:void 0})}function f(){const e=s().A.state;e.open&&s().A.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function h(e,t){if(!s().A.state.open||!s().A.state.snapshot)return;if(!s().A.state.snapshot)return;!function(e,t){a().vd(e,"restore_snapshot",{ageMs:(0,r().S)(t)})}(e,s().A.state.snapshot),d().m({message:c.restoringPreviousVersion});const n=await l().UT(e,i,{block:{id:s().A.state.blockStore.id,spaceId:(0,o().e)(s().A.state.blockStore.pointer.spaceId)},timestamp:s().A.state.snapshot.timestamp,shouldRestoreCollection:t??!1}).next();if(d().V(),n.value.error)throw n.value.error}},91669:(e,t,n)=>{n.d(t,{z:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{isOpen:!1}}}const i=new o},103674:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{permissionsInviteStore:new(n(986229).A),contextualInviteStore:new(n(159026).Ay)}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const i=o},120114:(e,t,n)=>{n.d(t,{AX:()=>a,Ur:()=>o,uw:()=>i,yP:()=>s});const o=["unified_find_variant"],i=["deep_find_enable_query_gen","deep_find_enable_universal_blending","deep_find_enable_3p_sources","deep_find_enable_query_gen_finetuned_json_schema","deep_find_enable_query_gen_json_schema","deep_find_enable_request_tracing","deep_find_render_and_hydrate_notion_pages","deep_find_use_query_gen_for_notion_search","deep_find_should_show_streaming_ux","deep_find_append_keywords_to_notion_search","deep_find_all_connectors"],s=["notionSourceNumResults","maxPagesToDecorate","maxResultsPerSourceToBlendedRanking","maxFinalResults","maxResultsPerSourceToBoost"];function a(e,t,n){return{universalBlendingEnabled:e.isDeepFindUniversalBlendingEnabled(),queryGenEnabled:e.isDeepFindQueryGenEnabled(),notionSourceNumResults:t("notionSourceNumResults"),enableRequestTracing:n("deep_find_enable_request_tracing"),maxPagesToDecorate:t("maxPagesToDecorate"),maxResultsPerSourceToBlendedRanking:t("maxResultsPerSourceToBlendedRanking"),maxFinalResults:t("maxFinalResults"),useQueryGenForNotionSearch:n("deep_find_use_query_gen_for_notion_search"),shouldShowStreamingUx:n("deep_find_should_show_streaming_ux"),appendKeywordsToNotionSearch:n("deep_find_append_keywords_to_notion_search"),allConnectorsEnabled:n("deep_find_all_connectors"),maxResultsPerSourceToBoost:t("maxResultsPerSourceToBoost")}}},135154:(e,t,n)=>{n.d(t,{E:()=>i});n(898992),n(823215);var o=()=>n(953418);function i(e){const{element:t,extraBottomSpacing:n=0}=e;let i=t.getBoundingClientRect();i=DOMRect.fromRect({x:i.x,y:i.y,width:i.width,height:i.height+n});return(0,o().sl)(t).every((e=>{const t=e.getBoundingClientRect();return i.top>=t.top&&i.bottom<=t.bottom&&i.left>=t.left&&i.right<=t.right}))}},136805:(e,t,n)=>{n.r(t),n.d(t,{TopbarShareButton:()=>_,messages:()=>k});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(864896),l=()=>n(959013),d=()=>n(904671),c=()=>n(38337),u=()=>n(553965),p=()=>n(321172),m=()=>n(623275),g=()=>n(437487),f=()=>n(326589),h=()=>n(962730),y=()=>n(227440),v=()=>n(493823),b=()=>n(406699),x=()=>n(35392),S=()=>n(859428),M=()=>n(573792),A=()=>n(863059),w=n(474848);const k=(0,l().YK)({share:{defaultMessage:"Share",id:"topbar.share"}});function j(e){let{store:t,buttonPopupStore:r}=e;const l=(0,i().v3)(),{isMobile:c,isTablet:u}=(0,s().K8)((()=>({isMobile:l.device.isMobile,isTablet:l.device.isTablet})),[l]),h=(0,s().uB)(void 0,n(103674).A),y=(0,s().uB)(void 0,n(529183).Ay),v=(0,s().uB)(void 0,n(454354).A),x=(0,s().K8)((()=>function(e,t){if(t.shouldUserHaveAccessToPrivatePageBlock()&&t.state.changePermissionsEnabled&&t.state.privatePageStore&&t.state.privatePageStore.id===e.id)return t.state.privatePageStore;return e}(t,v)),[t,v]),S=(0,s().K8)((()=>(0,n(663590).FI)({disableLogging:!0})),[]),M=(0,s().K8)((()=>t.canAdmin()),[t]),A=(0,s().K8)((()=>!c&&function(e,t){const{permissionsInviteStore:n}=e.state;return n.state.inviteTargets.length>0||t.state.inviteTargets.length>0}(h,y)),[y,c,h]),{sudoModeStoreId:k}=(0,s().K8)((()=>{var e;return{sudoModeStoreId:null===(e=v.state.privatePageStore)||void 0===e?void 0:e.id}}),[v]),j=(0,s().O$)(n(351360).AppStoreCurrentSpaceStore);(0,o.useEffect)((()=>{!function(e){var t;let{environment:n,store:o,sudoModeStore:i,canAdmin:s,currentSpaceStore:a}=e;null!==(t=i.state.privatePageStore)&&void 0!==t&&t.id&&i.state.privatePageStore.id!==o.id&&i.reset();s||d().B({environment:n,sudoModeStore:i,pageBlockId:o.id,currentSpaceStore:a})}({environment:l,sudoModeStore:v,store:t,canAdmin:M,currentSpaceStore:j})}),[M,l,t,v,k,j]),(0,o.useEffect)((()=>{g().Ay.setState({...g().Ay.state,isInitialized:!0})}));const I=(0,o.useCallback)((()=>{r.reset()}),[r]),_=(0,o.useCallback)((()=>{T({buttonPopupStore:r,universalMemberInviteStore:h,inviteTargetsStore:y}),n(778417).IU({environment:l}),p().Tk(l),(0,f().g)()||n(224701).Ow(l)}),[r,h,y,l]),P=(0,o.useCallback)((e=>(0,w.jsx)(C,{buttonPopupEvents:e,handleClick:_})),[_]),B=(0,o.useCallback)((async()=>{if(y.state.inviteTargets.length>0){return void(await p().T({environment:l,inviteTargetsStore:y})&&(p().XP(l),T({buttonPopupStore:r,universalMemberInviteStore:h,inviteTargetsStore:y})))}const{permissionsInviteStore:e}=h.state;"invitee"===e.state.inputFocus&&e.setState({...e.state,inputFocus:"none"});await(0,n(743260).iQ)({environment:l,permissionsInviteStoreState:e.state,from:"share_menu"})||(p().XP(l),T({buttonPopupStore:r,universalMemberInviteStore:h,inviteTargetsStore:y}))}),[r,l,y,h]),R=(0,a().IS)((e=>({buttonPopup:{...c?{width:"100%"}:u?{width:460}:{width:S?m().$D:500,overflow:"hidden",...S&&{borderRadius:m().Sg,boxShadow:e.shadowMD,..."dark"===e.mode&&{border:`1px solid ${e.largePopupBorder}`}}}}})),[c,S,u]);return(0,w.jsx)(b().Ay,{popupType:c?b().z7.SlideUp:b().z7.Popup,forceInitialInbound:!0,buttonPopupStore:r,renderOrigin:P,originGap:c?void 0:8,style:R.buttonPopup,onClick:_,render:()=>(0,w.jsx)(n(482707).k,{buttonPopupStore:r,sudoModeStore:v,store:x,inviteTargetsStore:y,universalMemberInviteStore:h,onUpgradeButtonClick:I,location:c?"topbar_mobile":"topbar_share_button",onClose:B}),persistOnClose:A,onDismiss:B,onClose:B})}function C(e){let{buttonPopupEvents:t,handleClick:n}=e;const{isMobile:r}=(0,i().Y0)(),d=!(0,s().O$)(y().e),c=(0,s().K8)((()=>(0,f().g)()),[]),p=(0,a().IS)((e=>({shortcut:{color:e.text.contrastSecondary}})),[]),m=(0,o.useCallback)((()=>d?(0,w.jsx)(l().sA,{defaultMessage:"Unavailable while offline",id:"topbar.shareButton.offlineTooltip"}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{children:c?(0,w.jsx)(l().sA,{defaultMessage:"Share",id:"topbar.shareButton.tooltipAWTL"}):(0,w.jsx)(l().sA,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,w.jsx)(x().A,{style:p.shortcut,name:"openShareMenu"})]})),[d,c,p.shortcut]);return(0,w.jsx)(S().A,{disableTooltip:r,renderTooltip:m,placement:h().W.Bottom,delayThreshold:400,render:e=>(0,w.jsx)(I,{events:(0,u().A)(e,t),handleClick:n,disabled:d})})}function I(e){let{events:t,handleClick:n,disabled:o}=e;const{isMobile:s}=(0,i().Y0)(),d=(0,l().tz)(),u=(0,a().IS)((e=>{const t=(0,M().aD)(e),n=(0,A().Hh)(e);return{mobileIconStyle:t.iconStyle,shareButton:{...s?t.iconContainer:{marginRight:n.iconButton.marginRight,marginLeft:n.iconButton.marginRight}}}}),[s]);const p=s?(0,r().Y)(u.mobileIconStyle):(0,w.jsx)(l().sA,{defaultMessage:"Share",id:"topbar.shareButton.title"});return(0,w.jsx)(v().p,{id:void 0,className:c().voG,...t,mobileFeedback:s,style:u.shareButton,"aria-label":d.formatMessage(k.share),disabled:o,disabledFeedback:o,children:p})}function T(e){let{buttonPopupStore:t,universalMemberInviteStore:n,inviteTargetsStore:o}=e;t.reset(),n.reset(),o.reset()}const _=o.memo(j)},136833:(e,t,n)=>{function o(e){return Date.now()-parseInt(e.timestamp)}n.d(t,{S:()=>o})},137840:(e,t,n)=>{n.r(t),n.d(t,{OutlinerDropdownMenuButton:()=>H,useSortActions:()=>G});n(581454);var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(582684),l=()=>n(29037),d=()=>n(126617),c=()=>n(813197),u=()=>n(617668),p=()=>n(946065),m=()=>n(116225),g=()=>n(959013),f=()=>n(416726),h=()=>n(899963),y=()=>n(246826),v=()=>n(751156),b=()=>n(664713),x=()=>n(47373),S=()=>n(722872),M=()=>n(396301),A=()=>n(37433),w=()=>n(963589),k=()=>n(655923),j=()=>n(112282),C=()=>n(575143),I=()=>n(667193),T=()=>n(351360),_=()=>n(966711),P=n(474848);const B=(0,g().YK)({move:{id:"useMoveSidebarAction.title.moveSection",defaultMessage:"Move section"},moveUp:{id:"useMoveSidebarAction.option.moveUp",defaultMessage:"Move up"},moveDown:{id:"useMoveSidebarAction.option.moveDown",defaultMessage:"Move down"}});var R=()=>n(852678),L=()=>n(620149),D=()=>n(848237),O=()=>n(452558),N=()=>n(704152),E=()=>n(406699),U=()=>n(928600),F=()=>n(8980),V=()=>n(89924);const K=(0,g().YK)({manual:{id:"outlinerDropdownMenuButton.sort.manual",defaultMessage:"Manual"},lastEdited:{id:"outlinerDropdownMenuButton.sort.lastEdited",defaultMessage:"Last edited"}});function H(e){const{type:t,spaceViewStore:n}=e,s=(0,i().v3)(),r=(0,a().IS)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:4}})),[]),l=(0,o.useCallback)((()=>{R().A.setState({open:!0}),h().ye(s,{outliner_type:M().BP[t]})}),[s,t]),c=(0,o.useCallback)((()=>{R().A.setState({open:!1})}),[]),u=(0,g().tz)().formatMessage({id:"outlinerDropdownMenuButton.ariaLabel",defaultMessage:"Open menu"});return(0,P.jsx)(E().Ay,{popupType:E().z7.Popup,alignmentToOrigin:E().yP.Start,renderOrigin:e=>(0,P.jsx)(N().A,{style:r.button,ariaLabel:u,...e,children:(0,P.jsx)(F().I,{icon:d().Y,size:"sm",color:s.device.isMobile?"tertiary":"secondary"})}),onClick:l,onClose:c,render:e=>(0,P.jsx)(W,{type:t,spaceViewStore:n,onClose:()=>{e.close()}}),originGap:2})}const z=(0,g().YK)({sort:{id:"outlinerDropdownMenu.sort",defaultMessage:"Sort"},truncationLimit:{id:"outlinerDropdownMenu.truncationLimit",defaultMessage:"Show"},addTeam:{id:"outlinerDropdownMenu.addTeam",defaultMessage:"New teamspace"}});function W(e){const{type:t,spaceViewStore:n,onClose:o}=e,d=(0,i().v3)(),b=(0,g().tz)(),w=(0,a().IS)((e=>({rightText:{fontSize:12,color:e.text.secondary}})),[]),R=(0,s().K8)((()=>(0,x().rY)(d)),[d]),N=(0,s().K8)((()=>(0,M().RQ)({spaceViewStore:n,type:t})),[n,t]),E=N.sortOption,F=N.truncationLimit,H="shared"===t&&R||"private"===t||"teamspaces"===t,W="private"===t||"shared"===t&&R,q=(0,s().K8)((()=>!L().l.state),[]),$=(0,s().K8)((()=>{const{currentSpaceStore:e}=T().default.state;return!!e&&(0,A().canCreateTeam)({environment:d,spaceStore:e})}),[d]),Q=q&&"teamspaces"===t&&$,Z=G({type:t,onSelect:o,spaceViewStore:n,outlinerLocation:"sidebar"}),X=function(e){const{type:t,spaceViewStore:n,onSelect:o}=e,r=(0,i().v3)(),d=(0,a().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]),c=(0,s().K8)((()=>(0,M().RQ)({type:t,spaceViewStore:n}).truncationLimit),[t,n]);return p().AQ.map((e=>(0,f().Ls)({key:e.toString(),displayName:void 0,analyticsName:e.toString(),validators:[],closeParentMenu:!0,action:()=>{v().createAndCommit({userAction:"OutlinerDropdownMenuButton.setTruncationLimit",environment:r,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("truncationLimit").getKeyStore(t);y().KY({transaction:o,store:i,value:e})}}),m().u4({name:"update_sidebar_section_option",args:{option:"show",type:t}}),h().nT(r,{outliner_type:M().BP[t],option:e}),o()},render:t=>(0,P.jsx)(C().A,{...t,title:(0,P.jsx)(Y,{limit:e,withItems:!0}),right:c===e&&(0,l().checkmarkIcon)(d.icon),rightStyle:d.right})})))}({type:t,onSelect:o,spaceViewStore:n}),J=function(e){const{type:t,onSelect:n}=e,o=(0,s().O$)(T().AppStoreCurrentSpaceStore),a=(0,s().O$)(T().AppStoreCurrentSpaceViewStore),r=(0,s().K8)((()=>T().default.state.currentUserRootStore),[]),l=(0,g().tz)(),d=(0,i().v3)(),c=(0,I().p)(),u=(0,_().m)(),p=(0,s().K8)((()=>(0,x().i3)({environment:d,spaceStore:o,userRootStore:r})),[d,o,r]),m=(0,M().KP)({sidebarOrder:u,sidebarState:c,showLockedSidebar:p});if(!a)return[];const b=m.indexOf(t),S=0===b,A=b===m.length-1,w=(null==c?void 0:c.shownSidebarSectionCount)??0;return["moveUp","moveDown"].map((e=>{const o=B[e];return(0,f().Ls)({key:e,displayName:void 0,analyticsName:o.defaultMessage,validators:[()=>w>1],closeParentMenu:!0,action:o=>{let{environment:i}=o;const s=function(e){let{sidebarSection:t,selectedMoveOption:n,sidebarOrder:o,visibleSidebarOrder:i}=e;const s=[...o],a=o.indexOf(t),r=i.indexOf(t);if("moveUp"===n&&r>0){const e=i[r-1];s[o.indexOf(e)]=t,s[a]=e}if("moveDown"===n&&r<i.length-1){const e=i[r+1];s[o.indexOf(e)]=t,s[a]=e}return s}({sidebarSection:t,selectedMoveOption:e,sidebarOrder:u,visibleSidebarOrder:m});v().createAndCommit({userAction:`useMoveSidebarAction.${e}`,environment:i,canUndo:!0,perform:e=>{y().zv({store:a,data:{sidebar_order:s},transaction:e})}}),h().ub(i,{section:t,previous_order:u,new_order:s,from:"outliner_section_menu"}),n()},render:t=>{const n="moveUp"===e&&S||"moveDown"===e&&A,i="moveUp"===e?j().s:k().v;return(0,P.jsx)(C().A,{...t,disabled:n,disabledFeedback:n,title:l.formatMessage(o),svg:i})}})}))}({type:t,onSelect:o}),ee=[(0,f().uk)({key:"sort",displayName:z.sort,analyticsName:z.sort.defaultMessage,validators:[()=>W],svg:r().C,right:b.formatMessage(K[E]),rightStyle:w.rightText,subActions:()=>[(0,f().gy)({key:"sort",render:e=>(0,P.jsx)(V().A,{...e}),actions:Z})]}),(0,f().uk)({key:"truncationLimit",displayName:z.truncationLimit,analyticsName:z.truncationLimit.defaultMessage,validators:[()=>H],svg:c().L,right:(0,P.jsx)(Y,{limit:F}),rightStyle:w.rightText,subActions:()=>[(0,f().gy)({key:"truncationLimit",render:e=>(0,P.jsx)(V().A,{...e}),actions:X})]}),...J],te=[(0,f().gy)({key:"all",render:e=>(0,P.jsx)(V().A,{...e}),actions:ee}),(0,f().gy)({key:"addTeam",render:e=>(0,P.jsx)(V().A,{...e}),actions:[(0,f().Ls)({key:"addTeam",displayName:z.addTeam,analyticsName:z.addTeam.defaultMessage,validators:[()=>Q],svg:u().plusIcon,closeParentMenu:!0,action:()=>{(0,D().vn)("sidebar_team_section"),o()}})]})];return(0,P.jsx)(U().A,{menuType:S().gu.Popup,minWidth:220,children:(0,P.jsx)(O().A,{context:{blocks:[],environment:d,publicEditMode:void 0},sections:te,initialFocus:void 0})})}function G(e){const{type:t,spaceViewStore:n,onSelect:o,outlinerLocation:r}=e,d=(0,i().v3)(),c=(0,g().tz)(),{currentSpaceStore:u}=(0,s().O$)(T().default),p=d.currentUser.id,x=(0,w().X)("sidebar_add_new_pages_to_bottom"),S=(0,s().K8)((()=>(0,M().RQ)({type:t,spaceViewStore:n}).sortOption),[t,n]),A=(0,a().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]);return["manual","lastEdited"].map((e=>{const i=K[e];return(0,f().Ls)({key:e,displayName:void 0,analyticsName:i.defaultMessage,validators:[],closeParentMenu:!0,action:async()=>{v().createAndCommit({userAction:"OutlinerDropdownMenuButton.setSortOption",environment:d,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("sortOption").getKeyStore(t);y().KY({transaction:o,store:i,value:e})}}),"manual"===e&&"shared"===t&&!x&&p&&u&&await b().Z({environment:d,spaceId:u.id,userId:p}),m().u4({name:"update_sidebar_section_option",args:{option:"sort",type:t}}),h().Rf(d,{outliner_type:M().BP[t],outliner_location:r,option:e}),o()},render:t=>(0,P.jsx)(C().A,{...t,title:c.formatMessage(i),right:S===e&&(0,l().checkmarkIcon)(A.icon),rightStyle:A.right})})}))}function Y(e){const{limit:t,withItems:n}=e;return t===p().vw?(0,P.jsx)(g().sA,{id:"outlinerDropdownMenuButton.truncationLimit.noTruncation",defaultMessage:"All"}):n?(0,P.jsx)(g().sA,{id:"outlinerDropdownMenuButton.truncationLimit",defaultMessage:"{limit} items",values:{limit:t}}):(0,P.jsx)("span",{children:t})}},142015:(e,t,n)=>{n.d(t,{D:()=>i});n(296540);const o={viewBox:"0 0 20 20",svg:(0,n(474848).jsx)("path",{d:"M15.417 5.467c.23-.23.219-.615-.025-.859s-.629-.255-.86-.025l-8.857 8.858V7.313a.625.625 0 0 0-1.25 0v7.637c0 .345.28.625.625.625h7.637a.625.625 0 1 0 0-1.25H6.559z"})},i=(0,n(340498).wt)("arrowDiagonalDownLeft",o)},146594:(e,t,n)=>{n.d(t,{H:()=>s});var o=()=>n(645873);const i=new(o().O2)("UpdateSidebarTabInfo",(async()=>await Promise.all([n.e(75134),n.e(43380),n.e(9304),n.e(85515),n.e(1213),n.e(78846),n.e(43741),n.e(93282),n.e(67780),n.e(96933),n.e(49157),n.e(21377)]).then(n.bind(n,722143)))),s=(0,o()._h)(i,(e=>e.UpdateSidebarTabInfo))},149257:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(296540),i=()=>n(959013),s=n(474848);const a=(0,i().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const r=function(e){const{teamStore:t,teamName:r,teamId:l,isModalOpen:d,onDismiss:c}=e,[u,p]=(0,o.useState)(""),m=(0,n(484714).v3)(),g=(0,i().tz)(),f=async()=>{await n(350648).Ip({environment:m,teamId:l,message:u}),c()},h=(0,n(401497).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,s.jsx)(n(676007).A,{open:d,onDismiss:c,innerStyle:h.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{style:h.requestTitle,children:(0,s.jsx)(i().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:r,icon:(0,s.jsx)(n(898808).x,{style:h.icon,store:t,disabled:!0,size:22})}})}),(0,s.jsx)(n(623580).A,{textarea:!0,style:h.input,value:u,onChange:e=>{p(e.target.value)},placeholder:g.formatMessage(a.message_placeholder)}),(0,s.jsxs)("div",{style:h.footer,children:[(0,s.jsx)(n(125565).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,s.jsx)(i().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,s.jsx)(n(204063).A,{size:"lg",style:h.requestInvitesButton,onClick:f,children:(0,s.jsx)(i().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},171510:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>v});n(898992),n(354520);var o=n(296540),i=()=>n(484714),s=()=>n(847249);const a="initial_handshake";var r=()=>n(798880),l=()=>n(959013),d=()=>n(496603),c=()=>n(763824),u=()=>n(498212),p=()=>n(780054),m=()=>n(630116),g=()=>n(179534),f=()=>n(214006),h=n(474848);const y=1;function v(){const e=(0,i().v3)(),t=(0,l().tz)(),n=`${p().A.identity.domainBaseUrl}/authSync`,v=e.currentUser.isLoggedIn(),[b,x]=(0,o.useState)(null),[S,M]=(0,o.useState)({value:!1,count:0}),A=(0,s().K8)((()=>g().A.getTotalUnreadMentionsCount()),[]),w=(0,s().K8)((()=>f().A.getAllSpaceViewStores(e)),[e]);(0,o.useEffect)((()=>{const e=t=>{const n=p().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(x(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,o.useEffect)((()=>{v&&(S.value||0===S.count||null==b||b.postMessage({version:y,name:"unreadCount",source:"notion",unreadCount:A}))}),[v,S.count,S.value,b,A]);const k=(0,o.useCallback)((async()=>{const e=d().hS(w,"userId"),n=await(0,c().lX)(e,10,(async e=>{if(!e.userId)return;const n=m().LU.createChildStore(e,{table:r().oo,id:e.userId});await n.load();const o=n.getEmail()??"",i=n.getDisplayName(t)??"";return{id:e.userId,displayName:i,emailAddress:o}}));null==b||b.postMessage({version:y,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,b,w]);(0,o.useEffect)((()=>{v&&b&&(S.value||0===S.count)&&k()}),[v,k,S.count,S.value,b]),(0,o.useEffect)((()=>{e.currentUser.id&&!(0,u().uj)(e.currentUser.id)||null==b||b.postMessage({version:y,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id?e.currentUser.id:"",type:"mutation"})}),[e.currentUser.id,b]),(0,o.useEffect)((()=>{v||(null==b||b.postMessage({version:y,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"}),null==b||b.postMessage({version:y,name:"accountSwitcher",source:"notion",accounts:[],persistCookie:!0}))}),[v,b]);const j=(0,o.useCallback)((e=>{if(e.data.version!==y)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)M((e=>({value:!0,count:e.count+1})))}),[]);return(0,o.useEffect)((()=>(x((e=>(e&&(e.onmessage=j),e))),()=>{x((e=>(e&&(e.onmessage=null),e)))})),[j,b]),(0,h.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(a,p().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},171789:(e,t,n)=>{n.d(t,{A:()=>r});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(705540),s=n(474848);function a(){const[e,t]=(0,o.useReducer)(((e,t)=>{switch(t.type){case"push":return[...e.map((e=>({...e,isAnimatingOut:!0}))),{item:t.item,isAnimatingOut:!1}];case"delete":return e.filter((e=>e.item.key!==t.key));case"clear":return e.map((e=>({...e,isAnimatingOut:!0})));default:return e}}),[]);return(0,o.useEffect)((()=>(null===i()||void 0===i()||i().snackbarReady(!0),()=>{null===i()||void 0===i()||i().snackbarReady(!1)})),[]),(0,o.useEffect)((()=>{const e=new(n(496506).default)((()=>n(666429).Ay.state.currentItem),{debugName:"currentItemStore"});let o=null;function i(){const n=e.state;n&&o!==n.key?(t({type:"push",item:n}),o=n.key):n||t({type:"clear"})}return e.addListener(i),()=>{e.removeListener(i)}}),[]),(0,s.jsx)(n(177158).A,{open:e.length>0,zIndex:201,children:e.map((e=>(0,o.createElement)(l,{...e,key:e.item.key,dispatch:t})))})}const r=o.memo(a),l=o.memo((function(e){let{dispatch:t,isAnimatingOut:i,item:a}=e;const r=(0,n(401497).DP)(),l=(0,n(552871).L)(),d=(0,o.useCallback)((()=>{t({type:"delete",key:a.key})}),[t,a.key]),c=(0,o.useRef)(i);(0,o.useEffect)((()=>{if(!c.current&&i){const e=setTimeout(d,270);return()=>{d(),clearTimeout(e)}}c.current=i}),[i,d]);const u=a.position??"bottom",p="top"===u?{top:24}:{bottom:l};return(0,s.jsx)("div",{style:{...p,position:"fixed",left:0,width:"100%",display:"flex",zIndex:1e6,padding:4,pointerEvents:"none"},children:(0,s.jsxs)("div",{"aria-live":"polite",style:{background:r.tooltipBackground,color:r.text.contrastPrimary,borderRadius:8,padding:"11px 16px",boxShadow:r.shadowLG,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",...a.style,animationName:`snackbar-slide-in-${u}`,animationDuration:"270ms",animationTimingFunction:"ease",transitionProperty:"transform, opacity",transitionDuration:"270ms",transitionTimingFunction:"ease",transform:i?"scale(0.95)":"scale(1)",opacity:i?0:1},onTransitionEnd:i?d:void 0,children:[a.label,a.helpUrl&&(0,s.jsx)(n(296798).A,{href:a.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:r.text.contrastPrimary},children:(0,n(133033).$)({fill:r.text.contrastSecondary})}),(0,s.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:a.right})]})})}))},178998:(e,t,n)=>{n.d(t,{Z:()=>c});var o=()=>n(416726),i=()=>n(878377),s=()=>n(972435),a=()=>n(227440),r=()=>n(540758),l=()=>n(670631);const d=(0,n(959013).YK)({name:{id:"action.availableOffline.name",defaultMessage:"Available offline"}}),c=(0,o().fi)({key:"available offline",svg:n(973238).arrowInCircleDownIcon,svgWhenEnabled:n(671089).checkmarkCircleIcon,displayName:d.name,label:s().A.formatMessage(d.name),isLoading:e=>{const t=void 0===l().A.state.offlinePages,n=r().B1(e.id);return t||n&&l().A.state.isSlowWrite},isEnabled:e=>r().fF(e.id),validators:[i().SQN("download_for_offline"),i().or([i().b8R,i().wHP])],action:(e,t,o,i)=>{n(532338).lX({store:t,environment:e,analyticsFrom:i})},disabled:e=>!a().A.state.online,renderTooltip:()=>s().A.formatMessage(o().AY.unavailableOfflineTooltip),disableTooltip:e=>a().A.state.online||r().Bd(e.id)})},187859:(e,t,n)=>{n.d(t,{m:()=>o});const o=(0,n(340498).xh)("google",{default:{loader:()=>n.e(78472).then(n.bind(n,293901))},darkMode:{loader:()=>n.e(78472).then(n.bind(n,259539))}})},192940:(e,t,n)=>{n.d(t,{h:()=>s});var o=()=>n(847249),i=()=>n(37433);function s(e){return(0,o().K8)((()=>{var t;return void 0===e?0:(null===(t=(0,i().getTeamMemberCountAndSampleUserIds)(e))||void 0===t?void 0:t.memberCountWithGuests)??0}),[e])}},195795:(e,t,n)=>{n.d(t,{A:()=>x});n(898992),n(672577),n(737550);var o=n(296540),i=()=>n(484714),s=()=>n(921385),a=()=>n(953448),r=()=>n(741496),l=()=>n(845955),d=()=>n(494043),c=()=>n(847249),u=()=>n(961581);var p=()=>n(695625),m=()=>n(407054),g=()=>n(508496),f=()=>n(732770),h=()=>n(871399),y=()=>n(502438),v=()=>n(527606),b=n(474848);function x(e){const t=(0,i().v3)(),r=(0,a().J)(),[l,d]=(0,o.useState)([]),p=(0,c().K8)((()=>u().A.state.initialRenderCompleted),[]);(0,o.useEffect)((()=>{(async()=>{if(p){const{lowPriActionsWithKeyboardShortcuts:e}=await Promise.all([n.e(96346),n.e(85864),n.e(92845),n.e(71718),n.e(15498)]).then(n.bind(n,28965));d(e)}})()}),[p]);const m=(0,o.useRef)(),g=(0,o.useRef)();(0,o.useEffect)((()=>{function e(e){e.clientX===m.current&&e.clientY===g.current||(m.current=e.clientX,g.current=e.clientY,f().A.setKeyboardMode(!1))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]);const h=(0,o.useMemo)((()=>[...s().D0,...l]),[l]),y=(0,o.useMemo)((()=>function(e,t,n){const o={};for(const i of t)for(const s of i.shortcuts)o[s]=o=>M(s,o,e,t,n);return o}(t,h,r)),[t,h,r]);return(0,b.jsx)(v().k,{debugName:e.debugName,priority:e.priority,enable:e.capture,shortcuts:y})}function S(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(m().A.state.isActive&&!g().default.checkGate({gateName:"block_menu_shortcut_fix"}))}function M(e,t,n,o,i){if(!S())return;const s=y().default.state.stores,a=y().default.state.pivot||s[0],c=a&&p().T.getRectFromStore(a),u=o.find((t=>!!t.shortcuts.some((t=>t===e))&&l().F6(t,{environment:n,blocks:s,originRect:c,publicEditMode:void 0})));if(u){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=m().A.state.isActive;u.action({environment:n,blocks:s,originRect:c,publicEditMode:void 0,analyticsFrom:"keyboard_shortcut",lazyDependencies:i},t);const o=s[0];let a,l,p,y;var v;if(o)a=o.getType(),l=a?(0,d().Yt)(a,o.getFormat()):void 0,p=null===(v=o.getCollectionStore())||void 0===v?void 0:v.id,y=o.getParentCollectionIdUpToTwoLevels();(0,r().N)(n,{analyticsName:u.analyticsName,action_type:u.analyticsActionType,from:"keyboard_shortcut",block_id:null==o?void 0:o.id,block_type:a,is_toggleable:l,collection_id:p,parent_collection_id:y}),b={resetBlockMenuStore:e},f().A.setKeyboardMode(!0),h().default.reset(),g().default.checkGate({gateName:"block_menu_shortcut_fix"})&&b.resetBlockMenuStore&&m().A.reset()}var b}},196163:(e,t,n)=>{n.d(t,{T:()=>S});n(296540);var o=()=>n(401497),i=()=>n(218275),s=()=>n(84817),a=()=>n(464708),r=()=>n(493823),l=()=>n(313633),d=()=>n(296798),c=()=>n(8980),u=()=>n(554509),p=()=>n(204063),m=n(474848);const g=480,f=16/9,h=20;function y(e){const{heroMedia:t,heroElement:n,width:i}=e,s=(0,o().IS)((()=>({heroContainer:{width:i,marginLeft:-h,marginTop:-h,...t?{position:"relative",aspectRatio:f,overflow:"hidden"}:{}}})),[t,i]);return(0,m.jsx)("div",{style:s.heroContainer,children:t?(0,m.jsx)(v,{src:t.src,alt:t.alt,type:t.type}):n})}function v(e){const{alt:t,src:n,type:i}=e,s=(0,o().IS)((()=>({media:{width:"100%",height:"100%",position:"absolute",objectFit:"cover",objectPosition:"top center"}})),[]);return"image"===i?(0,m.jsx)("img",{src:n,style:s.media,alt:t}):(0,m.jsx)("video",{title:t,src:n,style:s.media,autoPlay:!0,playsInline:!0,muted:!0,loop:!0,controls:!1})}function b(e){const{title:t,body:n,badge:i,eyebrow:r}=e,l=(0,o().IS)((()=>({container:{paddingRight:4,paddingBottom:12,paddingLeft:4,paddingTop:24},title:{margin:0,textWrap:"pretty"},badge:{margin:0,alignSelf:"start"},badgeInline:{display:"inline-flex",verticalAlign:"middle",margin:"-4px 0 0 8px"}})),[]);return(0,m.jsxs)(s().Y1,{style:l.container,gap:4,children:[null!=r&&r.text?(0,m.jsxs)(s().Y1,{direction:"horizontal",align:"center-left",width:"hug",gap:4,children:[r.icon?(0,m.jsx)(c().I,{icon:r.icon}):void 0,(0,m.jsx)(u().D,{styleName:"UIRegular-14px/Regular",colorName:"primary",children:r.text})]}):null!=i&&i.text?(0,m.jsx)(a().A,{content:i.text,color:i.color,style:l.badge}):void 0,(0,m.jsxs)(u().D,{styleName:"UITitle-26px/Bold",colorName:"primary",customStyles:l.title,children:[t,null!=r&&r.text&&null!=i&&i.text?(0,m.jsx)(a().A,{content:i.text,color:i.color,style:l.badgeInline}):void 0]}),(0,m.jsx)(u().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:n})]})}function x(e){const{link:t,secondary:n,primary:a}=e,l=(0,o().IS)((e=>({container:{marginTop:16},primary:{...null!=a&&a.isFullWidth?{width:"100%"}:{},...null!=a&&a.icon?{gap:4}:{}},link:{color:e.text.secondary,borderRadius:6,padding:"4px 8px",marginLeft:-4},linkIcon:{display:"inline-block",verticalAlign:"text-bottom",marginLeft:4},secondary:{color:e.text.secondary,padding:"0 12px",borderRadius:6,height:32,display:"flex",alignItems:"center"}})),[a]),g=a?(0,m.jsxs)(p().A,{color:"black",size:a.isFullWidth?"xl":"lg",onClick:a.onClick,style:l.primary,autoFocus:!0,children:[a.icon?(0,m.jsx)(c().I,{icon:a.icon}):void 0,a.text]}):void 0;if(null!=a&&a.isFullWidth)return(0,m.jsx)("div",{style:l.container,children:g});let f=(0,m.jsx)("div",{});t&&(f=(0,m.jsx)(d().A,{onClick:t.onClick,style:l.link,external:t.external,children:(0,m.jsxs)(u().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:[t.text,t.external?(0,m.jsx)(c().I,{icon:i().arrowUpRightSquareSmallIcon,size:"sm",color:"secondary",style:l.linkIcon}):void 0]})}));const h=n?(0,m.jsx)(r().p,{onClick:n.onClick,style:l.secondary,external:n.external,children:n.text}):void 0;return(0,m.jsxs)(s().Y1,{style:l.container,direction:"horizontal",align:"center",gap:"auto",children:[f,(0,m.jsxs)(s().Y1,{direction:"horizontal",gap:8,align:"center",width:"hug",children:[h,g]})]})}function S(e){const{title:t,body:n,badge:i,eyebrow:a,heroMedia:r,heroElement:d,primary:c,secondary:u,link:p,onDismiss:f,width:v,hideCloseButton:S}=e,M=v||g,A=(0,o().IS)((e=>({container:{width:M,padding:h,position:"relative",backgroundColor:e.surface.elevated}})),[M]);return(0,m.jsxs)(s().Y1,{style:A.container,direction:"vertical",children:[r||d?(0,m.jsx)(y,{heroMedia:r,heroElement:d,width:M}):void 0,(0,m.jsx)(b,{title:t,body:n,badge:i,eyebrow:a}),(0,m.jsx)(x,{primary:c,secondary:u,link:p}),S?void 0:(0,m.jsx)(l().A,{onClick:f})]})}},201170:(e,t,n)=>{n.d(t,{HX:()=>s,Hi:()=>i().Hi,lR:()=>a});var o=()=>n(736026),i=()=>n(348337);function s(){o().A.setState({open:!0,submitted:!1,error:void 0})}function a(){o().A.setState({open:!1})}},201902:(e,t,n)=>{n.d(t,{M:()=>o});const o=(0,n(340498).xh)("page",{default:{loader:()=>n.e(82985).then(n.bind(n,982985))},small:{loader:()=>n.e(88931).then(n.bind(n,188931))},mini:{loader:()=>n.e(35189).then(n.bind(n,735189))},large:{loader:()=>n.e(86763).then(n.bind(n,686763))},extraLarge:{loader:()=>n.e(83295).then(n.bind(n,683295))}})},210748:(e,t,n)=>{n.d(t,{O:()=>r});var o=()=>n(857639),i=()=>n(134025),s=()=>n(534177),a=()=>n(751156);function r(e){var t;const{environment:n,layoutStore:r}=e,d=r.getPreviousViewsMainCollectionViewBlockPointer(),c=null===(t=r.getModuleByType("viewsMain"))||void 0===t?void 0:t.collection_view_block_pointer;if(!r.getModel()||!r.canEdit())return;const u=r.getBlockChildren(),{blocksToRemoveFromChildArray:p,clearPreviousPointer:m}=function(e){let{previousViewsMainBlockId:t,currentViewsMainBlockId:n,currentBlocksArray:o}=e;if(o.length>1)return l;const i=1===o.length?o[0]:void 0;if((0,s().O9)(n))return(0,s().O9)(t)?{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i===t&&n!==i?[t]:[]}:l;if((0,s().O9)(t)){return i===t?l:{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i?[i]:[]}}return{clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}}({previousViewsMainBlockId:null==d?void 0:d.id,currentViewsMainBlockId:null==c?void 0:c.id,currentBlocksArray:u});if(!m&&0===p.length)return;const g=m?null:d;(0,o().log)({level:"info",from:"cleanupInvalidCollectionViewBlocks",type:"resetInvalidBlockChildrenArray",data:{layoutPointer:r.pointer,expectedPreviousPointer:g,actualPreviousPointer:c??null,actualChildIds:u}}),a().createAndCommit({environment:n,userAction:"cleanupInvalidCollectionViewBlocks.fixEmptyBlockChildren",canUndo:!1,perform:e=>{if(m&&a().applyOperation({store:r,transaction:e,operation:i().op.update({pointer:r.pointer,path:["format"],args:{previousViewsMainCollectionViewBlockPointer:null}})}),p.length>0)for(const t of p)a().applyOperation({store:r,transaction:e,operation:i().op.removeChild({pointer:r.pointer,path:["blocks"],args:{id:t}})})}})}const l={clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}},211825:(e,t,n)=>{n.d(t,{G:()=>a});var o=()=>n(484714),i=()=>n(847249),s=()=>n(486130);function a(e){const t=(0,o().v3)().currentUser.id;return(0,i().K8)((()=>Boolean(void 0!==t&&e.isNonGuestMember(t,s()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()})))),[t,e])}},226916:(e,t,n)=>{n.d(t,{c:()=>v,t:()=>b});n(16280);var o=()=>n(908006),i=()=>n(388821),s=()=>n(919709),a=()=>n(970330),r=()=>n(171718),l=()=>n(319975),d=()=>n(751156),c=()=>n(62287),u=()=>n(389658),p=()=>n(972435),m=()=>n(129522),g=()=>n(351360),f=()=>n(508496),h=()=>n(75368);const y=(0,n(959013).YK)({formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}});function v(e){var t,n,s;const{environment:d,store:p,viewType:y,transaction:v}=e,b=null===(t=p.getBlockTitleStore())||void 0===t?void 0:t.getValue();f().default.checkGate({gateName:"mobile_keep_template_gallery_open"})&&h().A.state.open&&h().A.setState({open:!1});const x=p.getSpaceId()??(null===(n=g().default.state.currentSpaceStore)||void 0===n?void 0:n.id)??(null===(s=g().default.state.mainEditorCurrentBlockStore)||void 0===s?void 0:s.getSpaceId()),S=x?d.idCreator.getSpaceIdCreatorSync(x):void 0;r().j({environment:d,sourceBlockId:"root",targetBlockPointer:p.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().qP)({isInline:!1,viewType:y})),targetRecordCache:p.inMemoryRecordCache,transaction:v,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:S}),c().pd({environment:d,block:p,blockType:"collection_view_page",transaction:v}),b&&l().R9({environment:d,store:p.getBlockTitleStore(),value:b,transaction:v}),o().default.afterNextFlush((()=>{const e=m().K.findCollectionViewBlockFromStore(p);var t;e&&"handleCreated"in e&&(null===(t=e.handleCreated)||void 0===t||t.call(e))})),a().v(d,{from:"template_picker",type:"collection_view_page",creating_block_id:p.id,is_full_screen:!0,view_type:y})}async function b(e){var t,o,l;const{environment:m,store:f}=e,h=null===(t=f.getBlockTitleStore())||void 0===t?void 0:t.getValue(),{formsEditorDependency:v}=await Promise.resolve().then(n.bind(n,339034)),{formEditorActions:b}=await v.load(),x=f.getSpaceId()??(null===(o=g().default.state.currentSpaceStore)||void 0===o?void 0:o.id)??(null===(l=g().default.state.mainEditorCurrentBlockStore)||void 0===l?void 0:l.getSpaceId()),S=x?m.idCreator.getSpaceIdCreatorSync(x):void 0;d().createAndCommit({userAction:"HorizontalTemplatePicker.createForm",environment:m,canUndo:!0,perform:e=>{var t;r().j({environment:m,sourceBlockId:"root",targetBlockPointer:f.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().mT)({isInline:!1,name:(0,s().w9s)(h)?(0,s().x9d)(p().A.formatMessage(y.formDatabaseTitle)):h})),targetRecordCache:f.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:S}),c().pd({environment:m,block:f,blockType:"collection_view_page",transaction:e});const n=f.getCollectionStore(),o=null==n||null===(t=n.getModel())||void 0===t?void 0:t.getNormalizedSchema(),l=f;if(!o)throw new Error("Schema not found");const d=b.createCollectionFormEditorView({environment:m,transaction:e,collectionViewBlockStore:l,schema:o,initializeWithAllDefaultQuestions:!0});b.createResponsesCollectionView({environment:m,transaction:e,collectionViewBlockStore:l,schema:o}),a().v(m,{from:"template_picker",type:"form",creating_block_id:f.pointer.id,form_id:null==d?void 0:d.formId,view_id:l.id})}})}},233842:(e,t,n)=>{n.d(t,{u:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("notionCalendarLogo",{viewBox:"0 0 20 21",svg:(0,o.jsxs)("svg",{width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:[(0,o.jsxs)("g",{clipPath:"url(#clip0_970_53429)",children:[(0,o.jsx)("path",{d:"M2.17141 17.1924C1.81019 17.1884 1.48919 17.0958 1.23979 16.8633C1.23979 16.8633 1.23899 16.8633 1.23819 16.8617C1.20922 16.8336 1.18187 16.8046 1.15613 16.7756C0.959022 16.5504 0.852023 16.2615 0.852023 15.9494L0.849609 3.0915C0.849609 2.34732 1.47712 1.67957 2.21968 1.63371L15.0636 0.838839C15.0918 0.83723 15.1191 0.836426 15.1473 0.836426C15.4683 0.836426 15.7675 0.952277 15.996 1.16789C16.0274 1.19766 16.0572 1.22823 16.0845 1.26041C16.1585 1.34488 16.2197 1.43821 16.268 1.53877C16.2205 1.43901 16.1585 1.34569 16.0845 1.26121C16.2768 1.48487 16.3822 1.76967 16.3822 2.07861V2.40766C16.3822 2.40766 16.3902 2.67717 16.1231 2.69487L16.1247 2.69648L4.3114 3.43664C3.44494 3.49055 2.741 4.24117 2.741 5.10925C2.741 5.10925 2.73617 16.9768 2.73537 16.9961C2.72652 17.1924 2.56481 17.1924 2.43127 17.1924H2.17141Z",fill:"black"}),(0,o.jsx)("path",{d:"M19.1589 18.1882C19.1589 18.2075 19.1573 18.2269 19.1556 18.2462C19.1275 18.6589 18.7984 19.0225 18.3938 19.0973C18.3857 19.0973 18.3777 19.0998 18.3696 19.0998L4.66812 19.9292H4.62548C4.35758 19.9155 4.10979 19.8126 3.91671 19.6307C3.7003 19.4272 3.57882 19.1488 3.56997 18.8439C3.56997 18.8319 3.56836 18.8198 3.56836 18.8069V5.19278C3.56836 5.17347 3.56836 5.15497 3.56997 5.13566C3.59974 4.6988 3.96498 4.31746 4.40102 4.2724C4.41229 4.2724 4.42355 4.26919 4.43481 4.26838L17.5531 3.44616L18.1436 3.40915C18.1653 3.40754 18.187 3.40674 18.2087 3.40674C18.4557 3.40674 18.6858 3.49604 18.862 3.66097C18.9851 3.77601 19.072 3.92002 19.1186 4.08012C19.1388 4.14851 19.1508 4.22011 19.1556 4.29332V13.1785L19.1589 18.1874V18.1882Z",fill:"black"}),(0,o.jsx)("path",{d:"M20.001 4.36907C20.001 3.86302 19.8023 3.3972 19.4402 3.0577C19.0782 2.71819 18.6011 2.54763 18.0967 2.57981L17.3928 2.62245C17.2166 2.62808 17.2246 2.49212 17.2246 2.49212V2.08583C17.2246 1.49692 16.9929 0.955478 16.5722 0.560458C16.1514 0.165437 15.5955 -0.0324757 15.009 0.00372785L2.16349 0.798596C0.97121 0.872612 0.000976562 1.90482 0.000976562 3.09953L0.00339008 15.9574C0.00339008 16.5455 0.235088 17.0878 0.655844 17.4836C1.04442 17.8488 1.54724 18.0468 2.08465 18.0468C2.12889 18.0468 2.55448 18.0387 2.55448 18.0387C2.70975 18.0387 2.73549 18.1103 2.73549 18.2439V18.9012C2.73549 19.4289 2.94547 19.9157 3.32278 20.2705C3.67113 20.5979 4.12246 20.7749 4.60436 20.7749C4.62366 20.7749 4.64217 20.7733 4.66148 20.7733C4.67113 20.7733 4.67998 20.7749 4.68963 20.7749C4.73147 20.7749 4.7733 20.7733 4.81594 20.7709L18.3477 19.9519C18.4081 19.9478 18.4668 19.9406 18.5255 19.931C19.3461 19.8304 19.9994 19.1071 19.9994 18.2728L19.9978 18.2648C19.9978 18.2415 20.001 18.2181 20.001 18.1948V4.36907ZM2.17153 17.1996C1.81031 17.1956 1.48931 17.1031 1.23991 16.8705C1.23991 16.8705 1.23911 16.8705 1.23831 16.8689C1.20934 16.8408 1.18199 16.8118 1.15625 16.7829C0.959142 16.5576 0.852143 16.2688 0.852143 15.9566L0.84973 3.09873C0.84973 2.35454 1.47724 1.68679 2.2198 1.64093L15.0637 0.846063C15.0919 0.844454 15.1192 0.84365 15.1474 0.84365C15.4684 0.84365 15.7677 0.959501 15.9961 1.17511C16.0275 1.20488 16.0573 1.23545 16.0846 1.26763C16.1587 1.35211 16.2198 1.44543 16.2681 1.546C16.2206 1.44624 16.1587 1.35291 16.0846 1.26844C16.2769 1.49209 16.3823 1.7769 16.3823 2.08583V2.41488C16.3823 2.41488 16.3904 2.6844 16.1233 2.7021L16.1249 2.70371L4.31152 3.44387C3.44506 3.49777 2.74112 4.24839 2.74112 5.11647C2.74112 5.11647 2.73629 16.984 2.73549 17.0033C2.72664 17.1996 2.56493 17.1996 2.43139 17.1996H2.17153ZM19.1635 18.1948C19.1635 18.2141 19.1619 18.2334 19.1603 18.2527C19.1321 18.6654 18.8031 19.0291 18.3984 19.1039C18.3904 19.1039 18.3823 19.1063 18.3743 19.1063L4.67274 19.9358H4.6301C4.3622 19.9221 4.11441 19.8191 3.92133 19.6373C3.70492 19.4338 3.58344 19.1554 3.57459 18.8505C3.57459 18.8384 3.57298 18.8263 3.57298 18.8135V5.19934C3.57298 5.18003 3.57298 5.16152 3.57459 5.14221C3.60436 4.70536 3.9696 4.32402 4.40564 4.27896C4.41691 4.27896 4.42817 4.27574 4.43943 4.27494L17.5577 3.45272L18.1482 3.41571C18.1699 3.4141 18.1916 3.4133 18.2134 3.4133C18.4603 3.4133 18.6904 3.5026 18.8666 3.66752C18.9897 3.78257 19.0766 3.92658 19.1233 4.08668C19.1434 4.15507 19.1554 4.22667 19.1603 4.29988V13.185L19.1635 18.194V18.1948Z",fill:"white"}),(0,o.jsx)("path",{d:"M17.1877 17.7582L5.7163 18.426C5.24727 18.459 4.83215 18.2997 4.84502 17.685V8.11764C4.84502 7.7894 5.11533 7.57942 5.4138 7.56413L17.3398 6.84891C17.6375 6.83362 17.8812 7.04924 17.8812 7.34771V16.932C17.8812 17.2828 17.7935 17.7341 17.1901 17.7574H17.1885L17.1877 17.7582Z",fill:"white"}),(0,o.jsx)("path",{d:"M8.39759 10.4651C7.83685 10.4997 7.64699 10.9277 7.64779 11.5858V11.7016C7.58102 11.7177 7.5247 11.7322 7.45712 11.7362C7.05326 11.7612 6.76203 11.4329 6.76123 10.844C6.76042 9.94293 7.56654 9.09577 9.10234 9.00003C10.47 8.91475 11.3453 9.57607 11.3469 10.7426C11.3469 11.6204 10.6196 12.2439 9.90282 12.4386C11.248 12.5045 11.8095 13.2551 11.8111 14.2141C11.8127 15.8546 10.614 16.7838 8.76445 16.8988L8.71939 16.9012C7.32921 16.9881 6.35334 16.4596 6.35254 15.5472C6.35254 15.0275 6.73227 14.5882 7.30427 14.552C7.34932 14.5488 7.39357 14.5577 7.43862 14.5553C7.55206 15.4837 8.18037 15.8256 8.80789 15.787C9.41288 15.7492 9.83846 15.3413 9.83846 14.7636V14.7403C9.83766 13.8392 9.08625 13.7942 7.9535 13.7491L7.77329 12.6743C8.8272 12.4812 9.35334 12.1369 9.35254 11.5134C9.35254 10.8432 8.98166 10.4273 8.3984 10.4643H8.39759V10.4651Z",fill:"black"}),(0,o.jsx)("path",{d:"M13.4544 10.0227C12.3338 10.3469 12.0868 9.85373 12.2091 9.33803C12.8816 9.18034 14.6298 8.65579 15.2911 8.41846L15.2992 15.3374L16.5212 15.5152C16.5212 15.9657 16.2638 16.2473 15.8044 16.2762C15.4231 16.2996 14.5373 16.3317 14.1117 16.3583C13.4504 16.3993 12.2396 16.4983 12.2396 16.4983C12.2058 16.4082 12.1946 16.3165 12.1946 16.2352C12.1946 16.0156 12.2839 15.7903 12.5751 15.6913L13.4601 15.4049L13.4536 10.0227H13.4544Z",fill:"black"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_970_53429",children:(0,o.jsx)("rect",{width:"20",height:"20.7752",fill:"white"})})})]})})},236190:(e,t,n)=>{n.d(t,{c:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("minus",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.037 8.844h9.92a.705.705 0 00.368-.103.825.825 0 00.28-.28.73.73 0 000-.773.752.752 0 00-.28-.28.705.705 0 00-.369-.102H3.037a.705.705 0 00-.369.102.824.824 0 00-.28.28.73.73 0 000 .772.914.914 0 00.28.281.705.705 0 00.37.103z"})})},237829:(e,t,n)=>{n.d(t,{X:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("checkedRoundedCheckmark",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7.99617 16C12.3807 16 15.9923 12.3807 15.9923 7.99617C15.9923 3.61167 12.373 0 7.99617 0C3.61167 0 0 3.61167 0 7.99617C0 12.3807 3.61167 16 7.99617 16ZM7.99617 14.2018C4.5605 14.2018 1.80583 11.4319 1.80583 7.99617C1.80583 4.5605 4.55285 1.79818 7.99617 1.79818C11.4319 1.79818 14.1942 4.5605 14.2018 7.99617C14.2018 11.4319 11.4319 14.2018 7.99617 14.2018ZM7.18508 11.6461C7.47585 11.6461 7.73601 11.4931 7.912 11.2329L11.3324 5.96078C11.4395 5.79244 11.5237 5.60115 11.5237 5.42516C11.5237 5.01196 11.1564 4.72119 10.7585 4.72119C10.506 4.72119 10.2841 4.86657 10.1081 5.14969L7.16212 9.84027L5.80775 8.14921C5.6241 7.912 5.43281 7.82783 5.18795 7.82783C4.7824 7.82783 4.45337 8.14921 4.45337 8.56241C4.45337 8.76136 4.52224 8.93735 4.66762 9.12099L6.42755 11.2406C6.6418 11.5084 6.87901 11.6461 7.18508 11.6461Z"})})},271459:(e,t,n)=>{n.r(t),n.d(t,{TopbarStopSuggestModeButton:()=>w});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(66913),l=()=>n(880922),d=()=>n(959013),c=()=>n(473227),u=()=>n(755199),p=()=>n(614415),m=()=>n(745766),g=()=>n(645873),f=()=>n(737230),h=()=>n(962730),y=()=>n(351360),v=()=>n(948914),b=()=>n(704152),x=()=>n(953006),S=n(474848);const M=(0,d().YK)({stopSuggestRole:{defaultMessage:"Turn off suggesting",id:"topbar.stopsuggestmodel."},tooltip:{defaultMessage:"You’re suggesting",id:"topbarStopSuggestModeButton.tooltip"},tooltipCommentOnlyContent:{defaultMessage:"Suggest edits or add comments",id:"topbarStopSuggestModeButton.tooltipCommentOnlyContent"}});function A(e){let{store:t,isVisible:n,compact:u,framerMotion:p}=e;const g=(0,i().v3)(),h=(0,d().tz)(),y=(0,s().O$)(v().b),x=(0,s().K8)((()=>f().Ay.state.expanded),[]),A=(0,a().IS)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:256,color:e.text.uiBluePrimary,gap:0,height:28,background:e.accentColors.uiBlue[100],...(0,m().g)({noDrag:g.device.isElectron&&!y})},hoveredButton:{background:e.accentColors.uiBlue[200]},pressedButton:{background:e.accentColors.uiBlue[300]},suggestionIcon:{height:18,width:18,marginLeft:9,marginRight:7},text:{fontSize:14,lineHeight:1.428,marginRight:7},closeIcon:{height:14,width:14,fill:e.text.uiBlueSecondary,marginRight:9}})),[g.device.isElectron,y]),w=(0,o.useCallback)((()=>{c().PD({environment:g,navigableBlockStore:t,mode:"default",location:"stop_suggest_pill"})}),[g,t]),j=(0,o.useRef)(null),{AnimatePresence:C,motion:I}=p;return(0,S.jsx)(C,{children:n&&(0,S.jsxs)(I.div,{ref:j,initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.1},children:[(0,S.jsxs)(b().A,{style:A.button,hoveredStyle:A.hoveredButton,pressedStyle:A.pressedButton,onClick:w,ariaLabel:h.formatMessage(M.stopSuggestRole),children:[(0,l().A)(A.suggestionIcon),(0,S.jsx)(C,{initial:x,children:!u&&!x&&(0,S.jsx)(I.div,{initial:{width:0},exit:{width:0},animate:{width:"auto"},transition:{duration:.1},style:A.text,children:(0,S.jsx)(d().sA,{id:"topbar.stopsuggestmodel.label",defaultMessage:"Suggesting"})})}),(0,r().V)(A.closeIcon)]},"button"),!u&&!x&&(0,S.jsx)(k,{store:t,origin:j})]})})}function w(e){const{value:t}=(0,g().fJ)(p().fM);return t?(0,S.jsx)(A,{...e,framerMotion:t}):null}function k(e){const{store:t,origin:n}=e,a=(0,d().tz)(),r=(0,i().v3)(),l=(0,s().K8)((()=>t.isCommentOnly()),[t]),c=(0,s().K8)((()=>{var e;return null===(e=y().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.dismissed_suggest_mode_tooltip}),[]),p=l||!c,[m,g]=(0,o.useState)(p);return m?(0,S.jsx)(x().k,{origin:n,alignmentToOrigin:h().C.Center,placementToOrigin:"bottom",header:(0,S.jsx)(S.Fragment,{children:a.formatMessage(M.tooltip)}),content:l?a.formatMessage(M.tooltipCommentOnlyContent):null,headerStyle:{marginBottom:-2,width:"max-content",maxWidth:240},contentStyle:{width:"max-content",maxWidth:240},hideCloseButton:!0,shouldDismissUponOutsideClick:!0,onCloseClick:()=>{g(!1),u().eO({environment:r,dismissed:!0})},pointerPosition:"50%",pointerLength:24}):null}},273321:(e,t,n)=>{n.d(t,{A:()=>T});var o=n(296540),i=()=>n(790748),s=()=>n(847249),a=()=>n(401497),r=()=>n(713998),l=()=>n(797809),d=()=>n(959013),c=()=>n(284371),u=()=>n(710648),p=()=>n(678553),m=()=>n(125565),g=()=>n(862292),f=()=>n(186445),h=()=>n(972435),y=()=>n(480289),v=()=>n(351360),b=()=>n(441467),x=()=>n(848565),S=()=>n(493319),M=()=>n(555776),A=()=>n(116008),w=()=>n(811879),k=()=>n(846583),j=()=>n(640753),C=()=>n(105157),I=n(474848);function T(e){const{environment:t,menuListItemProps:n,shouldShowTopDividerLine:T,shouldShowBottomDividerLine:_,shouldExpandDiscussionWidth:P,noBackgroundColors:B,onMouseEnter:R,onMouseLeave:L,onFocus:D,onBlur:O}=e,N=(0,s().O$)(v().AppStoreMainEditorCurrentBlockStore),E=(0,s().K8)((()=>(0,f()._m)(t)),[t]),U=x().eQ,F=(0,s().K8)((()=>M().A.state.isActivelyComposing),[]),V=(0,s().K8)((()=>M().A.state.isHovered),[]),K=(0,o.useCallback)((()=>{null==R||R()}),[R]),H=(0,o.useCallback)((()=>{null==L||L()}),[L]),z=(0,o.useCallback)((()=>{null==D||D()}),[D]),W=(0,o.useCallback)((()=>{A().A.hasContent()?M().A.resetAllActiveSources():(A().A.reset(),M().A.reset()),null==O||O()}),[O]),G=(0,d().tz)(),Y=(0,o.useRef)(null);(0,i().b)(y().A,(()=>({getNode:()=>Y.current})),[]);const q=(0,a().IS)((e=>({menuDiscussionItem:{marginLeft:-14,marginRight:-14,width:"calc(100% + 28px)"},discussionContainer:{paddingTop:t.device.isMobile?4:6,borderTop:!t.device.isMobile&&T?`1px solid ${e.regularDividerColor}`:void 0,borderBottom:!t.device.isMobile&&_?`1px solid ${e.regularDividerColor}`:void 0,transition:"background 300ms ease",background:B?void 0:F?e.focusDiscussionBackground:V?e.hoveredDiscussionBackground:void 0},comment:{position:"relative",fontSize:14},commentElementsBelowUserRow:{paddingLeft:x().FB},avatar:{marginTop:0,marginRight:8,userSelect:"none",WebkitUserSelect:"none"},userRow:{display:"flex",flexDirection:"row",alignItems:"center",userSelect:"none",WebkitUserSelect:"none"},placeholder:{height:8,width:81,borderRadius:6,background:e.lightDividerColor},draftLabel:{margin:"0 6px",flexBasis:140,whiteSpace:"normal",flexGrow:void 0,display:"inline",color:e.text.tertiary},commentAuthorPlaceholder:{marginRight:8,marginTop:2,height:U,width:U,borderRadius:20,flexShrink:0},container:{paddingTop:x().e4,paddingRight:16,paddingBottom:x().Wv,paddingLeft:16},noOverflow:{overflow:"hidden"},commentContext:{display:"flex",width:"100%",marginTop:6,marginBottom:22,fontSize:13,color:e.text.secondary},displayName:{fontWeight:c().Wy.medium,whiteSpace:"normal"},fullWidthFlex:{display:"flex",width:"100%"},smallTopPadding:{marginTop:1}})),[U,t.device.isMobile,V,F,B,_,T]),$=(0,o.useCallback)((async()=>{const e=await g().T.formulas.load();b().i5({environment:t,allowActionsWhileCommenting:!0,formulasModule:e})}),[t]),Q=(0,s().K8)((()=>!A().A.state.open||"reaction"===A().A.state.content),[]),Z=(0,s().K8)((()=>{var e;return A().A.getBlockStore()??(null===(e=A().A.getClosestBlockStore())||void 0===e?void 0:e.parentBlockStore)}),[]),X=(0,s().K8)((()=>A().A.getPropertyId()),[]),J=(0,s().K8)((()=>{if(X){var e;const t=null===(e=A().A.getBlockStore())||void 0===e?void 0:e.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const n=t.getSchema();return(0,r()._g)({schema:n,property:X})}}),[X]),ee=(0,s().K8)((()=>(0,l().RX)(h().A.getIntl()).title),[]),te=(0,s().O$)(A().f),ne=(0,s().K8)((()=>null==E?void 0:E.getDisplayName(G)),[E,G]),oe=(0,s().K8)((()=>null==Z?void 0:Z.getSpaceId()),[Z]),ie=(0,s().K8)((()=>b().Ek({environment:t})),[t]),se=(0,s().K8)((()=>A().A.getType()),[]),ae=(0,s().K8)((()=>null==Z?void 0:Z.getValue()),[Z]);if(Q||!ee||!E||!Z||!N||!te||!oe||!ae&&"block"===se||!ie&&"inline"===se)return null;const re="inline"===se||X,le="block"===se&&!X?(0,I.jsx)(u().Ay,{blockValue:ae,rootStore:Z,blockPreviewLocation:"comments_sidebar"}):re?(0,I.jsx)(u().vY,{value:{value:(null==ie?void 0:ie.context)??[],spaceId:oe},propertySchema:ee,labeled:!1,rootStore:Z,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0}):null;return(0,I.jsx)("div",{style:q.discussionContainer,ref:Y,onClick:null==n?void 0:n.onClick,onMouseEnter:K,onMouseLeave:H,children:(0,I.jsx)(p().Ay,{allowTextSelection:!0,style:q.menuDiscussionItem,title:(0,I.jsx)("div",{style:q.container,children:(0,I.jsxs)("div",{style:q.comment,children:[(0,I.jsxs)("div",{style:q.userRow,children:[(0,I.jsx)(w().E,{authorStore:E,avatarSize:U,avatarStyle:q.avatar,placeholderStyle:q.commentAuthorPlaceholder}),(0,I.jsxs)("div",{style:q.noOverflow,children:[(0,I.jsx)("span",{style:q.displayName,children:ne||(0,I.jsx)("span",{style:q.placeholder})}),(0,I.jsx)(m().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:q.draftLabel,children:(0,I.jsx)(d().sA,{defaultMessage:"Draft",id:"DraftCommentInputWithContext.draftLabel"})})]})]}),(0,I.jsxs)("div",{style:q.commentElementsBelowUserRow,children:[(0,I.jsx)("div",{style:q.commentContext,children:(0,I.jsxs)("div",{style:q.fullWidthFlex,children:[(0,I.jsx)(k().T,{}),J&&(0,I.jsx)(C().A,{propertySchema:J}),(0,I.jsx)("div",{style:q.smallTopPadding,children:le})]})}),(0,I.jsx)(j().A,{showAvatar:!1,parentStore:N,blockStore:Z,onSubmit:$,discussionInputStore:te,isNewComment:!0,isEditingExistingComment:!1,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:S().DiscussionFormat.Sidebar,canDrop:!0,disableFocusRing:!0,adjustWidthForDraftDiscussions:P,dontMoveCursorToInputEndOnFocus:!0,onBlur:W,onFocus:z},"draft-comment-sidebar")]})]})})})},"draft-comment-discussion-updates")}},274234:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Be});var o=n(296540),i=()=>n(662303),s=()=>n(484714),a=()=>n(847249),r=()=>n(604995),l=()=>n(416504),d=()=>n(971404),c=()=>n(959013),u=()=>n(722872),p=()=>n(963589),m=()=>n(691298),g=()=>n(117586),f=()=>n(594739),h=()=>n(805751),y=()=>n(928600),v=()=>n(480095),b=()=>n(89924),x=()=>n(597777),S=()=>n(760217),M=()=>n(946548),A=n(474848);function w(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("date"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:"00:00",time_zone:(0,l().P)(),reminder:t.reminder&&x().ex(t.reminder)};null==n||n(e)}else if("daterange"===t.type){const e={type:"datetimerange",start_date:t.start_date,start_time:"00:00",end_date:t.end_date,end_time:"00:00",time_zone:(0,l().P)(),reminder:t.reminder&&x().ex(t.reminder)};null==n||n(e)}else if("datetime"===t.type){const e={type:"date",start_date:t.start_date,reminder:t.reminder&&x().vW(t.reminder,(0,l().P)())};null==n||n(e)}else{const e={type:"daterange",start_date:t.start_date,end_date:t.end_date,reminder:t.reminder&&x().vW(t.reminder,(0,l().P)())};null==n||n(e)}}),[t,n]);return(0,A.jsx)(S().A,{focused:!1,onClick:i,title:(0,A.jsx)(c().sA,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,A.jsx)(M().A,{on:"date"!==t.type&&"daterange"!==t.type,onClick:i})})}var k=()=>n(244641),j=()=>n(595555),C=()=>n(401497),I=()=>n(100622),T=()=>n(534177),_=()=>n(284371),P=()=>n(541181),B=()=>n(805025),R=()=>n(807778),L=()=>n(704152),D=()=>n(493823),O=()=>n(498140),N=()=>n(458366);const E=Object.freeze({backgroundColor:I().Ay.blue,color:I().Ay.white}),U=Object.freeze({backgroundColor:I().Ay.blueWithAlpha(.43)});function F(e,t){switch(e){case g().dz.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case g().dz.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case g().dz.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}function V(e,t,n){return void 0===e||"relative"===e||"ll"===e?x().WA(Y(n,t)):x().c1(e)}function K(e,t){return e&&(e!==x().jk||t)?x().B4(e):x()._g}function H(){return(0,d().X)(i().locale).time}function z(e,t,n){return(0,O().FM)(e,K(t,!1),n)}function W(e,t,n,o,i){return o.device.isMobile?(0,O().yc)(e,r().tr,t):(0,O().yc)(e,V(n,t,i),t)}function G(e,t,n,o){return!e||"number"==typeof e&&isNaN(e)?t&&(0,N().NN)(t)?function(e,t){var n,o;const i=(null==t||null===(n=t.getPropertyTypeSpecificConfig("date"))||void 0===n?void 0:n.endDate)??!1,s=(null==t||null===(o=t.getPropertyTypeSpecificConfig("date"))||void 0===o?void 0:o.includeTime)??!1,a=r().vF({timezone:(0,l().P)()});if(i&&s)return r().NC(a.startOf("day").valueOf(),a.startOf("day").valueOf(),(0,l().P)());if(i)return r().Mk(a.valueOf(),a.valueOf(),(0,l().P)());if(s)return r().Xo(a.startOf("day"));return e}(n,o):n:e}function Y(e,t){return e||t.locale}function q(e,t,n){return"date"===e.type?{...e,type:"daterange",end_date:t||e.start_date}:"datetime"===e.type?{...e,type:"datetimerange",end_date:t||e.start_date,end_time:n||e.start_time}:void(0,T().HB)(e)}function $(e){let{store:t,dateValue:n,disabled:d,firstDayOfWeek:m,onChangeValue:f}=e;const h=(0,s().v3)(),y=(0,s().Y0)(),v=(0,u().Tf)(),b=(0,p().X)("nds_datepicker_refresh"),S=(0,a().K8)((()=>(0,R().D$)(h)),[h]),{focus:M,currentMonth:w}=(0,a().K8)((()=>({focus:t.state.focus,currentMonth:t.state.currentMonth})),[t]),O=(0,C().IS)((e=>({container:{textAlign:"center",...y.isMobile?{padding:"16px 14px 16px",background:e.popoverBackground,...!v&&{borderBottom:`1px solid ${e.regularDividerColor}`}}:{padding:b?`0 ${B().Qm}px`:"4px 0 4px"}},todayButton:{width:43,height:20},button:{background:"none",border:"none",cursor:"pointer",padding:0,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3},navButtonSize:{width:20,height:20},navButton:{width:"11px",height:"17px",color:I().Ay.uiGray}})),[y.isMobile,v,b]),N=r().AA(n,(0,l().P)()),F=w||N.start,V=N.start.toJSDate(),K=M===g().xQ.StartDate||M===g().xQ.StartTime,H=(0,o.useCallback)(((e,o,i)=>{if(d)return;const s=k().c9.fromJSDate(e).setLocale(x().M5).toFormat(r().tr);if(i.shiftKey&&("date"===n.type||"datetime"===n.type)){const e=q(n,s);return null==f||f(e),void t.setState({...t.state,focus:g().xQ.EndDate})}let a;if(x().oM(n)||x().L3(n)){M===g().xQ.StartDate||M===g().xQ.StartTime?a={...n,start_date:s}:M===g().xQ.EndDate||M===g().xQ.EndTime?a={...n,end_date:s}:(0,T().HB)(M);const e=r().AA(a,(0,l().P)());e.end<e.start&&(x().oM(a)?a={...a,start_date:a.end_date,end_date:a.start_date}:x().L3(a)?a={...a,start_date:a.end_date,start_time:a.end_time,end_date:a.start_date,end_time:a.start_time}:(0,T().HB)(a),t.setState({...t.state,focus:M===g().xQ.StartDate||M===g().xQ.StartTime?g().xQ.EndDate:g().xQ.StartDate})),t.setState({...t.state,focus:M===g().xQ.StartDate||M===g().xQ.StartTime?g().xQ.EndDate:g().xQ.StartDate})}else a={...n,start_date:s};t.setState({...t.state,error:{...t.state.error,[M]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[M]:void 0}}),null==f||f(a)}),[n,d,M,f,t]),z=(0,o.useCallback)((e=>{t.setState({...t.state,currentMonth:k().c9.fromJSDate(e)})}),[t]),W=(0,o.useMemo)((()=>({todayButtonLabel:{id:"datePicker.todayButton.label",defaultMessage:"Today",description:"Label for the button that selects today's date in the calendar"},previousMonthLabel:{id:"datePicker.previousMonth.label",defaultMessage:"Go to previous month",description:"Aria label for the button that navigates to the previous month"},nextMonthLabel:{id:"datePicker.nextMonth.label",defaultMessage:"Go to next month",description:"Aria label for the button that navigates to the next month"}})),[]),G=(0,o.useMemo)((()=>{if(N.end){const e=N.end.toJSDate();return{modifiers:{range:{from:V,to:e},...K?{end:e,start:V}:{start:V,end:e}},modifiersStyles:{range:{backgroundColor:b?"transparent":I().Ay.blueWithAlpha(.15)},start:K?E:U,end:K?U:E}}}return{selected:V,modifiers:{start:V},modifiersStyles:{start:E}}}),[N.end,V,K,b]),Y=(0,o.useCallback)((e=>(0,A.jsx)("div",{className:"notion-calendar-caption",children:(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,A.jsx)(j().$J,{displayMonth:e.displayMonth}),(0,A.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,A.jsx)(D().p,{onClick:e=>{z(k().c9.now().toJSDate()),H(k().c9.now().toJSDate(),{},e)},isGray:!0,style:{...O.button,...O.todayButton,fontSize:12,fontWeight:_().Wy.medium},children:(0,A.jsx)(c().sA,{...W.todayButtonLabel})}),(0,A.jsx)(L().A,{onClick:()=>z(k().c9.fromJSDate(e.displayMonth).minus({months:1}).toJSDate()),style:{...O.button,...O.navButtonSize},"aria-label":W.previousMonthLabel.defaultMessage,children:(0,A.jsx)(j().Bu,{style:O.navButton})}),(0,A.jsx)(L().A,{onClick:()=>z(k().c9.fromJSDate(e.displayMonth).plus({months:1}).toJSDate()),style:{...O.button,...O.navButtonSize},"aria-label":W.nextMonthLabel.defaultMessage,children:(0,A.jsx)(j()._l,{style:O.navButton})})]})]})})),[H,O.button,O.navButtonSize,O.todayButton,O.navButton,z,W.nextMonthLabel,W.previousMonthLabel,W.todayButtonLabel]);return(0,A.jsx)("div",{style:O.container,children:S?(0,A.jsx)(P().n,{className:"notion-date-property-menu notranslate",components:{Caption:Y},numberOfMonths:1,weekStartsOn:m,defaultMonth:F.toJSDate(),month:F.toJSDate(),locale:i().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:H,onMonthSelected:z,...G}):(0,A.jsx)(P().n,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:m,defaultMonth:F.toJSDate(),month:F.toJSDate(),locale:i().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:H,onMonthSelected:z,...G})})}function Q(e){let{onChangeValue:t}=e;const n=(0,o.useCallback)((()=>{null==t||t(void 0)}),[t]);return(0,A.jsx)(S().A,{focused:!1,onClick:n,title:(0,A.jsx)(c().sA,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}function Z(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("datetimerange"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:t.start_time,time_zone:t.time_zone,reminder:t.reminder};null==n||n(e)}else if("daterange"===t.type){const e={type:"date",start_date:t.start_date,reminder:t.reminder};null==n||n(e)}else{const e=q(t);null==n||n(e)}}),[t,n]);return(0,A.jsx)(S().A,{focused:!1,onClick:i,title:(0,A.jsx)(c().sA,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,A.jsx)(M().A,{on:"daterange"===t.type||"datetimerange"===t.type,onClick:i})})}n(581454);const X=(0,c().YK)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function J(e){const{reminder:t,shouldShowTime:n,intl:o,formatTime:i}=e;if(!t)return o.formatMessage(X.none);if(x().fc(t)){const{unit:e,value:s,time:a}=t,r=i({start_time:a,time_format:"LT",humanReadable:!0,intl:o}),l=n?`(${r})`:"";return 0===s?o.formatMessage(X.onTheDay,{formattedTimeText:l}):"day"===e?o.formatMessage(X.daysBefore,{formattedTimeText:l,numberOfDays:s}):"year"===e?o.formatMessage(X.yearsBefore,{formattedTimeText:l,numberOfYears:s}):"month"===e?o.formatMessage(X.monthsBefore,{formattedTimeText:l,numberOfMonths:s}):o.formatMessage(X.weeksBefore,{formattedTimeText:l,numberOfWeeks:s})}{const{unit:e,value:n}=t;return 0===n?o.formatMessage(X.atTimeOf):"hour"===e?o.formatMessage(X.hoursBefore,{numberOfHours:n}):o.formatMessage(X.minutesBefore,{numberOfMinutes:n})}}var ee=()=>n(869190),te=()=>n(68913),ne=()=>n(496603),oe=()=>n(989423);var ie=()=>n(406699),se=()=>n(113474),ae=()=>n(939740),re=()=>n(8980);function le(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,p().X)("nds_datepicker_refresh"),a=(0,s().v3)(),{device:r}=a,d=(0,c().tz)(),m=(0,p().X)("db_ux_mobile"),g=(0,o.useCallback)((e=>{e?x().fc(e)?null==n||n({...t,reminder:{...e,defaultTimeZone:(0,l().P)()}}):"datetime"!==t.type&&"datetimerange"!==t.type||null==n||n({...t,reminder:e}):null==n||n({...t,reminder:e}),function(e,t){oe().vd(e,"set_reminder",{date:t.date,reminder:t.reminder})}(a,{date:t,reminder:e})}),[t,a,n]),f=(0,o.useCallback)((e=>(0,A.jsx)(se()._,{...e,icon:i?void 0:(0,A.jsx)(re().I,{icon:te().alarmIcon}),title:(0,A.jsx)(c().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:r.isMobile,chevronType:"right",right:J({reminder:t.reminder,intl:d,formatTime:ee().fU})})),[t.reminder,r.isMobile,d,i]),h=(0,o.useCallback)((e=>{let n;n=r.isMobile?{menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),...!m&&{right:(0,A.jsx)(v().DoneMenuText,{}),onClickRight:e.close}}:{menuType:u().gu.Popup,width:250};const o=("date"===t.type||"daterange"===t.type?x().vK:x().SA).map((n=>{const o=J({reminder:n,shouldShowTime:!0,intl:d,formatTime:ee().fU});return{key:o,action:()=>{g(n),e.close()},render:e=>(0,A.jsx)(S().A,{...e,title:o,isChecked:ne().n4(n,t.reminder)})}}));return(0,A.jsx)(y().A,{...n,children:(0,A.jsx)(ae().Ay,{type:ae().Oh.Vertical,sections:[{key:"reminder section",render:e=>(0,A.jsx)(b().A,{...e}),items:o}],initialFocus:void 0})})}),[t.type,t.reminder,r.isMobile,d,g,m]);return(0,A.jsx)(ie().Ay,{popupType:r.isMobile?m?ie().z7.BottomSheet:ie().z7.SlideUp:ie().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:ie().sx.Right,renderOrigin:f,render:h})}function de(e){let{dateValue:t,shouldShowReminder:n,shouldShowEndDateControl:o,shouldShowAllDayControl:i,onChangeValue:a}=e;return(0,s().Y0)().isMobile?n||o||i?(0,A.jsxs)(b().A,{topBorder:!0,children:[n&&(0,A.jsx)(le,{dateValue:t,onChangeValue:a}),o&&(0,A.jsx)(Z,{dateValue:t,onChangeValue:a}),i&&(0,A.jsx)(w,{dateValue:t,onChangeValue:a})]}):null:(0,A.jsxs)(A.Fragment,{children:[n&&(0,A.jsx)(b().A,{topBorder:!0,children:(0,A.jsx)(le,{dateValue:t,onChangeValue:a})}),(o||i)&&(0,A.jsxs)(b().A,{topBorder:!0,children:[o&&(0,A.jsx)(Z,{dateValue:t,onChangeValue:a}),i&&(0,A.jsx)(w,{dateValue:t,onChangeValue:a})]})]})}var ce=()=>n(933117);function ue(e){let{dateFormat:t,onChangeDateFormat:n}=e;const i=(0,p().X)("nds_datepicker_refresh"),a=(0,p().X)("db_ux_mobile"),{isMobile:r}=(0,s().Y0)(),l=(0,c().tz)(),d=t||x().vz,m=(0,o.useCallback)((e=>e),[]),g=(0,o.useCallback)((e=>{null==n||n(e)}),[n]),f=(0,o.useCallback)((e=>(0,A.jsx)(S().A,{...e,title:l.formatMessage(x().xz[e.value])})),[l]),h=(0,o.useCallback)((e=>(0,A.jsx)(se()._,{...e,focused:!1,title:(0,A.jsx)(c().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),showExtensionArrow:r,chevronType:i?"right":"down",right:d?l.formatMessage(x().xz[d]):(0,A.jsx)(c().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"})})),[d,l,i,r]),M=(0,o.useMemo)((()=>({menuTitle:l.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:x().wJ,getKey:m,selectedItem:d,onSelect:g,renderItem:f,renderOrigin:h})),[d,m,l,g,f,h]);if(i){const e=e=>{const t=x().wJ.map((t=>({key:t,action:()=>{g(t),e.close()},render:e=>(0,A.jsx)(S().A,{...e,title:l.formatMessage(x().xz[t]),isChecked:t===d})})));let n={menuType:u().gu.Popup};return r&&(n={menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),...!a&&{right:(0,A.jsx)(v().DoneMenuText,{}),onClickRight:e.close}}),(0,A.jsx)(y().A,{...n,children:(0,A.jsx)(ae().Ay,{type:ae().Oh.Vertical,initialFocus:void 0,sections:[{key:"date format section",render:e=>(0,A.jsx)(b().A,{...e}),items:t}]})})};return(0,A.jsx)(ie().Ay,{popupType:r?ie().z7.BottomSheet:ie().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:ie().sx.Right,renderOrigin:h,render:e})}return(0,A.jsx)(ce().A,{...M})}var pe=()=>n(304422);function me(e){let{dateValue:t,timeFormat:n,onChangeTimeFormat:i}=e;const a=(0,p().X)("nds_datepicker_refresh"),r=(0,p().X)("db_ux_mobile"),{isMobile:l}=(0,s().Y0)(),d=(0,c().tz)(),m="date"===t.type||"daterange"===t.type,g=K(n,!0),f=function(e){const t=K(e,!0),n=H();for(const o in n)if(n[o]===t)return o;return"12h"}(n),h=H(),M=(0,o.useCallback)((e=>e),[]),w=(0,o.useCallback)((e=>{const t=h[e];null==i||i(t)}),[i,h]),k=(0,o.useCallback)((e=>(0,A.jsx)(S().A,{...e,title:d.formatMessage(x().px[e.value])})),[d]),j=(0,o.useCallback)((e=>(0,A.jsx)(se()._,{...e,focused:!1,title:(0,A.jsx)(c().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:m,showExtensionArrow:l,chevronType:a?"right":"down",right:!m&&(g?d.formatMessage(x().px[f]):(0,A.jsx)(c().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"}))})),[d,m,a,l,f,g]),C=(0,o.useMemo)((()=>({menuTitle:d.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:x().ZD,selectedItem:f,disabled:m,getKey:M,onSelect:w,renderItem:k,renderOrigin:j})),[M,d,m,w,k,j,f]);if(a){if(m)return null;const e=e=>{const t=x().ZD.map((t=>({key:t,action:()=>{w(t),e.close()},render:e=>(0,A.jsx)(S().A,{...e,title:d.formatMessage(x().px[t]),isChecked:t===f})})));let n={menuType:u().gu.Popup};return l&&(n={menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.mobileTimeFormatModal.title"}),...!r&&{right:(0,A.jsx)(v().DoneMenuText,{}),onClickRight:e.close}}),(0,A.jsx)(y().A,{...n,children:(0,A.jsx)(ae().Ay,{type:ae().Oh.Vertical,initialFocus:void 0,sections:[{key:"time format section",render:e=>(0,A.jsx)(b().A,{...e}),items:t}]})})};return(0,A.jsx)(ie().Ay,{popupType:l?ie().z7.BottomSheet:ie().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:ie().sx.Right,renderOrigin:j,render:e})}return(0,A.jsx)(ce().A,{...C})}function ge(e){const{dateValue:t,dateFormat:n,timeFormat:a,onChangeDateFormat:m,onChangeTimeFormat:g,onChangeValue:f}=e,h=(0,s().Y0)(),x=!d().V.includes(i().locale),M="date"===t.type||"daterange"===t.type,w="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,l().P)(),k=(0,o.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const n={...t,time_zone:e};null==f||f(n)}}),[t,f]),j=(0,p().X)("db_ux_mobile");return(0,A.jsxs)(A.Fragment,{children:[!M&&(0,A.jsx)(pe().G,{enableRecents:!0,placementToOrigin:ie().sx.Right,currentValue:w,onSelect:k,renderOrigin:e=>(0,A.jsx)(se()._,{...e,title:(0,A.jsx)(c().sA,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!M&&r().GF(w),chevronType:"right"})}),(0,A.jsx)(ie().Ay,{popupType:h.isMobile?j?ie().z7.BottomSheet:ie().z7.SlideUp:ie().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:ie().sx.Right,renderOrigin:e=>(0,A.jsx)(S().A,{...e,title:(0,A.jsx)(c().sA,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.label"}),focused:!1,showExtensionArrow:!0}),render:e=>{let o;return o=h.isMobile?{menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.title"}),...!j&&{right:(0,A.jsx)(v().DoneMenuText,{}),onClickRight:e.close}}:{menuType:u().gu.Popup,width:250},(0,A.jsx)(y().A,{...o,children:(0,A.jsxs)(b().A,{children:[(0,A.jsx)(ue,{dateFormat:n,onChangeDateFormat:m}),x&&(0,A.jsx)(me,{dateValue:t,timeFormat:a,onChangeTimeFormat:g})]})})}})]})}var fe=()=>n(720665),he=()=>n(962730),ye=()=>n(623580),ve=()=>n(859428);const be=12;function xe(e){let{store:t,disabled:n,locale:i,format:d,dateFormat:u,timeFormat:m,dateValue:f,formQuestionStore:h,onChangeValue:y}=e;const v=(0,s().v3)(),{device:b,WindowSizeStore:S}=v,M=(0,c().tz)(),w=(0,p().X)("nds_datepicker_refresh"),{focus:k,inputTemporaryValue:j,error:I}=(0,a().K8)((()=>({focus:t.state.focus,inputTemporaryValue:t.state.inputTemporaryValue,error:t.state.error})),[t]),{formQuestionHasEndDate:_,formQuestionIncludesTime:P}=(0,a().K8)((()=>{var e,t;return{formQuestionHasEndDate:(null==h||null===(e=h.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1,formQuestionIncludesTime:(null==h||null===(t=h.getPropertyTypeSpecificConfig("date"))||void 0===t?void 0:t.includeTime)??!1}}),[h]),R=(0,o.useMemo)((()=>r().AA(f,(0,l().P)(),Y(i,M))),[f,i,M]),L=d&&(0,N().NN)(d)?P:"datetime"===f.type||"datetimerange"===f.type,D=d&&(0,N().NN)(d)?_:"daterange"===f.type||"datetimerange"===f.type,O=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startDate;if(!e)return;const n=W(e,M,u,v,i);if(!n)return g().dz.InvalidDate;const o={...f,start_date:n},s=r().Dz(o);if(!s)return g().dz.InvalidRange;t.setState({...t.state,currentMonth:s.start,error:{...t.state.error,[g().xQ.StartDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.StartDate]:void 0}}),null==y||y(o)}),[u,f,v,M,i,y,t]),E=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startTime;if(!e)return;const n=z(e,m,M);if(!n)return g().dz.InvalidTime;if(x().L3(f)){const{newDate:e,currentMonth:o}=r().uj({previous:f,updatedStartTime:n});t.setState({...t.state,currentMonth:o,error:{...t.state.error,[g().xQ.StartTime]:void 0,[g().xQ.EndDate]:void 0,[g().xQ.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.StartTime]:void 0}}),null==y||y(e)}else{if(!x().Ar(f))return g().dz.InvalidTime;{const e={...f,start_time:n},o=r().Dz(e);t.setState({...t.state,currentMonth:o.start,error:{...t.state.error,[g().xQ.StartTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.StartTime]:void 0}}),null==y||y(e)}}}),[f,M,y,t,m]),U=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endDate;if(!e)return;const n=W(e,M,u,v,i);if(!n)return g().dz.InvalidDate;if(!x().oM(f)&&!x().L3(f))return;const o={...f,end_date:n},s=r().Dz(o);if(!s)return g().dz.InvalidRange;t.setState({...t.state,currentMonth:s.end,error:{...t.state.error,[g().xQ.EndDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.EndDate]:void 0}}),null==y||y(o)}),[u,f,v,M,i,y,t]),F=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endTime;if(!e)return;const n=z(e,m,M);if(!n)return g().dz.InvalidTime;if(!x().L3(f))return;const o={...f,end_time:n},i=r().Dz(o);if(!i)return g().dz.InvalidRange;t.setState({...t.state,currentMonth:i.end,error:{...t.state.error,[g().xQ.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[g().xQ.EndTime]:void 0}}),null==y||y(o)}),[f,M,y,t,m]),V=(0,o.useCallback)((()=>{t.setState({...t.state,focus:g().xQ.StartDate,inputIsFocused:!0,currentMonth:R.start})}),[R.start,t]),K=(0,o.useCallback)((()=>{t.setState({...t.state,focus:g().xQ.StartTime,inputIsFocused:!0,currentMonth:R.start})}),[R.start,t]),H=(0,o.useCallback)((()=>{R.end&&t.setState({...t.state,focus:g().xQ.EndDate,inputIsFocused:!0,currentMonth:R.end})}),[R.end,t]),G=(0,o.useCallback)((()=>{R.end&&t.setState({...t.state,focus:g().xQ.EndTime,inputIsFocused:!0,currentMonth:R.end})}),[R.end,t]),q=(0,o.useCallback)((()=>{let e;if(t.state.focus===g().xQ.StartDate)e=O();else if(t.state.focus===g().xQ.StartTime)e=E();else if(t.state.focus===g().xQ.EndDate)e=U();else{if(t.state.focus!==g().xQ.EndTime)return(0,T().HB)(t.state.focus);e=F()}e?t.setState({...t.state,error:{...t.state.error,[t.state.focus]:e}}):t.setState({...t.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})}),[U,F,O,E,t]),$=(0,o.useCallback)((e=>{t.setState({...t.state,inputTemporaryValue:{...t.state.inputTemporaryValue,[t.state.focus]:e.target.value||""}}),b.isAndroid&&q()}),[b.isAndroid,q,t]),[Q,Z]=(0,a().K8)((()=>[b.isMobile?S.getSafePaddingLeftCSS(16):w?B().Qm:14,b.isMobile?S.getSafePaddingRightCSS(16):w?B().Qm:14]),[b.isMobile,w,S]),X=(0,C().IS)((e=>({container:{paddingTop:b.isMobile?16:8,paddingBottom:b.isMobile?16:8,paddingLeft:Q,paddingRight:Z,display:L?"block":"flex",...b.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:b.isMobile?e.popoverBackground:void 0}})),[b.isMobile,Q,Z,L]);return(0,A.jsxs)("div",{style:X.container,children:[(0,A.jsx)(Se,{inputDateValue:j.startDate,inputTimeValue:j.startTime,rangeValue:R.start,disabled:n,dateError:I.startDate,timeError:I.startTime,isDateFocused:k===g().xQ.StartDate,isTimeFocused:k===g().xQ.StartTime,hasTime:L,hasEndDate:D,locale:i,dateFormat:u,timeFormat:m,onChange:$,onDateFocus:V,onTimeFocus:K,onBlur:q,onSubmit:q}),D&&(0,A.jsx)("div",{style:{width:12,height:8}}),R.end&&(0,A.jsx)(Se,{inputDateValue:j.endDate,inputTimeValue:j.endTime,rangeValue:R.end,disabled:n,dateError:I.endDate,timeError:I.endTime,isDateFocused:k===g().xQ.EndDate,isTimeFocused:k===g().xQ.EndTime,hasTime:L,hasEndDate:D,locale:i,dateFormat:u,timeFormat:m,onChange:$,onDateFocus:H,onTimeFocus:G,onBlur:q,onSubmit:q})]})}function Se(e){let{inputDateValue:t,inputTimeValue:n,rangeValue:i,disabled:a,dateError:l,timeError:d,isDateFocused:u,isTimeFocused:p,hasTime:m,hasEndDate:g,locale:f,dateFormat:h,timeFormat:y,onChange:v,onDateFocus:b,onTimeFocus:S,onBlur:M,onSubmit:w}=e;const k=(0,s().Y0)(),j=(0,c().tz)(),I=(0,T().O9)(l)||(0,T().O9)(d),_=u||p,P=(0,C().IS)((e=>({input:Me(k,e,I,_,g),separator:{height:14,width:1,background:e.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})),[k,I,_,g]),B=(0,o.useCallback)((()=>F(l,j)),[l,j]),R=(0,o.useCallback)((()=>F(d,j)),[d,j]),L=(0,o.useCallback)((()=>{if(k.isMobile){const e=(0,fe().pN)(t)?i.toFormat(r().tr):t;return(0,A.jsx)(ye().A,{type:"date",format:ye().C.Transparent,value:e,onChange:v,onFocus:b,onBlur:M,onSubmit:w,disabled:a,size:1})}{const e=(0,fe().pN)(t)?i.toFormat(V(h,j,f)):t;return(0,A.jsx)(ye().A,{selectAll:!0,format:ye().C.Transparent,value:e,focusInitial:u,onChange:v,onFocus:b,onBlur:M,onSubmit:w,disabled:a,size:1})}}),[h,k.isMobile,a,M,v,b,w,t,j,u,f,i]),D=(0,o.useCallback)((()=>{if(k.isMobile){const e=(0,fe().pN)(n)?i.toFormat(x().GE):n;return(0,A.jsx)(ye().A,{type:"time",format:ye().C.Transparent,value:e,onChange:v,onFocus:S,onBlur:M,onSubmit:w,size:1,disabled:a})}{const e=(0,fe().pN)(n)?i.toFormat(K(y,!1)):n;return(0,A.jsx)(ye().A,{format:ye().C.Transparent,value:e,focusInitial:p,onChange:v,onFocus:S,onBlur:M,onSubmit:w,size:1,disabled:a})}}),[k.isMobile,a,M,v,w,S,n,p,i,y]);return(0,A.jsxs)("div",{style:P.input,children:[(0,A.jsx)(ve().A,{renderTooltip:B,originGap:be,forceVisibleState:(0,T().O9)(l),placement:he().W.Left,render:L}),m&&(0,A.jsx)("div",{style:P.separator}),m&&(0,A.jsx)(ve().A,{renderTooltip:R,originGap:be,forceVisibleState:(0,T().O9)(d),placement:he().W.Right,render:D})]})}function Me(e,t,n,o,i){return{display:"flex",alignItems:"center",borderRadius:6,height:28,lineHeight:1.2,paddingLeft:8,paddingRight:8,flexBasis:"50%",flexGrow:1,fontSize:e.isMobile?16:14,...n?{background:I().Ay.redWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${I().Ay.red}`}:o&&i?{background:I().Ay.blueWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${I().Ay.blue}`}:{background:t.inputBackground,boxShadow:t.inputBoxShadow}}}var Ae=()=>n(836251),we=()=>n(962036),ke=()=>n(64901);function je(){return(0,s().Y0)().isMobile?(0,A.jsx)(ke().A,{href:(0,Ae().xS)("guides.reminders"),analyticsFrom:"date_selector"}):(0,A.jsx)(we().A,{title:(0,A.jsx)(c().sA,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,Ae().xS)("guides.reminders"),analyticsFrom:"date_selector"})}function Ce(e){const{dateValue:t,onChangeValue:n}=e,{isMobile:i}=(0,s().Y0)(),a="date"===t.type||"daterange"===t.type,d="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,l().P)(),u=(0,o.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const o={...t,time_zone:e};null==n||n(o)}}),[t,n]);return a?null:(0,A.jsx)(pe().G,{enableRecents:!0,placementToOrigin:ie().sx.Right,currentValue:d,onSelect:u,renderOrigin:e=>(0,A.jsx)(se()._,{...e,title:(0,A.jsx)(c().sA,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!a&&r().GF(d),showExtensionArrow:i,chevronType:"right"})})}var Ie=()=>n(173979),Te=()=>n(422464);function _e(e){const{onChangeValue:t}=e,n=(0,c().tz)();return(0,A.jsx)(b().A,{title:(0,A.jsx)(c().sA,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,A.jsx)(S().A,{title:(0,A.jsx)(Te().W,{templateVariableType:e}),caption:(0,Ie().EC)(e,n),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}function Pe(e){let{store:t,value:n,header:m,isTemplatePage:g,shouldShowReminder:h,shouldShowControls:x=!0,canConfigureCollection:S,disabled:M,format:k,dateFormat:j,timeFormat:C,firstDayOfWeek:I,formQuestionStore:T,onChangeValue:_,onChangeDateFormat:P,onChangeTimeFormat:B,onDismiss:R}=e;const L=(0,s().Y0)(),D=(0,p().X)("nds_datepicker_refresh"),O=(0,p().X)("db_ux_mobile"),N=(0,o.useMemo)((()=>r().Ec((0,l().P)())),[]),E=(0,a().K8)((()=>G(n,k,N,T)),[n,k,N,T]),U=(0,a().K8)((()=>t.state.inputIsFocused),[t]),F=(0,o.useMemo)((()=>L.isMobile?{menuType:u().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),...!O&&{right:(0,A.jsx)(v().DoneMenuText,{}),onClickRight:R},left:h?(0,A.jsx)(je,{}):void 0,header:(0,A.jsx)(b().A,{children:(0,A.jsx)(xe,{store:t,disabled:M,locale:i().locale,format:k,dateFormat:j,timeFormat:C,dateValue:E,formQuestionStore:T,onChangeValue:_})})}:{menuType:u().gu.Popup,maxHeight:"none",width:D?"min-content":270,header:m}),[j,E,L.isMobile,M,k,T,m,D,_,R,h,t,C,O]),V=!d().V.includes(i().locale);return(0,A.jsxs)(y().A,{...F,children:[(0,A.jsx)(f().A,{show:U}),g&&(0,A.jsx)(_e,{onChangeValue:_}),(0,A.jsxs)(b().A,{topBorder:g,children:[!L.isMobile&&(0,A.jsx)(xe,{store:t,disabled:M,locale:i().locale,format:k,dateFormat:j,timeFormat:C,dateValue:E,formQuestionStore:T,onChangeValue:_}),(0,A.jsx)($,{store:t,dateValue:E,firstDayOfWeek:I,disabled:M,onChangeValue:_})]}),M?null:(0,A.jsxs)(A.Fragment,{children:[D&&(h||x)?(0,A.jsxs)(b().A,{topBorder:!0,children:[x&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(Z,{dateValue:E,onChangeValue:_}),S&&(0,A.jsx)(ue,{dateFormat:j,onChangeDateFormat:P}),(0,A.jsx)(w,{dateValue:E,onChangeValue:_}),S&&V&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(me,{dateValue:E,timeFormat:C,onChangeTimeFormat:B}),(0,A.jsx)(Ce,{dateValue:E,onChangeValue:_})]})]}),h&&(0,A.jsx)(le,{dateValue:E,onChangeValue:_})]}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(de,{dateValue:E,shouldShowReminder:h,shouldShowEndDateControl:x,shouldShowAllDayControl:x,onChangeValue:_}),S&&x&&(0,A.jsx)(b().A,{topBorder:!0,children:(0,A.jsx)(ge,{dateValue:E,dateFormat:j,timeFormat:C,onChangeDateFormat:P,onChangeTimeFormat:B,onChangeValue:_})})]}),(0,A.jsx)(b().A,{topBorder:!0,children:(0,A.jsx)(Q,{onChangeValue:_})}),!L.isMobile&&h&&(0,A.jsx)(b().A,{topBorder:!0,children:(0,A.jsx)(je,{})})]})]})}function Be(e){const t=(0,a().uB)(void 0,g().Ay),n=(0,a().K8)((()=>t.state.inputIsFocused),[t]);return(0,m().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,A.jsx)(h().A,{debugName:"DatePropertyMenu",capture:n,allowEsc:!0,children:(0,A.jsx)(h().A,{debugName:"DatePropertyMenu",allowEsc:!0,capture:!0,allowUndo:!0,children:(0,A.jsx)(Pe,{store:t,...e})})})}},275193:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(591779),l=n(474848);const d=(0,n(340498).wt)("appDownload",{viewBox:"0 0 23 16",svg:(0,l.jsx)("path",{clipRule:"evenodd",d:"m23 11.4338c0 2.5317-2.1591 4.5662-4.922 4.5662h-12.59789c-3.12888 0-5.48011-2.2739-5.48011-4.9804 0-2.2463 1.28998-4.10591 3.3576-4.43732.04574-2.57768 2.49761-4.2992 4.74821-3.63637 1.09785-1.61104 2.86359-2.94591 5.34289-2.94591 3.7418 0 6.6786 2.96433 6.6603 7.0702 1.784.75489 2.891 2.43038 2.891 4.3636zm-17.51989 3.084h12.59789c1.9487 0 3.449-1.3717 3.449-3.084 0-1.66625-1.0704-2.89065-2.7354-3.25889-.1098-.02761-.1556-.09206-.1464-.21173.0366-.43269.064-.92981.0366-1.35328-.1555-2.73418-2.2323-5.12774-5.2331-5.12774-2.3695 0-3.73271 1.30725-4.62014 2.89989-.05489.10126-.11893.12888-.22872.09206-1.8755-.6168-3.90652.22094-3.90652 3.05638 0 .11968-.04575.18412-.17383.18412-1.93954 0-3.04654 1.46376-3.04654 3.30499 0 1.878 1.70167 3.4982 4.00716 3.4982zm7.19089-9.49502c0-.39047-.3145-.70701-.7026-.70701-.388 0-.7026.31654-.7026.70701v4.89196l-1.61105-1.62112c-.27439-.27611-.71927-.27611-.99366 0-.2744.27611-.2744.72377 0 .99987l2.81051 2.82811c.2744.2761.7193.2761.9936 0l2.8106-2.82811c.2743-.2761.2743-.72376 0-.99987-.2744-.27611-.7193-.27611-.9937 0l-1.6111 1.62112z",fillRule:"evenodd"})});var c=()=>n(66913),u=()=>n(861017),p=()=>n(959013),m=()=>n(284371),g=()=>n(579631),f=()=>n(449506),h=()=>n(435009),y=()=>n(597755),v=()=>n(112799),b=()=>n(346),x=()=>n(567121),S=()=>n(962730),M=()=>n(351360),A=()=>n(927080),w=()=>n(493823),k=()=>n(625830),j=()=>n(285790),C=()=>n(187485),I=()=>n(897119),T=()=>n(204063),_=()=>n(125565);function P(){const e=(0,i().v3)(),t=(0,p().tz)(),[n,P]=(0,o.useState)(!0),{isDesktopBrowser:B,os:R}=(0,i().Y0)(),L=(0,s().K8)((()=>e.RouterStore.state.route.name in u().b1),[e]),D=(0,s().K8)((()=>M().default.state.inAppCalloutStore),[]),O=(0,s().K8)((()=>D.getCalloutVisibility("desktop_preference_popup").canShow),[D]),N=e.currentUser.isLoggedIn(),E=(0,s().O$)(A().A),[U,F]=(0,o.useState)(!1),V=(0,s().K8)((()=>A().A.canPersistToLocalStorage()),[]),K=!U&&N&&void 0===E&&B&&("mac"===R||"windows"===R)&&L&&V&&O,[H,z]=(0,o.useState)(!1),W=K&&H,G=(0,o.useRef)(!1);(0,o.useEffect)((()=>{K&&!G.current&&(async function(e,t){const n=await f().callApi({eventName:"getDesktopAppRegistration",environment:e,data:{os:t}});return"data"in n&&n.data.isRegistered}(e,R).then((e=>{z(e)})),G.current=!0)}),[K,z,e,R]);const Y=(0,r().ZC)(W);(0,o.useEffect)((()=>{W&&!Y&&(g()._g(e),D.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!0,validateCanShow:!0}))}),[W,Y,e,D]);const q=(0,b().n_)(),$=(0,v().E)(),Q=(0,a().IS)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",minWidth:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:m().Wy.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34,marginLeft:12}})),[]);return(0,l.jsx)(I().Ay,{popupType:I().nl.Popup,placementToOrigin:S().W.Bottom,alignmentToOrigin:S().C.Center,origin:(0,l.jsx)("div",{style:Q.origin}),originGap:q?-x().ls/2:0,disableMouseCapture:!0,open:W,style:Q.container,render:()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{style:Q.header,children:[(0,l.jsx)(_().A,{style:Q.headerText,children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,l.jsx)(j().A,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:c().V,onClick:()=>{A().A.setState("never"),F(!0),g().e1(e)}})]}),(0,l.jsx)(C().A,{external:!0,onClick:()=>{$.current&&(h().oo({environment:e,url:$.current,openInNew:"tab"}),g().co(e))},children:(0,l.jsxs)(w().p,{isGray:!0,size:"xs",style:Q.appDownloadButton,children:[d(Q.appDownloadIcon),(0,l.jsx)("span",{children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,l.jsxs)("div",{style:Q.actions,children:[(0,l.jsxs)("div",{style:Q.alwaysOpenLinks,children:[(0,l.jsx)(k().A,{checked:n,size:16,onClick:()=>{P(!n)}}),(0,l.jsx)(_().A,{isInline:!0,style:Q.alwaysOpenLinksLabel,children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]}),(0,l.jsx)(T().A,{style:Q.alwaysOpenLinksButton,onClick:()=>{A().A.setState(n?"always":"never"),F(!0),h().eG({url:(0,y().P)(window.location.href),environment:e}),g().SS(e,{always_open_in_app:n})},children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]})]}),onClosed:()=>{D.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!1})}})}},291606:(e,t,n)=>{n.d(t,{AC:()=>s,dE:()=>r,Nw:()=>l,tn:()=>a});var o=()=>n(989423);const i=new(n(178624).R)({key:"offline_autosync_setting",namespace:n(419494).cd,important:!0,trackingType:"necessary"});function s(){return"on"===i.getState()}function a(e){let{environment:t}=e;const n=s()?"off":"on";(0,o().u4)({environment:t,event:{eventName:"offline_autosyncing_toggled",eventProperties:{toggle_status:n}}}),i.setState(n)}function r(){return i.getState()}function l(e){i.setState(e)}},296431:(e,t,n)=>{n.r(t),n.d(t,{CreateTeamFromPageConfirmModal:()=>y});n(296540);var o=()=>n(484714),i=()=>n(847249),s=()=>n(401497),a=()=>n(673724),r=()=>n(959013),l=()=>n(284371),d=()=>n(864943),c=()=>n(204063),u=()=>n(641514),p=()=>n(21140),m=()=>n(477093),g=()=>n(108414),f=()=>n(812941),h=n(474848);function y(){const e=(0,o().v3)(),t=(0,r().tz)(),n=(0,s().IS)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},title:{marginTop:16,marginBottom:12,color:e.text.primary,fontWeight:l().Wy.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]),y=(0,i().K8)((()=>g().A.state.open),[]);return(0,h.jsx)(u().A,{onDismiss:()=>{g().A.setState({open:!1})},render:()=>(0,h.jsx)("div",{style:n.modal,children:(0,h.jsxs)(p().Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,a().I)(n.loopIcon),(0,h.jsx)("div",{style:n.title,children:(0,h.jsx)(r().sA,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,h.jsx)("div",{style:n.description,children:(0,h.jsx)(r().sA,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,h.jsx)(c().A,{size:"lg",style:n.confirmButton,onClick:()=>{if(g().A.state.open){const{pageStore:n,flowId:o}=g().A.state;m().v4({environment:e,intl:t,page:n,flowId:o}),g().A.setState({open:!1})}},children:(0,h.jsx)(r().sA,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,h.jsx)(d().A,{size:"lg",style:n.cancelButton,onClick:()=>g().A.setState({open:!1}),children:(0,h.jsx)(r().sA,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,h.jsx)(f().A,{message:(0,h.jsx)(r().sA,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),isOpen:y})}},305837:(e,t,n)=>{n.d(t,{H:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("settingsUpgradeFilled",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M10 19c4.935 0 9.009-4.073 9.009-9 0-4.926-4.082-9-9.018-9C5.065 1 1 5.074 1 10c0 4.927 4.074 9 9 9zm0-4.422c-.47 0-.818-.33-.818-.8v-4.23l.087-1.863-.81 1.01-1 1.053a.762.762 0 01-.558.235c-.435 0-.757-.314-.757-.74 0-.218.07-.392.218-.549l2.994-3.029c.2-.217.4-.313.644-.313.261 0 .461.104.662.313l2.976 3.03a.73.73 0 01.227.548c0 .426-.322.74-.758.74a.73.73 0 01-.557-.235l-.992-1.045-.818-1.027.087 1.871v4.23c0 .47-.348.801-.827.801z"})})},308228:(e,t,n)=>{n.d(t,{W:()=>r,m:()=>a});n(296540);var o=()=>n(959013),i=n(474848);const s=(0,o().YK)({addingGuestsToDefaultTeam:{id:"getTeamRoleDisabled.addingGuestsToDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"},addingGuestsAsNonOwner:{id:"getTeamRoleDisabled.addingGuestsAsNonOwner",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"},makingAGroupATeamGuest:{id:"getTeamRoleDisabled.makingAGroupATeamGuest",defaultMessage:"Groups can’t be teamspace guests"},upgradingAnOwnerAsNonOwner:{id:"getTeamRoleDisabled.upgradingAnOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to add another owner"},downgradeLastUserOwner:{id:"getTeamRoleDisabled.downgradeLastUserOwner",defaultMessage:"Add another teamspace owner to downgrade yourself to member"},downgradeToOwnerAsNonOwner:{id:"getTeamRoleDisabled.downgradeToOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to downgrade other teamspace owners"},removeLastUserOwner:{id:"getTeamRoleDisabled.removeLastUserOwner",defaultMessage:"Add another teamspace owner to leave the team"},removeLastGroupOwner:{id:"getTeamRoleDisabled.removeLastGroupOwner",defaultMessage:"Add another teamspace owner to remove this group"},downgradeLastMakingAGroupAnOwner:{id:"getTeamRoleDisabled.downgradeLastMakingAGroupAnOwner",defaultMessage:"Add another teamspace owner to make this group a member"},downgradingAMemberToAGuest:{id:"getTeamRoleDisabled.downgradingAMemberToAGuest",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."},removingMemberFromDefaultTeam:{id:"getTeamRoleDisabled.removingMemberFromDefaultTeam",defaultMessage:"Members cannot be removed from a default teamspace."},removingMemberAsMember:{id:"getTeamRoleDisabled.removingMemberTeam.noPermission",defaultMessage:"You must be a team owner to remove other team members in this teamspace."},changingTeamRoleAsNonTeamOwner:{id:"getTeamRoleDisabled.changingTeamRoleAsNonMember",defaultMessage:"You must be a teamspace owner to adjust team membership."}});function a(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}=e;return t||"owner"!==n?o&&"team_level_guest"===n?l(s.addingGuestsToDefaultTeam):!i&&"team_level_guest"===n||!t&&"team_level_guest"===n?l(s.addingGuestsAsNonOwner):{isDisabled:!1,disabledReason:void 0}:l(s.upgradingAnOwnerAsNonOwner)}function r(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i,userIsEnterpriseWorkspaceOwner:r,originalTeamMemberInfo:d,onlyHasOneOwner:c,isUnowned:u,isMemberCurrentUser:p,canCurrentUserAddTeamMembers:m}=e;if("team_level_guest"===n&&"team_level_guest"!==d.type)return l(s.downgradingAMemberToAGuest);const g="owner"!==n&&"owner"===d.type;if(g&&!t)return l(s.downgradeToOwnerAsNonOwner);if(g&&c)return l("none"===n?"group"===d.entity_type?s.removeLastGroupOwner:s.removeLastUserOwner:"group"===d.entity_type?s.downgradeLastMakingAGroupAnOwner:s.downgradeLastUserOwner);if("none"===n&&o)return l(s.removingMemberFromDefaultTeam);return"group"===d.entity_type&&"team_level_guest"===n?l(s.makingAGroupATeamGuest):"owner"===n&&i&&"user"===d.entity_type&&u&&p||"owner"===n&&r&&p?{isDisabled:!1,disabledReason:void 0}:"none"===n?t||m&&"member"===d.type?{isDisabled:!1,disabledReason:void 0}:l(s.removingMemberAsMember):t?a({isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}):l(s.changingTeamRoleAsNonTeamOwner)}function l(e){return{isDisabled:!0,disabledReason:(0,i.jsx)(o().sA,{...e})}}},313633:(e,t,n)=>{n.d(t,{A:()=>r});n(296540);var o=()=>n(401497),i=()=>n(66913),s=()=>n(197190),a=n(474848);function r(e){const{top:t,right:n,onClick:r}=e,l=(0,o().IS)((e=>({buttonBackground:{position:"absolute",top:t??12,right:n??12,width:22,height:22,borderRadius:"100%",background:e.buttonBackground},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},buttonHovered:{background:e.buttonHoveredBackground},icon:{width:14,fill:e.icon.secondary}})),[t,n]);return(0,a.jsx)("div",{style:l.buttonBackground,children:(0,a.jsx)(s().A,{style:l.button,hoveredStyle:l.buttonHovered,onClick:r,children:(0,i().V)(l.icon)})})}},315729:(e,t,n)=>{n.r(t),n.d(t,{MembersTabTitle:()=>_n,PeopleRow:()=>In,SettingToggle:()=>Pn,SidebarTeamModal:()=>Tn});n(581454);var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(959013),l=()=>n(496603),d=()=>n(534177),c=()=>n(284371),u=()=>n(946141),p=()=>n(38337),m=()=>n(37433),g=()=>n(632709),f=()=>n(756279),h=()=>n(351360),y=()=>n(630116),v=()=>n(991249),b=()=>n(341974),x=()=>n(345578),S=(n(944114),()=>n(820579)),M=()=>n(340498),A=()=>n(100622),w=()=>n(436572),k=()=>n(751156),j=()=>n(297872),C=()=>n(623580),I=()=>n(204063),T=()=>n(859428),_=()=>n(125565),P=()=>n(972435),B=()=>n(213525),R=()=>n(962730),L=()=>n(848237),D=()=>n(605685),O=()=>n(43450);function N(e){return!(0,O().R)(e)}var E=()=>n(976519),U=()=>n(211825),F=()=>n(655784),V=()=>n(812941),K=()=>n(898808),H=()=>n(818787),z=()=>n(640653),W=()=>n(144707),G=n(474848);const Y=(0,r().YK)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),q=(0,r().YK)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function $(e){let{teamStore:t}=e;const n=(0,a().IS)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),o=g().p.Members,i=(0,s().K8)((()=>t.getTeamAccessLevel()),[t]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{style:n.spacer}),(0,G.jsx)(H().BA,{title:(0,G.jsx)(r().sA,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,G.jsx)(W().u,{currentAccessLevel:i,teamStore:t,disabledWithRightChevron:!0,style:n.accessLevelButton},"visibility"),(0,G.jsx)(Q,{teamStore:t},"permissions")],onClick:()=>{g().A.state.open&&g().A.setState({...g().A.state,tab:o})},itemStyle:n.listItem})]})}function Q(e){let{teamStore:t}=e;const n=(0,s().O$)(h().AppStoreCurrentSpaceStore),o=(0,i().v3)(),r=(0,a().IS)((e=>({label:{color:e.text.primary,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,s().K8)((()=>t.getTeamPermission()),[t]),d=(0,s().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,s().K8)((()=>{if(!n)return{spaceIcon:void 0,spaceName:void 0};const e=(0,z().GK)(o,n);return{spaceIcon:(0,G.jsx)(K().x,{disabled:!0,store:n,size:20,style:r.icon}),spaceName:e}}),[n,o,r.icon]),p=(0,s().K8)((()=>(0,G.jsx)(K().x,{disabled:!0,store:t,size:20,style:r.icon})),[t,r.icon]),m=(null==l?void 0:l.role)??"none",g=!(m===d.role),f=g?p:c,y=P().A.formatMessage(q[d.role],{showTeam:g,spaceName:u}),v=P().A.formatMessage(Y[m]);return(0,G.jsxs)("div",{style:r.row,children:[f,(0,G.jsxs)(_().A,{isSmall:!0,style:r.label,children:[g&&(0,G.jsxs)(G.Fragment,{children:[v,(0,G.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),y]})]})}var Z=()=>n(934999),X=()=>n(493823),J=()=>n(638743),ee=()=>n(657328),te=()=>n(963589),ne=()=>n(118849),oe=()=>n(233510),ie=(n(898992),n(672577),()=>n(668725)),se=()=>n(68263),ae=(n(354520),()=>n(433847));const re=["none","reader","comment_only","read_and_write","editor"],le=["reader","comment_only","read_and_write"],de=["reader","comment_only","read_and_write","editor"],ce=["editor"];function ue(e){const t=function(e){var t,n;let{teamId:o,permissions:i}=e;const s=(null===(t=i.find((e=>(0,se().Lg)(e))))||void 0===t?void 0:t.role)??"none",a=(null===(n=i.find((e=>(0,se().gl)(e)&&e.team_id===o)))||void 0===n?void 0:n.role)??s,r=i.find((e=>(0,se().un)(e)));return{spacePermission:{type:"space_permission",role:s},teamMemberPermission:{type:"explicit_team_permission",team_id:o,role:a},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:o,role:"editor"},...r&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:o,role:r.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:n,teamMemberPermission:o}=t,i={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},s={spacePermission:me({roles:re,currentRole:o.role}),teamGuestPermission:le,teamMemberPermission:pe({roles:de,currentRole:n.role}),teamOwnerPermission:ce},{visibility:a,space_member_join_access:r}=e.settings;return"team_members"===a&&(i.space_member_join_access=["invite_only"],s.spacePermission=["none"]),"self_join"===r&&(i.visibility=["space_members"],i.invite_access=["team_members"],s.spacePermission=s.spacePermission.filter((e=>"none"!==e))),e.is_default&&(s.teamMemberPermission=[o.role],s.spacePermission=[o.role]),{settingsOptions:i,permissionItemRoleOptions:s,currentTeamPermissionItems:t}}function pe(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,ae().Pr)(e,n)))}function me(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,ae().Y1)(e,n)))}var ge=()=>n(760217),fe=()=>n(406699),he=()=>n(928600),ye=()=>n(939740),ve=()=>n(89924),be=()=>n(946548),xe=()=>n(722872),Se=()=>n(553965);function Me(e){let{teamStore:t}=e;const n=(0,s().K8)((()=>t.getSettingsStore().getValue()),[t]),o=(0,s().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return ue({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!n||!o)return null;const i=[(0,G.jsx)(we,{teamStore:t,hasMultiInviteAccessOptions:1===o.settingsOptions.invite_access.length,inviteAccess:n.invite_access},"invite"),(0,G.jsx)(Ae,{teamStore:t,disablePageEdits:n.disable_team_page_edits},"editSidebar"),(0,G.jsx)(ke,{teamStore:t},"toggleInviteLink")];return(0,G.jsx)(H().BA,{title:(0,G.jsx)(r().sA,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:i,hideDividers:!0})}function Ae(e){const{teamStore:t,disablePageEdits:n}=e,a=(0,i().v3)(),l=N(t),d=(0,s().K8)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),c=(0,o.useCallback)((e=>{k().createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:a,canUndo:!0,perform:n=>{L().WC({environment:a,store:t,update:{disable_team_page_edits:e},transaction:n})}})}),[a,t]),u=(0,se().p2)(d),p=[{option:!0,label:(0,G.jsx)(r().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>c(!0)}];return u&&p.push({option:!1,label:(0,G.jsx)(r().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>c(!1)}),(0,G.jsx)(je,{title:(0,G.jsx)(r().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,G.jsx)(r().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:l||!u,currentOption:!u||Boolean(n),allOptions:p,optionTooltip:u?void 0:(0,G.jsx)(r().sA,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function we(e){const{teamStore:t,hasMultiInviteAccessOptions:n,inviteAccess:s}=e,a=(0,O().R)(t),l=(0,i().v3)(),d=(0,o.useCallback)((e=>{k().createAndCommit({userAction:"team.setInviteAccess",environment:l,canUndo:!0,perform:n=>{L().WC({environment:l,store:t,update:{invite_access:e},transaction:n})}})}),[l,t]),c=!a||n;return(0,G.jsx)(je,{title:(0,G.jsx)(r().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite or remove teamspace members"}),disabled:c,optionTooltip:c&&a&&(0,G.jsx)(r().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:s,allOptions:[{option:"team_members",label:(0,G.jsx)(r().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d("team_members")},{option:"team_owners",label:(0,G.jsx)(r().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d("team_owners")}]})}function ke(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,s().K8)((()=>(0,m().isTeamInviteLinkDisabled)(t)),[t]),l=N(t),d=(0,a().IS)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,G.jsxs)("div",{style:d.container,children:[(0,G.jsxs)("div",{children:[(0,G.jsx)(_().A,{children:(0,G.jsx)(r().sA,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,G.jsx)(_().A,{isSmall:!0,style:d.subtitle,children:(0,G.jsx)(r().sA,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,G.jsx)("div",{style:d.switcher,children:(0,G.jsx)(be().A,{disabled:l,on:!o,onClick:()=>{k().createAndCommit({userAction:"team.setInviteAccess",environment:n,canUndo:!0,perform:e=>{L().WC({environment:n,store:t,update:{disable_invite_link:!o},transaction:e})}})}})})]})}function je(e){const{title:t,caption:n,currentOption:o,allOptions:s,disabled:r,optionTooltip:l}=e,d=(0,i().Y0)(),c=(0,a().IS)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.text.secondary},tooltipWidth:{width:300}})),[]),u=s.find((e=>e.option===o));return u?(0,G.jsxs)("div",{style:c.root,children:[(0,G.jsxs)("div",{style:c.title,children:[t,n&&(0,G.jsx)(_().A,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:n})]}),(0,G.jsx)(T().A,{style:c.tooltipWidth,placement:R().W.Top,alignment:R().C.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,G.jsx)(fe().Ay,{...e,disablePopup:r,popupType:d.isMobile?fe().z7.SlideUp:fe().z7.Popup,alignmentToOrigin:fe().yP.End,renderOrigin:t=>(0,G.jsxs)(X().p,{style:c.buttonStyle,disabled:r,...(0,Se().A)(e,t),children:[u.label,!r&&(0,ie().b)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:xe().gu.ActionSheet}:{menuType:xe().gu.Popup,minWidth:150};const n=[{key:"options",render:e=>(0,G.jsx)(ve().A,{...e}),items:s.map((t=>{const n={key:t.option.toString(),render:e=>(0,G.jsx)(ge().A,{...e,title:t.label,caption:t.caption,isChecked:o===t.option}),action:()=>{t.action(),e.close()}};return n}))}];return(0,G.jsx)(he().A,{...t,children:(0,G.jsx)(ye().Ay,{type:ye().Oh.Vertical,initialFocus:void 0,sections:n})})}})})]}):null}function Ce(e){let{teamStore:t}=e;const n=(0,a().IS)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Me,{teamStore:t}),(0,G.jsx)("div",{style:n.spacer}),(0,G.jsx)(Ie,{teamStore:t}),(0,G.jsx)(V().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:n.learnMoreLinkContainer,message:(0,G.jsx)(r().sA,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function Ie(e){let{teamStore:t}=e;const n=(0,s().O$)(h().AppStoreCurrentSpaceStore),o=(0,i().v3)(),l=(0,oe().Z)(),d="enterprise",c=(0,te().X)("sharing_anyone_with_the_link"),{organizationOverrides:u}=(0,J().n)({spaceId:null==n?void 0:n.id}),p=o.currentUser.id,m=(0,s().K8)((()=>({disable_public_access:{spaceIsDisabled:(null==n?void 0:n.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess(),isControlledByOrganization:Boolean(u.disable_public_access)},disable_export:{spaceIsDisabled:(null==n?void 0:n.getDisableExport())??!1,teamIsDisabled:t.getDisableExport(),isControlledByOrganization:Boolean(u.disable_export)},disable_guests:{spaceIsDisabled:(null==n?void 0:n.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests(),isControlledByOrganization:Boolean(u.disable_guests)},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits(),isControlledByOrganization:!1}})),[n,t,u]),g=(0,O().R)(t),f=(0,s().K8)((()=>(null==n?void 0:n.canAdmin())??!1),[n]),y=(0,a().IS)((()=>({switcher:{marginRight:0}})),[]);if(!n)return null;if(!p)return null;const v=e=>l||m[e].teamIsDisabled,b=e=>{if(!v(e))return!1;if(!g)return!1;if(m[e].isControlledByOrganization)return!1;const t=(e=>m[e].spaceIsDisabled&&m[e].teamIsDisabled)(e);return!t||f},x=e=>!v(e)&&f,S=e=>{const{teamIsDisabled:n,spaceIsDisabled:i}=m[e],s=!n;L()._B({environment:o,store:t,settingName:e,newTeamSettingValue:Pe(s),spaceSettingValue:void 0===i?void 0:Pe(i)})},M=e=>{if((e=>m[e].spaceIsDisabled)(e))return(e=>m[e].teamIsDisabled)(e)?(0,G.jsx)(r().sA,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,G.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,G.jsx)(r().sA,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,G.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},A=(0,G.jsx)(ne().A,{subscriptionTier:d,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),w=(0,G.jsx)(r().sA,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),k=[(0,G.jsx)(Pn,{switcherStyle:y.switcher,upsellTier:d,on:m.disable_public_access.teamIsDisabled,disabled:!b("disable_public_access"),onChange:()=>S("disable_public_access"),shouldTriggerUpsell:x("disable_public_access"),secondCaption:M("disable_public_access"),title:(0,G.jsxs)(G.Fragment,{children:[c?(0,G.jsx)(r().sA,{id:"teamSettingsSecurity.setting.shareTitleAWTLUpdate",defaultMessage:"Disable publishing sites, forms, and public links"}):(0,G.jsx)(r().sA,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable publishing sites and forms"}),!v("disable_public_access")&&A]}),tooltip:!v("disable_public_access")&&w,isLocked:m.disable_public_access.isControlledByOrganization,lockedTooltip:(0,ee().C)()}),(0,G.jsx)(Pn,{switcherStyle:y.switcher,upsellTier:d,on:m.disable_guests.teamIsDisabled,disabled:!b("disable_guests"),onChange:()=>S("disable_guests"),shouldTriggerUpsell:x("disable_guests"),secondCaption:M("disable_guests"),title:(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(r().sA,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),!v("disable_guests")&&A]}),tooltip:!v("disable_guests")&&w,isLocked:m.disable_guests.isControlledByOrganization,lockedTooltip:(0,ee().C)()}),(0,G.jsx)(Pn,{switcherStyle:y.switcher,upsellTier:d,on:m.disable_export.teamIsDisabled,disabled:!b("disable_export"),onChange:()=>S("disable_export"),shouldTriggerUpsell:x("disable_export"),secondCaption:M("disable_export"),title:(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(r().sA,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),!v("disable_export")&&A]}),tooltip:!v("disable_export")&&w,isLocked:m.disable_export.isControlledByOrganization,lockedTooltip:(0,ee().C)()})],j=(0,G.jsx)(r().sA,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,G.jsx)(H().BA,{title:j,rows:k,hideDividers:!0})}function Te(e){const t=(0,i().v3)(),n=(0,s().K8)((()=>(0,m().getCanRestoreTeam)(e.teamStore)),[e.teamStore]);return(0,G.jsx)(X().p,{style:e.style,icon:e=>(0,Z().B)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default}),onClick:async()=>await(async e=>{let{teamStore:n,teamName:o}=e;await L().Q8({environment:t,teamStore:n,teamName:o,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStore}),disabled:!n,children:(0,G.jsxs)("div",{children:[(0,G.jsx)(_().A,{children:(0,G.jsx)(r().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,G.jsx)(_().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,G.jsx)(r().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})}function _e(e){const t=(0,i().v3)(),n=(0,a().IS)((()=>({archiveLabel:{color:A().Ay.red}})),[]);return(0,G.jsx)(X().p,{style:e.style,isRed:!0,icon:e=>(0,Z().B)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:async()=>{e.disabled||await L().mm({environment:t,teamStore:e.teamStore,from:"sidebar_team_modal"})},...e.tooltipEvents,children:(0,G.jsxs)("div",{children:[(0,G.jsx)(_().A,{style:n.archiveLabel,children:(0,G.jsx)(r().sA,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,G.jsx)(_().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,G.jsx)(r().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function Pe(e){return e?"disable":"allow"}const Be=(0,r().YK)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Re(e){let{teamStore:t}=e;const n=(0,i().v3)(),l=(0,s().O$)(h().AppStoreCurrentSpaceStore),d=N(t),[c,u]=(0,o.useState)(void 0),[p,m]=(0,o.useState)(void 0),g=(0,a().IS)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[f,y]=(0,s().K8)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===f)return null;const v=f||"",b=y??"",x=b.length>0,S=null==c?void 0:c.trim(),M=null==p?void 0:p.trim(),A=""===S||(void 0===p||M===b.trim())&&(void 0===c||S===v.trim()),j=(0,G.jsx)(r().sA,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),C=(0,G.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,G.jsx)(K().x,{disabled:d,store:t,style:g.icon,size:20,onChange:e=>{k().createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:n,canUndo:!0,perform:n=>{L().n7({store:t,update:{icon:e},transaction:n})}})}}),d?(0,G.jsx)(_().A,{children:v}):(0,G.jsx)(Le,{value:c??v,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:d,placeholder:"Acme Labs"})]}),T=(0,G.jsx)(r().sA,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),R=P().A.formatMessage(Be.noDescription),D=d?(0,G.jsx)(_().A,{isMultiline:!0,isSecondaryColor:!x,children:x?b:R}):(0,G.jsx)(Le,{value:void 0===p?b:p,onBlur:e=>{m(e)},onChange:e=>{m(e)},disabled:d,textarea:!0,autosize:!0,placeholder:R,style:g.description}),O=[(0,G.jsxs)(o.Fragment,{children:[(0,G.jsx)(_().A,{isSmall:!0,children:j}),C]},"name"),(0,G.jsxs)(o.Fragment,{children:[(0,G.jsx)(_().A,{isSmall:!0,children:T}),D]},"description")];return(0,G.jsxs)("div",{style:g.container,children:[(0,G.jsx)(H().BA,{title:(0,G.jsx)(r().sA,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:O}),!d&&(0,G.jsx)(I().A,{style:g.updateButton,disabled:A,size:"lg",onClick:async()=>{if(A)return;if(S&&S!==v.trim()){if(!(await(0,B().d$)({environment:n,spaceStore:l,teamName:S})))return}const{performResult:e,serverCommitResult:o}=k().createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:n,canUndo:!0,perform:e=>{L().n7({store:t,update:{name:S??v,description:M??b},transaction:e})}});try{await Promise.all([e,o])}catch(i){return}w().D6({label:(0,G.jsx)(r().sA,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},children:(0,G.jsx)(r().sA,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,G.jsx)("br",{}),(0,G.jsx)($,{teamStore:t}),(0,G.jsx)(De,{teamStore:t}),(0,G.jsx)(V().A,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function Le(e){const{value:t,style:n,onBlur:i,onChange:s,placeholder:a,disabled:r}=e,[l,d]=(0,o.useState)(!1);return(0,G.jsx)(j().A,{capture:l,render:o=>(0,G.jsx)(C().A,{textarea:e.textarea,autosize:e.autosize,onFocus:e=>{d(!0)},onBlur:e=>{d(!1),i(e.target.value)},onChange:e=>{d(!1),s&&s(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:a,disabled:r,value:t,style:n,...o})})}function De(e){let{teamStore:t}=e;const n=(0,a().IS)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:H().mZ,paddingBottom:H().mZ,paddingLeft:H().jN,paddingRight:H().jN}})),[]),[o,i]=(0,s().K8)((()=>[t.getName(),t.isArchived()]),[t]),l=(0,O().R)(t),d=(0,U().G)(t),c=(0,E().q)(t.id),u=(0,D().c)(),p=c&&!u;if(void 0===o||!d)return null;const m=[],g=(0,G.jsx)(F().A,{buttonInternals:(0,G.jsx)(Oe,{isTeamOwner:l}),teamStore:t,placement:R().W.Bottom,alignment:R().C.Start,from:"sidebar_team_modal",style:n.buttonStyle,icon:e=>(0,S().f)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default,transform:"rotate(-90deg)"}),isRed:!l});if(m.push(g),l)if(i)m.push((0,G.jsx)(Te,{teamStore:t,teamName:o,style:n.buttonStyle}));else{const e=(0,G.jsx)(T().A,{disableTooltip:!p,placement:R().W.Bottom,alignment:R().C.Start,renderTooltip:()=>(0,G.jsx)(r().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>(0,G.jsx)(_e,{disabled:p,teamStore:t,tooltipEvents:e,style:n.buttonStyle})});m.push(e)}return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{style:{height:20,width:"100%"}}),(0,G.jsx)(H().BA,{title:(0,G.jsx)(r().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:m,itemStyle:{padding:0,margin:0}})]})}function Oe(e){let{isTeamOwner:t}=e;const n=(0,a().IS)((()=>({label:{color:t?"inherit":A().Ay.red}})),[t]);return(0,G.jsxs)("div",{children:[(0,G.jsx)(_().A,{style:n.label,children:(0,G.jsx)(r().sA,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,G.jsx)(_().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,G.jsx)(r().sA,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var Ne=()=>n(381138),Ee=()=>n(986863),Ue=()=>n(205618),Fe=()=>n(931956),Ve=()=>n(284331);function Ke(e){let{teamStore:t}=e;const n=(0,a().IS)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.surface.elevated,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),o=(0,r().tz)(),i=(0,s().K8)((()=>g().A.state.memberFilterQuery),[]),l=(0,s().uB)(void 0,Ue().A),d=(0,Fe().X)(t),c=(0,s().K8)((()=>d&&!(0,m().isTeamInviteLinkDisabled)(t)),[t,d]);return(0,G.jsxs)("div",{style:n.container,children:[(0,G.jsxs)("div",{children:[(0,G.jsx)(Ee().u,{store:t,permissionsInviteStore:l,origin:(0,G.jsx)(T().A,{placement:R().W.Left,alignment:R().C.Start,textWrap:!0,renderTooltip:()=>d?(0,G.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,G.jsx)(r().sA,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,G.jsx)("div",{style:{width:220},children:(0,G.jsx)(r().sA,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,G.jsx)(I().A,{disabled:!d,size:"lg",onClick:()=>{l.setState({...l.state,modalOpen:!0})},...e,children:(0,G.jsx)(r().sA,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),c&&(0,G.jsx)(Ve().m,{store:t,isSmall:!0})]}),(0,G.jsx)(C().A,{placeholder:o.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:n.input,value:i,onChange:e=>{g().A.setState({...g().A.state,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,Ne().q)(n.searchIcon),showClearButton:!0,format:C().C.Small})]})}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var He=()=>n(187174),ze=()=>n(778078),We=()=>n(645873),Ge=()=>n(106628),Ye=()=>n(21735),qe=()=>n(508496),$e=()=>n(134217),Qe=()=>n(749240),Ze=()=>n(96689),Xe=()=>n(695608),Je=()=>n(34293),et=()=>n(173783),tt=()=>n(614505),nt=()=>n(453697),ot=()=>n(820635),it=()=>n(646736),st=()=>n(605402),at=(n(16280),()=>n(831310)),rt=()=>n(901389),lt=()=>n(802790),dt=()=>n(47373),ct=()=>n(176983),ut=()=>n(463830),pt=()=>n(700250),mt=()=>n(10984),gt=()=>n(577437),ft=()=>n(308228),ht=()=>n(418426),yt=(n(737550),()=>n(854150)),vt=()=>n(784438),bt=()=>n(468006),xt=()=>n(912913),St=()=>n(731320),Mt=()=>n(112698);function At(e){var t;const{teamStore:n,memberInfo:l,permissionItem:d,memberName:c,style:u,onMenuItemClicked:p,isPermissionOverridden:m}=e,g=(0,i().v3)(),f=(0,r().tz)(),y=(0,o.useMemo)((()=>new(ut().A)),[]),v=(0,s().K8)((()=>n.getTeamPermission()),[n]),b=(0,s().O$)(h().AppStoreCurrentSpaceStore),x=(0,gt()._X)({name:"custom_teamspace_permissions",spaceId:null==b?void 0:b.id,userId:null==g||null===(t=g.currentUser)||void 0===t?void 0:t.id}),S=(0,O().R)(n),M=!(0,vt().e2)(x)&&!m||!S,A=(0,s().K8)((()=>{if(null==n||!n.isDefined())return;const e=f.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),t=(0,G.jsx)(r().sA,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});return["editor","read_and_write","comment_only","reader"].map((function(o){const i=(null==v?void 0:v.role)===o?t:void 0;return(0,ae().or)({teamValue:{id:n.id,permissions:n.getPermissionItems()},permissionRole:o})?{role:o,disabledInfo:{isDisabled:!0,disabledMessage:e},tag:i}:{role:o,tag:i}}))}),[v,f,n]);const w=(0,a().IS)((e=>({overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},roleSelectButton:{marginRight:0,fontSize:12,color:e.text.secondary,visibility:m?void 0:"hidden"},disabledItem:{...u,color:e.text.tertiary}})),[u,m]),j=(0,G.jsxs)("div",{style:w.overrideTitle,children:[(0,G.jsx)(r().sA,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),null!=x&&x.upsell&&!m?(0,G.jsx)(Mt().B,{upsell:null==x?void 0:x.upsell,analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,G.jsx)(xt().Ay,{role:"owner"===l.type?"none":d.role,table:yt().yK,type:"user"===l.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===l.entity_type?"user_permission_item":"group_permission_item",disabled:M,buttonStyle:w.roleSelectButton,availableRoleItems:A,header:(0,G.jsx)(_().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,G.jsx)(r().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){rt().ui({message:(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:c,role:(0,St().qZ)(e).toLowerCase()}}),description:(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:rt().zw,items:[{label:(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:t}=k().createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:g,canUndo:!0,perform:t=>{L().b4({memberInfo:l,teamStore:n,transaction:t,environment:g,permissionRole:e})}});await t,n.isDefault()&&(n.getMembershipDefinedOnTeam().some((e=>(0,bt().Q6)(e,l)))||await L().Zd({environment:g,teamStore:n,teamMemberInfos:[l],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),p&&p())},buttonPopupStore:y,placementToOrigin:pt().UV.Right,alignmentToOrigin:pt().MY.End})]});return(0,G.jsx)(T().A,{placement:M?R().W.Right:R().W.Left,textWrap:!0,renderTooltip:()=>M&&!S?(0,G.jsx)(r().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip.disabled",defaultMessage:"You must be a teamspace owner to set custom permission level"}):(0,G.jsx)(r().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,G.jsx)(ge().A,{...e,focused:!1,disabled:M,style:M?w.disabledItem:u,textWrapperStyle:{marginRight:0},onClick:()=>y.setState({open:!0}),title:j,icon:m?(0,G.jsx)("div",{style:{marginTop:8},children:(0,at().o)({width:14})}):void 0})})}function wt(e){let{teamStore:t,memberInfo:n,permissionItem:o,memberName:a,isPermissionOverridden:l,disabled:c}=e;const u=(0,s().uB)(void 0,ut().A),p=(0,i().v3)(),g=(0,s().O$)(h().AppStoreCurrentSpaceStore),f=(0,s().K8)((()=>h().default.state.currentUserStore),[]),y=(0,s().K8)((()=>{const e=null==f?void 0:f.userId;return"user"===n.entity_type&&n.user_id===e}),[null==f?void 0:f.userId,n]),v=()=>u.setState({...u.state,open:!1}),b=(0,O().R)(t),x=(0,gt().P9)({name:"team_self_promotion",spaceId:null==g?void 0:g.id,userId:null==f?void 0:f.userId}),S=(0,s().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return Boolean(null==e?void 0:e.canAdmin())}),[]),M=(0,s().K8)((()=>{const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return e.length+n.length}),[t]),A=(0,ht().$)(t),w=0===M,j=async e=>{v();const o="owner"===e?(0,G.jsx)(r().sA,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,G.jsx)(r().sA,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==n.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===n.entity_type||"group"===n.entity_type){const e=async()=>{const{serverCommitResult:e}=k().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:p,canUndo:!0,perform:e=>{L().D6({environment:p,memberInfo:n,teamStore:t,transaction:e})}});await e},o=async()=>{await L().z9({environment:p,teamStore:t,currentSpaceStore:g,from:"team_settings_members",action:"upgradeToOwner"})};w&&y?rt().ui({message:(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.message",defaultMessage:"Are you sure you want to become a teamspace owner? You can become the teamspace owner since there are no other owners and you are a workspace admin."}),showCancel:!0,keepFocus:!1,handleCancel:rt().zw,items:[{label:(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.accept",defaultMessage:"Become teamspace owner"}),color:"blue",onAccept:async()=>{await e()}}]}):y&&x&&S?await o():await e()}}else y&&b?rt().ui({message:(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:rt().zw,items:[{label:(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:C}]}):await C();else{const i=(0,m().getTeamsWithUserDirectMembership)(n.user_id).length;rt().ui({message:(0,G.jsx)(G.Fragment,{children:i>1?(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:o,numberOfOtherTeams:i-1}}):(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:o}})}),showCancel:!0,keepFocus:!1,handleCancel:rt().zw,items:[{label:(0,G.jsx)(r().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(g){const{serverCommitResult:o}=k().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:p,canUndo:!0,perform:o=>{L().Nd({environment:p,userId:n.user_id,teamStore:t,transaction:o,spaceStore:g,newTeamRole:e})}});await o}}}]})}},C=async()=>{if("owner"!==n.type||"user"!==n.entity_type&&"group"!==n.entity_type){if("member"===n.type){const{serverCommitResult:e}=k().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:p,canUndo:!0,perform:e=>{L().P8({environment:p,memberInfo:n,teamStore:t,transaction:e})}});await e}}else{const{serverCommitResult:e}=k().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:p,canUndo:!0,perform:e=>{L().qS({memberInfo:n,teamStore:t,transaction:e,environment:p})}});await e}},I=async()=>{var e;const{entity_type:o}=n;switch(v(),o){case"group":const i=null===(e=st().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n.group_id)))||void 0===e?void 0:e.group;if(!i)throw new Error("Permission group not found in space.");L().BQ({environment:p,teamStore:t,group:i});break;case"user":await L().fy({environment:p,teamStore:t,userId:n.user_id,from:"team_settings_member_table",userGroupsInTeam:A});break;default:(0,d().HB)(o)}};return(0,G.jsx)(fe().Ay,{buttonPopupStore:u,placementToOrigin:pt().UV.Bottom,renderOrigin:e=>(0,G.jsx)(jt,{buttonPopupEvents:e,isPermissionOverridden:l,permissionItem:o,memberInfo:n,disabled:c}),render:()=>(0,G.jsx)(kt,{teamStore:t,isPermissionOverridden:l,memberInfo:n,permissionItem:o,memberName:a,numberOfOwners:M,isMemberCurrentUser:y,onMenuItemClicked:j,onRemoveClicked:I,onSubMenuItemClicked:v}),popupType:fe().z7.Popup})}function kt(e){let{teamStore:t,isPermissionOverridden:n,memberInfo:o,permissionItem:i,memberName:r,numberOfOwners:d,isMemberCurrentUser:u,onRemoveClicked:m,onMenuItemClicked:g,onSubMenuItemClicked:f}=e;const y=(0,s().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,dt().Qd)()}),[]),v=(0,s().K8)((()=>t.isDefault()),[t]),b=(0,ct().J)(),x=(0,s().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return Boolean((null==e?void 0:e.canAdmin())&&(0,mt().OX)())}),[]),S=(0,O().R)(t),M=(0,Fe().X)(t),A=1===d,w=0===d,k=(0,a().IS)((e=>{const t={paddingTop:5,paddingBottom:5},n={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:n,indentedMenuItem:{...n,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.text.secondary,fontSize:12,fontWeight:c().Wy.regular}}}),[]),j=(e,t,n)=>(0,ft().W)({isCurrentUserTeamOwner:S,role:e,isDefaultTeam:v,userIsSpaceAdmin:Boolean(b),userIsEnterpriseWorkspaceOwner:x,originalTeamMemberInfo:t,onlyHasOneOwner:A,isUnowned:w,isMemberCurrentUser:u,canCurrentUserAddTeamMembers:n}),C=(e,t)=>{const{isDisabled:o,disabledReason:i}=j(e,t,M);return{key:e,action:()=>g(e),render:s=>{const a=!n&&t.type===e;return(0,G.jsx)(T().A,{disableTooltip:!o,placement:R().W.Right,textWrap:!0,renderTooltip:()=>i,render:t=>(0,G.jsx)("span",{...t,children:(0,G.jsx)(ge().A,{...s,style:a?k.menuItem:k.indentedMenuItem,disabled:o,disabledFeedback:o,title:(0,G.jsx)(Ct,{type:e}),caption:Tt(e),shouldWrapCaption:!0,icon:a?(0,at().o)({width:14}):void 0})})})}}},I=v&&"user"===o.entity_type,_="group"!==o.entity_type&&y,P=[{key:"teamRoles",items:l().oE([C("owner",o),C("member",o),_?C("team_level_guest",o):void 0,_t({onRemoveClicked:m,styles:k,...j("none",o,M),isMemberInDefaultTeam:I}),..."owner"===o.type||w?[]:[{key:"divider",action:()=>{},render:()=>(0,G.jsx)(lt().A,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,G.jsx)("span",{...e,children:(0,G.jsx)(At,{teamStore:t,memberInfo:o,permissionItem:i,memberName:r,onMenuItemClicked:f,isPermissionOverridden:n,style:n?k.menuItem:k.indentedMenuItem})})}]]),render:e=>(0,G.jsx)(ve().A,{...e,topBorder:0!==e.index})}];return(0,G.jsx)(he().A,{className:p().yw8,menuType:xe().gu.Popup,children:(0,G.jsx)(ye().Ay,{type:ye().Oh.Vertical,initialFocus:void 0,sections:P})})}function jt(e){let{buttonPopupEvents:t,disabled:n,isPermissionOverridden:o,permissionItem:i,memberInfo:s}=e;const l=(0,a().IS)((e=>({label:{color:e.text.primary,fontSize:12.5,fontWeight:c().Wy.regular},overrideLabel:{color:e.text.secondary,fontSize:12,fontWeight:c().Wy.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),u=function(e,t,n){if(t&&n)return function(e){switch(e){case"none":return(0,G.jsx)(r().sA,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,G.jsx)(r().sA,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,G.jsx)(r().sA,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,G.jsx)(r().sA,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,G.jsx)(r().sA,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,G.jsx)(r().sA,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,d().HB)(e)}}(n);return It(e)}(s.type,o,i.role);return(0,G.jsxs)(X().p,{disabled:n,...t,children:[o&&(0,G.jsxs)("span",{style:l.overrideLabel,children:[(0,G.jsx)(r().sA,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,G.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,G.jsx)("span",{style:l.label,children:u}),!n&&(0,ie().b)(l.chevron)]})}function Ct(e){let{type:t}=e;const n=It(t);return(0,G.jsx)("div",{children:(0,G.jsx)("span",{children:n})})}function It(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,G.jsx)(r().sA,{...m().ROLE_MESSAGE_MAP[e].label});case"none":return;default:(0,d().HB)(e)}}function Tt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,G.jsx)(r().sA,{...m().ROLE_MESSAGE_MAP[e].caption});case"none":return;default:(0,d().HB)(e)}}function _t(e){let{styles:t,isDisabled:n,disabledReason:o,onRemoveClicked:i,isMemberInDefaultTeam:s}=e;return{key:"remove",action:i,render:e=>(0,G.jsx)(T().A,{disableTooltip:!n,placement:R().W.Right,textWrap:!1,renderTooltip:()=>o,render:o=>(0,G.jsx)("span",{...o,children:(0,G.jsx)(ge().A,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:n,disabledFeedback:!0,title:(0,G.jsx)(r().sA,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var Pt=()=>n(265665);function Bt(e){const{icon:t,label:n,name:o,tag:i,style:s}=e,r=(0,a().IS)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...s},labelContainer:{display:"flex",flexDirection:"column",...c().RC,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[s]);return(0,G.jsxs)("div",{style:r.container,children:[t,(0,G.jsxs)("div",{style:r.labelContainer,children:[(0,G.jsxs)("div",{style:r.nameContainer,children:[(0,G.jsx)(Pt().j,{style:r.name,children:o}),i]}),n&&(0,G.jsx)(_().A,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,G.jsx)(Pt().j,{children:n})})]})]})}function Rt(e){const{iconComponent:t,label:n,name:o,permissionRoleSelectComponent:i,tag:s,tooltip:r,style:l}=e,d=(0,a().IS)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,G.jsxs)("div",{style:d.permissionRow,children:[(0,G.jsx)(Bt,{icon:t,name:o,tag:s,label:n,style:{minWidth:200,marginRight:6}}),(0,G.jsx)(T().A,{textWrap:!0,style:{width:210},disableTooltip:!r,placement:R().W.Left,renderTooltip:()=>r,render:e=>(0,G.jsx)("span",{...e,children:i})})]})}function Lt(e){const{type:t,store:n,permissionItem:o,memberInfo:l}=e,c=(0,i().v3)(),u=(0,r().tz)(),p="group"===t?e.permissionGroup:void 0,g="user"===t?e.userStore:void 0,f=(0,s().O$)(h().AppStoreCurrentSpaceStore),y=(0,s().K8)((()=>{var e;switch(t){case"group":return"none";case"user":const n=l.user_id;return(null===(e=(0,it().sE)(f,n))||void 0===e?void 0:e.getMembershipTypeAsRoleOrNone())??"none";default:(0,d().HB)(t)}}),[t,l,f]),v=(0,O().R)(n),b=(0,Fe().X)(n),x=(0,s().K8)((()=>{const{currentSpaceStore:e}=h().default.state;return null==e?void 0:e.canEditMembership()}),[]),S=(0,s().K8)((()=>{const e=c.currentUser.id,t=n.getSettingsStore().getValue();return!!(null!=f&&f.isDefined()&&n.isDefined()&&t&&e)&&(0,m().isEligibleToUpgradeMemberToOwnerForUnownedTeam)({environment:c,teamStore:n,spaceStore:f})}),[c,f,n]),M=(0,s().K8)((()=>{const e=n.getPermissionItems()||[];switch(l.entity_type){case"group":return Boolean(e.find((e=>(0,se().Ds)(e)&&e.group_id===l.group_id)));case"user":return Boolean(e.find((e=>(0,se().B2)(e)&&e.user_id===l.user_id)));default:return!1}}),[l,n]),{name:A,label:w,icon:k,isSelfUserPermission:j}=(0,s().K8)((()=>{const e=c.currentUser.id;switch(t){case"group":return Ot({permissionGroup:p,spaceId:null==f?void 0:f.id});case"user":return function(e){var t;let{intl:n,userStore:o,currentUserId:i}=e;const s=void 0!==i&&(null==o||null===(t=o.getModel())||void 0===t?void 0:t.id)===i;return{name:(0,Xe().c6)(n,null==o?void 0:o.getModel()),label:null==o?void 0:o.getEmail(),icon:(0,G.jsx)(nt().A,{avatarShouldShowShadow:!0,userStore:o,size:32}),isSelfUserPermission:s}}({intl:u,userStore:g,currentUserId:e});default:(0,d().HB)(t)}}),[c.currentUser.id,t,p,null==f?void 0:f.id,u,g]),C=(0,G.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,G.jsx)(wt,{teamStore:n,memberInfo:l,memberName:A,permissionItem:o,isPermissionOverridden:M,disabled:b&&"member"===l.type?!v&&M:!v&&!S||"team_level_guest"===l.type&&!x})}),I=(0,a().IS)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17},titleYouIndicator:{color:e.text.secondary}})),[]),T=(0,G.jsxs)("div",{style:{display:"flex",gap:4},children:[A,j&&(0,G.jsx)("span",{style:I.titleYouIndicator,children:(0,G.jsx)(r().sA,{id:"specificTeamMemberPermissionRow.displayName.youIndicator",defaultMessage:"(You)"})})]});return(0,G.jsx)(Rt,{style:I.row,tag:(0,se().EH)(y)?(0,G.jsx)(Je().A,{desktopStyle:I.pill,mobileStyle:I.pill,role:Dt(y)}):"group"===t?(0,G.jsx)("div",{style:I.pill,children:k}):void 0,permissionRoleSelectComponent:C,iconComponent:"group"===t?(0,G.jsx)(et().A,{size:32}):k,name:T,label:w})}function Dt(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,d().HB)(e)}}function Ot(e){var t;let{spaceId:n,permissionGroup:o}=e;const{name:i,icon:s}=o,a=(null===(t=st().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===o.group_id)))||void 0===t?void 0:t.memberCount)??0;return{name:i||(0,G.jsx)(r().sA,{id:"teamPermissionSettings.untitled",defaultMessage:"Untitled"}),label:(0,G.jsx)(T().A,{placement:R().W.Bottom,alignment:R().C.Start,disableTooltip:0===a,renderTooltip:()=>(0,G.jsx)(ot().Q,{group:o,limit:10,noMembersMessage:void 0}),render:e=>(0,G.jsxs)("div",{...e,children:[(0,G.jsx)(r().sA,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,G.jsx)(r().sA,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:a}})]})}),icon:s&&(0,G.jsx)(tt().B,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:i,size:18,icon:s&&n?{icon:s,pointer:{table:Ze().NX,id:n}}:void 0}),isSelfUserPermission:!1}}var Nt=()=>n(689094),Et=()=>n(47170),Ut=()=>n(224701);function Ft(e){let{teamStore:t,...n}=e;const l=(0,i().v3)(),d=(0,Et().O)(),c=(0,r().tz)(),u=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),p=(0,o.useCallback)((e=>{w().D6({label:(0,G.jsx)(r().sA,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),m=(0,o.useCallback)((async(e,n)=>{await L().Zd({environment:l,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await Ut().Ow(l):p(n)}),[l,p,t]),g=(0,o.useCallback)(((e,t)=>m({type:"member",entity_type:"user",user_id:e.id},t)),[m]),f=(0,o.useCallback)(((e,t)=>m({type:"member",entity_type:"group",group_id:e.group_id},t)),[m]),h=(0,s().K8)((()=>{if("groupToAdd"in n)return Ot({spaceId:d,permissionGroup:n.groupToAdd})}),[d,n]);if("memberToAdd"in n){const{memberToAdd:e}=n,t=(0,Xe().c6)(c,e);return(0,G.jsxs)("div",{style:u.container,children:[(0,G.jsx)(Bt,{icon:(0,G.jsx)(nt().A,{userValue:e,size:32}),name:t,label:e.email}),Vt((()=>{g(e,t)}))]})}{if(!d||!h)return(0,G.jsx)(G.Fragment,{});const{groupToAdd:e}=n;return(0,G.jsxs)("div",{style:u.container,children:[(0,G.jsx)(Bt,{icon:(0,G.jsx)(et().A,{size:32}),name:h.name,label:h.label,tag:(0,G.jsx)("div",{style:u.pill,children:h.icon})}),Vt((()=>{f(e,h.name)}))]})}}function Vt(e){return(0,G.jsx)(X().p,{isBlue:!0,onClick:e,icon:Nt().W,children:(0,G.jsx)(r().sA,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})})}var Kt=()=>n(158359),Ht=()=>n(498474);function zt(e){let{sortType:t,onChangeSortType:n}=e;const o=(0,a().IS)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),i=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",s=e=>{const o=e===t.column&&!t.sortedAscending;n({column:e,sortedAscending:o})};return(0,G.jsxs)("div",{style:o.container,children:[(0,G.jsx)(Wt,{title:(0,G.jsx)(r().sA,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>s("name")}),(0,G.jsx)(Wt,{title:(0,G.jsx)(r().sA,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>s("role")})]})}function Wt(e){let{sortedType:t,title:n,onClick:o}=e;const i=(0,a().IS)((e=>({button:{color:e.text.secondary,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return(0,G.jsxs)(X().p,{style:i.button,hoveredStyle:i.buttonHover,onClick:o,children:["ascending"===t&&(0,Ht().q)(i.sortIcon),"descending"===t&&(0,Kt().P)(i.sortIcon),n]})}function Gt(e){let{store:t}=e;const n=(0,i().v3)(),l=(0,a().IS)((e=>({container:{display:"block",overflow:"hidden"},noResult:{fontSize:c().J.UIRegular.desktop,color:e.text.secondary,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),u=(0,r().tz)(),[p,f]=(0,o.useState)({column:"role",sortedAscending:!1}),y=(0,Fe().X)(t),v=(0,s().K8)((()=>{const e=Qe().subscriptionDataStoreInstance.state;return e?t.getMemberInfoUsingSpaceMembers((0,$e().Ye)(e))??[]:[]}),[t]),b=(0,s().O$)(h().AppStoreCurrentSpaceStore),x=(0,s().K8)((()=>h().default.state.currentUserStore),[]),{permissionRowInfos:S,numNotShown:M}=(0,s().K8)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:n,intl:o}=e;if(""===n)return t;return(0,ze().Ay)(n,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name||"";case"user":const{userStore:n}=e;return n.getSearchName(o);default:(0,d().HB)(t)}}))}({permissionRowInfos:(0,m().getPermissionRowInfos)({currentUserStore:x,currentSpaceStore:b,teamStore:t,members:v}),memberFilterQuery:g().A.state.memberFilterQuery,intl:u}),n=function(e){let{permissionRowInfos:t,sortType:n,intl:o}=e;const{column:i,sortedAscending:s}=n,a={permissionRowInfos:t,sortedAscending:s};if("role"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n}=e;const o=["owner","member","team_level_guest"],i=["group","user"];return[...t].sort(((e,t)=>{const n=e.memberInfo.entity_type,o=t.memberInfo.entity_type;return i.indexOf(n)-i.indexOf(o)})).sort(((e,t)=>{const i=e.memberInfo.type,s=t.memberInfo.type,a=o.indexOf(i)-o.indexOf(s);return n?-a:a}))}(a);if("name"===i)return function(e){let{permissionRowInfos:t,sortedAscending:n,intl:o}=e;return[...t].sort(((e,t)=>{const i=Yt(e,o)??"",s=Yt(t,o)??"";if(i===s)return 0;const a=i<s?-1:1;return n?-a:a}))}({...a,intl:o});(0,d().HB)(i)}({permissionRowInfos:e,sortType:p,intl:u}),o=g().A.state.limitMembers?n.slice(0,50):n;return{permissionRowInfos:o,numNotShown:e.length-o.length}}),[b,x,v,t,p,u]),A=(0,We().fJ)(Ge().T.searchActions),w=(0,s().K8)((()=>{const e=Ye().A.state.shouldUseEdgeCache,t=qe().default.checkGate({gateName:"edge_cache_settings"});return e&&t}),[]),k=(0,s().K8)((()=>g().A.state.memberFilterQuery),[]),[j]=(0,He().Yb)((async()=>{if(!y||null==k||!k.trim().length||"resolved"!==A.status)return[];const e=A.value;return[...(w?await e.searchEdgeCacheSpaceUsers({environment:n,query:k,membersOnly:!0,limit:5}):await e.searchVisibleSpaceUsers({environment:n,query:k,membersOnly:!0})).map((e=>({type:"user",value:e}))),...e.searchSpaceGroups({query:k,intl:u}).map((e=>({type:"group",value:e})))]}),[y,k,A.status,A.value,n,u,w]),C=(0,s().K8)((()=>{if("resolved"!==j.status)return[];const e=new Set(S.map($t));return j.value.filter((t=>!e.has("user"===t.type?t.value.id:t.value.group_id))).slice(0,5)}),[j.status,j.value,S]),I=Boolean(null==k?void 0:k.trim().length),T=S.length>0;return(0,G.jsxs)("div",{style:l.container,children:[(0,G.jsx)(qt,{title:I?(0,G.jsx)(r().sA,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,G.jsx)(zt,{sortType:p,onChangeSortType:f}),rows:S,renderRow:e=>(0,G.jsx)(Lt,{store:t,...e})}),M>0&&(0,G.jsx)(X().p,{isGray:!0,size:"xs",style:l.showMore,onClick:()=>{g().A.update((e=>({...e,limitMembers:!1})))},children:(0,G.jsx)(r().sA,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:M}})}),C.length>0&&(0,G.jsx)(qt,{title:(0,G.jsx)(r().sA,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"}),rows:C,renderRow:e=>"user"===e.type?(0,G.jsx)(Ft,{teamStore:t,memberToAdd:e.value}):(0,G.jsx)(Ft,{teamStore:t,groupToAdd:e.value})}),!T&&0===C.length&&(0,G.jsx)("div",{style:l.noResult,children:(0,G.jsx)(r().sA,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})})]})}function Yt(e,t){const{type:n}=e;if("user"===n){const{userStore:n}=e;return n.getDisplayName(t)}if("group"===n){const{permissionGroup:t}=e;return t.name}(0,d().HB)(n)}function qt(e){let{rows:t,renderRow:n,title:i}=e;const s=(0,a().IS)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?(0,G.jsxs)(G.Fragment,{children:[i&&(0,G.jsx)(_().A,{isSmall:!0,children:i}),(0,G.jsx)("div",{style:s.membersList,children:t.map(((e,t)=>(0,G.jsxs)(o.Fragment,{children:[t>0&&(0,G.jsx)("div",{style:s.memberDivider}),n(e)]},t)))})]}):null}function $t(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,d().HB)(e)}}function Qt(e){let{teamStore:t}=e;const n=(0,a().IS)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,G.jsxs)("div",{style:n.content,children:[(0,G.jsx)(Ke,{teamStore:t}),(0,G.jsx)(Gt,{store:t})]})}var Zt=()=>n(278238);function Xt(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,r().tz)(),{teamGuestPermissionItem:l,teamPermissions:d}=(0,s().K8)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),c=N(t),u=(0,s().K8)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:o.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[o]),p=(0,a().IS)((e=>({button:{fontSize:12.5,marginRight:0,color:e.text.secondary}})),[]),m=l&&(0,G.jsx)(xt().Ay,{role:l.role,table:yt().yK,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:c,buttonStyle:p.button,availableRoleItems:u,onChange:async e=>{if(d.filter((t=>((0,se().B2)(t)||(0,se().Ds)(t))&&(0,ae().dI)(e,t.role))).length>0){if(!(await(0,B().fT)()))return}k().createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:o=>{L().HU({environment:n,teamStore:t,newRole:e,transaction:o,permissionsToClear:[]})}})}}),g=(0,s().K8)((()=>t.getName()),[t]),f=(0,s().K8)((()=>t.getIcon()),[t]),h=f&&Zt().T8(f.icon)?Zt().VA(f.icon):"gray",y=f?{...f,icon:`/icons/user-circle_${h}.svg`}:void 0,v=(0,G.jsx)(K().x,{disabled:!0,store:t,size:H().QT,icon:y});return m?(0,G.jsx)(Rt,{permissionRoleSelectComponent:m,iconComponent:v,name:Jt(g)}):null}function Jt(e){return e?(0,G.jsx)(r().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,G.jsx)(r().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function en(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,a().DP)(),l=(0,r().tz)(),{teamPermissionItem:d,teamPermissions:c}=(0,s().K8)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=N(t),p=(0,s().K8)((()=>{var e;const n=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),o=l.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function i(e){return n&&e!==n.role&&(0,ae().$q)(e,n.role)===n.role&&!t.isDefault()?{role:e,disabledInfo:{isDisabled:!0,disabledMessage:o}}:{role:e,disabledInfo:void 0}}return[i("editor"),i("read_and_write"),i("comment_only"),i("reader")]}),[l,t]),m=d&&(0,G.jsx)(xt().Ay,{role:d.role,table:yt().yK,type:(0,se().gl)(d)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:o.text.secondary},availableRoleItems:p,onChange:async e=>{const o=c.filter((t=>((0,se().B2)(t)||(0,se().Ds)(t))&&(0,ae().dI)(e,t.role)));if(o.length>0){if(!(await(0,B().fT)()))return}k().createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:i=>{L().xp({environment:n,teamStore:t,newRole:e,transaction:i,permissionsToClear:o})}})}}),{teamName:g}=(0,s().K8)((()=>({teamName:t.getName()})),[t]),f=(0,G.jsx)(K().x,{disabled:!0,store:t,size:H().QT});return(0,G.jsx)(Rt,{permissionRoleSelectComponent:m,iconComponent:f,name:tn(g)})}function tn(e){return e?(0,G.jsx)(r().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,G.jsx)(r().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var nn=()=>n(798880),on=()=>n(482705);function sn(e){const{teamStore:t,teamOwnerIds:n}=e,o=(0,a().DP)(),i=(0,s().K8)((()=>t.getName()),[t]),l=(0,s().K8)((()=>t.getTeamOwnerPermission()),[t]),d=(0,s().K8)((()=>h().default.state.currentUserStore),[]),c=(0,s().K8)((()=>d?n.map((e=>y().LU.createChildStore(d,{table:nn().oo,id:e}))):[]),[d,n]);return(0,G.jsx)(Rt,{tooltip:(0,G.jsx)(r().sA,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,G.jsx)(xt().Ay,{role:"editor",table:yt().yK,type:l&&(0,se().nl)(l)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:o.text.secondary,marginRight:0},availableRoleItems:[]}),iconComponent:(0,G.jsx)(on().l,{teamStore:t,ownerStores:c,isSmall:!0}),name:an(i)})}function an(e){return e?(0,G.jsx)(r().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,G.jsx)(r().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var rn=()=>n(449552),ln=()=>n(579627);function dn(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,s().O$)(h().AppStoreCurrentSpaceStore),{iconComponent:a,spaceName:r}=(0,s().K8)((()=>{if(!o)return{iconComponent:void 0,spaceName:void 0};const e=(0,z().GK)(n,o);return{iconComponent:(0,G.jsx)(K().x,{disabled:!0,store:o,size:H().QT}),spaceName:e}}),[o,n]);return(0,G.jsx)(Rt,{permissionRoleSelectComponent:(0,G.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,G.jsx)(un,{teamStore:t})}),iconComponent:a,name:cn(r)})}function cn(e){return e?(0,G.jsx)(r().sA,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,G.jsx)(r().sA,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function un(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,a().DP)(),d=(0,s().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),c=N(t),u=(0,s().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return ue({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const p=u.permissionItemRoleOptions.spacePermission;if(1===p.length&&"none"===p[0])return(0,G.jsx)(T().A,{renderTooltip:()=>(0,G.jsx)(r().sA,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,rn().g)({width:14,height:14,fill:o.timelineRed,marginRight:4}),(0,G.jsx)("div",{style:{fontSize:12.5,color:o.timelineRed,marginRight:8},children:(0,G.jsx)(r().sA,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=l().Ul(p,(e=>-se().TE[e])).map((e=>({role:e})));return(0,G.jsx)(xt().Ay,{role:d.role,table:yt().yK,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:c||1===p.length,buttonStyle:{fontSize:12.5,marginRight:0,color:o.text.secondary},availableRoleItems:e,onChange:e=>{const o={...d,role:e};k().createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:n,canUndo:!0,perform:e=>{ln().bo({environment:n,store:t,permissionItems:[o],transaction:e})}})}})}}function pn(e){let{teamStore:t}=e;const n=(0,s().K8)((()=>t.isDefault()),[t]),o=(0,s().K8)((()=>t.getOwnerUserIds()),[t]),i=(0,s().K8)((()=>{const e=h().default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!n&&(0,dt().Qd)())}),[n]),r=(0,a().IS)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,G.jsxs)("div",{style:r.container,children:[(0,G.jsx)(sn,{teamStore:t,teamOwnerIds:o},"0"),(0,G.jsx)(en,{teamStore:t},"1"),i&&(0,G.jsx)(Xt,{teamStore:t},"2"),!n&&(0,G.jsx)(dn,{teamStore:t},"3")]})}var mn=()=>n(838156);function gn(e){let{teamStore:t}=e;const n=(0,a().IS)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(fn,{teamStore:t}),(0,G.jsx)("div",{style:n.spacer}),(0,G.jsx)(mn().a,{title:(0,G.jsx)(r().sA,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:n.heading}),(0,G.jsx)(Qt,{teamStore:t})]})}function fn(e){let{teamStore:t}=e;const n=(0,i().v3)(),l=(0,s().K8)((()=>t.getName()),[t]),d=(0,a().IS)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),c=(0,o.useCallback)(((e,o)=>{L().qH({environment:n,accessLevel:e,isDefault:o,store:t,teamName:l,from:"sidebar_team_modal"})}),[n,t,l]),u=(0,s().K8)((()=>t.getTeamAccessLevel()),[t]),p=[(0,G.jsx)(W().u,{teamStore:t,currentAccessLevel:u,onChange:c,style:d.accessButton},"visibility"),(0,G.jsx)(pn,{teamStore:t},"permissions")];return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(H().BA,{title:(0,G.jsx)(r().sA,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:p,itemStyle:d.teamSettingsListItems}),(0,G.jsx)(V().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,G.jsx)(r().sA,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:d.learnMoreLinkContainer})]})}var hn=()=>n(192940),yn=()=>n(545805),vn=()=>n(676007),bn=()=>n(16006),xn=()=>n(2143),Sn=()=>n(994006),Mn=()=>n(101919),An=()=>n(987017),wn=()=>n(824160);function kn(e){return(0,G.jsx)(wn().A,{...e,children:(0,G.jsx)(r().sA,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function jn(e){const{teamStore:t}=e,n=(0,s().K8)((()=>g().A.state.tab),[]);if(void 0===n)return null;switch(n){case g().p.General:return(0,G.jsx)(Re,{teamStore:t});case g().p.Members:return(0,G.jsx)(gn,{teamStore:t});case g().p.Security:return(0,G.jsx)(Ce,{teamStore:t});default:(0,d().HB)(n)}}function Cn(e){const{userId:t,currentSpaceStore:n}=e,{userStore:o,isDefined:i}=(0,s().K8)((()=>{const e=y().LU.createChildStore(n,{table:"notion_user",id:t,spaceId:n.id});return{userStore:e,isDefined:e.isDefined()}}),[n,t]);return i?(0,G.jsx)(Sn().A,{avatarShouldShowShadow:!0,userStore:o,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function In(e){const{userIds:t,label:n,hasMarginTop:o}=e,i=(0,s().O$)(h().AppStoreCurrentSpaceStore);return i?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Mn().A,{hasMarginTop:o,children:n}),t.map((e=>(0,G.jsx)(Cn,{userId:e,currentSpaceStore:i},e)))]}):null}function Tn(){const e=(0,i().v3)(),t=(0,s().O$)(h().AppStoreCurrentSpaceStore),n=(0,s().O$)(h().AppStoreCurrentSpaceViewStore),o=(0,i().Y0)(),y=(0,a().IS)((e=>({modal:{width:o.isMobile?"auto":630,height:o.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:c().Wy.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.text.primary,fontWeight:c().Wy.regular,textTransform:"unset",fontSize:11}})),[o.isMobile]),{open:v,tab:S,teamStore:M}=(0,s().K8)((()=>{const{open:e,tab:t}=g().A.state;return{open:e,tab:t,teamStore:g().A.getTeamStore()}}),[]),A=(0,s().K8)((()=>null==M?void 0:M.getSettings()),[M]),w=(0,O().R)(M);if(!t||!n||!M)return null;const k=[g().p.General,g().p.Members,g().p.Security];return(0,G.jsx)(vn().A,{open:v,innerStyle:y.modal,onDismiss:()=>{g().A.reset()},render:()=>v?(0,G.jsx)("div",{className:p().kYU,style:{height:"100%"},children:(0,G.jsx)("div",{style:y.modalWrap,children:(0,G.jsx)(yn().A,{debugName:"SidebarTeamModal",capture:!0,onBackspace:l().D_,onLeft:l().D_,onRight:l().D_,onSelectAll:l().D_,onRedo:l().D_,onUndo:l().D_,onCut:l().D_,onCopy:l().D_,onPaste:l().D_,onKeypress:l().D_,onDelete:l().D_,onTab:l().D_,children:(0,G.jsxs)("div",{style:y.innerWrap,children:[(0,G.jsxs)("div",{style:y.header,children:[(0,G.jsx)(K().x,{disabled:!0,store:M,size:24,style:y.icon}),(0,G.jsx)(bn().A,{store:M,style:{fontSize:16,fontWeight:c().Wy.semibold}}),(0,m().shouldShowLockIconForTeam)(A)&&(0,G.jsx)(x().A,{iconStyle:y.lockIcon}),(0,m().isUnownedTeam)({membership:M.getRawMembership()})&&(0,G.jsx)("div",{style:{gap:5,display:"flex"},children:(0,G.jsx)(kn,{desktopStyle:y.unownedPill,mobileStyle:y.unownedPill,innerStyle:y.unownedPillInner})}),(0,G.jsx)("div",{style:{flexGrow:1}}),(0,G.jsx)(b().TeamJoinLeaveButton,{teamStore:M,onLeavingTeam:()=>g().A.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,G.jsx)(An().Ay,{tabs:k.map((e=>function(e,t){switch(e){case g().p.General:return(0,G.jsx)(r().sA,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case g().p.Members:return(0,G.jsx)(_n,{teamStore:t});case g().p.Security:return(0,G.jsx)(r().sA,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,d().HB)(e)}}(e,M))),selectedIndex:(0,d().O9)(S)?k.indexOf(S):1,onChange:t=>{v&&(u().Vg(e,{store:M,tab_old_value:S??g().p.General,tab_new_value:k[t]}),g().A.update((e=>e.open?{...e,tab:k[t]}:e)))},tabStyle:{marginLeft:-8},style:y.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,G.jsx)(xn().H,{type:f().A.Y,style:y.scroller,children:(0,G.jsx)("div",{style:y.contentWrap,children:(0,G.jsx)(jn,{currentSpaceStore:t,teamStore:M,userIsTeamOwner:w})})})]})})})}):null})}function _n(e){let{teamStore:t}=e;const n=(0,hn().h)(t),o=(0,a().DP)();return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(r().sA,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,G.jsx)("span",{children:" "}),(0,G.jsx)("div",{style:{color:o.text.tertiary},children:n})]})}function Pn(e){let{title:t,caption:n,secondCaption:o,on:s,disabled:r,tooltip:l,style:d,switcherStyle:c,onChange:u,shouldTriggerUpsell:p,upsellTier:m,isLocked:g,lockedTooltip:f}=e;const h=(0,i().v3)(),y=(0,a().IS)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:p?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18,...c}})),[p,d,c]);return(0,G.jsxs)("div",{style:y.root,onClick:()=>{if(p)return v().K(h,{from:"team_security_settings",upsell:{type:"product",product:m,limit:{type:"none"},trialability:"none"},dontOpenPlansOnCancel:!0})},children:[(0,G.jsxs)("div",{style:y.title,children:[t,n&&(0,G.jsx)(_().A,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:n}),o&&(0,G.jsx)(_().A,{isSmall:!0,children:o})]}),(0,G.jsx)("div",{style:y.switcherWrap,children:(0,G.jsx)(T().A,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,G.jsx)("div",{...e,children:(0,G.jsx)(be().A,{on:s,disabled:r,onClick:u,isLocked:g,lockedTooltip:f})})})})]})}},315841:(e,t,n)=>{n.d(t,{Js:()=>a,Ns:()=>i,d:()=>s});var o=()=>n(645873);const i={publishSite:new(o().O2)("PublishSite",(async()=>await Promise.all([n.e(9304),n.e(67780),n.e(96933),n.e(52979),n.e(16345)]).then(n.bind(n,142650)))),publishedSiteSettings:new(o().O2)("PublishedSiteSettings",(async()=>await Promise.all([n.e(75134),n.e(9304),n.e(62475),n.e(3151),n.e(98629),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(28721),n.e(6463),n.e(71993),n.e(26483),n.e(81768),n.e(94387),n.e(82850),n.e(77692),n.e(7060),n.e(82136),n.e(12739),n.e(50984),n.e(67780),n.e(96933),n.e(77905),n.e(39301)]).then(n.bind(n,355852))))},s=(0,o()._h)(i.publishedSiteSettings,(e=>e.default)),a=(0,o()._h)(i.publishSite,(e=>e.default))},338429:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(463830).A)},339806:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=n(474848);const l=(0,n(340498).wt)("thanksShield",{viewBox:"0 0 27 32",svg:(0,r.jsx)("path",{d:"M13.5 31.672c.281 0 .672-.125 1.031-.328 8.75-5.063 11.64-6.969 11.64-12.344V7.125c0-1.672-.624-2.219-2.062-2.797-2.218-.89-7.14-2.719-9.375-3.484-.406-.14-.828-.235-1.234-.235-.422 0-.844.11-1.25.235-2.219.719-7.156 2.61-9.375 3.484C1.437 4.891.812 5.453.812 7.125V19c0 5.375 2.922 7.234 11.641 12.344.36.203.75.328 1.047.328zm0-2.14c-.266 0-.547-.126-.922-.36-7.25-4.5-9.844-5.797-9.844-10.547V7.485c0-.782.141-1.063.735-1.298 2.078-.828 7.187-2.656 9.281-3.468.281-.125.547-.188.75-.188.188 0 .438.078.75.188 2.078.812 7.156 2.703 9.266 3.469.593.218.734.515.734 1.296v11.141c0 4.75-2.625 6.016-9.844 10.547-.375.234-.656.36-.906.36zm-1.688-6.75c.391 0 .72-.188.954-.548l7.593-11.859c.141-.234.282-.5.282-.75 0-.531-.485-.906-.985-.906-.312 0-.61.203-.843.547L11.75 20.437 8.156 16c-.281-.375-.562-.484-.89-.484a.944.944 0 00-.938.953c0 .265.11.531.281.765l4.188 5c.297.391.61.547 1.015.547z",fill:"#636363"})});var d=()=>n(959013);const c=["dmca_no_action"],u=(0,d().YK)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"},dmca_no_action:{id:"reportPage.reportReasons.dmca_no_action",defaultMessage:"DMCA takedown request"}});var p=()=>n(100622),m=()=>n(496603),g=()=>n(284371),f=()=>n(449506),h=()=>n(901389),y=()=>n(201170),v=()=>n(186445),b=()=>n(135552),x=()=>n(972435),S=()=>n(722872),M=()=>n(836251),A=()=>n(227440),w=()=>n(736026),k=()=>n(716583),j=()=>n(297872),C=()=>n(623580),I=()=>n(928600),T=()=>n(678553),_=()=>n(939740),P=()=>n(819121),B=()=>n(484595);function R(e){let{name:t,title:n,caption:s,isSelected:l,onClick:d,disabled:c}=e;const[u,p]=(0,P().A)(),m=(0,i().Y0)(),g=(0,a().IS)((e=>({root:{position:"relative",display:"flex",alignItems:"center",flex:1,fontSize:14,marginBottom:8,cursor:"pointer",opacity:c?.4:1,...p&&{boxShadow:e.outlineBlueInputBoxShadow}},caption:{color:e.text.secondary,marginLeft:8},input:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}})),[c,p]),f=(0,o.useCallback)((()=>{c||d()}),[c,d]);return m.isMobile?(0,r.jsx)(T().Ay,{title:n,right:(0,r.jsx)(B().A,{isSelected:l}),onClick:f}):(0,r.jsxs)("label",{style:g.root,children:[(0,r.jsx)(B().A,{isSelected:l}),(0,r.jsx)("div",{children:n}),s&&(0,r.jsx)("div",{style:g.caption,children:s}),(0,r.jsx)("input",{type:"radio",checked:l,disabled:c,name:t,onClick:f,style:g.input,ref:u})]})}var L=()=>n(864943),D=()=>n(89924),O=()=>n(690197),N=()=>n(719147),E=()=>n(327165);const U=(0,d().YK)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Please describe how this content violates our Content & Use Policy ({otherSelected, select, true {required} other {optional}})"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const F=function(){const e=(0,s().K8)((()=>w().A.state.open),[]);return(0,r.jsx)(n(641514).A,{ariaLabel:x().A.formatMessage(U.dialogLabel),onDismiss:Q,render:()=>(0,r.jsx)(ee,{}),isOpen:e})};function V(e){const{reason:t,additionalInformation:n}=e;return void 0!==t&&(!c.includes(t)&&!("other_content_policy_violation"===t&&!n))}function K(){const{state:e}=w().A;if(e.open){const{reason:t,additionalInformation:n}=e;return V({reason:t,additionalInformation:n})}return!1}function H(e){let{modalState:t}=e;const{reason:n}=t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R,{title:(0,r.jsx)(d().sA,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===n,onClick:()=>w().A.setState({...t,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,r.jsx)(R,{title:x().A.formatMessage(u.inappropriate_content),isSelected:"inappropriate_content"===n,onClick:()=>w().A.setState({...t,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,r.jsx)(R,{title:x().A.formatMessage(u.dmca_no_action),isSelected:"dmca_no_action"===n,onClick:()=>w().A.setState({...t,reason:"dmca_no_action"}),name:"report-page-modal"},"dmca_no_action"),(0,r.jsx)(R,{title:(0,r.jsx)(d().sA,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===n,onClick:()=>w().A.setState({...t,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function z(e){const t=w().A.getState();if(!t.open)return;const{additionalInformation:n,reason:o}=t,i=(0,v().Gu)();if(null==i||!i.id||!o||!V({reason:o,additionalInformation:n}))return void h().f1((0,r.jsx)(d().sA,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const s=await f().callApi({eventName:"reportPage",environment:e,data:{reason:o,page:i,additionalInformation:n}});"failed"===s.type?h().Qg(s):(w().A.setState({open:!1}),h().rG({message:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[l({width:32}),(0,r.jsx)("div",{style:{paddingTop:12,paddingBottom:8,textAlign:"center"},children:(0,r.jsx)(d().sA,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})}))}function W(e){return{width:360,padding:24,fontSize:14,color:e.text.secondary}}function G(e,t){const{device:n}=e;return{width:"100%",background:t.popoverBackground,display:"block",padding:n.isMobile?16:"10px 12px",height:n.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:n.isMobile?16:14}}function Y(e){let{isMobile:t=!1}=e;return(0,r.jsx)(d().sA,{defaultMessage:"This page is hosted by Notion. Use this form to submit a report if you believe this page violates <contentpolicylink>Notion's content policy</contentpolicylink>.{br}{br}<clarification>This is not a contact form for the person or organization that authored this page</clarification>.",id:"reportPageModal.reportButton.description",values:{br:(0,r.jsx)("br",{}),contentpolicylink:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(0,r.jsx)(O().A,{title:n,href:(0,M().xS)("contentPolicy"),analyticsFrom:"report_page",style:{display:"inline",marginLeft:void 0},buttonStyle:{alignItems:"baseline",height:t?g().K_.UISmall.mobile:g().K_.UISmall.desktop,paddingLeft:"3px",paddingRight:"2px"},iconStyle:{alignSelf:"center",marginRight:"3px"},textSize:"small",isMobile:t})},clarification:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)("i",{children:t})}}})}function q(){return(0,r.jsx)(d().sA,{defaultMessage:"To submit a formal DMCA takedown request, please follow the instructions detailed in <dmcapolicylink>Notion's official DMCA policy</dmcapolicylink>.",id:"reportPageModal.reportButton.dmcaInstructions",values:{dmcapolicylink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)(N().A,{external:!0,href:"https://www.notion.so/notion/DMCA-Policy-69d880bd37fe496a9b7c64ccc65e024d",children:t})}}})}function $(){const e=(0,a().DP)();return(0,r.jsx)("div",{style:W(e),children:(0,r.jsx)(d().sA,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function Q(){y().lR()}function Z(){return(0,a().IS)((e=>({reportPageExplanation:{color:e.text.tertiary,background:e.contentBackground,border:`1px solid ${e.stroke.input}`},reportPageBanner:{justifyContent:void 0,whiteSpace:"normal",display:"block",paddingTop:"7px",paddingBottom:"7px",marginBottom:"15px"},mobileDescription:{color:p().Ay.lightTextColor,padding:"5px",fontSize:g().J.UISmall.mobile},modalTitle:{fontSize:16,marginBottom:12,fontWeight:g().Wy.medium}})),[])}function X(e){let{modalState:t}=e;const n=(0,a().DP)(),o=(0,i().v3)(),s=Z();if(!t.open)return null;const{reason:l}=t,u={menuType:S().gu.Modal,title:(0,r.jsx)(d().sA,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,r.jsx)(d().sA,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:Q};return(0,r.jsx)(I().A,{...u,children:(0,r.jsx)(_().Ay,{type:_().Oh.Vertical,initialFocus:void 0,sections:m().oE([{key:"help",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(D().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"help",render:()=>(0,r.jsx)(T().Ay,{title:(0,r.jsx)(Y,{isMobile:!0}),textWrapperStyle:s.mobileDescription,shouldWrapTitle:!0,right:(0,r.jsx)(r.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(D().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"options",render:()=>(0,r.jsx)(H,{modalState:t}),action:()=>{}},{key:"additionalInfo",render:()=>l&&!c.includes(l)&&(0,r.jsx)(C().A,{textarea:!0,style:G(o,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:x().A.formatMessage(U.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===l}),onChange:e=>{w().A.setState({...t,additionalInformation:e.target.value})}}),action:()=>{}}]},"dmca_no_action"===l?{key:"explain_dmca",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(D().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"explain_dmca",render:()=>"dmca_no_action"===l&&(0,r.jsx)(T().Ay,{title:(0,r.jsx)(q,{}),textWrapperStyle:{...s.mobileDescription,background:n.accentColors.yellow[100],color:n.accentColors.yellow[600],margin:"0px",padding:"10px 20px"},style:{display:"block"},shouldWrapTitle:!0,right:(0,r.jsx)(r.Fragment,{}),onClick:()=>{}}),action:()=>{}}]}:void 0,{key:"actions",render:e=>{let{children:t,...n}=e;return(0,r.jsx)(D().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...n}=e,o=K();return(0,r.jsx)(E().A,{...n,disabled:!o,title:(0,r.jsx)("div",{style:{color:o?p().Ay.red:p().Ay.uiGray},children:(0,r.jsx)(d().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||z})},action:()=>z(o)}]}])},"main list")})}function J(e){let{modalState:t}=e;const n=(0,a().DP)(),o=(0,i().v3)(),s=Z();if(!t.open)return null;const{reason:l}=t,u="dmca_no_action"===l;return(0,r.jsx)(j().A,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,r.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,r.jsx)("div",{style:s.modalTitle,children:(0,r.jsx)(d().sA,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,r.jsx)(k().A,{isMobile:!1,textSize:"small",styleKey:b().q.Yellow,style:u?s.reportPageBanner:{...s.reportPageExplanation,...s.reportPageBanner},children:u?(0,r.jsx)(q,{}):(0,r.jsx)(Y,{})}),(0,r.jsx)("div",{children:(0,r.jsx)(H,{modalState:t})}),l&&!c.includes(l)&&(0,r.jsx)(C().A,{textarea:!0,style:G(o,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:x().A.formatMessage(U.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===l}),onChange:e=>{w().A.setState({...t,additionalInformation:e.target.value})}}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,r.jsx)(L().A,{size:"lg",onClick:Q,style:{marginRight:12},children:(0,r.jsx)(d().sA,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,r.jsx)(L().A,{color:"uiRed",size:"lg",onClick:()=>z(o),disabled:!K(),disabledFeedback:!0,children:(0,r.jsx)(d().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function ee(){const e=(0,i().v3)(),{device:t}=e,n=(0,s().O$)(A().e),o=(0,s().O$)(w().A);return n?o.open?t.isMobile?(0,r.jsx)(X,{modalState:o}):(0,r.jsx)(J,{modalState:o}):null:(0,r.jsx)($,{})}},341974:(e,t,n)=>{n.r(t),n.d(t,{TeamJoinLeaveButton:()=>v});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(284371),l=()=>n(640653),d=()=>n(37433),c=()=>n(515512),u=()=>n(211825),p=()=>n(959013),m=()=>n(493823),g=n(474848);const f=function(e){const{teamStore:t,from:a,navigateToTeamHomeOnJoin:r,style:l,hoveredStyle:d,icon:c,isRed:u}=e,f=(0,i().v3)(),h=(0,s().O$)(n(351360).AppStoreCurrentSpaceStore),y=(0,o.useCallback)((async()=>{h&&await n(848237).e2({environment:f,teamStore:t,currentSpaceStore:h,from:a,andNavigateToTeamHome:r??!1})}),[h,f,t,a,r]);return(0,g.jsx)(m().p,{style:l,hoveredStyle:d,onClick:y,icon:c,isRed:u,children:(0,g.jsx)(p().sA,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var h=()=>n(655784);const y=function(e){const{teamStore:t,style:i,hoveredStyle:a}=e,[r,l]=(0,o.useState)(!1),d=(0,s().K8)((()=>t.getName()),[t]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(m().p,{style:i,hoveredStyle:a,onClick:()=>l(!0),children:(0,g.jsx)(p().sA,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,g.jsx)(n(149257).A,{teamStore:t,teamName:d,teamId:t.id,isModalOpen:r,onDismiss:()=>l(!1)})]})};function v(e){const{teamStore:t,style:n,hoveredStyle:o}=e,p=(0,i().v3)(),m=(0,c().Q)(),v=(0,u().G)(t),b=(0,s().K8)((()=>t.getTeamAccessLevel()),[t]),x=(0,a().IS)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:r().Wy.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...n},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...o}})),[n,o]),S=(0,s().K8)((()=>(0,d().isUnownedTeam)({membership:t.getRawMembership()})&&(0,l().s7)(p)),[p,t]),M=!v&&"open"===b||S,A=!v&&"closed"===b;return m?null:v?(0,g.jsx)(h().A,{...e,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):M?(0,g.jsx)(f,{...e,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):A?(0,g.jsx)(y,{teamStore:t,style:x.joinTeamButton,hoveredStyle:x.joinTeamButtonHoveredStyle}):null}},345578:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var o=()=>n(449552),i=()=>n(959013),s=()=>n(859428),a=()=>n(962730),r=n(474848);function l(e){let{iconStyle:t}=e;return(0,r.jsx)(s().A,{textWrap:!0,style:{width:210},placement:a().W.Bottom,renderTooltip:()=>(0,r.jsx)(i().sA,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,r.jsx)("div",{...e,children:(0,o().g)(t)})})}},347345:(e,t,n)=>{n.d(t,{A:()=>D});var o=n(296540),i=()=>n(484714),s=()=>n(852507),a=()=>n(401497),r=()=>n(847249),l=()=>n(959013),d=()=>n(542056),c=n(474848);const u=function(e){const{permissionsInviteStore:t,onInviteClick:s,inviteOrigin:a,sudoModeStore:u}=e,p=(0,i().v3)(),m=(0,l().tz)(),g=(0,n(58293).r)(),[f,h]=(0,o.useState)(!1),y=(0,r().uB)(void 0,n(159026).Ay),v=(0,r().K8)((()=>t.state.inviteTargets.length>0),[t]),b=(0,o.useCallback)((e=>{e||n(436572).D6({label:(0,c.jsx)(l().sA,{id:"SpacePermissionsInviteButton.handleOnInviteComplete.genericError",defaultMessage:"Invite failed to send"})})}),[]),x=(0,o.useCallback)((async()=>{if(g){h(!0);try{await d().kW({environment:p,store:g,sudoModeStore:u,permissionsInviteStore:t,contextualInviteStore:y,onInviteClick:s,onInviteComplete:b,inviteOrigin:a,intl:m})}catch(e){}finally{h(!1)}}}),[y,p,m,a,s,t,g,u,b]);return(0,c.jsx)(n(204063).A,{onClick:x,disabled:!v||f,children:(0,c.jsx)(l().sA,{id:"spacePermissionsInviteButton.label",defaultMessage:"Send invite"})})};var p=()=>n(554509),m=()=>n(10984);const g=function(e){const{permissionsInviteStore:t}=e,i=(0,r().K8)((()=>(0,m().dL)()),[]),s=(0,o.useCallback)((()=>{t.reset()}),[t]),d=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:8},header:{display:"flex",justifyContent:"space-between"}})),[]);return(0,c.jsxs)("div",{style:d.container,children:[(0,c.jsxs)("div",{style:d.header,children:[(0,c.jsx)(p().D,{styleName:"Heading-17px/Semibold",children:(0,c.jsx)(l().sA,{id:"spacePermissionsInviteHeader.title",defaultMessage:"Invite members"})}),(0,c.jsx)(n(398208).A,{onClose:s})]}),(0,c.jsx)(n(125565).A,{isSecondaryColor:!0,isMultiline:!0,children:i?(0,c.jsx)(l().sA,{id:"spacePermissionsInviteHeader.freeDescription",defaultMessage:"Type or paste in emails below, separated by commas"}):(0,c.jsx)(l().sA,{id:"spacePermissionsInviteHeader.billedDescription",defaultMessage:"Type or paste in emails below, separated by commas. Your workspace will be billed by members."})})]})};n(944114),n(581454);var f=()=>n(148307),h=()=>n(668725),y=()=>n(760217),v=()=>n(406699),b=()=>n(928600),x=()=>n(939740),S=()=>n(897119),M=()=>n(89924),A=()=>n(747788),w=()=>n(103448),k=()=>n(722872),j=()=>n(553965),C=()=>n(731320),I=()=>n(962730),T=()=>n(991249),_=()=>n(643908),P=()=>n(134217);function B(e){const{permissionsInviteStore:t}=e,n=(0,i().v3)(),u=(0,r().K8)((()=>{const e=(0,m().AI)();return(0,P().fk)(e)}),[]);(0,s().l)((()=>{u||t.setState({...t.state,isInviteTargetsEmpty:!0,inviteTargets:[],inviteRole:"read_and_write"})}));const g=(0,r().K8)((()=>t.state.inviteRole?t.state.inviteRole:u?"editor":"read_and_write"),[u,t]),f=(0,r().K8)((()=>{const e=["editor"];return(0,C().Qu)()&&e.push("membership_admin"),u||e.push("read_and_write"),e}),[u]),w=(0,o.useCallback)((e=>{d().lf({environment:n,newRole:e,permissionsInviteStore:t})}),[n,t]),j=(0,a().IS)((e=>({menuItem:{width:"100%",backgroundColor:e.inputBackground,borderRadius:6,boxShadow:"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px inset"},dropdownButton:{display:"flex",minHeight:34,margin:0,width:"100%"},dropdownButtonContent:{display:"flex",alignItems:"center"},selectedRole:{width:"100%",color:e.text.secondary},downIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function I(e){const t=f.map((t=>({key:t,render:e=>{const n=(0,A().R)({type:"space_permission",table:"space",role:t,isRemovable:!1,isCurrentUser:!1});return(0,c.jsx)(y().A,{title:(0,c.jsx)(l().sA,{...n.label}),caption:(0,c.jsx)(l().sA,{...n.caption}),shouldWrapCaption:!0,...e})},action:()=>{w(t),e.close()}})));return u&&t.push({key:"read_and_write",render:e=>(0,c.jsx)(R,{menuListItemProps:e}),action:()=>{e.close()}}),t}return(0,c.jsx)(v().Ay,{popupType:S().nl.Popup,sameWidthAsOrigin:!0,render:e=>(0,c.jsx)(b().A,{menuType:k().gu.Popup,children:(0,c.jsx)(x().Ay,{type:x().Oh.Vertical,initialFocus:void 0,sections:[{key:"roles",render:e=>(0,c.jsx)(M().A,{...e}),items:I(e)}]})}),renderOrigin:e=>(0,c.jsx)(y().A,{style:j.menuItem,buttonStyle:j.dropdownButton,title:(0,c.jsxs)("div",{style:j.dropdownButtonContent,children:[(0,c.jsx)("div",{style:j.selectedRole,children:(0,c.jsx)(p().D,{styleName:"UIRegular-14px/Regular",children:(0,c.jsx)(l().sA,{...(0,A().R)({type:"space_permission",table:"space",role:g,isRemovable:!1,isCurrentUser:!1}).label})})}),(0,h().b)(j.downIcon)]}),focused:!1,...e})})}function R(e){let{menuListItemProps:t}=e;const n=(0,i().v3)(),s=(0,a().IS)((()=>({titleContainer:{display:"flex",alignItems:"center"},titleLabel:{marginRight:6}})),[]),r="space_permission_settings",d="plus",u=(0,o.useCallback)((()=>{(0,T().K)(n,{from:r,upsell:{type:"product",product:d,limit:{type:"none"},trialability:"none"}})}),[n]),p=(0,c.jsx)(w().A,{imageURL:f().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,c.jsx)(l().sA,{defaultMessage:"Members cannot change workspace settings or invite new members.",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.caption"}),title:(0,c.jsx)(l().sA,{defaultMessage:"Upgrade to add non-admin members",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.title"})});return(0,c.jsx)(_().A,{requireUpgradeToTier:d,renderUpgradeTooltip:()=>p,analyticsName:r,tooltipPlacement:I().W.Left,render:(e,n)=>{const{focused:o,...i}=(0,j().A)(t,e),a=(0,A().R)({type:"space_permission",table:"space",role:"read_and_write",isRemovable:!1,isCurrentUser:!1});return(0,c.jsx)(y().A,{...i,title:(0,c.jsxs)("div",{style:s.titleContainer,children:[(0,c.jsx)("div",{style:s.titleLabel,children:(0,c.jsx)(l().sA,{...a.label})}),n]}),caption:(0,c.jsx)(l().sA,{...a.caption}),shouldWrapCaption:!0,focused:o})},onClick:u})}const L=function(e){const t=(0,a().IS)((e=>({container:{display:"flex",flexDirection:"column",width:"100%",gap:8},roleText:{color:e.text.secondary}})),[]);return(0,c.jsxs)("div",{style:t.container,children:[(0,c.jsx)(p().D,{styleName:"UISmall-12px/Medium",customStyles:t.roleText,children:(0,c.jsx)(l().sA,{id:"spacePermissionsInviteRoleSection.label",defaultMessage:"Role"})}),(0,c.jsx)(B,{...e})]})};const D=function(e){const{inviteOrigin:t,onInviteClick:r,permissionsInviteStore:l}=e,d=(0,i().v3)();(0,s().l)((async()=>{await n(224701).Ow(d)}));const p=(0,o.useCallback)((()=>{l.setState({...l.state,inputFocus:"none"})}),[l]),m=(0,a().IS)((()=>({container:{maxWidth:460},body:{display:"flex",flexDirection:"column",gap:20,width:"100%"},footer:{display:"flex",justifyContent:"end"}})),[]);return(0,c.jsx)("div",{style:m.container,onClick:p,className:n(38337).bFE,children:(0,c.jsx)(n(7674).tf,{header:(0,c.jsx)(g,{permissionsInviteStore:l}),footer:(0,c.jsx)("div",{style:m.footer,children:(0,c.jsx)(u,{inviteOrigin:t,onInviteClick:r,permissionsInviteStore:l})}),children:(0,c.jsxs)("div",{style:m.body,children:[(0,c.jsx)(n(334013).A,{permissionsInviteStore:l}),(0,c.jsx)(L,{permissionsInviteStore:l})]})})})}},347930:(e,t,n)=>{n.d(t,{H:()=>s});var o=()=>n(645873);const i=new(o().O2)("permissionsInviteWithModal",(async()=>await Promise.all([n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(3965),n.e(84341),n.e(80533),n.e(45620),n.e(58221),n.e(44763),n.e(8081),n.e(67183),n.e(64598),n.e(82720),n.e(4253),n.e(86787),n.e(77465),n.e(24593),n.e(80896),n.e(1440),n.e(67378),n.e(58504),n.e(97308),n.e(63996),n.e(20636),n.e(66268),n.e(55717),n.e(7005),n.e(40186),n.e(22585),n.e(73206),n.e(11037),n.e(33235),n.e(91957),n.e(84176),n.e(16357),n.e(75681)]).then(n.bind(n,895469)))),s=(0,o()._h)(i,(e=>e.PermissionsInviteWithModal))},350648:(e,t,n)=>{n.d(t,{D2:()=>M,Ip:()=>b,Jk:()=>x,YT:()=>S,e2:()=>y,g:()=>v});n(898992),n(354520);var o=()=>n(584262),i=()=>n(798880),s=()=>n(946141),a=()=>n(449506),r=()=>n(246826),l=()=>n(436572),d=()=>n(426116),c=()=>n(751156),u=()=>n(972435),p=()=>n(640653),m=()=>n(351360),g=()=>n(848237),f=()=>n(263928);const h=(0,n(959013).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function y(e){let{environment:t,userId:n,teamStore:o,user:i}=e;const a=o.getSpaceId();if(!a)return;await g().rU({environment:t,teamId:o.id,spaceId:a,teamUserInfo:i,isSettingDefaultTeam:!1,inviterId:n})&&(s().vo(t,{store:o,joined_role:"member",from:"team_invite_link"}),await v({environment:t,userId:n,teamStore:o}),l().D6({label:u().A.formatMessage(h.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function v(e){let{environment:t,userId:n,teamStore:i}=e;const s=m().default.state.currentUserRootStore,a=i.getSpaceId();if(!a||!s)return;const r=s.getSpaceViewStores().filter((e=>e.getSpaceId()===a))[0];await d().tR({environment:t,spaceViewStore:r,userSettingsStore:void 0,userRootStore:s,pageVisitSource:o().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),await f().J({environment:t,spaceId:a,userId:n}),g().L0({environment:t,teamStore:i,shouldScroll:!0})}async function b(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await a().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:o}})).type?(s().XQ(t,{teamId:n}),await S({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{l().D6({label:u().A.formatMessage(h.requestTeamSuccessMessage)})}))):l().D6({label:u().A.formatMessage(h.requestTeamFailureMessage)})}async function x(e){let{environment:t,teamStore:n,accessRequestStore:o,status:a}=e;const l=o.getForActorId();if(!l)return;const d=o.getRecordModel({table:i().oo,id:l});if(d){if("approved"===a){const e=[{type:"member",entity_type:"user",user_id:d.id}];if(!(await g().Zd({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}c().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{r().zv({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:i().oo,resolved_by_id:t.currentUser.id,status:a}})}}),s().GW(t,{store:n,resolution:a})}}async function S(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:i,userSettingsStore:s}=await(0,p().ex)({environment:t,disableRedirectUrl:!1});n?await d().tR({environment:t,spaceViewStore:n,userRootStore:i,userSettingsStore:s,pageVisitSource:o().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await d().t9({environment:t,userRootStore:i,userSettingsStore:s,pageVisitSource:o().y8.BackForward})}async function M(e){let{environment:t,teamId:n}=e;const o=await a().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===o.type)return o.data}},358359:(e,t,n)=>{n.d(t,{L:()=>s});n(296540);var o=n(474848);const i={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("g",{clipPath:"url(#clip0_9208_17166)",children:(0,o.jsx)("path",{d:"M8.125 14.75c0-.345.28-.625.625-.625h10.1a.625.625 0 0 1 0 1.25H8.75a.625.625 0 0 1-.625-.625M7 9.375a.625.625 0 1 0 0 1.25h10.1a.625.625 0 1 0 0-1.25zm-1.75-4.75a.625.625 0 0 0 0 1.25h10.1a.625.625 0 1 0 0-1.25zM2.9 9.375a.625.625 0 1 0 0 1.25h1.5a.625.625 0 1 0 0-1.25zM.525 5.25c0-.345.28-.625.625-.625h1.5a.625.625 0 0 1 0 1.25h-1.5a.625.625 0 0 1-.625-.625m4.125 8.875a.625.625 0 0 0 0 1.25h1.5a.625.625 0 1 0 0-1.25z"})}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_9208_17166",children:(0,o.jsx)("path",{d:"M0 0h20v20H0z"})})})]})},s=(0,n(340498).wt)("tableOfContents",i)},364811:(e,t,n)=>{n.d(t,{dl:()=>S,LV:()=>w});n(18107),n(944114),n(967357),n(296540);var o=n(474848);const i=(0,n(340498).wt)("pinStrikethrough",{viewBox:"0 0 15 19",svg:(0,o.jsx)("path",{d:"M3.094 1.328c0 .227.094.492.297.758.398.531 1.343 1.266 2.328 1.914l-.055.86 1.149 1.156.156-2.594c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102.007-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.961.867-2.14 1.468-.071.04-.087.079-.079.188l.234 3.875a7.12 7.12 0 00-1.437-.14h-.203l1.203 1.226c2.164.219 3.758 1.984 3.758 3.234 0 .04-.008.078-.008.117l.844.97c.257-.157.468-.477.468-.93 0-1.649-1.32-3.313-3.359-4.11L10.617 4c.992-.648 1.93-1.383 2.336-1.914.203-.266.297-.531.297-.758 0-.476-.367-.828-.914-.828H4.008c-.555 0-.914.352-.914.828zM.367 2.656l14.125 14.11a.603.603 0 00.852 0 .597.597 0 000-.852L1.227 1.804a.606.606 0 00-.86 0 .618.618 0 000 .852zm1.735 9.117c0 .665.445 1.102 1.148 1.102h4.234v3.648c0 1.196.493 2.188.688 2.188.195 0 .687-.992.687-2.188V12.97h.446L8.03 11.695H3.562c-.171 0-.257-.101-.226-.312.094-.875.828-1.805 1.984-2.399l-.82-.82c-1.477.867-2.398 2.234-2.398 3.61z"})});var s=()=>n(236262),a=()=>n(959013),r=()=>n(751156),l=()=>n(89924),d=()=>n(878377),c=()=>n(640653),u=()=>n(869562),p=()=>n(351360),m=()=>n(290625),g=()=>n(599364),f=()=>n(654056),h=()=>n(416726),y=()=>n(910702);const v=(0,a().YK)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"},editFormName:{id:"action.editForm.name",defaultMessage:"Edit form"}}),b=(0,h().Ls)({key:"remove pinned shared page",displayName:v.unpinName,analyticsName:v.unpinName.defaultMessage,svg:i,validators:[d().p9k,d().qKm,d().AU6(d().nGR)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;const{currentSpaceViewStore:i,currentUserSettingsStore:s}=p().default.state;i&&s&&(r().createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:o,canUndo:!0,perform:e=>{for(const n of t)u().unpinSharedPage({environment:o,transaction:e,spaceViewStore:i,userSettingsStore:s,store:n})}}),n(899963).Nj(o,{type:"shared",from:"sidebar_dropdown_menu"}))}}),x=(0,h().Ls)({key:"edit form",displayName:v.editFormName,analyticsName:v.editFormName.defaultMessage,svg:n(173019).r,validators:[d().kD4,d().$68],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;const i=t[0],s=i.getFormBlockParentBlockStore();var a;s&&n(857783).uK({environment:o,store:s,collectionViewId:null===(a=i.getParentStore())||void 0===a?void 0:a.id,pageVisitSource:n(584262).y8.FormInternalPage})}}),S=(0,h().Ls)({key:"delete block without shortcuts",displayName:h().AY.moveToTrashName,analyticsName:h().AY.moveToTrashName.defaultMessage,svg:s().trashIcon,isRed:!0,validators:[d().or([d()._fc,d().t7S,d().IuJ]),d().SvZ,d().AU6(d().xqI),d().AU6(d().Xjv(n(700500).xd.externalObjectInstancePage)),d().AU6(d().PfK),d().zrb,d().AU6(d().oy3),d().AU6(d().Po5)],closeParentMenu:!0,track:{actionName:"move_to_trash"},render:(e,t,i)=>{const r=d().dj5(t.blocks.at(0));return(0,o.jsx)(n(859428).A,{renderTooltip:()=>(0,o.jsx)("div",{style:{maxWidth:400,whiteSpace:"pre-wrap"},children:(0,o.jsx)(a().sA,{...h().AY.cannotDeleteBlockTooltip})}),render:()=>(0,o.jsx)(n(575143).A,{...e,title:(0,o.jsx)(a().sA,{...h().AY.moveToTrashName}),svg:s().trashIcon,isRed:!0,disabled:r,disabledFeedback:r,tooltipText:r?(0,o.jsx)(a().sA,{...h().AY.cannotDeleteBlockTooltip}):void 0})})},action:async(e,t,o)=>{let{blocks:i,environment:s}=t;await n(797265).Af({environment:s,blocks:i,shouldCheckSuggestEdit:!1,callback:e})}}),M=(0,h().Ls)({key:"leave shared page",displayName:v.leaveName,analyticsName:v.leaveName.defaultMessage,svg:n(818044).k,validators:[d().p9k,d().zq3],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;r().createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:n,canUndo:!0,perform:e=>{u().leaveBlocks({environment:n,blocks:t,transaction:e})}})}}),A=(0,h().uk)({key:"duplicate to workspace",displayName:v.duplicateToName,analyticsName:v.duplicateToName.defaultMessage,svg:n(212439).V,validators:[d()._fc,d().PaP,d().Km9,d().AU6(d().MIU),d().aAU],subActions:e=>{let{blocks:t,environment:i}=e;const{currentUserRootStore:s}=p().default.state;if(!s)return[];const a=t[0],r=n(186445).jU(s),d=[];for(const l of r){const e=l.getSpaceStore();if(e){const t=(0,c().GK)(i,e),s=(0,c().c2)(i,e);d.push({key:l.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await n(394893).w7({environment:i,store:a,spaceStore:e,spaceViewStore:l,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,i)=>{let{environment:a}=i;return(0,o.jsx)(n(760217).A,{title:t,icon:(0,o.jsx)(n(614505).B,{icon:s,isEmptyPage:!1,title:t,size:a.device.isMobile?24:20,disabled:!0}),...e})}})}}return[(0,h().gy)({key:"duplicate-to",render:e=>(0,o.jsx)(l().A,{...e}),actions:d})]}}),w=[n(354406).LQ,{key:"outliner organization actions",render:e=>(0,o.jsx)(l().A,{...e}),actions:[m()._J,m().wy,b,M]},{key:"outliner available offline action",render:e=>(0,o.jsx)(l().A,{...e}),actions:[n(178998).Z]},{key:"outliner primary actions",render:e=>(0,o.jsx)(l().A,{...e}),actions:[g().ko,g().oc,m().O5,m().tA,f().As,f().nK,f().J8,f().lb,A,x,n(22913).U,n(137743).t,S]},{key:"turn page into",render:e=>(0,o.jsx)(l().A,{...e}),actions:[y().zk,y().wm,y().Js]},{key:"outliner navigation",render:e=>(0,o.jsx)(l().A,{...e}),actions:n(668491).YO}]},381495:(e,t,n)=>{n.r(t),n.d(t,{CloseTemplatesPopupComponent:()=>be,default:()=>de});var o=()=>n(624119),i=n(296540),s=()=>n(484714),a=()=>n(847249),r=()=>n(401497),l=()=>n(292119),d=()=>n(380048),c=()=>n(212050),u=()=>n(959013),p=()=>n(209199),m=()=>n(284371),g=()=>n(112873),f=()=>n(901389),h=()=>n(413677),y=()=>n(436572),v=()=>n(824622),b=()=>n(37546),x=()=>n(202106);function S(){return"web-mobile"===(0,s().Y0)().deviceType}var M=()=>n(345737),A=()=>n(78219),w=()=>n(396990),k=()=>n(351360),j=()=>n(714818),C=()=>n(712505),I=()=>n(757695);class T extends I().default{getInitialState(){return{inMemoryRecordCache:new(n(221844).A)({name:"TemplateRecordCacheStore"})}}}var _=()=>n(112527),P=()=>n(704152),B=()=>n(285790),R=()=>n(331542),L=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(581454),()=>n(386164)),D=()=>n(388821),O=()=>n(861017),N=()=>n(179034),E=()=>n(824862),U=()=>n(798880),F=()=>n(919709),V=()=>n(449506),K=()=>n(276470),H=()=>n(620689),z=()=>n(437768),W=()=>n(780054),G=()=>n(484792),Y=()=>n(186445),q=()=>n(396831);class $ extends I().default{getInitialState(){return{}}}const Q=$;var Z=()=>n(548821),X=()=>n(630116),J=()=>n(134217),ee=()=>n(749240),te=()=>n(2143),ne=()=>n(299772),oe=()=>n(13679),ie=n(474848);const se=function(e){let{style:t,disabled:o,disablePointerEvents:r,previewRootId:l,previewSpaceId:d,isPaidTemplate:c,userHasAcquiredTemplate:p,templateRecordCacheStore:m}=e;const g=(0,s().v3)(),f=(0,a().uB)(m,T),h=(0,a().uB)(void 0,Q),y=(0,a().O$)(n(227440).A),v=(0,i.useCallback)(((e,n)=>(0,ie.jsx)(re,{err:e,store:n,style:t,disabled:o,disablePointerEvents:r,isPaidTemplate:c,userHasAcquiredTemplate:p,pageTemplatePreviewStore:h})),[t,o,r,h,c,p]),b=(0,i.useCallback)((e=>{const{rootId:t,spaceId:n}=e;return async function(e,t,n,o,i){if(i){return new(X().Bv)(n,{table:N().ev,id:e})}const s=await V().callApi({eventName:"loadBlockSubtree",environment:n,data:{block:{id:e,spaceId:t},shallow:!1},headers:(0,L().WS)({spaceId:t})});if("failed"===s.type)throw s.error;const{currentSpaceStore:a}=k().default.state,r=ee().subscriptionDataStoreInstance.state,{inMemoryRecordCache:l}=o.state;l.clearCache(),l.isTemplatePreview=!0;const d=new Set,c=new Set,u=D().RecordMapWithRole.create(s.data.subtreeRecordMap);for(const h of u){const{pointer:e,model:t,role:o}=h;if(!o)return;if(l.setModelAndRole({pointer:e,userId:n.currentUser.id},t,"editor"),(null==t?void 0:t.table)===N().ev){const e=t.getProperties();for(const t of Object.keys(e)){const n=(0,F().Fbh)(e[t]);for(const e of n)d.add(e);const o=(0,F().jgW)(e[t]);for(const e of o)c.add(e)}t.created_by_table&&t.created_by_id&&(t.created_by_table===U().oo?d.add(t.created_by_id):c.add(t.created_by_id)),t.last_edited_by_table&&t.last_edited_by_id&&(t.last_edited_by_table===U().oo?d.add(t.last_edited_by_id):c.add(t.last_edited_by_id))}}if(r)for(const h of(0,J().Be)(r))d.add(h.userId);const p=await Promise.all(Array.from(d).map((async e=>{if(a){const t=X().LU.createChildStore(a,{table:U().oo,id:e});await t.load();return t.getValue()}{const t=await(0,K().e)(n,{pointer:{table:U().oo,id:e},userId:n.currentUser.id,version:-1});return t&&t.value}})));for(const h of p)h&&l.setRecord({pointer:{table:U().oo,id:h.id},userId:n.currentUser.id},{role:"reader",value:h});const m=await Promise.all(Array.from(c).map((async e=>{if(a){const t=(0,X().Oo)(a,{table:E().GP,id:e,spaceId:a.id});await t.load();return t.getValue()}{const t=await(0,K().e)(n,{pointer:{table:E().GP,id:e},userId:n.currentUser.id,version:-1});return t&&t.value}})));for(const h of m)h&&l.setRecord({pointer:{table:E().GP,id:h.id,spaceId:h.space_id},userId:n.currentUser.id},{role:"reader",value:h});const{currentUserStore:g}=k().default.state;g&&(await g.load(),l.setRecord({pointer:g.pointer,userId:n.currentUser.id},{role:"editor",value:g.getValue()}));const f=new(X().Bv)(n,{table:N().ev,id:e},{inMemoryRecordCache:l});return f}(t,n,g,f,o)}),[g,f,o]),x=(0,i.useCallback)((e=>function(e,t,n){const{device:o}=t,i=(0,O().parseRoute)({url:e,isMobile:o.isMobile,baseUrl:W().A.domainBaseUrl,publicDomainName:W().A.publicDomainName,protocol:W().A.protocol,currentUrl:window.location.href});"page"===i.name&&(i.peekViewBlockId?n.setState({...n.state,navigatedRootId:i.peekViewBlockId}):n.setState({...n.state,navigatedRootId:i.blockId}))}(e,g,h)),[g,h]);return y.online?(0,ie.jsx)(G().B,{value:x,children:(0,ie.jsx)(n(251126).A,{request:{rootId:l,spaceId:d},performRequest:b,render:v})}):(0,ie.jsx)(G().B,{value:x,children:(0,ie.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...t},children:(0,ie.jsx)(n(125565).A,{isSmall:!0,children:(0,ie.jsx)(u().sA,{defaultMessage:"Please go online to view this template.",id:"pageTemplatePreview.offline.message"})})})})};function ae(e){const{device:t}=e;return{flex:1,...t.isSafari&&{zIndex:1}}}function re(e){let{store:t,style:n,disabled:o,disablePointerEvents:r,isPaidTemplate:l,userHasAcquiredTemplate:d,pageTemplatePreviewStore:c}=e;const p=(0,s().v3)(),m=(0,a().uB)(c,Q),g=(0,a().K8)((()=>m.state.navigatedRootId),[m]),f=S(),h=(0,a().K8)((()=>t&&(0,Y().fl)({environment:p,store:t})),[p,t]);if((0,i.useEffect)((()=>{l&&!f&&y().D6({label:(0,ie.jsx)(u().sA,{defaultMessage:"Purchase is unavailable on this platform",id:"pageTemplatePreview.paidTemplate.message"}),durationMs:"keep"})}),[p,l,f,d]),t&&h){let e;return e=g?X().Bv.createChildStore(t,{table:N().ev,id:g}):t,(0,ie.jsx)("div",{style:n,children:(0,ie.jsx)(oe().A,{store:e,isDefaultContainer:!0,droppable:!0,render:t=>{let{selectableEvents:n,selectableHoverMenuOverlay:i}=t;return(0,ie.jsx)(te().H,{style:ae(p),type:h,store:q().A,preventType:H().u5(p),...n,children:r?(0,ie.jsxs)("section",{inert:"",children:[i,(0,ie.jsx)(ne().Ay,{store:e,context:Z().Rr.InAppTemplatePreview,paddingBottom:(0,ne().Wj)(p),disabled:o})]}):(0,ie.jsxs)(ie.Fragment,{children:[i,(0,ie.jsx)(ne().Ay,{store:e,context:Z().Rr.InAppTemplatePreview,paddingBottom:(0,ne().Wj)(p),disabled:o})]})},e.id)}},e.id)})}return(0,ie.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...n},children:(0,ie.jsx)(R().A,{legacySize:z().Kh})})}const le={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"};const de=function(){const e=(0,s().v3)(),t=(0,a().uB)(void 0,T),o=(0,i.useCallback)((()=>ge(e,t)),[e,t]),r=(0,i.useCallback)((()=>(0,ie.jsx)(he,{templateRecordCacheStore:t})),[t]),{device:l}=e,d=(0,a().O$)(j().A),c=(0,a().O$)(k().AppStoreCurrentSpaceViewStore);return(0,i.useEffect)((()=>{d.open&&c&&n(751156).createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:e,canUndo:!0,perform:e=>{h().setTemplateVisited({item:d.item,spaceViewStore:c,transaction:e})}})}),[c,e,d.item,d.open]),l.isMobile?(0,ie.jsx)(n(897119).Ay,{open:d.open,render:r,forceFullScreenSlideUp:!0,onDismiss:o,popupType:n(377586).n.SlideUp}):null};function ce(){return new Promise(((e,t)=>{f().ui({message:(0,ie.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:(0,ie.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:(0,ie.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}function ue(e){h().close(e),g().xl()}function pe(e){var t,n;let{modalState:o,templateRecordCacheStore:i}=e;const s=(0,a().uB)(i,T);return(0,ie.jsx)(se,{disablePointerEvents:o.disablePointerEvents,previewRootId:o.item.previewRootId,previewSpaceId:o.item.spaceId,isPaidTemplate:Boolean(null===(t=o.item.marketplaceTemplateMetadata)||void 0===t?void 0:t.isPaidTemplate),userHasAcquiredTemplate:Boolean(null===(n=o.item.marketplaceTemplateMetadata)||void 0===n?void 0:n.userHasAcquiredTemplate),style:le,templateRecordCacheStore:s,disabled:!0},o.item.previewRootId)}function me(e,t,n,o){const{inMemoryRecordCache:i}=n.state,s=j().A.state,{currentSpaceViewStore:a,currentSpaceStore:r,mainEditorCurrentBlockStore:l}=k().default.state;if(s.open&&a&&r){const n=l&&l.isEmptyPage()?l:void 0,d=C().default.state.open&&C().default.state.targetStore&&C().default.state.targetStore.isEmptyPage()?C().default.state.targetStore:void 0;h().accept({environment:t,item:s.item,spaceStore:r,spaceViewStore:a,useRecordCache:e?i:void 0,initializeStore:s.createNewPage?void 0:n||d,isPrivate:s.isPrivate,acceptFrom:s.createNewPage?"sidebar":"newPage",isEmailShared:o})}}async function ge(e,t){const{inMemoryRecordCache:n}=t.state;if(y().N2(),n.appliedTransaction){await ce()?me(!0,e,t):ue(e)}else ue(e)}async function fe(e,t,n){var o,i,s,a;const{inMemoryRecordCache:r}=t.state;if(r.appliedTransaction){return void me(!!(await ce()),e,t)}const l=null===(o=j().A.state.item)||void 0===o||null===(o=o.marketplaceTemplateMetadata)||void 0===o?void 0:o.isPaidTemplate,d=null===(i=j().A.state.item)||void 0===i||null===(i=i.marketplaceTemplateMetadata)||void 0===i?void 0:i.marketplaceListingId,c=null===(s=j().A.state.item)||void 0===s||null===(s=s.marketplaceTemplateMetadata)||void 0===s?void 0:s.userHasAcquiredTemplate,u=null===(a=j().A.state.item)||void 0===a?void 0:a.id;if(j().A.state.open&&l&&d&&u&&!c)return M().A.setState({...M().A.state,from:"mobileApp",marketplaceListingId:d,templateId:u}),void j().A.setState({...j().A.state,isCheckout:!0});!c&&l||me(!1,e,t,n)}function he(e){var t,n,d,c,m;let{templateRecordCacheStore:g}=e;const f=(0,s().v3)(),h=(0,u().tz)(),C=(0,r().DP)(),I=S(),T=(0,a().K8)((()=>{var e;return(null===(e=k().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||p().q}),[]),P=(0,a().K8)((()=>A().A.state.duplicationStatus),[]),B=(0,a().O$)(j().A),L=null===(t=B.item)||void 0===t||null===(t=t.marketplaceTemplateMetadata)||void 0===t?void 0:t.creator,D=null===(n=B.item)||void 0===n||null===(n=n.marketplaceTemplateMetadata)||void 0===n?void 0:n.emailCaptureType,O="duplicating"===P,N=Boolean(null===(d=B.item)||void 0===d||null===(d=d.marketplaceTemplateMetadata)||void 0===d?void 0:d.isPaidTemplate),E=null===(c=B.item)||void 0===c||null===(c=c.marketplaceTemplateMetadata)||void 0===c?void 0:c.paidTemplatePrice,U=Boolean(null===(m=B.item)||void 0===m||null===(m=m.marketplaceTemplateMetadata)||void 0===m?void 0:m.userHasAcquiredTemplate),F=(0,i.useCallback)((()=>{if("required"!==D&&"optional"!==D)return fe(f,g);w().A.open({creator:L,emailRequirement:D,onSubmit:async e=>{await fe(f,g,e)}})}),[f,D,L,g]),V=(0,i.useCallback)((()=>ge(f,g)),[f,g]),K=(0,i.useCallback)((()=>{y().N2(),j().A.state.open&&j().A.setState({...j().A.state,isCheckout:!1}),M().A.setState({...M().A.state,isModalOpen:!1,from:void 0,marketplaceListingId:void 0,templateId:void 0,creatorId:void 0,customerId:void 0})}),[]),H=(0,x().IT)(C,T);return B.open?(0,ie.jsx)(v().QA,{title:B.isCheckout?(0,ie.jsx)(u().sA,{defaultMessage:"Complete checkout",id:"pageTemplateModal.mobileModal.checkoutTitle"}):void 0,left:B.isCheckout?(0,ie.jsx)(ve,{handleClick:K}):(0,ie.jsx)(be,{handleClick:V,style:{marginLeft:20}}),right:B.isLoading?(0,ie.jsx)(R().A,{style:{marginRight:40}}):B.isCheckout?null:(0,ie.jsx)(ye,{handleClick:F,isDisabled:O||N&&!I,label:U?(0,ie.jsx)(u().sA,{id:"inApp.marketplace.template.addAgain",defaultMessage:"Add again"}):N&&E?(0,ie.jsx)(u().sA,{id:"inApp.marketplace.template.buyTemplate",defaultMessage:"Buy for <money></money>",values:{money:()=>(0,ie.jsx)(l().v,{cost:{amount:100*E,currencyCode:"USD"},intl:h,trailingZeroDisplay:"auto"})}}):void 0}),shouldRenderLeftDirectly:!0,shouldRenderRightDirectly:!0,onCancel:V,disableHeaderShadow:!0,forceFullScreenSlideUp:!0,children:B.isCheckout?(0,ie.jsx)(o().Elements,{stripe:(0,_().getStripe)(),options:H,children:(0,ie.jsx)(b().l,{})}):(0,ie.jsx)(pe,{templateRecordCacheStore:g,modalState:B})}):null}function ye(e){let{handleClick:t,isDisabled:n,label:o}=e;const i=(0,r().IS)((e=>({doneButton:{display:"flex",alignItems:"center",height:34,paddingLeft:14,paddingRight:14,marginRight:20,fontWeight:m().Wy.medium,color:n?e.text.secondary:e.text.primary,background:e.tint.regular,borderRadius:17}})),[n]);return(0,ie.jsx)(P().A,{mobileFeedback:!0,style:i.doneButton,onClick:t,disabled:n,children:o||(0,ie.jsx)(u().sA,{defaultMessage:"Use template",id:"pageTemplateModal.mobileModal.useTemplateButton.label"})})}function ve(e){let{handleClick:t}=e;const n=(0,u().tz)(),o=(0,r().IS)((e=>({iconButton:{borderRadius:17,width:34,height:34,marginLeft:20},icon:{width:20,height:20}})),[]);return(0,ie.jsx)(B().A,{icon:e=>(0,d().I)(o.icon),style:o.iconButton,isDarkIconColor:!0,onClick:t,ariaLabel:n.formatMessage({defaultMessage:"Back",id:"pageTemplateModal.mobileModal.checkout.backButton.label"})})}function be(e){let{handleClick:t,style:n,disabled:o}=e;const i=(0,r().DP)(),s=(0,u().tz)(),a={background:i.tint.regular,borderRadius:17,width:34,height:34,...n};return(0,ie.jsx)(B().A,{disabled:o,icon:e=>(0,c().u)({width:20,height:20}),style:a,isDarkIconColor:!0,onClick:t,ariaLabel:s.formatMessage({defaultMessage:"Close",id:"pageTemplateModal.mobileModal.closeButton.label"})})}},383286:(e,t,n)=>{n.d(t,{E:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("microphone",{viewBox:"0 0 17 25",svg:(0,o.jsx)("path",{d:"M0.20752 12.0743C0.20752 13.5496 0.511882 14.853 1.12061 15.9845C1.72933 17.116 2.57438 18.0219 3.65576 18.7023C4.73714 19.3826 5.98324 19.7908 7.39404 19.9269V22.129H3.45166C3.17236 22.129 2.93245 22.2257 2.73193 22.4191C2.53141 22.6196 2.43115 22.8595 2.43115 23.1388C2.43115 23.4109 2.53141 23.6437 2.73193 23.837C2.93245 24.0376 3.17236 24.1378 3.45166 24.1378H13.313C13.5923 24.1378 13.8322 24.0376 14.0327 23.837C14.2332 23.6437 14.3335 23.4109 14.3335 23.1388C14.3335 22.8595 14.2332 22.6196 14.0327 22.4191C13.8322 22.2257 13.5923 22.129 13.313 22.129H9.37061V19.9269C10.7814 19.7908 12.0239 19.3826 13.0981 18.7023C14.1795 18.0219 15.0246 17.116 15.6333 15.9845C16.242 14.853 16.5464 13.5496 16.5464 12.0743V9.94739C16.5464 9.66809 16.4461 9.43176 16.2456 9.2384C16.0522 9.04504 15.8159 8.94836 15.5366 8.94836C15.2573 8.94836 15.0174 9.04504 14.8169 9.2384C14.6164 9.43176 14.5161 9.66809 14.5161 9.94739V11.9991C14.5161 13.2166 14.2583 14.2837 13.7427 15.2003C13.2271 16.1098 12.5109 16.8152 11.5942 17.3165C10.6776 17.8178 9.60693 18.0685 8.38232 18.0685C7.16488 18.0685 6.09424 17.8178 5.17041 17.3165C4.24658 16.8152 3.52686 16.1098 3.01123 15.2003C2.50277 14.2837 2.24854 13.2166 2.24854 11.9991V9.94739C2.24854 9.66809 2.14827 9.43176 1.94775 9.2384C1.74723 9.04504 1.50374 8.94836 1.21729 8.94836C0.94515 8.94836 0.708822 9.04504 0.508301 9.2384C0.30778 9.43176 0.20752 9.66809 0.20752 9.94739V12.0743ZM8.38232 15.8448C9.10563 15.8448 9.75016 15.6766 10.3159 15.34C10.8888 14.9962 11.3364 14.5236 11.6587 13.922C11.9881 13.3204 12.1528 12.6222 12.1528 11.8273V4.59778C12.1528 3.80286 11.9881 3.10461 11.6587 2.50305C11.3364 1.90149 10.8888 1.43241 10.3159 1.09583C9.75016 0.752075 9.10563 0.5802 8.38232 0.5802C7.65902 0.5802 7.0109 0.752075 6.43799 1.09583C5.87223 1.43241 5.42464 1.90149 5.09521 2.50305C4.76579 3.10461 4.60107 3.80286 4.60107 4.59778V11.8273C4.60107 12.6222 4.76579 13.3204 5.09521 13.922C5.42464 14.5236 5.87223 14.9962 6.43799 15.34C7.0109 15.6766 7.65902 15.8448 8.38232 15.8448Z"})})},391435:(e,t,n)=>{n.d(t,{Z:()=>w});n(944114),n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(484714),s=()=>n(401497),a=()=>n(529324),r=()=>n(644161),l=()=>n(185078),d=()=>n(959013),c=()=>n(778078),u=()=>n(989423),p=()=>n(722872),m=()=>n(760217),g=()=>n(419357),f=()=>n(928600),h=()=>n(939740),y=()=>n(64e3),v=()=>n(460292),b=()=>n(89924),x=()=>n(662971),S=n(474848);const M=1,A=(0,d().YK)({sourceLanguage:{id:"translation.languageMenuList.sourceLanguage",defaultMessage:"From"},selectLanguage:{id:"translation.languageMenuList.selectLanguage",defaultMessage:"To"},detectedLanguage:{id:"translation.languageMenuList.detectedLanguage",defaultMessage:"Detected language"},preferredLanguage:{id:"translation.languageMenuList.preferredLanguage",defaultMessage:"Preferred language"},languageSearchPlaceholder:{id:"translation.languageMenuList.languageSearchPlaceholder",defaultMessage:"Search languages…"}});function w(e){const{onSelectTargetLanguage:t,onSelectSourceLanguage:n,editorModeConfigTranslateState:a,sourceLanguage:l,detectedPageLanguage:c,preferredLanguage:p,subMenuPlacement:g,subMenuAlignment:f,pageId:y}=e,v=(0,i().v3)(),w=(0,d().tz)(),I="loading"===a.status,T=k(I),_=(0,s().IS)((e=>({menuItemSectionBottomBorder:{boxShadow:`${e.regularDividerColor} 0px 1px 0px`},...T})),[T]);(0,o.useEffect)((()=>{if("pre_activation"===a.status){const e=setTimeout((()=>{(0,u().u4)({environment:v,event:{eventName:"translate_page_interaction",eventProperties:{type:"action_menu_rendered",page_id:y}}})}),750);return()=>clearTimeout(e)}}),[a.status,y,v]);const P=a.targetLanguage,B=C({disabled:I,filter:e=>l!==e,currentSelectedLanguage:a.targetLanguage,onSelectLanguage:e=>{t({targetLanguage:e})}});return(0,S.jsx)(h().Ay,{initialFocus:M,type:h().Oh.Vertical,sections:[{key:"sourceLanguage",render:e=>(0,S.jsx)(b().A,{...e,title:w.formatMessage(A.sourceLanguage),desktopTitleStyle:{marginLeft:2,marginRight:2},style:_.menuItemSectionBottomBorder}),items:[{key:l,render:(e,t)=>{let{onFocus:o}=t;return(0,S.jsx)(x().A,{...e,onFocus:o,disableDefaultClick:!0,placementToOrigin:g,alignmentToOrigin:f,renderOrigin:(e,t)=>(0,S.jsx)(m().A,{...e,disabled:I,buttonStyle:_.button,ref:t,title:w.formatMessage((0,r().Bj)(l)),caption:l===c?w.formatMessage(A.detectedLanguage):l===p?w.formatMessage(A.preferredLanguage):void 0}),renderExtension:e=>(0,S.jsx)(j,{disabled:I,extensionPopupButtonEvents:e,currentTargetLanguage:P,sourceLanguage:l,onSelectSourceLanguage:n})})},action:()=>{}}]},{key:"selectLanguage",render:e=>(0,S.jsx)(b().A,{...e,title:w.formatMessage(A.selectLanguage),desktopTitleStyle:{marginLeft:2,marginRight:2}}),items:B}]})}function k(e){return(0,s().IS)((t=>({button:{color:e?t.text.tertiary:t.text.primary}})),[e])}function j(e){const{extensionPopupButtonEvents:t,currentTargetLanguage:n,disabled:o,sourceLanguage:s,onSelectSourceLanguage:a}=e,{isMobile:r}=(0,i().Y0)(),l=C({disabled:o,filter:e=>e!==n,currentSelectedLanguage:s,onSelectLanguage:e=>{a({sourceLanguage:e})}}),d=r?{menuType:p().gu.ActionSheet,...t}:{menuType:p().gu.Popup,width:200,height:380,...t};return(0,S.jsx)(f().A,{...d,onClick:e=>{e.preventDefault()},children:(0,S.jsx)(h().Ay,{initialFocus:void 0,type:h().Oh.Vertical,sections:[{key:"originalLanguage",render:e=>(0,S.jsx)(b().A,{...e}),items:l}]})})}function C(e){const{disabled:t,filter:n,currentSelectedLanguage:s,onSelectLanguage:u}=e,p=(0,d().tz)(),{isMobile:f}=(0,i().Y0)(),[h,b]=(0,o.useState)(""),x=k(t),M=(0,o.useMemo)((()=>({key:"language-search-input",render:e=>(0,S.jsx)(g().Ay,{...e,disabled:t,placeholder:p.formatMessage(A.languageSearchPlaceholder),value:h,onChange:e=>b(e.target.value),autoFocus:!f,inputLeft:(0,S.jsx)(v().Q,{iconGroup:a().C,colorName:"lightGrayPrimary",variantName:"default"})}),action:()=>{}})),[h,t,p,f]),w=(0,o.useMemo)((()=>({key:"no-results",render:()=>(0,S.jsx)(y().A,{title:(0,S.jsx)(d().sA,{defaultMessage:"No results found.",id:"TranslationLanguageMenuList.noResults"})}),action:()=>{}})),[]),j=(0,o.useMemo)((()=>{const e=[];for(const t of l().hr)if(n(t)){const n=p.formatMessage((0,r().Bj)(t));e.push({languageCode:t,languageName:n})}return e.sort(((e,t)=>e.languageName.localeCompare(t.languageName)))}),[n,p]),C=(0,o.useMemo)((()=>(0,c().Ay)(h,j,(e=>{let{languageName:t}=e;return t.toLowerCase()}))),[h,j]),I=(0,o.useMemo)((()=>C.map((e=>{let{languageCode:n,languageName:o}=e;return{key:n,render:e=>(0,S.jsx)(m().A,{...e,buttonStyle:x.button,disabled:t,title:o,isChecked:s===n}),action:()=>{t||u(n)}}}))),[C,t,s,u,x.button]);return 0===I.length?[M,w]:[M,...I]}},396831:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(17090).A)},418426:(e,t,n)=>{n.d(t,{$:()=>l});n(898992),n(354520),n(581454);var o=()=>n(484714),i=()=>n(847249),s=()=>n(468006),a=()=>n(605402),r=()=>n(486130);function l(e){const t=(0,o().v3)().currentUser.id;return(0,i().K8)((()=>{if(!e.isDefined())return[];return(0,s().ri)({rawMembers:e.getRawMembership(),groupsInSpace:a().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))}).filter((n=>r()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()}).has(n.getGroupId())))}),[t,e])}},423817:(e,t,n)=>{n.d(t,{J:()=>a});n(581454),n(296540);var o=()=>n(401497),i=()=>n(710149),s=n(474848);function a(e){let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const n=(0,o().IS)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),a=[...Array(t)].map(((e,t)=>(0,s.jsxs)("div",{style:n.skeletonSection,children:[(0,s.jsx)(i().A,{style:n.skeletonCircle}),(0,s.jsxs)("div",{style:{width:"80%"},children:[(0,s.jsx)(i().A,{style:{width:"80%",...n.skeletonRect,marginTop:0}}),(0,s.jsx)(i().A,{style:{width:"50%",...n.skeletonRect}}),(0,s.jsx)(i().A,{style:{width:"60%",...n.skeletonRect}}),(0,s.jsx)(i().A,{style:{width:"50%",...n.skeletonRect}})]})]},t)));return(0,s.jsx)("div",{children:a})}},430923:(e,t,n)=>{n.d(t,{DV:()=>r,l7:()=>a,y7:()=>s});var o=()=>n(645873);const i={CollectionNewViewsPopupComponent:new(o().O2)("CollectionNewViewsPopupComponent",(async()=>await Promise.all([n.e(96346),n.e(55373),n.e(36192),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(7605),n.e(62620)]).then(n.bind(n,93709)))),CollectionLinkExistingModal:new(o().O2)("CollectionLinkExistingModal",(async()=>await Promise.all([n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(53321),n.e(90825),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(95794),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(71993),n.e(52393),n.e(26090),n.e(12341),n.e(66984),n.e(90978),n.e(64598),n.e(5287)]).then(n.bind(n,901226)))),ModalOverlayCollectionView:new(o().O2)("ModalOverlayCollectionView",(async()=>await Promise.all([n.e(96346),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(48486),n.e(74070),n.e(32413)]).then(n.bind(n,700868))))},s=(0,o()._h)(i.CollectionNewViewsPopupComponent,(e=>e.CollectionNewViewsPopupComponent)),a=(0,o()._h)(i.CollectionLinkExistingModal,(e=>e.CollectionLinkExistingModal)),r=(0,o()._h)(i.ModalOverlayCollectionView,(e=>e.ModalOverlayCollectionView))},448360:(e,t,n)=>{n.d(t,{W:()=>o});const o=n(757695).default.createValue(!1,{name:"AiPageTranslationCalloutStore"})},459240:(e,t,n)=>{n.d(t,{_:()=>c});n(296540);var o=()=>n(340498),i=n(474848);const s=(0,o().wt)("collectionCalendar",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.29688 14.4561H12.7031C14.1797 14.4561 14.9453 13.6904 14.9453 12.2344V3.91504C14.9453 2.45215 14.1797 1.69336 12.7031 1.69336H3.29688C1.82031 1.69336 1.05469 2.45215 1.05469 3.91504V12.2344C1.05469 13.6973 1.82031 14.4561 3.29688 14.4561ZM3.27637 13.1162C2.70898 13.1162 2.39453 12.8154 2.39453 12.2207V5.9043C2.39453 5.30273 2.70898 5.00879 3.27637 5.00879H12.71C13.2842 5.00879 13.6055 5.30273 13.6055 5.9043V12.2207C13.6055 12.8154 13.2842 13.1162 12.71 13.1162H3.27637ZM6.68066 7.38086H7.08398C7.33008 7.38086 7.41211 7.30566 7.41211 7.05957V6.66309C7.41211 6.41699 7.33008 6.3418 7.08398 6.3418H6.68066C6.44141 6.3418 6.35938 6.41699 6.35938 6.66309V7.05957C6.35938 7.30566 6.44141 7.38086 6.68066 7.38086ZM8.92285 7.38086H9.31934C9.56543 7.38086 9.64746 7.30566 9.64746 7.05957V6.66309C9.64746 6.41699 9.56543 6.3418 9.31934 6.3418H8.92285C8.67676 6.3418 8.59473 6.41699 8.59473 6.66309V7.05957C8.59473 7.30566 8.67676 7.38086 8.92285 7.38086ZM11.1582 7.38086H11.5547C11.8008 7.38086 11.8828 7.30566 11.8828 7.05957V6.66309C11.8828 6.41699 11.8008 6.3418 11.5547 6.3418H11.1582C10.9121 6.3418 10.8301 6.41699 10.8301 6.66309V7.05957C10.8301 7.30566 10.9121 7.38086 11.1582 7.38086ZM4.44531 9.58203H4.84863C5.09473 9.58203 5.17676 9.50684 5.17676 9.26074V8.86426C5.17676 8.61816 5.09473 8.54297 4.84863 8.54297H4.44531C4.20605 8.54297 4.12402 8.61816 4.12402 8.86426V9.26074C4.12402 9.50684 4.20605 9.58203 4.44531 9.58203ZM6.68066 9.58203H7.08398C7.33008 9.58203 7.41211 9.50684 7.41211 9.26074V8.86426C7.41211 8.61816 7.33008 8.54297 7.08398 8.54297H6.68066C6.44141 8.54297 6.35938 8.61816 6.35938 8.86426V9.26074C6.35938 9.50684 6.44141 9.58203 6.68066 9.58203ZM8.92285 9.58203H9.31934C9.56543 9.58203 9.64746 9.50684 9.64746 9.26074V8.86426C9.64746 8.61816 9.56543 8.54297 9.31934 8.54297H8.92285C8.67676 8.54297 8.59473 8.61816 8.59473 8.86426V9.26074C8.59473 9.50684 8.67676 9.58203 8.92285 9.58203ZM11.1582 9.58203H11.5547C11.8008 9.58203 11.8828 9.50684 11.8828 9.26074V8.86426C11.8828 8.61816 11.8008 8.54297 11.5547 8.54297H11.1582C10.9121 8.54297 10.8301 8.61816 10.8301 8.86426V9.26074C10.8301 9.50684 10.9121 9.58203 11.1582 9.58203ZM4.44531 11.7832H4.84863C5.09473 11.7832 5.17676 11.708 5.17676 11.4619V11.0654C5.17676 10.8193 5.09473 10.7441 4.84863 10.7441H4.44531C4.20605 10.7441 4.12402 10.8193 4.12402 11.0654V11.4619C4.12402 11.708 4.20605 11.7832 4.44531 11.7832ZM6.68066 11.7832H7.08398C7.33008 11.7832 7.41211 11.708 7.41211 11.4619V11.0654C7.41211 10.8193 7.33008 10.7441 7.08398 10.7441H6.68066C6.44141 10.7441 6.35938 10.8193 6.35938 11.0654V11.4619C6.35938 11.708 6.44141 11.7832 6.68066 11.7832ZM8.92285 11.7832H9.31934C9.56543 11.7832 9.64746 11.708 9.64746 11.4619V11.0654C9.64746 10.8193 9.56543 10.7441 9.31934 10.7441H8.92285C8.67676 10.7441 8.59473 10.8193 8.59473 11.0654V11.4619C8.59473 11.708 8.67676 11.7832 8.92285 11.7832Z"})}),a=(0,o().wt)("collectionGallery",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.0542 7.75952H5.96973C7.00464 7.75952 7.50562 7.25854 7.50562 6.19727V3.58691C7.50562 2.53223 7.00464 2.03125 5.96973 2.03125H2.0542C1.01929 2.03125 0.518311 2.53223 0.518311 3.58691V6.19727C0.518311 7.25854 1.01929 7.75952 2.0542 7.75952ZM10.0303 7.75952H13.9392C14.9741 7.75952 15.4751 7.25854 15.4751 6.19727V3.58691C15.4751 2.53223 14.9741 2.03125 13.9392 2.03125H10.0303C8.98877 2.03125 8.48779 2.53223 8.48779 3.58691V6.19727C8.48779 7.25854 8.98877 7.75952 10.0303 7.75952ZM2.06079 6.55322C1.83008 6.55322 1.71802 6.44116 1.71802 6.20386V3.58032C1.71802 3.34961 1.83008 3.23755 2.06079 3.23755H5.96313C6.18726 3.23755 6.30591 3.34961 6.30591 3.58032V6.20386C6.30591 6.44116 6.18726 6.55322 5.96313 6.55322H2.06079ZM10.0369 6.55322C9.79956 6.55322 9.69409 6.44116 9.69409 6.20386V3.58032C9.69409 3.34961 9.79956 3.23755 10.0369 3.23755H13.9392C14.1633 3.23755 14.2754 3.34961 14.2754 3.58032V6.20386C14.2754 6.44116 14.1633 6.55322 13.9392 6.55322H10.0369ZM2.0542 14.4634H5.96973C7.00464 14.4634 7.50562 13.969 7.50562 12.9077V10.2974C7.50562 9.24268 7.00464 8.7417 5.96973 8.7417H2.0542C1.01929 8.7417 0.518311 9.24268 0.518311 10.2974V12.9077C0.518311 13.969 1.01929 14.4634 2.0542 14.4634ZM10.0303 14.4634H13.9392C14.9741 14.4634 15.4751 13.969 15.4751 12.9077V10.2974C15.4751 9.24268 14.9741 8.7417 13.9392 8.7417H10.0303C8.98877 8.7417 8.48779 9.24268 8.48779 10.2974V12.9077C8.48779 13.969 8.98877 14.4634 10.0303 14.4634ZM2.06079 13.2637C1.83008 13.2637 1.71802 13.1516 1.71802 12.9143V10.2974C1.71802 10.0601 1.83008 9.94141 2.06079 9.94141H5.96313C6.18726 9.94141 6.30591 10.0601 6.30591 10.2974V12.9143C6.30591 13.1516 6.18726 13.2637 5.96313 13.2637H2.06079ZM10.0369 13.2637C9.79956 13.2637 9.69409 13.1516 9.69409 12.9143V10.2974C9.69409 10.0601 9.79956 9.94141 10.0369 9.94141H13.9392C14.1633 9.94141 14.2754 10.0601 14.2754 10.2974V12.9143C14.2754 13.1516 14.1633 13.2637 13.9392 13.2637H10.0369Z"})});var r=()=>n(972435);const l=(0,n(959013).YK)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"}});function d(e){const{environment:t,store:o,viewType:i}=e;n(751156).createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,canUndo:!0,perform:e=>{(0,n(226916).c)({environment:t,store:o,viewType:i,transaction:e}),n(857783).uK({environment:t,store:o,pageVisitSource:n(584262).y8.LinkInPage});const s=o.getCollectionViewStores()[0];s&&(0,n(493260).F)(s.id,{viewType:i})}})}const c=[{name:r().A.formatMessage(l.table),type:"table",iconFn:n(29118).K,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"table"})},{name:r().A.formatMessage(l.board),type:"board",iconFn:n(34373).k,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"board"})},{name:r().A.formatMessage(l.list),type:"list",iconFn:n(50170).u,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"list"})},{name:r().A.formatMessage(l.timeline),type:"timeline",iconFn:n(880261).v,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"timeline"})},{name:r().A.formatMessage(l.calendar),type:"calendar",iconFn:s,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"calendar"})},{name:r().A.formatMessage(l.gallery),type:"gallery",iconFn:a,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>d({environment:e,store:t,viewType:"gallery"})}]},466529:(e,t,n)=>{n.r(t),n.d(t,{HorizontalTemplatePicker:()=>Q});n(898992),n(823215),n(354520),n(581454);var o=n(296540),i=()=>n(484714),s=()=>n(792485),a=()=>n(847249),r=()=>n(401497),l=()=>n(590856),d=()=>n(29118),c=()=>n(30626),u=()=>n(383286),p=()=>n(284611),m=()=>n(169606),g=()=>n(179034),f=()=>n(959013),h=()=>n(534177),y=()=>n(160568),v=()=>n(246826),b=()=>n(33301),x=()=>n(751156),S=()=>n(178658),M=()=>n(938987),A=()=>n(226916),w=()=>n(459240),k=()=>n(828634),j=()=>n(549500),C=()=>n(862835),I=()=>n(249696),T=()=>n(68465),_=()=>n(972435),P=()=>n(478726),B=()=>n(963589),R=()=>n(806638),L=()=>n(962730),D=()=>n(377586),O=()=>n(227440),N=()=>n(970585),E=()=>n(611371),U=()=>n(922952),F=()=>n(317053),V=()=>n(155004),K=()=>n(364280),H=()=>n(939740),z=()=>n(897119),W=()=>n(125565),G=()=>n(532731),Y=()=>n(286611),q=n(474848);const $=8;function Q(e){const{store:t,context:n,menuListStore:B,editorWidth:N}=e,Q=J(),ne=(0,P().L5)(n),oe=(0,r().IS)((e=>({root:{background:ne?e.peekModalBackground:e.contentBackground,paddingBottom:"min(48px, 5vh)",pointerEvents:"all"}})),[ne]),[ie,se]=function(e){const t=(0,i().v3)(),n=(0,a().K8)((()=>"editor"===e.getRole()),[e]),o=function(){const e=(0,f().tz)(),t=(0,r().DP)();return{name:e.formatMessage(X.tableTemplateTitle),type:"database",iconFn:e=>(0,d().K)({...e,fill:t.regularIconColor}),isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>{const n=t.getParentStore();n&&(0,U().u)(n)&&(0,F().openTemplateOnboardingModal)({parentStore:n,template:void 0,version:(0,F().getTemplateOnboardingVersion)({template:void 0}),origin:"new_page_pills",navigateToOnFinish:"created_collection",onClose:o=>{"accepted_template"!==o.type&&"accepted_empty_collection"!==o.type||x().createAndCommit({environment:e,canUndo:!1,perform:e=>{if(v().zv({store:t,transaction:e,data:{alive:!1}}),n.table===g().ev){const o=n.getContentIds();v().zv({store:n,transaction:e,data:{content:o.filter((e=>e!==t.id))}})}},userAction:"clean_up_empty_new_page"})}})}}}(),c=function(e){const{environment:t,store:n}=e,o=(0,f().tz)(),i=(0,s().S)(),r=(0,a().K8)((()=>null==i?void 0:i.publicEditModeStore.state),[null==i?void 0:i.publicEditModeStore]),l=(0,a().K8)((()=>(0,T().ZE)(r)),[r]);return{name:o.formatMessage(X.askAi),type:"ai",iconFn:e=>(0,q.jsx)(M().UY,{}),shouldShow:()=>l,onClick:()=>{x().createAndCommit({userAction:"HorizontalTemplatePicker.genericHelpMeWriteNewPageWithAI",environment:t,canUndo:!0,perform:e=>{b().n({environment:t,store:n,transaction:e,preventTextSelection:!1,onTextSelection(){(0,S().openHelpMeWriteGenericPopup)({environment:t,title:""})}})}})}}}({environment:t,store:e}),h=function(e){const t=(0,f().tz)(),n=(0,r().DP)(),o=(0,a().K8)((()=>(0,C().h)()),[]),i=(0,I().W)(),s=J();return{name:e?"":t.formatMessage(X.dictate),type:"dictation",iconFn:t=>(0,u().E)({...t,width:10,...e?{height:16,marginTop:"2px",marginBottom:"2px",marginLeft:"2px",marginRight:"-6px"}:{},fill:s?n.icon.primary:"dark"===n.mode?n.accentColors.red[700]:n.accentColors.red[400]}),shouldShow:()=>o&&!i,onClick:async(e,t)=>{const{dictationActions:n}=await j().$O.load();n.startDictation({environment:e,blockStore:t,from:"horizontal_template_picker",includeSystemAudio:!1})}}}(!0),y=function(){const e=(0,f().tz)(),t=(0,r().DP)(),n=(0,I().W)();return{name:e.formatMessage(X.transcription),type:"transcription",iconFn:e=>(0,p().b)({...e,fill:t.regularIconColor}),shouldShow:()=>n,onClick:async(e,t)=>{const{transcriptionNewPageActions:n}=await j().$O.load();n.appendTranscriptionBlockToPage({environment:e})}}}(),k=function(e){const t=(0,i().v3)(),n=(0,f().tz)(),o=(0,r().DP)();return{name:n.formatMessage(X.formTemplateTitle),type:"quick-form",iconFn:e=>(0,l().y)({...e,fill:o.regularIconColor}),shouldShow:()=>!0,onClick:async()=>{await(0,A().t)({environment:t,store:e})}}}(e),P=function(e){const{isTablet:t}=(0,i().Y0)();return{name:_().A.formatMessage(G().KQ.templates),type:"templates",iconFn:e=>(0,m().s)(e),shouldShow:()=>!t,onClick:e=>{(0,R().P)({environment:e})}}}(),B=[h,c,y,o,...n?[k]:[],P].filter((e=>e.shouldShow(t))),L=[...w()._,ee,G().zD];return[B,L]}(t),[ae,re]=function(e){const{store:t,editorWidth:n,initialVisible:s,initialOverflow:a}=e,l=(0,i().v3)(),d=(0,f().tz)(),u=J(),p=(0,r().IS)((e=>({icon:{width:16,marginLeft:2,marginRight:2,fill:e.lightIconColor}})),[]),[m,g]=o.useState(void 0),[v,b]=o.useState([]),[x,S]=o.useState(void 0),[M,A]=o.useState(s.length);(0,o.useEffect)((()=>{if(!(n&&v.every(h().O9)&&x))return;let e=0,t=0;for(;t<s.length&&(e+=v[t]+$,!(e+x>n+24));)t++;A(t)}),[v,n,s.length,x]);const w=s.slice(0,M).map(((e,n)=>{const o={key:"ai-skill"===e.type?`${e.type}-${n}`:e.type,render:o=>{var i;let{ref:s,...a}=o;return(0,q.jsx)(k().EE,{onSizeChange:e=>{if(v[n]===e.width)return;const t=[...v];t[n]=e.width,b(t)},children:(0,q.jsx)("div",{children:(0,q.jsx)(Y().J,{...a,focused:m===n,onMouseEnter:o=>{var i;null===(i=e.onMouseEnter)||void 0===i||i.call(e,l,t),g(n)},onMouseLeave:n=>{var o;null===(o=e.onMouseLeave)||void 0===o||o.call(e,l,t),g(void 0)},format:"horizontal-new-page",title:(0,q.jsx)(W().A,{children:e.name}),type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,p.icon),locked:!1})})})},action:n=>{(0,E().EF)(l)&&(y().ki(l,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(l,t))}};return o})),[j,C]=o.useState(!1),I=M,T={key:"more",render:e=>{let{ref:n,...o}=e;return(0,q.jsx)(z().Ay,{origin:(0,q.jsx)(k().EE,{onSizeChange:e=>S(e.width),children:(0,q.jsx)("div",{children:(0,q.jsx)(Y().J,{...o,focused:m===I,onMouseEnter:e=>{g(I)},onMouseLeave:e=>{g(void 0)},format:"horizontal-new-page",title:u?null:(0,q.jsx)(W().A,{children:d.formatMessage(X.more)}),type:"more",icon:(0,c()._)(p.icon),locked:!1})})}),alignmentToOrigin:L().C.Start,placementToOrigin:L().W.Top,originGap:4,open:j,popupType:D().n.Popup,onDismiss:()=>C(!1),render:()=>(0,q.jsx)(te,{store:t,items:[...s.slice(M),...a]})})},action:e=>{y().ki(l,{is_keyboard:"keydown"===e.event.type,from:"horizontal_template_picker",template_type:"more"}),C(!0)}};return[w,T]}({store:t,editorWidth:N,initialVisible:ie,initialOverflow:se});return!(0,a().O$)(O().e)?null:(0,q.jsx)(V().s,{allowSelectionWithin:!1,children:(0,q.jsx)(H().Ay,{type:H().Oh.Horizontal,store:B,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Get started",render:e=>(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Z,{isInPeekView:ne}),(0,q.jsx)("div",{style:oe.root,children:(0,q.jsxs)(K().VP,{gap:12,children:[(0,q.jsx)(W().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:500},children:Q?(0,q.jsx)(f().sA,{defaultMessage:"Get started with",id:"PageEditor.horizontalTemplatePicker.getStarted.label.new"}):(0,q.jsx)(f().sA,{defaultMessage:"Get started",id:"PageEditor.horizontalTemplatePicker.getStarted.label"})}),(0,q.jsx)("div",{style:{cursor:"pointer"},children:(0,q.jsx)(K().fI,{gap:$,children:e.children})})]},e.key)})]}),items:[...ae,re]}]})})}function Z(e){const t=(0,r().IS)((t=>({fade:{background:`linear-gradient(0deg, ${e.isInPeekView?t.peekModalBackground:t.contentBackground} 0%, ${t.contentBackgroundTransparent} 100%)`,height:140,width:"100%"}})),[e.isInPeekView]);return(0,q.jsx)("div",{style:t.fade})}const X=(0,f().YK)({askAi:{defaultMessage:"Ask AI",id:"newpage.templates.writeWithAiCondensed"},dictate:{defaultMessage:"Dictate",id:"newpage.templates.dictateIntoNewPage"},transcription:{defaultMessage:"Meet",id:"newpage.templates.transcription"},more:{defaultMessage:"More",id:"newpage.templates.more"},tableTemplateTitle:{defaultMessage:"Database",id:"newpage.templates.table"},formTemplateTitle:{defaultMessage:"Form",id:"newpage.templates.form"}});function J(){const e=(0,i().v3)(),{isTablet:t}=(0,i().Y0)(),n=(0,B().X)("tablet_refresh_template_pills_gate");return!(!t||!n)||!e.device.isMobile}const ee={name:"",type:"divider",iconFn:e=>null,shouldShow:()=>!0,onClick:()=>{}};function te(e){const{store:t,items:n}=e,s=(0,i().v3)(),a=(0,o.useMemo)((()=>new(N().A)),[]),l=(0,r().IS)((e=>({menu:{width:200,cursor:"pointer",padding:"6px 4px"},icon:{width:16,marginLeft:2,marginRight:2,fill:e.regularIconColor},divider:{height:1,background:e.stroke.primary,margin:"6px -6px"}})),[]),d=n.filter((e=>e.shouldShow(s))).map((e=>{const n={key:e.name,render:t=>{var n;let{ref:o,...i}=t;return"divider"===e.type?(0,q.jsx)("div",{style:l.divider}):(0,q.jsx)(Y().J,{...i,format:"horizontal-new-page-submenu",title:(0,q.jsx)(W().A,{children:e.name}),type:e.type,icon:null===(n=e.iconFn)||void 0===n?void 0:n.call(e,l.icon),locked:!1})},action:n=>{(0,E().EF)(s)&&(y().ki(s,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(s,t))}};return n}));return(0,q.jsx)(H().Ay,{type:H().Oh.Vertical,store:a,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Items",render:e=>(0,q.jsx)("div",{style:l.menu,children:(0,q.jsx)(K().VP,{children:e.children},e.key)}),items:d}]})}},467935:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(584262),r=()=>n(133033),l=()=>n(959013),d=()=>n(148024),c=()=>n(857783),u=()=>n(836251),p=()=>n(351360);class m extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const g=new m;var f=()=>n(493823),h=()=>n(187485),y=()=>n(487631),v=n(474848);const b={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:n(284371).Wy.bold,marginRight:"auto"},x={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},S={padding:"24px 36px 24px",minWidth:300};const M=function(){const e=(0,s().O$)(g);return(0,v.jsx)(n(676007).A,{open:e.open,innerStyle:S,preventHideChildrenWhileOpening:!0,render:()=>(0,v.jsxs)(o.Fragment,{children:[(0,v.jsxs)("div",{style:x,children:[(0,v.jsx)("div",{style:b,children:(0,v.jsx)(l().sA,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,v.jsx)(A,{})]}),(0,v.jsx)("div",{children:(0,v.jsx)(k,{modalState:e})})]}),onDismiss:w})};function A(){const e=(0,i().v3)();return(0,v.jsx)(h().A,{href:(0,u().xS)("guides.import"),onClick:()=>d().FH(e,{from:"import"}),external:!0,children:(0,v.jsx)(f().p,{size:"sm",icon:r().$,isGray:!0,children:(0,v.jsx)(l().sA,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function w(){g.setState({open:!1})}function k(e){let{modalState:t}=e;const n=(0,i().v3)(),{mainEditorCurrentBlockStore:o,currentSpaceStore:r,currentSpaceViewStore:l,currentUserSettingsStore:d}=(0,s().K8)((()=>{const{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}=p().default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}}),[]);return o&&r&&l&&d?(0,v.jsx)(y().A,{pageStore:t.open&&t.pageStore?t.pageStore:o,spaceStore:r,spaceViewStore:l,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>function(e,t){g.setState({open:!1}),c().uK({environment:t,store:e,pageVisitSource:a().y8.Import})}(e,n),readOnlyCreditButton:!1}):null}},487443:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInviteWithModal:()=>l});n(296540);var o=()=>n(847249),i=()=>n(401497),s=()=>n(433876),a=()=>n(284331),r=n(474848);function l(e){let{store:t,permissionsInviteStore:n,origin:l}=e;const d=(0,o().K8)((()=>n.state.modalOpen),[n]),c=()=>{n.reset()},u=(0,i().IS)((()=>({modal:{alignSelf:"center",overflow:"visible",top:0,width:500},overlay:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}})),[]);return(0,r.jsx)(s().A,{modalStyle:u.modal,open:d,onDismiss:c,renderContent:()=>(0,r.jsx)("div",{style:u.overlay,children:(0,r.jsx)(a().A,{store:t,permissionsInviteStore:n,isNewlyCreatedTeam:!1,onSubmitSuccessful:c,onDismiss:c})}),origin:l})}},500844:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInvite:()=>E});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(842599),l=()=>n(187174),d=()=>n(959013),c=()=>n(542056),u=()=>n(928600),p=()=>n(263919),m=()=>n(417555),g=()=>n(856952),f=()=>n(47373),h=()=>n(722872),y=()=>n(743260),v=()=>n(37433),b=()=>n(351360),x=()=>n(406999),S=()=>n(205618),M=()=>n(224701),A=()=>n(668725),w=()=>n(496603),k=()=>n(493823),j=()=>n(760217),C=()=>n(406699),I=()=>n(939740),T=()=>n(89924),_=()=>n(859428),P=()=>n(962730),B=()=>n(700250),R=()=>n(308228),L=()=>n(43450),D=n(474848);function O(e){const{selectedRole:t,allRoles:n,onChange:o,store:r,labelStyle:l}=e,{device:c}=(0,i().v3)(),p=(0,a().DP)(),m=(0,L().R)(r),g=(0,s().K8)((()=>{const{currentSpaceStore:e}=b().default.state;return null==e?void 0:e.canEditMembership()}),[]),f=(0,s().K8)((()=>r.isDefault()),[r]);return(0,D.jsx)(C().Ay,{popupType:c.isMobile?C().z7.SlideUp:C().z7.Popup,renderOrigin:e=>(0,D.jsxs)(k().p,{style:l,...e,children:[(0,D.jsx)(d().sA,{...v().ROLE_MESSAGE_MAP[t].label}),(0,A().b)({width:10,marginLeft:4,fill:p.lightIconColor})]}),placementToOrigin:B().UV.Bottom,render:e=>{const i=[{key:"roles",render:e=>(0,D.jsx)(T().A,{...e,topBorder:0!==e.index}),items:n.map((n=>{const{isDisabled:i,disabledReason:s}=(0,R().m)({role:n,isCurrentUserTeamOwner:Boolean(m),userIsSpaceAdmin:Boolean(g),isDefaultTeam:f}),a={key:n,render:e=>(0,D.jsx)(_().A,{disableTooltip:!i,placement:P().W.Right,textWrap:!0,renderTooltip:()=>s,render:o=>(0,D.jsx)("span",{...o,children:(0,D.jsx)(j().A,{...e,isChecked:w().n4(n,t),disabled:i,disabledFeedback:i,title:(0,D.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,D.jsx)(d().sA,{...v().ROLE_MESSAGE_MAP[n].label})}),caption:(0,D.jsx)("span",{style:{color:p.text.secondary},children:(0,D.jsx)(d().sA,{...v().ROLE_MESSAGE_MAP[n].caption})}),shouldWrapCaption:!0})})}),action:()=>{o(n),e.close()}};return a}))}];let s;return s=c.isMobile?{menuType:h().gu.Modal,title:(0,D.jsx)(d().sA,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,D.jsx)(d().sA,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:h().gu.Popup,width:264},(0,D.jsx)(u().A,{...s,children:(0,D.jsx)(I().Ay,{type:I().Oh.Vertical,initialFocus:void 0,sections:i})})}})}const N="member";function E(e){const{store:t,onEmptySubmit:n}=e,o=(0,i().v3)();(0,l().Yb)((async()=>{await M().Ow(o)}),[]);const r=(0,s().uB)(e.permissionsInviteStore,S().A),d=(0,s().K8)((()=>Boolean(r.state.isFocused)),[r]),c=(0,s().K8)((()=>r.state.tokenQuery),[r]),m=(0,s().K8)((()=>d&&c.length>0),[d,c]),g=(0,a().IS)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.contentBackground,boxShadow:e.shadowLG,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){r.setState({...r.state,isFocused:e})}return(0,D.jsx)("div",{onFocus:()=>f(!0),onBlur:()=>f(!1),children:(0,D.jsx)(u().A,{menuType:h().gu.Popup,header:(0,D.jsx)(U,{store:t,permissionsInviteStore:r,setFocus:f,onEmptySubmit:n}),scrollerStyle:g.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:m&&(0,D.jsx)("div",{style:g.permissionsInviteSearchRequest,children:(0,D.jsx)(p().A,{permissionsInviteStore:r,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}function U(e){const{store:t,permissionsInviteStore:n,onEmptySubmit:l,setFocus:u}=e,p=(0,d().tz)(),f=(0,i().v3)(),h=(0,o.useRef)(null),v=(0,s().K8)((()=>Boolean(n.state.isFocused)),[n]),b=(0,s().K8)((()=>n.state.tokenQuery),[n]),S=(0,s().K8)((()=>n.state.inviteRole),[n]),M=(0,s().K8)((()=>n.state.inviteTargets),[n]),A=(0,a().IS)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:v?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[v]);function w(e){if(n.state.isInviteTargetsEmpty)return;const t=n.state.inviteTargets.filter((t=>t!==e));0===M.length?n.setState({...n.state,inviteTargets:[],inviteRole:N,isInviteTargetsEmpty:!0}):n.setState({...n.state,inviteTargets:t})}const k=M.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,D.jsx)(m().A,{target:e,onClickRemove:w,role:S,shouldWrap:!0,style:A.inputTokenVerticalMargin,backgroundColor:(0,y().qv)(e)},t)}));return(0,D.jsx)(g().Ay,{ref:h,focus:v,onClick:()=>u(!0),format:g().le.Share,value:b,onChange:async e=>{await async function(e){const{environment:t,permissionsInviteStore:n,event:o,setFocus:i,inputRef:s}=e;if(!n.state.isInviteTargetsEmpty&&(0,x().qs)(n.state))return;const a=o.target.value,{extractedEmails:l,newInputValue:d}=(0,r().Ct)(a),u=await c().Ah(t,l),p=u.filter((e=>!(0,y().mQ)({target:e,permissionsInviteStore:n}))),m=[...n.state.inviteTargets,...p];if(m.length>0){if(n.setState({...n.state,inviteTargets:m,isInviteTargetsEmpty:!1,tokenQuery:d}),!d){const e=s.current;e&&(e.value="")}i(!(p.length>0))}else n.setState({...n.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:d})}({environment:f,event:e,permissionsInviteStore:n,setFocus:u,inputRef:h})},onEmptySubmit:l,type:"email",placeholder:p.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:k,tokenWrapStyle:{gap:4},onRemoveLastToken:function(){const e={...n.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=N),n.setState(e)},focusAfterAnimation:!0,right:(0,D.jsx)(F,{store:t,permissionsInviteStore:n}),style:A.tokenMenuItem,inputStyle:A.inputTokenVerticalMargin,inputDivStyle:A.inputDiv,inputFullWidth:!0})}function F(e){const{store:t,permissionsInviteStore:n}=e,o=(0,s().K8)((()=>{const e=b().default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,f().Qd)()}),[]),i=(0,s().K8)((()=>n.state.inviteRole),[n]),r=(0,a().IS)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){n.setState({...n.state,inviteRole:e})}return o?(0,D.jsx)(O,{store:t,selectedRole:i,allRoles:v().TeamRolesWithGuest,onChange:l,labelStyle:r.teamRoleLabel}):(0,D.jsx)(O,{store:t,selectedRole:i,allRoles:v().TeamRoles,onChange:l,labelStyle:r.teamRoleLabel})}},501402:(e,t,n)=>{n.r(t),n.d(t,{PopupBottomSheet:()=>f});var o=n(296540),i=()=>n(484714),s=()=>n(852507),a=()=>n(847249),r=()=>n(401497),l=()=>n(751735),d=()=>n(347199),c=()=>n(574012),u=()=>n(881839),p=()=>n(888789),m=()=>n(56197),g=n(474848);function f(e){const{isAndroid:t}=(0,i().Y0)(),n=(0,r().IS)((n=>({container:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",overflow:"hidden",pointerEvents:"none"},content:{position:"absolute",bottom:0,left:0,right:0,maxHeight:"var(--full-viewport-height)"},overlay:{pointerEvents:"auto",position:"absolute",top:0,left:0,bottom:0,right:0,...e.disableDarkOverlayBackground?{}:{background:t?(0,l().X4)("black","light"===n.mode?.2:.8):(0,l().X4)("black","light"===n.mode?.12:.29)},transition:"opacity 0.5s cubic-bezier(0.32, 0.72, 0, 1)"}})),[e.disableDarkOverlayBackground,t]),s=(0,o.useRef)(null),[a,d]=(0,o.useState)(0);return e.open?(0,g.jsx)(u().L,{keepFocus:e.keepFocus,preventCaptureEsc:e.preventCaptureEsc,onDismiss:e.onDismiss,children:t=>(0,g.jsxs)("div",{...t,style:n.container,children:[(0,g.jsx)("div",{"aria-hidden":!0,tabIndex:-1,ref:s,style:{...n.overlay,opacity:a},onMouseDown:e=>e.preventDefault()},"overlay"),(0,g.jsx)("div",{style:n.content,children:(0,g.jsx)(h,{...e,overlayRef:s,setAnimationState:d,children:e.render()})})]})},"popup-keyboard-area"):null}function h(e){const{initialState:t,onDismiss:n,overlayRef:l,setAnimationState:u}=e,{WindowSizeStore:f,TabbedRouterStore:h}=(0,i().v3)(),{isAndroid:y,isTablet:v,isMobileNative:b}=(0,i().Y0)(),x=(0,a().K8)((()=>h.state.modal.length>0),[h]),S=(0,o.useRef)(!1),M="half"===t||"full"===t&&e.enableHalfSheet,A=(0,o.useMemo)((()=>window.innerHeight),[]),w=(0,o.useRef)(A),k=(0,o.useMemo)((()=>({closed:A,half:.5*A,open:0})),[A]),j=(0,a().K8)((()=>f.getSafePaddingTopCSS(y?16:10)),[f,y]),[C,I]=(0,o.useState)({transform:`translateY(${k.closed}px) translateZ(0)`});(0,s().w)((()=>{p().KP.setState(!0),u(1),P({target:"half"===t?k.half:k.open,animate:!0})}));const T=(0,r().IS)((t=>({sheet:{backgroundColor:e.bottomSheetBackgroundColor?t.surface[e.bottomSheetBackgroundColor]:t.surface.wash,borderRadius:"12px 12px 0 0",maxWidth:640,margin:"0 auto",marginTop:j,boxShadow:y?void 0:t.shadowMD},dragHandle:{height:5,width:y?44:38,backgroundColor:t.stroke.primary,borderRadius:5,margin:"0px auto"}})),[j,y,e.bottomSheetBackgroundColor]),_=(0,o.useRef)(-1),P=(0,o.useCallback)((e=>{const{target:t,animate:n}=e,o=Math.max(Math.min(t,k.closed),k.open),i=_.current;window.cancelAnimationFrame(i),_.current=window.requestAnimationFrame((()=>{if(w.current=o,I({transform:`translateY(${o}px) translateZ(0)`,transition:n?"transform 0.5s cubic-bezier(0.32, 0.72, 0, 1)":void 0}),S.current){const e=Math.max(0,Math.min(o/k.closed,1)),t=.5-e<k.half?e:0,i=1-Math.max(0,Math.min(2*t,1));m().q.update((e=>({...e,attached:!0,animating:n,proportion:i})))}}))}),[_,w,k]),B=(0,a().K8)((()=>{const{phase:e}=c().A.state;return e===c().i.willShow}),[]);(0,o.useEffect)((()=>{B&&w.current>50&&P({target:k.open,animate:!0})}),[B,k.open,w,P]),(0,o.useEffect)((()=>{const e=l.current;if(e){const t=e=>{P({target:k.closed,animate:!0})};return e.addEventListener("click",t),()=>e.removeEventListener("click",t)}}),[l,k.closed,P,n]);const R=(0,o.useCallback)((()=>{var e;return null===(e=d().A.MenuScroller)||void 0===e?void 0:e.getNode()}),[]),L=(0,o.useRef)(0),D=(0,o.useRef)(0),O=(0,o.useRef)(void 0),N=(0,o.useRef)(0),E=(0,o.useRef)(!1),U=(0,o.useRef)(!1),F=(0,o.useCallback)((e=>{E.current=!1,U.current=!1,O.current=void 0;const t={open:.3*A,half:A*(y?.55:.65)},n={open:A*(y?.3:.4)},o=Math.max(0,Date.now()-N.current),i=(w.current-L.current)/o;let s;s=i<-.5?k.open:i>1?M&&w.current<t.half?k.half:k.closed:M?w.current<t.open?k.open:w.current<t.half?k.half:k.closed:w.current<n.open?k.open:k.closed,void 0!==s&&P({target:s,animate:!0})}),[y,M,A,w,P,k]);(0,o.useEffect)((()=>{if(b&&!y&&!v&&!x&&!m().q.state.attached)return S.current=!0,m().q.update((e=>({...e,attached:!0}))),()=>{S.current=!1,m().q.update((e=>({...e,attached:!1})))}}),[b,y,v,x,w,A,k.half]);const V=(0,o.useCallback)((e=>{var t,n;const o=e.touches[0].clientY-D.current,i=o<0,s=O.current?e.touches[0].clientY-O.current:void 0;if(O.current=e.touches[0].clientY,0!==((null===(t=R())||void 0===t?void 0:t.scrollTop)??0)){U.current=!0;const e=R();return void(!i&&e&&s&&e.scrollBy({top:-s}))}if(U.current)return;const a=(null===(n=R())||void 0===n?void 0:n.clientHeight)??0;if(i&&a<k.half-17-100)return;if(i&&0===w.current)return;e.preventDefault(),e.stopPropagation(),E.current=!0;const r=Math.max(0,L.current+o);P({target:r,animate:!1})}),[w,P,k.half,R]),K=(0,o.useCallback)((e=>{"transform"===e.propertyName&&p().KP.setState(!0)}),[]),H=(0,o.useCallback)((e=>{"transform"===e.propertyName&&p().KP.setState(!1)}),[]),z=(0,o.useRef)(null);return(0,o.useEffect)((()=>{const e=z.current;if(e)return e.addEventListener("touchmove",V),e.addEventListener("transitionrun",K),e.addEventListener("transitionend",H),()=>{e.removeEventListener("touchmove",V),e.removeEventListener("transitionrun",K),e.removeEventListener("transitionend",H)}}),[V,K,H]),(0,g.jsx)("div",{role:"none",ref:z,style:{...C,willChange:"transform"},onTransitionEnd:e=>{"transform"===e.propertyName&&w.current===k.closed&&(u(0),null==n||n(e))},onTouchStart:e=>{L.current=w.current,D.current=e.touches[0].clientY,N.current=Date.now(),w.current>0&&(E.current=!0)},onTouchEnd:F,children:(0,g.jsxs)("div",{role:"dialog","aria-label":e.ariaLabel,"aria-labelledby":e.ariaLabelledBy,"aria-describedby":e.ariaDescribedBy,"aria-modal":!!e.trapFocus||void 0,style:{...T.sheet,pointerEvents:E.current?"none":"auto",touchAction:E.current?"none":"auto"},children:[(0,g.jsx)("div",{style:{height:6}}),(0,g.jsx)("div",{style:T.dragHandle},"drag-spacer"),(0,g.jsx)("div",{style:{height:6}}),(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",height:`calc(var(--full-viewport-height) - 17px - ${j})`},children:e.children})]},"content")},"sheet")}},514799:(e,t,n)=>{n.d(t,{H:()=>r});var o=()=>n(484714),i=()=>n(847249),s=()=>n(185078),a=()=>n(910302);function r(e){const{detectedLanguage:t,canSuggestInConfidence:n}=function(e){const{pageStore:t,enabled:n,forceUpdate:s=!1}=e,r=(0,o().v3)();return(0,i().K8)((()=>n?a().bY({pageStore:t,environment:r,enabled:n,forceUpdate:s}):{detectedLanguage:void 0,canSuggestInConfidence:!1}),[t,r,n,s])}(e);return t&&!(0,s().cE)(t)?{detectedLanguage:void 0,canSuggestInConfidence:!1}:{detectedLanguage:t,canSuggestInConfidence:n}}},515512:(e,t,n)=>{n.d(t,{Q:()=>l});var o=()=>n(484714),i=()=>n(847249),s=()=>n(640653),a=()=>n(351360),r=()=>n(749240);function l(){const e=function(){const e=(0,o().v3)();return(0,i().K8)((()=>{const t=a().default.state.currentSpaceStore,n=r().subscriptionDataStoreInstance.state;return t?s().IL(t)?n?{loading:!1,isUserTeamGuestOfSpace:s().Qx(e,n)}:{loading:!0}:{loading:!1,isUserTeamGuestOfSpace:!1}:{loading:!0}}),[e])}();return(0,i().K8)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},529324:(e,t,n)=>{n.d(t,{C:()=>o});const o=(0,n(340498).xh)("magnifyingGlass",{default:{loader:()=>n.e(1827).then(n.bind(n,901827))},small:{loader:()=>n.e(41805).then(n.bind(n,741805))},mini:{loader:()=>n.e(20283).then(n.bind(n,420283))},large:{loader:()=>n.e(61969).then(n.bind(n,861969))}})},532731:(e,t,n)=>{n.d(t,{F1:()=>h,KQ:()=>d,Wt:()=>p,dB:()=>f,vP:()=>u,wL:()=>c,zD:()=>m});n(944114),n(898992),n(581454),n(908872);var o=()=>n(959013),i=()=>n(33301),s=()=>n(751156),a=()=>n(972435),r=()=>n(806638),l=()=>n(404141);const d=(0,o().YK)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),c={name:a().A.formatMessage(d.empty),iconFn:n(47966).Y,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{s().createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,canUndo:!0,perform:n=>{i().n({environment:e,store:t,transaction:n})}})}},u={name:a().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(948352).M)(e),shouldShow:()=>!0,onClick:e=>{(0,r().P)({environment:e})}},p={name:a().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(926329).b)(e),shouldShow:()=>!0,onClick:e=>{(0,r().P)({environment:e})}},m={name:a().A.formatMessage(d.import),type:"import",iconFn:n(555555).n,shouldShow:()=>!0,onClick:(e,t)=>{const o=n(206267).JW();n(522094).A.setState({flowId:o}),n(559926).kY(e,{from:"new_page",flowId:o}),l().A.setState({...l().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0})}},g=(0,o().YK)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),f=[{name:a().A.formatMessage(g.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{s().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().T({environment:e,store:t,transaction:n})}})}},{name:a().A.formatMessage(g.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{s().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().n({environment:e,store:t,transaction:n})}})}}];function h(e,t){const n=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(n.has(t)&&e.push(n.get(t)),e)),[])}},536612:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(959180))().A{}const i=new o},542371:(e,t,n)=>{n.d(t,{A:()=>o});class o extends(()=>n(757695))().default{getInitialState(){}}},544008:(e,t,n)=>{n.d(t,{DZ:()=>i});var o=()=>n(959013);const i=(0,o().YK)({gettingStarted:{defaultMessage:"Getting started",id:"templateHelpers.personas.gettingStarted"},life:{defaultMessage:"Life",id:"templateGallery.sidebar.life"},personal:{defaultMessage:"Personal",id:"templateHelpers.personas.personal"},designer:{defaultMessage:"Design",id:"templateHelpers.personas.design"},engineering:{defaultMessage:"Engineering",id:"templateHelpers.personas.engineering"},marketing:{defaultMessage:"Marketing",id:"templateHelpers.personas.marketing"},media:{defaultMessage:"Media",id:"templateHelpers.personas.media"},it:{defaultMessage:"IT",id:"templateHelpers.personas.it"},entrepreneur:{defaultMessage:"Entrepreneur",id:"templateHelpers.personas.entrepreneur"},freelancer:{defaultMessage:"Freelancer",id:"templateHelpers.personas.freelancer"},educator:{defaultMessage:"Educator",id:"templateHelpers.personas.educator"},student:{defaultMessage:"Student",id:"templateHelpers.personas.student"},other:{defaultMessage:"Other",id:"templateHelpers.personas.otherOptionLabel"},hr:{defaultMessage:"Human resources",id:"templateHelpers.personas.humanResources"},truncated_hr:{defaultMessage:"HR",id:"templateHelpers.personas.truncated.humanResources"},productManagement:{defaultMessage:"Product management",id:"templateHelpers.personas.productManagement"},productManagementV2:{defaultMessage:"Product",id:"templateHelpers.personas.productManagementV2"},support:{defaultMessage:"Support",id:"templateHelpers.personas.support"},education:{defaultMessage:"Education",id:"templateHelpers.personas.education"},sales:{defaultMessage:"Sales",id:"templateHelpers.personas.sales"},getStartedPage:{defaultMessage:"Getting started",id:"templateHelpers.templates.getStarted"},getStartedPageEvernote:{defaultMessage:"Getting started from Evernote",id:"templateHelpers.templates.getStartedOnEvernote"},getStartedPageMobile:{defaultMessage:"Getting started on mobile",id:"templateHelpers.templates.getStartedOnMobile"},readingList:{defaultMessage:"Reading List",id:"templateHelpers.templates.readingList"},taskList:{defaultMessage:"Task List",id:"templateHelpers.templates.taskList"},todoList:{defaultMessage:"To-do List",id:"templateHelpers.templates.todo"},journal:{defaultMessage:"Journal",id:"templateHelpers.templates.journal"},travelPlanner:{defaultMessage:"Travel Planner",id:"templateHelpers.templates.travelPlanner"},quickNote:{defaultMessage:"Quick Note",id:"templateHelpers.templates.quickNote"},blogPost:{defaultMessage:"Blog Post",id:"templateHelpers.templates.blogPost"},personalHome:{defaultMessage:"Personal Home",id:"templateHelpers.templates.personalHome"},userResearch:{defaultMessage:"User Research Database",id:"templateHelpers.templates.userResearchDatabase"},userResearchDescription:{defaultMessage:"Use this template to schedule and track the status of your user research.",id:"templateHelpers.templates.userResearchDatabase.description"},designSystem:{defaultMessage:"Design System",id:"templateHelpers.templates.designSystem"},designSystemDescription:{defaultMessage:"A design system is a great way to keep everyone aligned. Use this template to document design patterns, assets, and brand, and make assets downloadable for everyone on your team.",id:"templateHelpers.templates.designSystem.description"},engineeringWiki:{defaultMessage:"Engineering Wiki",id:"templateHelpers.templates.engineeringWiki"},engineeringWikiDescription:{defaultMessage:"Use this template to give engineering teams a single source of truth for processes, documentation, and projects, build good programming habits, and keep everyone aligned.",id:"templateHelpers.templates.engineeringWiki.description"},engineeringMeetingNotes:{defaultMessage:"Meeting Notes",id:"templateHelpers.templates.meetingNotes"},brandAssets:{defaultMessage:"Brand Assets",id:"templateHelpers.templates.brandAssets"},brandAssetsDescription:{defaultMessage:"This template makes it easy to keep track of brand assets like logos, images, and fonts by tagging them so they’re easily sortable by file type or application.",id:"templateHelpers.templates.brandAssets.description"},marketingWiki:{defaultMessage:"Marketing Wiki",id:"templateHelpers.templates.marketingWiki"},mediaList:{defaultMessage:"Media List",id:"templateHelpers.templates.mediaList"},mediaListDescription:{defaultMessage:"Use this template to follow news coverage of your company and the people reporting it. Subpages help you keep track of press details and more.",id:"templateHelpers.templates.mediaList.description"},contentCalendar:{defaultMessage:"Content Calendar",id:"templateHelpers.templates.contentCalendar"},contentCalendarDescription:{defaultMessage:"Use this template to schedule and track all the content you're putting out, from blog posts to podcasts to tweets.",id:"templateHelpers.templates.contentCalendar.description"},moodBoard:{defaultMessage:"Mood Board",id:"templateHelpers.templates.moodBoard"},moodBoardDescription:{defaultMessage:"Ideal template for assembling mood or inspiration boards for events, products, brand campaigns, and more.",id:"templateHelpers.templates.moodBoard.description"},jobBoard:{defaultMessage:"Job Board",id:"templateHelpers.templates.jobBoard"},jobBoardDescription:{defaultMessage:"Easily list and edit your company’s openings with this jobs templates that lets you make real-time changes to a lightweight, public-facing job site. ",id:"templateHelpers.templates.jobBoard.description"},newHireOnboarding:{defaultMessage:"New Hire Onboarding",id:"templateHelpers.templates.newHireOnboarding"},newHireOnboardingDescription:{defaultMessage:"Onboarding checklists help new hires get settled at your company. You can sort by status, team, and start date, and click into any individual card to review onboarding tasks and notes for that person.",id:"templateHelpers.templates.newHireOnboarding.description"},applicantTracker:{defaultMessage:"Applicant Tracker",id:"templateHelpers.templates.applicantTracker"},applicantTrackerDescription:{defaultMessage:"Manage candidate progress across the hiring cycle with this template that lets you easily view each candidate's information, notes, documents, offers, next steps, and more.",id:"templateHelpers.templates.applicantTracker.description"},companyHome:{defaultMessage:"Company Home",id:"templateHelpers.templates.companyHome"},companyHomeDescription:{defaultMessage:"Every company needs a place where important info is easy to find. This template gathers everything your company needs in order to run smoothly, from mission and values to the employee directory. ",id:"templateHelpers.templates.companyHome.description"},productWiki:{defaultMessage:"Product Wiki",id:"templateHelpers.templates.productWiki"},productWikiDescription:{defaultMessage:"Organize all your product-related documentation with this template, which unifies guides and processes in one place with easy-to-navigate sections.",id:"templateHelpers.templates.productWiki.description"},salesCRM:{defaultMessage:"Sales CRM",id:"templateHelpers.templates.salesCRM"},salesCRMDescription:{defaultMessage:"Your sales funnel doesn't have to feel like heavy SaaS software. This template offers you a clean canvas to define only the fields you need to track leads.",id:"templateHelpers.templates.salesCRM.description"},salesWiki:{defaultMessage:"Sales Wiki",id:"templateHelpers.templates.salesWiki"},salesWikiDescription:{defaultMessage:"With this template you can keep all your company’s sales documentation and projects in one place so crucial info is easy for anyone across the team or organization to find at a moment’s notice. ",id:"templateHelpers.templates.salesWiki.description"},competitiveAnalysis:{defaultMessage:"Competitive Analysis",id:"templateHelpers.templates.competitiveAnalysis"},salesAssets:{defaultMessage:"Sales Assets",id:"templateHelpers.templates.salesAssets"},salesAssetsDescription:{defaultMessage:"Use this template to keep your sales assets organized so you always use the proper demo, white paper, video, etc. for every meeting. You can upload any type of file to this page for instant access and version control.",id:"templateHelpers.templates.salesAssets.description"},productFAQs:{defaultMessage:"Product FAQs",id:"templateHelpers.templates.productFAQs"},productFAQsDescription:{defaultMessage:"Keep responses to your customers’ common support questions in one place for everyone to see. Every row of this template is its own Notion page, to which you can add any content you want.",id:"templateHelpers.templates.productFAQs.description"},helpCenter:{defaultMessage:"Help Center",id:"templateHelpers.templates.helpCenter"},helpCenterDescription:{defaultMessage:"This template lets you build your own help center, with columns, headings, and sub-pages. You can easily share this page with users and quickly add new support pages as needed.",id:"templateHelpers.templates.helpCenter.description"},classNotes:{defaultMessage:"Class Notes",id:"templateHelpers.templates.classNotes"},jobApplications:{defaultMessage:"Job Applications",id:"templateHelpers.templates.jobApplications"},gradeCalculator:{defaultMessage:"Grade Calculator",id:"templateHelpers.templates.gradeCalculator"},clubHomepage:{defaultMessage:"Club Homepage",id:"templateHelpers.templates.clubHomepage"},cornellNotesSystem:{defaultMessage:"Cornell Notes System",id:"templateHelpers.templates.cornellNotesSystem"},personalCRM:{defaultMessage:"Personal CRM",id:"templateHelpers.templates.personalCRM"},simpleBudget:{defaultMessage:"Simple Budget",id:"templateHelpers.templates.simpleBudget"},syllabus:{defaultMessage:"Syllabus",id:"templateHelpers.templates.syllabus"},classroomHome:{defaultMessage:"Classroom Home",id:"templateHelpers.templates.classroomHome"},lessonPlans:{defaultMessage:"Lesson Plans",id:"templateHelpers.templates.lessonPlans"},courseSchedule:{defaultMessage:"Course Schedule",id:"templateHelpers.templates.courseSchedule"},groupProjects:{defaultMessage:"Group Projects",id:"templateHelpers.templates.groupProjects"},classDirectory:{defaultMessage:"Class Directory",id:"templateHelpers.templates.classDirectory"},lifeWiki:{defaultMessage:"Life Wiki",id:"templateHelpers.templates.lifeWiki"},habitTracker:{defaultMessage:"Habit Tracker",id:"templateHelpers.templates.habitTracker"},hobbies:{defaultMessage:"Hobbies",id:"templateHelpers.templates.hobbies"},resume:{defaultMessage:"Resume",id:"templateHelpers.templates.resume"},resumeDescription:{defaultMessage:"Build a beautiful, functional resume within your Notion workspace, make it publicly accessible and send over the link with your job applications. You can keep improving the resume even after you send it out.",id:"templateHelpers.templates.resume.description"},teamsGettingStarted:{defaultMessage:"Teams Getting Started",id:"templateHelpers.templates.teamsGettingStarted"},teamsHomepage:{defaultMessage:"Teamspaces Home",id:"templateHelpers.templates.teamsHomepage"},wiki:{defaultMessage:"Team Wiki",id:"templateHelpers.templates.wiki"},notes:{defaultMessage:"Notes & docs",id:"templateHelpers.templates.notes"},projectManagement:{defaultMessage:"Project & tasks",id:"templateHelpers.templates.projectManagement"},suggested:{defaultMessage:"Suggested templates",id:"templateHelpers.personas.suggestedTemplates"},suggestedCategory:{defaultMessage:"Suggested",id:"templateGallery.sidebar.suggested"},teamHome:{defaultMessage:"Team Home",id:"templateHelpers.useCase.teamHome"},teamTasks:{defaultMessage:"Team Tasks",id:"templateHelpers.useCase.teamTasks"},teamMeetingNotes:{defaultMessage:"Meeting Notes",id:"templateHelpers.useCase.teamMeetingNotes"},teamDocs:{defaultMessage:"Docs",id:"templateHelpers.useCase.teamDocs"},peopleDirectory:{defaultMessage:"People Directory",id:"templateHelpers.useCase.peopleDirectory"},peopleDirectoryDescription:{defaultMessage:"Help your team keep track of who's who with this simple template. Each card can be updated to store an employee’s bio, past achievements, goals, and more. ",id:"templateHelpers.useCase.peopleDirectory.description"},employeeBenefits:{defaultMessage:"Employee Benefits",id:"templateHelpers.useCase.employeeBenefits"},employeeBenefitsDescription:{defaultMessage:"This template is a perfect place to describe your company’s benefits and link out to all necessary info so your employees feel appreciated and informed.",id:"templateHelpers.useCase.employeeBenefits.description"},recruitingTracker:{defaultMessage:"Recruiting Tracker",id:"templateHelpers.useCase.recruitingTracker"},recruitingTrackerDescription:{defaultMessage:"This template makes it easy for your company to keep up with your headcount, including job postings and relevant details like role, status, location, and more.",id:"templateHelpers.useCase.recruitingTracker.description"},investorUpdate:{defaultMessage:"Investor Update",id:"templateHelpers.useCase.investorUpdate"},investorUpdateDescription:{defaultMessage:"Instead of sending the usual disorganized email updates to your investors, use this template to offer them a more comprehensive and digestible look at your company’s progress.",id:"templateHelpers.useCase.investorUpdate.description"},designSprint:{defaultMessage:"Design Sprint",id:"templateHelpers.useCase.designSprint"},designSprintDescription:{defaultMessage:"This template is designed to help design teams continuously track and iterate on their projects, from creative sprints to finished projects based on user feedback.",id:"templateHelpers.useCase.designSprint.description"},visionAndStrategy:{defaultMessage:"Vision and strategy",id:"templateHelpers.useCase.visionAndStrategy"},visionAndStrategyDescription:{defaultMessage:"Use this template to put your organization’s guiding principles in one place so that they stay top of mind and easy for employees to reference.",id:"templateHelpers.useCase.visionAndStrategy.description"},designPortfolio:{defaultMessage:"Design Portfolio",id:"templateHelpers.useCase.designPortfolio"},designPortfolioDescription:{defaultMessage:"Use this template to showcase creative projects you’ve worked on and offer more context on their purpose and the development process you or your team followed.",id:"templateHelpers.useCase.designPortfolio.description"},teamWiki:{defaultMessage:"Team Wiki",id:"templateHelpers.useCase.teamWiki"},defaultWiki:{defaultMessage:"Wiki",id:"templateHelpers.useCase.wiki"},teamWikiDescription:{defaultMessage:"This template lets every team in your company create and manage a personalized homepage where they can organize processes, projects, and knowledge specific to their work.",id:"templateHelpers.useCase.teamWiki.description"},teamGoals:{defaultMessage:"Goals",id:"templateHelpers.useCase.teamGoals"},campaignBrief:{defaultMessage:"Campaign Brief",id:"templateHelpers.useCase.campaignBrief"},campaignBriefDescription:{defaultMessage:"Use this template to brief other team members on any given campaign’s goals, messaging, timeline, and more. You can also easily add any relevant supporting documents so everyone in the company stays well-informed. ",id:"templateHelpers.useCase.campaignBrief.description"},presentation:{defaultMessage:"Presentation",id:"templateHelpers.useCase.presentation"},presentationDescription:{defaultMessage:"Use this template to present new ideas and status updates to your team, organized in a way that’s easily updated and scannable. ",id:"templateHelpers.useCase.presentation.description"},experimentResults:{defaultMessage:"Experiment Results",id:"templateHelpers.useCase.experimentResults"},experimentResultsDescription:{defaultMessage:"Use this template to track your experiments along with their results. Anyone from any team can quickly add an experiment by using the database templates.",id:"templateHelpers.useCase.experimentResults.description"},engineeringTechSpec:{defaultMessage:"Engineering Tech Spec",id:"templateHelpers.useCase.engineeringTechSpec"},engineeringTechSpecDescription:{defaultMessage:"Use this template to organize a project kickoff and deliver the necessary context so team members are all up to speed and well-informed.",id:"templateHelpers.useCase.engineeringTechSpec.description"},productSpec:{defaultMessage:"Product Spec",id:"templateHelpers.useCase.productSpec"},productSpecDescription:{defaultMessage:"A product spec should contain all the info your team needs to build something new. Use this template as a source of truth to give context, set goals, see edge cases, and plan development steps.",id:"templateHelpers.useCase.productSpec.description"},interviewGuide:{defaultMessage:"Interview Guide",id:"templateHelpers.useCase.interviewGuide"},interviewGuideDescription:{defaultMessage:"Use this template to prepare your job candidates for their interviews and offer them helpful resources like videos, links, schedules and more.",id:"templateHelpers.useCase.interviewGuide.description"},brainstorm:{defaultMessage:"Remote Brainstorming",id:"templateHelpers.useCase.brainstorm"},brainstormDescription:{defaultMessage:"Boost your team's remote collaboration with this remote brainstorming template. Designed to streamline brainstorming sessions and maximize creativity using Notion’s new button and AI blocks. This template helps team members to generate brainstorming questions and effortlessly contribute ideas with just a click of a button. Use this template for seamless idea generation and action planning.",id:"templateHelpers.useCase.brainstorm.description"},oneOnOneNotes:{defaultMessage:"1:1 Notes",id:"templateHelpers.useCase.oneOnOneNotes"},oneOnOneNotesDescription:{defaultMessage:"This template is perfect for keeping all of your 1:1 notes and docs in one place. You can add dates to each meeting and even check off action items as the week progresses.",id:"templateHelpers.useCase.oneOnOneNotes.description"},productLaunchBrief:{defaultMessage:"Product Launch Brief",id:"templateHelpers.useCase.productLaunchBrief"},productLaunchBriefDescription:{defaultMessage:"Use this template to plan and execute every part of your launch with your team, in one, centralized page.",id:"templateHelpers.useCase.productLaunchBrief.description"},blogEditorialCalendar:{defaultMessage:"Blog Editorial Calendar",id:"templateHelpers.useCase.blogEditorialCalendar"},blogEditorialCalendarDescription:{defaultMessage:"Use this template to plan and write all your marketing content with a database that lets you track each project’s status, audience, author, reviewer, publish date, and more. ",id:"templateHelpers.useCase.blogEditorialCalendar.description"},socialMediaCalendar:{defaultMessage:"Social Media Calendar",id:"templateHelpers.useCase.socialMediaCalendar"},socialMediaCalendarDescription:{defaultMessage:"Use this template to draft, plan, and write all of your social posts in one simple database. You can view your own posts in a calendar to get an idea of timelines, or switch to a board view to see platform usage.",id:"templateHelpers.useCase.socialMediaCalendar.description"},simpleBudgetDescription:{defaultMessage:"Track your spending to reach your financial goals. Set a monthly cap for your spending, then enter your expenses in the database below. View your expenses in different ways using different database views.",id:"templateHelpers.useCase.simpleBudget.description"},readingListDescription:{defaultMessage:"The modern day reading list includes more than just books. We've created a dashboard to help you track all of the articles, videos, podcasts, blog posts, Twitter threads, and — yes, books.",id:"templateHelpers.useCase.readingList.description"},habitTrackerDescription:{defaultMessage:"Keep yourself accountable by tracking your habits everyday. With Notion's new button block, you can easily check off completed habits for the day with a single click. Whether you're trying to drink more water, exercise regularly, or meditate every day, this template will help you build healthy habits with ease.",id:"templateHelpers.useCase.habitTracker.description"},travelPlannerDescription:{defaultMessage:"Travel planning can be a fragmented mess with different documents and information everywhere. With this template, you can pull all the essential details about your plans into one spot.",id:"templateHelpers.useCase.travelPlanner.description"},jobApplicationsDescription:{defaultMessage:"Keep track of the entire job application process all in one page. Easily add customized resumes, cover letters, and portfolio's while keeping track of companies you've reached out to.",id:"templateHelpers.useCase.jobApplication.description"},weeklyPlan:{defaultMessage:"Weekly Plan",id:"templateHelpers.useCase.weeklyPlan"},weeklyPlanDescription:{defaultMessage:"Use this template to plan and organize all the work you need to accomplish over the next week. Visualize your most important to-do's with an agenda that helps you prioritize.",id:"templateHelpers.useCase.weeklyPlan.description"},weeklyTodo:{defaultMessage:"Weekly To-do List",id:"templateHelpers.useCase.weeklyTodo"},weeklyTodoDescription:{defaultMessage:"Use this template to plan and organize all the work you need to accomplish over the next week. Visualize your most important to-do's with an agenda that helps you prioritize.",id:"templateHelpers.useCase.weeklyTodo.description"},journalDescription:{defaultMessage:"Document your life - daily happenings, special occasions, and reflections on your goals. Categorize entries with tags and automatically capture the date.",id:"templateHelpers.useCase.journal.description"},quickNoteDescription:{defaultMessage:"This template gives you a sense of the many different types of content you can add while taking quick notes in any situation. It includes a to-do list, web bookmarks, sub-headings, and more!",id:"templateHelpers.useCase.quickNote.description"},personalHomeDescription:{defaultMessage:"Just like a wiki can help keep all the important information in a company somewhere central, a personal wiki can give you a helpful knowledge base for your life!",id:"templateHelpers.useCase.personalHome.description"},lifeWikiDescription:{defaultMessage:"Plan and keep track of your entire life with this comprehensive dashboard. Take charge of your growth with setting goals, tracking daily habits and maintaining a log of everything you're reading.",id:"templateHelpers.useCase.lifeWiki.description"},blogPostDescription:{defaultMessage:"Use this template as a format for your blog posts. Format your writing and images in any format you like. Make your page live by enable the 'Share to web' feature.",id:"templateHelpers.useCase.blogPost.description"},personalCRMDescription:{defaultMessage:"Keep track of all the people you meet, what you know about them, when to reach out, and whether they're a professional contact. Be the person who always follows up and knows the exact gift to give.",id:"templateHelpers.useCase.personalCRM.description"},classNotesDescription:{defaultMessage:"Keep all your notes from all your classes in one spot. This template makes it easy to capture all your notes and tag them by class, date, and topic.",id:"templateHelpers.useCase.classNotes.description"},classDirectoryDescription:{defaultMessage:"Put names to faces. Use this directory to track class participation, absences, and take any other notes that will be helpful when it comes time to calculate final grades or give feedback to students.",id:"templateHelpers.useCase.classDirectory.description"},clubHomepageDescription:{defaultMessage:"We know that school probably isn't just about school for you. Notion is the perfect solution for managing information for clubs, organizations, and group projects.",id:"templateHelpers.useCase.clubHomepage.description"},gradeCalculatorDescription:{defaultMessage:"Strategize your quarter or semester by knowing how much every assignment, exam, and project is worth for your final grade. Use this template to stay on top of your grades and plan accordingly.",id:"templateHelpers.useCase.gradeCalculator.description"},cornellNotesSystemDescription:{defaultMessage:"In the 1940s, Cornell Professor Walter Pauk developed a new note-taking system to give college students a better way to organize, condense, and intake knowledge. Here's the Notion version!",id:"templateHelpers.useCase.cornellNotesSystem.description"},syllabusDescription:{defaultMessage:"Create a digital syllabus that all your students can easily access on the web. Notion makes building a web page like this as easy as typing a document. Just replace this sample content with your own!",id:"templateHelpers.useCase.syllabus.description"},classroomHomeDescription:{defaultMessage:"Give your students one source of truth for class information, course materials, assignments, announcements, scheduling and more. Editing this web page is as easy as writing any document.",id:"templateHelpers.useCase.classroomHome.description"},lessonPlansDescription:{defaultMessage:"These lesson plans are based on Harvard Business School's Elements of Effective Class Preparation. This makes it easy to track their status, keep all related notes in one spot, and make progress.",id:"templateHelpers.useCase.lessonPlans.description"},classroomManagement:{defaultMessage:"Classroom Management",id:"templateHelpers.useCase.classroomManagement"},courseScheduleDescription:{defaultMessage:"This course schedule provides a comprehensive list of weekly topics, readings, assignments, and exams. You can create your own categories and topics for whatever you're teaching.",id:"templateHelpers.useCase.courseSchedule.description"},studentPlanner:{defaultMessage:"Student Planner",id:"templateHelpers.useCase.studentPlanner"},studentPlannerDescription:{id:"templateHelpers.useCase.studentPlanner.description",defaultMessage:"From your courses to your calendar, personal projects to club meetings and event, use this template to stay organized, focused, and inspired to have a successful school year."},scratchpad:{defaultMessage:"Scratchpad",id:"templateHelpers.private.scratchpad"},aiUpgrade:{defaultMessage:"Getting Started with Notion AI",id:"templateHelpers.private.aiUpgrade"},websiteBuilder:{defaultMessage:"Website Builder",id:"templateHelpers.private.websiteBuilder"},research:{defaultMessage:"Research",id:"templateHelpers.private.research"}});(0,o().YK)({creative:{id:"teamHelpers.creativeTeam.name",defaultMessage:"Creative"},support:{id:"teamHelpers.supportTeam.name",defaultMessage:"Customer Service"},educator:{id:"teamHelpers.educatorTeam.name",defaultMessage:"Educator"},eng:{id:"teamHelpers.engTeam.name",defaultMessage:"Engineering"},finance:{id:"teamHelpers.financeTeam.name",defaultMessage:"Finance"},founder_or_ceo:{id:"teamHelpers.founderCeoTeam.name",defaultMessage:"Executive"},hr:{id:"teamHelpers.hrTeam.name",defaultMessage:"Human Resources"},internal_communication:{id:"teamHelpers.internalCommunicationTeam.name",defaultMessage:"Internal Communication"},it_admin:{id:"teamHelpers.itAdminTeam.name",defaultMessage:"IT Admin"},knowledge_management:{id:"teamHelpers.knowledgeManagementTeam.name",defaultMessage:"Knowledge Management"},marketing:{id:"teamHelpers.marketingTeam.name",defaultMessage:"Marketing"},operations:{id:"teamHelpers.operationsTeam.name",defaultMessage:"Operations"},product_design:{id:"teamHelpers.productDesignTeam.name",defaultMessage:"Product Design"},product:{id:"teamHelpers.productTeam.name",defaultMessage:"Product Management"},project_or_program_management:{id:"teamHelpers.projectProgramMgmtTeam.name",defaultMessage:"Project / Program Management"},sales:{id:"teamHelpers.salesTeam.name",defaultMessage:"Sales"},student:{id:"teamHelpers.studentTeam.name",defaultMessage:"Student"},other:{id:"teamHelpers.otherTeam.name",defaultMessage:"Your Team"}}),(0,o().YK)({generalTeamLabel:{defaultMessage:"General",id:"teamHelpers.generalTeam.name"},personaTeamDescription:{id:"teamHelpers.personaTeam.description",defaultMessage:"A home for you and your team"},workspaceNameHq:{defaultMessage:"{workspaceName} HQ",id:"templateMessages.workspaceNameHQ"}})},551345:(e,t,n)=>{n.d(t,{VN:()=>l,or:()=>a,pV:()=>r});var o=()=>n(120114),i=()=>n(430483),s=()=>n(508496);function a(e){const{configurationState:t}=e;return t.deepFindRequested&&i().zD.isDeepFindEnabled()}function r(e){const{configurationState:t,assistantSurface:n}=e;return a({configurationState:t})&&n.isType("fullPage")}function l(){const e=i().zD.state;return(0,o().AX)(e,(e=>s().default.getConfigKey("deep_find_config",e)),(e=>s().default.checkGate({gateName:e})))}new(n(496506).default)((()=>{var e;const t=i().zD.isDeepFindEnabled(),o=Boolean(null===(e=n(295169).default.getActiveAssistantConfigurationState())||void 0===e?void 0:e.deepFindRequested);return t&&o}),{debugName:"isDeepFindActiveStore"})},577466:(e,t,n)=>{n.d(t,{B:()=>s});var o=()=>n(401497),i=()=>n(100622);function s(e){return(0,o().IS)((t=>({wrapper:{background:e?(0,i().qh)(e,t).color:t.surface.wash,borderRadius:5,padding:"8px 12px",userSelect:"none",width:"100%"}})),[e])}},585515:(e,t,n)=>{n.d(t,{T:()=>A});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(430670),n(803949),n(581454),n(908872);var o=()=>n(496603),i=()=>n(763824),s=()=>n(534177),a=()=>n(700500),r=()=>n(452540),l=()=>n(792071),d=()=>n(577449),c=()=>n(212547),u=()=>n(388821),p=()=>n(696706),m=()=>n(912720),g=()=>n(199378),f=()=>n(179034),h=()=>n(519831),y=()=>n(869558),v=()=>n(343666),b=()=>n(197959),x=()=>n(37165),S=()=>n(144081),M=()=>n(919709);async function A(e,t,n){var A;const{isServerMultiCellRequest:C,shouldTraverseToggleBlocks:I,loadButtonBlockChildren:T,omitAncestorDependencies:_}=e;let P;const B={};P=e.cursor?o().mg(e.cursor.stack):[];const R=e.page.id,L=e.limit,D=e.batchLoadChildren??!1,O=e.contentBatchSize??25,N=u().RecordMap.create();0===P.length&&P.push([{table:f().ev,id:R,index:0,spaceId:e.page.spaceId}]);let E=0,U=0;const F=d().h.throughRecordMap(N,t),V=async(e,t)=>{if(!e.length)return u().RecordMap.create();const{sameCellPointers:n,crossCellPointers:i}=await H(e);for(const[o,s]of Object.entries(i))B[o]??=new Map,s.forEach((e=>{B[o].set(e.id,e)}));U+=n.length;const a=await F(n),l=o().hS([...a].map((e=>{let{model:t}=e;return t})).filter(s().O9).flatMap((e=>G(e))),r().jV);if(t){const e=o().hS([...a].map((e=>{let{model:t}=e;return t})).filter(s().O9).flatMap((e=>Y(e))),r().jV);_?await Promise.all([V(l,!1),V(e,!0)]):await V(e.concat(l),!0)}else await V(l,!1);return a},K=d().h.fromLoadRecords((e=>V(e,!0))),H=async e=>{if(C&&!C.isMainCell){const{spaceCellObjects:t,mainDbObjects:n}=await C.groupValueContainingRecordPointerByCell(e,(e=>e),((e,t)=>{t.spaceId=e})),o=t[C.currentCellId]??[];return delete t[C.currentCellId],o.push(...n),{sameCellPointers:o,crossCellPointers:t}}return{sameCellPointers:e,crossCellPointers:{}}},z=new Set,W=(e,t)=>t.filter((e=>{let[t,n]=e;const o=(0,r().jV)(t);return!z.has(o)&&(z.add(o),!0)})).map((t=>{let[o,i,s]=t;return n&&n({table:e.table,id:e.id},o,i,s),o})),G=function(e){const t=[];if((0,c().A0)(e)){const n=e.getParentPointer();t.push([n,"Block parent_id"])}return W(e,t)},Y=function(t){const n=[];function o(t,o){M().air(t,{spaceId:o,inlinePageLink:e}).forEach((e=>{n.push([e,"text token mention",{suppressErrorOnClient:!0}])}))}if(t.table===f().ev){const e=t.getCollectionViewPointers();for(const t of e)n.push([t,"CollectionViewBlock view_id"]);if(t.type===a().xd.form){const e=t.getLayoutPointer();e&&n.push([e,"Form layout"])}const i=t.getCollectionPointer();i&&n.push([i,"CollectionViewBlock collection_id"]);const s=t.getDiscussionPointers();for(const t of s)n.push([t,"Discussion"]);const r=t.getProperties().title;if((0,a().Db)(t.getType(),t.getFormat())&&r&&o(r,t.spaceId),t.getType()===a().xd.alias){const e=t.getAliasTargetPointer();e&&n.push([e,"alias"])}else if(t.isExternalObjectInstanceType()){const e=t.getExternalObjectSubInstancePointers();for(const t of e)n.push([t,"eoi"])}else if(t.getType()===a().xd.button){const e=t.getAutomationPointer();e&&n.push([e,"button_automation"])}}else if(t.table===b().$Y){if(!t.getResolved()){for(const e of t.getCommentPointers())n.push([e,"discussion table comment"]);for(const e of t.getReactionPointers())n.push([e,"discussion table reaction"])}}else if(t.table===v().SN){const e=t.getCreatedByPointer();e&&n.push([e,"comment table author"]);const i=t.getText();i&&o(i,t.spaceId);for(const o of t.getContentPointers())n.push([o,"comment table attachment"]);for(const o of t.getReactionPointers())n.push([o,"comment table reaction"])}else if(t.table===y().Gy){const e=t.getFormatStore().getKeyStore("collection_pointer").getValue();e&&n.push([e,"CollectionView collection_id"])}else if(t.table===S().zx){if("form"===t.getLayoutType()){const e=t.getRawModules().form_layout_schema||[];for(const o of e)"formQuestion"===o.type&&n.push([{table:x().lo,id:o.formQuestionId,spaceId:t.spaceId},"Form question"])}else{const e=t.getBlockChildren();for(const t of e)n.push([{table:f().ev,id:t},"Layout dependent block"])}}else if(t.table===m().yB){const e=t.getActionPointers();for(const t of e)n.push([t,"Automation action_ids"])}else if(t.table===g().SC)for(const e of t.getBlocks())n.push([{table:f().ev,id:e},"Automation action blocks"]);else if(t.table===h().Vl){for(const i of t.getAutomationPointers())n.push([i,"Collection automation_ids"]);const e=t.getLayoutPointer();e&&n.push([e,"Collection layout"]);const o=t.getSharingEnabledRelationTargetPointer();o&&n.push([o,"Sharing-enabled relation target collection"])}return W(t,n)},q=new Map,$=[],Q=async function(){const t=[],o=P[P.length-1];if(E>=L&&U>10*L||U>20*L||!o)return!1;const i=o.map((e=>{const{table:t,id:n,spaceId:o}=e;return p().L3.fromPointerLike({table:t,id:n,spaceId:o})})),s=await K(i),r=[];for(let n=0;n<o.length;n++){const i=o[n],u=s.getModel(p().L3.fromPointerLike(i));if(!u||u.table!==f().ev)continue;const m=u.isType(a().xd.button)&&T?j(u,l().b4_.fromRecordMap(N)):null==u?void 0:u.getContentIds(),g=null==u?void 0:u.getFormat();if(!e.verticalColumns&&u&&m&&"column_list"===u.type&&0===i.index){for(let e=0;e<m.length;e++){const n=m[e],o=u.spaceId;r.push([{table:f().ev,id:n,spaceId:o},i,"column"]),t.push({table:f().ev,id:n,index:0,spaceId:o})}i.index=m.length}else if(u&&"transclusion_reference"===u.type&&g&&g.transclusion_reference_pointer&&0===i.index)r.push([g.transclusion_reference_pointer,i,"transclusion reference"]),t.push({...g.transclusion_reference_pointer,index:0}),i.index=1;else if(m&&((0,a().IU)(u.type,g)||u.isType(a().xd.button)&&T)&&(u.id===R&&1===P.length||!(0,a().NC)(u.type)&&(!(0,a().BN)(u.type,g)||I))&&m[i.index]){if(D){var d;const e=w(O,i.index);if(null===(d=q.get(u.id))||void 0===d||!d.has(e)){var c;for(const t of k(m.map((e=>({table:f().ev,id:e}))),O,e))r.push([t,i,"block content child"]);q.has(u.id)||q.set(u.id,new Set),null===(c=q.get(u.id))||void 0===c||c.add(e)}}else{const e=m[i.index];r.push([{table:f().ev,id:e,spaceId:u.spaceId},i,"block content child"])}t.push({table:f().ev,id:m[i.index],index:0,spaceId:u.space_id}),i.index++}}const u=r.map((e=>{let[t,o,i]=e;return n&&n(o,t,i),t}));await K(u),r.forEach((e=>{if("block content child"===e[2]){const t=e[0],n=N.getModel(t);if(n&&n instanceof l().zgg&&!n.alive){const e=N.getModel({id:n.parent_id,table:n.parent_table,spaceId:n.spaceId});e&&e instanceof l().zgg&&e.alive&&e.getContentIds().includes(n.id)&&$.push(n.pointer)}}}));const m=t.filter((e=>{for(let t=0;t<P.length;t++){const n=P[t];for(let t=0;t<n.length;t++){const o=n[t];if(o.table===e.table&&o.id===e.id)return!1}}return!0}));return m.length>0?(P.push(m),E++):P.pop(),!0};for(;await Q(););if(null===(A=e.performFixForQuasiAliveBlock)||void 0===A||A.call(e,$),C){const t={},n=await i().lX(P,20,(async e=>await C.groupValueContainingRecordPointerByCell(e,(e=>p().L3.fromPointerLike({id:e.id,table:e.table,spaceId:e.spaceId})),((e,t)=>{t.spaceId=e}))));for(const{spaceCellObjects:e,mainDbObjects:i}of n){if(i.length>0){const e=C.currentCellId;t[e]??={stack:[]},t[e].stack.push(i)}for(const[n,o]of Object.entries(e))t[n]??={stack:[]},t[n].stack.push(o)}const o=e.cursor.stack.reduce(((e,t)=>(t.forEach((t=>{e[t.id]=t})),e)),{});for(const[e,i]of Object.entries(B)){t[e]??={stack:[]};Array.from(i.values()).map((e=>{const t=o[e.id];return{...e,index:t?t.index:0}})).forEach((n=>{t[e].stack.push([n])}))}const s=Object.keys(t).map((e=>({...t[e],cellId:e})));return{recordMap:N,cursorValue:{stack:[]},cursorValueCellularized:s}}return{recordMap:N,cursorValue:{stack:P},cursorValueCellularized:[]}}function w(e,t){return Math.trunc(t/e)}function*k(e,t,n){const o=Math.min(n*t,e.length-1),i=Math.min((n+1)*t,e.length);for(let s=o;s<i;s++)yield e[s]}function j(e,t){const n=e.getAutomationPointer();if(!n)return[];const o=t(n);if(!o)return[];return o.getActionPointers().map((e=>t(e))).filter(s().O9).flatMap((e=>e.getBlocks()))}},592680:(e,t,n)=>{n.r(t),n.d(t,{AppComponents:()=>kp});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(257615),r=()=>n(430923),l=()=>n(774733),d=()=>n(645873);const c=new(d().O2)("desktop",(async()=>{const[{Notification:e},{default:t}]=await Promise.all([n.e(7097).then(n.bind(n,15121)),n.e(7097).then(n.bind(n,91063))]);return{Notification:e,ElectronContextMenu:t}})),u=(0,d()._h)(c,(e=>e.ElectronContextMenu));var p=()=>n(896780),m=()=>n(347845),g=(n(898992),n(354520),()=>n(919709)),f=()=>n(496603),h=()=>n(901997),y=()=>n(98244),v=()=>n(751156),b=()=>n(928600),x=()=>n(897119),S=()=>n(722872),M=()=>n(231722),A=()=>n(333665),w=()=>n(486666),k=()=>n(962730),j=()=>n(377586),C=()=>n(797162),I=()=>n(24157),T=()=>n(97270),_=()=>n(355802),P=n(474848);function B(){const e=(0,i().Y0)(),{open:t,filter:n,emojiTextStore:a,popupOpen:r,originRect:l,alwaysShowPopup:d}=(0,s().K8)((()=>{const e=T().A.state,t=e.open;if(!t)return{open:t,popupOpen:!1};const n=function(e){if(!e.textStore)return;return A().vD(e.textStore,e.oldTextValue,!0)}(e)||"",{textStore:o,showPopupWithEmptyFilter:i,selectionRect:s}=e,a=Boolean(i);return{open:t,filter:n,emojiTextStore:o,popupOpen:n.length>0||a,originRect:s,alwaysShowPopup:a}}),[]),{textMode:c,prevChar:u,singleTextSelectionStore:p}=(0,s().K8)((()=>{var e;const t=I().default.state,{mode:n}=t;if("editing"!==n)return{mode:n};const{multiSelection:o}=t,i=g().qAZ(o.start.store.getValue());return{textMode:n,prevChar:i?i[o.start.index-1]:void 0,singleTextSelectionStore:null===(e=(0,M().H7)(o))||void 0===e?void 0:e.store}}),[]),m=(0,s().K8)((()=>C().A.state.open),[]);return(0,o.useEffect)((()=>{t&&!m&&("editing"!==c||!n&&":"!==u||p!==a||void 0===n||":"===n||n.startsWith(" ")||n.includes("\n"))&&y().VN()}),[a,n,m,t,u,p,c]),(0,P.jsx)(x().Ay,{popupType:e.isMobileNative&&!e.isTablet?j().n.SlideUp:j().n.Popup,open:r,originRect:l,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:L,render:()=>(0,P.jsx)(R,{open:t,filter:n||"",alwaysShowPopup:d}),keepFocus:!0})}function R(e){let{open:t,filter:n,alwaysShowPopup:s}=e;const a=(0,i().v3)(),r=(0,i().Y0)(),l=(0,o.useRef)(null),d=r.isMobileNative&&!r.isTablet?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:w().jv,onClickOutside:y().VN};const c=(0,o.useMemo)((()=>f().sg((e=>{h().P$(a,{searchQuery:e})}),500)),[a]);return t?!Boolean(s)&&n.length<1?null:(0,P.jsx)(b().A,{innerRef:l,...d,children:(0,P.jsx)(_().p,{filter:n,onSubmit:e=>D(e,a),onNoResults:function(){if(!t)return;if(!n||0===n.length)return;const e=n.charAt(n.length-1);e&&(/\s/g.test(e)?y().VN():c(n))},isCallout:!1,menuRef:l,isInline:!0,onUpload:{onComplete:e=>{D(e,a)}}})}):null}function L(){y().VN()}function D(e,t){v().createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:t,canUndo:!0,perform:n=>{y().Ju({environment:t,emoji:e,transaction:n})}})}var O=()=>n(592678),N=(n(944114),n(581454),()=>n(813206)),E=()=>n(584262),U=()=>n(416504),F=()=>n(921997),V=()=>n(959044),K=()=>n(959013),H=()=>n(848259),z=()=>n(449506),W=()=>n(705540),G=()=>n(780054),Y=()=>n(909470),q=()=>n(299545),$=()=>n(941541),Q=()=>n(179534),Z=()=>n(524450),X=()=>n(351360),J=()=>n(508496),ee=()=>n(865241),te=()=>n(630116),ne=()=>n(477293);function oe(e,t){const n=(0,s().K8)((()=>t?null==e?void 0:e.userId:void 0),[t,null==e?void 0:e.userId]),a=(0,s().K8)((()=>ee().A.state.isVisible),[]),r=(0,K().tz)(),l=(0,i().v3)(),d=(0,o.useRef)(),c=(0,o.useRef)(),u=(0,o.useRef)(-1),p=(0,o.useCallback)((()=>{const{mobileNative:e}=l,{allSpaces:t,currentSpace:n}=ie();e&&(t===d.current&&n===c.current||e.setBadgeNumber(t,n),c.current=n),t!==d.current&&(t>0?W().setBadge(`${t}`):W().setBadge("")),d.current=t}),[l]),m=(0,o.useMemo)((()=>f().Oo(p)),[p]),g="on"===(0,ne().r)("inbox_activity_split"),h=(0,o.useCallback)((async(t,n)=>{if(n===u.current||!e)return;if(u.current=n,!function(e){if(0===Q().A.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(n)))return;const o=J().default.checkGate({gateName:"multi_cell_get_user_notifications"}),i=await(async e=>{let t=[];if(o){const n=z().callMultiCellApi({eventName:"getUserNotifications",environment:l,data:{size:1e3,isInboxV2:!0,splitInboxActivity:g,markNotificationsAsReceived:e},headers:{}});for await(const e of n)"success"===e.type&&t.push(...e.data.results)}else{const n=await z().callApi({eventName:"getUserNotifications",environment:l,data:{size:1e3,isInboxV2:!0,splitInboxActivity:g,markNotificationsAsReceived:e}});if("failed"===n.type)return[];t=n.data.results}return t})(a);Q().A.setState({results:i}),m();const s=f().KC.apply(null,i.map((e=>e.unreceived.notificationIds)));for(const a of s)se(a,e,r,l)}),[e,m,l,g,r,a]);(0,o.useEffect)((()=>{a&&h("visibilityChange",u.current)}),[a,h]);const y=(0,o.useMemo)((()=>f().nF(h,1e3)),[h]);(0,o.useEffect)((()=>{if(!n)return;let e;const t=e=>{let{key:t,value:n}=e;Z().A.whenActive((()=>{y(t,n)}))};if(n){const o=(0,F().dp)(n);e=$().Ay.addListener(o,void 0,t,void 0,l),h("initializeListener",-1)}return Q().A.addListener(p),l.mobileNative&&X().default.addListener(p),()=>{e&&$().Ay.removeListener(e,l),Q().A.addListener(p),l.mobileNative&&X().default.removeListener(p)}}),[n,l,h,y,p])}function ie(){const e="on"===J().default.getGroup("inbox_activity_split")?"comments":"mentions";return{allSpaces:Q().A.getTotalUnreadCountForType(e),currentSpace:Q().A.getUnreadCountForCurrentSpace()[e]??0}}async function se(e,t,n,o){const i=(0,te().Oo)(t,{table:V()._p,id:e});await i.load();const s=i.getKeyStore("activity_id").getValue(),a=i.getKeyStore("space_id").getValue();if(!a||!s)return;const r=(0,q().jA)(i,s,a);await r.load();const l=r.getModel(),{currentUserStore:d,currentSpaceViewStore:u}=X().default.state;if(d&&u&&l&&!l.invalid&&!N().zP(l,d.id)&&await W().isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await u.load(),!u.isDefined())return;if(!l.isMentionType())return;if("reacted"===l.getType())return;if(!u.getNotifyDesktop())return;if(!o.device.isDesktop)return;const e=(0,(await c.load()).Notification)({activity:l,getRecordValue:i.getRecordValue,userTimeZone:(0,U().P)(),intl:n,pageVisitSource:E().y8.PushNotification,recipientUser:d.getModel(),experimentService:J().default,collectionFeatureGates:(0,Y().i)()});if(!e)return;const{subject:t,body:s}=e,a=new Notification(t,{body:s,silent:!0}),p=N().JT(l.type),m={medium:"desktop_push",type:p,badge_number:ie().allSpaces,notification_id:i.id,activity_id:r.id},g=e=>H().Gj({environment:o,args:m,action:e});g("sent"),a.addEventListener("show",(()=>g("shown"))),a.addEventListener("close",(()=>g("closed"))),a.addEventListener("click",(()=>{const e=N().KP({activity:l,getRecordModel:i.getRecordModel,baseUrl:G().A.domainBaseUrl,pageVisitSource:E().y8.PushNotification}),t=(0,E().p3)(e,[p,"desktop_push"],E().y8.PushNotification);W().openNotificationUrl(t,o),g("clicked")}))}}const ae=new(d().O2)("linkMenu",(()=>n.e(4586).then(n.bind(n,323779)))),re=(0,d()._h)(ae,(e=>e.default)),le=new(d().O2)("message-store-debug-panel",(async()=>await n.e(64199).then(n.bind(n,572107)))),de=(0,d()._h)(le,(e=>e.MessageStoreDebugPanel));var ce=()=>n(971320);function ue(){return(0,s().K8)((()=>ce().A.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,P.jsx)(de,{}):null}var pe=()=>n(187174),me=()=>n(386164),ge=()=>n(534177),fe=()=>n(37433);function he(e){let{environment:t}=e;const{currentSpaceViewStore:n,currentSpaceStore:o,currentUserStore:i}=X().default.state,s=null==n?void 0:n.getUserId(),a=null==n?void 0:n.getSpaceId(),r={readyForHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0,spaceViewSpaceId:void 0};return null!=n&&n.isDefined()&&n.getAlive()&&n.canRead()&&s&&a?function(){const{spaceTransitionStatus:e}=X().default.state;switch(e){case"notTransitioning":return!1;case"joiningOrCreatingSpace":case"switchingToOrLoadingSpace":return!0;default:(0,ge().HB)(e)}}()||t.currentUser.id!==s||(null==i?void 0:i.id)!==s||(null==o?void 0:o.id)!==a?r:(0,fe().isPersonalHomeEnabledForUser)()?{readyForHomePagesRequest:!0,spaceViewId:n.id,spaceViewUserId:s,spaceViewSpaceId:a}:r:r}const ye=(0,f().sg)(z().callApi,1e3,{leading:!0,trailing:!0}),ve=function(){const e=(0,i().v3)(),t=(0,s().K8)((()=>he({environment:e})),[e]);return(0,pe().Yb)((async()=>{t.readyForHomePagesRequest&&await ye({eventName:"getUserHomePages",environment:e,data:{spaceViewId:t.spaceViewId,spaceId:t.spaceViewSpaceId},userId:t.spaceViewUserId,headers:(0,me().WS)({cellId:void 0,recordId:t.spaceViewId,spaceId:t.spaceViewSpaceId})})}),[e,t.readyForHomePagesRequest,t.spaceViewId,t.spaceViewUserId,t.spaceViewSpaceId]),null};var be=()=>n(362749),xe=()=>n(171510),Se=()=>n(793531),Me=()=>n(205682),Ae=()=>n(77238),we=()=>n(93658),ke=()=>n(263928),je=()=>n(634157);function Ce(){const e=(0,i().v3)(),{currentSpaceStore:t}=(0,s().O$)(X().default),n=e.currentUser.id,a=(0,s().K8)((()=>null==t?void 0:t.id),[t]);return(0,o.useEffect)((()=>{if(!a||!n)return;const t=$().Ay.addListener((0,F().Li)({userId:n,spaceId:a}),void 0,(async t=>{let{value:o}=t;(function(e){var t;let{spaceId:n,userId:o,emitValue:i}=e;const s=null===(t=je().A.getUserJoinedTeamsState({userId:o,spaceId:n}))||void 0===t?void 0:t.lastEmitValue;if(s===i)return!1;if(void 0===s&&je().A.getHasFetched({userId:o,spaceId:n}))return!1;return!0})({spaceId:a,userId:n,emitValue:o})&&await ke().u({environment:e,spaceId:a,userId:n,emitValue:o});const i=je().A.getUserJoinedTeamsState({userId:n,spaceId:a});i&&je().A.setUserJoinedTeamsState({userId:n,spaceId:a,state:{...i,lastEmitValue:o}})}),void 0,e);return function(){t&&$().Ay.removeListener(t,e)}}),[e,n,a]),null}var Ie=()=>n(195795),Te=()=>n(401497),_e=()=>n(66913),Pe=()=>n(133033),Be=()=>n(284371),Re=()=>n(296511),Le=()=>n(725614),De=()=>n(921855),Oe=()=>n(792540),Ne=()=>n(836251),Ee=()=>n(24973),Ue=()=>n(285790),Fe=()=>n(859428),Ve=()=>n(524702);const Ke=(0,K().YK)({learnTooltip:{defaultMessage:"Learn more about alt text",id:"altTextMenuPopup.helpButton.tooltip"}});function He(){const e=(0,i().v3)(),{device:t}=e,n=(0,K().tz)(),a=(0,Te().IS)((e=>({wrapper:{padding:t.isMobile?16:12,display:"flex",flexDirection:"column",fontSize:t.isMobile?Be().J.UIRegular.mobile:Be().J.UIRegular.desktop,wordBreak:"break-word",maxHeight:t.isMobile?"35vh":"200px",overflowY:"auto"},closeButton:{borderRadius:"100%",width:22,height:22,float:"right",marginLeft:8},input:{marginTop:t.isMobile?16:12,padding:t.isMobile?"8px 12px":"4px 10px",width:"100%",borderRadius:6,boxShadow:e.inputBoxShadow,background:e.surface.page,cursor:"text",overflowX:"hidden"},helpText:{color:e.text.secondary,display:"inline"},helpButton:{marginLeft:2,display:"inline-flex",position:"absolute",transform:t.isMobile?void 0:"translateY(-1px)"}})),[t.isMobile]),{altTextStore:r,altText:l,canEdit:d}=(0,s().K8)((()=>{const e=Ee().A.state.blockStore;return{altTextStore:null==e?void 0:e.getPropertyStore("alt_text"),altText:e?(0,De().r4)(null==e?void 0:e.getPropertyValue("alt_text"),e):void 0,canEdit:(null==e?void 0:e.canEdit())&&!(null!=e&&e.isNavigableAncestorNonEditableState())}}),[]);return(0,o.useEffect)((()=>{r&&Le().setSelectionAtEnd({store:r})}),[r]),(0,P.jsx)(b().A,{menuType:t.isMobile?S().gu.ActionSheet:S().gu.Popup,width:t.isMobile?"100vw":310,children:(0,P.jsxs)("div",{style:a.wrapper,children:[(0,P.jsxs)("div",{children:[(0,P.jsx)(Ue().A,{style:a.closeButton,hovered:!0,icon:_e().V,onClick:()=>Re().V(e),ariaLabel:n.formatMessage({id:"altTextMenuPopup.closeButton",defaultMessage:"Close"})}),d?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:a.helpText,children:(0,P.jsx)(K().sA,{id:"altTextMenuPopup.description",defaultMessage:"Add alt text to describe this image. This makes your page more accessible to people who are vision-impaired or blind"})}),(0,P.jsx)(Fe().A,{renderTooltip:()=>n.formatMessage(Ke.learnTooltip),render:e=>(0,P.jsx)(Ue().A,{ariaLabel:n.formatMessage(Ke.learnTooltip),icon:Pe().$,external:!0,href:(0,Ne().xS)("guides.altText"),style:a.helpButton,isLightIconColor:!0,...e})})]}):l]}),d&&r&&(0,P.jsx)(Ve().A,{store:r,disabled:!1,pasteBehavior:"plaintext",style:a.input,placeholderStyle:a.input,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableInsertText:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:()=>Re().V(e),onEsc:()=>Re().V(e),onTab:()=>!0,placeholder:n.formatMessage({id:"altTextMenuPopup.placeholder",defaultMessage:"Add alt text..."}),inPageFind:Oe().Os.none})]})})}const ze=function(){const e=(0,i().v3)(),{device:t}=e,n=(0,Te().IS)((e=>({popup:{background:e.altTextPopupBackground,borderTopLeftRadius:t.isMobile?12:6,borderTopRightRadius:t.isMobile?12:6,left:t.isMobile?0:8}})),[t.isMobile]),{open:o,originRect:a}=(0,s().K8)((()=>{const{open:e}=Ee().A.state;return e?{open:e,originRect:Ee().A.state.originRect}:{open:e,originRect:void 0}}),[]);return(0,P.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:o,originRect:a,originGap:8,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.End,onDismiss:()=>Re().V(e),render:()=>(0,P.jsx)(He,{}),sameWidthAsOrigin:!1,style:n.popup,trapFocus:!0})};var We=()=>n(112873),Ge=()=>n(963589),Ye=()=>n(517223),qe=()=>n(644914),$e=()=>n(737230),Qe=()=>n(372154),Ze=()=>n(700500),Xe=()=>n(273321),Je=()=>n(555776),et=()=>n(116008),tt=()=>n(756279),nt=()=>n(344051),ot=()=>n(545805),it=()=>n(480095),st=()=>n(13679),at=()=>n(987017);const rt=[Qe().c.Open,Qe().c.Resolved];const lt=function(e){let{discussionIds:t,blockStore:o,recursivelyLoadAllDiscussions:a,tab:r,property_id:l}=e;const d=(0,i().v3)(),{resolved:c,unresolved:u}=(0,s().K8)((()=>{const e=q().Bw(o,{recursivelyLoadAllDiscussions:a,includePropertyDiscussions:!0}).filter((e=>{if(t&&!t.includes(e.id)&&!q().j3(e))return!1;return!Boolean(l)||e.getPropertyId()===l})).sort(((e,t)=>t.getReactionStores().length-e.getReactionStores().length)),{resolved:n,unresolved:i}=q().uy(e);return{resolved:n,unresolved:i}}),[o,a,t,l]),{device:p}=d;let m;return m=p.isMobile?{menuType:S().gu.Modal,title:(0,P.jsx)(K().sA,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:(0,P.jsx)(pt,{tab:r,resolved:c,unresolved:u}),right:(0,P.jsx)(it().DoneMenuText,{}),onClickRight:We().xl,whiteBackground:!0}:{menuType:S().gu.Popup,header:(0,P.jsx)(pt,{tab:r,resolved:c,unresolved:u}),width:480,maxHeight:"50vh",onClickOutside:We().xl},(0,P.jsx)(n(700180).A,{capture:!0,preventType:tt().A.All,children:(0,P.jsx)(n(297872).A,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,P.jsx)(ot().A,{debugName:"BlockDiscussionMenu",capture:!0,onEsc:We().xl,onBackspace:ut,onDelete:ut,children:(0,P.jsx)(st().A,{store:o,droppable:!0,render:()=>(0,P.jsx)(b().A,{...m,children:(0,P.jsx)(gt,{tab:r,blockStore:o,resolved:c,unresolved:u})})},o.id)})})})};function dt(e){let{message:t}=e;const n=(0,i().v3)(),{device:o}=n,s=(0,Te().IS)((e=>({emptyState:{textAlign:"center",padding:o.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:e.text.secondary}})),[o.isMobile]);return(0,P.jsx)("div",{style:s.emptyState,children:t})}function ct(e){const t=Qe().A.state;t.open&&Qe().A.setState({...t,tab:rt[e]})}function ut(e){null==e||e.preventDefault(),We().xl()}function pt(e){let{tab:t,resolved:n,unresolved:o}=e;const s=(0,i().v3)(),{device:a}=s,r=o.length,l=n.length,d=(0,Te().IS)((e=>({openCountStyle:{color:e.text.tertiary},resolvedCountStyle:{color:e.text.quaternary}})),[]);return 0===l||0===r?null:(0,P.jsx)(at().Ay,{tabs:[(0,P.jsxs)("div",{children:[(0,P.jsx)(K().sA,{defaultMessage:"Open",id:"blockDiscussionMenu.openDiscussionsTab.title"},"openDiscussionsTitle")," ",(0,P.jsx)("span",{style:d.openCountStyle,children:r})]},"openDiscussions"),(0,P.jsxs)("div",{children:[(0,P.jsx)(K().sA,{defaultMessage:"Resolved",id:"blockDiscussionMenu.resolvedDiscussionsTab.title"},"resolvedDiscussionsTitle")," ",(0,P.jsx)("span",{style:d.resolvedCountStyle,children:l})]},"resolvedDiscussions")],selectedIndex:rt.indexOf(t),onChange:ct,style:{...a.isAndroid&&{borderBottom:"none"}}})}function mt(e){const{value:t}=(0,d().fJ)(l().commentsDependency),n=(0,i().v3)(),o=(0,s().K8)((()=>et().A.state.open&&Je().A.state.overlapsExistingDiscussionMenu),[]),a=(0,s().K8)((()=>Qe().A.state.open&&Qe().A.state.tab===Qe().c.Open),[]),r=(0,s().K8)((()=>Qe().A.state.open&&Qe().A.state.keepNewDiscussionAtBottom),[]),c=(0,s().K8)((()=>(et().A.state.open&&Je().A.state.overlapsExistingDiscussionMenu)??!1),[]);if(0===e.discussionStores.length)return null;const u=r?e.discussionStores[0]:void 0;return(0,P.jsxs)(P.Fragment,{children:[t&&e.discussionStores.slice(u?1:0).map(((n,o,i)=>(0,P.jsx)(l().PW,{store:n,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:0===o,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:We().xl},n.id))),u&&t&&(0,P.jsx)(l().PW,{store:u,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:1===e.discussionStores.length,isOnly:1===e.discussionStores.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:We().xl},u.id),o&&a&&(0,P.jsx)(Xe().A,{environment:n,shouldShowTopDividerLine:!0,shouldExpandDiscussionWidth:c,noBackgroundColors:!0})]})}function gt(e){let{tab:t,blockStore:n,resolved:a,unresolved:r}=e;const c=(0,Te().DP)(),u=(0,i().v3)(),{device:p}=u,m=(0,s().K8)((()=>n.getType()),[n]),g=(0,s().K8)((()=>nt().B(n)),[n]),{value:f}=(0,d().fJ)(l().commentsDependency);if(!f)return null;if(t===Qe().c.Open){if(r.length){const e=m&&(0,ge().O)(Ze().kt,m);return p.isMobile&&e&&g?(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${c.regularDividerColor}`,marginBottom:1},children:(0,P.jsx)(g,{store:n,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),(0,P.jsx)(mt,{discussionStores:r,blockStore:n})]}):(0,P.jsx)(mt,{discussionStores:r,blockStore:n})}return(0,P.jsx)(dt,{message:(0,P.jsx)(K().sA,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return a.length?(0,P.jsx)(mt,{discussionStores:a,blockStore:n}):(0,P.jsx)(dt,{message:(0,P.jsx)(K().sA,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}const ft=function(){const e=(0,i().v3)(),{device:t}=e,a=(0,s().K8)((()=>Qe().A.state.rect),[]),r=(0,s().K8)((()=>{if(!Qe().A.state.open)return!1;let t=!1;const o=Qe().A.state.property_id;if(Qe().A.state.open&&o){var i;const e=null===(i=Qe().A.state.blockStore)||void 0===i||null===(i=i.getAssociatedCollectionStore())||void 0===i?void 0:i.getLayoutStore();e&&(t=(0,Ye().Hc)({layoutStore:e,propertyId:o}).isPropertyInPageDetails)}const s=(0,n(835066).$N)(e,Qe().A.state.blockStore);return!!t||($e().Ay.state.currentTab!==$e().tF.Comments||!(0,qe().Nk)(e))&&!s}),[e]),l=(0,o.useCallback)((()=>{We().xl()}),[]),d=(0,o.useCallback)((()=>{if(Qe().A.state.open)return(0,P.jsx)(lt,{tab:Qe().A.state.tab,blockStore:Qe().A.state.blockStore,discussionIds:Qe().A.state.discussionIds,recursivelyLoadAllDiscussions:Qe().A.state.recursivelyLoadAllDiscussions,property_id:Qe().A.state.property_id})}),[]),c=(0,Ge().X)("comment_sidebar_for_you");return(0,P.jsx)(x().Ay,{popupType:t.isMobile?c?j().n.BottomSheet:j().n.SlideUp:j().n.Popup,bottomSheetInitialState:"half",open:r,originRect:a,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Center,disableMouseCapture:!0,originGap:4,render:d,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:l,trapFocus:!0})};var ht=()=>n(925193),yt=()=>n(847832),vt=()=>n(857639),bt=()=>n(356596),xt=()=>n(129518),St=()=>n(541372),Mt=()=>n(178658),At=()=>n(938987),wt=()=>n(949575),kt=()=>n(945710),jt=()=>n(352097),Ct=()=>n(310770),It=()=>n(390849),Tt=()=>n(931871),_t=()=>n(989423),Pt=()=>n(186445),Bt=()=>n(38337),Rt=()=>n(495159),Lt=()=>n(972435),Dt=()=>n(430483),Ot=()=>n(84349),Nt=()=>n(525569),Et=()=>n(502438),Ut=()=>n(760217),Ft=()=>n(939740),Vt=()=>n(89924);const Kt=(0,K().YK)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"},pasteItem:{defaultMessage:"Paste",id:"blockPasteMenu.actions.paste.label"},suggestedActionsSectionTitle:{defaultMessage:"Suggested actions",id:"blockPasteMenu.actions.suggestedActionsSectionTitle"}});const Ht=function(){const e=(0,i().Y0)(),t=(0,i().v3)(),a=(0,s().O$)(Ot().A),{stores:r,phase:l}=(0,s().O$)(Et().default);(0,o.useEffect)((()=>{a.open&&((0,n(821062).A)(r,a.blocks)&&l===Et().SelectionPhase.Selected||St().VN(t))}),[a,r,l,t]);const d=(0,o.useCallback)((()=>{St().VN(t)}),[t]),c=a.open&&"ai_actions"===a.type;return(0,P.jsx)(x().Ay,{popupType:e.isMobileNative&&!e.isTablet?j().n.SlideUp:j().n.Popup,open:a.open,originRect:a.open?a.rect:void 0,placementToOrigin:c?k().W.Right:k().W.Bottom,alignmentToOrigin:c?k().C.Start:k().C.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,P.jsx)(Wt,{}),onDismiss:d,disableFlippingPlacement:c})};function zt(e){const{menuItemProps:t}=e,{isMobile:n}=(0,i().Y0)(),o=(0,s().O$)(Dt().ts),a=n?{mobileIconStyle:o?{marginLeft:18,marginRight:2}:void 0}:{};return(0,P.jsx)(Ut().A,{...t,title:Lt().A.formatMessage(Rt().VT.askAI),icon:(0,P.jsx)(At().H2,{}),...a})}function Wt(){const e=(0,i().v3)(),t=(0,Te().DP)(),{device:n}=e,o=(0,s().K8)((()=>{const n=Ot().A.state;return n.open?"ai_actions"===n.type?function(e,t,n){var o;const i=(0,Pt().ao)();if(!i)return null;const s=(0,wt().clientSkillToAssistantSurfaceAction)((0,kt().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),a={type:"entrypoint",entrypoint:"blockPasteMenu",isMobile:t.device.isMobile,pageStore:i,selectionState:Et().default.state,textSelectionState:I().default.state,userSettings:null===(o=X().default.state.currentUserSettingsStore)||void 0===o?void 0:o.getSettings()},r=(0,wt().filterAssistantSurfaceActionsForContext)(s,a),l=(0,Ct().d7)({assistantSuggestionContext:a,validatedActions:r}).filter(kt().isAssistantSurfaceActionWithClientSkill),d=(0,wt().clientSkillToAssistantSurfaceAction)(l),c=(0,ht().gC)();return[{key:"ai_actions_paste_menu",render:e=>(0,P.jsx)(Vt().A,{...e,title:Lt().A.formatMessage(Kt.suggestedActionsSectionTitle)}),items:[{key:"paste",render:e=>(0,P.jsx)(Ut().A,{...e,icon:(0,P.jsx)(xt().O1,{svg:bt().K}),title:Lt().A.formatMessage(Kt.pasteItem)}),action:()=>{(0,_t().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"paste"}}}),St().VN(t)}},...d.map((e=>({key:e.skillType,render:t=>(0,P.jsx)(Ut().A,{...t,title:Lt().A.formatMessage(Tt().DZ.writerGlobalSkill,{displayName:Lt().A.formatMessage(e.displayName),acceptsParameters:(0,yt().yH)(e.skillType)||(0,yt().SH)(e.skillType)}),icon:(0,P.jsx)(xt().O1,{svg:e.icon,svgFill:(0,jt().vJ)(e.category).color(n).color})}),action:async()=>{try{(0,_t().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"client_skill",skill_type:e.skillType}}}),St().VN(t),await(0,Mt().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c});const n=Nt().default.state;if(!n||"assistantCompletionPopup"!==n.type||"initialPrompt"!==n.stage)return;await It().assistantWriterActions.triggerAssistantSkillCompletion({environment:t,context:n.context,clientSkillWithParameterValues:(0,kt().dangerouslyCreateClientSkillWithParameterValues)(e),updater:Nt().default.createUpdater(),sessionId:c,from:"block_paste_menu",assistantSurfaceType:t.device.isMobile?"mobileWriter":"writer"})}catch{vt().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantSkillCompletionError",error:{message:"Error triggering assistant skill completion"},data:{miscDataToConvertToString:{skillType:e.skillType}}})}}}))),{key:"ask_ai",render:e=>(0,P.jsx)(zt,{menuItemProps:e}),action:async()=>{try{(0,_t().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"ask_ai"}}}),St().VN(t),await(0,Mt().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c})}catch{vt().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantWriterError",error:{message:"Error opening assistant writer"}})}}}]}]}(0,e,t):"blocks"===n.type||"links"===n.type?function(e,t){const{blocks:n}=e,{currentSpaceStore:o}=X().default.state,i=[];if("blocks"===e.type){const{copiedStores:s,pageSource:a}=e;St().GV({currentSpaceId:null==o?void 0:o.id,blocks:n,copiedStores:s})&&i.push({name:Lt().A.formatMessage(Kt.createTransclusion),action:async()=>{(0,_t().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"create_transclusion"}}}),await St().Ce({environment:t,blocks:n,copiedBlockIds:s.map((e=>e.id))})}}),St().h8({blocks:n})&&i.push({name:Lt().A.formatMessage(Kt.linkToPage),action:async()=>((0,_t().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),St().Xw({environment:t,blocks:n,source:{type:"blocks",copiedStores:s,pageSource:a}}))})}return"links"===e.type&&i.push({name:Lt().A.formatMessage(Kt.linkToPage),action:async()=>((0,_t().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),St().Xw({environment:t,blocks:n,source:{type:"links",copiedLinks:e.copiedLinks}}))}),[{key:"embed section",render:e=>(0,P.jsx)(Vt().A,{...e}),items:[{key:"dismiss",render:e=>(0,P.jsx)(Ut().A,{...e,title:Lt().A.formatMessage(Kt.dismissItem)}),action:()=>{(0,_t().u4)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"dismiss"}}}),St().VN(t)}},...i.map((e=>{let{name:t,action:n}=e;return{key:`embed ${t}`,render:e=>(0,P.jsx)(Ut().A,{...e,title:t}),action:n}}))]}]}(n,e):void(0,ge().HB)(n):null}),[e,t]);if(null===o)return null;let a;return a=n.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:320,maxHeight:"40vh"},(0,P.jsx)(b().A,{...a,className:Bt().poM,children:(0,P.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,sections:o,initialFocus:0})})}var Gt=()=>n(673898),Yt=()=>n(623580),qt=()=>n(125565);const $t=function(){const e=(0,i().v3)(),{device:t}=e,{active:n,stringValue:o}=(0,s().K8)((()=>{const{active:e,stringValue:t}=Gt().A.state;return{active:e,stringValue:t}}),[]),a=window.innerWidth/2-150,r=window.innerHeight/2,l=t.isMobileNative?(0,P.jsx)(K().sA,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,P.jsx)(K().sA,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,P.jsx)(x().Ay,{popupType:t.isMobileNative?j().n.SlideUp:j().n.Popup,open:n,originRect:{top:r,left:a},onDismiss:Qt,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:0,render:()=>(0,P.jsx)(ot().A,{debugName:"ClipboardInputRenderer",capture:!0,onEnter:f().D_,onCommandEnter:f().D_,onCommandShiftEnter:f().D_,onCommandSlash:f().D_,onDelete:f().D_,onBackspace:f().D_,onEsc:f().D_,onLeft:f().D_,onRight:f().D_,onUntab:f().D_,onTab:f().D_,onSelectAll:f().D_,onRedo:f().D_,onUndo:f().D_,onToggleBold:f().D_,onToggleItalics:f().D_,onToggleStrike:f().D_,onToggleCode:f().D_,onCut:f().D_,onCopy:f().D_,onPaste:f().D_,onKeypress:f().D_,children:(0,P.jsxs)("div",{style:{padding:8,width:300},children:[(0,P.jsx)(Yt().A,{style:{width:"100%",fontSize:12},value:o,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,P.jsx)(qt().A,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:l})]})})})};function Qt(){Gt().A.setState({...Gt().A.state,active:!1,stringValue:""})}var Zt=()=>n(509111),Xt=()=>n(588264),Jt=()=>n(861841),en=()=>n(269380),tn=()=>n(177158);const nn=function(){const e=(0,s().O$)(Jt().Hf);return(0,P.jsx)(tn().A,{open:e,children:(0,P.jsx)(on,{})})};function on(){const e=(0,s().O$)(Jt().Ay),t=(0,s().K8)((()=>function(){const e=Jt().Ay.state;if(!e.isDragging)return;const{startX:t,startY:n,currentX:o,currentY:i}=e;return{position:"absolute",top:0,left:0,transform:`translate3d(${o-t}px, ${i-n}px, 0)`}}()),[]);if(!e.isDragging)return null;const n=e.draggedStores.map(((t,n)=>(0,P.jsx)("div",{children:e.ghostElements[n].map(((e,t)=>(0,P.jsx)(en().A,{element:e},t)))},n)));return(0,P.jsx)("div",{style:t,children:n})}var sn=()=>n(887480),an=()=>n(605402);const rn=function(){const e=(0,i().v3)(),{currentSpaceStore:t}=(0,s().K8)((()=>({currentSpaceStore:X().default.state.currentSpaceStore})),[]);return(0,o.useEffect)((()=>{if(!t)return;const o=$().Ay.addListener((0,F().On)(t.id),void 0,(async o=>{let{value:i}=o;if(!an().A.shouldRefetch({currentSpaceId:t.id,emitValue:i}))return;const s=await z().callApi({eventName:"getAllSpacePermissionGroupsWithMemberCount",environment:e,data:{spaceId:t.id},headers:(0,me().WS)({cellId:void 0,spaceId:t.id})});if("failed"===s.type)return vt().rateLimitedLog({from:"CurrentSpacePermissionGroupsListener",level:"error",type:"getAllCurrentSpacePermissionGroupsFailed"}),[];an().A.setState({permissionGroupsAndMemberCounts:s.data.groupsWithMemberCount.map((e=>({group:n(792071).Bj6.fromValue("space_permission_group",e.group),memberCount:e.memberCount}))),lastEmitData:{spaceId:t.id,value:i}})}),void 0,e);return function(){o&&$().Ay.removeListener(o,e)}}),[t,e]),null};n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var ln=()=>n(486130);const dn=function(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n}=(0,s().O$)(X().default),a=null==n?void 0:n.id;return(0,o.useEffect)((()=>{if(!t||!a)return;const n=$().Ay.addListener((0,F().yp)({spaceId:t.id,userId:a}),void 0,(async n=>{let{value:o}=n;if(!ln()._.shouldRefetch({spaceId:t.id,userId:a,emitValue:o}))return;const i=await z().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:e,data:{spaceId:t.id,userIds:[a]},headers:(0,me().WS)({cellId:void 0,spaceId:t.id})});if("failed"===i.type)return vt().rateLimitedLog({from:"CurrentUserSpaceGroupMembershipListener",level:"error",type:"getSpacePermissionGroupIdsContainingMembers"}),[];const s=ln()._.getState();ln()._.setState({...s,[a]:{...s[a],[t.id]:{spacePermissionGroupIds:new Set(i.data.userToGroupMap[a]||[]),lastEmitValue:o}}})}),void 0,e);return function(){n&&$().Ay.removeListener(n,e)}}),[t,a,e]),null};var cn=()=>n(666144),un=()=>n(245865),pn=()=>n(423219);function mn(e){const{environment:t,pointers:n,userIdToCloneFrom:o}=e;for(const i of n)cn().PC({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:i,model:t.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:i,userId:o}),role:"reader",updatePaths:[[]],debugSource:"CustomEmojisListener"})}const gn=new(n(99895).G)((()=>0));const fn=function(){const e=(0,i().v3)(),[t,a]=(0,o.useState)(!1);(0,o.useEffect)((()=>{!async function(){await n(571963).waitForInitialPageRenderToComplete(),a(!0)}()}),[]);const r=(0,s().K8)((()=>{var e;return null===(e=(0,n(87878).vZ)())||void 0===e?void 0:e.id}),[]),l=e.currentUser.id,d=(0,s().K8)((()=>{const e=pn().A.getKeys();return r&&l?e.includes(r)?e:[...e,r]:e}),[r,l]);return function(e,t){const n=(0,i().v3)();(0,o.useEffect)((()=>{const o=gn.get(e)+1;gn.set(e,o);const i=()=>{};Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:`useRetainRecordsInMemory(${e} ${o})`});for(const e of t)n.defaultRecordCache.inMemoryRecordCache.addListenerToRecord(e,i),un().cancelEviction({pointer:e,userId:n.currentUser.id});return()=>{for(const e of t)n.defaultRecordCache.inMemoryRecordCache.removeListenerToRecord(e,i),un().unsubscribeAfterDelay({environment:n,pointer:e,userId:n.currentUser.id})}}),[e,n,t])}("CustomEmojis",(0,s().K8)((()=>{if(!t)return[];const n=[];for(const t of d){const o=pn().A.getDataWithoutRefetch(e,{spaceId:t});if(!o)continue;const i=o.pointers,s=o.lastFetchedBy;t===r&&s!==l&&mn({environment:e,pointers:i,userIdToCloneFrom:s}),n.push(...i)}return n}),[d,r,l,e,t])),function(e){const t=(0,i().v3)();(0,o.useEffect)((()=>{const n=[];for(const o of e){const e=$().Ay.addListener((0,F().VW)(o),void 0,(e=>{let{value:t}=e;pn().A.emit({spaceId:o},t)}),void 0,t);e&&n.push(e)}return()=>{for(const e of n)$().Ay.removeListener(e,t)}}),[t,e])}(d),null};var hn=()=>n(597777),yn=()=>n(220719),vn=()=>n(743336),bn=()=>n(319975),xn=()=>n(536131);const Sn=function(){const e=(0,i().v3)(),{device:t}=e,n=(0,s().O$)(xn().A);return(0,P.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:n.open,originRect:n.originRect,onDismiss:vn().V,render:()=>(0,P.jsx)(Mn,{shouldShowReminder:!!n.open&&n.allowReminders}),trapFocus:!0})};function Mn(e){let{shouldShowReminder:t}=e;const n=(0,i().v3)(),o=(0,s().K8)((()=>An()),[]);if(!o)return null;const a="default",{date_format:r,time_format:l,dateValue:c}=o;return(0,P.jsx)(d().u2,{dependency:p().cm,children:e=>{let{DatePropertyMenu:o}=e;return(0,P.jsx)(o,{firstDayOfWeek:Pt().XX.state,value:c,canConfigureCollection:!0,onChangeValue:e=>function(e,t,n){if(!e)return void function(e,t){const n=An();if(!n)return;const{textStore:o,textValue:i,tokenIndex:s}=n,a=g().AhH(i.slice(0,s)),r=g().AhH(i.slice(0,s+1));v().createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,canUndo:!0,perform:t=>{bn().jQ({environment:e,store:o,selection:{startIndex:a,endIndex:r},transaction:t})}})}(t);if(!hn().kC(e))return;const o=An();if(!o)return;const{date_format:i,time_format:s}=o;wn({date_format:i,time_format:s,...e},t,n)}(e,n,a),dateFormat:r,onChangeDateFormat:e=>function(e,t,n){const o=An();if(!o)return;const{dateValue:i,time_format:s}=o;wn({date_format:e,time_format:s,...i},t,n)}(e,n,a),timeFormat:l,onChangeTimeFormat:e=>function(e,t,n){const o=An();if(!o)return;const{dateValue:i,date_format:s}=o;wn({date_format:s,time_format:e,...i},t,n)}(e,n,a),onDismiss:vn().V,disabled:!1,shouldShowReminder:t,isTemplatePage:!1})}})}function An(){const e=xn().A.state;if(e.open){const{textStore:t,tokenIndex:n}=e,o=t.getValue();if(o){const e=o[n];if(e){(0,yn().MX)(g().qXl(e),"Token should be a mention token");const i=g().uPN(e),s=g().$CJ(i);if(s){const{date_format:a,time_format:r,...l}=g().K7D(s);return{textStore:t,textValue:o,tokenIndex:n,token:e,annotations:i,date_format:a,time_format:r,dateValue:l}}}}}}function wn(e,t,n){const o=An();if(!o)return;const{textStore:i,textValue:s,tokenIndex:a,token:r,annotations:l}=o,d=l.map((t=>g().qsB(t)?["d",e]:t)),c=g().Ey_(r[0],d),u=g().AhH(s.slice(0,a)),p=g().AhH(s.slice(0,a+1));v().createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,canUndo:!0,perform:e=>{bn().jQ({environment:t,store:i,selection:{startIndex:u,endIndex:p},transaction:e}),bn().yr({environment:t,store:i,tokens:[c],index:u,transaction:e}),J().default.checkGate({gateName:"mobile_clear_selection_on_date_mention_menu_change_kill_switch"})||Le().clear({environment:t})}})}n(737550);var kn=()=>n(852507),jn=()=>n(90023),Cn=()=>n(304740),In=()=>n(861017),Tn=()=>n(179034),_n=()=>n(720665),Pn=()=>n(437219),Bn=()=>n(131581),Rn=()=>n(664133),Ln=()=>n(108944);const Dn={quip:"Quip",evernote:"Evernote",workflowy:"Workflowy",monday:"Monday",confluence:"Confluence",trello:"Trello"},On=(Object.values(Dn),[{name:Dn.quip,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.quip\\.com)\\/(?<docId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}]),Nn=[{name:Dn.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/shard\\/(?<shardId>[^\\/]+)\\/nl\\/(?<userId>[^\\/]+)\\/(?<noteId>[a-zA-Z0-9]+)\\/?(?:.*)?$"},{name:Dn.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\?b=(?<notebookId>[^&]+)&n=(?<noteId>[^&]+)$"},{name:Dn.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\/note\\/(?<noteId>[a-f0-9-]+)(?:\\?.*)?$"}],En=[{name:Dn.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/s\\/(?<shareId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"},{name:Dn.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/#\\/(?<nodeId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"}],Un=[{name:Dn.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/views\\/(?<viewId>\\d+)\\/?(?:.*)?$"},{name:Dn.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/?(?:.*)?$"},{name:Dn.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/items\\/(?<itemId>\\d+)\\/?(?:.*)?$"}],Fn=[{name:Dn.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/pages\\/(?<pageId>\\d+)\\/(?<pageTitle>[^\\/?#]+)\\/?(?:.*)?$"},{name:Dn.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/?(?:.*)?$"}],Vn=[{name:Dn.trello,attributes:[],regex:"^(?<site>https:\\/\\/trello\\.com)\\/b\\/(?<boardId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}],Kn={[Dn.quip]:On,[Dn.evernote]:Nn,[Dn.workflowy]:En,[Dn.monday]:Un,[Dn.confluence]:Fn,[Dn.trello]:Vn};function Hn(e){if(!e||"string"!=typeof e)return{type:"failure"};for(const[t,n]of Object.entries(Kn))for(const o of n)if(new RegExp(o.regex).test(e)&&zn(t))return{type:"success",importName:t,pattern:o};return{type:"failure"}}function zn(e){return Object.values(Dn).some((t=>t===e))}var Wn=()=>n(176106),Gn=()=>n(666803),Yn=()=>n(404141),qn=()=>n(160475),$n=()=>n(464708),Qn=()=>n(802790),Zn=()=>n(331542),Xn=()=>n(515918);const Jn=(0,K().YK)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed Excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Maps",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),eo=(0,K().YK)({mentionPage:{defaultMessage:"Mention",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention",id:"embedMenu.actions.mentionBlock.title"},createLinkedViewOfDatabase:{defaultMessage:"Linked database view",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Bookmark",id:"embedMenu.actions.createBookmark.title"},newBookmarkMenuItem:{defaultMessage:"Preview",id:"embedMenu.actions.createNewBookmark.title"},createTransclusionItem:{defaultMessage:"Synced block",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"URL",id:"embedMenu.actions.dismiss.title"},linkMention:{defaultMessage:"Mention",id:"embedMenu.actions.linkMention.title"},pagePreview:{defaultMessage:"Preview",id:"embedMenu.actions.pagePreview.title"},embed:{defaultMessage:"Embed",id:"embedMenu.actions.embed.title"}}),to="3rd party import section",no={image:Lt().A.formatMessage(Jn.image),video:Lt().A.formatMessage(Jn.video),tweet:Lt().A.formatMessage(Jn.tweet),drive:Lt().A.formatMessage(Jn.drive),gist:Lt().A.formatMessage(Jn.gist),figma:Lt().A.formatMessage(Jn.figma),invision:Lt().A.formatMessage(Jn.invision),abstract:Lt().A.formatMessage(Jn.abstract),framer:Lt().A.formatMessage(Jn.framer),whimsical:Lt().A.formatMessage(Jn.whimsical),mixpanel:Lt().A.formatMessage(Jn.mixpanel),miro:Lt().A.formatMessage(Jn.miro),sketch:Lt().A.formatMessage(Jn.sketch),excalidraw:Lt().A.formatMessage(Jn.excalidraw),replit:Lt().A.formatMessage(Jn.replit),audio:Lt().A.formatMessage(Jn.audio),maps:Lt().A.formatMessage(Jn.maps),loom:Lt().A.formatMessage(Jn.loom),typeform:Lt().A.formatMessage(Jn.typeform),codepen:Lt().A.formatMessage(Jn.codepen),pdf:Lt().A.formatMessage(Jn.pdf),embed:Lt().A.formatMessage(Jn.embed),hex:Lt().A.formatMessage(Jn.hex),deepnote:Lt().A.formatMessage(Jn.deepnote),drawing:Lt().A.formatMessage(Jn.drawing)};const oo=function(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,s().O$)(Wn().A);return(0,P.jsx)(x().Ay,{popupType:t.isMobileNative&&!t.isTablet?j().n.SlideUp:j().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:t.isMobile,keepFocus:t.isMobile,render:()=>n.loading?(0,P.jsx)(Zn().A,{}):(0,P.jsx)(mo,{}),onDismiss:()=>io(e)})};function io(e){const t=Wn().A.state;if(!t.open)return;const{url:n}=t;Pn().ol(e,{url:n,type:"close"}),Bn().VN()}function so(e,t){const n=Wn().A.state;if(!n.open)return;const{url:o}=n;Bn().Ju({environment:t,type:e}),"form"!==e&&Pn().ol(t,{url:o,type:e})}function ao(e){let{environment:t,isImportExperimentEnabled:n,importType:o}=e;return n?{key:to,render:e=>(0,P.jsx)(Vt().A,{...e}),items:[{key:"import",render:e=>(0,P.jsx)(ro,{environment:t,importType:o,menuItemProps:e}),action:()=>function(e,t){let n;(0,qn().t)({environment:e,action:"click",from:"paste_link"}),t&&(n=function(e){switch(e){case"Evernote":return"evernote";case"Monday":return"monday";case"Confluence":return"confluence";case"Trello":return"trello";case"Workflowy":return"workflowy";case"Quip":return"quip";default:return}}(t)),Yn().A.setState({...Yn().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:n,openedFrom:"link_paste"}),Bn().VN()}(t,o)}]}:null}function ro(e){let{environment:t,importType:n,menuItemProps:o}=e;return(0,kn().w)((()=>{(0,qn().t)({environment:t,action:"view",from:"paste_link"})})),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Qn().A,{size:4}),(0,P.jsx)(Ut().A,{...o,title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(K().sA,{id:"embedMenu.actions.import.title",defaultMessage:"Import from {importType}",values:{importType:n}}),(0,P.jsx)($n().A,{style:{marginLeft:4,display:"inline"},color:"blue",content:(0,P.jsx)(K().sA,{id:"embedMenu.actions.pasteAsImport.title",defaultMessage:"Recommended"})})]})})]})}function lo(e,t,n){const{device:o}=t,{url:i,textStore:s}=e,{currentSpaceStore:a}=X().default.state,r=[],l=(0,In().parseRoute)({url:i,baseUrl:G().A.domainBaseUrl,publicDomainName:G().A.publicDomainName,isMobile:o.isMobile,protocol:G().A.protocol,currentUrl:window.location.href}),d=["youtube.com","youtu.be","instagram.com","twitter.com","x.com","facebook.com","linkedin.com","pinterest.com","tiktok.com","spotify.com","maps.google.com","drive.google.com","docs.google.com","slides.google.com","sheets.google.com","forms.google.com","indify.co","open.spotify.com","music.youtube.com","figma.com","amazon","wikipedia.org","medium.com","naver.com","canva.com","miro.com","reddit.com","calendly.com","forms.gle"],c=s.getRecordStoreUIParent(),u="page"===l.name?l.blockId:"team"===l.name?l.peekViewBlockId:void 0,p="page"===l.name&&l.scrollToBlockId,m="page"===l.name?l.collectionViewId:void 0;if(u){const e=te().Bv.createChildStore(s,{table:Tn().ev,id:u});e.isType("form")&&r.push({name:Lt().A.formatMessage(eo.embed),validator:()=>!Bn().en(s)&&po(c)&&(null==a?void 0:a.id)===e.getSpaceId(),type:Ze().xd.form});const t=p?te().Bv.createChildStore(s,{table:Tn().ev,id:p}):void 0;r.push({name:Lt().A.formatMessage(eo.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!Bn().en(s)&&(!e.isCollectionViewPageWithContent()||!function(e,t){const n=e.getCollectionViewStores(),o=f().I6(n,(e=>e.id===t&&"page"===e.getType()));return Boolean(o)}(e,m))&&!function(e,t){const n=e.getCollectionViewStores(),o=f().I6(n,(e=>e.id===t&&"form_editor"===e.getType()));return Boolean(o)}(e,m)&&(null==a?void 0:a.id)===e.getSpaceId()&&po(c)&&uo(e),type:Ze().xd.collectionView}),r.push({name:Lt().A.formatMessage(void 0===t?eo.mentionPage:eo.mentionBlock),validator:()=>uo(e),type:"mention-page"}),r.push({name:Lt().A.formatMessage(eo.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!Bn().en(s)&&!t.isNonEditableState()&&!t.isNavigableAncestorNonEditableState()&&t.canEdit()&&t.getSpaceId()===(null==a?void 0:a.id)&&po(c)&&uo(e)),type:"create-transclusion"}),J().default.checkGate({gateName:"enable_page_previews"})&&r.push({name:Lt().A.formatMessage(eo.pagePreview),validator:()=>!t&&!e.isCollectionView()&&!Bn().en(s)&&uo(e)&&po(c)&&!e.isType("form"),type:"page-preview"})}const g=_n().HP(no);for(const f of g)"embed"!==f&&r.push({name:no[f],validator:e=>Cn().dA[f](e)&&po(c),type:f});r.push({name:Lt().A.formatMessage(eo.bookmarkMenuItem),validator:e=>!Bn().en(s)&&po(c)&&Cn().Vp(e),type:Ze().xd.bookmark}),r.push({name:no.embed,validator:e=>!Bn().en(s)&&po(c)&&Cn().dA.embed(e),type:"embed"});const h=f().oE(r.map((e=>{let{name:n,validator:o,type:s}=e;if(o({url:i,baseUrl:G().A.domainBaseUrl,publicDomainName:G().A.publicDomainName})){return{key:`embed ${n}`,render:e=>(0,P.jsx)(Ut().A,{...e,title:n}),action:()=>so(s,t)}}}))),y={key:"link-mention",render:e=>(0,P.jsx)(Ut().A,{...e,title:Lt().A.formatMessage(eo.linkMention)}),action:()=>so("link-mention",t)},v={key:"dismiss",render:e=>(0,P.jsx)(Ut().A,{...e,title:Lt().A.formatMessage(eo.dismissItem)}),action:()=>io(t)};if(0===h.length)return[];(0,In().Jx)(l)?h.push(v):(co(i,d)?("embed Create bookmark"!==h[0].key||h.reverse(),h.push(v)):h.unshift(v),J().default.checkGate({gateName:"enable_link_mentions"})&&h.splice(0,0,y));const b={key:"embed section",render:e=>(0,P.jsx)(Vt().A,{...e}),items:h},x={key:"import section",render:e=>(0,P.jsx)(Vt().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:[{key:"jira-sync",render:e=>(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Qn().A,{size:4}),(0,P.jsx)(Ut().A,{...e,title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(K().sA,{id:"embedMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,P.jsx)(Xn().A,{style:{display:"inline"}})]})})]}),action:()=>function(e){var t,n;const o=Wn().A.state;if(!o.open)return;const{url:i}=o,s=X().default.state.mainEditorCurrentBlockStore,a=s&&(null===(t=(0,Ln().Uo)(s))||void 0===t?void 0:t.id),r=null===(n=i.match(/\/projects\/(\w+)\//))||void 0===n?void 0:n[1];Gn().Ay.setState({...Gn().Ay.state,teamSpaceId:a,projectKeys:r?[r]:[]}),Rn().jh({environment:e,from:"external_object_instance_block",action:"show_teamspaces"}),(0,_t().u4)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",flowId:Gn().Ay.createNewFlowId(),from:"link_paste_menu"}}}),Bn().VN(),Pn().ol(e,{url:i,type:"jira-sync"})}(t)}]},S=Hn(i),M="success"===S.type?S.importName:void 0,A=ao({environment:t,isImportExperimentEnabled:n,importType:M});return co(i,["atlassian.net/jira","/jira/"])?[b,x]:n&&function(e){return"success"===Hn(e).type}(i)&&A?[b,A]:[b]}function co(e,t){return t.some((t=>e.includes(t)))}function uo(e){const t=e.getSystemBlockTypeStore().getValue();return!(0,jn().xm)(t)}function po(e){if(!(e instanceof te().Bv))return!1;const t=e.getType();return!!t&&(0,Ze().IU)(t,e.getFormat())}function mo(){const e=(0,i().v3)(),{device:t}=e,n=(0,s().K8)((()=>"paste_link"===J().default.getEligibleGroup({experimentId:"adoption_import_contextual_entry_points",defaultGroup:"control"})),[]),a=(0,s().K8)((()=>{const t=Wn().A.state;return t.open?lo(t,e,n):null}),[e,n]),r=(0,s().K8)((()=>!!Wn().A.state.loading),[]),l=(null==a?void 0:a.length)??0;(0,o.useEffect)((()=>{r||0!==l||Bn().VN()}),[l,r]),function(){const e=(0,s().O$)(Wn().A),t=(0,s().O$)(I().default);(0,o.useEffect)((()=>{if(e.open&&"editing"===t.mode){const{multiSelection:n}=t;(0,M().KP)(n)&&n.start.store.id===e.textStore.id&&n.end.index===e.urlSelection.endIndex||Bn().VN()}}),[e,t])}();const d=(0,Te().IS)((e=>({header:t.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Be().Wy.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:Be().J.UISmall.desktop,fontWeight:450,fontStyle:"normal",font:"SF Pro"}})),[t]);if(null===a)return null;let c;return c=t.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:a.some((e=>e.key===to))?270:a.some((e=>"import section"===e.key))?260:200,maxHeight:"40vh"},(0,P.jsx)(P.Fragment,{children:r?(0,P.jsx)(Zn().A,{style:{marginLeft:3,marginRight:3}}):(0,P.jsx)(b().A,{...c,className:Bt().poM,header:(0,P.jsx)(qt().A,{style:d.header,isSmall:!t.isMobile,isSecondaryColor:!t.isMobile,children:(0,P.jsx)(K().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,P.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,sections:a,initialFocus:0})})})}var go=()=>n(633457),fo=()=>n(47170),ho=()=>n(523713);function yo(){const e=(0,i().v3)(),t=e.currentUser.id,n=(0,fo().O)(),a=(0,s().K8)((()=>(0,ho().x)({isPhone:e.device.isPhone,spaceStore:X().default.state.currentSpaceStore})),[e.device]);return(0,o.useEffect)((()=>{if(!n||!t||!a)return;const o=$().Ay.addListener((0,F().DZ)({notionUserId:t,spaceId:n}),void 0,(0,$().AY)((t=>{let{version:n}=t;-1!==n&&vo(e)})),void 0,e);return function(){o&&$().Ay.removeListener(o,e)}}),[e,t,n,a]),null}const vo=(0,f().sg)((e=>{go().oX({environment:e})}),5e3,{leading:!0,trailing:!0});var bo=()=>n(908006),xo=()=>n(522419),So=()=>n(681546),Mo=()=>n(452951),Ao=()=>n(340498);const wo=(0,Ao().wt)("collapse",{viewBox:"0 0 16 16",svg:(0,P.jsx)("path",{d:"M2.477 7.51h3.787c.396 0 .701-.106.916-.32.214-.22.321-.525.321-.917V2.534a.723.723 0 00-.745-.745.731.731 0 00-.54.212.736.736 0 00-.205.533v.486l.15 2.146-1.6-1.682-1.968-1.982a.695.695 0 00-.52-.219.791.791 0 00-.574.219.736.736 0 00-.219.554.78.78 0 00.055.294.917.917 0 00.17.253L3.482 4.57l1.675 1.593-2.153-.143h-.526a.723.723 0 00-.746.745.723.723 0 00.746.745zm6.74 6.912a.71.71 0 00.526-.212.7.7 0 00.212-.526v-.554l-.143-2.14 1.6 1.682 2.002 2.016a.69.69 0 00.526.22c.224 0 .41-.074.561-.22a.725.725 0 00.226-.553.707.707 0 00-.062-.294.728.728 0 00-.164-.246l-2.01-2.017-1.688-1.586 2.16.144h.588a.736.736 0 00.533-.205.711.711 0 00.219-.534.72.72 0 00-.219-.54.723.723 0 00-.533-.211H9.702c-.392 0-.697.109-.916.328-.214.214-.321.517-.321.909v3.8a.7.7 0 00.212.527.746.746 0 00.54.212z"})});var ko=()=>n(812318),jo=()=>n(236190),Co=()=>n(689094),Io=()=>n(343666),To=()=>n(100622),_o=()=>n(124952),Po=()=>n(235116),Bo=()=>n(35622),Ro=()=>n(797265),Lo=()=>n(778417),Do=()=>n(569912),Oo=()=>n(129522),No=()=>n(640867),Eo=()=>n(145214),Uo=()=>n(493823);const Fo={background:"rgba(255, 255, 255, 0.055)"},Vo={padding:"6px 10px 6px 6px"},Ko={padding:"6px 6px 6px 10px"},Ho={display:"flex",borderRadius:4,background:To().Ay.blackWithAlpha(.65)},zo=.5,Wo=.5,Go=2,Yo=-.002,qo=-.004;function $o(e){let{visible:t,isOpen:n,zoomScale:o,handleZoomIn:a,handleZoomOut:r,handleNext:l,handlePrevious:d,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:p,resetHideControlsTimeout:m,clearHideControlsTimeout:f,isSaving:h,isEditingZoom:y,handleClose:v}=e;const b=(0,i().Y0)(),x=(0,i().v3)(),{blockStore:S,imageUrl:M}=(0,s().K8)((()=>({blockStore:No().A.state.blockStore,imageUrl:No().A.state.imageUrl})),[]),A=(0,s().K8)((()=>{var e;return Boolean(S&&(M||(null===(e=S.getProperties())||void 0===e?void 0:e.source)&&g().q4_(S.getProperties().source)))}),[S,M]);if(b.isMobile)return null;return(0,P.jsxs)(Eo().A,{visible:t,initial:{opacity:1},exit:{opacity:0},animate:{opacity:1},style:ii(n),onClick:e=>{!function(e){e.stopPropagation()}(e),m(),u()},children:[(0,P.jsx)("div",{style:{...Ho,marginRight:10},children:(0,P.jsx)(Zo,{handlePrevious:d,handleNext:l})}),(0,P.jsxs)("div",{style:Ho,children:[(0,P.jsx)(Qo,{zoomScale:o,handleZoomIn:a,handleZoomOut:r,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:p,isEditingZoom:y}),(0,P.jsx)(ci,{}),A?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Xo,{onClick:()=>{if(!S||!A)return;No().A.setState({...No().A.state,isSaving:!0}),f();const e=null==S?void 0:S.getProperties();let t,n;if(t=M||g().q4_(null==e?void 0:e.source),t){if((0,xo()._J)(t)){const o=g().q4_(null==e?void 0:e.title)||(0,xo().Jt)(t);n=Po().KE(x,{url:t,download:!0,downloadName:o,permissionRecord:S.pointer})}else{const o=g().q4_(null==e?void 0:e.caption);n=(0,xo().pJ)(t,null==S?void 0:S.pointer,G().A.domainBaseUrl,x.currentUser.id,o)}n.then((()=>{No().A.setState({...No().A.state,isSaving:!1}),(0,_o().d)(x,{type:"download",triggered_by:"click"}),m()}))}},loading:h}),(0,P.jsx)(ci,{})]}):void 0,(0,P.jsx)(Jo,{onClick:v})]})]})}function Qo(e){let{zoomScale:t,handleZoomIn:n,handleZoomOut:s,setZoomScale:a,disableZoomEditing:r,enableZoomEditing:l,isEditingZoom:d}=e;const c=(100*t).toFixed(0),u=(0,i().v3)(),p=(0,o.useCallback)((e=>{const t=e.target,n=parseInt(t.value);if(!isNaN(n)){const e=n/100;(0,_o().d)(u,{type:"set_zoom",new_zoom:e}),a(e)}r()}),[r,u,a]);return(0,P.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsx)(di,{primaryText:(0,P.jsx)(K().sA,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:t<=Wo,render:e=>(0,P.jsx)(Uo().p,{...e,disabled:t<=Wo,style:{...ri(t<=Wo),...Ko},onClick:s,icon:e=>(0,jo().c)({...e,fill:si(),height:16,margin:0,width:16})})}),d?(0,P.jsx)(ei,{initialValue:c,onSubmit:p,onCancel:r,primaryColor:si(),secondaryColor:ai()}):(0,P.jsx)(Uo().p,{onClick:e=>{e.stopPropagation(),l()},style:{color:ai(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${c}%`}),(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsx)(di,{primaryText:(0,P.jsx)(K().sA,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:t>=Go,render:e=>(0,P.jsx)(Uo().p,{...e,disabled:t>=Go,style:ri(t>=Go),onClick:n,icon:e=>(0,Co().W)({...e,fill:si(),height:16,margin:0,width:16})})})]})}function Zo(e){let{handlePrevious:t,handleNext:n}=e;const o=(0,P.jsx)("div",{}),{blockStore:i,allImageBlocksOnPage:a}=(0,s().K8)((()=>{const{blockStore:e}=No().A.state;return{blockStore:e,allImageBlocksOnPage:e?ni():[]}}),[]);if(!i)return o;if(a.length<=1)return o;const r=a.findIndex((e=>e.id===(null==i?void 0:i.id)))??-1;if(-1===r)return o;const l=a.length;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsx)(di,{primaryText:(0,P.jsx)(K().sA,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,P.jsx)(li,{imageIndex:r-1,totalImageCount:l})}),disableTooltip:0===r,render:e=>(0,P.jsx)(Uo().p,{...e,disabled:r<=0,style:{...ri(r<=0),...Ko},hoveredStyle:Fo,onClick:()=>t(),icon:e=>(0,So().i)({...e,fill:si(),height:16,margin:0,width:16})})}),(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsx)(di,{primaryText:(0,P.jsx)(K().sA,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,P.jsx)(li,{imageIndex:r+1,totalImageCount:l})}),disableTooltip:r+1===l,render:e=>(0,P.jsx)(Uo().p,{...e,disabled:r>=l-1,style:{...ri(r>=l-1),...Vo},hoveredStyle:Fo,onClick:()=>n(),icon:e=>(0,Mo().Z)({...e,fill:si(),height:16,margin:0,width:16})})})]})}function Xo(e){let{onClick:t,loading:n}=e;return(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsx)(di,{primaryText:(0,P.jsx)(K().sA,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:e=>(0,P.jsx)(Uo().p,{...e,disabled:n,onClick:t,style:ri(!1),hoveredStyle:Fo,children:n?(0,P.jsx)(Zn().A,{size:"sm"}):(0,ko().k)({fill:si(),width:16})})})}function Jo(e){let{onClick:t}=e;return(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsx)(di,{primaryText:(0,P.jsx)(K().sA,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,P.jsx)(Uo().p,{...e,onClick:t,style:{...ri(!1),...Vo},hoveredStyle:Fo,icon:e=>wo({...e,fill:si(),height:16,margin:0,width:16})})})}function ei(e){const[t,n]=(0,o.useState)(e.initialValue);return(0,P.jsx)(Yt().A,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;n(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:Yt().C.Transparent,right:(0,P.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}const ti=function(){const e=(0,i().v3)(),t=(0,o.useRef)(!1),a=(0,o.useRef)(),r=(0,o.useRef)(),[l,d]=(0,o.useState)(!1),[c,u]=(0,o.useState)(void 0),[p,m]=(0,o.useState)(!1),{isOpen:g,rendered:h,fullScreenNodeRect:y,fullscreenNodeAnimationComplete:v,contentAspectRatio:b,zoomScale:x,panOffset:S,skipAnimations:M,isSaving:A,blockStore:w,panStartPosition:k}=(0,s().K8)((()=>{var e;const{state:t}=No().A;return{isOpen:t.isOpen,rendered:null===(e=t.renderFullScreenNode)||void 0===e?void 0:e.call(t),fullScreenNodeRect:t.fullScreenNodeRect,fullscreenNodeAnimationComplete:t.fullscreenNodeAnimationComplete,contentAspectRatio:t.contentAspectRatio,zoomScale:t.zoomScale,panOffset:t.panOffset,skipAnimations:t.skipAnimations,isSaving:Boolean(t.isSaving),blockStore:t.blockStore,panStartPosition:t.panStartPosition}}),[]),j=(0,s().K8)((()=>{const t=e.WindowSizeStore.state.width;return Bo().wX(t)}),[e.WindowSizeStore]);(0,n(388487).A)({capture:g,preventType:tt().A.All});const C=(0,o.useCallback)((()=>{a.current&&clearTimeout(a.current)}),[]),I=(0,o.useCallback)((()=>{m(!0),C(),l||A||(a.current=setTimeout((()=>m(!1)),2e3))}),[C,l,A]),T=(0,o.useCallback)((e=>{I();const t=Math.max(Math.min(e,Go),Wo),n=t<=1?{x:0,y:0}:S;No().A.setState({...No().A.state,zoomScale:t,panOffset:n})}),[S,I]),_=(0,o.useCallback)((e=>{const t=gi(e,c);t&&(e.x!==t.x&&(k.x=k.x+(e.x-t.x)),e.y!==t.y&&(k.y=k.y+(e.y-t.y)),No().A.setState({...No().A.state,panOffset:t,panStartPosition:k}))}),[c,k]),B=(0,o.useCallback)((()=>{d(!1),No().A.setState({...No().A.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}),[]),R=(0,o.useCallback)((()=>{d(!0),C()}),[C]),L=(0,o.useCallback)((()=>{d(!1),I()}),[I]),D=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Bo().VN(),(0,_o().d)(e,{type:"close",triggered_by:t?"keypress":"click"}),Lo().IU({environment:e}),mi(),bo().default.afterNextFlush((()=>{B()}))}),[e,B]),N=(0,o.useCallback)((e=>{(0,O().Vt)(e)||D()}),[D]),E=(0,o.useCallback)((e=>{if(e.stopPropagation(),(0,O().Vt)(e))return;let t,n;t=x<1?1:x<1.5?1.5:1,n=t<=1?{x:0,y:0}:gi({x:(window.innerWidth/2-e.clientX)/(t/(t-1)),y:(window.innerHeight/2-e.clientY)/(t/(t-1))},c)??S,No().A.setState({...No().A.state,zoomScale:t,panOffset:n}),I(),L()}),[c,L,S,I,x]),U=(0,o.useCallback)((function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!w)return;const o=ni();if(!o)return;const i=o.findIndex((e=>e.id===w.id));if(i+t<0||i+t>=o.length)return;(0,_o().d)(e,{type:t>0?"next":"previous",image_count:o.length,image_index:i+t,triggered_by:n?"keypress":"click"}),No().A.setState({...No().A.state,skipAnimations:!0}),r.current&&clearTimeout(r.current),r.current=setTimeout((()=>{No().A.setState({...No().A.state,skipAnimations:!1})}),250);const s=o[i+t];Ro().iy({environment:e,blockStore:s}),B()}),[w,e,B]),F=(0,o.useCallback)((function(){U(-1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[U]),V=(0,o.useCallback)((function(){U(1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[U]),K=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.ceil(2*(x-zo))/2;x-n<.25&&(n-=zo),(0,_o().d)(e,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,x]),H=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.floor(2*(x+zo))/2;n-x<.25&&(n+=zo),(0,_o().d)(e,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,x]),z=(0,o.useCallback)((e=>{c&&1===e.buttons&&oi()&&_({x:e.clientX/x-k.x,y:e.clientY/x-k.y})}),[c,k.x,k.y,_,x]),W=(0,o.useCallback)((e=>{switch(e.key){case"+":case"=":H(!0);break;case"-":case"_":K(!0)}}),[H,K]);(0,o.useEffect)((()=>{const e=e=>{T(x+e)},n=t=>{g&&(t.preventDefault(),t.ctrlKey?t.deltaY?e(t.deltaY*qo):t.deltaX&&e(t.deltaX*qo):t.metaKey?t.deltaY?e(t.deltaY*Yo):t.deltaX&&e(t.deltaX*Yo):oi()&&_({x:S.x-t.deltaX,y:S.y-t.deltaY}))};return g&&(window.addEventListener("wheel",n,{passive:!1}),t.current=!0),()=>{window.removeEventListener("wheel",n),t.current=!1}}),[g,S.x,S.y,_,T,x]);const G=window.innerWidth,Y=window.innerHeight-2*j;let q=G-2*j;const $=b??(y?y.width/y.height:void 0);if(void 0===$)return null;let Q=q/$;if(Q>Y){const e=Q/Y;Q/=e,q/=e}const Z={opacity:0},X={scale:x,opacity:1,translateX:S.x,translateY:S.y,width:"100%",height:"100%"};let J;return J=p?x>=1.5?"zoom-out":"zoom-in":"none",(0,P.jsx)(tn().A,{open:g||!v,children:(0,Do().A)((e=>(0,P.jsx)(ot().A,{debugName:"FullScreenRenderer",capture:g,onEsc:()=>{D(!0)},onEnter:f().D_,onSpace:()=>D(!0),onCommandEnter:()=>D(!0),onCommandShiftEnter:f().D_,onCommandSlash:f().D_,onUp:f().D_,onDown:f().D_,onDelete:f().D_,onBackspace:f().D_,onLeft:()=>F(!0),onRight:()=>V(!0),onUntab:f().D_,onTab:f().D_,onSelectAll:f().D_,onRedo:f().D_,onUndo:f().D_,onToggleBold:f().D_,onToggleItalics:f().D_,onToggleStrike:f().D_,onToggleCode:f().D_,onCut:f().D_,onCopy:f().D_,onPaste:f().D_,onKeypress:W,children:(0,P.jsxs)("div",{style:fi({isOpen:g,showControls:p}),...e,onClick:N,onMouseMove:I,children:[g&&(0,P.jsx)(n(552713).B,{}),(0,P.jsx)(Eo().A,{visible:g,initial:Z,exit:Z,animate:X,skip:M,forceCompositeLayer:!0,style:{display:"flex",cursor:J,maxWidth:q,maxHeight:Q,justifyContent:"center"},ref:e=>{e&&!c&&u({width:e.clientWidth,height:e.clientHeight})},onClick:E,onMouseDown:pi,onMouseUp:mi,onMouseLeave:mi,onMouseMove:z,onAnimationEnd:ui,children:h}),(0,P.jsx)($o,{visible:p,isOpen:g,zoomScale:x,handleZoomIn:H,handleZoomOut:K,handlePrevious:F,handleNext:V,setZoomScale:T,disableZoomEditing:L,enableZoomEditing:R,clearHideControlsTimeout:C,resetHideControlsTimeout:I,isSaving:A,isEditingZoom:l,handleClose:D})]})})))})};function ni(){const{blockStore:e}=No().A.state;if(!e)return[];if(function(){const{blockStore:e}=No().A.state;return(null==e?void 0:e.getParentTable())===Io().SN}()){return e.getParentStore().getContentStores().filter((e=>"image"===e.getType())).filter((e=>Boolean(e.getProperties().source)))}const t=Et().default.getCurrentRootStore();return Oo().K.getMembersByDOMOrder({filter:e=>"image"===e.renderedType&&Boolean(e.getBlockStore().findRecordStoreUIAncestor((e=>Boolean(t&&e===t))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function oi(){const{zoomScale:e}=No().A.state;return e>1}function ii(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function si(){return To().Ay.white}function ai(){return To().Ay.whiteWithAlpha(.5)}function ri(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function li(e){let{imageIndex:t,totalImageCount:n}=e;return(0,P.jsx)(K().sA,{values:{currentIndex:t+1,totalCount:n},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function di(e){const{primaryText:t,secondaryText:n}=e;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("span",{style:{marginRight:n?4:void 0},children:t}),n?(0,P.jsx)("span",{style:{color:ai()},children:n}):void 0]})}function ci(){return(0,P.jsx)("span",{style:{borderLeft:`1px solid ${To().Ay.whiteWithAlpha(.25)}`,height:"100%"}})}function ui(){const{isOpen:e}=No().A.state;e||No().A.setState({...No().A.state,fullscreenNodeAnimationComplete:!0})}function pi(e){const{panOffset:t,zoomScale:n}=No().A.state;No().A.setState({...No().A.state,panStartPosition:{x:e.clientX/n-t.x,y:e.clientY/n-t.y},skipAnimations:!0})}function mi(){No().A.setState({...No().A.state,skipAnimations:!1})}function gi(e,t){if(!t)return;let n,o;n=t.width*Go>window.innerWidth?(t.width*Go-window.innerWidth)/(2*Go):(window.innerWidth-t.width*Go)/(2*Go),o=t.height*Go>window.innerHeight?(t.height*Go-window.innerHeight)/(2*Go):(window.innerHeight-t.height*Go)/(2*Go);return{x:Math.min(Math.max(e.x,-1*n),n),y:Math.min(Math.max(e.y,-1*o),o)}}function fi(e){const{isOpen:t,showControls:n}=e;return{zIndex:999,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:n?void 0:"none"}}var hi=()=>n(473594),yi=()=>n(448619),vi=()=>n(969197),bi=()=>n(792002),xi=()=>n(569777);const Si=function(){const e=(0,i().v3)(),t=(0,o.useRef)(null),a=(0,o.useCallback)((n=>function(e,t,n){if(!xi().A.isOpen())return;if(!n.current)return;const o=n.current.getSelection();if(!o)return;const i=xi().A.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&o.startIndex===i&&o.endIndex===i&&(wi(t),yi().IV())}(n,e,t)),[e]),r=(0,o.useCallback)((n=>function(e,t,n){if(!n.current)return;const o=n.current.getSelection();if(!o)return;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===o.startIndex&&0===o.endIndex&&(wi(t),yi().IV(xi().q.Backward))}(n,e,t)),[e]),l=(0,o.useCallback)((()=>wi(e)),[e]),c=(0,s().K8)((()=>xi().A.state),[]),u=(0,s().K8)((()=>function(){if(!xi().A.isOpen())return;return xi().A.state.savedTextSelectionRect}()),[]),p=(0,s().K8)((()=>function(){var e;if("editing"!==I().default.state.mode&&!xi().A.isOpen())return!0;const t=xi().A.isOpen()?null===(e=(0,M().H7)(xi().A.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,vi().TL)(t);if(e&&e.isNonEditableState())return!0}const n={[g().Ifu.User]:g().Ifu.User,[g().Ifu.Page]:g().Ifu.Page,[g().Ifu.CustomEmoji]:g().Ifu.CustomEmoji,[g().Ifu.Comment]:g().Ifu.Comment,[g().Ifu.Bot]:g().Ifu.Bot,[g().Ifu.Date]:g().Ifu.Date,[g().Ifu.ExternalObjectInstance]:g().Ifu.ExternalObjectInstance,[g().Ifu.TemporaryPage]:g().Ifu.TemporaryPage,[g().Ifu.TemplateVariable]:g().Ifu.TemplateVariable,[g().Ifu.FormulaPageProperty]:g().Ifu.FormulaPageProperty,[g().Ifu.FormulaContextValue]:g().Ifu.FormulaContextValue,[g().Ifu.Group]:g().Ifu.Group,[g().Ifu.Team]:g().Ifu.Team,[g().Ifu.Citation]:g().Ifu.Citation,[g().Ifu.LinkMention]:g().Ifu.LinkMention,[g().Ifu.AssistantInstructionsCollection]:g().Ifu.AssistantInstructionsCollection,[g().Ifu.GeoPoint]:g().Ifu.GeoPoint,[g().Ifu.SlackSpecialMention]:g().Ifu.SlackSpecialMention};for(const o of Object.values(n))if((0,bi().y_)(o))return!0;return!1}()),[]);if(!c.open)return null;const m=c.value,f=c.error;return(0,P.jsx)(d().u2,{dependency:n(354584).y,children:e=>c.open?(0,P.jsx)(n(548901).A,{Prism:e,ref:t,isOpen:!0,equationValue:m,error:f,displayMode:"inline",disabled:p,originRect:u,originGap:8,onDismiss:Ai,onChange:Mi,onSubmit:l,onLeft:r,onRight:a}):null})};function Mi(e,t){xi().A.isOpen()&&xi().A.setState({...xi().A.state,value:e,error:t})}function Ai(){yi().IV()}function wi(e){v().createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,canUndo:!0,perform:t=>{yi().t5({environment:e,equationStore:xi().A,transaction:t})}})}var ki=()=>n(813743),ji=()=>n(728611),Ci=()=>n(487494),Ii=()=>n(525112);function Ti(e){switch(e){case Ci().A.Preview:return(0,P.jsx)(K().sA,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"});case Ci().A.Mention:return(0,P.jsx)(K().sA,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"});case Ci().A.Link:return(0,P.jsx)(K().sA,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Link"});default:(0,ge().HB)(e)}}const _i=function(){const e=(0,i().v3)(),t=(0,o.useRef)(null),[n]=(0,s().$y)(Ii().A),a=(0,o.useCallback)((t=>{if(n.open){var o;if(!t)ki().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!1});Ii().A.setState({open:!1})}}),[e,n]),r=(0,o.useCallback)((e=>{n.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&a(void 0)}),[a,n.open]),l=(0,o.useCallback)((e=>{if(!n.open||!e.target)return;const o=t.current;o&&(o.contains(e.target)||a(void 0))}),[a,n.open]);(0,o.useEffect)((()=>((0,ji().P4)(window,"keydown",r),(0,ji().P4)(window,"mousedown",l),()=>{(0,ji().Ol)(window,"keydown",r),(0,ji().Ol)(window,"mousedown",l)})),[r,l]);const d=(0,o.useRef)(!1);function c(t){var o;n.open&&void 0!==t.indexGlobal&&(Ii().A.setState({...n,focusedIndex:t.indexGlobal}),ki().fS({actionType:t.indexGlobal,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0}))}(0,s().K8)((()=>{var t,o;const i=(n.open&&(null===(t=n.args.commentStore)||void 0===t?void 0:t.state)&&(null===(o=n.args.commentStore.state)||void 0===o?void 0:o.isReady()))??!1;var s;i&&!d.current&&n.open&&ki().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(s=n.args.commentStore)||void 0===s?void 0:s.state,useTempStores:!0});d.current=i}),[e,n]);const u=(0,s().K8)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),p=e.device.isMobile;return(0,P.jsx)(x().Ay,{popupType:u?j().n.SlideUp:j().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:k().W.Top,alignmentToOrigin:k().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:p,keepFocus:p,render:function(){var o;const{device:i}=e;if(!n.open)return;const s=function(t){const{url:n,args:o}=t,i=[];i.push({title:Ti(Ci().A.Preview),validator:()=>!0,type:Ci().A.Preview}),i.push({title:Ti(Ci().A.Mention),validator:()=>!0,type:Ci().A.Mention}),i.push({title:Ti(Ci().A.Link),validator:()=>!0,type:Ci().A.Link});return[{key:"menu section",render:e=>(0,P.jsx)(Vt().A,{...e}),items:f().oE(i.map((t=>{let{title:i,validator:s,type:a}=t;if(s({url:n,baseUrl:G().A.domainBaseUrl,publicDomainName:G().A.publicDomainName})){return{key:`item ${a}`,render:t=>(0,P.jsx)(Ut().A,{...t,title:i,onMouseEnter:n=>{var i;t.onMouseEnter(n),ki().fS({actionType:a,environment:e,commentStore:null===(i=o.commentStore)||void 0===i?void 0:i.state,useTempStores:!0})}}),action:()=>{var t;return ki().fS({actionType:a,environment:e,commentStore:null===(t=o.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(n),a=i.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Be().Wy.semibold,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:Be().Wy.semibold};let r;return r=i.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:200,maxHeight:"40vh"},null!==(o=n.args.commentStore)&&void 0!==o&&o.state&&n.args.commentStore.state.isReady()?(0,P.jsx)(b().A,{...r,className:Bt().poM,ref:t,header:(0,P.jsx)(qt().A,{style:a,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,P.jsx)(K().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,P.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,sections:s,onKeyboardArrow:c,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,P.jsx)(b().A,{...r,className:Bt().poM,ref:t,header:(0,P.jsx)(qt().A,{style:a,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,P.jsx)(K().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,P.jsx)(Vt().A,{style:{display:"flex",justifyContent:"center"},children:(0,P.jsx)(Zn().A,{})})})},onDismiss:()=>a(void 0)})};var Pi=()=>n(775812),Bi=(n(672577),()=>n(829300)),Ri=()=>n(536612),Li=()=>n(663038),Di=()=>n(691298),Oi=()=>n(875497),Ni=()=>n(529183),Ei=()=>n(757695);class Ui extends Ei().default{getInitialState(){return{formulaTypecheckContextValue:void 0}}}const Fi=Ui;var Vi=()=>n(375447),Ki=()=>n(472090),Hi=()=>n(278132),zi=()=>n(743176),Wi=()=>n(247331),Gi=()=>n(977345),Yi=()=>n(380048),qi=()=>n(353147),$i=()=>n(476724),Qi=()=>n(381138),Zi=()=>n(379632),Xi=()=>n(191772),Ji=()=>n(267419);function es(e){return"+"===e.insertionType?(0,P.jsx)(ts,{}):(0,P.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,P.jsx)(ss,{svg:Qi().q.__iconDefinition.svg,viewBox:Qi().q.__iconDefinition.viewBox})})}function ts(){return(0,P.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,P.jsx)(ss,{svg:Co().W.__iconDefinition.svg,viewBox:Co().W.__iconDefinition.viewBox})})}function ns(){return(0,P.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,P.jsx)(ss,{svg:$i().I.__iconDefinition.svg,viewBox:$i().I.__iconDefinition.viewBox})})}function os(){return(0,P.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,P.jsx)(ss,{svg:qi().b.__iconDefinition.svg,viewBox:qi().b.__iconDefinition.viewBox})})}function is(e){const{pageStore:t,theme:n,isSafariOrIOS:o,emojiType:i,currentUserId:s}=e;return(0,Xi().h6)({pageModel:t.getModel(),pageRole:t.getRole(),showEmojiInline:!0,emojiType:i,baseUrl:G().A.domainBaseUrl,getRecordModel:t.getRecordModel,isClient:!0,isSafariOrIOS:o,currentUserId:s,theme:n,emojiData:Ji().A.state})}function ss(e){const{svg:t,viewBox:n}=e,i=(0,o.useMemo)((()=>{const e=Zi().A.renderToString((0,P.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:n,children:t}));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,n]),s=(0,Te().IS)((e=>({container:{width:"100%",height:"100%",backgroundColor:e.mediumIconColor,WebkitMaskImage:i,maskImage:i,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}})),[i]);return(0,P.jsx)("div",{style:s.container})}var as=()=>n(17022);class rs extends Ei().default{getInitialState(){}}const ls=new rs;function ds(e){const{isFirefox:t}=(0,i().Y0)();return(0,o.useCallback)((n=>{as().A.withListenerIgnored((()=>{var o;const i=Vi().A.state;if(!i.open)return;if(!n)return void i.temporaryInputData.setState(void 0);const{title:s,icon:a,allowTabCompletion:r}=n,l=e.current??"",d=s.toLowerCase().startsWith(l)?i.oldTextValue&&0!==(null===(o=i.oldTextValue)||void 0===o?void 0:o.length)?"":s.slice(l.length):"";ls.setState(r?d:void 0);const c=t?void 0:a;i.temporaryInputData.setState({prefix:i.insertionType,suffix:"[["===i.insertionType&&l.endsWith("]]")?"]]":"",completion:d,prefixIcon:c})}))}),[e,t])}const cs=(0,K().YK)({backButtonAriaLabel:{defaultMessage:"Back",id:"formulaMentionMenu.backButton.ariaLabel"},possessiveContextValueProperty:{defaultMessage:"{contextValueName}'s {propertyName}",id:"formulaMentionMenu.possessiveContextValueProperty.title"}}),us=o.memo((function(e){const{mentionMenuCurrentFormulaStore:t,queryRef:n}=e,a=(0,s().K8)((()=>330),[]),r=(0,s().K8)((()=>{const e=t.state.formulaTypecheckContextValue;if(e&&e.kind===Wi().FormulaContextValueKind.ContextValue)return e}),[t]),l=function(e){const{contextValue:t,queryRef:n,setTemporaryInputData:o}=e,a=(0,i().v3)(),r=(0,K().tz)(),l=(0,s().K8)((()=>{if(!t)return;const e=Pt().oc();return e?function(e,t){const n=function(e){if("block"!==e.type.type||!(0,ge().O9)(e.type.collection))return;return e.type.collection}(t);if(!n)return;const o=te().md.createChildStore(e,n);return o.getSchema()}(e,t):void 0}),[t]);if(!t||!l)return[];const d=(0,Gi().sM)(t);return(0,f().oE)(Object.entries(l).map((e=>{let[i,s]=e;if(s&&Wi().FORMULAS_SUPPORTED_COLLECTION_PROPERTY_TYPES.includes(s.type))return{action:e=>{v().createAndCommit({userAction:"FormulaMentionMenu.menuItem",environment:a,canUndo:!0,perform:o=>{const l=(0,g().ESw)({contextValueId:t.id,name:(0,Hi().Nl)(r,d,s.name),property:i,valueSnapshot:"current"});Bi().Ju({annotations:[l],editorMode:"default",environment:a,mentionType:"formulaContextVariable",menuListItemAction:e,query:n.current??"",transaction:o})}})},key:`formula property ${i}`,render:e=>(e.focused&&o({allowTabCompletion:!0,icon:(0,P.jsx)(os,{}),title:r.formatMessage(cs.possessiveContextValueProperty,{contextValueName:d,propertyName:s.name})}),(0,P.jsx)(Ut().A,{...e,icon:(0,P.jsx)(ps,{children:zi().LE[s.type]({height:17,width:17})}),title:s.name}))}})))}({contextValue:r,queryRef:n,setTemporaryInputData:ds(n)}),d=function(e){const{contextValue:t,items:n,mentionMenuCurrentFormulaStore:i}=e,s=(0,K().tz)(),a=(0,o.useCallback)((()=>{i.setState({formulaTypecheckContextValue:void 0}),Vi().A.updateOpenState({showFormulaProperty:!1})}),[i]),r=(0,Te().IS)((()=>({backButton:{height:20,width:20},backButtonIcon:{width:17},sectionDesktopTitle:{paddingInline:10},titleHeader:{display:"inline-flex",alignItems:"center",gap:2}})),[]);if(0===n.length||!t)return[];const l=(0,Gi().sM)(t);return[{items:n,key:"formula properties section",render:e=>(0,P.jsx)(Vt().A,{...e,desktopTitleStyle:r.sectionDesktopTitle,title:(0,P.jsxs)("header",{style:r.titleHeader,children:[(0,P.jsx)(Ue().A,{ariaLabel:s.formatMessage(cs.backButtonAriaLabel),icon:Yi().I,iconStyle:r.backButtonIcon,onClick:a,style:r.backButton}),(0,P.jsx)(K().sA,{defaultMessage:"Property from {contextValueName}",id:"formulaMentionMenu.formulaPropertiesSection.title",values:{contextValueName:l}})]})})}]}({contextValue:r,items:l,mentionMenuCurrentFormulaStore:t});if(!d||0===d.length)return null;const c={menuType:S().gu.Popup,width:a};return(0,P.jsx)(b().A,{...c,children:(0,P.jsx)(Ft().Ay,{initialFocus:0,sections:d,type:Ft().Oh.Vertical})})}));function ps(e){const{children:t}=e,n=(0,Te().IS)((()=>({wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:20,width:20}})),[]);return(0,P.jsx)("div",{style:n.wrapper,children:t})}class ms extends Ei().default{getInitialState(){return{userId:"",userEmail:"",displayName:""}}}const gs=ms;function fs(e,t){return t?Vi().A.state.open&&"@"===Vi().A.state.insertionType&&e.device.isAndroid&&t.startsWith("@")?t.slice(1).trim():Vi().A.state.open&&"[["===Vi().A.state.insertionType&&t.endsWith("]]")?t.slice(0,-2).trim():t.trim():""}var hs=()=>n(296206),ys=()=>n(966505),vs=()=>n(766637);function bs(e,t){const n=(0,s().K8)((()=>Vi().A.getMentionMenuContext()),[]);return(0,o.useCallback)((()=>{let o,i=Date.now();const s=Vi().A.state;if(s.open&&(i=s.openTime,o=s.flowId),s.open){var a;const r=Date.now(),{numServerRequests:l}=vs().A.state,d=s.sessionId,c=s.showMentionAndShare;hs().sM(e,{timeToAbandonInMs:r-i,analyticsFrom:n,queryLength:(null===(a=t.current)||void 0===a?void 0:a.length)??0,flowId:o,searchSessionId:d,searchSessionFlowNumber:l,stage:c?"share":"user_selection"})}s.open&&s.showInvite&&ys().F$(e,{origin:Vi().A.getInviteOrigin(),invite_flow_id:s.flowId}),Bi().VN()}),[n,e,t])}function xs(e){let{usePopupOnMobile:t}=e;const n=(0,i().Y0)();return!t&&(n.isMobileNative&&!n.isTablet)}var Ss=()=>n(891957);function Ms(e){let{clearSavedSelection:t,filter:n}=e;const o=(0,i().v3)(),a=(0,s().O$)(Vi().A),r=(0,s().K8)((()=>330),[]);if(!a.open)return null;const l="block"===a.textStore.table?a.textStore.id:void 0;return(0,P.jsx)(Ss().Ay,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{Bi().eh({environment:o,titleText:fs(o,n),clearSavedSelection:t,createInValue:e,menuListItemAction:void 0})},parentBlockId:l,onAutocompleteQueryChange:As,autocompleteQuery:a.createInQuery,desktopWidth:r,onCancel:ws})}function As(e){Vi().A.updateOpenState({createInQuery:e})}function ws(){Vi().A.updateOpenState({showCreateIn:!1,createInQuery:""})}var ks=()=>n(690490);function js(e){let{inviteTargetsStore:t,personPropertyInviteStore:n,filter:a}=e;const r=(0,i().v3)(),l=(0,o.useCallback)((()=>Cs(r,t,n)),[r,t,n]),d=(0,s().K8)((()=>Pt().ao()),[]),c=(0,s().K8)((()=>Vi().A.getInviteOrigin()),[]);return d?(0,P.jsx)(ks().A,{inviteOrigin:c,store:d,onInviteCompleteFn:e=>{if(!e.success)return Cs(r,t,n),null;const{invitedUsers:o,requestedUsers:i}=e,s=f().xW(Object.values(o),Object.values(i));s.length?v().createAndCommit({userAction:"MentionMenu.inviteMenu",environment:r,canUndo:!0,perform:e=>{Bi().Ju({environment:r,editorMode:"default",annotations:s.map((e=>(0,g().P4h)(e))),transaction:e,menuListItemAction:void 0,query:fs(r,a),mentionType:"user"})}}):Cs(r,t,n)},handleBackButtonClick:l,inviteTargetsStore:t,personPropertyInviteStore:n}):null}function Cs(e,t,n){const o=Vi().A.state;o.open&&(ys().F$(e,{origin:Vi().A.getInviteOrigin(),invite_flow_id:o.flowId}),t.setState({tokenQuery:"",inviteTargets:[]}),n.setState({...n.state,emailMessage:""}),Vi().A.updateOpenState({showInvite:!1}))}var Is=()=>n(97835),Ts=()=>n(763884),_s=()=>n(134696),Ps=()=>n(579627),Bs=()=>n(436572),Rs=()=>n(574012),Ls=()=>n(8980);const Ds="ShowMentionInvite";function Os(e){return`${Ds}-${e}`}function Ns(e){const t=(0,i().v3)(),n=(0,s().K8)((()=>Pt().ao()),[]),{mentionMenuCurrentMentionStore:o,menuPopupType:a}=e,{userId:r,displayName:l,userEmail:d}=(0,s().K8)((()=>o.getState()),[o]),c=(0,s().K8)((()=>Rs().A.mobileNativeBottomPadding(t)),[t]),u=(0,s().K8)((()=>Vi().A.state.open),[]);if(!n)return null;const p={key:"invite buttons",render:e=>(0,P.jsx)(Vt().A,{...e}),items:[{key:"MentionMenu.MentionWithoutSharing",render:e=>(0,P.jsx)(Ut().A,{title:(0,P.jsx)(K().sA,{defaultMessage:"Mention without sharing",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharing"}),caption:(0,P.jsx)(K().sA,{defaultMessage:"Mention {userDisplayName} without sharing this document",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharingCaption",values:{userDisplayName:l}}),icon:(0,qi().b)({width:18}),...e}),action:()=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Bi().Ju({environment:t,editorMode:"default",annotations:[(0,g().P4h)(r)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_without_share"})}}),Ts().K.set({userId:t.currentUser.id,key:Os(n.id),value:!0})}},{key:"MentionMenu.MentionAndShare",render:e=>(0,P.jsx)(Ut().A,{title:(0,P.jsx)(K().sA,{defaultMessage:"Mention and share",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShare"}),caption:(0,P.jsx)(K().sA,{defaultMessage:"Grant {userDisplayName} full access",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShareCaption",values:{userDisplayName:l}}),icon:(0,P.jsx)(Ls().I,{icon:Is().x}),...e}),action:()=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Bi().Ju({environment:t,editorMode:"default",annotations:[(0,g().P4h)(r)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_and_share"})}}),v().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission",environment:t,canUndo:!0,perform:e=>{Ps().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"editor",user_id:r}],pagePermissionChangeLocation:"mention_share_menu"})}}),_s().Jg(t,{role:"editor",is_space:!1,invite_targets:[{type:"existingUser",value:{id:r,version:0,email:d}}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:"editor",user_id:r}],invite_message_length:0}),Bs().rL({item:{label:(0,P.jsx)(K().sA,{id:"mentionMenu.mentionShareMenu.mentionAndShare.snackbarMessage",defaultMessage:"Successfully granted {user} full access",values:{user:l}})},undoFunc:()=>v().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission.undoShare",environment:t,canUndo:!0,perform:e=>{Ps().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"none",user_id:r}],pagePermissionChangeLocation:"mention_share_menu"})}})})}}]},m=a===S().gu.ActionSheet?{menuType:S().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${c}px)`}:{menuType:S().gu.Popup};return(0,P.jsxs)(b().A,{...m,children:[(0,P.jsx)(ot().A,{debugName:"MentionMenu",capture:u}),(0,P.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,initialFocus:0,sections:[p]})]})}var Es=()=>n(227440),Us=()=>n(64e3);const Fs=(0,K().YK)({addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}});var Vs=()=>n(30626),Ks=()=>n(406792),Hs=()=>n(311337),zs=()=>n(310109),Ws=()=>n(173979),Gs=()=>n(778078),Ys=()=>n(578136),qs=()=>n(217827);var $s=()=>n(148307),Qs=()=>n(955363),Zs=()=>n(617668),Xs=()=>n(264879),Js=()=>n(857783),ea=()=>n(553965);const ta={...Be().RC,fontWeight:Be().Wy.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function na(e){const{pageTitle:t}=e;return t?(0,P.jsx)(K().sA,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,P.jsx)("span",{style:ta,children:t})}}):(0,P.jsx)(K().sA,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function oa(e){const{pageTitle:t}=e;return t?(0,P.jsx)(K().sA,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,P.jsx)("span",{style:ta,children:t})}}):(0,P.jsx)(K().sA,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var ia=()=>n(103448);function sa(e){const{isFirstSection:t,query:n,clearSavedSelection:a,setTemporaryInputData:r}=e,{isOpen:l,insertionType:d,isCreatePageEnabled:c,textStore:u}=(0,s().K8)((()=>{const e=Vi().A.state.open;return{isOpen:e,isCreatePageEnabled:Vi().A.state.mentionTypes.createPage,insertionType:e?Vi().A.state.insertionType:void 0,textStore:e?Vi().A.state.textStore:void 0}}),[]),p=function(e){const{query:t,textStore:n,clearSavedSelection:a,setTemporaryInputData:r}=e,l=(0,i().v3)(),d=(0,K().tz)(),c=(0,s().K8)((()=>Xs().D8(n)),[n]),u=(0,o.useMemo)((()=>({key:"add new subpage",action:async e=>{c&&await Bi().eh({environment:l,clearSavedSelection:a,titleText:t,createInValue:c.createInValue,onPageCreated:e=>{e&&""===g().q4_(e.getTitleValue())&&Js().uK({environment:l,store:e,pageVisitSource:E().y8.Create})},menuListItemAction:e})},render:e=>{e.focused&&r({title:0===t.length?d.formatMessage(Fs.addPage):"",icon:(0,P.jsx)(ts,{}),allowTabCompletion:!1});const n=n=>(0,P.jsx)(Ut().A,{...(0,ea().A)(n||{},e),icon:(0,P.jsx)(Ls().I,{icon:Zs().plusIcon}),title:(0,P.jsx)(oa,{pageTitle:t})});return l.device.isMobile?n():(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsx)(ia().A,{imageURL:$s().A.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,P.jsx)(K().sA,{...Ss().DZ.createSubpage})}),placement:k().W.Right,delayThreshold:0,render:e=>n(e)})}})),[l,a,c,d,t,r]);return u}({query:n,textStore:u,clearSavedSelection:a,setTemporaryInputData:r}),m=function(e){const{query:t,setTemporaryInputData:n}=e,s=(0,i().v3)(),a=(0,K().tz)(),r=(0,o.useCallback)((()=>{Vi().A.updateOpenState({showCreateIn:!0})}),[]),l=(0,o.useMemo)((()=>({key:"open create in menu",action:r,render:e=>{e.focused&&n({title:0===t.length?a.formatMessage(Fs.addPage):"",icon:(0,P.jsx)(ts,{}),allowTabCompletion:!1});const o=n=>(0,P.jsx)(Ut().A,{...(0,ea().A)(n||{},e),icon:(0,P.jsx)(Ls().I,{icon:Qs().arrowDiagonalUpRightIcon}),title:(0,P.jsx)(na,{pageTitle:t})});return s.device.isMobile?o():(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsx)(ia().A,{imageURL:$s().A.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,P.jsx)(K().sA,{...Ss().DZ.newPageIn})}),placement:k().W.Right,delayThreshold:0,render:e=>o(e)})}})),[s.device.isMobile,r,a,t,n]);return l}({query:n,setTemporaryInputData:r}),f=(0,o.useMemo)((()=>{if(!c||!l)return;const e="@"===d?(0,P.jsx)(K().sA,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:n=>(0,P.jsx)(Vt().A,{...n,title:e,desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:[p,m]}}),[t,p,m,c,l,d]);return f}var aa=()=>n(395361),ra=()=>n(869190),la=()=>n(604995),da=()=>n(498140),ca=()=>n(5580);function ua(e){const{category:t,query:n,setTemporaryInputData:o,templateVariableResults:s}=e,a=(0,i().v3)(),r=(0,K().tz)();return s.filter((e=>(0,Ws().BX)(e,t))).map((e=>({key:e,render:t=>{const n=(0,Ws().Ti)(e,r),i=(0,Ws().EC)(e,r);return t.focused&&o({title:n,icon:(0,P.jsx)(os,{}),allowTabCompletion:!0}),(0,P.jsx)(Ut().A,{...t,title:n,caption:i,inline:!0})},action:t=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:a,canUndo:!0,perform:o=>{Bi().Ju({environment:a,editorMode:"default",annotations:[g().Ii$({type:e})],transaction:o,menuListItemAction:t,query:n,mentionType:"templateVariable"})}})}})))}var pa=()=>n(742117),ma=()=>n(575143);function ga(e,t){return function(){t.setState({formulaTypecheckContextValue:e}),Vi().A.updateOpenState({showFormulaProperty:!0})}}function fa(e){const{formulaReturnType:t,query:n,formulaContextVariableResults:o,setTemporaryInputData:s}=e;return ha({environment:(0,i().v3)(),formulaVariableFilter:e=>e.kind===Wi().FormulaContextValueKind.ContextValue&&e.type.type===t&&!(0,Gi().IF)(e),query:n,formulaContextVariableResults:o,setTemporaryInputData:s})}function ha(e){const{environment:t,formulaVariableFilter:n,query:o,formulaContextVariableResults:i,setTemporaryInputData:s}=e;if(0===i.length)return[];const a=i.filter(n);return 0===a.length?[]:a.map((e=>{const n=(0,Gi().sM)(e),i=(0,Gi().E9)(e),a=(0,Gi().Ix)(e.type);return{action:ya(t,e,o),key:e.id,render:t=>(t.focused&&s({allowTabCompletion:!0,icon:(0,P.jsx)(os,{}),title:e.name}),(0,P.jsx)(ma().A,{...t,svg:a,title:n,tooltipText:i}))}}))}function ya(e,t,n){return function(o){v().createAndCommit({userAction:"MentionMenu.formulaMenuItem",environment:e,canUndo:!0,perform:i=>{const s=(0,g().CA$)(t);Bi().Ju({annotations:[s],editorMode:"default",environment:e,mentionType:"formulaContextVariable",menuListItemAction:o,query:n,transaction:i})}})}}function va(e){const{isFirstSection:t,query:a,setTemporaryInputData:r,templateVariableResults:l,formulaContextVariableResults:d}=e,c=(0,i().v3)(),u=(0,K().tz)(),p=function(e){const[t,i]=(0,o.useState)([]),a=(0,K().tz)(),{areDateMentionsAllowed:r,areReminderMentionsAllowed:l}=(0,s().K8)((()=>({areDateMentionsAllowed:Vi().A.state.mentionTypes.date,areReminderMentionsAllowed:Vi().A.state.mentionTypes.reminder})),[]),d=(0,ca().n)(),c=(0,Ge().X)("chrono_node_date_mentions"),u=(0,o.useCallback)((async()=>{if(e.length<1)return;const t=await async function(e){const{query:t,intl:o,userLocal:i}=e,{chronoNodeDependency:s}=await Promise.all([n.e(91757),n.e(58587)]).then(n.bind(n,211051)),a=await s.load(),r={en:a.en.parse,ja:a.ja.parse,zh:a.zh.parse,fr:a.fr.parse,de:a.de.parse,es:a.es.parse,pt:a.pt.parse,nl:a.nl.parse}[i]??a.en.parse,l=r(t,void 0,{forwardDate:!0}),d=l.length>0?l[0]:void 0;if(!d)return;const{start:c,end:u}=d,p=c.isCertain("minute")||c.isCertain("hour"),m=(null==u?void 0:u.isCertain("minute"))||(null==u?void 0:u.isCertain("hour")),g=c.date().getTime(),f=null==u?void 0:u.date().getTime(),h=(0,U().P)(),y=la().KQ(g,h),v={unit:"day",value:0,time:hn().lM,defaultTimeZone:h},b=t.toLowerCase().startsWith(o.formatMessage(da().DZ.remind).toLowerCase());let x;if(g&&!f)x=p?{...y,reminder:b?ba(c):void 0}:{type:"date",start_date:y.start_date,reminder:b?v:void 0};else if(f){const e=la().NC(g,f,(0,U().P)());x=p&&m?{...e,reminder:b?ba(c):void 0}:{type:"daterange",end_date:e.end_date,start_date:e.start_date,reminder:b?v:void 0}}if(!x)return;let S=(0,ra().ZF)({value:x,allowRelativeDates:!0,userTimeZone:(0,U().P)(),intl:o});b&&(S=o.formatMessage(xa.reminder,{dateTime:S}));return{label:S,value:()=>x}}({query:e,intl:a,userLocal:d});i(t?[t]:[])}),[a,e,d]),p=(0,aa().Y)((async()=>await u()),100);return(0,pe().Yb)((async()=>{if(!r)return;c&&p.cancel();const t=function(e){const{query:t,allowReminder:n,intl:o}=e;if(0===t.length)return(0,f().oE)([{label:o.formatMessage(xa.autocompleteToday),value:()=>la().Ec((0,U().P)())},n?void 0:{label:o.formatMessage(xa.autocompleteNextTuesday),value:()=>{const e=la().ah((0,U().P)()),t=e.set({weekday:2,hour:15}),n=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:n.toFormat(la().tr),start_time:n.toFormat(hn().GE),time_zone:(0,U().P)()}}},n?{label:o.formatMessage(xa.autocompleteReminder),value:()=>({type:"datetime",start_date:la().uf((0,U().P)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:hn().lM,defaultTimeZone:(0,U().P)()},time_zone:(0,U().P)()})}:void 0]);const i=t.normalize("NFKD"),s=n?da().bm(i,o):da().FA(i,o);if(!s)return[];let a=(0,ra().ZF)({value:s,date_format:"relative",userTimeZone:(0,U().P)(),intl:o,allowRelativeDates:!0});s.reminder&&(a=o.formatMessage(xa.reminder,{dateTime:a}));return[{label:a,value:()=>s}]}({query:e,allowReminder:l,intl:a}).slice(0,6);t.length>0||!c?i(t):await p()}),[p,r,e,l,a,c]),t}(a),m=ua({templateVariableResults:l,category:"date",query:a,setTemporaryInputData:r}),g=fa({formulaReturnType:"date",query:a,formulaContextVariableResults:d,setTemporaryInputData:r}),h=(0,o.useMemo)((()=>p.map((e=>{let{label:t,value:n}=e;return{key:t,render:e=>{if(e.focused&&r({title:t,icon:(0,P.jsx)(os,{}),allowTabCompletion:!0}),da().e_(t,u)){const o=(0,ra().ZF)({value:n(),userTimeZone:(0,U().P)(),intl:u,allowRelativeDates:!1});return(0,P.jsx)(Ut().A,{...e,title:t,caption:o,inline:!0})}return(0,P.jsx)(Ut().A,{...e,title:t})},action:e=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:c,canUndo:!0,perform:t=>{const o=n();Bi().Ju({environment:c,editorMode:"default",annotations:[["d",{...o,date_format:"relative"}]],transaction:t,menuListItemAction:e,query:a,mentionType:o.reminder?"reminder":"date"})}})}}}))),[p,u,r,c,a]),y=(0,o.useMemo)((()=>[...g,...m,...h]),[h,g,m]),b=(0,o.useMemo)((()=>{if(y.length>0)return{key:"date results",render:e=>(0,P.jsx)(Vt().A,{...e,title:(0,P.jsx)(K().sA,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:y}}),[y,t]);return b}function ba(e){const t=e.isCertain("minute")?"minute":e.isCertain("hour")?"hour":"day";return"minute"===t?{unit:t,value:e.get("minute")??0}:"hour"===t?{unit:t,value:e.get("hour")??0}:{unit:"day",value:0,time:hn().lM}}const xa=(0,K().YK)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"}});var Sa=()=>n(862139);const Ma=(0,K().YK)({groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});function Aa(e){const{isFirstSection:t,query:n,setTemporaryInputData:a}=e,r=(0,i().v3)(),l=(0,K().tz)(),d=function(e){const{query:t}=e,n=(0,s().K8)((()=>Vi().A.state.mentionTypes.group),[]),i=(0,s().K8)((()=>an().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))),[]),a=(0,o.useMemo)((()=>n?(0,Gs().Ay)(t,i,(e=>e.name||""),{normalizeFuzzyScore:!0}):[]),[n,t,i]);return a}({query:n}),c=(0,s().K8)((()=>f().pY(an().A.state.permissionGroupsAndMemberCounts,(e=>e.group.group_id))),[]),u=(0,fo().O)(),p=(0,o.useMemo)((()=>f().oE(d.map((e=>{var t;if(!u)return;const o=l.formatMessage(Ma.groupMentionCaption,{numMembersInGroup:(null===(t=c[e.group_id])||void 0===t?void 0:t.memberCount)||0});return{key:e.id,render:t=>(t.focused&&a({title:e.name||"",icon:(0,P.jsx)(os,{}),allowTabCompletion:!0}),(0,P.jsx)(Sa()._,{menuListItemProps:{...t,caption:o},group:e,iconSizeOverride:r.device.isMobile?24:void 0})),action:t=>{v().createAndCommit({userAction:"MentionMenu.groupMention",environment:r,canUndo:!0,perform:o=>{Bi().Ju({environment:r,editorMode:"default",annotations:[g().dWL(e.group_id,u)],transaction:o,menuListItemAction:t,query:n,mentionType:"group"})}})}}})))),[d,u,l,c,a,r,n]),m=(0,o.useMemo)((()=>{if(0!==p.length)return{key:"group results",render:e=>(0,P.jsx)(Vt().A,{...e,title:(0,P.jsx)(K().sA,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:p}}),[p,t]);return m}var wa=()=>n(125958),ka=()=>n(712505),ja=()=>n(16006);const Ca=o.forwardRef((function(e,t){const{store:n}=e,o=(0,i().v3)().device.isMobile?24:20,s=(0,Te().IS)((e=>({icon:{fill:e.text.tertiary,width:o,height:o}})),[o]);return(0,P.jsx)(Ut().A,{...e,ref:t,title:(0,P.jsx)(ja().A,{store:n}),className:"notranslate",icon:(0,$i().I)(s.icon)})}));function Ia(e){const t=(0,i().v3)(),n=(0,K().tz)(),{query:a,setTemporaryInputData:r,isFirstSection:l}=e,d=function(e){const{intl:t,query:n}=e,o=n.toLowerCase(),i=(0,Ge().X)("mention_menu_page_headings"),a=(0,s().K8)((()=>{const e=(0,Pt().ZO)();if(!e)return;const{mainEditorCurrentBlockStore:t}=X().default.state;return e===t?t:ka().default.peekTargetStore.state===e?ka().default.peekTargetStore.state:void 0}),[]),r=(0,s().K8)((()=>{if(!i||!a)return[];const e=J().default.checkGate({gateName:"toc_nested_headings"});return(0,wa().T)(a.id,a.getRecordModel,e)}),[i,a]),l=(0,s().K8)((()=>a?(0,f().oE)(r.map((e=>{const n=te().Bv.createChildStore(a,{table:Tn().ev,id:e}),i=n.getModel();if(!i)return;const s=i.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,U().P)(),intl:t});return s&&s.toLowerCase().includes(o)?n:void 0}))):[]),[t,o,a,r]);return l}({query:a,intl:n}),c=0===d.length,u=(0,s().K8)((()=>d.map((e=>{const o=e.id;return{key:o,render:t=>{if(t.focused){const t=e.getModel();if(t){const o=t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,U().P)(),intl:n});r({title:o||"",icon:(0,P.jsx)(ns,{}),allowTabCompletion:!0})}}return(0,P.jsx)(Ca,{...t,store:e})},action:e=>{v().createAndCommit({userAction:"MentionMenu.getHeaderResultsMenuSection",environment:t,canUndo:!0,perform:n=>{Bi().Ju({environment:t,editorMode:"default",annotations:[["p",o]],transaction:n,menuListItemAction:e,query:a,mentionType:"heading"})}})}}}))),[t,d,n,a,r]),p=(0,o.useMemo)((()=>{if(!c)return{key:"heading results",render:e=>(0,P.jsx)(Vt().A,{...e,title:(0,P.jsx)(K().sA,{defaultMessage:"Link to heading",id:"mentionMenu.headerSection.title"}),desktopTitleStyle:l?{paddingTop:4}:void 0,topBorder:!l}),items:u}}),[u,l,c]);return p}var Ta=()=>n(626822);function _a(e){const{isFirstSection:t,environment:n,query:a,setTemporaryInputData:r}=e,{teamResults:l,currentTeamResultStore:d}=function(e){const t=(0,i().v3)(),{query:n}=e,o=(0,s().K8)((()=>(0,Ys().D)({isMobileNative:t.device.isMobileNative,disableExposureLogging:!0})&&Vi().A.state.mentionTypes.team),[t.device.isMobileNative]),a=(0,s().K8)((()=>{var e;if(!o)return[];if(!Vi().A.state.open)return[];const t=(null===(e=X().default.state.currentSpaceViewStore)||void 0===e?void 0:e.getTeamsStores().filter(ge().O9))||[];return(0,Gs().Ay)(n,t,(e=>e.getName()||""),{normalizeFuzzyScore:!0})}),[o,n]),r=(0,s().K8)((()=>Vi().A.state.open?Vi().A.state.textStore:void 0),[]);return{teamResults:a,currentTeamResultStore:(0,s().K8)((()=>{if(r&&(0,Ln().Wo)(r))return(0,Ln().yQ)(r)}),[r])}}({query:a}),c=(0,fo().O)(),u=(0,s().K8)((()=>f().oE(l.map((e=>{if(!c)return;return{key:e.id,render:t=>(t.focused&&r({title:e.getName()||"",icon:(0,P.jsx)(os,{}),allowTabCompletion:!0}),(0,o.createElement)(Ta().A,{...t,key:e.id,teamStore:e})),action:t=>{v().createAndCommit({userAction:"MentionMenu.teamMention",environment:n,canUndo:!0,perform:o=>{Bi().Ju({environment:n,editorMode:"default",annotations:[g().DH3(e.id,c,"teamspace")],transaction:o,menuListItemAction:t,query:a,mentionType:"team"})}})}}})))),[n,a,r,c,l]),p=(0,o.useMemo)((()=>{if(0!==u.length)return{key:"team results",render:e=>(0,P.jsx)(Vt().A,{...e,title:(0,P.jsx)(K().sA,{defaultMessage:"Teams",id:"mentionMenu.teamSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:u}}),[u,t]);return{currentTeamResultStore:d,teamResultsSection:p}}var Pa=()=>n(245241),Ba=()=>n(712030),Ra=()=>n(825972),La=()=>n(135599),Da=()=>n(62856),Oa=()=>n(477244),Na=()=>n(148832),Ea=()=>n(958378);const Ua=20;function Fa(e){const{query:t,isFirstSection:n,setTemporaryInputData:a,formulaContextVariableResults:r}=e,l=(0,K().tz)(),d=(0,i().v3)(),{device:c}=d,u=d.currentUser.id,p=(0,Te().DP)(),m=c.isSafari||c.isIOS,{results:g,isLoading:h}=function(e){const t=(0,s().K8)((()=>Vi().A.state.mentionTypes.page),[]),n=(0,s().K8)((()=>Vi().A.state.open&&Vi().A.state.textStore instanceof Na().B?Vi().A.state.textStore:void 0),[]),o=(0,i().v3)(),a=(0,s().K8)((()=>(0,Hs().y)(o)),[o]),{overriddenPublicShareLinkSpaceStore:r,furthestPublicShareAncestorId:l}=(0,Oa().W)(),d=(0,s().K8)((()=>Boolean(X().default.state.currentSpaceStore||r)||Boolean(n)),[n,r]),c=(0,s().K8)((()=>{var e;return null===(e=(0,Pt().ao)())||void 0===e?void 0:e.id}),[]),u=(0,s().K8)((()=>Ra().NK.state.filter((e=>e.pageId!==c)).slice(0,Ua).map((e=>e.store))),[c]),p=""===e,{results:m,isResultsLoading:g}=(0,La().W)({...a?{type:Pa().Vz.BlocksInAncestor,ancestorId:l??""}:{type:Pa().Vz.BlocksInSpace},source:"mention_menu",query:e,limit:Ua,filters:{excludeTemplates:!0,includePublicPagesWithoutExplicitAccess:a},options:{disable:!t||!d||p||a&&!l,overrideSpaceStore:a?r:void 0}});return{results:(0,s().K8)((()=>p?u.map((e=>({pageStore:e,serverEventProperties:void 0}))):m.map((e=>{let{store:t,serverEventProperties:n}=e;return{pageStore:t,serverEventProperties:n}}))),[m,u,p]),isLoading:g}}(t),y=fa({formulaReturnType:"block",query:t,formulaContextVariableResults:r,setTemporaryInputData:a}),b=(0,o.useMemo)((()=>(0,f().oE)(g.map((e=>{let{pageStore:n,serverEventProperties:o}=e;const i=n.id;return{key:i,render:e=>{if(e.focused){const e=n.getModel();if(e){const t=e.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,U().P)(),intl:l});a({title:t||"",icon:(0,P.jsx)(is,{pageStore:n,theme:p,isSafariOrIOS:m,emojiType:(0,Ba().FN)(d),currentUserId:u}),allowTabCompletion:!0})}}return(0,P.jsx)(Ea().A,{...e,store:n,showVerifiedPageBadge:!0})},action:e=>{v().createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:d,canUndo:!0,perform:n=>{Bi().Ju({environment:d,editorMode:"default",annotations:[["p",i]],transaction:n,menuListItemAction:e,query:t,serverEventProperties:o,mentionType:"page",resultId:i})}})}}})))),[u,d,l,m,t,g,a,p]),x=(0,o.useMemo)((()=>[...y,...b]),[y,b]),S=!(x.length>0)&&!h?Ka.noPageResults:Ka.linkToPage,M=(0,o.useMemo)((()=>(0,P.jsxs)(P.Fragment,{children:[l.formatMessage(S),(0,P.jsx)(Va,{show:h})]})),[l,h,S]),A=(0,o.useMemo)((()=>({key:"no page results",render:e=>(0,P.jsx)(Vt().A,{...e,title:M,desktopTitleStyle:n?{paddingTop:4}:void 0,topBorder:!n}),items:x})),[x,M,n]);return{pageResultsSection:A,isPageResultsLoading:h}}function Va(e){let{show:t}=e;const n=(0,Da().A)(t,500,300);return(0,P.jsx)(Zn().A,{style:{textAlign:"center",visibility:n?"visible":"hidden",display:"inline",marginLeft:8}})}const Ka=(0,K().YK)({noPageResults:{defaultMessage:"No page results",id:"mentionMenu.noPageSearchResults.title"},linkToPage:{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}});n(908872);var Ha=()=>n(764880),za=()=>n(237829),Wa=()=>n(798880),Ga=()=>n(695608),Ya=()=>n(498212),qa=()=>n(812182),$a=()=>n(731320),Qa=()=>n(928074),Za=()=>n(448693);const Xa=(0,K().YK)({here:{id:"mentionMenu.SlackSpecialMentionMenuItem.hereMention",defaultMessage:"@here"},channel:{id:"mentionMenu.SlackSpecialMentionMenuItem.channelMention",defaultMessage:"@channel"}}),Ja=(0,K().YK)({here:{id:"mentionMenu.SlackSpecialMentionMenuItem.hereMentionNoAmpersand",defaultMessage:"here"},channel:{id:"mentionMenu.SlackSpecialMentionMenuItem.channelMentionNoAmpersand",defaultMessage:"channel"}}),er=[{message:Ja.here,channelRecipient:"here"},{message:Ja.channel,channelRecipient:"channel"}],tr=o.forwardRef((function(e,t){const{channelRecipient:o}=e;return(0,P.jsx)(Ut().A,{...e,icon:(0,n(522500).q)({width:14,height:14}),title:(0,P.jsx)(K().sA,{...Xa[o]}),ref:t,inline:!0,caption:(0,P.jsx)(K().sA,{...Xa[o]})})}));var nr=()=>n(21510),or=()=>n(696746);const ir=["reply_menu_all_updates","reply_menu_archive","reply_menu_mentions_comments"];function sr(){const e=(0,s().K8)((()=>nr().A.state.open&&ir.includes(nr().A.state.discussionLocation)),[]),t=(0,s().K8)((()=>Vi().A.getIsMockText()),[]),n=(0,s().K8)((()=>(0,or().lU)(X().default.state.mainEditorCurrentBlockStore)),[]);return!t&&!e&&!n}function ar(e,t){const{user:o,focused:a}=e,r=(0,i().v3)(),l=(0,K().tz)(),d=(0,Te().IS)((e=>({icon:{width:17,height:17,fill:e.icon.secondary},tooltip:{color:e.text.contrastSecondary,fontWeight:Be().Wy.regular,maxWidth:240},tooltipHeader:{color:e.text.contrastPrimary,fontWeight:Be().Wy.medium}})),[]),c=(0,Ha().A7)(o),u=(0,Ha().lR)(l,c),p=(0,s().K8)((()=>{const e=(0,Pt().ao)();return!(e&&(0,Qa().Aj)({store:e}))||"none"!==(0,$a().om)(o.id)}),[o.id]),m=(0,s().K8)((()=>{var e;return o.id===(null===(e=X().default.state.currentUserStore)||void 0===e?void 0:e.id)}),[o.id]),g=sr(),f=(0,s().K8)((()=>{if(!g)return;if(!a)return;if(p)return;const e=(0,Pt().ao)(),t=e&&Boolean(Ts().K.get({userId:r.currentUser.id,key:Os(e.id)})),o=null==e?void 0:e.canAdmin();return!t&&o?(0,Is().x)(d.icon):(0,n(70423).L)(d.icon)}),[g,r.currentUser.id,p,a,d.icon]),h=(0,s().K8)((()=>{if(!g)return null;const e=o.email;return(0,P.jsxs)("div",{style:d.tooltip,children:[(0,P.jsx)("header",{style:d.tooltipHeader,children:(0,P.jsx)(lr,{userName:u,userHasAccessToPage:p,userIsSelf:m})}),e]})}),[g,p,m,u,o.email,d.tooltip,d.tooltipHeader]);return(0,P.jsx)(n(457688).A,{...e,ref:t,actor:c,right:f,tooltip:h,tooltipPlacement:g?k().W.Right:void 0,useEmailAsTooltip:!g,customUserTitleStyles:r.device.isMobile?{fontSize:14}:void 0,iconSizeOverride:r.device.isMobile?24:void 0})}const rr=o.forwardRef(ar);function lr(e){let{userName:t,userHasAccessToPage:n,userIsSelf:o}=e;return o?(0,P.jsx)(K().sA,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label"}):n?null:(0,P.jsx)(K().sA,{id:"mentionMenu.UserMentionMenuItem.noAccessTooltip",defaultMessage:"{userName} won't be notified because they don't have page access",values:{userName:t}})}n(430670);var dr=()=>n(68263),cr=()=>n(763824),ur=()=>n(318102),pr=()=>n(106628),mr=()=>n(870092),gr=()=>n(271084);const fr=75,hr=4;function yr(e){const{query:t,environment:n,intl:a}=e,r=(0,s().K8)((()=>Vi().A.state.open),[]),l=(0,s().K8)((()=>e.disabled||!Vi().A.state.mentionTypes.user),[e.disabled]),c=(0,s().K8)((()=>Boolean(X().default.state.currentSpaceStore)),[]),u=(0,Ge().X)("edge_cache_mentions"),[{value:p=[],status:m}]=(0,pe().Yb)((async()=>{if(l||u||!r||!c)return[];const e=await async function(e,t,n){if(Es().A.state.online){const o=await pr().T.searchActions.load();return await o.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1,minFuzzyScore:25,placeSelfFirst:o.isPersonalPronoun(e,n)})}return[]}(t,n,a.locale);return e}),[l,u,r,c,t,n,a.locale],{debounce:fr}),{results:g,isLoading:h}=function(e){const{query:t,flagEnabled:n,disabled:a}=e,r=(0,K().tz)(),l=(0,i().v3)(),c=(0,s().K8)((()=>Vi().A.state.open),[]),u=(0,s().O$)(X().AppStoreCurrentSpaceStore),p=!a&&n&&t.length>0&&u&&c,m=(0,s().K8)((()=>{var e;const t=gr().k.getSortedUserIds(),n=null===(e=(0,Pt()._m)(l))||void 0===e?void 0:e.id;return[...(0,f().oE)([n]),...t]}),[l]),g=(0,s().K8)((()=>{const e=X().default.state.mainEditorCurrentBlockStore;return e?(0,$a().i0)(e).flatMap((e=>{let{permissionItem:t}=e;return(0,dr().B2)(t)?[t.user_id]:[]})):[]}),[]),h=(0,d().fJ)(pr().T.searchActions),[{value:y=[],status:v}]=(0,pe().Yb)((async()=>{if(!p||"resolved"!==h.status)return[];const e=(0,f().sb)([...m,...g]),n=h.value;return(await n.searchUsers({environment:l,parentStore:u,query:t,userIds:e.slice(0,100),minFuzzyScore:25,placeSelfFirst:n.isPersonalPronoun(t,r.locale)})).slice(0,3)}),[p,h.status,h.value,m,g,l,u,t,r.locale]),b=(0,o.useMemo)((()=>({field:"name_normalized",direction:"asc"})),[]),x=(0,ur().n)({query:t,sort:b,filter:void 0,limit:50,disable:!p}),S=(0,s().K8)((()=>(null==x?void 0:x.rowsStore.state.rows)??[]),[x]),[{value:M=[],status:A}]=(0,pe().Yb)((async()=>{if(!p)return[];const e=S.sort(((e,t)=>{var n,o;const i=(null===(n=gr().k.state)||void 0===n?void 0:n[e.id])??0;return((null===(o=gr().k.state)||void 0===o?void 0:o[t.id])??0)-i})),t=await(0,cr().lX)(e,e.length,(async e=>{const t=mr().L.createChildStore(u,{table:Wa().oo,id:e.id});return await t.load(),t.getValue()}));return(0,f().oE)(t)}),[u,p,S],{debounce:fr}),w=(0,o.useMemo)((()=>{const e=new Set;return[...y,...M].filter((t=>!e.has(t.id)&&(e.add(t.id),!0)))}),[y,M]),k="pending"===A||"pending"===v;return{results:w,isLoading:k}}({query:t,flagEnabled:u,disabled:l}),y=(0,o.useMemo)((()=>u?g:p),[u,p,g]),v=(0,s().K8)((()=>Vi().A.state.emptyQueryUserRequestStore.state.result??[]),[]),b="pending"===(u?h:m);return{results:0===t.length?v.slice(0,hr):y.slice(0,20),isLoading:b}}const vr="__invite";function br(e){const{isFirstSection:t,query:n,inviteTargetsStore:a,personPropertyInviteStore:r,mentionMenuCurrentMentionStore:l,setTemporaryInputData:d,templateVariableResults:c,formulaContextVariableResults:u,currentTeamResultStore:p,disabled:m}=e,f=(0,i().v3)(),h=(0,K().tz)(),y=(0,s().K8)((()=>Vi().A.state.mentionTypes.user),[]),{results:b,isLoading:x}=yr({query:n,environment:f,intl:h,disabled:m}),S=(0,s().K8)((()=>(0,Pt().ao)()),[]),M=(0,s().K8)((()=>S&&Boolean(Ts().K.get({userId:f.currentUser.id,key:Os(S.id)}))),[f.currentUser.id,S]),A=(0,s().K8)((()=>Vi().A.state.mentionTypes.inviteUserToPage&&!M),[M]),w=ua({templateVariableResults:c,category:"user",query:n,setTemporaryInputData:d}),k=fa({formulaReturnType:"person",query:n,formulaContextVariableResults:u,setTemporaryInputData:d}),j=(0,s().K8)((()=>{const e=Vi().A.state.mentionTypes.team;return(0,Ys().D)({isMobileNative:f.device.isMobileNative,disableExposureLogging:!0})&&e}),[f.device.isMobileNative]),C=(0,s().K8)((()=>!b.find((e=>e.email===n))&&Vi().A.state.mentionTypes.inviteUserToWorkspace),[n,b]),I=(0,fo().O)(),T=(0,s().K8)((()=>{var e;return"slack_notification"===(null===(e=qs().A.state.automationActionStore)||void 0===e?void 0:e.getType())}),[]),_=C||b.length>0||w.length>0||k.length>0||j,B=(0,s().K8)((()=>{if(!I||!p||!_)return;const e=h.formatMessage({id:"posts.teamMenuItem.everyoneMentionNoAmpersand",defaultMessage:"everyone"});return e.startsWith(n)?{key:"everyone-unique-item",render:t=>(t.focused&&d({title:e,icon:(0,P.jsx)(os,{}),allowTabCompletion:!0}),(0,o.createElement)(Ta().A,{...t,key:"everyone-unique-item",teamStore:p,renderAsEveryoneMention:!0})),action:e=>{v().createAndCommit({userAction:"MentionMenu.teamMention",environment:f,canUndo:!0,perform:t=>{Bi().Ju({environment:f,editorMode:"default",annotations:[g().DH3(p.id,I,"everyone")],transaction:t,menuListItemAction:e,query:n,mentionType:"team"})}})}}:void 0}),[_,p,f,h,n,d,I]),R=(0,s().K8)((()=>er.reduce(((e,t)=>{if(!T)return e;const{channelRecipient:i,message:s}=t,a=h.formatMessage(s);if("channel"!==i&&"here"!==i)return e;if(!a.startsWith(n))return e;const r=function(e){return`slack-special-mention-${e}-unique-item`}(i),l={key:r,render:e=>(e.focused&&d({title:a,icon:(0,P.jsx)(os,{}),allowTabCompletion:!0}),(0,o.createElement)(tr,{...e,channelRecipient:i,key:r})),action:e=>{v().createAndCommit({userAction:`MentionMenu.slackSpecialMention.${s.id}MenuItem`,environment:f,canUndo:!0,perform:t=>{Bi().Ju({environment:f,editorMode:"default",annotations:[g().zP1(i)],transaction:t,menuListItemAction:e,query:n,mentionType:"slackSpecialMention"})}})}};return e.push(l),e}),[])),[T,f,h,n,d]),L=sr(),D=(0,s().K8)((()=>Vi().A.getMentionMenuContext()??Tn().ev),[]),O=(0,s().K8)((()=>!!S&&((0,Qa().Aj)({store:S})&&S.canAdmin())),[S]),N=(0,o.useCallback)((async e=>{let{user:t}=e;if(!(!f.device.isMobile&&L&&!M&&O))return;if(!S)return;const n=await z().callApi({eventName:"canMentionInviteUserToPage",environment:f,data:{block:{id:S.pointer.id,table:Tn().ev,spaceId:S.getSpaceId()},mentionedUser:{id:t.id,table:Wa().oo,spaceId:S.getSpaceId()}}});if("success"!==n.type||!n.data.canInvite)return;const o=(0,Ya().Ay)();qa().HK(function(e){const{environment:t,user:n,pageStore:o,intl:i,flowId:s,from:a}=e;return o&&Ts().K.set({userId:t.currentUser.id,key:Os(o.id),value:!0}),{id:`invite_${n.id}`,title:i.formatMessage(Mr.pageInviteToastTitle,{name:n.name??n.email}),jsxMessage:(0,P.jsx)(xr,{user:n}),actions:{primary:{title:i.formatMessage(Mr.pageInviteToastInviteButton),onAction:()=>{if(!o)return;const i="read_and_write";v().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Ps().zP({environment:t,transaction:e,store:o,permissionItems:[{type:"user_permission",role:i,user_id:n.id}],pagePermissionChangeLocation:"mention_share_menu",fromPermissionWrapper:"mention_menu",flowId:s})}}),Ts().K.set({userId:t.currentUser.id,key:Os(o.id),value:!1}),_s().Jg(t,{role:i,is_space:!1,invite_targets:[{type:"existingUser",value:n}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:i,user_id:n.id}],invite_message_length:0,invite_flow_id:s}),Sr(t,{flow_id:s,selection:"invite",target_user_id:n.id,from:a}),qa().HK(function(e){const{user:t,intl:n,environment:o,pageStore:i,flowId:s,from:a}=e;return{id:`invite_${t.id}`,icon:za().X,title:n.formatMessage(Mr.pageInviteSnackbarSuccessTitle),jsxMessage:void 0,message:n.formatMessage(Mr.pageInviteSnackbarSuccessMessage),actions:{primary:{title:n.formatMessage(Mr.pageInviteUndo),onAction:()=>{v().createAndCommit({userAction:"MentionMenu.menuItem",environment:o,canUndo:!0,perform:e=>{i&&Ps().zP({environment:o,transaction:e,store:i,permissionItems:[{type:"user_permission",role:"none",user_id:t.id}],pagePermissionChangeLocation:"mention_share_menu",flowId:s})}}),qa().UW(`invite_${t.id}`),function(e,t){(0,_t().u4)({environment:e,event:{eventName:"undo_invite_to_page_popup",eventProperties:t}}),J().default.logEvent("undo_invite_to_page_popup",void 0,t)}(o,{flow_id:s,target_user_id:t.id,from:a})}}}}}(e))}},secondary:{title:i.formatMessage(Mr.pageInviteToastIgnoreButton),onAction:()=>{o&&(qa().UW(`invite_${n.id}`),Sr(t,{flow_id:s,selection:"dismiss",target_user_id:n.id,from:a}))}}}}}({environment:f,user:t,pageStore:S,intl:h,flowId:o,from:D})),function(e,t){(0,_t().u4)({environment:e,event:{eventName:"trigger_invite_to_page_popup",eventProperties:t}}),J().default.logEvent("trigger_invite_to_page_popup",void 0,t)}(f,{flow_id:o,target_user_id:t.id,from:D})}),[f,M,O,L,S,D,h]),E=(0,s().K8)((()=>Vi().A.state.open?Vi().A.state.flowId:void 0),[]),U=(0,o.useCallback)(((e,t,n,o)=>{t.reset(),n.reset(),E&&(t.setState({...t.state,tokenQuery:o}),n.setState({...n.state,flowId:E}),ys().TS(e,{origin:Vi().A.getInviteOrigin(),invite_flow_id:E}),Vi().A.updateOpenState({showInvite:!0}))}),[E]),F=(0,s().K8)((()=>b.map((e=>{const t=e.id;return{key:t,render:n=>(n.focused&&d({title:(0,Ga().c6)(h,e),icon:(0,P.jsx)(os,{}),allowTabCompletion:!0}),(0,o.createElement)(rr,{...n,key:t,user:e})),action:o=>{const i=(0,$a().om)(t);A&&"none"===i?(l.setState({userId:t,userEmail:e.email,displayName:(0,Ha().A7)(e).getDisplayName(h)}),Vi().A.updateOpenState({showMentionAndShare:!0})):(v().createAndCommit({userAction:"MentionMenu.menuItem",environment:f,canUndo:!0,perform:t=>{Bi().Ju({environment:f,editorMode:"default",annotations:[(0,g().P4h)(e.id)],transaction:t,menuListItemAction:o,query:n,mentionType:"user"})}}),N({user:e}))}}})).concat(C&&_?[{key:vr,action:()=>U(f,a,r,n),render:e=>(e.focused&&d({title:"",icon:(0,P.jsx)(os,{}),allowTabCompletion:!1}),(0,P.jsx)(Ut().A,{...e,icon:(0,P.jsx)(Ls().I,{icon:Is().x}),title:n.length>0?(0,P.jsx)(K().sA,{defaultMessage:"Invite ”{query}”…",id:"mentionMenu.peopleSection.invitePrompt",values:{query:n}}):(0,P.jsx)(K().sA,{defaultMessage:"Invite…",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[])),[N,f,U,h,a,l,r,n,d,C,A,_,b]),V=(0,o.useMemo)((()=>[...B?[B]:[],...R,...k,...w,...F]),[B,k,w,R,F]),H=(0,o.useMemo)((()=>{if(0!==V.length||x)return{key:"user results",render:e=>(0,P.jsx)(Vt().A,{...e,title:(0,P.jsx)(K().sA,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:V}}),[V,t,x]);return y?{userResultsSection:H,isUserResultsLoading:x,numberOfUserResults:b.length}:{userResultsSection:void 0,isUserResultsLoading:!1,numberOfUserResults:0}}function xr(e){const{user:t}=e,n=(0,Te().IS)((()=>{const e=(0,To().O4)({theme:"dark"});return{container:{display:"flex",flexDirection:"column",gap:4},tokenContainer:{paddingTop:4,paddingBottom:4},darkTooltip:{background:e.tooltipBackground,color:e.text.contrastPrimary}}}),[]);return(0,P.jsxs)("div",{style:n.container,children:[(0,P.jsx)(Fe().A,{overlayContainerZIndex:202,alignment:k().C.Center,originGap:2,placement:k().W.Top,renderTooltip:()=>t.email,render:e=>(0,P.jsx)("div",{style:n.tokenContainer,...e,children:(0,P.jsx)(Za().t_,{userValue:t,isSingle:!0,shouldShrink:!0,format:Za().t_.Format.Medium})}),style:n.darkTooltip}),(0,P.jsx)("div",{children:(0,P.jsx)(K().sA,{...Mr.pageInviteToastMessage})})]})}function Sr(e,t){(0,_t().u4)({environment:e,event:{eventName:"select_invite_to_page_popup",eventProperties:t}}),J().default.logEvent("select_invite_to_page_popup",t.selection,t)}const Mr=(0,K().YK)({pageInviteToastTitle:{defaultMessage:"Invite to page?",id:"mentionMenu.UserMentionMenuItem.inviteToastTitle"},pageInviteToastMessage:{defaultMessage:"They won’t be notified unless you invite them to the page.",id:"mentionMenu.UserMentionMenuItem.inviteToastMessage"},pageInviteToastInviteButton:{defaultMessage:"Invite",id:"mentionMenu.UserMentionMenuItem.inviteToastInviteButton"},pageInviteToastIgnoreButton:{defaultMessage:"Ignore",id:"mentionMenu.UserMentionMenuItem.inviteToastIgnoreButton"},pageInviteSnackbarSuccessTitle:{defaultMessage:"Invite sent",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessTitle"},pageInviteSnackbarSuccessMessage:{defaultMessage:"They were notified and invited to edit the page.",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessMessage"},pageInviteUndo:{defaultMessage:"Undo",id:"mentionMenu.UserMentionMenuItem.undoToastMessage"}});var Ar=()=>n(842599);function wr(e){const{numberOfUserResults:t,templateVariableResults:n,query:i}=e,a=i.length>0,r=(0,s().K8)((()=>Vi().A.state.open&&Vi().A.state.insertionType),[]),l=function(e){const{templateVariableResults:t,query:n,numberOfUserResults:o}=e,i=(0,s().K8)((()=>Vi().A.state.open),[]),a=(0,s().K8)((()=>Vi().A.state.open?Vi().A.state.sectionOrder:void 0),[]),r=function(e){const{numberOfUserResults:t,templateVariableResults:n,query:o}=e,i=t+n.length;if(""===o||i>0||(0,Ar().xn)(o))return!0;const s=n.some((e=>(0,Ws().BX)(e,"user")));if(s)return!0;return!1}({numberOfUserResults:o,templateVariableResults:t,query:n});if(i&&a)return a;if(r)return jr;return kr}({numberOfUserResults:t,templateVariableResults:n,query:i});return(0,o.useMemo)((()=>{const e=l,t=(0,_n().sb)([...e,...Vi().k]),n=t.filter((e=>"createPage"!==e));return"+"===r?["createPage",...n]:"@"===r&&a||"[["===r?[...n,"createPage"]:t}),[a,r,l])}const kr=["date","page","team","group","heading","user"],jr=["date","user","page","team","group","heading"];function Cr(e){const{query:t,clearSavedSelection:n,inviteTargetsStore:a,personPropertyInviteStore:r,mentionMenuCurrentMentionStore:l,mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c}=e,[u,p]=(0,o.useState)(kr[0]),m=(0,i().v3)(),g=(0,s().K8)((()=>(0,Hs().y)(m)),[m]),h=(0,Te().DP)(),y=(0,i().WS)(),{expandSection:v,isOpen:b}=(0,s().K8)((()=>({isOpen:Vi().A.state.open,expandSection:Vi().A.state.open?Vi().A.state.expandSection:void 0})),[]),x=function(e){const t=(0,K().tz)();return(0,s().K8)((()=>Vi().A.state.mentionTypes.templateVariable),[])?(0,Ws().W4)(e,t):[]}(t),S=function(e){const t=(0,s().K8)((()=>Vi().A.state.mentionTypes.formulaContextVariable),[]),{automationActionStore:n,typecheckResult:i}=(0,s().K8)((()=>({automationActionStore:qs().A.state.automationActionStore,typecheckResult:qs().A.state.typecheckResult})),[]),a=(0,o.useMemo)((()=>n&&i?(0,zs().getContextValuesForAction)({value:i},n.id):(null==i?void 0:i.valueTypes)||[]),[n,i]),r=i&&t;return(0,o.useMemo)((()=>r?(0,Gs().Ay)(e,a,(e=>e.kind!==Wi().FormulaContextValueKind.ContextValue?"":e.name),{normalizeFuzzyScore:!0}):[]),[r,e,a])}(t),{pageResultsSection:M,isPageResultsLoading:A}=Fa({query:t,isFirstSection:"page"===u,setTemporaryInputData:c,formulaContextVariableResults:S}),w=va({templateVariableResults:x,formulaContextVariableResults:S,isFirstSection:"date"===u,query:t,setTemporaryInputData:c}),k=Ia({query:t,setTemporaryInputData:c,isFirstSection:"heading"===u}),{teamResultsSection:j,currentTeamResultStore:C}=_a({isFirstSection:"team"===u,environment:m,query:t,setTemporaryInputData:c}),{userResultsSection:I,isUserResultsLoading:T,numberOfUserResults:_}=br({isFirstSection:"user"===u,query:t,inviteTargetsStore:a,personPropertyInviteStore:r,mentionMenuCurrentMentionStore:l,setTemporaryInputData:c,templateVariableResults:x,formulaContextVariableResults:S,currentTeamResultStore:C,disabled:g}),B=Aa({isFirstSection:"group"===u,query:t,setTemporaryInputData:c}),R=sa({isFirstSection:"createPage"===u,query:t,clearSavedSelection:n,setTemporaryInputData:c}),L=function(e){const{mentionMenuCurrentFormulaStore:t,setTemporaryInputData:n,isFirstSection:i,formulaContextVariableResults:a}=e,r=a.filter((e=>e.kind===Wi().FormulaContextValueKind.ContextValue&&"block"===e.type.type)),l=(0,s().K8)((()=>{const e=r.map((e=>{const o=(0,Gi().sM)(e),i=(0,Gi().E9)(e),s=(0,Gi().Ix)(e.type);return{action:ga(e,t),key:e.id,render:e=>(e.focused&&n({title:o,icon:(0,P.jsx)(os,{}),allowTabCompletion:!1}),(0,P.jsx)(ma().A,{...e,right:(0,pa().V)({height:"auto",marginInlineStart:6,width:12}),svg:s,title:o,tooltipText:i}))}}));return(0,f().oE)(e)}),[r,t,n]),d=(0,o.useMemo)((()=>{if(0!==l.length)return{items:l,key:"formula property results",render:e=>(0,P.jsx)(Vt().A,{...e,title:(0,P.jsx)(K().sA,{defaultMessage:"Property from",id:"mentionMenu.formulaPropertySection.title"}),desktopTitleStyle:i?{paddingTop:4}:void 0,topBorder:!i})}}),[l,i]);return d}({mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c,isFirstSection:"formula"===u,formulaContextVariableResults:S}),D=function(e){const{query:t,formulaContextVariableResults:n,setTemporaryInputData:a,isFirstSection:r}=e,l=(0,i().v3)(),d=(0,s().K8)((()=>ha({environment:l,formulaVariableFilter:e=>e.kind===Wi().FormulaContextValueKind.ContextValue&&(0,Gi().IF)(e),query:t,formulaContextVariableResults:n,setTemporaryInputData:a})),[l,n,t,a]),c=(0,o.useMemo)((()=>{if(0!==d.length)return{items:d,key:"custom formula results",render:e=>(0,P.jsx)(Vt().A,{...e,title:(0,P.jsx)(K().sA,{defaultMessage:"Custom",id:"mentionMenu.customFormulaVariables.title"}),desktopTitleStyle:r?{paddingTop:4}:void 0,topBorder:!r})}}),[d,r]);return c}({query:t,formulaContextVariableResults:S,setTemporaryInputData:c,isFirstSection:"custom-formula"===u}),O=(0,o.useMemo)((()=>({date:w,user:I,page:M,group:B,team:j,heading:k,createPage:R,formula:L,"custom-formula":D,bot:void 0})),[w,I,M,B,j,k,R,L,D]),N=wr({templateVariableResults:x,numberOfUserResults:_,query:t});(0,o.useEffect)((()=>{const e=N.find((e=>void 0!==O[e]));p(e??N[0])}),[O,N]);const E=!T&&!A;(0,o.useEffect)((()=>{const e=Ks().default.DO_NOT_USE_markLegacy("rum.mention_menu_ready");E&&Ks().default.DO_NOT_USE_measureLegacy(e,{environment:m})}),[m,E]);const U=(0,o.useCallback)((e=>function(e){const{sectionName:t,menuSection:n,isOpen:o,expandSection:i,theme:s,isPhone:a}=e;if(!o||i===t)return n;const{items:r}=n,l=a||"heading"===t?3:5;if(r.length<=l)return n;const d=[...r.slice(0,l),{key:"show more",render:e=>(0,P.jsx)(Ut().A,{...e,icon:(0,Vs()._)({width:16,fill:s.text.secondary}),title:(0,P.jsx)("span",{style:{color:s.text.secondary},children:(0,P.jsx)(K().sA,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:r.length-l}})})}),action:()=>{Vi().A.updateOpenState({expandSection:t})}}];return{...n,items:d}}({sectionName:e.sectionName,menuSection:e.menuSection,isPhone:y,isOpen:b,expandSection:v,theme:h})),[y,b,v,h]);return(0,o.useMemo)((()=>{const e=[];for(const t of N){const n=O[t];n&&(g&&"user"===t||e.push("createPage"===t?n:U({sectionName:t,menuSection:n})))}return e}),[N,O,U,g])}const Ir=(0,K().YK)({noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"}}),Tr=(0,K().YK)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"}}),_r=o.memo((function(e){const{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:a,mentionMenuCurrentFormulaStore:r}=e;return(0,P.jsx)(Pr,{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:a,mentionMenuCurrentFormulaStore:r})}));function Pr(e){let{query:t,queryRef:a,clearSavedSelection:r,inviteTargetsStore:l,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u}=e;const p=(0,K().tz)(),m=(0,i().v3)(),g=(0,s().O$)(Vi().A),f=(0,s().O$)(Es().e),h=Boolean(g.open&&g.usePopupOnMobile),y=ds(a),v=Cr({clearSavedSelection:r,query:t,inviteTargetsStore:l,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u,setTemporaryInputData:y}),x=(0,n(575301).o_)();let M;(0,o.useEffect)((()=>{if(!f)return;const e=g.mentionTypes.user,t=g.mentionTypes.page,n=g.mentionTypes.date;let o="";e&&t&&n?o=p.formatMessage(Tr.mentionAll):e&&t?o=p.formatMessage(Tr.mentionPersonPage):e&&n?o=p.formatMessage(Tr.mentionPersonDate):t&&n?o=p.formatMessage(Tr.mentionPageDate):e?o=p.formatMessage(Tr.mentionPerson):n?o=p.formatMessage(Tr.mentionDate):t&&g&&(o=g.open&&"+"===g.insertionType?p.formatMessage(Fs.addPage):p.formatMessage(Tr.mentionPage)),y({title:o,icon:(0,P.jsx)(es,{insertionType:g.open?g.insertionType:"+"}),allowTabCompletion:!1})}),[f,y,p,g]),f||(M=(0,P.jsx)(Us().A,{title:(0,P.jsx)(K().sA,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})}));const{device:A}=m,w=(0,s().K8)((()=>330),[]),k=bs(m,a);let j;j=xs({usePopupOnMobile:h})?{menuType:S().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${x}px)`}:{menuType:S().gu.Popup,width:w,maxHeight:A.isMobile?"30vh":"40vh",onClickOutside:k};const C=(0,o.useCallback)((e=>{(function(e){return""===e})(a.current??"")&&(e.preventDefault(),k())}),[a,k]);return(0,P.jsxs)(b().A,{...j,header:M,children:[(0,P.jsx)(ot().A,{debugName:"MentionMenu",capture:g.open,onBackspace:C}),(0,P.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,initialFocus:Br(t),sections:v,onEmptyEnter:k,resetInitialFocusOnSectionChange:!0,performHandleEnterOnTab:!0}),0===v.length&&(0,P.jsx)(Vt().A,{children:(0,P.jsx)(Us().A,{title:(0,P.jsx)(K().sA,{...Ir.noResults})})})]})}function Br(e){if(""!==e)return 0}function Rr(){const e=(0,i().v3)(),t=(0,s().O$)(Vi().A),n=t.open&&t.showCreateIn,a=t.open&&t.showInvite,r=t.open&&t.showMentionAndShare,l=t.open&&t.showFormulaProperty,d=Boolean(t.usePopupOnMobile),c=(0,s().uB)(void 0,Ni().Ay),u=(0,s().uB)(void 0,Oi().A),p=(0,s().uB)(void 0,gs),m=(0,s().uB)(void 0,Fi),g=(0,s().K8)((()=>{if(t.open)return A().aX(t.textStore,t.oldTextValue,t.isEmptyPageTitle?"":t.insertionType)}),[t]),f=(0,s().K8)((()=>{if(g&&t.open)return A().mX(t.textStore,g)}),[g,t]),h=(0,s().K8)((()=>fs(e,f)),[e,f]),y=(0,o.useRef)(h);(0,o.useEffect)((()=>{y.current=h}),[h]);const v=(0,s().K8)((()=>!!t.open&&("+"!==t.insertionType||""!==h)),[h,t]),b=(0,s().K8)((()=>Pt().ao()),[]),w=v&&(b&&(n||a)||r),{clearSavedSelection:C,getSavedSelection:T}=(0,Di().A)({shouldPreserveTextSelection:w,shouldPreserveBlockSelection:!1,shouldRestoreSelection:w});(0,o.useEffect)((()=>{const e=Vi().A.state;if(e.open){var t;const n=I().default.state,o="editing"===n.mode?(0,M().H7)(n.multiSelection):void 0,i=(null==o?void 0:o.store)===e.textStore,s=T().textSelectionState,a=s&&"editing"===s.mode&&(null===(t=(0,M().H7)(s.multiSelection))||void 0===t?void 0:t.store)===e.textStore;if(!i&&!a)return void Bi().VN();const r=i&&(null==o?void 0:o.selection);if(g&&r&&(r.startIndex<g.filter.startIndex||r.endIndex>g.filter.endIndex))return void Bi().VN();const l=f&&f[0];if("+"===e.insertionType&&l&&!(0,Li().D$)(l))return void Bi().VN();if("@"===e.insertionType&&l&&(0,Li().Yv)(l))return void Bi().VN();if(void 0===f&&!e.isEmptyPageTitle)return void Bi().VN()}}),[f,T,g]);const{device:_}=e,[B,R]=(0,o.useState)(void 0),L=Ri().A.getSize(),D=(0,s().K8)((()=>{if(_.isMobile&&0!==L)return Ri().A.find((e=>e.isCaptured()))}),[_,L]);(0,o.useEffect)((()=>{const e=null==D?void 0:D.getNode();if(e){const t=new(Ki().E);return t.observe(e),t.rect.addListener((e=>{R({height:`calc(100vh - ${e.state.height}px)`})})),()=>t.destroy()}}),[D]);const O=xs({usePopupOnMobile:d}),N=O?j().n.SlideUp:j().n.Popup,E=bs(e,y);return(0,P.jsx)(x().Ay,{popupType:N,open:v,originRect:t.open?t.selectionRect?{...t.selectionRect,left:t.selectionRect.left-22}:t.selectionRect:void 0,slideUpWrapStyle:B,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:12,disableMouseCapture:!a,disableContentScroll:!0,onDismiss:E,disableDarkOverlayBackground:_.isMobile,keepFocus:!0,trapFocus:!1,render:()=>_.isMobile?(0,P.jsxs)(P.Fragment,{children:[!r&&(0,P.jsx)(_r,{query:h,queryRef:y,clearSavedSelection:C,inviteTargetsStore:c,personPropertyInviteStore:u,mentionMenuCurrentMentionStore:p,mentionMenuCurrentFormulaStore:m}),(0,P.jsx)(x().Ay,{popupType:j().n.SlideUp,render:()=>(0,P.jsx)(Ms,{clearSavedSelection:C,filter:f}),open:n,keepFocus:!0,trapFocus:!1}),(0,P.jsx)(x().Ay,{popupType:j().n.SlideUp,render:()=>(0,P.jsx)(js,{inviteTargetsStore:c,personPropertyInviteStore:u,filter:f}),open:a,keepFocus:!0,trapFocus:!1}),(0,P.jsx)(x().Ay,{popupType:N,render:()=>(0,P.jsx)(Ns,{mentionMenuCurrentMentionStore:p,menuPopupType:O?S().gu.ActionSheet:S().gu.Popup}),open:r,keepFocus:!0,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:B,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Start,originGap:12,isFullWidthOnMobile:!0,trapFocus:!1}),(0,P.jsx)(x().Ay,{keepFocus:!0,open:l,popupType:j().n.SlideUp,render:()=>(0,P.jsx)(us,{mentionMenuCurrentFormulaStore:m,queryRef:y}),trapFocus:!1})]}):n?(0,P.jsx)(Ms,{clearSavedSelection:C,filter:f}):a?(0,P.jsx)(js,{inviteTargetsStore:c,personPropertyInviteStore:u,filter:f}):r?(0,P.jsx)(Ns,{mentionMenuCurrentMentionStore:p,menuPopupType:S().gu.Popup}):l?(0,P.jsx)(us,{mentionMenuCurrentFormulaStore:m,queryRef:y}):(0,P.jsx)(_r,{query:h,queryRef:y,clearSavedSelection:C,inviteTargetsStore:c,personPropertyInviteStore:u,mentionMenuCurrentMentionStore:p,mentionMenuCurrentFormulaStore:m})})}var Lr=()=>n(415651),Dr=()=>n(490884),Or=()=>n(559926),Nr=()=>n(209660),Er=()=>n(755199),Ur=()=>n(680074);const Fr={...Dr().k2,csv:[...Dr().k2.csv,"text/csv"]},Vr=Dr().fF.filter((e=>["csv","docx","html","txt","markdown","pdf"].includes(e)));function Kr(e){return Object.keys(Fr).includes(e)}function Hr(e){var t;const{type:n,environment:o}=e,i=function(e){for(const t of Object.keys(Fr)){if(!Kr(t))continue;const n=Fr[t];if((Array.isArray(n)?n.flat(1/0):[n]).includes(e))return t}}(n);if(!i||"string"!=typeof n||!Vr.includes(i))return;const s=(0,Ur().R$)(o),a=null==s||null===(t=s.getSettings())||void 0===t?void 0:t.adoption_entry_points,r=a?null==a?void 0:a.import_nudge_on_drag:void 0;if(r){const e=J().default.getConfigKey("adoption_entry_point_time_delta","import_nudge_on_drag"),t=r[r.length-1];if(!(Date.now()-t>e.view_delta))return}"nudge_on_drag"===J().default.getEligibleGroup({experimentId:"adoption_import_contextual_entry_points",defaultGroup:"control"})&&((0,qn().t)({environment:o,action:"view",from:"import_nudge_on_drag"}),qa().Iz({message:Lt().A.formatMessage(zr.triggerNudgeOnDragDescription),presentationType:"transient",id:"nudge-on-drag",title:Lt().A.formatMessage(zr.triggerNudgeOnDragTitle),onUserDismiss:()=>{(0,qn().t)({environment:o,action:"dismiss",from:"import_nudge_on_drag"})},onDismiss:()=>{Er().pr(o,{entryPoint:"import_nudge_on_drag"})},actions:{primary:{title:Lt().A.formatMessage(zr.triggerNudgeOnDragPrimaryAction),onAction:()=>{(0,qn().t)({environment:o,action:"click",from:"import_nudge_on_drag"}),Or().kY(o,{from:"import_nudge_on_drag"}),qa().UW("nudge-on-drag"),Nr().Ow({currentTab:"imports",openedFrom:"import_nudge_on_drag",subtab:i})}}}}))}const zr=(0,K().YK)({triggerNudgeOnDragTitle:{id:"adoption.nudgeOnDrag.title",defaultMessage:"Try importing your file"},triggerNudgeOnDragDescription:{id:"adoption.nudgeOnDrag.description",defaultMessage:"You can import this file to directly edit your content in a Notion database"},triggerNudgeOnDragPrimaryAction:{id:"adoption.nudgeOnDrag.primaryAction",defaultMessage:"Import now"}});const Wr=function(){const e=(0,i().v3)(),t=(0,o.useRef)(void 0);return(0,o.useEffect)((()=>{const n=t=>{var n;if(null!==(n=t.dataTransfer)&&void 0!==n&&n.types.includes("application/x.notion.tab-id"))return t.dataTransfer.dropEffect="move",void t.preventDefault();t.preventDefault(),function(e,t){const n=Lr().v7(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0});n&&Lo().IU({environment:t})}(t,e),o(t)},o=f().nF((n=>{t.current&&window.clearTimeout(t.current),t.current=window.setTimeout(Yr,function(e){const{device:t}=e;if(t.isLinux)return 2e3;if(t.isIOS&&J().default.checkGate({gateName:"ios_native_drag_handler_delay"}))return 1e3;return 200}(e),e),Lr().GB(e,{currentX:n.clientX,currentY:n.clientY})}),Gr),i=t=>{!function(e,t){var n;e.preventDefault();const o=Array.from((null===(n=e.dataTransfer)||void 0===n?void 0:n.files)||[]);o.length>0&&(Hr({environment:t,type:o[0].type}),Lr().b({environment:t,files:o,analyticsFrom:"native_drag"}))}(t,e)};return window.addEventListener("dragover",n),window.addEventListener("drop",i),()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",i)}}),[e]),null},Gr=62.5;function Yr(e){Lr().Pt(e)}var qr=()=>n(211716),$r=()=>n(906537),Qr=()=>n(35392);const Zr=function(){const e=(0,i().v3)(),t=(0,s().K8)((()=>{const e=I().default.state;if("editing"!==e.mode)return null;const t=(0,M().H7)(e.multiSelection);if(!t)return null;const{store:n,selection:o}=t;if(o.endIndex!==o.startIndex+1)return null;const i=n.getValue(),s=g().ANx(i,o.startIndex);if(!s||!g().rjO(s))return null;const[a]=g().N5L([s]);return{pageId:a,store:n}}),[]),n=(0,o.useCallback)((()=>(0,P.jsx)(Xr,{pageMentionTokenStoreState:t})),[t]);if(e.device.isMobile)return null;const a=$r().getSelectionRect();return(0,P.jsx)(Fe().A,{render:()=>{},renderTooltip:n,originRect:a,forceVisibleState:Boolean(t&&a),placement:k().W.Bottom})};function Xr(e){let{pageMentionTokenStoreState:t}=e;const n=(0,Te().DP)(),s=(0,i().v3)(),a=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault();const s=te().Bv.createChildStore(i,{table:Tn().ev,id:o});Js().uK({store:s,environment:t,visitType:qr().ig.Link,openInNew:"tab",pageVisitSource:E().y8.MentionInPage})}(e,s,t)),[s,t]),r=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault&&e.preventDefault();const s=te().Bv.createChildStore(i,{table:Tn().ev,id:o});Js().uK({store:s,environment:t,visitType:qr().ig.Link,pageVisitSource:E().y8.MentionInPage})}(e,s,t)),[s,t]);return(0,P.jsx)(ot().A,{debugName:"PageMentionOverlay",capture:!0,onEnter:r,onCommandEnter:a,children:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(K().sA,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,P.jsx)("div",{children:(0,P.jsx)(Qr().A,{onlyShowFirst:!0,name:"enter",style:{color:n.text.contrastSecondary}})})]})})}var Jr=()=>n(569577),el=()=>n(315957);function tl(){const e=(0,K().tz)(),t=(0,Te().DP)(),n=(0,i().v3)(),{device:a}=n,r=(0,s().K8)((()=>el().A.state.blockStore),[]),l=(0,s().K8)((()=>null==r?void 0:r.getTitleStore()),[r]),d=(0,s().K8)((()=>(null==r?void 0:r.canEdit())??!1),[r]),c=(0,s().K8)((()=>{var t;return(null==r||null===(t=r.getModel())||void 0===t?void 0:t.getEmptyTitlePlaceholder({getRecordModel:r.getRecordModel,userTimeZone:(0,U().P)(),intl:e}))??""}),[r,e]);if((0,o.useEffect)((()=>{const{blockStore:e}=el().A.state;if(!e)return;const t=e.getTitleStore();t&&Le().selectAllText({environment:n,store:t,canSelectAllBlocks:!1})}),[n]),!r||!l)return null;let u;return u=a.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:380},(0,P.jsx)(b().A,{...u,children:(0,P.jsx)("div",{style:ol(t),children:(0,P.jsx)(Ve().A,{store:l,disabled:!d,onEsc:()=>Jr().V(n),onEnter:()=>Jr().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:c,style:il(t),pasteBehavior:"inline",inPageFind:Oe().Os.none})})})}const nl=function(){const e=(0,i().v3)(),{device:t}=e,{blockStore:n,originRect:o}=(0,s().K8)((()=>{const{blockStore:e,originRect:t}=el().A.state;return{blockStore:e,originRect:t}}),[]);return(0,P.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:Boolean(n),originRect:o,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Center,originGap:4,onDismiss:()=>Jr().V(e),render:()=>(0,P.jsx)(tl,{}),trapFocus:!0})};function ol(e){return{display:"flex",alignItems:"center",color:e.text.primary,fontSize:"13px",padding:"4px 8px"}}function il(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}var sl=()=>n(735384),al=()=>n(246826),rl=()=>n(898286),ll=()=>n(270710),dl=()=>n(614505);function cl(e){const t=(0,K().tz)(),n=(0,i().v3)(),{device:a}=n,r=(0,s().K8)((()=>ll().A.state.clonedBlockStore),[]),l=(0,s().K8)((()=>null==r?void 0:r.getTitleStore()),[r]),d=(0,s().K8)((()=>(null==r?void 0:r.canEdit())??!1),[r]),c=(0,s().K8)((()=>{var e;if(r)return null===(e=r.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:r.getRecordModel,userTimeZone:(0,U().P)(),intl:t})}),[r,t]);(0,o.useEffect)((()=>{if(!r)return;const e=r.getTitleStore();e&&Le().selectAllText({environment:n,store:e,canSelectAllBlocks:!1})}),[r,n]);const u=(0,Te().IS)((e=>({wrapper:{display:"flex",alignItems:"center",color:e.text.primary,fontSize:"13px",padding:"4px 8px"},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]);if(!r||!l)return null;const{renderDelete:p}=e;let m;return m=a.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:380},(0,P.jsx)(b().A,{...m,children:(0,P.jsxs)("div",{style:u.wrapper,children:[(0,P.jsx)(gl,{blockStore:r}),(0,P.jsx)(Ve().A,{store:l,disabled:!d,onEsc:()=>rl().V(n),onEnter:()=>rl().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:c,style:u.input,pasteBehavior:"inline",inPageFind:Oe().Os.none}),p&&d&&(0,P.jsx)(pl,{})]})})}const ul=function(){const e=(0,i().v3)(),{device:t}=e,{clonedBlockStore:n,originRect:o}=(0,s().K8)((()=>{const{clonedBlockStore:e,originRect:t}=ll().A.state;return{clonedBlockStore:e,originRect:t}}),[]);return(0,P.jsx)(x().Ay,{popupType:t.isMobile?j().n.SlideUp:j().n.Popup,open:Boolean(n),originRect:o,placementToOrigin:k().W.Bottom,alignmentToOrigin:k().C.Center,originGap:4,onDismiss:()=>rl().V(e),render:()=>(0,P.jsx)(ml,{}),trapFocus:!0})};function pl(){const e=(0,i().v3)(),t=(0,K().tz)();return(0,P.jsx)(Ue().A,{ariaLabel:t.formatMessage({id:"renamePageMenu.deleteButton.ariaLabel",defaultMessage:"Delete"}),icon:e=>(0,sl().I)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=ll().A.state;t&&await Ro().Af({environment:e,blocks:[t],shouldCheckSuggestEdit:!0}),rl().V(e)}})}function ml(){const e=(0,s().K8)((()=>ll().A.state.renderDelete),[]);return(0,P.jsx)(cl,{renderDelete:Boolean(e)})}function gl(e){let{blockStore:t}=e;const n=(0,Te().DP)(),o=(0,i().v3)(),a={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${n.darkDividerColor}`},r=(0,s().K8)((()=>t.canEdit()),[t]),l=(0,s().K8)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),d=(0,s().K8)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.id}),[t]),c=(0,s().K8)((()=>t.getIcon()),[t]),u=(0,s().K8)((()=>t.isEmptyPage()),[t]),p=(0,s().K8)((()=>t.getType()),[t]);return r?(0,P.jsx)(dl().B,{disabled:!1,bucket:"secure",store:t,icon:c,isEmptyPage:u,size:18,style:a,iconLoggingData:{recordTable:l,source:"breadcrumb",block_type:p,collection_id:"collection"===l?d:void 0},onChange:e=>function(e,t){const{clonedBlockStore:n}=ll().A.state;if(n){const o=n.getIconStore();o&&v().createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,canUndo:!0,perform:t=>{al().KY({store:o,value:e,transaction:t})}})}}(e,o)}):(0,P.jsx)(dl().B,{disabled:!0,icon:c,isEmptyPage:u,size:18,style:a})}n(823215);var fl=()=>n(792485),hl=()=>n(713998);const yl=(0,Ao().wt)("bold",{viewBox:"0 0 16 16",svg:(0,P.jsx)("g",{children:(0,P.jsx)("path",{d:"M5.067 13.014c-.772 0-1.223-.451-1.223-1.238V4.36c0-.786.45-1.237 1.223-1.237h3.5c1.949 0 3.131.943 3.131 2.488 0 1.1-.793 1.97-1.948 2.12v.061c1.401.068 2.4 1.046 2.4 2.386 0 1.716-1.347 2.837-3.466 2.837H5.067zm1.238-5.81h1.34c1.025 0 1.633-.459 1.633-1.225 0-.738-.553-1.168-1.483-1.168h-1.49v2.392zm0 4.142h1.6c1.148 0 1.742-.472 1.742-1.347 0-.854-.642-1.32-1.804-1.32H6.305v2.667z"})})});var vl=()=>n(668725),bl=()=>n(815883),xl=()=>n(339764);const Sl=(0,Ao().wt)("italic",{viewBox:"0 0 16 16",svg:(0,P.jsx)("g",{children:(0,P.jsx)("path",{d:"M5.02 13.014c-.397 0-.67-.24-.67-.63 0-.382.266-.614.663-.614H6.42l1.593-7.404H6.612c-.396 0-.67-.239-.67-.629 0-.383.267-.615.663-.615h4.382c.397 0 .663.232.663.615 0 .39-.273.63-.67.63H9.586l-1.6 7.403h1.409c.396 0 .663.232.663.615 0 .39-.274.629-.67.629H5.02z"})})});var Ml=()=>n(657222);const Al=(0,Ao().wt)("strikethrough",{viewBox:"0 0 16 16",svg:(0,P.jsx)("g",{children:(0,P.jsx)("path",{d:"M7.973 13.191a5.695 5.695 0 01-1.75-.253 3.694 3.694 0 01-1.306-.71 2.376 2.376 0 01-.71-1.101 1.514 1.514 0 01-.062-.424c0-.205.061-.369.184-.492a.71.71 0 01.513-.185c.155 0 .28.034.376.103a.92.92 0 01.273.328c.128.296.31.554.547.772.237.215.52.379.848.493.328.114.69.17 1.087.17.45 0 .847-.066 1.19-.198.345-.136.614-.321.806-.553.196-.237.294-.506.294-.807 0-.383-.15-.688-.451-.916-.301-.232-.796-.43-1.484-.595L7.043 8.53c-.939-.21-1.636-.528-2.092-.957-.451-.433-.677-.998-.677-1.695 0-.574.158-1.082.472-1.524.32-.443.757-.787 1.313-1.033.556-.25 1.191-.376 1.907-.376.601 0 1.148.09 1.64.267.497.173.91.415 1.238.725.328.31.547.67.656 1.08a.82.82 0 01.034.177c.01.055.014.11.014.164a.625.625 0 01-.185.472c-.123.119-.29.178-.499.178-.287 0-.506-.132-.656-.397a2.244 2.244 0 00-.506-.745 1.98 1.98 0 00-.752-.458 2.897 2.897 0 00-.984-.157c-.406 0-.766.064-1.08.191a1.742 1.742 0 00-.745.527 1.233 1.233 0 00-.267.78c0 .36.148.648.444.867.301.214.784.399 1.45.554l1.169.267c1.016.227 1.756.553 2.221.977.47.42.704.998.704 1.736 0 .611-.162 1.147-.485 1.607-.32.456-.77.809-1.354 1.06-.578.25-1.262.375-2.05.375zM2.552 8.386a.363.363 0 01-.267-.11.378.378 0 01-.11-.266c0-.1.037-.187.11-.26a.352.352 0 01.267-.116h10.89c.104 0 .193.039.266.116.073.073.11.16.11.26s-.037.189-.11.266a.363.363 0 01-.267.11H2.551z"})})}),wl=(0,Ao().wt)("underline",{viewBox:"0 0 16 16",svg:(0,P.jsx)("g",{children:(0,P.jsx)("path",{d:"M8 13.191c-.843 0-1.572-.152-2.188-.458a3.46 3.46 0 01-1.421-1.292c-.333-.551-.5-1.191-.5-1.92V3.724c0-.242.071-.431.213-.568.14-.141.33-.212.567-.212.246 0 .44.071.58.212.147.137.22.326.22.568v5.653c0 .488.098.914.294 1.278.2.36.49.64.868.841.378.2.834.3 1.367.3.798 0 1.417-.22 1.86-.662.446-.442.67-1.028.67-1.757V3.724c0-.242.07-.431.211-.568.142-.141.33-.212.568-.212.246 0 .44.071.58.212.147.137.22.326.22.568V9.52c0 .729-.167 1.369-.5 1.92-.332.552-.809.982-1.428 1.292-.616.306-1.342.458-2.181.458zm-3.623 2.174a.487.487 0 01-.349-.136.464.464 0 01-.136-.342c0-.137.045-.25.136-.342a.487.487 0 01.349-.137h7.24c.14 0 .257.046.348.137a.453.453 0 01.143.342c0 .136-.048.25-.143.341a.472.472 0 01-.349.137H4.377z"})})});var kl=()=>n(519831),jl=()=>n(843005),Cl=()=>n(741496),Il=()=>n(21869),Tl=()=>n(332751);function _l(e){const{clientSkill:t}=e,n=(0,K().tz)(),o=(0,s().K8)((()=>n.formatMessage(t.displayName)),[t,n]);return(0,P.jsx)(P.Fragment,{children:o})}var Pl=()=>n(602098);function Bl(e){if(e.inMemoryRecordCache.isMockTextStore){const t=e.getRecordStoreAtRootPath();if(t.table===Tn().ev){if("automation_id"in t.getProperties())return!0}}return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof te().bx||e instanceof te().dn)).ancestor)}var Rl=()=>n(704152);function Ll(e){const t=(0,i().v3)(),{isMobile:s}=(0,i().Y0)(),a=(0,o.useRef)(null),r=async()=>{const o=I().default.state;if("empty"===o.mode)return;const i=await n(862292).T.formulas.load();n(441467).of({environment:t,blockStore:e.blockStore,multiSelection:o.multiSelection,formulasModule:i})};return(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsx)("div",{children:(0,P.jsx)(K().sA,{defaultMessage:"React to selected text",id:"inlineReactionButton.tooltip"})}),render:t=>(0,P.jsxs)(Rl().A,{ref:a,style:{display:"flex",justifyContent:"center",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:r,...t,children:[(0,n(350124).s)({width:s?22:20,height:s?22:20,marginTop:s?0:1,marginRight:e.iconOnly?0:4}),!s&&!e.iconOnly&&(0,P.jsx)(K().sA,{defaultMessage:"React",id:"inlineReactionButton.reactLabel"})]})})}Ll.displayName="InlineReactionButton";const Dl=Ll;var Ol=()=>n(328732),Nl=()=>n(962845),El=()=>n(478726),Ul=()=>n(494043),Fl=()=>n(441199),Vl=()=>n(397248),Kl=()=>n(337567),Hl=()=>n(77246),zl=()=>n(195613),Wl=()=>n(396831),Gl=()=>n(285288),Yl=()=>n(170722),ql=()=>n(369241),$l=()=>n(496889),Ql=()=>n(452558),Zl=()=>n(406699),Xl=()=>n(720263),Jl=()=>n(880922),ed=()=>n(473227);function td(e){const t=(0,i().v3)(),{isMobile:n}=(0,i().Y0)(),a=(0,s().K8)((()=>"suggest"===Hl().Uv.getMode(e.blockStore)),[e.blockStore]),r=()=>{const n=e.blockStore.getRecordStoreUIRoot();n&&n instanceof te().Bv&&n.isNavigableBlock()&&ed().PD({environment:t,navigableBlockStore:n,mode:a?"default":"suggest",location:"rich_text_menu"})},l=(0,Te().IS)((t=>({button:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",color:a?t.blueColor:t.icon.primary,...e.style},icon:{width:n?18:16,height:n?18:16,marginTop:n?0:1,marginRight:e.iconOnly?0:4}})),[n,a,e.iconOnly,e.style]);return(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:a?(0,P.jsx)(K().sA,{defaultMessage:"Turn off suggesting",id:"inlineSuggestButton.tooltipDisable"}):(0,P.jsx)(K().sA,{defaultMessage:"Suggest edits",id:"inlineSuggestButton.tooltipEnable"})}),(0,P.jsx)("div",{})]}),render:t=>(0,P.jsxs)(Rl().A,{style:l.button,disabled:e.disabled,disabledFeedback:e.disabled,onClick:r,...t,children:[(0,Jl().A)(l.icon),!n&&!e.iconOnly&&(a?(0,P.jsx)(K().sA,{defaultMessage:"Suggesting",id:"inlineSuggestButton.suggestingLabel"}):(0,P.jsx)(K().sA,{defaultMessage:"Suggest",id:"inlineSuggestButton.suggestLabel"}))]})})}var nd=()=>n(236228),od=()=>n(777849),id=()=>n(780243);function sd(){var e;if(!(0,Ge().X)("selectable_word_count"))return null;const t=null===(e=$r().get())||void 0===e?void 0:e.cloneContents(),n=t?ad(t):0;return 0===n?null:(0,P.jsx)("div",{style:{justifyContent:"center",alignSelf:"center",whiteSpace:"pre-wrap",padding:"0px 6px"},children:(0,P.jsx)(K().sA,{id:"richTextMenu.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:n}})})}function ad(e){if(0===e.childNodes.length)return 0;let t=0;for(let n=0;n<e.childNodes.length;n++){const o=e.childNodes[n];o.childNodes.length>0?t+=ad(o):o.textContent&&(t+=(0,De().sQ)(o.textContent))}return t}const rd={[Ze().xd.button]:new Set(["showActionButton","showCompletions","showDiscuss","showReact","showSuggest","showTurnInto"]),[Ze().xd.code]:new Set(["showCode","showCompletions"]),[Ze().xd.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[Ze().xd.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},ld={[Ze().xd.factory]:!0};const dd=function(){const e=(0,fl().S)(),t=(0,i().v3)(),a=(0,i().Y0)(),r=(0,s().O$)(Yl().A),{isActive:l,blockTarget:d,isAnimatingClosed:c}=r,u=(0,s().O$)(X().AppStoreMainEditorCurrentBlockStore),p=(0,s().K8)((()=>Dt().zD.isRichTextMenuSuggestionEnabled()),[]),m=(0,s().K8)((()=>{var e;return"slack_notification"===(null===(e=qs().A.getState().automationActionStore)||void 0===e?void 0:e.getType())}),[]),[g,h]=(0,o.useState)(void 0),y=(0,o.useCallback)((()=>{var e;if(!p||!u)return;const n=(0,wt().filterAndRankAssistantSurfaceActionsForContext)((0,wt().clientSkillToAssistantSurfaceAction)((0,kt().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),{type:"entrypoint",entrypoint:"richTextMenu",pageStore:u,selectionState:Et().default.state,textSelectionState:I().default.state,isMobile:t.device.isMobile,userSettings:null===(e=X().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()});return n.length?n[0]:void 0}),[p,u,t]),v=(0,s().K8)((()=>{const t=d,o=I().default.state;if(!l||"empty"===o.mode)return;const{multiSelection:i}=o,s=(0,Nl().$W)(i),a=s.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),r=(0,M().KP)(i),c=I().default.isEditingComment(),u=I().default.isEditingFormQuestion(),p=t&&"form"===t.getType(),f=u||p,h=I().default.isEditingCaption(),y=t&&t.getParentTable()===kl().Vl,v=r&&t&&i.start.store===t.getCollectionViewSourceDescriptionStoreIfSingleSource(),b=n(747100).Gb(),x=e&&e.publicEditModeStore.state,S=!(0,$a().QT)(x)&&(i.start.store.canEdit()&&i.end.store.canEdit()),A=t&&"suggest"===Hl().Uv.getMode(t),w=J().default.checkGate({gateName:"block_reactions"}),k=a.some(((e,t)=>{const n=s[t].store.table===Io().SN&&!s[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n})),j=S&&!k,C=t&&t.getType(),T=C&&rd[C],_=null==t?void 0:t.isType("button"),P=(0,Pl().u)(i.start.store)||(0,Pl().u)(i.end.store),B=Bl(i.start.store)||Bl(i.end.store);let R=!1;const L=Me().A.state.isOpen?Me().A.state:Ae().A.state.isOpen?Ae().A.state:void 0;if(L){const e=L.store.getParentStore();if((null==e?void 0:e.table)===kl().Vl){const t=e.getSchema(),n=L.property,o=(0,hl()._g)({schema:t,property:n});"text"!==(null==o?void 0:o.type)||o.ai_inference||(R=!0)}}const D={isSingleStoreSelection:r,showTurnInto:Boolean(r&&!c&&!y&&!v&&!h&&t&&j&&!_&&!A&&!f&&(P||!B)),showBold:Boolean(j),showItalic:Boolean(j),showStrikethrough:Boolean(j),showUnderline:Boolean(j)&&!m,showCode:Boolean(j)&&!m,showLink:Boolean(r&&j),showHighlight:Boolean(j)&&!m,showDiscuss:Boolean(!c&&t&&(R||!y)&&!v&&!f&&!B),showReact:Boolean(w&&!c&&t&&!y&&!v&&!B&&!f),showSuggest:Boolean(!c&&t&&!s.some((e=>e.editable.props.disableSuggestEdit))&&!y&&!v&&!B&&!b&&!k&&!f),showEquation:Boolean(r&&j&&!A&&!f&&!m),showActionButton:Boolean(r&&!c&&!h&&t&&!y&&!f&&(P||!B)),targetBlockStore:t,isComment:c,showCompletions:Boolean((0,n(68465).ZE)(x)&&j&&!c&&!h&&t&&!y&&!v&&!_&&!B&&!A&&!f),topRankedSkill:g};if(T&&T.size>0)for(const e of T)D[e]=!1;return D}),[d,l,e,g,m]),[b,x]=(0,o.useState)(v);(0,o.useEffect)((()=>{v&&x(v)}),[v]);const S=(0,s().K8)((()=>t.WindowSizeStore.state.height),[t.WindowSizeStore]),A=(0,s().K8)((()=>v&&v.showDiscuss&&!v.showBold),[v]),w=(0,o.useCallback)((()=>{if(n(711319).A.state.open||ql().A.state.open)return;if(n(620149).l.state)return Tl().I();const e=I().default.state;if("empty"===e.mode)return Tl().I();const o=(0,Nl().$W)(e.multiSelection);if(0===o.length)return Tl().I();if(!o.every((e=>{let{store:t}=e;return t.table===Tn().ev||t.table===Io().SN||t.table===kl().Vl||t.table===n(37165).lo})))return Tl().I();if(!t.currentUser.isLoggedIn()||!o.every((e=>{let{store:t}=e;return t.canComment()})))return;const i=$r().get();if(Pt().fI())return Tl().I();if(o.some((e=>{let{editable:t}=e;return t.props.disableStyleAnnotations})))return Tl().I();const s=o.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(s.some((e=>e&&e.pathIsDead())))return Tl().I();if(s.some((e=>e&&(0,Kl().dL)(e))))return Tl().I();if(s.some(((e,t)=>{const n=o[t].store.canComment(),i=o[t].store.table===Io().SN&&o[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return Tl().I();const l=o.some((e=>{let{store:t}=e;const n=t.getRecordStoreAtRootPath();if(!(n instanceof te().Bv))return!1;const o=n.getValue();return!!o&&ld[o.type]}));if(l)return Tl().I();const d=i?$r().getRect(i):void 0;if(d&&!Vl().HY(d,(0,n(59728).A)()))return Tl().I();if(ll().A.isActive()||el().A.isActive()||xi().A.isOpen()||l||Fl().default.isPeekDismissableState()||!i||!function(){const e=$r().get();return void 0!==e&&!e.collapsed&&"empty"!==I().default.state.mode&&!(0,M().kM)(I().default.state.multiSelection)}()||n(807926).A.state.open||"assistantCompletionPopup"===Nt().default.state.type)return Tl().I();let c=0,u=0;if(d){c=d.left;const e=25,t=d.top-36-e,o=n(175947).ek(a.isElectronMac),i=S-36-e;u=Math.min(Math.max(t,o),i)}0===Math.abs(Yl().A.state.top-u)&&Math.abs(Yl().A.state.left-c)<10&&(u=Yl().A.state.top,c=Yl().A.state.left),h(y()),Yl().A.setState({...r,isActive:!0,isAnimatingClosed:!1,top:u,left:c,blockTarget:Et().default.state.stores[0]})}),[t.currentUser,S,a.isElectronMac,r,h,y]),k=(0,o.useMemo)((()=>f().nF(w,200,{leading:!1})),[w]);(0,o.useEffect)((()=>(Et().default.addListener(k),I().default.addListener(k),zl().A.addListener(w),Gl().A.addListener(w),Wl().A.addListener(w),Fl().default.addListener(w),()=>{I().default.removeListener(k),Et().default.removeListener(k),zl().A.removeListener(w),Gl().A.removeListener(w),Wl().A.removeListener(w),Fl().default.removeListener(w)})),[w,k]);const j=(0,s().K8)((()=>function(e){const t=null==e?void 0:e.getParentStore();if((null==t?void 0:t.table)===Tn().ev)return!!t&&(0,El().fc)(t);return!1}(d)),[d]),C=(0,o.useCallback)((()=>{r.isActive||Yl().A.setState({...r,isAnimatingClosed:!1}),x(v)}),[r,v]);return(0,P.jsx)(tn().A,{open:l||c,children:(0,P.jsx)(ud,{handleAnimationEnd:C,isActive:l,isExternallyImportedAndSyncedCollectionPageBlockTarget:j,lastRenderState:b,richTextMenuStoreState:r,canOnlyDiscuss:A})})},cd=o.forwardRef((function(e,t){let{lastRenderState:n,richTextMenuStoreState:o,canOnlyDiscuss:i,style:s}=e;const{top:a,left:r}=o,l=Math.max(i?r:r-60,0),d=i?"12px 0":12;return(0,P.jsxs)("div",{className:Bt().Vl,style:{pointerEvents:"none",position:"absolute",top:a,left:0,display:"flex",width:"100%",...s},ref:t,children:[(0,P.jsx)("div",{style:{flexShrink:1,width:l,minWidth:24}}),(0,Do().A)((e=>(0,P.jsx)("div",{style:{pointerEvents:"none",padding:d},...e,children:n&&(0,P.jsx)(jd,{renderState:n})}))),(0,P.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})}));function ud(e){let{handleAnimationEnd:t,isActive:n,isExternallyImportedAndSyncedCollectionPageBlockTarget:o,lastRenderState:i,richTextMenuStoreState:s,canOnlyDiscuss:a}=e;return(0,P.jsx)(Eo().A,{tag:cd,visible:n&&!o,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},onAnimationEnd:t,config:{duration:120},lastRenderState:i,richTextMenuStoreState:s,canOnlyDiscuss:a})}function pd(e){let{theme:t,styles:n}=e;return(0,P.jsx)("div",{style:{height:24,width:1,borderRight:`1px solid ${t.regularDividerColor}`,margin:"auto 6px",...n}})}function md(e){let{blockStore:t}=e;const n=(0,Te().DP)(),o=(0,i().v3)(),a=(0,K().tz)();let r=(0,P.jsx)(K().sA,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const l=(0,s().K8)((()=>t.getType()),[t]);if(l){const e=Ol().ry[l];r=e&&e.displayName||r}return(0,P.jsx)(Zl().Ay,{popupType:Zl().z7.Popup,buttonPopupStore:ql().A,originGap:4,renderOrigin:e=>(0,P.jsx)(Fe().A,{renderTooltip:()=>a.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:t=>(0,P.jsxs)(Rl().A,{style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",color:n.icon.primary,borderRadius:6},...(0,ea().A)(e,t),children:[r,(0,vl().b)({width:10,marginLeft:4,fill:n.lightIconColor})]})}),render:()=>(0,P.jsx)(b().A,{menuType:S().gu.Popup,children:(0,P.jsx)(Ql().A,{context:{blocks:[t],environment:o,publicEditMode:void 0,analyticsFrom:"rich_text_menu"},sections:[jl().t3],onAccept:e=>{const n=t.getType(),i=t.getFormat();Tl().I(),(0,Cl().N)(o,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"rich_text_menu",block_id:t.id,block_type:n,is_toggleable:n?(0,Ul().Yt)(n,i):void 0,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}})}),onClick:()=>{(0,Il().s)(o,{action:"turn_into"})}})}function gd(){const e=(0,Te().DP)();return(0,P.jsx)(nd().A,{type:"b",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(K().sA,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Qr().A,{style:{color:e.text.contrastSecondary},name:"toggleBold"})})]}),children:yl({width:16,height:16})})}function fd(){const e=(0,Te().DP)();return(0,P.jsx)(nd().A,{type:"i",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(K().sA,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Qr().A,{style:{color:e.text.contrastSecondary},name:"toggleItalics"})})]}),children:Sl({width:16,height:16})})}function hd(){const e=(0,Te().DP)();return(0,P.jsx)(nd().A,{type:"s",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(K().sA,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Qr().A,{style:{color:e.text.contrastSecondary},name:"toggleStrike"})})]}),children:Al({width:16,height:16})})}function yd(){const e=(0,Te().DP)();return(0,P.jsx)(nd().A,{type:"_",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(K().sA,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Qr().A,{style:{color:e.text.contrastSecondary},name:"toggleUnderline"})})]}),children:wl({width:16,height:16})})}function vd(){const e=(0,Te().DP)();return(0,P.jsx)(nd().A,{type:"c",tooltipLabel:(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)("div",{children:(0,P.jsx)(K().sA,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Qr().A,{style:{color:e.text.contrastSecondary},name:"toggleCode"})})]}),children:(0,bl().N)({width:16,height:16})})}function bd(e){let{}=e;const t=(0,Te().DP)();return(0,P.jsx)(id().A,{children:(0,P.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[(0,Ml().w)({width:16,height:16,color:t.icon.primary}),(0,vl().b)({width:10,fill:t.lightIconColor})]})})}function xd(e){let{intl:t,topRankedSkill:n}=e;const o=(0,Te().DP)(),a=(0,i().v3)(),r=(0,s().K8)((()=>Dt().zD.isXMLAssistantEnabled()),[]);return(0,P.jsxs)(P.Fragment,{children:[n&&(0,P.jsxs)(Rl().A,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6},onClick:()=>{(0,xt().Nj)({environment:a,clientSkillWithParameterValues:(0,kt().dangerouslyCreateClientSkillWithParameterValues)(n),from:"rich_text_menu",assistantSurfaceType:a.device.isMobile?"mobileWriter":"writer"}),(0,Il().s)(a,{action:"completions"})},children:[n.icon({width:16,height:16,marginRight:6,fill:(0,jt().vJ)(n.category).color(o).color}),(0,P.jsx)("span",{children:(0,P.jsx)(_l,{clientSkill:n})})]}),(0,P.jsx)(Fe().A,{renderTooltip:()=>(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{children:r?t.formatMessage({defaultMessage:"Make edits, find answers, and more",id:"richTextMenu.assist.assistantTooltip"}):t.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,P.jsx)("div",{children:(0,P.jsx)(Qr().A,{style:{color:o.text.contrastSecondary},name:"commandJ"})})]}),render:e=>(0,P.jsxs)(Rl().A,{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 6px",whiteSpace:"nowrap",borderRadius:6,height:28},...e,onClick:()=>{(0,Mt().toggleInitialPrompt)({from:"rich_text_menu",environment:a}),(0,Il().s)(a,{action:"completions"})},children:[(0,P.jsx)(At().iB,{}),(0,P.jsx)("span",{style:{marginLeft:6,marginRight:2},children:(0,P.jsx)(K().sA,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})]})}function Sd(){const e=(0,i().v3)();return(0,P.jsx)(od().A,{onClick:()=>{(0,Il().s)(e,{action:"e"}),Tl().I()},children:(0,xl().c)({width:16,height:16})})}function Md(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,Te().DP)(),i=(0,K().tz)();return(0,P.jsx)(Xl().A,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28},iconOnly:n,blockStore:t,ariaLabel:i.formatMessage({id:"richTextMenu.Discussions.OpenDiscussionButton",defaultMessage:"Write a comment"})})}function Ad(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,Te().DP)();return(0,P.jsx)(Dl,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28,width:n?28:void 0},iconOnly:n,blockStore:t})}function wd(e){let{targetBlockStore:t,iconOnly:n}=e;return(0,P.jsx)(td,{style:{borderRadius:6,height:28},iconOnly:n,blockStore:t})}function kd(e){let{targetBlockStore:t}=e;const n=(0,Te().DP)(),o=(0,i().v3)();return(0,P.jsx)($l().A,{store:t,style:{borderRadius:6,padding:6,width:28,height:28},iconStyle:{fill:n.icon.primary},fadeIn:!1,onClick:()=>{(0,Il().s)(o,{action:"more"})}})}function jd(e){let{renderState:t}=e;const o=(0,K().tz)(),i=(0,Te().DP)(),a=(0,s().K8)((()=>Yl().A.state.isActive),[]),r=t.showDiscuss||t.showReact||t.showSuggest,l=t.showBold||t.showItalic||t.showUnderline||t.showStrikethrough||t.showCode||t.showEquation||t.showHighlight,d=l;return(0,P.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:36,background:i.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:8,boxShadow:i.shadowMD,pointerEvents:a?"auto":"none",padding:"4px"},onMouseDown:e=>e.preventDefault(),children:[t.showCompletions&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(xd,{intl:o,topRankedSkill:t.topRankedSkill}),(0,P.jsx)(pd,{theme:i})]}),r&&t.targetBlockStore&&(0,P.jsxs)(P.Fragment,{children:[t.showDiscuss&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Md,{targetBlockStore:t.targetBlockStore,iconOnly:!1}),!d&&(t.showReact||t.showSuggest)&&(0,P.jsx)(pd,{theme:i})]}),t.showReact&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Ad,{targetBlockStore:t.targetBlockStore,iconOnly:d}),!d&&t.showSuggest&&(0,P.jsx)(pd,{theme:i})]}),t.showSuggest&&(0,P.jsx)(wd,{targetBlockStore:t.targetBlockStore,iconOnly:d}),l&&(0,P.jsx)(pd,{theme:i})]}),l&&(0,P.jsxs)(P.Fragment,{children:[t.showTurnInto&&t.targetBlockStore&&(0,P.jsx)(md,{blockStore:t.targetBlockStore}),(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[t.showBold&&(0,P.jsx)(gd,{}),t.showItalic&&(0,P.jsx)(fd,{}),t.showUnderline&&(0,P.jsx)(yd,{}),t.showStrikethrough&&(0,P.jsx)(hd,{}),t.showCode&&(0,P.jsx)(vd,{}),t.showEquation&&(0,P.jsx)(Sd,{})]}),t.showLink&&(0,P.jsx)(bd,{}),t.showHighlight&&(0,P.jsx)(n(213799).A,{blockStore:t.targetBlockStore})]}),(0,P.jsx)(sd,{}),t.showActionButton&&t.targetBlockStore&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(pd,{theme:i}),(0,P.jsx)(kd,{targetBlockStore:t.targetBlockStore})]})]})}var Cd=()=>n(753199),Id=()=>n(489348),Td=()=>n(869562),_d=()=>n(749687);const Pd=5,Bd=18,Rd=.38;const Ld=function(){const e=(0,i().v3)(),t=(0,o.useRef)(void 0),n=(0,o.useRef)(void 0),a=(0,o.useRef)(1/0),r=(0,o.useRef)(void 0),l=(0,s().K8)((()=>e.WindowSizeStore.state.width),[e]);return(0,o.useEffect)((()=>{l<Td().OnlyOneSidebarVisibleWidthThreshold&&(0,qe().Nk)(e)&&(0,qe().KB)(e)&&Td().setExpand({environment:e,isExpanded:!1,from:"sidebar_listener",saveDetailsSidebarPreference:!1})}),[e,l]),(0,o.useEffect)((()=>{const o=o=>{!function(e){let{e:t,environment:n,timerRef:o,cachedPageViewRectRef:i,previousMousePositionRef:s,mouseSpeedRef:a}=e;(0,Cd().SQ)({event:t,context:Cd().y$.SidebarMouseMove,callback:()=>{Od(i),void 0!==s.current&&(a.current=Math.sqrt(Math.pow(t.clientX-s.current.x,2)+Math.pow(t.clientY-s.current.y,2))),function(e){let{x:t,y:n,timerRef:o,previousMousePositionRef:i}=e;i.current={x:t,y:n},clearTimeout(o.current),o.current=setTimeout((()=>{i.current=void 0}),100)}({x:t.clientX,y:t.clientY,timerRef:o,previousMousePositionRef:s});const e=J().default.checkGate({gateName:"sidebar_hover_expansion_v3"});if(i.current){const o=_d().sidebarOpenStore.state,s=t.clientX,r=i.current.left,l=Math.max(r*Rd,Bd,_d().sidebarMousePeekXStore.state);s<l&&!ka().default.isCenterPeekOpen()&&a.current<Pd&&0!==a.current&&!o&&!e&&Td().open({fromElectron:!1}),s>(0,qe().r6)(n)&&s>l&&o&&Td().close()}}})}({e:o,environment:e,timerRef:r,cachedPageViewRectRef:t,previousMousePositionRef:n,mouseSpeedRef:a})};return window.addEventListener("mousemove",o),window.addEventListener("mouseout",Dd),()=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseout",Dd)}}),[e]),(0,P.jsx)(P.Fragment,{})};function Dd(e){e.toElement||e.relatedTarget||Td().close()}const Od=f().nF((function(e){const t=function(){const{mainEditorCurrentBlockStore:e}=X().default.state,t=Id().A.find((t=>t.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}();e.current=t?t.getBoundingClientRect():document.body.getBoundingClientRect()}),500);var Nd=()=>n(171789),Ed=(n(803949),()=>n(662303)),Ud=()=>n(484392),Fd=()=>n(177167),Vd=()=>n(201902),Kd=()=>n(246760),Hd=()=>n(25729),zd=()=>n(846693),Wd=()=>n(161479),Gd=()=>n(232802),Yd=()=>n(979340),qd=()=>n(148024),$d=()=>n(901389),Qd=()=>n(435009),Zd=()=>n(82926),Xd=()=>n(120303),Jd=()=>n(112995),ec=()=>n(650843),tc=()=>n(878377),nc=()=>n(777092),oc=()=>n(600871),ic=()=>n(891078),sc=()=>n(570323),ac=()=>n(548821),rc=()=>n(991249),lc=()=>n(324561),dc=()=>n(807778),cc=()=>n(134217),uc=()=>n(10984),pc=()=>n(201145),mc=()=>n(138405),gc=()=>n(667474),fc=()=>n(270812),hc=()=>n(71743),yc=()=>n(749240),vc=()=>n(958846),bc=()=>n(187485),xc=()=>n(460292),Sc=()=>n(554509),Mc=()=>n(864943),Ac=()=>n(204063),wc=()=>n(2143),kc=()=>n(64901),jc=()=>n(221844),Cc=()=>n(970013),Ic=()=>n(452540),Tc=()=>n(388821),_c=()=>n(696706),Pc=()=>n(869558),Bc=()=>n(299772);const Rc=function(e){const t=(0,i().v3)(),a=(0,s().K8)((()=>e.blockStore.getAssociatedCollectionStore()),[e.blockStore]),r=(0,s().K8)((()=>{var e;return null==a||null===(e=a.getLayoutStore())||void 0===e?void 0:e.getModules()}),[a]),l=(0,s().K8)((()=>{if(!a)return 0;const{count:e}=(0,Ye().pm)({collectionStore:a});return e}),[a]),{device:{isMobile:d}}=(0,i().v3)(),c=l>0&&!d,u=(0,Te().IS)((e=>({spinnerWrapper:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},scroller:{background:e.contentBackground,zIndex:1,flexGrow:1,...c&&{paddingLeft:70,paddingRight:70}},container:{display:"flex",flexDirection:"row",flexGrow:1,overflow:"hidden"},layoutDetailsSidebar:{width:n(154807).xt,flexShrink:0,borderLeft:`1px solid ${e.stroke.secondary}`}})),[c]),p=(0,o.useCallback)((e=>{Zd().un(),Qd().oo({environment:t,url:e})}),[t]),m=e.blockStore.id,h=e.timestamp,[y]=(0,pe().Yb)((async()=>await async function(e,t,n){const{timestamp:o}=e,i=e.block.id,s=await z().callApi({eventName:"getSnapshotContents",environment:n,data:e});if("failed"===s.type)throw s.error;const a=Tc().RecordMapWithRole.create(s.data.contentMap),r=n.currentUser.id,l=new(jc().A)({name:"PageSnapshotPreview"});for(const{pointer:m,model:g}of a)g&&l.setModelAndRole({pointer:m,userId:r},g,"reader");l.snapshotData={blockId:i,timestamp:o};const d=new Map,c=e=>{const n=l.getRecord({pointer:e,userId:r}),o=(0,Ic().jV)(e);n||!(0,Ya().uj)(e.id)||d.has(o)||d.set(o,(0,te().Oo)(t,e))},u=[];for(const{model:m}of a)if(m)if(m.table===Tn().ev){const e=m,t=e.getProperties(),n=_c().L3.uniq(f().Bq(Object.keys(t).map((e=>t[e])).map(g().moK)));for(const d of n)c(d);const o=_c().L3.uniq(f().Bq(Object.keys(t).map((e=>t[e])).map(hl().n)));for(const d of o)c(d);const i=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of i)c({table:Tn().ev,id:d});const s=e.getCollectionPointer();s&&(c(s),u.push(s.id));const a=f().sb(f().Bq(Object.keys(t).map((e=>t[e])).map(g().Fbh)));for(const d of a)c({table:Wa().oo,id:d});const r=m.getCreatedByPointer();r&&c(r);const l=m.getLastEditedByPointer();l&&c(l)}else if(m.table===Pc().Gy){var p;const e=null===(p=m.getFormat())||void 0===p?void 0:p.collection_pointer;e&&c(e)}else if(m.table===Io().SN){const e=m.getCreatedByPointer();e&&c(e)}return await Lc({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:r}),u.forEach((e=>{var t;const n=null===(t=l.getRecord({pointer:{table:kl().Vl,id:e},userId:r}))||void 0===t?void 0:t.value;n&&n.schema&&Object.keys(n.schema).forEach((e=>{var t;const o=null===(t=n.schema)||void 0===t?void 0:t[e],i=o&&(0,Cc().nC)(o)?(0,Cc().zO)(o):void 0;i&&c({table:kl().Vl,id:i})}))})),await Lc({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:r}),{blockStore:new(te().Bv)(n,{table:Tn().ev,id:i},{inMemoryRecordCache:l}),timestamp:o}}({block:{id:m,spaceId:(0,Wd().e)(e.blockStore.pointer.spaceId)},timestamp:h},e.blockStore,t)),[m,t,e.blockStore,h]),v="pending"!==y.status&&"idle"!==y.status,b=y.value,x=y.error,S=(0,Da().A)(!v||!b,400,400),M=(0,s().K8)((()=>{if(S)return(0,P.jsx)("div",{style:u.spinnerWrapper,children:(0,P.jsx)(Zn().A,{})});if(x)return(0,P.jsx)("div",{style:{padding:32},children:(0,P.jsx)(K().sA,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})});const o=(0,Pt().fl)({environment:t,store:e.blockStore});return b?(0,P.jsxs)(n(21140).Ye,{style:u.container,children:[(0,P.jsx)(st().A,{store:b.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:n}=e;return(0,P.jsx)(wc().H,{style:u.scroller,type:o,...n,children:(0,P.jsx)(Bc().Ay,{store:b.blockStore,disabled:!0,context:ac().Rr.InPageSnapShot,paddingBottom:(0,Bc().Wj)(t),layoutModulesByArea:r})})}},b.timestamp),c&&(null==r?void 0:r.page_details)&&(0,P.jsx)(wc().H,{style:u.layoutDetailsSidebar,type:tt().A.Y,children:(0,P.jsx)(n(146594).H,{store:b.blockStore,context:ac().Rr.InPageSnapShot,disabled:!0,shownAs:"static_sidebar",modules:r.page_details})})]}):void 0}),[S,x,t,e.blockStore,b,u.spinnerWrapper,u.container,u.layoutDetailsSidebar,u.scroller,c,r]);return(0,P.jsx)(Jd().K,{from:"PageSnapshotPreview",fallback:e=>{let{error:t,errorId:n}=e;return(0,P.jsx)(ec().LargeSurfaceRenderError,{error:t,errorId:n})},children:(0,P.jsx)(n(484792).B,{value:p,children:M})})};async function Lc(e){const{relatedStoresMap:t,inMemoryRecordCache:n,currentUserId:o}=e,i=Array.from(t.values());await(0,cr().lX)(i,25,(async e=>{await e.load();const t=e.getValue();t&&n.setRecord({pointer:e.pointer,userId:o},{role:"reader",value:t})}))}const Dc={SnapshotAdminDebugButton:new(d().O2)("SnapshotAdminDebugButton",(async()=>await n.e(14201).then(n.bind(n,523402))))},Oc=(0,d().jQ)(Dc.SnapshotAdminDebugButton,(e=>e.SnapshotAdminDebugButton));var Nc=()=>n(147577);const Ec={display:"flex",justifyContent:"center",padding:32},Uc=(0,K().YK)({restoreSnapshotError:{id:"historyModal.restoreSnapshot.errorMessage",defaultMessage:"Failed to restore version."}});const Fc=function(){const e=(0,K().tz)(),t=(0,i().v3)(),{device:o}=t,a=(0,s().O$)(sc().A),r=su();return o.isMobile?(0,P.jsx)(x().Ay,{ariaLabel:Yc(e),popupType:j().n.SlideUp,open:a.open,render:()=>(0,P.jsx)(iu,{}),onDismiss:Zd().un}):(0,P.jsx)(n(676007).A,{ariaLabel:Yc(e),open:a.open,innerStyle:r.modal,onDismiss:Zd().un,render:()=>(0,P.jsx)(iu,{}),className:Bt().uMd})},Vc=(0,P.jsx)(K().sA,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function Kc(){return zd().MO.filter((e=>"personal"!==e.tier))}function Hc(e){const t=Kc(),n=t.findIndex((t=>t.tier===e));if(!(n<=0))return t[n-1]}function zc(e){var t;if(G().A.isAdminMode)return;const{nextFutureSnapshot:n}=e;if(!n)return;const o=(i=n,(Date.now()-parseInt(i.timestamp))/_n().nD);var i;if((0,uc().sP)()&&o<=zd().et.plus.days)return;const s=function(e){return Kc().filter((t=>t.days>e)).map((e=>e.tier))}(o);if((0,uc().bw)(s))return;const a=s[0]??"enterprise";return(0,Yd().dL)(a)?void 0:{tier:a,message:(0,P.jsx)(K().sA,{defaultMessage:"Please upgrade to the {upsellTier} plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,Ud().A)((0,Yd().$P)(a)?"plus":a),snapshotLimitDays:(null===(t=Hc(a))||void 0===t?void 0:t.days)??Math.floor(o)}})}}function Wc(){return(0,P.jsx)(kc().A,{href:(0,Ne().xS)("guides.pageHistory"),analyticsFrom:"page_history"})}function Gc(e,t){const{device:n}=t;return!n.isMobile||"personal"===e&&(0,oc().mM)({environment:t})}function Yc(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function qc(e){const{device:t}=e;return t.isMobile?24:20}function $c(e){let{menuState:t}=e;const n=(0,i().v3)(),a=(0,s().K8)((()=>t.blockStore.getIcon()),[t.blockStore]),r=(0,s().K8)((()=>t.blockStore.isEmptyPage()),[t.blockStore]),l=su();return t.snapshot?(0,P.jsxs)(o.Fragment,{children:[(0,P.jsxs)("div",{style:l.header,children:[a?(0,P.jsx)(dl().B,{disabled:!0,icon:a,isEmptyPage:r,size:qc(n)}):null,a?null:(0,P.jsx)(xc().Q,{iconGroup:Vd().M,variantName:"default",colorName:"secondary"}),(0,P.jsx)(Sc().D,{styleName:"Body-14px/Regular",colorName:"tertiary",children:(0,P.jsx)(ja().A,{store:t.blockStore})})]}),(0,P.jsx)(Rc,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp})]}):null}function Qc(e,t){rc().K(t,{from:"history_modal",upsell:{type:"product",product:e,limit:{type:"none"},trialability:"none"}})}function Zc(e){let{message:t,showUpgradeButtonForTier:n}=e;const o=(0,i().v3)(),{device:a}=o,r=(0,s().K8)((()=>cc().qc(yc().subscriptionDataStoreInstance.state)),[]),l=su();let d=Gc(n,o);return d&&(0,oc().mM)({environment:o})&&"personal"===n&&!r&&(d=!1),r||(d=!1),(0,P.jsxs)("div",{style:a.isMobile?l.unavailableMessageComponentMobile:l.unavailableMessageComponent,children:[Gc(n,o)?(0,P.jsx)("img",{src:$s().A.images.icons.clockArrowLockSvg,alt:"locked clock icon"}):null,(0,P.jsx)("div",{style:{...!a.isMobile&&{maxWidth:283}},children:t}),d&&n?(0,P.jsx)(Mc().A,{size:"lg",onClick:()=>Qc(n,o),style:l.upsell,icon:()=>(0,P.jsx)(xc().Q,{iconGroup:Hd().k,variantName:"fill",colorName:"uiBluePrimary"}),children:(0,P.jsx)(K().sA,{defaultMessage:"Upgrade plan",id:"historyModal.upgradeForHistoryButton.labelVHR"})}):null]})}function Xc(e){const t=(0,K().tz)(),{requestUpgradeTier:n}=e,{requestState:o,openModal:i}=(0,fc().E)({feature:n,entrypoint:"version_history",analyticsEntrypoint:"version_history"}),s=(0,gc().j)(o,t),a=(0,mc().k)(o,t),r=su();return(0,P.jsxs)("div",{style:r.unavailableMessageComponent,children:[(0,P.jsx)("img",{src:$s().A.images.icons.clockArrowLockSvg,alt:"locked clock icon"}),(0,P.jsx)("div",{style:{maxWidth:283},children:(0,P.jsx)(K().sA,{defaultMessage:"Your workspace owners must upgrade to the {requestUpgradeTier} plan to restore this page.",id:"historyModal.desktopModal.requestUpgradeMessage",values:{requestUpgradeTier:(0,Ud().A)(n)}})}),(0,P.jsx)(hc().U,{onClick:i,label:s,testId:`${n}-request-button`,disabledTooltip:a,tooltipPlacement:k().W.Bottom,useOutlineButton:!0})]})}function Jc(e){const t=(0,i().v3)(),n=(0,K().tz)(),{device:a}=t,{menuState:r,loadingMore:l}=e,d=(0,Da().A)(l,300,100),c=su();const u=function(e){const t=new Map;return e.forEach((e=>{const n=(0,ra().W_)(parseInt(e.timestamp),"very_short",Ed().locale),o=t.get(n)??0;t.set(n,o+1)})),t}(e.snapshotValues),p=(0,o.useCallback)((e=>{const t=e>Date.now()-6*_n().nD,n=u.get((0,ra().W_)(e,"very_short",Ed().locale));return!!n&&(n>1||t)}),[u]),m=(0,s().K8)((()=>f().oE(e.snapshotValues.map(((o,i)=>{const s=i>0?e.snapshotValues[i-1]:void 0,l=!zc({snapshot:o,nextFutureSnapshot:s});return{key:o.id,action:()=>{Zd().Xn({environment:t,snapshot:o,nextFutureSnapshot:s})},render:e=>{const t=o.authors||[],i=n.formatList(f().oE(t.map((e=>(0,nc().JQ)({parentStore:r.blockStore,pointer:e}).getDisplayName(n)))),{type:"conjunction",style:"narrow"}),s=(0,P.jsx)("div",{style:{...Be().RC},children:i}),d=Boolean(r.snapshot&&r.snapshot.id===o.id),u=parseInt(o.timestamp),m=p(u),g=new Date(u).getFullYear()!==(new Date).getFullYear()?"long":"month_day_long",h=m?(0,ra().jE)(u,Ed().locale,n,"·",g):(0,ra().W_)(u,g,Ed().locale);return l?(0,P.jsx)(Ut().A,{...e,title:h,focused:!a.isMobile&&d,caption:s,buttonStyle:c.buttonMenuItem,itemMarginLeft:8,right:G().A.isAdminMode?(0,P.jsx)(Oc,{snapshot:o}):null}):(0,P.jsx)(Ut().A,{...e,title:(0,P.jsx)("div",{style:c.menuItem,children:(0,P.jsx)("div",{style:{...a.isMobile&&{display:"flex",flex:1},...Be().RC},children:h})}),focused:!a.isMobile&&d,caption:s,right:(0,P.jsx)(xc().Q,{iconGroup:Fd().x,variantName:"small",colorName:"tertiary"}),buttonStyle:c.buttonMenuItem,itemMarginLeft:8,rightStyle:{marginRight:"7px"}})}}})))),[e.snapshotValues,a.isMobile,t,n,r.blockStore,r.snapshot,c,p]),g=r.snapshot&&r.snapshot.id,h=m.findIndex((e=>g===e.key)),y=[{key:"snapshots",render:e=>(0,P.jsx)(Vt().A,{...e}),items:m}];return(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,initialFocus:h,sections:y}),(0,P.jsx)(vc().A,{loading:l,fetchSize:r.size,resultSize:e.snapshotValues.length,onLoadMore:Zd().p2}),d&&(0,P.jsx)("div",{style:Ec,children:(0,P.jsx)(Zn().A,{})})]})}function eu(e){let{menuState:t,onRestoreSnapshot:n}=e;const o=(0,i().v3)();return(0,P.jsx)(x().Ay,{popupType:j().n.SlideUp,open:Boolean(t.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!t.snapshot)return null;const e=zc({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot}),i=!e,s=i?(0,P.jsx)(Rc,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp}):(0,P.jsx)(Zc,{message:e.message,showUpgradeButtonForTier:e.tier}),a=!i&&o.device.isMobileBrowser;return(0,P.jsx)(b().A,{menuType:S().gu.Modal,title:(0,ra().jE)(parseInt(t.snapshot.timestamp),Ed().locale,Lt().A.getIntl()),right:(0,P.jsx)(it().DoneMenuText,{}),onClickRight:Zd().j8,leftDisabled:!i&&!o.device.isMobileBrowser,left:a?(0,P.jsx)(K().sA,{defaultMessage:"Upgrade",id:"historyModal.mobileSnapshotMenu.upgradeButton.label"}):(0,P.jsx)(K().sA,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>(async()=>{a?Qc(e.tier,o):await n()})(),whiteBackground:i,forceFullScreenSlideUp:!0,children:s})}})}function tu(e){const t=(0,i().v3)(),{menuState:n}=e,o=(0,ic().i0)(n.blockStore),a=(0,ic().ty)(n.blockStore),r=(0,s().K8)((()=>Boolean(n.snapshot&&!o&&!a&&!zc({snapshot:n.snapshot,nextFutureSnapshot:n.nextFutureSnapshot})&&function(e,t){return(0,tc().Xmj)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(n,t))),[t,n,o,a]),l=su();return(0,P.jsxs)("div",{style:l.sidebarStyle,children:[(0,P.jsxs)("div",{style:l.sidebarHeader,children:[(0,P.jsx)(Sc().D,{styleName:"Heading-17px/Semibold",colorName:"primary",customStyles:{fontSize:16},children:(0,P.jsx)(K().sA,{id:"historyModal.desktopModal.sidebar.title",defaultMessage:"Version history"})}),(0,P.jsx)(Xd().R,{onClick:Zd().un,style:l.dismiss})]}),(0,P.jsx)(wc().H,{type:tt().A.Y,style:{flex:1},children:(0,P.jsx)(Jc,{...e})}),(0,P.jsxs)("div",{style:l.actions,children:[(0,P.jsx)(Uo().p,{size:"lg",style:l.learnMoreButton,onClick:()=>{qd().FH(t,{from:"page_history"}),Qd().oo({environment:t,url:(0,Ne().xS)("guides.pageHistory"),openInNew:"tab"})},icon:()=>(0,P.jsx)(xc().Q,{iconGroup:Kd().G,variantName:"small",colorName:"secondary"}),children:(0,P.jsx)(Sc().D,{colorName:"secondary",children:(0,P.jsx)(K().sA,{defaultMessage:"Learn more",id:"historyModal.desktopModal.learnMoreButtonVHR.label"})})}),(0,P.jsx)(Fe().A,{disableTooltip:r,renderTooltip:()=>a?(0,P.jsx)(K().sA,{defaultMessage:"Resolve pending edits to restore snapshots.",id:"historyModal.desktopModal.sidebar.resolvePendingEdits.tooltip"}):o?(0,P.jsx)(K().sA,{defaultMessage:"Restore page from trash to restore snapshots.",id:"historyModal.desktopModal.sidebar.restorePageFromTrashMessage.tooltip"}):(0,P.jsx)(K().sA,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:t=>(0,P.jsx)(Ac().A,{size:"lg",onClick:e.onRestoreSnapshot,disabled:!r,...t,style:l.restoreButton,children:(0,P.jsx)(K().sA,{defaultMessage:"Restore",id:"historyModal.desktopModal.restoreButtonVHR.label"})})})]})]})}function nu(e){let t,n;return e.loadingMore||0!==e.snapshotValues.length||(t=(0,P.jsx)(Zc,{message:Vc,showUpgradeButtonForTier:!1})),n=e.error?(0,P.jsx)("div",{style:Ec,children:(0,P.jsx)(K().sA,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,P.jsx)("div",{style:Ec,children:(0,P.jsx)(Zn().A,{})}):(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)(wc().H,{type:tt().A.Y,children:(0,P.jsx)(Jc,{...e})}),(0,P.jsx)(eu,{...e})]}),(0,P.jsx)(b().A,{menuType:S().gu.Modal,title:(0,P.jsx)(K().sA,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,P.jsx)(Wc,{}),right:(0,P.jsx)(it().DoneMenuText,{}),onClickRight:Zd().un,header:t,children:(0,P.jsx)(Jd().K,{from:"MobileHistory",fallback:e=>{let{error:t,errorId:n}=e;return(0,P.jsx)(ec().LargeSurfaceRenderError,{error:t,errorId:n})},children:n})})}function ou(e){const t=(0,i().v3)(),n=(0,s().K8)((()=>e.menuState.snapshot?zc({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot}):null),[e.menuState.nextFutureSnapshot,e.menuState.snapshot]),o=su(),a=(0,s().K8)((()=>(0,Bc().Wj)(t)),[t]),r=(0,lc().f_)({spaceId:e.menuState.blockStore.pointer.spaceId}),l=(0,pc().y)(r),d=(0,s().K8)((()=>(0,dc().NV)()),[]);let c;return c=e.error?(0,P.jsx)("div",{style:Ec,children:(0,P.jsx)(K().sA,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})}):e.initialLoading?(0,P.jsx)("div",{style:Ec,children:(0,P.jsx)(Zn().A,{})}):n?d&&(0,Gd().rU)(n.tier)&&l?(0,P.jsxs)("div",{style:o.blurContainer,children:[(0,P.jsx)("div",{style:o.unavailableMessageText,children:(0,P.jsx)(Xc,{requestUpgradeTier:n.tier})}),(0,P.jsx)("div",{style:o.snapshotBlur,children:(0,P.jsx)(Bc().Ay,{store:e.menuState.blockStore,disabled:!0,context:ac().Rr.InPageSnapShot,paddingBottom:a})})]}):(0,P.jsxs)("div",{style:o.blurContainer,children:[(0,P.jsx)("div",{style:o.unavailableMessageText,children:(0,P.jsx)(Zc,{message:n.message,showUpgradeButtonForTier:n.tier})}),(0,P.jsx)("div",{style:o.snapshotBlur,children:(0,P.jsx)(Bc().Ay,{store:e.menuState.blockStore,disabled:!0,context:ac().Rr.InPageSnapShot,paddingBottom:a})})]}):e.loadingMore||0!==e.snapshotValues.length?(0,P.jsx)($c,{menuState:e.menuState}):(0,P.jsx)(Zc,{message:Vc,showUpgradeButtonForTier:!1}),(0,P.jsxs)(Jd().K,{from:"DesktopHistory",fallback:e=>{let{errorId:t}=e;return(0,P.jsx)(ec().LargeSurfaceRenderError,{errorId:t})},children:[(0,P.jsx)("div",{style:o.preview,children:c}),(0,P.jsx)(tu,{...e})]})}function iu(){const e=(0,i().v3)(),{device:t}=e,n=(0,s().O$)(sc().A),[o]=(0,pe().Yb)((async()=>{if(n.open)return await async function(e,t,n){const{device:o}=n,i=await z().callApi({eventName:"getSnapshotsList",environment:n,data:e});if("failed"===i.type)throw i.error;const{snapshots:s}=i.data;if(t.pageHasCollection=s.some((e=>{var t;const n="collection"===e.parent_table,o=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return n||o&&0!==o})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),o=s.findIndex((t=>parseInt(t.timestamp)<e));0===s.length||(0===o?Zd().Xn({environment:n,snapshot:s[o],nextFutureSnapshot:void 0}):o>0?Zd().Xn({environment:n,snapshot:s[o-1],nextFutureSnapshot:o>1?s[o-2]:void 0}):s.length<t.size?Zd().Xn({environment:n,snapshot:s[s.length-1],nextFutureSnapshot:s.length>1?s[s.length-2]:void 0}):Zd().p2())}else Boolean(t.snapshot)||o.isMobile||sc().A.setState({...t,snapshot:s[0],nextFutureSnapshot:void 0});return i.data}({block:{id:n.blockStore.id,spaceId:(0,Wd().e)(n.blockStore.pointer.spaceId)},size:n.size},n,e)}),[e,n]),a="pending"!==o.status&&"idle"!==o.status,r=o.error,l=o.value,d=(0,Da().A)(Boolean(n.open&&(!l||l.snapshots.length>=n.size&&n.openSnapshotNearTimestamp)),400,100);if(!n.open)return null;const c=t.isMobile?nu:ou;return(0,P.jsx)(c,{snapshotValues:l?l.snapshots:[],menuState:n,onRestoreSnapshot:async function(){if(!n.open)return;const t="restore_collection",o=n.pageHasCollection?[{key:t,text:(0,P.jsx)(K().sA,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(K().sA,{defaultMessage:"All database pages and their properties from this version will be restored, which may impact other users or database views. To restore database page content, restore an earlier version for each page.",id:"historyModal.confirmDialog.selectOption.collection.description"})," ",(0,P.jsx)(bc().A,{external:!0,href:(0,Ne().xS)("guides.pageHistoryRestore"),style:{display:"inline",textDecoration:"underline"},children:(0,P.jsx)(K().sA,{id:"historyModal.confirmDialog.selectOption.collection.learnMore",defaultMessage:"Learn more"})})]})}]:void 0,{accept:i,selectionResult:s}=await $d().Gh({message:(0,P.jsx)("div",{style:{fontWeight:Be().Wy.semibold,fontSize:"medium"},children:(0,P.jsx)(K().sA,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,P.jsx)(K().sA,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:o,mode:o?"wide":void 0,textAlign:"left"});if(i){try{await Zd().n5(e,null==s?void 0:s[t])}catch{$d().f1(Lt().A.formatMessage(Uc.restoreSnapshotError))}Zd().un()}},error:r,initialLoading:d,loadingMore:!a})}function su(){return(0,Te().IS)((e=>({sidebarStyle:{display:"flex",flexDirection:"column",flexShrink:0,width:Nc().pN,padding:"10px 8px 0px 8px",borderLeft:`\n\t\t\t1px solid ${e.regularDividerColor}\n\t\t`},sidebarHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",alignSelf:"stretch",padding:"4px 4px 4px 8px"},actions:{display:"flex",padding:"12px 12px 12px 6px",borderTop:`\n\t\t\t\t\t1px solid ${e.regularDividerColor}\n\t\t\t\t`,justifyContent:"space-between",marginLeft:"-8px",marginRight:"-8px"},learnMoreButton:{padding:"0px 8px",borderRadius:"6px",gap:4},preview:{display:"flex",flexDirection:"column",width:`calc(100% - ${Nc().pN}px)`,boxShadow:`1px 0 0 ${e.regularDividerColor}`},restoreButton:{backgroundColor:e.text.uiBluePrimary,borderRadius:"6px",boxShadow:"none"},buttonMenuItem:{marginLeft:"0px",marginRight:"0px",width:"100%",borderRadius:"6px"},menuItem:{display:"flex",alignItems:"center",justifyContent:"space-between"},header:{display:"flex",alignItems:"center",flexShrink:0,height:45,paddingLeft:14,gap:6},modal:{height:`${Nc().fi}vh`,width:`${Nc().oR}vw`,overflow:"hidden",display:"flex",borderRadius:"12px"},blurContainer:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},unavailableMessageText:{position:"absolute",width:"100%",height:"100%",zIndex:1},snapshotBlur:{position:"relative",pointerEvents:"none",filter:"blur(20px)",opacity:"30%",margin:"-5px"},unavailableMessageComponentMobile:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,position:"relative",zIndex:1,background:e.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t\t0 -1px 0 ${e.regularDividerColor},\n\t\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t\t`},unavailableMessageComponent:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:16,textAlign:"center",fontSize:14,height:"100%",gap:16},upsell:{gap:4,paddingLeft:"8px",paddingRight:"12px",borderRadius:"6px"},dismiss:{position:"unset"}})),[])}var au=()=>n(988499);async function ru(e){const{environment:t,emitValue:n,spaceStore:o,currentUserId:i,lastEmitData:s}=e,a=function(e){const{emitValue:t,spaceStore:n,currentUserId:o,lastEmitData:i}=e;if(void 0===t)return!0;const s=n.id!==i.spaceId,a=o!==i.userId,r=t!==i.value;return s||a||r}({emitValue:n,spaceStore:o,currentUserId:i,lastEmitData:s});if(!a)return;const r=await(0,fe().getTeamsWithAggregateData)({fromCache:!1,environment:t,spaceStore:o,currentUserId:i,includeArchived:!1});if(!r)return;const{teams:l,teamAggregateData:d}=r;au().A.setState({teams:l,teamAggregateData:d,lastEmitData:{spaceId:o.id,userId:i,value:n}})}const lu=function(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n}=(0,s().O$)(X().default),a=null==n?void 0:n.id;return(0,o.useEffect)((()=>{if(!t||!a)return;const n=$().Ay.addListener((0,F().Dh)(t.id),void 0,(async n=>{let{value:o}=n;await ru({environment:e,emitValue:o,spaceStore:t,currentUserId:a,lastEmitData:au().A.state.lastEmitData})}),void 0,e);return function(){n&&$().Ay.removeListener(n,e)}}),[t,a,e]),null};var du=()=>n(510683),cu=()=>n(444768);const uu=function(){const e=(0,Te().DP)(),t=(0,i().v3)(),o=(0,s().O$)(cu().A),a=(0,s().O$)(n(661179).A);if(!o.open)return null;const r=o.integration.info.icon;return r?(0,P.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:e.popoverBackground,borderRadius:4,boxShadow:e.shadowSM,position:"absolute",bottom:65+a,right:16+a,width:240,zIndex:111,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,P.jsx)(n(854672).A,{type:"image_url",imageURL:r,size:38,style:{marginBottom:6}}),(0,P.jsx)("div",{style:{color:e.text.primary,fontSize:14,fontWeight:Be().Wy.semibold,marginBottom:6,textAlign:"center"},children:(0,P.jsx)(K().sA,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:o.integration.name}})}),(0,P.jsxs)("div",{style:{color:e.text.secondary,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,P.jsx)(K().sA,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,P.jsx)(n(719147).A,{href:(0,Ne().xS)("guides.unfurling"),external:!0,children:(0,P.jsx)(K().sA,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,P.jsx)(Ac().A,{onClick:()=>async function(e){const t=cu().A.state,{currentSpaceStore:n}=X().default.state;if(!t.open||!n)return;await du().Jq({environment:e,integration:t.integration,spaceId:n.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),pu(t.integration.id,e),cu().A.reset()}(t),style:{width:"100%"},children:(0,P.jsx)(K().sA,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,P.jsx)(Ue().A,{icon:n(212050).u,onClick:()=>function(e){const t=cu().A.state;t.open&&pu(t.integration.id,e);cu().A.reset()}(t),style:{position:"absolute",top:6,right:6}})]}):null};function pu(e,t){const{currentUserSettingsStore:n}=X().default.state;n&&v().createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,canUndo:!0,perform:t=>{Er().Cw({transaction:t,userSettingsStore:n,integrationId:e})}})}n(18107),n(967357);var mu=()=>n(617871),gu=()=>n(650829),fu=()=>n(398209),hu=()=>n(147294);const yu=function(){const e=(0,s().uB)(fu().A),t=(0,i().v3)(),n=(0,o.useRef)(null),a=(0,i().Y0)(),[r,l]=(0,s().K8)((()=>[e.state.open,e.state.open?e.state.renderRect:void 0]),[e]);return(0,o.useEffect)((()=>{const e=e=>{r&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&Au(t)},o=e=>{if(!r||!e.target||!n.current)return;const o=n.current;o&&o!==e.target&&Au(t)};return(0,ji().P4)(window,"keydown",e),(0,ji().P4)(window,"mousedown",o),()=>{(0,ji().Ol)(window,"keydown",e),(0,ji().Ol)(window,"mousedown",o)}}),[r,n,t]),(0,P.jsx)(x().Ay,{popupType:a.isMobileNative&&!a.isTablet?j().n.SlideUp:j().n.Popup,open:Boolean(r&&l),originRect:r?l:void 0,placementToOrigin:k().W.Top,alignmentToOrigin:k().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:a.isMobile,keepFocus:a.isMobile,render:()=>(0,P.jsx)(vu,{}),onDismiss:Au})};function vu(){const e=(0,s().uB)(fu().A),t=(0,i().v3)(),n=(0,i().Y0)(),a=(0,o.useRef)(null),r=(0,K().tz)(),[l,d,c,u]=(0,s().K8)((()=>[e.state.open,e.state.open?e.state.allOptionTypes:[],e.state.open?e.state.integration:void 0,e.state.open?e.state.url:void 0]),[e]),p=(0,Te().IS)((e=>({header:n.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Be().Wy.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:Be().J.UISmall.desktop,fontWeight:450,font:"SF Pro"}})),[n]),m=(0,s().K8)((()=>"paste_link"===J().default.getEligibleGroup({experimentId:"adoption_import_contextual_entry_points",defaultGroup:"control"})),[]);if(!l)return null;const g={fontSize:Be().J.UIRegular.desktop,fontWeight:Be().Wy.regular,font:"SF Pro"},f={key:"embed section",render:e=>(0,P.jsx)(Vt().A,{...e,style:{paddingTop:6,paddingBottom:0}}),items:d.filter((e=>"import"!==e)).map((e=>({key:e,render:n=>(0,P.jsx)(Ut().A,{...n,title:(0,P.jsx)(bu,{optionType:e,integration:c}),onMouseEnter:o=>{n.onMouseEnter(o),xu(e,r,t)},style:g}),action:()=>Su(e,t)})))},h={key:"import section",render:e=>(0,P.jsx)(Vt().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:d.filter((e=>"import"===e)).map(((e,n)=>({key:e,render:o=>function(e){let{props:t,optionType:n,integration:o,isExperimentEnabled:i,index:s,environment:a,intl:r,menuTextStyle:l}=e;if(i)return(0,P.jsx)(wu,{props:t,optionType:n,integration:o,isRecommended:0===s,environment:a,intl:r,menuTextStyle:l});return(0,P.jsx)(ku,{props:t,optionType:n,integration:o,isRecommended:!1,environment:a,intl:r,menuTextStyle:l})}({props:o,optionType:e,integration:c,isExperimentEnabled:m,index:n,environment:t,intl:r,menuTextStyle:g}),action:()=>Su(e,t)})))},y=[f,h];return(0,P.jsx)(gu().LazyAssistantUnfurlingMenuWithAiSection,{url:u,integration:c,headerStyle:p.header,menuTextStyle:g,updateUnfurlingOptionType:xu,handleDismiss:Su,renderMenu:e=>{let o,{maybeAiActionSection:i}=e;return o=n.isMobile?{menuType:S().gu.ActionSheet}:{menuType:S().gu.Popup,width:d.includes("import")?260:Boolean(i)?220:200,maxHeight:"40vh",onClickOutside:()=>Au(t)},(0,P.jsx)(b().A,{...o,className:Bt().Uvd,ref:a,header:(0,P.jsx)(qt().A,{style:p.header,isSmall:!n.isMobile,isSecondaryColor:!n.isMobile,children:(0,P.jsx)(K().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,P.jsx)(Ft().Ay,{type:Ft().Oh.Vertical,sections:i?[...y,i]:y,initialFocus:0,onKeyboardArrow:e=>function(e,t,n,o){const i=fu().A.state;if(!i.open||void 0===e.indexGlobal)return;const s=i.allOptionTypes.at(e.indexGlobal);if(!s)return void(o&&xu("preview",t,n));xu(s,t,n)}(e,r,t,Boolean(i)),priority:1,disallowBackspace:!0})})}})}function bu(e){let{optionType:t,integration:n,isRecommended:o}=e;return"preview"===t?(0,P.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"}):"mention"===t?(0,P.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"}):"link"===t?(0,P.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"URL"}):"drive"===t?(0,P.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsDrive.title",defaultMessage:"Embed"}):"collection"===t?(0,P.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Database"}):"import"===t?(null==n?void 0:n.id)===mu().me?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(K().sA,{id:"unfurlingMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,P.jsx)(Xn().A,{style:{display:"inline"}})]}):(null==n?void 0:n.id)===mu().mn?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(K().sA,{id:"unfurlingMenu.actions.import.salesforceTitle",defaultMessage:"Sync Reports"}),(0,P.jsx)(hu().E,{style:{display:"inline"},newBadgeKey:"salesforce_sync_unfurling_option",didUserEngage:!1,keyType:"date"})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(K().sA,{id:"unfurlingMenu.actions.import.title",defaultMessage:"Import from {integration}",values:{integration:null==n?void 0:n.name}}),o&&(0,P.jsx)($n().A,{style:{marginLeft:4,display:"inline"},color:"blue",content:(0,P.jsx)(K().sA,{id:"unfurlingMenu.actions.pasteAsImport.title",defaultMessage:"Recommended"})})]}):void(0,ge().HB)(t)}function xu(e,t,n){v().createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:n,canUndo:!1,perform:o=>{go().Oi({environment:n,type:Mu(e),useTemporaryRecordCache:!0,transaction:o,intl:t})}})}function Su(e,t){const n=fu().A.state;Or().Gp(t,{unfurl_option_type:e||"default",integration:n.open?n.integration.name:"default"}),"import"===e&&n.open?(v().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:e=>{go().VN({environment:t,setType:"link",transaction:e})}}),go().z1({environment:t,integration:n.integration,url:n.url,blockStore:n.stores.blockStore})):v().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:n=>{go().VN({environment:t,setType:e?Mu(e):void 0,transaction:n})}})}function Mu(e){return"import"===e?"link":e}function Au(e){Su(void 0,e)}function wu(e){let{props:t,optionType:n,integration:o,isRecommended:i,environment:s,intl:a,menuTextStyle:r}=e;return(0,kn().w)((()=>{(0,qn().t)({environment:s,action:"view",from:"paste_link"})})),(0,P.jsx)(ku,{props:t,optionType:n,integration:o,isRecommended:i,environment:s,intl:a,menuTextStyle:r})}function ku(e){let{props:t,optionType:n,integration:o,isRecommended:i,environment:s,intl:a,menuTextStyle:r}=e;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Qn().A,{size:4}),(0,P.jsx)(Ut().A,{...t,title:(0,P.jsx)(bu,{optionType:n,integration:o,isRecommended:i}),onMouseEnter:e=>{t.onMouseEnter(e),xu(n,a,s)},style:r})]})}var ju=()=>n(999752),Cu=()=>n(664713),Iu=()=>n(21899),Tu=()=>n(751348),_u=()=>n(90873);const Pu=10;function Bu(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n,currentUserRootStore:a}=(0,s().O$)(X().default),r=null==n?void 0:n.id,l=(0,Tu().n)(t),d=(0,s().K8)((()=>f().oE(l?(0,Iu().f)({currentUserRootStore:a}).map((e=>e.getSpaceId())):[null==t?void 0:t.id])),[l,t,a]);return(0,o.useEffect)((()=>{if(!r)return;const t=async(t,n)=>{const o=_u().A.getSharedPagesState({userId:r,spaceId:t});o&&o.emitValue===n||await Cu().Z({environment:e,userId:r,spaceId:t,emitValue:n})},n=d.length>Pu?new(ju().O)(Pu):void 0,o=d.map((o=>{const i=f().nF((async e=>{let{value:i}=e;return n?n.enqueue((async()=>t(o,i))):t(o,i)}),5e3);return{listener:$().Ay.addListener((0,F().Rs)({userId:r,spaceId:o}),void 0,i,void 0,e),throttledHandler:i}}));return function(){null==n||n.cancel(),o&&o.forEach((t=>{let{listener:n,throttledHandler:o}=t;n&&$().Ay.removeListener(n,e),o&&o.cancel()}))}}),[d,r,e]),null}n(16280);var Ru=()=>n(721908),Lu=()=>n(592269),Du=()=>n(921598),Ou=()=>n(854150),Nu=()=>n(313892),Eu=()=>n(799832),Uu=()=>n(199896),Fu=()=>n(854502),Vu=()=>n(666710);const Ku=200,Hu=30,zu=125,Wu=25;var Gu=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(Gu||{});function Yu(e){return e.type===Gu.Selectable?{type:Jt().OX.Selectable,store:e.target.props.store,direction:e.direction}:{type:Jt().OX.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function qu(e){const{target:t,device:n,direction:o,points:i}=e;return o===Jt().bH.Onto||!n.isPhone||t.props.dropzoneShouldNeverUseOrigin?i.mousePoint:{x:i.originPoint.x,y:i.mousePoint.y}}function $u(e){return(0,Uu().M)(e)?{type:Gu.Selectable,target:e}:{type:Gu.DropTarget,target:e}}function Qu(e){if(!e||!(0,Uu().M)(e))return!1;let t=e;const n=Jt().Ay.state;if(!n.isDragging)return!1;const{draggedStores:o}=n;for(;t;){if(o.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Zu(e){const{dropzoneMustBeWithinHorizontalBound:t,device:n}=e;return t?0:n.isPhone?9999:0}function Xu(e){switch(e.direction){case Jt().bH.Onto:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:a,canAcceptDrop:r}=e,l=Jt().bH.Onto,d=qu({device:t,target:i,direction:l,points:s});if((n?i.props.canNativeDropOnto:i.props.canDropOnto)&&ep(d,o)&&!Qu(i)&&r(i,l))return{...$u(i),direction:l,left:o.left,top:o.top,width:o.width,height:o.height,priority:a}}(e);case Jt().bH.Left:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Jt().bH.Left,c=qu({device:t,target:i,direction:d,points:s});if((n?i.props.canNativeDropLeft:i.props.canDropLeft)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.left)<=Ku&&(r||!Qu(i))&&l(i,d))return{...$u(i),direction:d,left:o.left,top:o.top,width:0,height:o.height,priority:a}}(e);case Jt().bH.Right:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Jt().bH.Right,c=qu({device:t,target:i,direction:d,points:s});if((n?i.props.canNativeDropRight:i.props.canDropRight)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.right)<=Ku&&(r||!Qu(i))&&l(i,d))return{...$u(i),direction:d,left:o.right,top:o.top,width:0,height:o.height,priority:a}}(e);case Jt().bH.Above:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??Hu,c=Zu({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=Jt().bH.Above,p=qu({device:t,target:i,direction:u,points:s});if((n?i.props.canNativeDropAbove:i.props.canDropAbove)&&o&&p.x>=o.left-d-c&&p.x<=o.right+c&&(r||!Qu(i))&&Math.abs(p.y-o.top)<=zu&&(o.height<=2*Wu||p.y<=o.top+Wu)&&l(i,u))return{...$u(i),direction:u,left:o.left,top:o.top,width:o.width,height:0,priority:a}}(e);case Jt().bH.Below:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:s,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??Hu,c=Zu({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=zu,p=i.props.isLastItem?Number.MAX_SAFE_INTEGER:zu,m=Jt().bH.Below,g=qu({device:t,target:i,direction:m,points:s});if((n?i.props.canNativeDropBelow:i.props.canDropBelow)&&o&&g.x>=o.left-d-c&&g.x<=o.right+c&&o.bottom-g.y<=u&&g.y-o.bottom<=p&&(o.height<=2*Wu||g.y>=o.bottom-Wu)&&(r||i.props.isLastItem||!Qu(i))&&l(i,Jt().bH.Below))return{...$u(i),direction:Jt().bH.Below,left:o.left,top:o.bottom,width:o.width,height:0,priority:a}}(e)}}function Ju(e){const{device:t,rect:n,target:o,points:i,optionKeyDown:s}=e;return ep(qu({device:t,target:o,direction:Jt().bH.Onto,points:i}),n)&&Qu(o)&&!s}function ep(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var tp=()=>n(281322),np=()=>n(776894),op=()=>n(396301),ip=()=>n(49650),sp=()=>n(585533),ap=()=>n(182106),rp=()=>n(696152),lp=()=>n(695625),dp=()=>n(444570),cp=()=>n(915440),up=()=>n(871399);const pp=2,mp=20,gp=7;function fp(){const e=(0,o.useRef)(!1),t=(0,o.useRef)(!1),n=(0,o.useRef)(void 0),s=(0,i().Y0)(),a=(0,i().v3)(),r=(0,fl().S)(),l=(0,Ru().d)((e=>as().A.withListenerIgnored((()=>(e=>{const o=up().default.state;if(!(e&&e.target instanceof Element)||o.isOpen&&o.menuIsOpen||(n.current={target:e.target,x:e.clientX,y:e.clientY}),t.current)return void(t.current=!1);const{isDragging:i}=Jt().Ay.state;if(i)g();else{if(!n.current)return;vp(a,n.current.target,n.current.x,n.current.y)}})(e)))),60),d=(0,o.useCallback)((()=>{e.current||l(void 0)}),[l]),c=f().nF((()=>{const{isDragging:e}=Jt().Ay.state;bo().default.afterNextFlush((()=>{n.current&&!e&&vp(a,n.current.target,n.current.x,n.current.y)}))}),60),u=(0,o.useMemo)((()=>new WeakMap),[]),p=(0,o.useCallback)((e=>{const t=u.get(e);if(u.has(e))return t??!1;const n=(0,tc().x7S)({environment:a,blocks:e,publicEditMode:r&&r.publicEditModeStore.state});return u.set(e,n),n??!1}),[a,r,u]),m=(0,o.useCallback)((()=>{const e=Jt().Ay.state;if(!e.isDragging)return;const{draggedStores:t,currentX:n,currentY:o,offsetX:i,offsetY:s,isNativeDrag:l}=e,d=function(e){const{points:t,draggingStore:n,isNativeDrag:o,environment:i,pageContext:s,canDragFn:a}=e,{device:r}=i,l=tp().r(),d=function(){const{selectableRectMap:e}=Vu().default.state,{dropTargetRectMap:t}=Fu().A.state,n=new Map;return e.forEach(((e,t)=>{n.set(t,e)})),t.forEach(((e,t)=>{n.set(t,e)})),n}(),c=d.keys();let u=c.next();const p=lp().T.findSelectableFromStore(n),m=p?p.getContextSelectableContainer():void 0;let g=[];for(;!u.done;){const e=u.value;u=c.next();const n=d.get(e),p=e.getContextSelectableContainer();if(r.isPhone&&p!==m)continue;if(!p||p.getProps().disable)continue;const h=yp(p),y={device:r,isNativeDrag:o,rect:n,target:e,points:t,priority:h,optionKeyDown:l.option,canAcceptDrop:(e,t)=>wp({target:e,direction:t,optionKeyDown:l.option,environment:i,pageContext:s,canDragFn:a})};if(Ju(y))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};g.push(...f().oE([Xu({...y,direction:Jt().bH.Onto}),Xu({...y,direction:Jt().bH.Left}),Xu({...y,direction:Jt().bH.Right}),Xu({...y,direction:Jt().bH.Above}),Xu({...y,direction:Jt().bH.Below})]))}g=function(e){const t=xp(f().Sk(e,xp));return e.filter((e=>xp(e)===t))}(g);const h=g.filter((e=>e.direction===Jt().bH.Above||e.direction===Jt().bH.Below)),y=f().wq(h,(e=>Math.abs(e.top-bp(e,t,i).y)));if(y&&y.target===p)return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};let v=h.filter((e=>{let{top:t}=e;return Math.abs(t-(y?y.top:0))<=pp}));if(v.length>1){v=v.filter((e=>{const n=bp(e,t,i).x,o=Zu({device:r});return n>=e.left-o&&n<=e.left+e.width+o})),v=f().Ul(v,(e=>{let{left:t}=e;return t}));let e=0;for(;e<v.length-1;e++){const n=v[e+1],o=bp(n,t,i).x;if(n.left>o)break}v=v.slice(0,e+1),v.reverse()}const b=v.map(Yu);let x;const S=g.filter((e=>e.direction===Jt().bH.Onto)),M=f().wq(S,(e=>e.height));if(M){h.some((e=>{const n=bp(e,t,i).y;return Math.abs(e.top-n)<gp}))||(x=Yu(M))}let A;const w=g.filter((e=>e.direction===Jt().bH.Left||e.direction===Jt().bH.Right)).sort(((e,t)=>e.height-t.height));let k=f().wq(w,(e=>{const n=bp(e,t,i).x;return Math.abs(e.left-n)}));if(k){const e=k,t=w.filter((t=>Math.abs(t.left-e.left)<mp));t.length>0&&(k=f().wq(t,(e=>e.left)))}if(k){const e=k;h.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(A=Yu(k))}return{ontoDropZone:x,verticalDropZone:A,horizontalDropZones:b}}({points:{mousePoint:{x:n,y:o},originPoint:{x:n-i,y:o-s}},draggingStore:t[0],isNativeDrag:l,environment:a,pageContext:r,canDragFn:p});if(d.ontoDropZone)Jt().Ay.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)Jt().Ay.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],n=f().RT(d.horizontalDropZones);if(t.type===Jt().OX.Selectable){const o=lp().T.findSelectableFromStore(t.store);if(o){const i=o.getContextClosestSelectable();let s;return i&&i.props.store!==t.store&&i.props.shouldShowParentHalo&&(s=i.props.store),void Jt().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:s})}}else{if(sp().A.findDropTargetFromKey(t.key))return void Jt().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:void 0})}}Jt().Ay.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}),[a,p,r]),g=(0,o.useCallback)((()=>{if(e.current)throw new Error("Assertion failure, updateDragState() called when isUpdatingDragState === true!");e.current=!0;try{m()}finally{e.current=!1}}),[m]),h=(0,o.useCallback)((()=>{const{isDragging:e}=Jt().Ay.state;e&&g()}),[g]),y=(0,o.useCallback)((()=>{t.current=!0}),[]);(0,o.useEffect)((()=>(window.addEventListener("mousemove",l),Et().default.addListener(c),s.isIOS&&window.addEventListener("touchend",y),window.addEventListener("keydown",h),window.addEventListener("keyup",h),Jt().Ay.addListener(d),window.addEventListener("scroll",Sp,!0),window.addEventListener("resize",Mp),Pt().RR.addListener(Ap),Lo().sf(),()=>{window.removeEventListener("mousemove",l),Et().default.removeListener(c),s.isIOS&&window.removeEventListener("touchend",y),window.removeEventListener("keydown",h),window.removeEventListener("keyup",h),Jt().Ay.removeListener(d),window.removeEventListener("scroll",Sp,!0),window.removeEventListener("resize",Mp),Pt().RR.removeListener(Ap)})),[s.isIOS,d,c,h,l,y])}function hp(){const e=up().default.state;e.isOpen&&!e.menuIsOpen&&up().default.reset()}function yp(e){return(Et().default.state.droppableContainerStack||[]).indexOf(e)}function vp(e,t,n,o){var i,s;const a=up().default.state;if(a.isOpen&&a.menuIsOpen)return;const r=function(e){const{environment:t,target:n,x:o,y:i,rightMarginCommentActionsEnabled:s}=e;if(cp().A.state.isResizing||Jt().Ay.state.isDragging||we().default.state.isActive||Pt().RR.state)return;const{selectableRectMap:a}=Vu().default.state,r=rp().A.getMembersByDOMOrder({filter:e=>{const t=e.getNode();return Boolean(t&&t.contains(n))}})[0];if(!r)return;const l=a.keys();let d=l.next();const c=[],u=[];for(;!d.done;){const e=d.value,n=a.get(e),p=dp().TH({environment:t,store:e.props.store,selectableBoundingRect:n}),m=dp().KG({store:e.props.store,selectableBoundingRect:n,containerWidth:p}),g=dp().mC(e);if((e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===r&&n&&Vl().ux((0,up().getExpandedSelectableRect)(n,s,p,m,g),o,i)){for(const t of up().HOVER_REGIONS)Vl().ux((0,up().getHoverRegionOfRect)(n,t,p,m,g),o,i)&&u.push({selectable:e,hoveredRegion:t});Vl().ux((0,up().getExactSelectableRect)(n,s),o,i)&&c.push(e)}d=l.next()}const p=f().Ul(c,(e=>{const t=a.get(e);return t?-t.left:1/0})),m=p.find((e=>{const t=e.getNode();return!t||!p.find((n=>{if(n!==e){const e=n.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return m?{exactSelectable:m,nearbySelectables:u,container:r}:{nearbySelectables:u,container:r}}({environment:e,target:t,x:n,y:o,rightMarginCommentActionsEnabled:!0});if(!r)return void up().default.reset();const l=!a.isOpen||(null===(i=r.exactSelectable)||void 0===i?void 0:i.props.store)!==a.currentStore,d=a.isOpen&&(null===(s=r.exactSelectable)||void 0===s?void 0:s.props.store)===a.currentStore;var c,u;l?up().default.setState({...a,isOpen:!0,menuIsOpen:!1,container:r.container,nearbySelectables:r.nearbySelectables,currentStore:null===(c=r.exactSelectable)||void 0===c?void 0:c.props.store,selectableBoundingRect:null===(u=r.exactSelectable)||void 0===u||null===(u=u.getNode())||void 0===u?void 0:u.getBoundingClientRect(),mouseX:n,mouseY:o}):d&&up().default.setState({...a,nearbySelectables:r.nearbySelectables,mouseX:n,mouseY:o})}function bp(e,t,n){return qu({device:n.device,target:e.target,points:t})}function xp(e){return(null==e?void 0:e.priority)??0}function Sp(){Lo().AP(),hp()}function Mp(){Lo().AP(),hp()}function Ap(){const e=up().default.state,t=Pt().RR.state;e.isOpen&&!e.menuIsOpen&&t&&up().default.reset()}function wp(e){const{target:t,direction:n,optionKeyDown:o,environment:i,pageContext:s,canDragFn:a}=e;if(Me().A.state.isOpen&&!ka().default.state.open)return!1;if(Ae().A.state.isOpen)return!1;const r=Jt().Ay.state,l=r.isDragging?r.draggedStores:[],d=!!r.isDragging&&r.isNativeDrag;let c,u,p,m=!1,g=!1;l.find((e=>{const t=ap().A.findOutlinerItemFromStore(e);return!!t&&(c=t,u=t.type,m=t.isTopLevelItem,!0)}));const f=(0,Uu().M)(t)?ap().A.findOutlinerItemFromStore(t.props.store):void 0,h=null==f?void 0:f.parentStore;var y;f&&(p=f.type,g=f.isTopLevelItem||"team"===(null===(y=f.parentStore)||void 0===y?void 0:y.table));if(function(e){var t;const{draggingOutlinerItem:n,selectableOutlinerItemParent:o,direction:i}=e;if(n&&"team"===n.type&&n.isTopLevelItem&&(null===(t=n.parentStore)||void 0===t?void 0:t.pointer.table)===Ou().yK){const e=n.parentStore;if(!(n.store.getParentId()===e.pointer.id||o&&o.pointer.id===e.pointer.id&&i!==Jt().bH.Onto))return!0}return!1}({draggingOutlinerItem:c,selectableOutlinerItemParent:h,direction:n}))return!1;if(!(0,Uu().M)(t))return t.props.canAcceptDrop({direction:n,draggingStores:l,isNativeDrag:d});const v=t.props.store;if(v.pathIsDead())return!1;if((0,Kl().dL)(v))return!1;if("suggest"===Hl().Uv.getMode(v))return!1;const b=(0,Eu().U)(v);if(b&&b.isInTrashStore.state)return!1;const x=v.getAssociatedCollectionStore();if(n===Jt().bH.Onto&&x){const e=x.id,t=(0,Eu().U)(v),n=null==t?void 0:t.collectionViewBlockStore(),o=null==t?void 0:t.collectionViewStore();if(n&&o&&"page"!==o.getType()){if(l.find((o=>{const i=o.getAssociatedCollectionStore(),s=(0,Eu().U)(o);return Boolean(o instanceof te().Bv&&i&&i.id===e)||Boolean(s===t&&v.id!==n.id)})))return!1}}if(n!==Jt().bH.Onto){const e=(0,Eu().U)(v);if("collectionTypedView"===(null==e?void 0:e.contextType)&&e.databaseType){if(!l.find((t=>{const n=(0,Eu().U)(t);return(null==n?void 0:n.databaseType)===e.databaseType})))return!1}}if(t.props.groupsPointer){var S;const e=null===(S=v.getCollectionStore())||void 0===S?void 0:S.getSchema();if(Boolean(t.props.groupsPointer.find((t=>!(0,Lu().wj)(t,(null==x?void 0:x.getSchema())??e))))){if(l.find((e=>{var n;const o=lp().T.findSelectableFromStore(e);return(null==o||null===(n=o.props)||void 0===n?void 0:n.groupsPointer)&&t.props.groupsPointer&&!(0,Du().PZ)(o.props.groupsPointer,t.props.groupsPointer)})))return!1}}if((0,np().qy)({targets:l,destination:v,direction:n,draggingOutlinerType:u}))return!1;if(o&&l.find((e=>e.isTypedCollectionViewBlock()||(0,Nu().sZ)(e))))return!1;if(f&&n!==Jt().bH.Onto&&!g&&!(0,tc().ecY)({environment:i,blocks:[f.store],publicEditMode:null==s?void 0:s.publicEditModeStore.state}))return!1;if(p&&d)return!1;if("bookmarks"===u&&m&&("bookmarks"!==p||!g||n===Jt().bH.Onto))return!1;if("bookmarks"===p&&g&&n!==Jt().bH.Onto&&("bookmarks"!==u||!m))return!1;if(c&&c.isTopLevelItem&&"team"===c.type&&c.parentStore&&c.parentStore.table===Ou().yK){const e=c.parentStore,t=te().h4.createChildStore(e,{...e.pointer,table:Ou().yK});if(t&&!(0,op().dp)({teamStore:t,environment:i}))return!1}if(f&&f.isTopLevelItem&&"team"===f.type&&f.parentStore&&f.parentStore.table===Ou().yK){const e=f.parentStore,t=te().h4.createChildStore(e,{...e.pointer,table:Ou().yK});if(t&&!(0,op().dp)({teamStore:t,environment:i}))return!1}const{currentSpaceViewStore:M}=X().default.state,A=p?op().Kv[p]:void 0;if(M&&f&&c&&A&&f.isTopLevelItem&&n!==Jt().bH.Onto&&c.type!==p){const{sortOption:e}=(0,op().RQ)({spaceViewStore:M,type:A});if("lastEdited"===e)return!1}if("shared"===p&&g&&n!==Jt().bH.Onto&&("shared"!==u||!m))return!1;if(p&&g&&n!==Jt().bH.Onto){if(l.find((e=>{const t=e.getType();return Boolean(!t||!Ze().BJ[t])})))return!1}const{device:w}=i;if(p&&w.isMobile&&n===Jt().bH.Onto&&g)return!1;if(l.some((e=>Boolean(ip().A.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(ip().A.findCollectionTemplatePickerItemFromStore(v)))return!1;if(n===Jt().bH.Onto&&v&&!(0,tc().p2L)({environment:i,blocks:[v],publicEditMode:null==s?void 0:s.publicEditModeStore.state}))return!1;if(!a(l))return!1;if(l.some((e=>e.isTransclusionType()))){if(v.findRecordStoreUIAncestor((e=>{if(e===v)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getKeyStore("type").getValue();return Boolean(t&&(0,Ze().Mp)(t))})).ancestor)return!1}return!0}function kp(){const e=(0,i().Y0)(),t=(0,i().v3)(),{isMobile:n,isElectron:d}=e;(0,o.useEffect)((()=>{if(n){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[n]);const c=(0,s().O$)(X().AppStoreCurrentSpaceStore);(0,o.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,o.useEffect)((()=>{function e(e){we().default.state.isActive&&(e.preventDefault(),a().K1({environment:t,currentX:we().default.state.currentX,currentY:we().default.state.currentY,toggle:e.shiftKey}))}function n(e){we().default.state.isActive&&(e.preventDefault(),a().K1({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function o(e){we().default.state.isActive&&((0,O().Mb)(e)||e.preventDefault(),a().OG(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",n),window.addEventListener("mouseup",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",o)}}),[t]);const g=t.currentUser.isLoggedIn();return oe(c,g),fp(),(0,P.jsxs)(o.Fragment,{children:[(0,P.jsx)(ft,{}),(0,P.jsx)(l().Gc,{}),(0,P.jsx)(l().MC,{}),(0,P.jsx)(ue,{}),(0,P.jsx)(Ie().A,{priority:-1,capture:!0,debugName:"AppComponents"}),g&&!n&&(0,P.jsx)(Ld,{}),g&&(0,P.jsx)(xe().AuthSyncListener,{}),g&&(0,P.jsx)(lu,{}),g&&(0,P.jsx)(rn,{}),g&&(0,P.jsx)(dn,{}),g&&(0,P.jsx)(Ce,{}),g&&(0,P.jsx)(yo,{}),g&&(0,P.jsx)(ve,{}),g&&(0,P.jsx)(Bu,{}),(0,P.jsx)(nn,{}),(0,P.jsx)(Wr,{}),(0,P.jsx)(p().Li,{}),(0,P.jsx)(ul,{}),(0,P.jsx)(nl,{}),(0,P.jsx)(ti,{}),(0,P.jsx)($t,{}),!n&&(0,P.jsx)(dd,{}),(0,P.jsx)(Si,{}),(0,P.jsx)(Zr,{}),(0,P.jsx)(Pi().A,{}),(0,P.jsx)(Zt().Ay,{store:Me().A}),(0,P.jsx)(Zt().Ay,{store:Ae().A}),(0,P.jsx)(r().DV,{}),(0,P.jsx)(Rr,{}),(0,P.jsx)(Se().Tm,{}),(0,P.jsx)(B,{}),(0,P.jsx)(oo,{}),(0,P.jsx)(be().Sd,{}),(0,P.jsx)(yu,{}),(0,P.jsx)(_i,{}),(0,P.jsx)(uu,{}),(0,P.jsx)(Ht,{}),(0,P.jsx)(Nd().A,{}),(0,P.jsx)(re,{}),d&&(0,P.jsx)(u,{}),(0,P.jsx)(Sn,{}),(0,P.jsx)(Xt().Y,{}),g&&(0,P.jsx)(Fc,{}),(0,P.jsx)(hi().nJ,{}),(0,P.jsx)(ze,{}),(0,P.jsx)(sn().yQ,{}),g&&(0,P.jsx)(fn,{}),(0,P.jsx)(m().h,{})]})}},601203:(e,t,n)=>{n.d(t,{Kz:()=>w,Qe:()=>b,dn:()=>x,gM:()=>k,jO:()=>S,qu:()=>M});n(898992),n(354520),n(581454);var o=()=>n(251111),i=()=>n(762433),s=()=>n(643819),a=()=>n(622963),r=()=>n(496603),l=()=>n(534177),d=()=>n(449506),c=()=>n(780054),u=()=>n(640653),p=()=>n(351360),m=()=>n(506090),g=()=>n(134217),f=()=>n(830140),h=()=>n(430395),y=()=>n(981046),v=()=>n(749240);async function b(e){var t;let{environment:n,billingData:s,billingInterval:r,vatId:c,addOn:f,onlyShowAddOn:h}=e;const b=m().A.state,x=v().subscriptionDataStoreInstance.state;if(!b.open||!x)return;const S=(null==s?void 0:s.address)??b.temporaryAddress;if(!(0,o().Z)(S))return;m().A.update((e=>({...e,calculatingTax:!0})));const M=r??b.temporaryBillingInterval??"year",w=f??b.addOnFeature,k=h??b.onlyShowAddOn,j=null===(t=p().default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!j)return;const C=await(0,u().Pu)({environment:n,spaceId:j})??1,{planAmount:I,promoInfo:T,accountBalance:_}=(0,g().TQ)({memberCount:C,promo:b.appliedPromo,currencyCode:y().A.selectedCurrencyCode,data:x,addOnFeature:w,onlyShowAddOn:k,subscriptionTier:b.subscriptionTier,taxAmount:b.taxAmount,calculatingTax:b.calculatingTax,billingInterval:M,coupon:b.coupon}),P=Math.max(0,I-T.amount+_),B=[b.subscriptionTier,b.addOnFeature].map((e=>{switch(e){case void 0:return;case"ai":case"sites_custom_hostnames":return e;default:return(0,a()._y)(e)}})).map((e=>{const t=y().A.getPrice(n,(t=>t.product===e&&t.billingInterval===r));return null==t?void 0:t.result})).map(A).filter(l().O9),R=await d().callApi({eventName:"calculateTax",environment:n,data:{address:S,lineItems:B,price:P,vatId:c??b.vatApplicable?b.temporaryVatCode:void 0,customerId:(0,i().Rz)(s)}});if("failed"===R.type)m().A.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=R.data;e.valid?m().A.update((t=>({...t,taxAmount:e.taxAmount,calculatingTax:!1,taxCalculationError:void 0}))):m().A.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function x(e,t){var n;const a=h().A.state,r=v().subscriptionDataStoreInstance.state;if(!a.open||!r)return;const l=a.temporaryAddress;if(!(0,o().Z)(l))return;h().A.update((e=>({...e,calculatingTax:!0})));const c=(null===(n=a.totalUpgradeCost)||void 0===n?void 0:n.amount)||0,u=await d().callApi({eventName:"calculateTax",environment:e,data:{address:l,price:c,vatId:a.vatApplicable?a.temporaryVatCode:void 0,customerId:(0,i().Rz)(t)}});if("failed"===u.type)h().A.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=u.data;e.valid?h().A.update((t=>({...t,taxAmount:s().W.fromValue({amount:e.taxAmount,currencyCode:y().A.selectedCurrencyCode}),calculatingTax:!1,taxCalculationError:void 0}))):h().A.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function S(e){const{environment:t,priceForTaxCalculation:n,address:o,customerId:i,vatId:s}=e,a=f().A.state,r=await d().callApi({eventName:"calculateTax",environment:t,data:{address:o,customerId:i,vatId:s,price:n}});if("failed"===r.type);else{const e=r.data;e.valid&&a.open&&f().A.update((t=>({...t,tax:Math.max(0,e.taxAmount)})))}}async function M(e){const{environment:t,billingData:n,stripeData:s,taxableAmount:a,lineItems:r}=e,{address:l}=null!=n&&n.address?{address:null==n?void 0:n.address}:e,c=(null==s?void 0:s.vatId)??(n?(0,i().t_)(n,"vat"):void 0);if(!l||!(0,o().Z)(l))return;const u=(0,i().Rz)(n),p=await d().callApi({eventName:"calculateTax",environment:t,data:{address:l,price:a.amount,vatId:c,customerId:u,lineItems:r}});if("failed"===p.type)return;const m=p.data;return m.valid?m.taxAmount:void 0}function A(e){if(!e)return;if(void 0===e.unitAmount)return;const t=c().A.pricing[e.product];return"productId"in t?{amount:e.unitAmount.amount,productId:t.productId}:void 0}function w(e){const t=c().A.pricing[e.price.product];if("productId"in t)return{amount:e.price.unitAmount.amount*e.quantity,productId:t.productId}}function k(e){let{line:t,defaultProductId:n=c().A.pricing.plus.productId}=e;const o=(0,r().xu)(t.discount_amounts??[],"amount"),i=t.price?"string"==typeof(s=t.price.product)?s:s.id:n;var s;return{amount:t.amount-o,productId:i}}},607810:(e,t,n)=>{n.d(t,{s:()=>a});var o=n(296540),i=()=>n(120997),s=n(474848);const a=o.memo((function(e){let{area:t,viewsMainTabId:a,children:r,className:l,style:d}=e;const{layoutBuilderModuleSelectionStore:c,layoutStore:u}=(0,n(937199).LH)(),p=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().p)(o,t)&&("page_main"===t&&u.isTabbedPageLayout()||c.setState({...e,draggingModuleFinalArea:{..."views_main_tab_modules"===t?{area:t,viewsMainTabId:a}:{area:t}}}))}),[t,c,u,a]),m=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().p)(o,t)&&c.setState({...e,draggingModuleFinalArea:e.draggingModuleInitialArea})}),[t,c,u]);return(0,s.jsx)("div",{onMouseEnter:p,onMouseLeave:m,className:l,style:d,children:r})}))},613735:(e,t,n)=>{n.d(t,{b:()=>a});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var o=()=>n(278238),i=()=>n(945778),s=()=>n(267419);function a(e){let{icon:t,theme:n}=e;if(t)return(0,i().A)(t)?s().A.state.emojiByColorProcessed[t]:(0,o().T8)(t)?function(e){var t;let{uri:n,theme:i}=e;const s=null===(t=n.match(/\/icons\/[\w\-]*_(.+)\.svg/))||void 0===t?void 0:t[1];if(!function(e){if(!e)return!1;return r.has(e)}(s))return;return o().l8[i.mode][s]}({uri:t,theme:n}):void 0}const r=new Set((0,n(534177).uv)(o().l8.light))},628302:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreMenu:()=>zt});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(381138),l=()=>n(959013),d=()=>n(284371),c=(n(16280),n(18107),n(967357),n(898992),n(672577),n(581454),n(737550),()=>n(662303)),u=()=>n(584262),p=()=>n(700500),m=()=>n(112665),g=()=>n(104077),f=()=>n(274570),h=()=>n(340498),y=n(474848);const v=(0,h().wt)("fontStyleMono",{viewBox:"0 0 16 16",svg:(0,y.jsx)("g",{children:(0,y.jsx)("path",{d:"M6.817 12 6.08 9.513H3.017L2.28 12H1.192l2.675-8.725h1.388L7.93 12zM4.605 4.388h-.113L3.267 8.6H5.83zm10.008 7.399q0 1.338-.75 2.1-.75.763-2.088.763-1.45 0-2.313-.888l.588-.687q.676.7 1.737.7 1.825 0 1.825-1.925v-1.075h-.05q-.625 1.2-1.987 1.2-1.175 0-1.85-.875-.675-.888-.675-2.412t.675-2.4q.675-.888 1.85-.888 1.361 0 1.988 1.2h.05V5.55h1zm-2.65-.7q.7 0 1.175-.35t.475-.974v-2.15q0-.626-.476-.975-.474-.35-1.175-.35-.862 0-1.35.525-.487.524-.487 1.412v.925q0 .888.488 1.412.487.526 1.35.526Z"})})}),b=(0,h().wt)("fontStyleSans",{viewBox:"0 0 16 16",svg:(0,y.jsx)("g",{children:(0,y.jsx)("path",{d:"m.76 12 3.248-8.807h.842v1.422h-.348L1.914 12H.761Zm1.472-2.52.341-.935h3.98l.342.934H2.232ZM7.188 12 4.6 4.615V3.193h.494L8.341 12zm4.557 2.32q-.793 0-1.385-.226a2.26 2.26 0 0 1-.947-.63 1.86 1.86 0 0 1-.433-.94l.012-.005h1.099l.006.006q.085.373.513.61.427.244 1.135.244.885 0 1.38-.402.5-.398.5-1.123v-1.331h-.098a2.24 2.24 0 0 1-1.22 1.007q-.39.128-.843.128-.848 0-1.47-.403a2.7 2.7 0 0 1-.953-1.123q-.336-.714-.336-1.635v-.013q0-.922.336-1.635.342-.72.964-1.13.623-.415 1.484-.415.464 0 .854.147t.69.415q.305.269.506.64h.074V5.42h1.062v6.488q0 .733-.36 1.276a2.27 2.27 0 0 1-1.014.836q-.66.3-1.556.3m-.049-3.602q.61 0 1.044-.28.44-.288.671-.788.238-.5.238-1.153v-.013q0-.653-.238-1.16a1.84 1.84 0 0 0-.671-.793q-.434-.287-1.044-.287t-1.037.287a1.83 1.83 0 0 0-.647.794 2.9 2.9 0 0 0-.22 1.16v.012q0 .653.22 1.153.225.5.646.787.428.282 1.038.281"})})}),x=(0,h().wt)("fontStyleSerif",{viewBox:"0 0 16 16",svg:(0,y.jsx)("g",{children:(0,y.jsx)("path",{d:"M.29 12v-.416l.753-.299 3.16-7.982.441-.065.455-.13 2.99 8.177.884.286V12h-3.34v-.429l1.104-.299-.793-2.275H2.772l-.754 2.119 1.248.455V12zm4.08-7.462L3.058 8.217h2.613L4.384 4.538h-.013Zm10.764 2.106-1.482-.078-.013.039c.325.273.663.754.663 1.443 0 1.417-1.287 2.327-2.587 2.327q-.488 0-.936-.156c-.3.234-.455.455-.455.65 0 .182.182.429.48.442l2.458.143c1.287.078 1.859.65 1.859 1.456 0 1.079-1.391 2.405-3.81 2.405-1.234 0-2.352-.52-2.352-1.469 0-.481.325-1.027.949-1.365l.312-.169v-.026l-.923-.884c.26-.663.546-.988 1.027-1.391C9.726 9.647 9.297 9.01 9.297 8.1c0-1.417 1.105-2.379 2.496-2.379.598 0 1.014.143 1.534.325l1.807-.195zM11.87 9.816c.689 0 1.248-.611 1.248-1.599 0-1.391-.624-1.989-1.404-1.989-.767 0-1.222.572-1.222 1.56 0 1.274.533 2.028 1.378 2.028m1.274 2.691-2.457-.156c-.195.208-.56.689-.56 1.157 0 .481.43 1.157 1.795 1.157 1.599 0 2.262-.767 2.262-1.365 0-.455-.3-.741-1.04-.793"})})});var S=()=>n(735790),M=()=>n(11356);const A={viewBox:"0 0 20 20",svg:(0,y.jsx)("path",{d:"m8.965 12.538 1.125 3.077a.625.625 0 1 0 1.174-.43L7.526 4.961a.987.987 0 0 0-1.854 0L1.934 15.185a.625.625 0 1 0 1.174.43l1.125-3.078zm-.457-1.25H4.69l1.909-5.223zm7.334 4.554a.625.625 0 0 1-.884 0l-2.475-2.475a.625.625 0 0 1 .884-.884l1.408 1.408V4.994a.625.625 0 1 1 1.25 0v8.897l1.408-1.408a.625.625 0 1 1 .884.884z"})},w=(0,h().wt)("textSmall",A),k=(0,h().wt)("textStyleIcon",{viewBox:"0 0 16 16",svg:(0,y.jsx)("g",{children:(0,y.jsx)("path",{d:"M.74 13.097c-.355 0-.574-.212-.574-.554 0-.116.02-.226.075-.37l3.206-8.55q.226-.625.862-.623c.437 0 .717.212.875.629l3.206 8.538a1 1 0 0 1 .075.37c0 .34-.233.56-.595.56-.355 0-.533-.137-.663-.52l-.882-2.413H2.292l-.882 2.413c-.13.383-.307.52-.67.52m1.887-3.972h3.356l-1.66-4.6h-.035zm9.604 4.02c-1.449 0-2.454-.875-2.454-2.181 0-1.272.964-2.071 2.694-2.167l2.208-.123v-.588c0-.957-.636-1.552-1.702-1.552-.89 0-1.47.37-1.853 1.162-.103.192-.267.274-.479.274-.293 0-.519-.199-.519-.5 0-.143.055-.307.13-.478.39-.882 1.463-1.449 2.748-1.449 1.736 0 2.83.964 2.83 2.454v4.56c0 .369-.232.594-.56.594-.322 0-.554-.225-.554-.567v-.902h-.028c-.423.888-1.408 1.463-2.46 1.463Zm.28-.95c1.204 0 2.168-.855 2.168-1.942v-.725l-2.065.13c-1.073.069-1.654.554-1.654 1.279 0 .752.629 1.257 1.552 1.257Z"})})});var j=()=>n(931075),C=()=>n(100622),I=()=>n(496603),T=()=>n(896628),_=()=>n(696384),P=()=>n(246826),B=()=>n(751156),R=()=>n(799832),L=()=>n(930545),D=()=>n(575143),O=()=>n(124524),N=()=>n(89924),E=()=>n(553965),U=()=>n(962730),F=()=>n(704152),V=()=>n(939740),K=()=>n(859428),H=()=>n(125565);function z(e,t){return e.isFiltering?function(e){return(0,y.jsx)(D().A,{...e,title:e.caption,caption:void 0})}(e):function(e,t){let{id:n,caption:s,focused:r,isActive:l,onClick:d,onMouseDown:c,onMouseEnter:u,onMouseLeave:p,role:m,style:g,tooltip:f,ignoreLocalHoverState:h,disallowTabbing:v}=e;const b=(0,i().Y0)(),{isMenuListFocusVisible:x}=(0,o.useContext)(V().VU),S=(0,a().IS)((e=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...b.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:l?C().Ay.blue:"inherit",...r&&x&&{boxShadow:e.outlineBlueInputBoxShadow}}})),[l,b,x,r]);return(0,y.jsx)(K().A,{renderTooltip:()=>f,placement:U().W.Bottom,delayThreshold:80,render:e=>{const o=(0,E().A)(e,{onMouseEnter:u,onMouseLeave:p}),{onMouseDown:i,...a}=o;return(0,y.jsx)(F().A,{...a,id:n,role:m,ref:t,mobileFeedback:b.isMobile,onClick:d,onMouseDown:o.onMouseDown||c,hovered:r,style:S.button,ignoreLocalHoverState:h,disallowTabbing:v,className:"notranslate",children:(0,y.jsxs)("div",{style:S.optionItem,children:[(0,y.jsx)("div",{style:{...g,height:25},children:"Ag"}),(0,y.jsx)(H().A,{isSmall:!0,style:{marginTop:4},children:s})]})})}})}(e,t)}const W=o.forwardRef(z);const G=function(e){const{children:t}=e,n=(0,i().v3)(),{mobileStyle:o,desktopStyle:s}=(0,a().IS)((e=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${e.regularDividerColor}`,background:e.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",padding:"0px 8px"}})),[]);return(0,y.jsx)(N().A,{...e,children:(0,y.jsx)("div",{style:n.device.isMobile?o:s,children:t})})};var Y=()=>n(53528),q=()=>n(534177),$=()=>n(470928);function Q(e){const{intl:t,blockStore:n}=e,o=(0,$().i1)(n);if("none"!==o.type){if("expired"===o.type)return t.formatMessage(Z.expiredVerification);if("verified"===o.type){if(o.isIndefinite)return t.formatMessage(Z.indefiniteVerification);{const e=o.dateTimeRange.end,n=(0,Y().OH)({dateTime:e,intl:t,shortenDateAndRange:!0});return t.formatMessage(Z.verificationWithEndDate,{date:n})}}(0,q().HB)(o)}}const Z=(0,l().YK)({expiredVerification:{defaultMessage:"Expired",id:"verificationHelpers.mobileAction.subtitle.expiredVerification"},indefiniteVerification:{defaultMessage:"No expiration",id:"verificationHelpers.mobileAction.subtitle.indefiniteVerification"},verificationWithEndDate:{defaultMessage:"Until {date}",id:"verificationHelpers.mobileAction.subtitle.datedVerification"}});var X=()=>n(546692),J=()=>n(558687),ee=()=>n(416726),te=()=>n(435009),ne=()=>n(878377),oe=()=>n(597755),ie=()=>n(492414);const se=(0,l().YK)({openInMacAppName:{id:"action.openInMacApp.name",defaultMessage:"Open in Mac app"},openInWindowsAppName:{id:"action.openInWindowsApp.name",defaultMessage:"Open in Windows app"},openIniOSAppName:{id:"action.openIniOSApp.name",defaultMessage:"Open in iOS app"},openInAndroidAppName:{id:"action.openInAndroidApp.name",defaultMessage:"Open in Android app"}}),ae=(0,ee().Ls)({key:"open in mac app",displayName:se.openInMacAppName,analyticsName:se.openInMacAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().AU6(ne().FrL),ne().cX8,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:(0,oe().P)(o),environment:n})}}),re=(0,ee().Ls)({key:"open in windows app",displayName:se.openInWindowsAppName,analyticsName:se.openInWindowsAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().AU6(ne().FrL),ne().uFH,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:(0,oe().P)(o),environment:n})}}),le=(0,ee().Ls)({key:"open in ios app",displayName:se.openIniOSAppName,analyticsName:se.openIniOSAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().un6,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:o,environment:n})}}),de=(0,ee().Ls)({key:"open in android app",displayName:se.openInAndroidAppName,analyticsName:se.openInAndroidAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().m01,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:o,environment:n})}});function ce(){return[ae,re,le,de]}var ue=()=>n(877235),pe=()=>n(910302),me=()=>n(722872),ge=()=>n(430483),fe=()=>n(227440),he=()=>n(77246),ye=()=>n(928600),ve=()=>n(480095),be=()=>n(147294);function xe(e){const{blockStore:t,menuListItemProps:r,title:d,onFocus:c,closeParentMenu:u}=e,p=(0,i().v3)(),m=(0,a().DP)(),g=(0,me().Tf)(),f=(0,s().K8)((()=>ge().zD.isFullPageTranslateEnabled()),[]),{detectedLanguage:h}=(0,n(514799).H)({pageStore:t,enabled:f}),v=(0,n(5580).n)(),[b,x]=(0,o.useState)(void 0),S=b??h??v,{isTranslating:M,editorModeConfigTranslateState:A}=(0,s().K8)((()=>{const e=he().Uv.getTranslateModeForBlock(t.id);return e?{isTranslating:!0,editorModeConfigTranslateState:e}:{isTranslating:!1,editorModeConfigTranslateState:{mode:"translate_unlocked",status:"pre_activation",sourceLanguage:S}}}),[t,S]),w=!(0,s().O$)(fe().e),k=(0,o.useCallback)((e=>{const{sourceLanguage:t}=e;x(t)}),[]),j=(0,o.useCallback)((e=>{const{targetLanguage:n}=e;pe().Z9({pageStore:t,environment:p}),pe().Ww({pageStore:t,targetLanguage:n,sourceLanguage:S,environment:p,triggeredFrom:"action_menu"}),u()}),[t,S,p,u]),C=(0,s().K8)((()=>(0,ee().cz)(m,M)),[M,m]);return"pre_activation"!==A.status||w?(0,y.jsx)(D().A,{...r,title:d,badge:(0,y.jsx)(be().E,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"}),svg:ue().H,right:C,onClick:()=>{pe().DL({pageStore:t,environment:p,triggeredFrom:"action_menu"}),u()},disabled:w,disabledFeedback:w,tooltipText:w?(0,y.jsx)(l().sA,{...ee().AY.unavailableOfflineTooltip}):void 0}):(0,y.jsx)(n(662971).A,{...r,disableDefaultClick:!0,onFocus:c,focused:r.focused,disableCloseOnEnter:!0,renderExtension:(e,o)=>{const i=p.device.isMobile?{menuType:me().gu.Modal,right:g?void 0:(0,y.jsx)(ve().DoneMenuText,{}),left:g?(0,y.jsx)(ve().MobileModalBackButton,{}):void 0,onClickRight:g?void 0:o.close,onClickLeft:g?o.close:void 0,shouldRenderMobileRefresh:g,paddingTop:g?10:void 0,title:d,...e}:{menuType:me().gu.Popup,height:480,...e};return(0,y.jsx)(ye().A,{...i,onClick:e=>{e.stopPropagation()},children:(0,y.jsx)(n(391435).Z,{onSelectTargetLanguage:j,onSelectSourceLanguage:k,editorModeConfigTranslateState:A,sourceLanguage:S,detectedPageLanguage:h,preferredLanguage:v,subMenuPlacement:U().W.Left,pageId:t.id})})},renderOrigin:(e,t)=>(0,y.jsx)(D().A,{...e,ref:t,title:d,badge:(0,y.jsx)(be().E,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"}),svg:ue().H,right:C})})}var Se=()=>n(989423),Me=()=>n(972435),Ae=()=>n(600871),we=()=>n(538075),ke=()=>n(178998),je=()=>n(869562),Ce=()=>n(737230),Ie=()=>n(351360),Te=()=>n(508496),_e=()=>n(404141),Pe=()=>n(795179),Be=()=>n(488923),Re=()=>n(102172);const Le=(0,l().YK)({aiCoEditingName:{id:"action.aiCoEditing.name",defaultMessage:"AI co-editing"}}),De=(0,ee().fi)({key:"ai_co_editing",displayName:Le.aiCoEditingName,label:Me().A.formatMessage(Le.aiCoEditingName),svg:n(824375).X,isEnabled:e=>e.isNavigableBlock()&&(0,Re().Wv)(e,e.environment),validators:[ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3),ne().AU6(ne().ln6),()=>ge().zD.isAiEnabled(),ne().SQN("ai_co_editing")],action:async(e,t,n)=>{if(!t.isNavigableBlock())return;const o=(0,Re().Wv)(t,e);if(await(0,Be().ne)({environment:e,pageId:t.id,active:!o}),o){(await(0,Be().gY)()).clearStore()}}});var Oe=()=>n(290625),Ne=()=>n(797583),Ee=()=>n(654056),Ue=()=>n(142015);const Fe={viewBox:"0 0 20 20",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{d:"M10 5.88c.345 0 .625.28.625.625V8.38H12.5a.625.625 0 1 1 0 1.25h-1.875v1.875a.625.625 0 1 1-1.25 0V9.63H7.5a.625.625 0 1 1 0-1.25h1.875V6.505c0-.345.28-.625.625-.625"}),(0,y.jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})]})},Ve=(0,h().wt)("commentAdd",Fe);var Ke=()=>n(525884),He=()=>n(848392),ze=()=>n(454531),We=()=>n(158574),Ge=()=>n(182034),Ye=()=>n(900967),qe=()=>n(449195),$e=()=>n(489348),Qe=()=>n(592968);const Ze=(0,l().YK)({addCover:{id:"mobile_page_actions.add_cover",defaultMessage:"Add cover"},changeCover:{id:"mobile_page_actions.change_cover",defaultMessage:"Change cover"},addComment:{id:"mobile_page_actions.add_comment",defaultMessage:"Add comment"},backlinks:{id:"mobile_page_actions.backlinks",defaultMessage:"Backlinks"},addDescription:{id:"mobile_page_actions.add_description",defaultMessage:"Add description"},showDescription:{id:"mobile_page_actions.show_description",defaultMessage:"Show description"},hideDescription:{id:"mobile_page_actions.hide_description",defaultMessage:"Hide description"}});function Xe(e){const{blockStore:t,environment:n}=e;return(0,ee().Ls)({key:"add comment",displayName:Ze.addComment,svg:Ve,analyticsName:Ze.addComment.defaultMessage,validators:[ne().pxM,ne().AU6(ne().omD),L().tm,ne().AU6(L().SD)],closeParentMenu:!0,track:{actionName:"add_comment"},action:async(e,o,i)=>{await(0,Ge().O)({blockStore:t,environment:n})}})}function Je(e){const{environment:t,intl:n,blockStore:o}=e,i=Boolean(o.getCover());return(0,ee().Ls)({key:"add page cover",displayName:i?Ze.changeCover:Ze.addCover,svg:He().M,analyticsName:i?Ze.changeCover.defaultMessage:Ze.addCover.defaultMessage,validators:[ne().p2L,ne()._fc,ne().AU6(ne().oy3),ne().FFM,ne().AU6(ne().J$q)],closeParentMenu:!0,track:{actionName:"edit_cover"},action:(e,i,s)=>{ze().W({environment:t,intl:n,store:o,rect:i.originRect})}})}function et(e){const{environment:t,blockStore:n}=e,o=(0,Ye().J)(n,t).backlinksCount;if(o<=0)return;return"section_hide"!==(0,qe().nl)(n.getFormat().page_section_visibility)?(0,ee().Ls)({key:"view backlinks",displayName:Ze.backlinks,analyticsName:"view_backlinks",validators:[ne().pxM],track:{actionName:"view_backlinks"},closeParentMenu:!0,render:e=>(0,y.jsx)(D().A,{...e,title:(0,y.jsx)(l().sA,{id:"topbarMoreMenuActions.viewBacklinks",defaultMessage:"{numberOfBacklinks, plural, =0 {No backlinks} one {{numberOfBacklinks} backlink} other {{numberOfBacklinks} backlinks}}",values:{numberOfBacklinks:o}}),svg:Ue().D}),action:(e,t,n)=>{Qe().F.setState({isOpen:!0})}}):void 0}function tt(e){const{blockStore:t}=e;if(!t.isType(p().xd.collectionViewPage))return;const n=$e().A.getPageViewBlockStore(t);if(!n)return;const{currentUserSettingsStore:o}=Ie().default.state,i=t.getCollectionViewSourceDescriptionStoreIfSingleSource(),s=We().OW(i),a=n.state.isPageDescriptionExpanded;return s&&a?nt({shouldShow:!1,blockStore:t,descriptionStore:i,pageViewBlockStore:n,userSettingsStore:o}):s&&!a?nt({shouldShow:!0,blockStore:t,descriptionStore:i,pageViewBlockStore:n,userSettingsStore:o}):function(e){const{blockStore:t,descriptionStore:n,pageViewBlockStore:o,userSettingsStore:i}=e;return(0,ee().Ls)({key:"add collection description",displayName:Ze.addDescription,analyticsName:"add_collection_description",validators:[ne().BAy,ne().p2L],closeParentMenu:!0,svg:Ke().A,track:{actionName:"add_collection_description"},action:(e,s,a)=>{We().de({environment:s.environment,pageId:t.id,store:o,userSettingsStore:i,isExpanded:!0,descriptionStore:n})}})}({blockStore:t,descriptionStore:i,pageViewBlockStore:n,userSettingsStore:o})}function nt(e){const{shouldShow:t,blockStore:n,descriptionStore:o,pageViewBlockStore:i,userSettingsStore:s}=e;return(0,ee().Ls)({key:t?"show collection description":"hide collection description",displayName:t?Ze.showDescription:Ze.hideDescription,analyticsName:t?"show_collection_description":"hide_collection_description",validators:[ne().BAy,ne().p2L],closeParentMenu:!0,svg:Ke().A,track:{actionName:t?"show_collection_description":"hide_collection_description"},action:(e,t,a)=>{We().Bq({toggleStore:i,pageId:n.id,descriptionStore:o,environment:t.environment,userSettingsStore:s})}})}var ot=()=>n(354406),it=()=>n(137743),st=()=>n(364811),at=()=>n(910702),rt=()=>n(921385);const lt=(0,l().YK)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontComicName:{id:"action.setPageFont.comic.fuzzySearchKeywords",defaultMessage:"Font Comic"},fontComicCaption:{id:"action.setPageFont.comic.caption",defaultMessage:"Comic"},fontComicTooltip:{id:"action.setPageFont.comic.tooltip",defaultMessage:"Playful but cringe"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},importName:{id:"action.import.name",defaultMessage:"Import"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},floatingTableOfContents:{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"},notifyMe:{id:"action.notifyMe.name",defaultMessage:"Notify me"},pageVerification:{id:"action.pageVerification.name",defaultMessage:"Page verification"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"View edit history"},pageHistoryNewName:{id:"action.pageHistoryNew.name",defaultMessage:"Version history"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},textFontStyle:{id:"action.textFontStyle.name",defaultMessage:"Text style"},suggestEditsName:{id:"action.suggestEdits.name",defaultMessage:"Suggest edits"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},viewUpdatesAndAnalyticsName:{id:"action.updatesAndAnalytics.name",defaultMessage:"Updates & analytics"},openPageLayoutEditor:{id:"action.layoutEditor.open",defaultMessage:"Customize layout"},translate:{id:"action.translate",defaultMessage:"Translate"}});function dt(e){const{environment:t,intl:n,context:o,isFiltering:i}=e,s=o.blocks[0],a=s.getFollowSettingsKey(),r=we().H8({followSettingsKey:a,environment:t,blockStore:s,from:"more_menu"}),l=!s.isPost()&&!s.isPostCollectionBlock(),d=!s.isPost()&&!s.isPostCollectionBlock();if(s.isSystemBlock())return[(0,ee().gy)({key:"system block all actions",render:e=>(0,y.jsx)(N().A,{...e}),actions:[Dt,Mt,Oe().qQ,Oe().Zk,rt().p6,At,...ce()]})];const c=(0,Ae().LX)({device:t.device});return[i?gt(t,s.getFormat().page_font||"default"):pt,(0,ee().gy)({key:"page style and layout",render:e=>(0,y.jsx)(N().A,{...e,topBorder:!1}),actions:[...(0,I().oE)([ft,d?ht:void 0,l?bt:void 0,Dt,Mt]),...c?(0,I().oE)([Oe().Xv,Je({environment:t,intl:n,blockStore:s}),Xe({blockStore:s,environment:t}),et({environment:t,blockStore:s}),tt({blockStore:s})]):[]]}),(0,ee().gy)({key:"viewing of page content",render:e=>(0,y.jsx)(N().A,{...e}),actions:[yt,ke().Z,De,Oe().fg,Oe().Fh,Oe().cy]}),ot().LQ,(0,ee().gy)({key:"editing of page content",render:e=>(0,y.jsx)(N().A,{...e}),actions:[xt,Ne().DI,St]}),(0,ee().gy)({key:"undo",render:e=>(0,y.jsx)(N().A,{...e}),actions:[rt().tN]}),(0,ee().gy)({key:"topbar primary actions",render:e=>(0,y.jsx)(N().A,{...e}),actions:[Oe().qQ,Oe().Zk,kt({environment:t,intl:n,blockStore:s}),rt().p6,At,wt,Ee().TR,Ee().kl,Ee().J8,Ee().lb,it().t,st().dl]}),(0,ee().gy)({key:"topbar import actions",render:e=>(0,y.jsx)(N().A,{...e}),actions:[Rt,Oe().TD,Oe().EX,Lt]}),(0,ee().gy)({key:"topbar wiki actions",render:e=>(0,y.jsx)(N().A,{...e}),actions:(0,I().oE)([at().H0,at().hk])}),Bt(),Pt(t,r),(0,X().A)(o),(0,ee().gy)({key:"topbar view options",render:e=>(0,y.jsx)(N().A,{...e}),actions:ce()})]}function ct(e){return(0,ee().Ls)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().p2L,ne().AU6(ne().oy3),...e.extraValidators],render:(t,n)=>{const o=n.blocks[0].getFormat().page_font,i=e.font===o||!e.font&&!o;return(0,y.jsx)(W,{...t,isActive:i,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption,isFiltering:e.isFiltering,isChecked:e.checkStatus,svg:e.svg})},closeParentMenu:!!e.isFiltering,track:{actionName:"set_font"},action:(t,n,o)=>{let{blocks:i,environment:s}=n;const{serverCommitResult:a}=B().createAndCommit({userAction:"actionRegistry.createFontAction",environment:s,canUndo:!0,perform:t=>{T().zA({stores:i,update:{page_font:e.font},transaction:t}),function(e,t){Se().vd(e,"change_font_type",t)}(s,{type:e.font||"default"})}});a.then(t)}})}const ut=[{font:"default",action:function(e){const{isFiltering:t,pageFont:n}=e;return ct({displayName:lt.fontDefaultName,caption:(0,y.jsx)(l().sA,{...lt.fontDefaultCaption}),font:void 0,tooltip:(0,y.jsx)(l().sA,{...lt.fontDefaultTooltip}),style:t?{}:{fontSize:24,fontFamily:d().vc(c().locale).sans,position:"relative",top:-2},extraValidators:[],isFiltering:t,checkStatus:"default"===n,svg:b})}},{font:"serif",action:function(e){const{isFiltering:t,pageFont:n}=e;return ct({displayName:lt.fontSerifName,caption:(0,y.jsx)(l().sA,{...lt.fontSerifCaption}),font:"serif",tooltip:(0,y.jsx)(l().sA,{...lt.fontSerifTooltip}),style:t?{}:{fontSize:25,fontFamily:d().vc(c().locale).serif},extraValidators:[],isFiltering:t,checkStatus:"serif"===n,svg:x})}},{font:"mono",action:function(e){const{isFiltering:t,pageFont:n}=e;return ct({displayName:lt.fontMonoName,caption:(0,y.jsx)(l().sA,{...lt.fontMonoCaption}),font:"mono",tooltip:(0,y.jsx)(l().sA,{...lt.fontMonoTooltip}),style:t?{}:{fontSize:26,fontFamily:d().vc(c().locale).mono,position:"relative",top:-3,letterSpacing:-1},extraValidators:[],isFiltering:t,checkStatus:"mono"===n,svg:v})}},{font:"comic",action:function(e){const{isFiltering:t,pageFont:n}=e;return ct({displayName:lt.fontComicName,caption:(0,y.jsx)(l().sA,{...lt.fontComicCaption}),font:"comic",tooltip:(0,y.jsx)(l().sA,{...lt.fontComicTooltip}),style:{fontSize:t?14:26,fontFamily:d().vc(c().locale).comic,position:"relative",top:-3,letterSpacing:-1},extraValidators:[ne().or([ne().SQN("comic_sans"),e=>e.blocks.some((e=>"comic"===e.getFormatStore().getKeyStore("page_font").getValue()))])],isFiltering:t,checkStatus:"comic"===n})}}],pt=(0,ee().gy)({key:"font section",title:void 0,render:e=>(0,y.jsx)(G,{...e}),actions:ut.map((e=>e.action({isFiltering:!1})))});function mt(e){return(0,ee().gy)({key:"font extension menu",render:e=>(0,y.jsx)(N().A,{...e}),actions:ut.map((t=>t.action({isFiltering:!0,pageFont:e})))})}function gt(e,t){const n=(0,C().O4)({theme:e.ThemeModeStore.state}),o=ut.map((e=>e.font)).findIndex((e=>e===t))??0;return(0,ee().gy)({key:"textStyleAction",render:e=>(0,y.jsx)(N().A,{...e}),actions:[(0,ee().uk)({key:"font style section",displayName:lt.textFontStyle,analyticsName:lt.textFontStyle.defaultMessage,svg:k,right:(0,y.jsx)(y.Fragment,{children:t.charAt(0).toUpperCase()+t.slice(1)}),rightStyle:{color:n.text.tertiary,marginRight:5},width:300,validators:[ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().p2L,ne().AU6(ne().oy3)],subActions:()=>[mt(t)],initialFocus:o,hideSubActions:!0,fuzzySearchKeywordsArray:[lt.fontDefaultName,lt.fontSerifName,lt.fontMonoName]})]})}const ft=(0,ee().fi)({key:"small text",displayName:lt.fontSmallTextKeywords,label:Me().A.formatMessage(lt.fontSmallTextLabel),svg:w,isEnabled:e=>Boolean(e.getFormat().page_small_text),validators:[ne().AU6(ne().FrL),ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().p2L,ne().AU6(ne().oy3)],track:{actionName:"set_text_size"},action:(e,t,n)=>T().zA({stores:[t],update:{page_small_text:!t.getFormat().page_small_text},transaction:n}),afterAction:(e,t)=>{Se().vd(t,"change_font_size",{type:e?"small":"large"})}}),ht=(0,ee().fi)({key:"full width",displayName:lt.fullWidthLabel,svg:n(665589).l,label:Me().A.formatMessage(lt.fullWidthLabel),isEnabled:e=>e.isFullWidth(),validators:[ne().AU6(ne().tpB),ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3)],track:{actionName:"set_width"},action:(e,t,n)=>{T().zA({stores:[t],update:{page_full_width:!t.isFullWidth()},transaction:n})},afterAction:(e,t)=>{Se().vd(t,"change_page_width",{type:e?"full_width":"default_width"})}}),yt=(0,ee().fi)({key:"page lock",displayName:lt.lockPageName,label:Me().A.formatMessage(lt.lockPageName),svg:e=>(0,y.jsx)(O().I,{isLocked:!1,style:e}),svgWhenEnabled:e=>(0,y.jsx)(O().I,{isLocked:!0,style:e}),isEnabled:e=>e.isLockedForAllUsers(),validators:[ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3)],action:(e,t,n)=>P().zv({store:t.getFormatStore(),data:{block_locked:!t.isLockedForAllUsers(),block_locked_by:e.currentUser.id},transaction:n}),afterAction:()=>null}),vt=[ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3),ne().AU6(ne().FrL),ne().or([ne().wTm])],bt=(0,ee().fi)({key:"floating table of contents",displayName:lt.floatingTableOfContents,svg:n(358359).L,label:Me().A.formatMessage(lt.floatingTableOfContents),isEnabled:e=>{var t;return"off"!==(null===(t=e.getModel())||void 0===t?void 0:t.getFloatingTableOfContentsState())},validators:vt,action:(e,t,n)=>{var o;const i="off"!==(null===(o=t.getModel())||void 0===o?void 0:o.getFloatingTableOfContentsState());P().zv({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:i?"off":"minimal"}},transaction:n})},afterAction:(e,t)=>{(0,Se().u4)({environment:t,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:e}}})}}),xt=(0,ee().Ls)({key:"suggest edits",displayName:lt.suggestEditsName,analyticsName:lt.suggestEditsName.defaultMessage,validators:[ne().AU6(ne().ln6),ne().AU6(ne().FrL),ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().$9,ne().AU6(ne().oy3)],render:(e,t)=>{const o="suggest"===he().Uv.getMode(t.blocks[0]),i=(0,C().O4)({theme:t.environment.ThemeModeStore.state});return(0,y.jsx)(D().A,{...e,title:(0,y.jsx)(l().sA,{...lt.suggestEditsName}),svg:n(209416).a,right:(0,ee().cz)(i,o)})},action:e=>{const t="suggest"===he().Uv.getMode(e.blocks[0])?"default":"suggest";"suggest"===t&&Pe().A.reset(),n(473227).PD({environment:e.environment,navigableBlockStore:e.blocks[0],mode:t,location:"page_more_actions"})},closeParentMenu:!0}),St=(0,ee().Ls)({key:"translate",displayName:lt.translate,analyticsName:"open_translate_bar_from_topbar",validators:[ne().yI5,ne().pxM],closeParentMenu:!0,render:(e,t,n)=>{let{onFocus:o}=n;const i=t.blocks.at(0);if(i)return(0,y.jsx)(xe,{onFocus:o,closeParentMenu:()=>{Pe().A.reset()},blockStore:i,menuListItemProps:e,title:(0,y.jsx)(l().sA,{...lt.translate})})},action:()=>{}}),Mt=(0,ee().Ls)({key:"customize page",displayName:lt.customizePageLabel,analyticsName:lt.customizePageLabel.defaultMessage,svg:S().M,validators:[ne().AU6(ne().wTm),ne().VNy,ne().AU6(ne().oy3),ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().or([ne().FrL,ne().AU6(ne().omD),ne().UC4]),ne().AU6(ne().Po5)],closeParentMenu:!0,render:e=>(0,y.jsx)(D().A,{...e,title:(0,y.jsx)(l().sA,{...lt.customizePageLabel}),svg:S().M}),action:e=>{n(334261).ho({originRect:e.originRect})}}),At=(0,ee().Fw)({key:"copy link to block non-desktop",displayName:ee().AY.copyLinkNavigableTypeName,analyticsName:ee().AY.copyLinkNavigableTypeName.defaultMessage,svg:n(742852).w,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[ne().M3g,ne().vXb,ne().AU6(ne().b8R),ne().AU6(ne().oy3),ne().AU6(ne().Po5)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,t,o)=>{let{lazyDependencies:i,...s}=t;const{clipboardActions:a}=i;a?a.copyLinkToBlock({...s,callback:e,event:o}):n(857639).log({data:{miscDataToConvertToString:{actionKey:"copy link to block non-desktop"}},from:"topbarMoreActionRegistry",level:"info",type:"lazyDependencies:missingClipboardActions"})}}),wt=(0,ee().Fw)({key:"duplicate",displayName:ee().AY.duplicateName,analyticsName:ee().AY.duplicateName.defaultMessage,svg:n(764781).V,validators:[ne()._fc,ne().p2L,ne().MIU,ne().omD,ne().AU6(ne().Xjv(p().xd.externalObjectInstancePage)),ne().AU6(ne().UC4),ne().AU6(ne().PfK),ne().AU6(ne().oy3)],shortcuts:["duplicate"],closeParentMenu:!0,track:{actionName:"duplicate"},action:async(e,t,o)=>{let{environment:i}=t;const s=n(186445).ao();if(!s)return;const a=s.getAssociatedCollectionStore();if(!a)return;if(!(0,n(611371).EF)(i))return;const r=new(n(889097).A)(i);if(r.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:a}),(0,n(405417).ls)(s,r))return void(await n(60867).HF({environment:i,blocks:[s],collectionContextStore:r,callback:e}));const{duplicateBlock:l}=await(0,n(855801).D6)(),{serverCommitResult:d}=B().createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:i,canUndo:!0,perform:e=>{const{blockStores:t}=l({environment:i,stores:[s],transaction:e,targetSpaceId:(0,n(161479).e)(a.pointer.spaceId),preferDuplicateLocation:"local",options:{addCopyName:(0,n(53664).A)(s),deepCopyTransclusionContainers:!0,resolveTemplateVariables:!s.isInsideTemplate()}}),o=t[0];n(44729).X$({childStore:o,parentStore:a,transaction:e}),s.isTemplate()&&n(722101).BC({parentStore:a.getTemplatePagesStore(),appendStore:o,transaction:e}),n(857783).uK({environment:i,store:o,pageVisitSource:u().y8.Duplicate})}});d.then(e)},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online});function kt(e){const{environment:t,intl:n,blockStore:o}=e,i=(0,C().O4)({theme:t.ThemeModeStore.state});return(0,ee().Ls)({key:"open page verification menu",analyticsName:"Open page verification",displayName:lt.pageVerification,render:e=>(0,y.jsx)(D().A,{...e,svg:m().J,title:(0,y.jsx)(l().sA,{...lt.pageVerification}),right:(0,y.jsx)("div",{style:{color:i.text.tertiary,marginRight:0},children:Q({intl:n,blockStore:o})}),rightStyle:{marginRight:5},showExtensionArrow:!0}),validators:[ne().FrL,e=>ne().p2L(e),()=>(0,$().Io)(),()=>{var e;const t=null===(e=Ie().default.state.currentSpaceStore)||void 0===e?void 0:e.getModel();return Boolean(t&&(0,j().Xi)(t))}],closeParentMenu:!1,action:()=>{_().h()}})}const jt=(0,ee().Ls)({key:"open page updates",analyticsName:"Open page updates",displayName:lt.pageUpdates,svg:f().clockIcon,validators:[L().tm,ne().FrL],closeParentMenu:!0,action:()=>{n(338429).A.setState({open:!0})},disabled:()=>!fe().A.state.online}),Ct=(0,ee().Ls)({key:"action page history",displayName:lt.pageHistoryName,analyticsName:lt.pageHistoryName.defaultMessage,svg:M().G,validators:[ne().or([ne().hfc,ne().Xmj]),ne()._fc,ne().M3g,ne().AU6(ne().vP$),ne().AU6(ne().PfK),ne().AU6(ne().Qp$),ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;return n(82926).WE({environment:t,blockStore:o[0],from:"topbar"})},render:(e,t)=>{let{onClick:o,key:i,...s}=e,{environment:a}=t;return(0,y.jsx)(n(643908).A,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:o,alwaysAllowClick:!0,render:(e,t)=>{const n=!fe().A.state.online;return(0,y.jsx)(D().A,{...(0,E().A)(s,e),title:Me().A.formatMessage(lt.pageHistoryNewName),svg:M().G,dontShrinkRight:!0,right:t,tooltipText:n?Me().A.formatMessage(ee().AY.unavailableOfflineTooltip):void 0,disabled:n,disabledFeedback:n})},renderUpgradeTooltip:()=>{}},i)}}),It=(0,ee().Ls)({key:"view analytics",displayName:lt.viewAnalyticsName,analyticsName:lt.viewAnalyticsName.defaultMessage,svg:n(489538).o,validators:[ne().JYi,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{je().handleSidebarButtonClick(e.environment,e.blocks[0],Ce().tF.Updates,"more_menu"),Ce().Ay.setState({...Ce().Ay.state,updatesSubTab:Ce().VE.Analytics})},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online}),Tt=(0,ee().Ls)({key:"view updates and analytics",displayName:lt.viewUpdatesAndAnalyticsName,analyticsName:lt.viewUpdatesAndAnalyticsName.defaultMessage,validators:[ne().JYi,ne().AU6(ne().Po5)],svg:f().clockIcon,closeParentMenu:!0,action:e=>{const{currentUserSettingsStore:t}=Ie().default.state;t&&B().createAndCommit({environment:e.environment,userAction:"topbarMoreActonRegistry.openUpdatesAndAnalytics",canUndo:!0,perform:e=>{n(755199).mJ({userSettingsStore:t,transaction:e,data:{opened_new_top_bar_updates_entrypoint:!0}})}}),je().handleSidebarButtonClick(e.environment,e.blocks[0],Ce().tF.Updates,"more_menu")},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online});function _t(e,t){var n;const o=(0,C().O4)({theme:e.ThemeModeStore.state});return(0,ee().uk)({key:"notifications",displayName:lt.notifyMe,analyticsName:lt.notifyMe.defaultMessage,svg:g().r,right:null===(n=t.find((e=>e.isSelectedOption)))||void 0===n?void 0:n.action.displayName,rightStyle:{color:o.text.tertiary,marginRight:5},width:300,initialFocus:t.findIndex((e=>e.isSelectedOption))??0,validators:[ne().AU6(ne().oy3),ne().AU6(ne().Po5)],subActions:()=>[(0,ee().gy)({key:"notifications",render:e=>(0,y.jsx)(N().A,{...e}),actions:t.map((e=>{let{action:t}=e;return t}))})],hideSubActions:!0,fuzzySearchKeywordsArray:(0,I().oE)(t.map((e=>{let{action:t}=e;return t.displayName?we().aE(t.displayName):void 0})))})}function Pt(e,t){return(0,ee().gy)({key:"notifyMe",render:e=>(0,y.jsx)(N().A,{...e}),actions:[_t(e,t)]})}function Bt(){const e="on"===Te().default.getEligibleGroup({experimentId:"remove_updates_topbar_button_v2",defaultGroup:"control",disableExposureLogging:!0});return(0,ee().gy)({key:"editorActions",render:e=>(0,y.jsx)(N().A,{...e}),actions:(0,I().oE)([jt,e?Tt:It,Ct])})}const Rt=(0,ee().Ls)({key:"open import modal",displayName:lt.importName,analyticsName:lt.importName.defaultMessage,svg:n(820579).f,validators:[ne().IRu,ne().p2L,ne().AU6(ne().Xjv(p().xd.externalObjectInstancePage)),ne().AU6(ne().PfK),ne().AU6(ne().oy3)],closeParentMenu:!0,action:e=>{let{blocks:t}=e,o=!1;if(1===t.length){const[e]=t;o=e.isCollectionView()}o?n(41432).A.setState({open:!0}):_e().A.setState({..._e().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"topbar"})},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online}),Lt=(0,ee().Ls)({key:"export block",displayName:lt.exportName,analyticsName:lt.exportName.defaultMessage,validators:[ne().M3g,ne().y9r,ne().AU6(ne().Po5)],closeParentMenu:!0,render:e=>{const t=!fe().A.state.online;return(0,y.jsx)(D().A,{...e,svg:n(419178).Q,title:(0,y.jsx)(l().sA,{...lt.exportName}),tooltipText:t?(0,y.jsx)(l().sA,{...ee().AY.unavailableOfflineTooltip}):(0,y.jsx)(l().sA,{...lt.exportCaption}),disabled:t,disabledFeedback:t})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];if(!i.isDefined())return;let s=!0;const a=(0,R().U)(t[0]);if(a){const e=null==a?void 0:a.collectionStore();null!=e&&e.isPageTreeCollection()&&(s=!1)}n(91709).Ss({environment:o,root:{id:i.id,table:"block",spaceId:i.getSpaceId()},isCollectionViewExportTypeSupported:s})}}),Dt=(0,ee().Ls)({key:"open page layout editor",displayName:lt.openPageLayoutEditor,analyticsName:lt.openPageLayoutEditor.defaultMessage,validators:[ne().wTm],closeParentMenu:!0,render:function(e){const t=!fe().A.state.online;return(0,y.jsx)(D().A,{...e,disabled:t,disabledFeedback:t,svg:n(167170)._,title:(0,y.jsx)(n(21140).Ye,{children:(0,y.jsx)(l().sA,{...lt.openPageLayoutEditor})}),tooltipText:t?(0,y.jsx)(l().sA,{...ee().AY.unavailableOfflineTooltip}):void 0})},action:function(e){let t,o,i,s,{environment:a,blocks:r}=e;for(const n of r)if(n.isCollectionView()){const e=n.getCollectionStore();if(e){t=n,o=e;const a=(0,R().U)(n);i=null==a?void 0:a.collectionViewStore(),s="customize_database_button_in_three_dot_menu";break}}else{const e=n.getAssociatedCollectionStore();if(e&&!e.isPageTreeCollection()){t=n,o=e,s="customize_page_button_in_three_dot_menu";break}}if(!o||!t||!s)throw new Error("Could not edit page layout: Could not find collection");n(447934).nh({environment:a,blockStore:t,collectionStore:o,collectionViewStore:i,from:s})},disabled:()=>!fe().A.state.online,renderTooltip:()=>Me().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online});var Ot=()=>n(836251),Nt=()=>n(857437),Et=()=>n(819493),Ut=()=>n(452558),Ft=()=>n(419357),Vt=()=>n(678553),Kt=()=>n(962036),Ht=()=>n(715011);function zt(e){const{blockStore:t,onClickOriginRect:n,handleAccept:c,handleDismiss:u}=e,p=(0,i().v3)(),m=(0,i().Y0)(),g=(0,l().tz)(),[f,h]=(0,o.useState)(""),[v,b]=(0,Nt().$)(),x=(0,s().K8)((()=>({environment:p,blocks:[t],originRect:n,publicEditMode:void 0,analyticsFrom:"topbar_more_menu"})),[p,t,n]),{initialSections:S,filterSections:M}=(0,s().K8)((()=>({initialSections:dt({environment:p,intl:g,context:x,isFiltering:!1}),filterSections:dt({environment:p,intl:g,context:x,isFiltering:!0})})),[p,g,x]),A=(0,s().K8)((()=>0===f.length&&!t.isCollectionView()&&t.canEdit()&&t.hasContent()&&!t.isPersonProfile()),[t,f]),w=(0,s().K8)((()=>0===f.length&&t.canEdit()&&!t.isPersonProfile()),[t,f.length]),k=(0,s().K8)((()=>t.canEdit()&&t.isCollectionView()),[t]),j=(0,a().IS)((e=>({caption:{color:e.text.tertiary},icon:{color:e.icon.secondary,width:16,height:16},menuPropIcon:{color:e.accentColors.gray[500]}})),[]),C=(0,s().K8)((()=>m.isMobile&&!Te().default.checkGate({gateName:"mobile_topbar_more_menu_search"})||t.isPersonProfile()),[m,t]),I=(0,y.jsxs)(y.Fragment,{children:[A&&!w&&(0,y.jsx)(Vt().Ay,{caption:(0,y.jsx)("span",{style:j.caption,children:(0,y.jsx)(l().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,y.jsx)(Ht().A,{store:t})}})})}),w&&(0,y.jsx)("div",{style:{marginBottom:1},children:(0,y.jsx)(Et().$,{store:t,isPageMoreButton:!0,showWordCount:A})})]}),T=m.isMobile?{menuType:me().gu.Modal,title:(0,y.jsx)(l().sA,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),leftRightButtonStyle:j.menuPropIcon,onClickRight:u,titleOuterStyle:{fontSize:17,fontWeight:d().Wy.bold},paddingTop:10,shouldRenderMobileRefresh:!0}:{menuType:me().gu.Popup,maxHeight:"80vh"};return(0,y.jsxs)(ye().A,{...T,children:[C?(0,y.jsx)(Ut().A,{sections:S,onAccept:c,context:x}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(N().A,{isInput:!0,children:(0,y.jsx)(Ft().Ay,{value:f,onChange:e=>h(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:g.formatMessage({defaultMessage:"Search actions…",id:"topbarMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,inputLeft:(0,r().q)({...j.icon}),showClearButton:!0,...v})}),(0,y.jsx)(Ut().A,{sections:S,filterSections:M,onAccept:c,context:x,filter:f,showNoResultsMessage:!0,initialFocus:f.length>0?0:void 0,comboboxProps:b})]}),(A||w)&&(m.isMobile?(0,y.jsx)(y.Fragment,{children:I}):(0,y.jsx)(N().A,{topBorder:!0,children:I})),k&&(0,y.jsx)(Wt,{})]})}function Wt(){return(0,y.jsx)(N().A,{topBorder:!0,children:(0,y.jsx)(Kt().A,{title:(0,y.jsx)(l().sA,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,Ot().xS)("guides.database"),analyticsFrom:"topbar_more_button"})})}},650843:(e,t,n)=>{n.r(t),n.d(t,{LargeSurfaceRenderError:()=>r});n(296540);var o=()=>n(167355),i=()=>n(840071),s=()=>n(113414),a=n(474848);function r(e){return(0,a.jsx)(i().L,{...e,iconGroup:o().F,children:(0,a.jsx)(s().g,{})})}},654856:(e,t,n)=>{n.d(t,{A:()=>u});n(581454);var o=n(296540),i=()=>n(847249),s=()=>n(959013),a=()=>n(743260),r=()=>n(299545),l=()=>n(417555),d=()=>n(856952),c=n(474848);const u=function(e){const{origin:t,permissionsInviteStore:u,store:p,handleClickRemoveToken:m,handleInputChange:g,handleInputSubmit:f,defaultRoleForNonBot:h,right:y,focus:v,handleFocus:b}=e,x=(0,i().K8)((()=>0!==(0,n(731320).Qo)()),[]),S="share_menu"===t||"add_members"===t,M="add_members"===t,[A,w]=(0,i().$y)(u),k=(0,n(484714).v3)(),{device:j}=k,C=(0,s().tz)(),{tokenQuery:I}=A,T=(0,n(101749).N)(p),_=A.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,i=(0,a().yi)(e),r="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,d=i?T:void 0,u={key:t,target:e,onClickRemove:m,role:A.inviteRole,shouldWrap:S,showInfoIcon:Boolean(d)};return S&&r?(0,c.jsx)(n(859428).A,{placement:n(962730).W.Top,disableTooltip:M,renderTooltip:()=>i?d||(0,c.jsx)(s().sA,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",values:{email:r}}):r,render:n=>(0,o.createElement)("span",{...n,key:t},(0,c.jsx)(l().A,{...u,backgroundColor:(0,a().qv)(e)}))},t):(0,o.createElement)(l().A,{...u,key:t})}));return(0,c.jsx)(d().Ay,{focus:j.isMobile?void 0:v,focusInitial:j.isMobile,focusAfterAnimation:!0,onClick:()=>{j.isMobile||null==b||b()},format:d().le.Share,value:I,onChange:g,type:"email",tokens:_,disabled:!1,autoComplete:"off",placeholder:S?x?C.formatMessage({defaultMessage:"Add people, groups, or emails…",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams"}):C.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}):(0,r().Yu)(p)||(0,r().nw)(p)?C.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):C.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),onRemoveLastToken:()=>{const e={...A};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=h),w(A)},right:y,inputFullWidth:!0,inputAndTokenWrapRightStyle:{paddingTop:k.device.isMobile?0:A.isInviteTargetsEmpty?7:6,paddingBottom:k.device.isMobile||S?0:4},onEmptySubmit:()=>f(),dontShowBorderBottom:j.isAndroid,showBorder:S,...!S&&{style:{padding:"10px  9px 4px 9px"}},...S&&{style:{borderRadius:4,paddingTop:A.isInviteTargetsEmpty?3:0,paddingBottom:0,...v&&{background:"none"}}}})}},655784:(e,t,n)=>{n.d(t,{A:()=>c});n(581454);var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(959013),r=()=>n(496603),l=()=>n(418426),d=n(474848);const c=function(e){const{teamStore:t,from:c,onLeavingTeam:u,style:p,hoveredStyle:m,icon:g,isRed:f,placement:h,alignment:y,buttonInternals:v}=e,b=(0,i().v3)(),x=(0,s().O$)(n(351360).AppStoreCurrentSpaceStore),S=(0,l().$)(t),M=(0,o.useCallback)((async()=>{if(!x)return;await n(848237).JC({environment:b,teamStore:t,from:c,userGroupsInTeam:S})&&(null==u||u())}),[x,b,t,c,S,u]),A=(0,d.jsx)(a().sA,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),w=function(e){let{teamStore:t}=e;const n=(0,i().v3)(),o=n.currentUser.id,{isDefaultTeam:c}=(0,s().K8)((()=>({isDefaultTeam:t.isDefault()})),[t]),u=(0,l().$)(t),p=(0,s().K8)((()=>{if(!t.isReady())return!1;const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return Boolean(o&&t.isOwner(o)&&e.length+n.length===1)}),[t,o]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:n,userGroupsInTeam:o}=e;if(t)return(0,d.jsx)(a().sA,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You can’t leave this teamspace because everyone in the workspace must be a member"});if(n)return(0,d.jsx)(a().sA,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(o.length>0)return(0,d.jsx)(a().sA,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:r().oE(o.map((e=>e.name))).join()}})}({isDefaultTeam:c,isOnlyTeamOwner:p,userGroupsInTeam:u})}({teamStore:t}),k=Boolean(w),j=k?w:A;return(0,d.jsx)(n(859428).A,{style:k?{width:240}:void 0,disableTooltip:!Boolean(j),renderTooltip:e=>(0,d.jsx)("div",{...e,children:j}),textWrap:k,placement:h,alignment:y,render:e=>(0,d.jsx)(n(493823).p,{...e,style:p,hoveredStyle:m,onClick:M,disabled:k,disabledFeedback:k,icon:g,isRed:f,children:v||(0,d.jsxs)(d.Fragment,{children:[(0,n(831310).o)({width:12.5,marginRight:4}),(0,d.jsx)(a().sA,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},667193:(e,t,n)=>{n.d(t,{p:()=>a});var o=()=>n(484714),i=()=>n(847249),s=()=>n(186445);function a(){const e=(0,o().v3)();return(0,i().O$)((0,s().rp)(e))}},671089:(e,t,n)=>{n.r(t),n.d(t,{checkmarkCircleIcon:()=>s,iconDefinition:()=>i});n(296540);var o=n(474848);const i={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M12.876 7.982a.625.625 0 1 0-1.072-.644L9.25 11.595 7.815 9.92a.625.625 0 0 0-.95.813l2 2.334a.625.625 0 0 0 1.01-.085z"}),(0,o.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},s=(0,n(340498).wt)("checkmarkCircle",i)},673898:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{active:!1,stringValue:""}}}const i=new o},679927:(e,t,n)=>{n.d(t,{AW:()=>i,B4:()=>P,Cw:()=>I,I5:()=>B,ID:()=>M,NX:()=>_,To:()=>y,Vu:()=>x,W$:()=>s,aC:()=>A,cD:()=>a,cp:()=>k,h9:()=>h,hj:()=>T,hy:()=>u,kA:()=>b,oc:()=>S,od:()=>w,pE:()=>l,r$:()=>r,rQ:()=>o,v8:()=>j,vP:()=>c,wU:()=>d,wx:()=>v,xH:()=>R,x_:()=>C,zZ:()=>f});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);const o="1f88cc90-92fd-4ce4-bfcd-25daec2ffbbe",i="IAV2zMildmGp1lZPngkFh",s="6V12s4UJlm9noQgnSvQAjk",a="1O2WB1UvrTQbfDsTGxQ6Ma",r="3I1VaNJoooolyivK2uKBA4",l="6b69yOoPrR9uZthpDkC3jg",d="3LoiCE0pTNqOdhIMNSqzVH",c="4TYdu6oruQDsNGmrpr2w62",u="4jJ9utEAM6sBm9rlHrmmag",p="35MTwBQoiGEMS4LkotwdKs",m="awWt9RUdJ4iRwCG3zlI1A",g="5cOhPmF8ykG1Qltp3CGtQ9",f=new Set([d,c,u,p,m,g]),h="38rtLN5PXALY47cpMpWjsv",y="72AUvxIRJUiI0FUvJCNIfI",v="4Lsz5ZJQRzXjBOrKWTQuyF",b="1QQFEoxxG0eI8XYekBEh5T",x="5NWgBc6vf0InRsdBIJEdPl",S=280,M=5e3,A=50,w=60,k=256,j=16,C=5,I=3,T="templates@makenotion.com",_="integrations@makenotion.com",P=["notion","template"],B=["notion","n0ti0n","n0tion","notlion","noshion","notoin","notino"],R={ds:"",listing_or_creator_id:"",downloads_app_1d:0,downloads_app_7d:0,downloads_app_14d:0,downloads_app_28d:0,downloads_app_total:0,downloads_web_1d:0,downloads_web_7d:0,downloads_web_14d:0,downloads_web_28d:0,downloads_web_total:0,downloads_app_web_1d:0,downloads_app_web_7d:0,downloads_app_web_14d:0,downloads_app_web_28d:0,downloads_app_web_total:0,views_app_1d:0,views_app_7d:0,views_app_14d:0,views_app_28d:0,views_app_total:0,views_web_1d:0,views_web_7d:0,views_web_14d:0,views_web_28d:0,views_web_total:0,views_app_web_1d:0,views_app_web_7d:0,views_app_web_14d:0,views_app_web_28d:0,views_app_web_total:0}},681546:(e,t,n)=>{n.d(t,{i:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("arrowLeft",{viewBox:"0 0 30 30",svg:(0,o.jsx)("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},687039:(e,t,n)=>{n.d(t,{A:()=>r,V:()=>s});n(898992),n(430670);var o=n(296540),i=n(474848);const s={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function a(e){return e.src?(0,i.jsx)("img",{style:e.style,src:e.src}):null}const r=o.forwardRef((function(e,t){const s=(0,n(401497).DP)(),r=o.useRef(e);r.current=e,o.useEffect((()=>{const t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",document.body.appendChild(t);const n=window.Vimeo;if(!n)return()=>{};const o=document.getElementById(e.src),i=new n.Player(o);return i?(i.on("play",(e=>{var t,n;null===(t=(n=r.current).onPlay)||void 0===t||t.call(n,e)})),i.on("pause",(e=>{var t,n;null===(t=(n=r.current).onPause)||void 0===t||t.call(n,e)})),i.on("ended",(e=>{var t,n;null===(t=(n=r.current).onEnd)||void 0===t||t.call(n,e)})),()=>{i.off("play"),i.off("pause"),i.off("ended")}):()=>{}}),[e.src,r.current.src]);const l=function(e,t){const o=(0,n(534177).WP)(t).flatMap((e=>{let[t,n]=e;return`${t}=${n}`})).join("&");return`${e}&${o}`}(r.current.src,{texttrack:r.current.defaultTextTrack,playsinline:!1,...r.current.options}),d={position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,boxShadow:`0 1px 0 0 ${s.stroke.secondary}`};return(0,i.jsxs)(n(25500).A,{ratio:r.current.aspectRatioOverride??9/16,children:[(0,i.jsx)(a,{style:d,src:r.current.preloadThumbnailSrc}),(0,i.jsx)("iframe",{ref:t,id:r.current.src,className:r.current.className,allowFullScreen:!0,src:l,style:{...d,...r.current.style}})]})}))},687110:(e,t,n)=>{n.r(t),n.d(t,{PageAnalyticsPageOptOut:()=>v,TopbarPageAnalyticsOptOutMenu:()=>y,TopbarPageAnalyticsOptOutMenuStore:()=>h});n(296540);var o=()=>n(484714),i=()=>n(847249),s=()=>n(959013),a=()=>n(72234),r=()=>n(836251),l=()=>n(962730),d=()=>n(377586),c=()=>n(351360),u=()=>n(364280),p=()=>n(897119),m=()=>n(719147),g=()=>n(702723),f=n(474848);const h=n(757695).default.createValue({isOpen:!1,rect:void 0},{name:"TopbarPageAnalyticsOptOutMenuStore"});function y(){const e=(0,o().v3)(),t=(0,i().K8)((()=>h.state.isOpen),[]),n=(0,i().K8)((()=>h.state.rect),[]),a=(0,i().O$)(c().AppStoreMainEditorCurrentBlockStore);return a?(0,f.jsx)(p().Ay,{popupType:e.device.isMobile?d().n.SlideUp:d().n.Popup,alignmentToOrigin:l().C.Center,open:t,render:()=>(0,f.jsx)("div",{style:{minWidth:360,padding:16},children:(0,f.jsxs)(u().VP,{gap:16,children:[(0,f.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,f.jsx)(s().sA,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,f.jsx)(v,{store:a})]})}),originRect:n,onDismiss:()=>h.setState({isOpen:!1,rect:void 0})}):null}function v(e){const t=(0,o().v3)(),n=(0,i().K8)((()=>{const e=c().default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),l=(0,i().K8)((()=>{const t=null==n?void 0:n.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[n,e.store.id]);return(0,f.jsx)(g().A,{type:"dropdown",currentOption:l?"do_not_record":"record",options:[{key:"record",label:(0,f.jsx)(s().sA,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,f.jsx)(s().sA,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:n=>{"do_not_record"===n?a().Oy(t,e.store.id):a().F3(t,e.store.id)},isMobile:t.device.isMobile,title:(0,f.jsx)(s().sA,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,f.jsx)(s().sA,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,f.jsx)(m().A,{external:!0,href:(0,r().xS)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},696384:(e,t,n)=>{n.d(t,{V:()=>s,h:()=>i});var o=()=>n(91669);function i(){o().z.setState({isOpen:!0})}function s(){o().z.setState({isOpen:!1})}},698085:(e,t,n)=>{n.r(t),n.d(t,{ShareMenuContainer:()=>Xo});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(959013),l=()=>n(778417),d=()=>n(725614),c=()=>n(805751),u=()=>n(928600),p=()=>n(480095),m=()=>n(125565),g=()=>n(64901),f=()=>n(38337),h=()=>n(722872),y=()=>n(836251),v=()=>n(645873),b=()=>n(58293),x=()=>n(646736),S=()=>n(131448),M=()=>n(146842),A=()=>n(284371),w=()=>n(987017),k=()=>n(115512),j=()=>n(641212),C=()=>n(66510),I=()=>n(463830),T=n(474848);function _(e){const{store:t,calculatedPermissions:n,permissionItemArgs:o,onClose:l}=e,d=(0,i().Y0)(),g=(y=d.isMobile,(0,a().IS)((e=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:y?e.surface.page:void 0}})),[y]));var y;const v=(0,s().uB)(void 0,I().A),b=d.isMobile?{menuType:h().gu.Modal,disableHeaderShadow:!0,title:(0,T.jsx)(m().A,{isMobile:d.isMobile,style:g.title,children:(0,T.jsx)(r().sA,{defaultMessage:"Share",id:"loggedOutShareMenu.title"})}),topbarStyle:g.topbarStyle,right:(0,T.jsx)(p().DoneMenuText,{}),onClickRight:l,whiteBackground:!0}:{menuType:h().gu.Popup,maxHeight:"90vh"};return(0,T.jsx)(u().A,{...b,className:f().NXe,children:(0,T.jsx)(c().A,{debugName:"LoggedOutShareMenuContainer",capture:!0,allowEsc:!0,children:(0,T.jsx)(P,{store:t,isMobile:d.isMobile,calculatedPermissions:n,permissionItemArgs:o,buttonPopupStore:v})})})}function P(e){let{store:t,isMobile:n,calculatedPermissions:s,permissionItemArgs:c,buttonPopupStore:u}=e;const p=(0,i().v3)(),m=function(e){const t=(0,i().v3)();return(0,a().IS)((n=>({tabStyle:{color:n.text.tertiary,...e&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:A().Wy.medium},tabTitleStyle:{color:"inherit",fontSize:(0,k().ny)(t,"UIRegular"),fontWeight:A().Wy.medium},style:e?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingLeft:16},tabBorderStyle:{left:0,right:0}})),[t,e])}(n),g=[(0,T.jsx)(o.Fragment,{children:(0,T.jsx)(r().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title")];return(0,o.useEffect)((()=>{l().IU({preventDismissMobileKeyboard:!0,environment:p}),d().clear({preventDismissMobileKeyboard:!0,environment:p})}),[p]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(w().Ay,{...m,tabs:g,selectedIndex:0,onChange:()=>{}}),(0,T.jsx)(C().T5,{store:t,calculatedPermissions:s,permissionItemArgs:c}),(0,T.jsx)(j().A,{store:t,buttonPopupStore:u,calculatedPermissions:s,permissionItemArgs:c})]})}var B=()=>n(326589),R=()=>n(315841),L=()=>n(159026),D=()=>n(103674),O=()=>n(726360),N=()=>n(663590),E=()=>n(928074),U=()=>n(437487),F=()=>n(134696),V=()=>n(495867),K=()=>n(640653),H=()=>n(534177),z=()=>n(477093);async function W(e,t,n,o,i){if(i.state.inviteStage===L().d5.closed||i.state.inviteStage===L().d5.share_page)return;const{selection:s}=i.state;switch(s){case L().NJ.request_workspace_member:F().RH(e,{...V().nE(e,i),from:"share_menu"}),await V().xi({environment:e,spaceStore:t,originId:n.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:i,intl:o});break;case L().NJ.workspace_member:F()._u(e,V().nE(e,i));const a=i.state.invitedUsers.length>0;if(!t.isTeamsEnabled()&&a){i.setState({...i.state,inviteStage:L().d5.closed});if(!(await z().oH({environment:e,flowId:i.state.flowId??"",trackCreateTeamComplete:!1})))return}await V().Lg({environment:e,spaceStore:t,contextualInviteStore:i,from:"page_contextual_invite",intl:o});break;case L().NJ.page_guest:case L().NJ.unselected:case L().NJ.closed:F().l8(e,V().nE(e,i)),i.reset();break;default:(0,H().HB)(s)}}n(581454);var G=()=>n(575157),Y=()=>n(90907),q=()=>n(835607),$=()=>n(792071),Q=()=>n(798880),Z=()=>n(84817),X=()=>n(8980),J=()=>n(554509),ee=()=>n(864943),te=()=>n(581495),ne=()=>n(305837),oe=()=>n(453697);function ie(e){let{users:t}=e;const n=(0,a().IS)((e=>({avatarsContainer:{marginLeft:"16px",display:"flex"},avatarWrapper:{marginLeft:"-16px"},upgradeWrapper:{alignSelf:"end",marginLeft:"-14px",borderRadius:"50%",background:e.surface.wash},upgradeIcon:{height:16,width:16,fill:e.icon.uiBluePrimary}})),[]);return(0,T.jsxs)("div",{style:n.avatarsContainer,children:[t.slice(0,10).map(((e,t)=>(0,T.jsx)("div",{style:n.avatarWrapper,children:(0,T.jsx)(oe().A,{userValue:e,size:40})},t))),(0,T.jsx)("div",{style:n.upgradeWrapper,children:(0,ne().H)(n.upgradeIcon)})]})}function se(e){const{guestEmails:t,spaceStore:n,contextualInviteStore:o,blockStore:l,paysPerSeat:d}=e,c=(0,i().v3)(),u=(0,r().tz)(),p=(0,s().K8)((()=>o.state.inviteStage===L().d5.request_workspace),[o]),m=(0,s().K8)((()=>t.map((e=>{const t=o.state.invitedEmailToUserIdMap[e];return $().Bj6.fromValue(Q().oo,{id:t,email:e,version:1})}))),[o,t]),g=(0,a().IS)((e=>({cta:{flex:1},facepileContainer:{display:"flex",justifyContent:"center"}})),[]);return(0,T.jsxs)("div",{className:f().NXe,children:[(0,T.jsx)(te().Rz,{onClick:()=>o.reset()}),(0,T.jsxs)(Z().Y1,{padding:"24px 22px 18px 22px",gap:24,children:[(0,T.jsxs)(Z().Y1,{gap:20,children:[(0,T.jsx)("div",{style:g.facepileContainer,children:(0,T.jsx)(ie,{users:m})}),(0,T.jsxs)(Z().Y1,{gap:8,children:[(0,T.jsx)(J().D,{styleName:"Heading-17px/Semibold",children:(0,T.jsx)(r().sA,{id:"ContextualInvite.variantD.header",defaultMessage:"{inviteCount, plural, one {Upgrade guest to member?} other {Upgrade {inviteCount} guests to members?}}",values:{inviteCount:t.length}})}),(0,T.jsxs)(Z().Y1,{gap:20,children:[(0,T.jsx)(J().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:d?p?(0,T.jsx)(r().sA,{id:"ContextualInvite.variantD.description.request",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features.} one {{firstGuest} and 1 other will have access to these features.} other {{firstGuest} and {otherInviteCount} others will have access to these features.}} A workspace admin will review your request.",values:{firstGuest:t[0],otherInviteCount:t.length-1}}):(0,T.jsx)(r().sA,{id:"ContextualInvite.variantD.description",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}} and {totalInviteCount, plural, one {this workspace will be billed for 1 member} other {this workspace will be billed for {totalInviteCount} members}}",values:{firstGuest:t[0],totalInviteCount:t.length,otherInviteCount:t.length-1}}):(0,T.jsx)(r().sA,{id:"ContextualInvite.variantD.description.free",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}}",values:{firstGuest:t[0],otherInviteCount:t.length-1}})}),(0,T.jsxs)(Z().Y1,{gap:14,children:[(0,T.jsxs)(Z().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,T.jsx)(X().I,{icon:Y().lockIcon,color:"secondary"}),(0,T.jsx)(J().D,{styleName:"UIRegular-14px/Regular",children:(0,T.jsx)(r().sA,{id:"ContextualInvite.variantD.memberBenefits.private",defaultMessage:"Create private pages and drafts"})})]}),(0,T.jsxs)(Z().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,T.jsx)(X().I,{icon:G().docPlainTextIcon,color:"secondary"}),(0,T.jsx)(J().D,{styleName:"UIRegular-14px/Regular",children:(0,T.jsx)(r().sA,{id:"ContextualInvite.variantD.memberBenefits.public",defaultMessage:"Access all public pages in the workspace"})})]}),(0,T.jsxs)(Z().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,T.jsx)(X().I,{icon:q().peopleIcon,color:"secondary"}),(0,T.jsx)(J().D,{styleName:"UIRegular-14px/Regular",children:(0,T.jsx)(r().sA,{id:"ContextualInvite.variantD.memberBenefits.collaboration",defaultMessage:"Unlimited collaboration with others"})})]})]})]})]})]}),(0,T.jsxs)(Z().Y1,{direction:"horizontal",gap:10,children:[(0,T.jsx)(ee().A,{size:"lg",style:g.cta,onClick:async()=>{!function(e){e.setState({...e.state,selection:L().NJ.page_guest})}(o),await W(c,n,l,u,o)},children:(0,T.jsx)(r().sA,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"})}),(0,T.jsx)(ee().A,{size:"lg",style:g.cta,onClick:async()=>{o.state.inviteStage===L().d5.share_workspace&&function(e){e.setState({...e.state,selection:L().NJ.workspace_member})}(o),o.state.inviteStage===L().d5.request_workspace&&function(e){e.setState({...e.state,selection:L().NJ.request_workspace_member})}(o),await W(c,n,l,u,o)},children:p?(0,T.jsx)(r().sA,{id:"ContextualInvite.variantD.request",defaultMessage:"Request upgrade"}):(0,T.jsx)(r().sA,{id:"ContextualInvite.variantD.upgrade",defaultMessage:"Upgrade to member"})})]})]})]})}function ae(e){const{spaceStore:t,blockStore:o}=e,a=(0,i().v3)(),r=(0,n(714300).l)({spaceId:t.id}),l=(0,s().K8)((()=>(0,n(37433).shouldShowZeroTeamsExperience)(a,r)),[a,r]),d=(0,s().uB)(e.contextualInviteStore,L().Ay),c=n(762433).OK(r),u=(0,s().K8)((()=>d.getGuestEmails()),[d]),p=(0,s().K8)((()=>(0,K().hN)(t)),[t]);return(0,n(852507).l)((()=>{!function(e,t){t&&e.setState({...e.state,selection:L().NJ.page_guest})}(d,l),F().bT(a,V().nE(a,d))})),u.length?(0,T.jsx)(se,{contextualInviteStore:d,spaceStore:t,blockStore:o,useZeroTeamsExperience:l,paysPerSeat:c,guestEmails:u,useGuestInviteRequestExperience:p}):null}const re=o.memo(ae);var le=()=>n(340498);const de=(0,le().wt)("wifiSlash",{viewBox:"0 0 32 32",svg:(0,T.jsx)("path",{d:"M5.33984 5.32812L8.04688 8.04688C6.17969 8.8125 4.50781 9.97656 3.03125 11.5391C2.90625 11.6719 2.75781 11.7422 2.58594 11.75C2.42188 11.75 2.27734 11.6836 2.15234 11.5508L0.5 9.89844C0.390625 9.78125 0.332031 9.65625 0.324219 9.52344C0.324219 9.38281 0.371094 9.25391 0.464844 9.13672C1.08984 8.39453 1.8125 7.70312 2.63281 7.0625C3.46094 6.41406 4.36328 5.83594 5.33984 5.32812ZM13.6719 6.91016L10.3203 3.54688C10.9688 3.42187 11.5938 3.32812 12.1953 3.26562C12.8047 3.20313 13.4023 3.17188 13.9883 3.17188C15.8086 3.17188 17.5703 3.42969 19.2734 3.94531C20.9844 4.46094 22.5469 5.17188 23.9609 6.07812C25.375 6.97656 26.5625 7.99609 27.5234 9.13672C27.6172 9.25391 27.6641 9.38281 27.6641 9.52344C27.6641 9.65625 27.6016 9.78125 27.4766 9.89844L25.8359 11.5391C25.7109 11.6719 25.5664 11.7422 25.4023 11.75C25.2383 11.75 25.0977 11.6914 24.9805 11.5742C23.543 10.0898 21.9141 8.94531 20.0938 8.14062C18.2812 7.33594 16.2852 6.91016 14.1055 6.86328C14.0352 6.86328 13.9609 6.86719 13.8828 6.875C13.8125 6.88281 13.7422 6.89453 13.6719 6.91016ZM10.6016 10.5781L13.7773 13.7656C13.0273 13.7812 12.2969 13.9023 11.5859 14.1289C10.875 14.3555 10.207 14.6641 9.58203 15.0547C8.96484 15.4375 8.42188 15.8828 7.95312 16.3906C7.82031 16.5312 7.67188 16.6094 7.50781 16.625C7.34375 16.6328 7.19141 16.5703 7.05078 16.4375L5.21094 14.6328C5.10156 14.5234 5.03906 14.4023 5.02344 14.2695C5.01562 14.1367 5.0625 14.0117 5.16406 13.8945C5.78906 13.1602 6.56641 12.5039 7.49609 11.9258C8.43359 11.3398 9.46875 10.8906 10.6016 10.5781ZM22.0859 15.3242L17.3398 10.5781C18.4492 10.8594 19.4922 11.2969 20.4688 11.8906C21.4453 12.4844 22.2344 13.1523 22.8359 13.8945C22.9219 14.0117 22.9609 14.1367 22.9531 14.2695C22.9531 14.4023 22.8945 14.5234 22.7773 14.6328L22.0859 15.3242ZM14 16.9531C14.8281 16.9531 15.5898 17.1367 16.2852 17.5039C16.9805 17.8711 17.5312 18.3125 17.9375 18.8281C18.0312 18.9453 18.0703 19.0742 18.0547 19.2148C18.0391 19.3555 17.9766 19.4766 17.8672 19.5781L15.0078 22.3438C14.7734 22.5703 14.582 22.7227 14.4336 22.8008C14.293 22.8867 14.1484 22.9297 14 22.9297C13.8594 22.9297 13.7188 22.8867 13.5781 22.8008C13.4375 22.7227 13.2461 22.5703 13.0039 22.3438L10.1328 19.5781C10.0312 19.4844 9.96484 19.3789 9.93359 19.2617C9.91016 19.1367 9.93359 19.0234 10.0039 18.9219C10.4102 18.375 10.9688 17.9102 11.6797 17.5273C12.3906 17.1445 13.1641 16.9531 14 16.9531ZM23.8906 21.7812L4.09766 2C3.91797 1.82812 3.82812 1.60938 3.82812 1.34375C3.82812 1.07812 3.91797 0.855469 4.09766 0.675781C4.26953 0.496094 4.48828 0.410156 4.75391 0.417969C5.01953 0.417969 5.24219 0.507813 5.42188 0.6875L25.2031 20.4688C25.3906 20.6484 25.4844 20.8672 25.4844 21.125C25.4844 21.3828 25.3906 21.6016 25.2031 21.7812C25.0312 21.9609 24.8164 22.0508 24.5586 22.0508C24.3008 22.0508 24.0781 21.9609 23.8906 21.7812Z"})});var ce=()=>n(529183),ue=()=>n(749240),pe=()=>n(440339),me=()=>n(962277);function ge(e){const{store:t,mostPermissivePublicItem:n,permissionItemArgs:o}=e,{permissionItem:i}=n;return(0,s().K8)((()=>(0,me().W)(i)),[i])?(0,T.jsx)(R().d,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location,showManageAllDomains:!0,showAllPublishedSites:!0,shouldAskForConfirmationOnPublish:!1}):(0,T.jsx)(R().Js,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location})}n(898992),n(354520);var fe=()=>n(842599),he=()=>n(196131),ye=()=>n(411387),ve=()=>n(545805),be=()=>n(792223),xe=()=>n(366858),Se=()=>n(535279),Me=()=>n(108944),Ae=()=>n(963589),we=()=>n(970585),ke=()=>n(308227),je=()=>n(616092),Ce=()=>n(577437),Ie=()=>n(717162),Te=()=>n(623275),_e=()=>n(43013);var Pe=()=>n(343247),Be=()=>n(529601),Re=()=>n(622963),Le=()=>n(751735),De=()=>n(920773),Oe=()=>n(460292),Ne=()=>n(364499),Ee=()=>n(404141),Ue=()=>n(697959);function Fe(e){const{spaceId:t,userId:n,spaceModel:o,spaceUserModel:i,teamModel:l,domains:d,blockStore:c}=e,u=(0,r().tz)(),p=(0,Ce()._X)({name:"internal_guests",spaceId:t,userId:n,amount:1}),m=(0,Ne().o)({store:c}),g=(0,Ce().P9)({name:"non_admin_members",spaceId:t,userId:n}),f=(0,a().IS)((e=>{const t=p&&!(0,ye().e2)(p),n=t?20:5,o=t?e.accentColors.orange[100]:"transparent",i=t?e.accentColors.orange[400]:e.fill.uiBlue;return{container:{borderImage:`repeating-linear-gradient(-45deg, ${o}, ${o} ${n}px, ${i} ${n}px, ${i} ${2*n}px) 5 0`,borderWidth:"4px 0 0 0",borderStyle:"solid",background:t?(0,Le().X4)(e.accentColors.orange[400],.15):(0,Le().X4)(e.fill.uiBlue,.15),position:"relative",padding:10,zIndex:5},fill:{background:e.surface.elevated,border:`1px solid ${e.stroke.secondary}`},button:{height:"auto",width:"calc(100% + 16px)",padding:8,margin:-8}}}),[p]),h=(0,s().K8)((()=>{var e;const t=(0,Re()._y)((null===(e=ue().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)??"free");return Ue().qY[t].label}),[]),y=(0,s().K8)((()=>null==i?void 0:i.isWorkspaceOwner()),[i]),v=(0,s().K8)((()=>null==i?void 0:i.isMember()),[i]);let b;b=y?"You are a workspace owner":v?"You are a member":"You are a guest";const x=(0,s().K8)((()=>[{label:"Allow members to invite guests to pages",isEnabled:!!o&&o.getDisableGuests()},{label:"Allow members to request adding guests",isEnabled:(null==o?void 0:o.getSettings().enable_guest_invite_requests)??!1},{label:"Allow members to request adding other members",isEnabled:!(null!=o&&o.getSettings().disable_membership_requests)}]),[o]),S=(0,s().K8)((()=>[{label:"Disable guests",isEnabled:(null==l?void 0:l.getSettings().disable_guests)??!1}]),[l]),M=(0,s().K8)((()=>{if(!o||!d||!i)return;const{autojoinDomains:e}=(0,Be().SJ)({space:o,spaceUser:i,domains:d});return e}),[o,i,d]),A=(0,s().K8)((()=>{if(!o||!i)return;const{type:e}=(0,Be().yQ)({space:o,spaceUser:i,team:l,publicPageDataGuestSetting:m});switch(e){case"can_add":return"You can add guests.";case"can_request":return"You can request to add guests.";case"cannot_add":return"You can't add or request to add guests.";default:(0,H().HB)(e)}}),[o,i,l,m]),w=(0,s().K8)((()=>{if(!o||!d||!i)return;const{type:e}=(0,Be().SJ)({space:o,spaceUser:i,domains:d});switch(e){case"can_add":return"You can add members.";case"can_request":return"You can request to add members.";case"cannot_add":return"You can't add or request to add members.";default:(0,H().HB)(e)}}),[o,i,d]),k=(0,s().K8)((()=>{if(!o||!i||!d)return!1;return"can_add"===(0,Be().SJ)({space:o,spaceUser:i,domains:d}).type}),[o,i,d]),j=(0,s().K8)((()=>{if(!p)return;const e=p.type;switch(e){case"available":return"You can add an internal guest.";case"unavailable":return k?g?"Internal guests will be added to the space with member access.":"Internal guests will be added to the space with workspace owner access.":"You can't add internal guests.";default:(0,H().HB)(e)}}),[p,g,k]),C=(0,s().K8)((()=>{if(!p)return"Guest limit data is unavailable";if("cumulative"===p.limit.type){const{current:e,total:t}=p.limit;return"unlimited"===t?"No guest limit":`Space has ${e} of ${t} guests`}}),[p]),I=e=>{Ee().A.setState({open:!0,openedFrom:"misc",currentTab:e,defaultSubtab:void 0,highlightedSetting:void 0})};return(0,T.jsxs)(Z().Y1,{gap:10,style:f.container,children:[(0,T.jsxs)(Z().Y1,{gap:12,borderRadius:6,padding:10,style:f.fill,children:[(0,T.jsx)(De().p,{onClick:()=>I("security"),style:f.button,children:(0,T.jsxs)(Z().Y1,{gap:4,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:"Space security settings"}),x.map(((e,t)=>(0,T.jsxs)(Z().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,T.jsx)(Ve,{isEnabled:e.isEnabled}),(0,T.jsx)(J().D,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]})}),(0,T.jsxs)(Z().Y1,{gap:4,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:"Team security settings"}),S.map(((e,t)=>(0,T.jsxs)(Z().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,T.jsx)(Ve,{isEnabled:e.isEnabled}),(0,T.jsx)(J().D,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]}),(0,T.jsx)(De().p,{onClick:()=>I("billing"),style:f.button,children:(0,T.jsxs)(Z().Y1,{gap:4,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:"Subscription"}),(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:`${u.formatMessage(h)} plan`}),(0,T.jsx)(J().D,{colorName:"secondary",styleName:"UISmall-12px/Regular",children:C})]})}),(0,T.jsx)(De().p,{onClick:()=>I("settings"),style:f.button,children:(0,T.jsxs)(Z().Y1,{gap:4,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:"Allowed email domains"}),null==M?void 0:M.map((e=>(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:e},e))),0===(null==M?void 0:M.length)&&(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:"None"})]})})]}),(0,T.jsxs)(Z().Y1,{gap:4,borderRadius:6,padding:10,style:f.fill,children:[(0,T.jsx)(J().D,{styleName:"UISmall-12px/Medium",children:b}),(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:w}),(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:A}),(0,T.jsx)(J().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:j})]})]})}function Ve(e){const{isEnabled:t}=e,n=(0,a().IS)((e=>({circle:{width:10,height:10,borderRadius:"50%",border:`1px solid ${e.icon.quaternary}`}})),[]);return t?(0,T.jsx)(Oe().Q,{iconGroup:Pe().d,variantName:"mini",colorName:"secondary"}):(0,T.jsx)(Z().Y1,{width:14,height:14,align:"center",children:(0,T.jsx)("div",{style:n.circle})})}var Ke=()=>n(617871),He=()=>n(449506),ze=()=>n(2143),We=()=>n(47373),Ge=()=>n(232461),Ye=()=>n(756279),qe=()=>n(351360),$e=()=>n(508496),Qe=()=>n(53137),Ze=()=>n(321172),Xe=()=>n(456328),Je=()=>n(623580);function et(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,value:o,maxLength:i}=e,s=(0,a().IS)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.text.tertiary,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,T.jsx)("div",{style:s.container,children:(0,T.jsxs)("div",{style:s.warning,children:[t&&(0,T.jsx)(r().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:o.length,maxCharacters:i}}),t&&n&&" · ",n&&(0,T.jsx)(r().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}const tt=100;function nt(e){const{open:t,focus:n,value:o,maxLength:i,onFocus:s,onChange:l,onCancel:d}=e,c=(0,r().tz)(),u=o.length/i>=.8,p=(0,Xe().BS)(o),m=u||p,g=(0,a().IS)((e=>({container:{maxHeight:t?tt:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,T.jsxs)("div",{style:g.container,children:[m&&(0,T.jsx)(et,{value:o,maxLength:i,shouldShowLengthWarning:u,shouldShowLinkWarning:p}),(0,T.jsx)(Je().A,{textarea:!0,focusInitial:!1,format:Je().C.Transparent,placeholder:f,maxlength:i,focus:n,value:o,onFocus:s,onChange:l,inputStyle:g.input,onCancel:d})]})}var ot=()=>n(458232);n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(672577),n(803949),n(908872),n(737550);const it={viewBox:"0 0 16 16",svg:(0,T.jsx)("path",{d:"M4.288 3.663a.625.625 0 0 0-.625.625v6.109a.625.625 0 1 0 1.25 0v-4.6l6.368 6.368c.24.24.63.232.873-.01a.62.62 0 0 0 .01-.874L5.797 4.913h4.601a.625.625 0 1 0 0-1.25z"})},st=(0,le().wt)("arrowDiagonalUpLeftSmall",it);var at=()=>n(535845),rt=()=>n(438265),lt=()=>n(97835),dt=()=>n(889154),ct=()=>n(68263),ut=()=>n(179034),pt=()=>n(848538),mt=()=>n(854150),gt=()=>n(778078),ft=()=>n(980427),ht=()=>n(701763),yt=()=>n(542056),vt=()=>n(843189),bt=()=>n(760217),xt=()=>n(406699),St=()=>n(939740),Mt=()=>n(64e3),At=()=>n(897119),wt=()=>n(614505),kt=()=>n(16006),jt=()=>n(89924),Ct=()=>n(859428),It=()=>n(747788),Tt=()=>n(267155),_t=()=>n(887080);(0,le().xh)("abstract",{default:{loader:()=>n.e(40471).then(n.bind(n,324692))},darkMode:{loader:()=>n.e(40471).then(n.bind(n,90816))}}),(0,le().xh)("adobeXd",{default:{loader:()=>n.e(79254).then(n.bind(n,735385))},darkMode:{loader:()=>n.e(79254).then(n.bind(n,214991))}}),(0,le().xh)("airtable",{default:{loader:()=>n.e(73865).then(n.bind(n,201350))},darkMode:{loader:()=>n.e(73865).then(n.bind(n,816142))}}),(0,le().xh)("amplitude",{default:{loader:()=>n.e(36448).then(n.bind(n,683631))},darkMode:{loader:()=>n.e(36448).then(n.bind(n,130049))}}),(0,le().xh)("apple",{default:{loader:()=>n.e(5815).then(n.bind(n,834258))},darkMode:{loader:()=>n.e(5815).then(n.bind(n,425722))}}),(0,le().xh)("asana",{default:{loader:()=>n.e(44225).then(n.bind(n,686452))},darkMode:{loader:()=>n.e(44225).then(n.bind(n,139808))}}),(0,le().xh)("basecamp",{default:{loader:()=>n.e(67601).then(n.bind(n,229574))},darkMode:{loader:()=>n.e(67601).then(n.bind(n,976782))}}),(0,le().xh)("box",{default:{loader:()=>n.e(88472).then(n.bind(n,180187))},darkMode:{loader:()=>n.e(88472).then(n.bind(n,695661))}}),(0,le().xh)("calendar",{default:{loader:()=>n.e(80319).then(n.bind(n,707648))},darkMode:{loader:()=>n.e(80319).then(n.bind(n,476364))}});(0,le().xh)("clickUp",{default:{loader:()=>n.e(52084).then(n.bind(n,676243))},darkMode:{loader:()=>n.e(52084).then(n.bind(n,992757))}}),(0,le().xh)("coda",{default:{loader:()=>n.e(59430).then(n.bind(n,216703))},darkMode:{loader:()=>n.e(59430).then(n.bind(n,266129))}}),(0,le().xh)("codepen",{default:{loader:()=>n.e(32179).then(n.bind(n,732198))},darkMode:{loader:()=>n.e(32179).then(n.bind(n,77870))}}),(0,le().xh)("confluence",{default:{loader:()=>n.e(16999).then(n.bind(n,658212))},darkMode:{loader:()=>n.e(16999).then(n.bind(n,7952))}}),(0,le().xh)("deepnote",{default:{loader:()=>n.e(2147).then(n.bind(n,46192))},darkMode:{loader:()=>n.e(2147).then(n.bind(n,849404))}}),(0,le().xh)("docs",{default:{loader:()=>n.e(88240).then(n.bind(n,26097))},darkMode:{loader:()=>n.e(88240).then(n.bind(n,360727))}}),(0,le().xh)("dropbox",{default:{loader:()=>n.e(30737).then(n.bind(n,374436))},darkMode:{loader:()=>n.e(30737).then(n.bind(n,983440))}}),(0,le().xh)("evernote",{default:{loader:()=>n.e(89253).then(n.bind(n,943322))},darkMode:{loader:()=>n.e(89253).then(n.bind(n,103954))}}),(0,le().xh)("excalidraw",{default:{loader:()=>n.e(23873).then(n.bind(n,651374))},darkMode:{loader:()=>n.e(23873).then(n.bind(n,742758))}}),(0,le().xh)("figma",{default:{loader:()=>n.e(44539).then(n.bind(n,158894))},darkMode:{loader:()=>n.e(44539).then(n.bind(n,56358))}}),(0,le().xh)("framer",{default:{loader:()=>n.e(87102).then(n.bind(n,214039))},darkMode:{loader:()=>n.e(87102).then(n.bind(n,447577))}});(0,le().xh)("gitLab",{default:{loader:()=>n.e(70916).then(n.bind(n,178469))},darkMode:{loader:()=>n.e(70916).then(n.bind(n,985627))}});(0,le().xh)("googleCalendar",{default:{loader:()=>n.e(17546).then(n.bind(n,721983))},darkMode:{loader:()=>n.e(17546).then(n.bind(n,169425))}});var Pt=()=>n(187859);(0,le().xh)("grid",{default:{loader:()=>n.e(21697).then(n.bind(n,866894))},darkMode:{loader:()=>n.e(21697).then(n.bind(n,155142))}}),(0,le().xh)("hex",{default:{loader:()=>n.e(20512).then(n.bind(n,599927))},darkMode:{loader:()=>n.e(20512).then(n.bind(n,216953))}}),(0,le().xh)("hubSpot",{default:{loader:()=>n.e(21914).then(n.bind(n,757381))},darkMode:{loader:()=>n.e(21914).then(n.bind(n,533499))}}),(0,le().xh)("instagram",{default:{loader:()=>n.e(77355).then(n.bind(n,749910))},darkMode:{loader:()=>n.e(77355).then(n.bind(n,117470))}}),(0,le().xh)("inVision",{default:{loader:()=>n.e(35364).then(n.bind(n,515285))},darkMode:{loader:()=>n.e(35364).then(n.bind(n,482763))}});(0,le().xh)("linkedin",{default:{loader:()=>n.e(58319).then(n.bind(n,960860))},darkMode:{loader:()=>n.e(58319).then(n.bind(n,202680))}}),(0,le().xh)("loom",{default:{loader:()=>n.e(68642).then(n.bind(n,464083))},darkMode:{loader:()=>n.e(68642).then(n.bind(n,910005))}}),(0,le().xh)("lucidchart",{default:{loader:()=>n.e(30512).then(n.bind(n,355893))},darkMode:{loader:()=>n.e(30512).then(n.bind(n,705835))}}),(0,le().xh)("lucidspark",{default:{loader:()=>n.e(7391).then(n.bind(n,243208))},darkMode:{loader:()=>n.e(7391).then(n.bind(n,653636))}}),(0,le().xh)("make",{default:{loader:()=>n.e(14079).then(n.bind(n,560996))},darkMode:{loader:()=>n.e(14079).then(n.bind(n,924816))}}),(0,le().xh)("maps",{default:{loader:()=>n.e(78724).then(n.bind(n,799017))},darkMode:{loader:()=>n.e(78724).then(n.bind(n,191967))}}),(0,le().xh)("miro",{default:{loader:()=>n.e(6122).then(n.bind(n,620507))},darkMode:{loader:()=>n.e(6122).then(n.bind(n,296173))}}),(0,le().xh)("mixpanel",{default:{loader:()=>n.e(41837).then(n.bind(n,191726))},darkMode:{loader:()=>n.e(41837).then(n.bind(n,282662))}}),(0,le().xh)("monday",{default:{loader:()=>n.e(98713).then(n.bind(n,357926))},darkMode:{loader:()=>n.e(98713).then(n.bind(n,947758))}});(0,le().xh)("office365",{default:{loader:()=>n.e(59287).then(n.bind(n,849050))},darkMode:{loader:()=>n.e(59287).then(n.bind(n,450770))}}),(0,le().xh)("oneDrive",{default:{loader:()=>n.e(77957).then(n.bind(n,582162))},darkMode:{loader:()=>n.e(77957).then(n.bind(n,952634))}}),(0,le().xh)("oneNote",{default:{loader:()=>n.e(54871).then(n.bind(n,813946))},darkMode:{loader:()=>n.e(54871).then(n.bind(n,534450))}});(0,le().xh)("pagerDuty",{default:{loader:()=>n.e(19314).then(n.bind(n,173737))},darkMode:{loader:()=>n.e(19314).then(n.bind(n,71455))}}),(0,le().xh)("pitch",{default:{loader:()=>n.e(39689).then(n.bind(n,574892))},darkMode:{loader:()=>n.e(39689).then(n.bind(n,61e3))}}),(0,le().xh)("polymer",{default:{loader:()=>n.e(38949).then(n.bind(n,907596))},darkMode:{loader:()=>n.e(38949).then(n.bind(n,370728))}}),(0,le().xh)("quip",{default:{loader:()=>n.e(61492).then(n.bind(n,592353))},darkMode:{loader:()=>n.e(61492).then(n.bind(n,266183))}}),(0,le().xh)("replit",{default:{loader:()=>n.e(49229).then(n.bind(n,394666))},darkMode:{loader:()=>n.e(49229).then(n.bind(n,800098))}});(0,le().xh)("sketch",{default:{loader:()=>n.e(64557).then(n.bind(n,118038))},darkMode:{loader:()=>n.e(64557).then(n.bind(n,461086))}});var Bt=()=>n(703888);(0,le().xh)("smartSheet",{default:{loader:()=>n.e(87153).then(n.bind(n,800230))},darkMode:{loader:()=>n.e(87153).then(n.bind(n,198574))}});(0,le().xh)("tiktok",{default:{loader:()=>n.e(80931).then(n.bind(n,605820))},darkMode:{loader:()=>n.e(80931).then(n.bind(n,832728))}}),(0,le().xh)("trello",{default:{loader:()=>n.e(9555).then(n.bind(n,590852))},darkMode:{loader:()=>n.e(9555).then(n.bind(n,259056))}}),(0,le().xh)("twitter",{default:{loader:()=>n.e(53974).then(n.bind(n,361881))},darkMode:{loader:()=>n.e(53974).then(n.bind(n,572175))}}),(0,le().xh)("typeform",{default:{loader:()=>n.e(61487).then(n.bind(n,528312))},darkMode:{loader:()=>n.e(61487).then(n.bind(n,780404))}}),(0,le().xh)("whimsical",{default:{loader:()=>n.e(43862).then(n.bind(n,164241))},darkMode:{loader:()=>n.e(43862).then(n.bind(n,902308))}}),(0,le().xh)("word",{default:{loader:()=>n.e(72001).then(n.bind(n,657442))},darkMode:{loader:()=>n.e(72001).then(n.bind(n,619786))}}),(0,le().xh)("workflowy",{default:{loader:()=>n.e(15135).then(n.bind(n,948458))},darkMode:{loader:()=>n.e(15135).then(n.bind(n,565090))}}),(0,le().xh)("youTube",{default:{loader:()=>n.e(55724).then(n.bind(n,720931))},darkMode:{loader:()=>n.e(55724).then(n.bind(n,901509))}}),(0,le().xh)("zapier",{default:{loader:()=>n.e(70074).then(n.bind(n,255811))},darkMode:{loader:()=>n.e(70074).then(n.bind(n,376037))}}),(0,le().xh)("zendesk",{default:{loader:()=>n.e(11235).then(n.bind(n,295434))},darkMode:{loader:()=>n.e(11235).then(n.bind(n,373826))}}),(0,le().xh)("zoom",{default:{loader:()=>n.e(9832).then(n.bind(n,444901))},darkMode:{loader:()=>n.e(9832).then(n.bind(n,360923))}}),(0,le().xh)("salesforce",{default:{loader:()=>n.e(81764).then(n.bind(n,769145))},darkMode:{loader:()=>n.e(81764).then(n.bind(n,781167))}});var Rt=()=>n(553965),Lt=()=>n(743260),Dt=()=>n(423657),Ot=()=>n(183804),Nt=()=>n(787766),Et=()=>n(423817),Ut=()=>n(962730),Ft=()=>n(21735),Vt=()=>n(630116),Kt=()=>n(715392),Ht=()=>n(134217),zt=()=>n(10984),Wt=()=>n(98866),Gt=()=>n(72388),Yt=()=>n(804800),qt=()=>n(913348),$t=()=>n(328403),Qt=()=>n(264154),Zt=()=>n(493823),Xt=()=>n(377586);function Jt(e){const{emailMessage:t,inviteTargetsStore:n,flowId:o,googleContacts:s=[],slackContacts:l=[]}=e,d=(0,i().v3)(),c=(0,a().IS)((e=>({importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:4,color:e.text.secondary,borderRadius:"6px"},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.text.primary},icon:{color:e.icon.tertiary}})),[]),u=(0,Nt().Hc)(),p=(0,Ae().X)("disconnect_contact_import"),m=s.length>0||l.length>0,g=(0,Ot().C)({onClickAuthenticated:e=>{p?Yt().L.setState({open:!0,type:e}):(U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:t}),n.setState({...n.state,tokenQuery:""}))},hideChevronIcon:!0,containerStyle:u.importListButtonContainer,buttonStyle:u.importListButton,flowId:o});return(0,T.jsx)(xt().Ay,{popupType:Xt().n.Popup,alignmentToOrigin:xt().yP.Center,placementToOrigin:xt().sx.Bottom,render:()=>(0,T.jsx)(_t().A,{importListItems:g}),originGap:12,renderOrigin:e=>(0,T.jsxs)(Zt().p,{style:{...c.importContactsButton},onClick:()=>{e.onClick(),ft().V(d,{source:"share_menu_inline_dropdown"})},children:[m?(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.numContacts",defaultMessage:"{numContacts} contacts",values:{numContacts:s.length+l.length}}):(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.noContacts",defaultMessage:"None"}),(0,T.jsx)(Oe().Q,{iconGroup:Qt().l,variantName:"fillSmall",style:c.icon})]})})}var en=()=>n(12193);function tn(e){const{publicPermission:t}=e,n=(0,a().IS)((e=>({banner:{...(0,Te().kJ)({theme:e,inheritanceBannerEnabled:!1}),display:"flex",flexDirection:"row",alignItems:"center",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:14,lineHeight:"20px",color:e.text.secondary,flex:"1 0 0",paddingLeft:4},iconContainer:{height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},manageButton:{color:e.text.uiBluePrimary,fontWeight:A().Wy.medium}})),[]),o=t.permissionItem.role;if(!ct().Tt(o))return null;const i=(0,ct().W8)(t.permissionItem);return(0,T.jsxs)("div",{style:n.banner,children:[(0,T.jsxs)("div",{style:n.content,children:[(0,T.jsx)("div",{style:n.iconContainer,children:(0,T.jsx)(X().I,{icon:en().globeIcon,color:"secondary"})}),(0,T.jsx)(m().A,{style:n.label,isMultiline:!0,children:(0,T.jsx)(nn,{role:o,hasSitePublicPermission:i})})]}),(0,T.jsx)(Zt().p,{size:"sm",style:n.manageButton,onClick:()=>{i?U().Ay.setState({...U().Ay.state,display:U().pP.Publish,tab:U().QC.Publish}):U().Ay.setState({...U().Ay.state,display:U().pP.MainShareMenu,tab:U().QC.Share,source:U().mc.PublicPermissionLevelBanner})},children:(0,T.jsx)(r().sA,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Settings"})})]})}function nn(e){const{role:t,hasSitePublicPermission:n}=e;switch(t){case"read_and_write":return(0,T.jsx)(r().sA,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,T.jsx)(r().sA,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return n?(0,T.jsx)(r().sA,{id:"shareMenu.publicPermissionBanner.canReadSite",defaultMessage:"This site can be viewed by anyone on the web"}):(0,T.jsx)(r().sA,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,H().HB)(t)}}var on=()=>n(623742),sn=()=>n(814429),an=()=>n(198463),rn=()=>n(851727),ln=()=>n(304243),dn=()=>n(560653),cn=()=>n(99162);function un(e){var t,n;const{store:o,shouldShowSlackOnly:l,shouldShowGoogleOnly:d,calculatedPermissions:c,permissionItemArgs:u,tokenQuery:p,showShimmer:g,error:f,ready:h,result:y}=e,v=(0,i().v3)(),b=(0,s().uB)(e.inviteTargetsStore,ce().Ay),x=(0,s().K8)((()=>U().Ay.state.display===U().pP.Invite&&U().Ay.state.focus&&"message"===U().Ay.state.focus),[]),S=(0,s().uB)(e.menuListStore,we().A),M=(0,Wt().x)(),A=(0,s().K8)((()=>We().YA()),[]),w=(0,s().K8)((()=>(0,N().FI)()),[]),k=(0,a().IS)((e=>({googleSlackIcons:{position:"relative",width:32,height:32},icons:{width:20,height:20,borderRadius:"50%",padding:2,border:`1px solid ${e.stroke.secondary}`,backgroundColor:e.accentColors.gray[0],position:"absolute"},sectionMenuItem:{display:"flex",flexDirection:"column",paddingTop:0,paddingLeft:8,paddingRight:8,paddingBottom:8},keepTypingMessage:{paddingLeft:Te().rL,paddingRight:Te().rL,marginTop:6,marginBottom:8,fontWeight:500},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.text.secondary,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:40,marginBottom:40},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:36,width:36,marginBottom:12,fill:e.mediumIconColor},arrowUpLeftIcon:{width:le().Ev.sm,height:le().Ev.sm,marginTop:2,color:e.icon.tertiary}})),[]),j=(0,s().K8)((()=>o.getSpaceId()),[o]),C=(0,Gt().V)(j,(null==y?void 0:y.inviteUsers.map((e=>e.value.id)).filter((e=>void 0!==e)))??[]),I=c.pagePermissionUIModel,{inPageTargets:_,notInPageTargets:P,filteredImportedContacts:B}=(0,s().K8)((()=>{const{inviteUsers:e,inviteGroups:t,importedContacts:n=[]}=y??{inviteUsers:[],inviteGroups:[],importedContacts:[]},i=[...e,...t],s=[],a=[],r=new Set;i.forEach((e=>{"group"!==e.type&&r.add(e.value.email.toLowerCase());const t=Boolean(Lt().wF({store:o,target:e}));if("existingUser"===e.type&&!Boolean(e.spaceRole)){let t;if(Ft().A.state.shouldUseEdgeCache){var n;const i=null===(n=Kt().W.getData(v,{userId:e.value.id,spaceId:o.getSpaceId()}))||void 0===n?void 0:n.membership_type;t=i?(0,pt().$N)(i):void 0}else{var i;t=null===(i=M.get(e.value.id))||void 0===i?void 0:i.role}e.spaceRole=t||"not_in_space"}const l=(0,E().NV)({inviteTarget:e,store:o,calculatedPermissions:c,isRedesignEnabled:w,userToGroupMap:C});void 0!==l&&(t||ct().Tt(l.permissionItem.role??"none"))&&"newUser"!==e.type?l&&s.push({inviteTarget:e,...l}):"newUser"!==e.type&&a.push(e)}));const l=n.filter((e=>!r.has(e.value.email.toLowerCase())));return{inPageTargets:s,notInPageTargets:a,filteredImportedContacts:l}}),[y,o,c,C,w,v,M]),{isValidEmail:R,isEmailInTargets:L}=(0,s().K8)((()=>{const e=(0,fe().qh)(p);return{isValidEmail:(0,fe().DT)(e),isEmailInTargets:[..._.map((e=>{let{inviteTarget:t}=e;return t})),...P].some((t=>"group"!==t.type&&t.value.email===e))}}),[p,_,P]),D=(0,s().K8)((()=>b.state.inviteTargets.length>0),[b]),O=(0,Ge().J)(),F=(0,s().K8)((()=>!(!O||l||d)&&"empty_state"===$e().default.getEligibleGroup({experimentId:"sharing_import_contacts_share_menu",parameter:"variant",defaultGroup:"control"})),[O,l,d]),V=R&&!L,K=c.showRestrictedPermissionBanner,z=!l&&!d&&P.length>0&&(0===p.length||0===(null==y?void 0:y.tokenQuery.length)),W=!l&&!d&&p.length>0&&Boolean(null==y||null===(t=y.tokenQuery)||void 0===t?void 0:t.length)&&_.length>0,G=!l&&!d&&P.length>0&&p.length>0&&Boolean(null==y||null===(n=y.tokenQuery)||void 0===n?void 0:n.length),Y=B.filter((e=>"slack"===e.source)),q=B.filter((e=>"google"===e.source)),$=A&&Y.length>0&&!F,Z=q.length>0&&!F,X=F&&(Y.length>0||q.length>0),J={key:"imported slack contacts",render:e=>(0,T.jsx)(jt().A,{...e,style:k.sectionMenuItem,title:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.importedSlackContactsSection.title",defaultMessage:"From Slack"}),loading:!h}),items:pn({filteredContacts:Y,isRedesignEnabled:w,environment:v,inviteTargetsStore:b,blockStore:o,spaceVisibleUserMap:M,tokenQuery:p,menuListStore:S})},ee={key:"imported google contacts",render:e=>(0,T.jsx)(jt().A,{...e,style:k.sectionMenuItem,title:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.importedGoogleContactsSection.title",defaultMessage:"From Google"}),loading:!h}),items:pn({filteredContacts:q,isRedesignEnabled:w,environment:v,inviteTargetsStore:b,blockStore:o,spaceVisibleUserMap:M,tokenQuery:p,menuListStore:S})},te={key:"mixed contacts",render:e=>(0,T.jsx)(jt().A,{...e,style:k.sectionMenuItem,loading:!h}),items:pn({filteredContacts:[...q,...Y].sort(((e,t)=>(e.value.name??"").localeCompare(t.value.name??""))),isRedesignEnabled:w,environment:v,inviteTargetsStore:b,blockStore:o,spaceVisibleUserMap:M,tokenQuery:p,menuListStore:S})},ne=V||!z&&!W&&!G&&!$&&!Z&&!l&&!d&&p.length>0,oe=(0,s().K8)((()=>{const e=ue().subscriptionDataStoreInstance.state,{currentSpaceStore:t}=qe().default.state;return t&&e?Ht().Ye(e).map((n=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(n.userId)){const e=Vt().LU.createChildStore(t,{table:Q().oo,id:n.userId}).getEmail();return e&&(0,fe().zN)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]),ie=(0,Dt().A)(o);if(f)return(0,T.jsx)(Tt().z,{loading:!h,children:(0,T.jsx)(Mt().A,{title:(0,T.jsx)(r().sA,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!h&&g)return(0,T.jsx)(Et().J,{areaHeight:window.innerHeight});const se={key:"user results",render:e=>(0,T.jsx)(jt().A,{...e,style:k.sectionMenuItem,loading:!h,title:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:wn({tokenQuery:p,possibleDomains:oe,shouldShowAutoFillEmail:ne,isGuestInviteRequestRequired:ie.isGuestRequestRequired,environment:v,inviteTargetsStore:b,menuListStore:S,styles:k})},ae={key:"import contacts",render:e=>(0,T.jsx)(jt().A,{...e,style:k.sectionMenuItem,loading:!h}),items:[{key:"import contacts",render:()=>(0,T.jsx)(bt().A,{focused:!1,style:{cursor:"default"},caption:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.importContacts.caption",defaultMessage:"Add contacts from Google, Slack"}),icon:(0,T.jsxs)("div",{style:k.googleSlackIcons,children:[(0,T.jsx)(Oe().Q,{iconGroup:Pt().m,variantName:"default",style:{...k.icons,top:0,left:0}}),(0,T.jsx)(Oe().Q,{iconGroup:Bt().j,variantName:"default",style:{...k.icons,bottom:0,right:0}})]}),right:(0,T.jsx)(Jt,{emailMessage:e.emailMessage??"",inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId,googleContacts:q,slackContacts:Y}),title:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.importContacts.title",defaultMessage:"Import contacts"})}),action:()=>{}}]},re={key:"suggested",render:e=>(0,T.jsx)(jt().A,{...e,style:k.sectionMenuItem,title:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!h}),items:P.map(((e,t)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>{const n=Se().P4({target:e,inviteTargetsStore:b});return(0,T.jsx)(sn().A,{...t,isRedesignEnabled:w,isMobile:v.device.isMobile,disabled:!1,inviteTarget:e,isInvited:n,spaceVisibleUserMap:M,store:o})},action:()=>gn({inviteTarget:e,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:p,environment:v,type:"suggested"})})))},de={key:"in page",render:e=>(0,T.jsx)(jt().A,{...e,style:k.sectionMenuItem,title:w?(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.inPageSection.titleRedesign",defaultMessage:"Already invited"}):(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!h}),items:_.map(((e,t)=>{const{inviteTarget:n,permissionItem:i,mostPermissivePermissions:s}=e,{type:a}=n;if("existingUser"===a){if(!!s&&s.length>1)return{key:n.value.id,render:e=>(0,T.jsx)(yn,{...e,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:s,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:K}),action:()=>{}};{const e=I.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===n.value.id));return e?{key:n.value.id,render:s=>w?(0,T.jsx)(yn,{...s,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:K}):(0,T.jsx)(bt().A,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,T.jsx)($t().A,{store:o,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:M,permissionItemArgs:u})}),action:()=>{}}:{key:n.value.id,render:e=>(0,T.jsx)(yn,{...e,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:K}),action:()=>gn({inviteTarget:n,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:p,environment:v,type:"in_page"})}}}if("group"===a){if(!!s&&s.length>1)return{key:n.value.id,render:s=>(0,T.jsx)(yn,{...s,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:K}),action:()=>{}};{const e=I.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===n.value.group_id));return e?{key:n.value.id,render:t=>(0,T.jsx)(bt().A,{...t,itemMarginLeft:0,itemMarginRight:0,title:(0,T.jsx)(qt().A,{store:o,groupPermission:e,spaceId:o.getSpaceId(),showInherited:!0,permissionItemArgs:u})}),action:()=>{}}:{key:n.value.id,render:e=>(0,T.jsx)(yn,{...e,isRedesignEnabled:w,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:K}),action:()=>gn({inviteTarget:n,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:p,environment:v,type:"in_page"})}}}(0,H().HB)(a)}))},pe={key:"not in page",render:e=>(0,T.jsx)(jt().A,{...e,style:k.sectionMenuItem,title:p.length>0&&(w?(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.notInPageSection.titleRedesign",defaultMessage:"Not invited to page"}):(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"})),loading:!h}),items:P.map(((e,t)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>(0,T.jsx)(sn().A,{...t,disabled:!1,isRedesignEnabled:w,isMobile:v.device.isMobile,inviteTarget:e,isInvited:Se().P4({target:e,inviteTargetsStore:b}),spaceVisibleUserMap:M,store:o}),action:()=>gn({inviteTarget:e,inviteTargetsStore:b,menuListStore:S,rank:t,tokenQuery:p,environment:v,type:"not_in_page"})})))};let me=[];if(V&&me.push(se),z&&me.push(re),W&&me.push(de),G&&me.push(pe),$&&me.push(J),Z&&me.push(ee),X&&me.push(te),l&&(me=[J],0===J.items.length))return(0,T.jsx)(xn,{styles:k,importContactType:"slack"});if(d&&(me=[ee],0===ee.items.length))return(0,T.jsx)(xn,{styles:k,importContactType:"google"});if(0===me.length){if(me=[se],0===p.length&&!D)return F?(0,T.jsx)(Mn,{emailMessage:e.emailMessage,inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId}):(0,T.jsx)(Sn,{styles:k});if(0===p.length&&D)return(0,T.jsx)("div",{style:k.keepTypingMessage,children:(0,T.jsx)(m().A,{isSecondaryColor:!0,isSmall:!0,children:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})})})}else F&&me.unshift(ae);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(tn,{publicPermission:c.mostPermissivePublicItem}),(0,T.jsx)(St().Ay,{type:St().Oh.Vertical,initialFocus:p.length>0?0:void 0,sections:me,store:S,disableKeyboard:x})]})}function pn(e){const{filteredContacts:t,isRedesignEnabled:n,environment:o,inviteTargetsStore:i,blockStore:s,spaceVisibleUserMap:a,tokenQuery:r,menuListStore:l}=e;return t.map(((e,t)=>({key:e.value.email,render:t=>(0,T.jsx)(sn().A,{...t,isRedesignEnabled:n,isMobile:o.device.isMobile,disabled:!1,inviteTarget:e,isInvited:Se().P4({target:e,inviteTargetsStore:i}),spaceVisibleUserMap:a,store:s}),action:()=>{Se().P4({target:e,inviteTargetsStore:i})?i.setState({...i.state,inviteTargets:i.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(F().kH(o,{invite_token_query:r,selected_user_token:e,selected_user_token_rank:t,from:"share_modal_invite",subscription_tier:(0,zt().AI)(),type:mn(e)}),i.setState({inviteTargets:[...i.state.inviteTargets,e],tokenQuery:""}),l.unsetFocus())}})))}function mn(e){return"google"===e.source?"google_contacts":"slack"===e.source?"slack":void(0,H().HB)(e.source)}function gn(e){const{inviteTarget:t,inviteTargetsStore:n,menuListStore:o,rank:i,tokenQuery:s,environment:a,type:r}=e;Se().lW({inviteTargetsStore:n,inviteTarget:t})&&F().kH(a,{invite_token_query:s,selected_user_token:t,selected_user_token_rank:i,from:"share_modal_invite",subscription_tier:(0,zt().AI)(),type:r}),o.unsetFocus()}const fn=o.forwardRef((function(e,t){const{blockStore:r,inviteTarget:l,permissionItem:d,mostPermissivePermissions:c,permissionItemArgs:u,isRedesignEnabled:p}=e,m=(0,i().v3)(),[g,f]=(0,o.useState)(!1),h=(0,s().K8)((()=>r.getSpaceId()),[r]),y=(0,s().K8)((()=>c&&c.length>0),[c]),v=(0,o.useCallback)((()=>{if(y){const e=!1===g;f(!g),e&&ht().lD(m,{share_menu_session_id:U().Ay.state.sessionId,type:"group",group_id:l.value.group_id})}}),[m,y,g,f,l]),b=(0,a().IS)((e=>({buttonMenuItem:(0,Te().sH)({isRedesignEnabled:p,isMobile:m.device.isMobile}),permissionRoleButton:{marginRight:-6,color:e.text.secondary,fontSize:12},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[m.device.isMobile,p]);return(0,T.jsx)(Ct().A,{delayThreshold:0,placement:Ut().W.Left,textWrap:!0,style:b.tooltip,renderTooltip:()=>(0,T.jsx)(vn,{blockStore:r,blockPermissionItem:d}),render:o=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{...o,children:(0,T.jsx)(bt().A,{...e,buttonStyle:b.buttonMenuItem,...(0,Rt().A)(e,{onClick:v}),ref:t,title:(0,T.jsx)(n(779496).A,{inviteTarget:l,isRedesignEnabled:p,isMobile:m.device.isMobile,captionOverride:y&&g?(0,T.jsx)(bn,{}):void 0}),right:(0,T.jsx)(It().Y,{type:d.type,table:ut().ev,disabled:!0,icon:y?g?at().B:rt().d:void 0,role:d.role??"none",isCurrentUser:!1,buttonStyle:b.permissionRoleButton})})}),y&&g&&(0,T.jsx)("div",{style:b.expandablePermissionList,children:null==c?void 0:c.map(((t,n)=>{const o=t.permissionItem.type;let i=null;switch(o){case"space_permission":i=(0,T.jsx)(rn().A,{store:r,spacePermission:t,showTrustedDomainPermission:!1,trustedDomainPermission:void 0,publicPermission:void 0,showPublicShareLinkPermission:!1,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission",isRestricted:e.isRestricted});break;case"explicit_team_permission":i=(0,T.jsx)(dn().A,{store:r,blockTeamPermission:t,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,T.jsx)(qt().A,{spaceId:h,store:r,groupPermission:t,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"space_owner_permission":case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"collection_property_permission":case"team_owner_permission":case"team_permission":break;default:(0,H().HB)(o)}return(0,T.jsx)("div",{style:b.roundedPermissionItem,children:i},n)}))})]})})})),hn=o.forwardRef((function(e,t){const{blockStore:r,inviteTarget:l,permissionItem:d,mostPermissivePermissions:c,spaceVisibleUserMap:u,permissionItemArgs:p}=e,m=(0,i().v3)(),[g,f]=(0,o.useState)(!1),h="existingUser"===l.type?Vt().LU.createChildStore(r,{table:Q().oo,id:l.value.id}):void 0,y=(0,s().K8)((()=>"none"===l.spaceRole?(0,n(619338).p)({spaceVisibleUserMap:u,userId:l.value.id,store:r}):(0,on().v)(l.spaceRole)),[l,u,r]),v=(0,s().K8)((()=>r.getSpaceId()),[r]),b=(0,s().K8)((()=>c&&c.length>0),[c]),x=(0,o.useCallback)((()=>{const e=!1===g;f(!g),e&&ht().lD(m,{share_menu_session_id:U().Ay.state.sessionId,type:"user",userId:l.value.id})}),[m,g,f,l]),S=(0,a().IS)((e=>({permissionRoleButton:{marginRight:-6,color:e.text.secondary,fontSize:12},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:Te().zr},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,T.jsx)(Ct().A,{delayThreshold:0,placement:Ut().W.Left,textWrap:!0,style:S.tooltip,renderTooltip:()=>(0,T.jsx)(vn,{blockStore:r,blockPermissionItem:d}),render:n=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{...n,children:(0,T.jsx)(bt().A,{...e,...(0,Rt().A)(e,{onClick:x}),ref:t,title:(0,T.jsx)(on().A,{isLarge:!0,actorStore:h,containerStyle:S.cellMemberAvatarContainer,spaceRole:y,caption:b&&g?(0,T.jsx)(bn,{}):void 0}),right:(0,T.jsx)(It().Y,{type:d.type,table:ut().ev,disabled:!0,icon:b?g?at().B:rt().d:void 0,role:d.role??"none",isCurrentUser:!1,buttonStyle:S.permissionRoleButton})})}),b&&g&&(0,T.jsx)("div",{style:S.expandablePermissionList,children:null==c?void 0:c.map(((t,n)=>{const o=t.permissionItem.type;let i=null;switch(o){case"space_permission":i=(0,T.jsx)(rn().A,{store:r,spacePermission:t,showTrustedDomainPermission:!1,trustedDomainPermission:void 0,publicPermission:void 0,showPublicShareLinkPermission:!1,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission",isRestricted:e.isRestricted});break;case"explicit_team_owner_permission":i=(0,T.jsx)(cn().A,{store:r,blockTeamOwnerPermission:t,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":i=(0,T.jsx)(dn().A,{store:r,blockTeamPermission:t,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":i=(0,T.jsx)(ln().A,{store:r,blockTeamGuestPermission:t,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,T.jsx)(qt().A,{store:r,spaceId:v,groupPermission:t,permissionItemArgs:p,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":i=(0,T.jsx)($t().A,{store:r,userPermission:t,permissionItemArgs:p,spaceVisibleUserMap:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":case"trusted_domain_permission":case"collection_property_permission":case"space_owner_permission":case"team_owner_permission":case"team_permission":break;default:(0,H().HB)(o)}return(0,T.jsx)("div",{style:S.roundedPermissionItem,children:i},n)}))})]})})})),yn=o.forwardRef((function(e,t){const{inviteTarget:n}=e,o=n.type,i=(0,s().K8)((()=>(0,N().FI)()),[]);switch(o){case"group":return i?(0,T.jsx)(an().Ay,{...e,inviteTarget:n}):(0,T.jsx)(fn,{...e,ref:t,inviteTarget:n});case"existingUser":return i?(0,T.jsx)(an().Ay,{...e,inviteTarget:n}):(0,T.jsx)(hn,{...e,ref:t,inviteTarget:n});default:(0,H().HB)(o)}}));function vn(e){const{blockStore:t,blockPermissionItem:n}=e,o=(0,i().v3)(),l=(0,s().O$)(qe().AppStoreCurrentSpaceStore),d=(0,s().K8)((()=>{if(l)return(0,K().c2)(o,l)}),[o,l]),c=(0,s().K8)((()=>{const e=n.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return Vt().h4.createChildStore(t,{table:mt().yK,id:n.team_id})}}),[t,n]),u=(0,s().K8)((()=>null==c?void 0:c.getIcon()),[c]),p=(0,a().IS)((()=>({container:{fontWeight:A().Wy.bold,...A().RC},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),m=n.type;return"space_permission"===m?(0,T.jsx)(r().sA,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:(0,T.jsxs)("span",{style:p.container,children:[d&&(0,T.jsx)(wt().B,{disabled:!0,icon:d,isEmptyPage:!1,size:12,style:p.recordIcon}),l&&(0,T.jsx)(kt().A,{store:l,style:p.recordTitle})]})}}):"explicit_team_owner_permission"===m?(0,T.jsx)(r().sA,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:(0,T.jsxs)("span",{style:p.container,children:[u&&(0,T.jsx)(wt().B,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:p.recordIcon}),c&&(0,T.jsx)(kt().A,{store:c,style:p.recordTitle})]})}}):"explicit_team_permission"===m?(0,T.jsx)(r().sA,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:(0,T.jsxs)("span",{style:p.container,children:[u&&(0,T.jsx)(wt().B,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:p.recordIcon}),c&&(0,T.jsx)(kt().A,{store:c,style:p.recordTitle})]})}}):"explicit_team_guest_permission"===m?(0,T.jsx)(r().sA,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:(0,T.jsxs)("span",{style:p.container,children:[u&&(0,T.jsx)(wt().B,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:p.recordIcon}),c&&(0,T.jsx)(kt().A,{store:c,style:p.recordTitle})]})}}):"group_permission"===m?(0,T.jsx)(r().sA,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===m||"exclusive_user_permission"===m||"public_permission"===m||"trusted_domain_permission"===m||"collection_property_permission"===m||"restricted_permission"===m||"deleted_permission"===m||"team_permission"===m||"team_owner_permission"===m||"bot_permission"===m||"space_owner_permission"===m?(0,T.jsx)(T.Fragment,{children:ct().Tt(n.role??"none")&&(0,T.jsx)(r().sA,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})}):void(0,H().HB)(m)}function bn(){return(0,T.jsx)(r().sA,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function xn(e){const{styles:t,importContactType:n}=e,o="google"===n?"Google account":"Slack workspace";return(0,T.jsxs)("div",{style:t.zeroState,children:[(0,dt().G)(t.zeroStateIcon),(0,T.jsxs)("div",{style:t.zeroStateText,children:[(0,T.jsx)("div",{style:{fontWeight:A().Wy.semibold,marginBottom:4},children:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,T.jsx)("div",{children:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different {externalIntegrationCopy} or typing an email address",values:{externalIntegrationCopy:o}})})]})]})}function Sn(e){const{styles:t}=e;return(0,T.jsxs)("div",{style:t.zeroState,children:[(0,lt().x)(t.zeroStateIcon),(0,T.jsxs)("div",{style:t.zeroStateText,children:[(0,T.jsx)("div",{style:{fontWeight:A().Wy.semibold,marginBottom:4},children:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Members and guests will appear here"})}),(0,T.jsx)("div",{children:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try inviting someone with their email address or importing contacts"})})]})]})}function Mn(e){const{inviteTargetsStore:t,flowId:n,emailMessage:o}=e,s=(0,a().IS)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,textAlign:"center",fontSize:14,position:"relative",pointerEvents:"auto",marginTop:32,marginBottom:24,gap:14},logos:{display:"flex",gap:12,alignItems:"center",justifyContent:"center"},text:{marginTop:6,textAlign:"center"},subtext:{color:e.text.secondary},button:{padding:"8px 12px"}})),[]),l=(0,Nt().Hc)(),d=(0,i().v3)(),c=(0,Ae().X)("disconnect_contact_import"),u=(0,Ot().C)({onClickAuthenticated:e=>{c?Yt().L.setState({open:!0,type:e}):(U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:o??""}),t.setState({...t.state,tokenQuery:""}))},hideChevronIcon:!0,containerStyle:l.importListButtonContainer,buttonStyle:l.importListButton,flowId:n});return(0,T.jsxs)("div",{style:s.container,children:[(0,T.jsxs)("div",{style:s.logos,children:[(0,T.jsx)(Oe().Q,{iconGroup:Pt().m,variantName:"default",style:{height:22,width:22}}),(0,T.jsx)(Oe().Q,{iconGroup:Bt().j,variantName:"default",style:{height:22,width:22}})]}),(0,T.jsxs)("div",{style:s.text,children:[(0,T.jsx)("div",{style:{fontWeight:A().Wy.semibold,marginBottom:4},children:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.title",defaultMessage:"Import contacts"})}),(0,T.jsx)("div",{style:s.subtext,children:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.text",defaultMessage:"Connect with Google or Slack"})})]}),(0,T.jsx)("div",{children:(0,T.jsx)(xt().Ay,{popupType:At().nl.Popup,alignmentToOrigin:xt().yP.Start,placementToOrigin:xt().sx.Left,render:()=>(0,T.jsx)(_t().A,{importListItems:u}),originGap:12,renderOrigin:e=>(0,T.jsx)(vt().E,{...e,onClick:()=>{var t;null===(t=e.onClick)||void 0===t||t.call(e),ft().V(d,{source:"share_menu_empty_state"})},style:s.button,children:(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.button",defaultMessage:"Get started"})})})})]})}function An(e){let{tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:o}=e;const i=(0,gt().Ay)(t,function(e,t,n){return n?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,n)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:n}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,n,o),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:t,weight:0}]:i}function wn(e){let{tokenQuery:t,possibleDomains:n,isGuestInviteRequestRequired:o,shouldShowAutoFillEmail:i,environment:s,inviteTargetsStore:a,menuListStore:l,styles:d}=e;return An({tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:i}).map(((e,n)=>({key:e.tokenQuery,render:t=>(0,T.jsx)(bt().A,{icon:(0,lt().x)({width:20,height:20}),title:(0,T.jsx)(kn,{tokenQuery:e.tokenQuery,shouldShowAutofillEmail:i,isGuestInviteRequestRequired:o}),caption:o?(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:i&&(0,T.jsx)(X().I,{icon:st,size:"sm",color:"tertiary"}),...t}),action:async()=>{const o=(0,fe().qh)(e.tokenQuery);if(!(0,fe().DT)(o)){const t={type:"invalidUser",value:{text:e.tokenQuery}};return void(Se().P4({target:t,inviteTargetsStore:a})||a.setState({inviteTargets:[...a.state.inviteTargets,t],tokenQuery:""}))}const i=await yt().Ah(s,[o]);if(!i.length)return;const r=i[0];Se().P4({target:r,inviteTargetsStore:a})||(F().kH(s,{invite_token_query:t,selected_user_token:r,selected_user_token_rank:n,from:"share_modal_invite",subscription_tier:(0,zt().AI)(),type:"autofill"}),a.setState({inviteTargets:[...a.state.inviteTargets,r],tokenQuery:""}),l.unsetFocus())}})))}function kn(e){const{tokenQuery:t,shouldShowAutofillEmail:n,isGuestInviteRequestRequired:o}=e;return o?(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):n?(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"”{tokenQuery}”",values:{tokenQuery:t}}):(0,T.jsx)(r().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const jn=function(e){const t=(0,i().v3)(),a=(0,r().tz)(),[l,d]=(0,o.useState)(!0),c=(0,s().K8)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),u=(0,s().K8)((()=>{if(e.shouldShowSlackOnly||e.shouldShowGoogleOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=Qe().A.completeSlackAuthentications.state.length>0&&We().YA(),n=Qe().A.externalAuthentications.state.filter((e=>e.integration_id===Ke().E8)).length>0;return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t||n?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly,e.shouldShowGoogleOnly]),p=(0,s().K8)((()=>{const e=Ft().A.state.shouldUseEdgeCache,t=$e().default.checkGate({gateName:"edge_cache_share_menu"});return e&&t}),[]),[{value:m,status:g}]=(0,n(187174).Yb)((async()=>({...await yt().hQ({query:c,sectionLimit:u,membersOnly:e.membersOnly,environment:t,intl:a,shouldUseEdgeCache:p}).finally((()=>d(!1))),tokenQuery:c})),[t,a,e.membersOnly,c,u,p],{debounce:40});return(0,T.jsx)(un,{...e,tokenQuery:c,showShimmer:l,ready:"pending"!==g&&"idle"!==g,error:"rejected"===g,result:m})};function Cn(e){const t=(0,i().v3)(),n=(0,s().uB)(e.inviteTargetsStore,ce().Ay),r=(0,s().K8)((()=>n.state.inviteTargets),[n]),{display:l,source:d,focus:c,emailMessage:u}=(0,s().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),p=(0,s().O$)(qe().AppStoreCurrentSpaceStore),m=l===U().pP.Invite&&r.length>0,g=(0,s().K8)((()=>d===U().NL.Notion&&0===r.length&&(0,We().YA)()),[r.length,d]),f=(0,s().O$)(Qe().A.completeSlackAuthentications),h=(0,s().K8)((()=>d===U().NL.Notion&&0===r.length),[r.length,d]),y=(0,s().K8)((()=>Qe().A.externalAuthentications.state.filter((e=>e.integration_id===Ke().E8))),[]),v=(0,s().K8)((()=>(0,N().FI)()),[]),[b,x]=(0,o.useState)(!1),S=m&&!g,M=(0,o.useCallback)((()=>{n.reset()}),[n]);(0,o.useEffect)((()=>{if(p&&!b&&(g||h)){if(g)for(const e of f)He().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:p.id,integrationId:Ke().zG,importContactType:"slack"}}).catch((e=>{}));if(h)for(const e of y)He().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:p.id,integrationId:Ke().E8,importContactType:"google"}}).catch((e=>{}));x(!0)}}),[g,h]);const A=function(e){let{scrollerMarginBottom:t}=e;return(0,a().IS)((e=>({scroller:{flexGrow:1,marginBottom:t},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.text.primary}})),[t])}({scrollerMarginBottom:S?tt:0}),w=(0,Ge().J)(),k=(0,s().K8)((()=>!(!w||d===U().NL.Slack||d===U().NL.Google)&&"empty_state"===$e().default.getEligibleGroup({experimentId:"sharing_import_contacts_share_menu",parameter:"variant",defaultGroup:"control"})),[w,d]);return l!==U().pP.Invite?null:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ze().H,{type:Ye().A.Y,style:A.scroller,children:(0,T.jsx)(jn,{inviteTargetsStore:n,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:d===U().NL.Slack,shouldShowGoogleOnly:d===U().NL.Google,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,emailMessage:u,flowId:e.flowId})}),k?null:(0,T.jsx)(ot().g,{shouldShowSlackImportContactsButton:g,shouldShowGoogleImportContactsButton:h,emailMessage:u,inviteTargetsStore:n,isRedesignEnabled:v,emailMessageOpen:S,flowId:e.flowId,source:"share_menu"}),(0,T.jsx)(nt,{open:m&&!g,focus:c===U().yZ.Message,value:u,onFocus:()=>{d&&l===U().pP.Invite&&U().Ay.setState({...U().Ay.state,focus:U().yZ.Message,tab:U().QC.Share,display:l,source:d,emailMessage:u})},onChange:e=>{U().Ay.setState({...U().Ay.state,focus:c,tab:U().QC.Share,display:l,source:d,emailMessage:e.target.value})},onCancel:async()=>{await Ze().T({environment:t,inviteTargetsStore:n})&&(Ze().XP(t),M())},maxLength:1e3})]})}var In=()=>n(100622),Tn=()=>n(912913),_n=()=>n(891078),Pn=()=>n(107683),Bn=()=>n(49210);const Rn=(0,le().xh)("personCropCircleBadgeExclamationPoint",{default:{loader:()=>n.e(50710).then(n.bind(n,223331))},small:{loader:()=>n.e(50710).then(n.bind(n,577829))},fill:{loader:()=>n.e(50710).then(n.bind(n,565711))},fillSmall:{loader:()=>n.e(50710).then(n.bind(n,429926))}},["person","alert","exclamation","warning","user"]);var Ln=()=>n(7674),Dn=()=>n(204063),On=()=>n(592674),Nn=()=>n(868146);function En(e){const{email:t}=e;return(0,T.jsx)(oe().A,{avatar:{email:t},size:28})}function Un(e){const{children:t}=e,n=(0,a().IS)((()=>({wrapper:{position:"relative"},shield:{position:"absolute",left:17,top:18}})),[]);return(0,T.jsxs)("div",{style:n.wrapper,children:[t,(0,T.jsx)("div",{style:n.shield,children:(0,T.jsx)(Oe().Q,{iconGroup:Nn().u,colorName:"secondary",variantName:"mini"})})]})}function Fn(e){const{rows:t,internalDomains:n}=e,o=(0,a().IS)((e=>({inviteTargetList:{background:e.surface.wash,borderRadius:12,maxHeight:227,overflowY:"auto",padding:"12px 16px",width:"100%"}})),[]);return(0,T.jsx)(ze().H,{type:Ye().A.Y,style:o.inviteTargetList,children:(0,T.jsx)(Z().Y1,{gap:16,children:t.map((e=>{const{type:t}=e;switch(t){case"new":return(0,T.jsx)(Vn,{email:e.email,internalDomains:n},e.email);case"existing":return(0,T.jsx)(Kn,{userStore:e.userStore,internalDomains:n},e.userStore.id);default:(0,H().HB)(t)}}))})})}function Vn(e){const{email:t,internalDomains:n}=e,o=(0,he().C7)(t,n);return(0,T.jsx)(Hn,{avatar:o?(0,T.jsx)(Un,{children:(0,T.jsx)(En,{email:t})}):(0,T.jsx)(En,{email:t}),name:t,email:t})}function Kn(e){const{userStore:t,internalDomains:n}=e,o=(0,r().tz)(),{name:i,email:a}=(0,s().K8)((()=>({name:t.getDisplayName(o),email:t.getEmail()})),[t,o]);if(!i||!a)return null;const l=(0,he().C7)(a,n);return(0,T.jsx)(Hn,{avatar:l?(0,T.jsx)(Un,{children:(0,T.jsx)(oe().A,{userStore:t,size:28})}):(0,T.jsx)(oe().A,{userStore:t,size:28}),name:i,email:a})}function Hn(e){const{avatar:t,name:n,email:o}=e;return(0,T.jsxs)(Z().Y1,{direction:"horizontal",gap:10,align:"center-left",children:[t,(0,T.jsxs)(Z().Y1,{gap:2,children:[(0,T.jsx)(J().D,{styleName:"Body-14px/Medium",children:n}),(0,T.jsx)(J().D,{styleName:"Caption-12px/Regular",colorName:"secondary",children:o})]})]})}function zn(e){const{type:t}=e;switch(t){case"new":return e.email;case"existing":return e.userStore.getEmail();default:(0,H().HB)(t)}}function Wn(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:a,onClickAddMembers:l,onClickManageGuests:d}=e,c=(0,i().v3)(),u=(0,r().tz)(),[p,m]=(0,s().K8)((()=>[n.id,n.getName()]),[n]),g=(0,s().K8)((()=>null==a?void 0:a.getUserId()),[a]),f=(0,s().K8)((()=>{var e;return(null===(e=On().A.getData(c,{spaceId:p}))||void 0===e?void 0:e.filter((e=>e.hasGuests)).map((e=>e.domain)))??[]}),[c,p]),h=(0,Ce()._X)({name:"internal_guests",spaceId:p,userId:g,amount:0}),y=(0,o.useCallback)((()=>{const e=t.map(zn).filter(H().O9);l(e)}),[t,l]);return h&&f?(0,T.jsx)(ve().A,{debugName:"AddAsMembersModalContent",capture:!0,onEnter:y,children:(0,T.jsx)(Ln().tf,{header:(0,T.jsx)(Ln().YA,{iconAndTitle:(0,T.jsx)(Ln().ZQ,{iconGroup:Rn,iconColorName:"secondary",title:u.formatMessage(Yn.title,{spaceName:m,guestLimit:h.limit.total})}),description:u.formatMessage(Yn.description,{domain:f[0].url,p:e=>(0,T.jsx)(J().D,{colorName:"uiBluePrimary",children:(0,T.jsx)("p",{children:e})})})}),footer:(0,T.jsx)(Gn,{rowCount:t.length,onClickAddMembers:y,onClickManageGuests:d}),children:(0,T.jsx)(Fn,{rows:t,internalDomains:f})})}):null}function Gn(e){const{rowCount:t,onClickAddMembers:n,onClickManageGuests:o}=e,i=(0,r().tz)(),s=i.formatMessage(Yn.addMember,{rowCount:t});return(0,T.jsxs)(Z().Y1,{gap:16,children:[(0,T.jsxs)(Z().Y1,{gap:8,children:[(0,T.jsx)(Dn().A,{"aria-label":s,onClick:n,style:{height:32},children:s}),(0,T.jsx)(ee().A,{size:"lg","aria-label":i.formatMessage(Yn.manageGuestsInSettings),onClick:o,children:i.formatMessage(Yn.manageGuestsInSettings)})]}),(0,T.jsx)("div",{style:{textAlign:"center"},children:(0,T.jsx)(J().D,{styleName:"Caption-12px/Regular",colorName:"secondary",children:i.formatMessage(Yn.billingNotice)})})]})}const Yn=(0,r().YK)({title:{id:"addAsMembersModal.title",defaultMessage:"{spaceName} is over the guest limit of {guestLimit}"},description:{id:"addAsMembersModal.description",defaultMessage:"Shares to work email domains ending with ‘@{domain}’ must be added as members with access to your entire workspace."},addMember:{id:"addAsMembersModal.addMember",defaultMessage:"Add {rowCount, plural, one {member} other {{rowCount} members}}"},manageGuestsInSettings:{id:"addAsMembersModal.manageGuestsInSettings",defaultMessage:"Manage guests in settings"},billingNotice:{id:"addAsMembersModal.billingNotice",defaultMessage:"Each new member will be billed as an additional seat"}});n(16280);var qn=()=>n(857639),$n=()=>n(319625),Qn=()=>n(763824),Zn=()=>n(901389),Xn=()=>n(436572),Jn=()=>n(402390),eo=()=>n(579627),to=()=>n(972435);async function no(e){const{environment:t,email:n}=e,o=await He().callApi({eventName:"findUser",environment:t,data:{email:n}});if("success"===o.type){const e=o.data;if(e.value)return e.value.value.id}return await async function(e){const{environment:t,email:n}=e,o=await He().callApi({eventName:"createEmailUser",environment:t,data:{email:n,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:(0,Jn().H)(to().A.getIntl())}});if("failed"===o.type)throw o.error;return o.data.userId}({environment:t,email:n})}async function oo(e){const{blockPermissionItem:t,blockStore:n,environment:o,metadata:i,sudoModeStore:s}=e;await eo().J4({environment:o,store:n,sudoModeStore:s,permissionItems:[t],invite:i,skipGuestLimitValidation:!0})}var io=()=>n(31082);const so=(0,r().YK)({nonAdminCannotEditPermissions:{defaultMessage:"You do not have permission to invite guests to this page. Ask an admin to send the invite.",id:"permissions.nonAdminCannotEditPermissions.message"},guestsAreNotAllowed:{defaultMessage:"Members cannot invite guests to pages in this workspace. Ask an admin to send the invite.",id:"shareMenu.guestsAreNotAllowed.message"},unexpectedProcessInviteFailure:{defaultMessage:"Failed to process invite",id:"shareMenu.unexpectedProcessInviteFailure.message"}});async function ao(e){const{environment:t,intl:n,internalDomains:o,destination:i,invites:s,metadata:a,sudoModeStore:r,contextualInviteStore:l}=e,d=await async function(e){const{environment:t,invites:n,destination:o,metadata:i,sudoModeStore:s,contextualInviteStore:a}=e,r=(await(0,Qn().lX)(n,20,(e=>async function(e){const{invite:t,environment:n,destination:o}=e,{blockStore:i,spaceStore:s}=o,{defaultAddability:a}=t;try{switch(a.type){case"none":throw new Error("Cannot send invite with none addability type");case"member":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:s,defaultAddability:a}=n;if(void 0===s)throw new Error("Expected invite.invitee to be defined");const{email:r}=s,{blockRole:l,blockStore:d,spaceRole:c,spaceStore:u}=o,{inviteOrigin:p}=i,m=await no({environment:t,email:r});if(!m)throw new Error("Invitee user not found");const g={type:"user_permission",role:c,user_id:m},f={type:"user_permission",role:l,user_id:m};await async function(e){const{blockPermissionItem:t,blockStore:n,environment:o,inviteOrigin:i,spacePermissionItem:s,spaceStore:a,sudoModeStore:r}=e;if(t.user_id!==s.user_id)throw new Error("User IDs for block and space permission items must match");if(!a.isTeamsEnabled()&&!(await z().oH({environment:o,flowId:"",trackCreateTeamComplete:!1})))throw new Error("Failed to enable teams before creating member.");await eo().J4({environment:o,store:a,sudoModeStore:r,permissionItems:[s],invite:{inviteOrigin:i}}),await eo().J4({environment:o,store:n,sudoModeStore:r,permissionItems:[t],skipGuestLimitValidation:!0,invite:{inviteOrigin:i}})}({blockPermissionItem:f,blockStore:d,environment:t,inviteOrigin:p,spacePermissionItem:g,spaceStore:u});const h="member"===a.type&&"over_internal_guest_limit"===a.reason;return{type:"createdMember",invite:n,inviteeUserId:m,spacePermissionItem:g,blockPermissionItem:f,wasInternalDomainEnforced:h}}(e);case"member_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:s,internalDomain:a}=n;if(void 0===s)throw new Error("Expected invite.invitee to be defined");const{email:r}=s,{spaceStore:l}=o,{inviteMessage:d}=i,c=await no({environment:t,email:r});if(!c)throw new Error("Invitee user not found");await async function(e){const{environment:t,spaceStore:n,inviteeUserId:o,inviteMessage:i}=e;if(n.canAdmin())throw new Error("This operation is not valid for workspace owners, because member requests are immediately approved when created by a workspace owner. Use createMember instead.");const s=await He().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:o,spaceId:n.id,message:i}});if("failed"===s.type)throw s.error}({environment:t,inviteeUserId:c,inviteMessage:d,spaceStore:l});const u=void 0!==a;return{type:"createdMemberRequest",invite:n,wasInternalDomainEnforced:u}}(e);case"guest":case"guest_page_add":case"member_page_add":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:s}=e,{invitee:a}=n;if(void 0===a)throw new Error("Expected invite.invitee to be defined");const{email:r}=a,{blockRole:l,blockStore:d}=o,c=await no({environment:t,email:r});if(!c)throw new Error("Invitee user not found");const u={type:"user_permission",role:l,user_id:c};return await oo({blockPermissionItem:u,blockStore:d,environment:t,metadata:i,sudoModeStore:s}),{type:"addedUserPermission",invite:n,inviteeUserId:c,blockPermissionItem:u}}(e);case"guest_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e;if(void 0===n.invitee)throw new Error("Expected invite.invitee to be defined");const{email:s}=n.invitee,{blockRole:a,blockStore:r,spaceStore:l}=o,{inviteMessage:d}=i,c={id:r.id,spaceId:l.id},u=await no({environment:t,email:s});if(!u)return;return await async function(e){const{block:t,blockRole:n,environment:o,inviteeUserId:i,inviteMessage:s}=e,a=await He().callApi({eventName:"requestAccess",environment:o,data:{type:"guest-invite-request",block:t,forActorId:i,message:void 0,attributes:{role:n,inviteMessage:s}}});if("failed"===a.type)throw a.error}({block:c,blockRole:a,environment:t,inviteeUserId:u,inviteMessage:d}),{type:"createdGuestRequest",invite:n}}(e);case"group":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:s}=e,{blockRole:a,blockStore:r}=o;if("group"!==n.inviteTarget.type)throw new Error("Expected invite.inviteTarget to be a group");const l=n.inviteTarget.value,d={type:"group_permission",role:a,group_id:l.group_id};return await oo({blockPermissionItem:d,blockStore:r,environment:t,metadata:i,sudoModeStore:s}),{type:"addedGroupPermission",invite:n,group:l,blockPermissionItem:d}}(e);default:(0,H().HB)(a)}}catch(l){var r;const e=(0,$n().A)(l).message,o={miscDataToConvertToString:{message:e,spaceId:s.id,blockId:i.id,actorUserId:n.currentUser.id,inviteeEmail:null===(r=t.invitee)||void 0===r?void 0:r.email,defaultAddabilityType:a.type}};let d,c;e.toLowerCase().includes("non-admin cannot edit permissions")?(d=!0,c="nonAdminCannotEditPermissions"):e.toLowerCase().includes("guests are not allowed")?(d=!0,c="guestsAreNotAllowed"):(d=!1,c="unexpectedProcessInviteFailure"),qn().log({level:d?"info":"error",from:"processInvite",type:c,data:o});const u=to().A.formatMessage(so[c]);return void(d?Zn().rG({message:u}):Zn().f1(u))}}({environment:t,invite:e,destination:o,metadata:i,sudoModeStore:s})))).filter(H().O9);if(a){const e={};for(const t of r)"addedUserPermission"!==t.type&&"createdMember"!==t.type||"group"===t.invite.inviteTarget.type||(e[t.invite.inviteTarget.value.email]=t.inviteeUserId);a.setState({...a.state,invitedEmailToUserIdMap:e})}return r}({destination:i,environment:t,invites:s,metadata:a,sudoModeStore:r,contextualInviteStore:l});if((0,io().Bw)({destination:i,environment:t,internalDomains:o,inviteResults:d,metadata:a}),0===d.length)return!1;return(0,N().FI)()?Xn().D6({label:ro({invites:s,intl:n})}):Xn().D6({label:n.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"})}),!0}function ro(e){var t;const{invites:n,intl:o}=e,i=null===(t=n[0].invitee)||void 0===t?void 0:t.email;i||o.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"});const s=n.length-1;return n.filter((e=>{var t;return"member"!==(null===(t=e.invitee)||void 0===t?void 0:t.currentRole)})).length===n.length?s<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuest.label",defaultMessage:"Invite sent to {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuests.label",defaultMessage:"Invite sent to {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:s}):s<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMember.label",defaultMessage:"Shared with {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMultiple.label",defaultMessage:"Shared with {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:s})}function lo(e){e.reset(),U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.MainShareMenu,source:U().mc.ShareTopbarButton})}async function co(e){const{addAsMembersResult:t,destination:n,environment:o,internalDomains:i,intl:s,invites:a,inviteTargetsStore:r,metadata:l}=e;var d;t&&("manageGuests"===t?(d="members",Ee().A.setState({currentTab:d,defaultSubtab:void 0,highlightedSetting:void 0,open:!0,openedFrom:"share_menu"})):"addMembers"===t?(lo(r),await ao({destination:n,environment:o,internalDomains:i,invites:a,intl:s,metadata:l})):(0,H().HB)(t))}async function uo(e){const{destination:t,contextualInviteStore:n,defaultAddabilities:o,metadata:i,invites:s,environment:a,internalDomains:r,intl:l,inviteTargetsStore:d,spaceStore:c,spaceUserStore:u,sudoModeStore:p}=e,m=s.map((e=>e.defaultAddability)).some((e=>"member"===e.type&&"over_internal_guest_limit"===e.reason)),g=s.map((e=>e.defaultAddability)).some((e=>["guest","guest_request","guest_page_add"].includes(e.type)));if(m){const e=s.map((e=>function(e){const{inviteTarget:t,environment:n}=e,{type:o}=t;switch(o){case"existingUser":return{type:"existing",userStore:new(Vt().LU)(n,{table:Q().oo,id:t.value.id})};case"newUser":return{type:"new",email:t.value.email};case"group":return;default:(0,H().HB)(o)}}({environment:a,inviteTarget:e.inviteTarget}))).filter(H().O9),n=await async function(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:o}=e;return await Bn().T.showAsyncModal((e=>(0,T.jsx)(Pn().s,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{type:"fixed",length:400}},render:()=>(0,T.jsx)(Wn,{inviteUserListRows:t,spaceStore:n,spaceUserStore:o,onClickAddMembers:()=>{e.resolve("addMembers")},onClickManageGuests:()=>{e.resolve("manageGuests")}})})))}({inviteUserListRows:e,spaceStore:c,spaceUserStore:u});await co({addAsMembersResult:n,destination:t,environment:a,internalDomains:r,intl:l,invites:s,inviteTargetsStore:d,metadata:i})}else{lo(d);if(!(await ao({destination:t,environment:a,internalDomains:r,intl:l,invites:s,metadata:i,sudoModeStore:p,contextualInviteStore:n})))return;const e=s.map((e=>e.invitee)).filter(H().O9);g&&function(e){const{contextualInviteStore:t,defaultAddabilities:n,environment:o,invitees:i,spaceStore:s}=e,a=i.filter((e=>function(e){const t=e.type;return["guest","guest_request","guest_page_add"].includes(t)}(n[e.email]))).map((e=>({email:e.email,isGuest:"member"!==(null==e?void 0:e.currentRole)})));t.setState({...t.state,invitedUsers:a}),V().BY({environment:o,spaceStore:s,contextualInviteStore:t})}({contextualInviteStore:n,environment:a,spaceStore:c,defaultAddabilities:o,invitees:e})}}var po=()=>n(540459),mo=()=>n(173376),go=()=>n(133507);function fo(e){const{onClick:t,featureAvailability:n}=e;return(0,T.jsx)(Ct().A,{disableTooltip:!1,renderTooltip:()=>(0,T.jsx)(go().j,{featureAvailability:n}),render:e=>(0,T.jsx)(Dn().A,{size:"lg",style:{marginLeft:8},onClick:t,...e,children:(0,T.jsx)(r().sA,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}const ho=1e3;function yo(e){const{blockStore:t,contextualInviteStore:n,defaultAddabilities:l,internalDomains:d,inviteTargetsStore:c,invites:u,metadata:p,spaceRole:m,spaceStore:g,spaceUserStore:f,sudoModeStore:h}=e,y=(0,i().v3)(),v=(0,r().tz)(),b=(0,a().IS)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:24,borderRadius:4,color:In().Ay.uiGray}})),[]),[x,S]=(0,o.useState)("editor"),[M,A]=(0,o.useState)(!1),w=(0,s().K8)((()=>(0,N().FI)()),[]),{source:k,focus:j,emailMessage:C,display:I}=(0,s().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),_=(0,s().K8)((()=>t.getType()),[t]),{inviteTargets:P,inputFieldText:B}=(0,s().K8)((()=>({inviteTargets:(0,Se().U1)({inviteTargetsStore:c,includeInputFieldText:!0}),inputFieldText:c.state.tokenQuery.trim()})),[c]),R=async()=>{if(!M&&l&&d){if(0===P.length&&w){const e=U().Ay.state;return U().Ay.setState({...e,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e.display===U().pP.Invite?e.source:U().NL.Notion,emailMessage:e.display===U().pP.Invite?e.emailMessage:""}),void F().UC(y,{source:"invite_button"})}A(!0);try{const e={blockRole:x,blockStore:t,spaceRole:m,spaceStore:g};await uo({contextualInviteStore:n,defaultAddabilities:l,destination:e,environment:y,internalDomains:d,intl:v,invites:u,inviteTargetsStore:c,metadata:p,spaceStore:g,spaceUserStore:f,sudoModeStore:h})}finally{A(!1)}}},L=(0,Be().sf)(u.map((e=>e.invitee)).filter(H().O9)),D=(0,s().K8)((()=>f.getUserId()),[f]),O=(0,Ce()._X)({name:"guests",spaceId:g.id,userId:D,amount:L}),E=(0,s().K8)((()=>t.canEditMembership()),[t]),V=(0,_n().i0)(t),K=(0,_n().ty)(t),z=Object.values(l??{}).some((e=>"none"===e.type||"member_request"===e.type)),W=C.length>ho,G=M||!E||V||K,[Y,q]=(0,o.useState)(!G);return(0,T.jsx)(Ct().A,{disableTooltip:E&&!V&&!K,placement:Ut().W.Left,renderTooltip:()=>E?V?(0,T.jsx)(r().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.pageInTrash",defaultMessage:"Restore page from trash to add people"}):K?(0,T.jsx)(r().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.hasAIEdits",defaultMessage:"Resolve pending edits to add people"}):void 0:w?(0,T.jsx)(r().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccessRedesign",defaultMessage:"Request full access to share with others"}):(0,T.jsx)(r().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccess",defaultMessage:"Only those with full access can add people"}),render:e=>(0,T.jsxs)("div",{style:{display:"flex"},...e,children:[(0,T.jsx)(mo().I,{inviteTargetsStore:c,metadata:p,focus:j===U().yZ.Search||w&&I===U().pP.MainShareMenu&&Y,setAutoFocusInput:q,addabilities:l,disabled:G,onFocus:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:k||U().NL.Notion,emailMessage:C||""}),F().Wd(y,{source:k||U().NL.Notion}),0===P.length&&w&&F().UC(y,{source:"invite_button"})},onSubmit:()=>{B.length>0||R()},placeholder:v.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}),right:w&&B.length>0&&U().Ay.getState().display===U().pP.Invite||P.length>0?(0,T.jsx)(Tn().Ay,{disabled:!E||V||K,role:x,table:"block",type:"user_permission",blockType:_,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:b.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>S(e)}):void 0}),O&&(0,Ce().N9)(O,{available:()=>(0,T.jsx)(po().G,{tooltip:C.length>ho?(0,T.jsx)(r().sA,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,disabled:!E||V||K||z||W,onClick:R}),unavailable:e=>(0,T.jsx)(fo,{featureAvailability:e,onClick:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:void 0,source:k||U().NL.Notion,emailMessage:C||""}),yt().D6({environment:y,upgradeButtonName:"user_permission_item"})}})})]})})}var vo=()=>n(704152),bo=()=>n(347930);const xo=function(e){const t=(0,a().DP)(),{buttonStyle:n}=(0,a().IS)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:6,boxShadow:e.shadow2XS,background:e.inputBackground,color:e.text.secondary,fill:In().Ay.white,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontSize:14}})),[]);return(0,T.jsx)(vo().A,{hovered:e.hovered,onClick:e.onClick,disabled:e.disabled,disabledFeedback:!0,style:{...n,...e.isLarge&&{height:32},...e.style},hoveredStyle:{background:t.buttonHoveredBackground},pressedStyle:{background:t.buttonPressedBackground},onFocus:e.onFocus,onBlur:e.onBlur,onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,className:e.className,children:e.children})};const So=function(e){const{store:t}=e,{isMobile:o}=(0,i().Y0)(),l=(0,s().K8)((()=>t.canEditMembership()),[t]),d=(0,s().K8)((()=>(0,N().FI)()),[]),c=(0,_n().i0)(t),u=(0,_n().ty)(t),p=(0,a().IS)((e=>({buttonContainer:{display:"flex",alignItems:"center",gap:Xe().Y3},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden",...d?{background:e.tint.regular,borderRadius:10,color:e.text.tertiary,boxShadow:"none",height:o?36:30}:{}},inputContent:{display:"flex",alignItems:"center",fontSize:16,fontWeight:400,...A().RC},iconContainer:{fill:e.icon.secondary,marginRight:8},blueButton:{minWidth:Xe().CO}})),[o,d]);return(0,T.jsx)(Ct().A,{renderTooltip:()=>u?(0,T.jsx)(r().sA,{id:"inviteUserButton.tooltip.resolveAIEditsMessage",defaultMessage:"Resolve pending edits to add people"}):(0,T.jsx)(r().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:l&&!c&&!u,render:t=>(0,T.jsxs)("div",{style:p.buttonContainer,...t,children:[(0,T.jsx)(xo,{onClick:e.onClick,disabled:!l||c||u,style:p.inputButton,children:(0,T.jsx)("div",{style:p.inputContent,children:o&&d?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{style:p.iconContainer,children:(0,n(381138).q)({height:16,width:16})}),(0,T.jsx)(r().sA,{defaultMessage:"Invite people, emails, groups...",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots.mobile"})]}):(0,T.jsx)(r().sA,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!o&&(0,T.jsx)(Dn().A,{size:"lg",onClick:e.onClick,disabled:!l||c||u,style:p.blueButton,children:(0,T.jsx)(r().sA,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function Mo(e){const{store:t,permissionItemArgs:n}=e,{onUpgradeButtonClick:l}=n,d=(0,i().v3)(),c=(0,i().WS)(),u=(0,s().uB)(void 0,D().A),p=(0,s().K8)((()=>u.state.permissionsInviteStore),[u]),m=(0,s().K8)((()=>u.stage),[u]),g=(0,s().K8)((()=>p.state.modalOpen),[p]),f=(0,s().K8)((()=>(0,N().FI)()),[]),h=(0,s().K8)((()=>t.canAdmin()),[t]),y=(0,s().K8)((()=>{const e=ue().subscriptionDataStoreInstance.state;return Boolean(e&&Ht().Fq(e))}),[]),v=(0,s().K8)((()=>(0,E().Xh)({store:t})),[t]),b=(0,a().IS)((e=>({button:{display:"flex",alignItems:"center",minHeight:f?0:52,marginBottom:f?16:void 0},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[f]),x=(0,o.useCallback)(((e,t)=>{e&&t>0&&Xn().D6({label:(0,T.jsx)(r().sA,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:c?b.requestedUsersToast:void 0})}),[c,b.requestedUsersToast]);return m!==L().d5.closed||c&&!h?null:(0,T.jsx)(vo().A,{mobileFeedback:!0,disabled:!0,style:b.button,children:(0,T.jsxs)("div",{style:b.buttonInner,children:[g&&(0,T.jsx)(bo().H,{store:t,disabled:!h,membersOnly:v,isSubscribed:y,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:b.modalButton,permissionsInviteStore:p,onInviteComplete:x,analyticsFrom:"mobile_invite"}),(0,T.jsx)(So,{store:t,onClick:()=>(0,Lt().LH)({environment:d,permissionsInviteStore:p,store:t,isSubscribed:y,renderInShareModal:!1})})]})})}var Ao=()=>n(42476),wo=()=>n(179030);function ko(e){const{spaceName:t,domainUrl:n}=e,o=(0,r().tz)();return(0,T.jsx)(wo().l,{tint:"gray",iconGroup:Ao().A,label:o.formatMessage(jo.label,{spaceName:t}),description:o.formatMessage(jo.description,{domain:n}),display:"inline"})}const jo=(0,r().YK)({label:{id:"shareMenu.overLimitBanner.label",defaultMessage:"{spaceName} is over the guest limit"},description:{id:"shareMenu.overLimitBanner.description",defaultMessage:"If you share this page to a ‘@{domain}‘ email, the invite will be sent to your workspace owners as a request to add them as a member with full access to the workspace."}});var Co=()=>n(695608),Io=()=>n(496603),To=()=>n(698449),_o=()=>n(605402),Po=()=>n(704262),Bo=()=>n(583705),Ro=()=>n(296798),Lo=()=>n(186445),Do=()=>n(731320),Oo=()=>n(898808),No=()=>n(485952);const Eo=(0,r().YK)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function Uo(e){let{store:t}=e;const n=(0,i().v3)(),l=(0,s().K8)((()=>(0,Lo()._m)(n)),[n]),d=(0,s().K8)((()=>t.canEditContentOnly()),[t]),{role:c,attribution:u}=(0,s().K8)((()=>{if(!l)return{role:"none",attribution:null};const e=(0,Do().zt)({userId:l.id,store:t}),o=function(e){let{environment:t,calculatedPermission:n,store:o}=e;const i=(0,Me().pp)(o)||qe().default.state.currentSpaceStore;if(!i)return null;if((0,ct().Ds)(n)){const e=(0,K().RF)({groupId:n.group_id}),t=null==e?void 0:e.name;return t?(0,T.jsxs)(T.Fragment,{children:[(0,Bo().$)({width:18,marginRight:5}),t]}):null}if((0,ct().eu)(n)){var s;const e=n.team_id||(null===(s=(0,Me().Uo)(o))||void 0===s?void 0:s.id);if(!e)return null;const t=Vt().h4.createChildStore(i,{table:mt().yK,id:e,spaceId:i.id});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Oo().x,{disabled:!0,store:t,size:18,style:{marginRight:5}}),(0,T.jsx)(No().i,{navigableParentStore:t,showUnderline:!0,maxLength:30})]})}if((0,ct().Lg)(n))return(0,ct().Ni)(n)?(0,T.jsx)(r().sA,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Oo().x,{disabled:!0,store:i,size:18,style:{marginRight:5}}),(0,K().GK)(t,i)]});if((0,ct().W8)(n))return(0,T.jsx)(Ro().A,{underline:!0,inline:!0,onClick:()=>{U().Ay.setState({...U().Ay.state,display:U().pP.Publish,tab:U().QC.Publish})},children:(0,T.jsx)(r().sA,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"})});return null}({environment:n,calculatedPermission:e,store:t});return{role:e.role,attribution:o}}),[l,t,n]),{userId:p,spaceId:g}=(0,s().K8)((()=>({userId:t.userId,spaceId:t.getSpaceId()})),[t]),f=(0,Ce().P9)({name:"block_read_and_write_role",spaceId:g,userId:p}),h=(0,s().K8)((()=>!!c&&(f&&!(0,ct().p2)(c))),[c,f]);(0,o.useEffect)((()=>{c&&ht().VJ(n,{share_menu_session_id:U().Ay.state.sessionId,role:c})}),[]);const y=(0,a().IS)((e=>({container:{background:e.surface.wash,border:1,borderStyle:"solid",borderColor:e.accentColors.gray[75],borderRadius:4,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingTop:10,paddingBottom:10,paddingLeft:12,paddingRight:12,display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},icon:{marginRight:8},bannerLabel:{fontSize:12,display:"flex",flexDirection:h?"column":"row"},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:h?0:5},requestAccessContainer:{fontSize:12,flexShrink:0},pendingAccessRequestButton:{color:e.text.tertiary},accessRequestButton:{color:e.blueColor,padding:5,borderRadius:4}})),[h]),[v,b]=(0,o.useState)(!1),[x,S]=(0,o.useState)(!1),M=(0,o.useCallback)((async()=>{var e;if("reader"!==c&&"comment_only"!==c)return;const o=await He().callApi({eventName:"requestAccess",environment:n,data:{type:"current-actor-to-block",block:{id:t.id,spaceId:t.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:c},message:void 0}});"success"===o.type&&o.data.request?(b(!0),ht().T_(n,{request_access_type:"page",previous_access_level:c,requested_access_level:"read_and_write",requestId:o.data.requestId})):"failed"===o.type&&"UserRateLimitResponse"===(null===(e=o.body)||void 0===e?void 0:e.name)&&S(!0)}),[n,c,t]);if(!(0,ct().PW)(c))return null;const A=function(e){switch(e){case"editor":return Eo.fullAccess;case"read_and_write":return Eo.editor;case"content_only_editor":return Eo.contentEditor;case"comment_only":return Eo.commenter;case"reader":return Eo.reader;case"none":case"membership_admin":return null;default:(0,H().HB)(e)}}(c);return A?(0,T.jsx)(Ct().A,{delayThreshold:0,renderTooltip:()=>(0,T.jsx)(r().sA,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!d,textWrap:!0,style:{maxWidth:180},render:e=>(0,T.jsxs)("div",{style:y.container,...e,children:[(0,T.jsxs)("div",{style:y.bannerBodyContainer,children:[(0,T.jsx)(oe().A,{userStore:l,size:20,style:y.icon}),(0,T.jsx)(m().A,{style:y.bannerLabel,isMultiline:!0,children:(0,T.jsx)(r().sA,{...A,values:{hasAttribution:Boolean(u),attribution:(0,T.jsx)("span",{style:y.attribution,children:u})}})})]}),h&&(0,T.jsx)("div",{style:y.requestAccessContainer,children:(0,T.jsx)(vo().A,{style:v||x?y.pendingAccessRequestButton:y.accessRequestButton,onClick:M,disabled:v||x,children:v?(0,T.jsx)(r().sA,{defaultMessage:"Edit access requested",id:"permissionsLevelBanner.requestPermission.accessRequested"}):x?(0,T.jsx)(r().sA,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,T.jsx)(r().sA,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}),placement:Ut().W.Left}):null}var Fo=()=>n(891368),Vo=()=>n(555857),Ko=()=>n(631523);function Ho(e){const{store:t,permissionItemArgs:n}=e,{showTeamPermission:o,showSpacePermission:i,mostPermissiveAncestorTeamOwnerItem:s,mostPermissiveAncestorTeamMemberItem:a,mostPermissiveAncestorTeamGuestItem:r,mostPermissiveTrustedDomainItem:l,mostPermissiveSpaceItem:d,pagePermissionUIModel:c,mostPermissivePublicItem:u,showSitePublicPermission:p,showPublicShareLinkPermission:m,showTrustedDomainPermission:g,showRestrictedPermissionBanner:f}=e.calculatedPermissions,h=Number(o)+Number(i)+Number(p);return(0,T.jsxs)(T.Fragment,{children:[p&&u&&(0,T.jsx)(Vo().P,{store:t,publicPermissionItem:u,permissionItemArgs:n}),o&&s&&a&&(0,T.jsx)(Ko().A,{store:t,blockTeamOwnerPermission:s,blockTeamMemberPermission:a,blockTeamGuestPermission:r,permissionItemArgs:n}),i&&(0,T.jsx)(rn().A,{store:t,spacePermission:d,publicPermission:u,showPublicShareLinkPermission:m,trustedDomainPermission:l,showTrustedDomainPermission:g,permissionItemArgs:n,fromPermissionWrapper:"permission_list",isRestricted:f}),(0,T.jsx)(zo,{store:t,pagePermissions:c,numberPermissionsAlreadyRendered:h,permissionItemArgs:n})]})}function zo(e){const t=(0,r().tz)(),n=(0,s().K8)((()=>{const e=qe().default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:o,pagePermissions:i,numberPermissionsAlreadyRendered:a,permissionItemArgs:l,showHeader:d}=e,{showUserPermissions:c,mostPermissiveGroupPermissions:u,mostPermissiveTeamPermissions:p,mostPermissiveUserPermissions:m}=i,g=(0,Wt().x)(),f=(0,s().K8)((()=>{const e=c?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:n}=e,o={};return t.forEach((t=>{o[t.permissionItem.user_id]=(0,T.jsx)($t().A,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:n,fromPermissionWrapper:"permission_list"},t.permissionItem.user_id)})),o}({store:o,mostPermissiveUserPermissions:m,permissionItemArgs:l,spaceVisibleUserMap:g}):[];return Io().oE(Object.keys(e).map((n=>{const i=Vt().LU.createChildStore(o,{table:Q().oo,id:n}),s=i.getModel();if(!i.isReady()||s)return{title:(0,Co().c6)(t,s),permissionItem:e[n]}})))}),[c,m,l,o,t,g]),h=function(e){const{store:t,mostPermissiveTeamPermissions:n,permissionItemArgs:o}=e;return n.map((e=>ct().nl(e.permissionItem)?(0,T.jsx)(cn().A,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):ct().un(e.permissionItem)?(0,T.jsx)(ln().A,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,T.jsx)(dn().A,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:o,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:o,mostPermissiveTeamPermissions:p,permissionItemArgs:l}),y=(0,s().K8)((()=>{const e=n?function(e){const{spaceId:t,mostPermissiveGroupPermissions:n}=e,o={},i=new Set(_o().A.state.permissionGroupsAndMemberCounts.map((e=>e.group.group_id)));return n.forEach((n=>{const s=n.permissionItem.group_id;i.has(s)&&(o[s]=(0,T.jsx)(qt().A,{store:e.store,groupPermission:n,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),o}({store:o,spaceId:n,mostPermissiveGroupPermissions:u,permissionItemArgs:l}):{};return Object.entries(e).map((e=>{let[n,o]=e;const i=_o().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n));return{title:i?(0,To().Pf)({intl:t,groupName:i.group.name}):"",permissionItem:o}}))}),[t,u,l,n,o]),v=[...f,...y];v.sort(((e,t)=>e.title.localeCompare(t.title)));const b=h.concat(v.map((e=>e.permissionItem))),x=b.length;if(0===x)return null;if(x>5-a){const e=Math.max(2-a,0);return(0,T.jsxs)(T.Fragment,{children:[d&&(0,T.jsx)(Fo().G0,{}),b.slice(0,e),(0,T.jsx)(Po().A,{permissions:b.slice(e,-1)}),b[x-1]]})}return(0,T.jsxs)(T.Fragment,{children:[d&&(0,T.jsx)(Fo().G0,{}),b]})}function Wo(e,t){return e.from.table===ut().ev&&e.from.blockId===t.id}const Go=function(e){const t=(0,i().v3)(),{device:r}=t,{store:l,permissionItemArgs:d,calculatedPermissions:c}=e,{sudoModeStore:u}=d,{permissionItemsCount:p,pagePermissionUIModel:m,showRestrictedPermissionBanner:g}=c,f=(0,s().K8)((()=>{if(!qe().default.state.currentSpaceStore)return!0;if(l.isTopLevelPrivatePage())return!0;const e=(0,Me().fU)(l);for(const t of e)if((0,n(299545)._p)(t)&&t.isTopLevelPrivatePage())return!0;return!1}),[l]);let h=null;const y=(0,s().K8)((()=>(0,E().Hb)({store:l,showRestrictedPermissionBanner:g})),[l,g]),{canAccessParent:v}=(0,s().K8)((()=>(0,E().iG)({store:l})),[l]),b={...c};if(!y&&v){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:n,mostPermissiveTeamPermissions:o,mostPermissiveUserPermissions:i}=t,[s,a]=Io().jB(n,(t=>Wo(t,e))),[r,l]=Io().jB(o,(t=>Wo(t,e))),[d,c]=Io().jB(i,(t=>Wo(t,e))),u={...t,mostPermissiveGroupPermissions:a,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},p={...t,mostPermissiveGroupPermissions:s,mostPermissiveTeamPermissions:r,mostPermissiveUserPermissions:d};return[u,p]}(l,m);b.pagePermissionUIModel=e,h=(0,T.jsx)(zo,{store:l,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:d,showHeader:!0})}const x=(0,s().K8)((()=>!(0,E().Aj)({store:l})),[l]),S=r.isMobile?Ye().A.None:Ye().A.Y,M=(0,a().IS)((e=>({scroller:{paddingBottom:10,minHeight:r.isMobile||0===p?void 0:1===p?60:90}})),[r,p]);return(0,o.useEffect)((()=>{ht().Fn({environment:t,calculatedPermissions:c})}),[]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(ze().H,{style:M.scroller,type:S,children:[!f&&(0,T.jsx)(Uo,{store:l}),(0,T.jsx)(n(65309).A,{store:l,showRestrictedPermissionBanner:g,showPermissionInheritanceBanner:!1,sudoModeStore:u}),!y&&p>0&&(0,T.jsx)(Fo().Ay,{store:l}),(0,T.jsx)(Ho,{store:l,calculatedPermissions:b,permissionItemArgs:d}),h,x&&(0,T.jsx)(n(342826).A,{store:l})]}),!r.isMobile&&(0,T.jsx)(j().A,{store:l,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:b,permissionItemArgs:d})]})};function Yo(e){const{blockStore:t,contextualInviteStore:n,inviteTargetsStore:r,permissionItemArgs:l,spaceStore:d,spaceUserStore:c,subscriptionDataStore:u}=e,p=(0,i().Y0)(),m=p.isMobile,{spaceId:g,spaceName:f,userId:h,spaceModel:y}=(0,s().K8)((()=>({spaceId:d.getSpaceId(),spaceName:d.getName(),userId:c.getUserId(),spaceModel:d.getModel()})),[d,c]),v=(0,s().K8)((()=>(0,Me().Uo)(t)),[t]),[b,x]=(0,s().K8)((()=>[null==c?void 0:c.getModel(),null==v?void 0:v.getModel()]),[c,v]),S=(0,s().K8)((()=>U().Ay.state.display),[]),M=(0,s().K8)((()=>(0,N().FI)()),[]),A=function(e,t,n){return(0,a().IS)((()=>({container:{position:"relative",height:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:t?n?"80vh":530:540}})),[t,n])}(0,M,(0,Ae().X)("collection_property_permissions")),w=(0,s().uB)(void 0,we().A),k=(0,s().K8)((()=>n.state.flowId),[n]),j=function(e){const t=(0,i().Y0)();return(0,o.useCallback)((n=>{n.preventDefault(),t.isMobile||e!==U().pP.MainShareMenu||U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:U().NL.Notion,emailMessage:""})}),[t,e])}(S),I=(0,_e().K)(u),_=(0,s().K8)((()=>(0,Se().U1)({inviteTargetsStore:r,includeInputFieldText:!0}).map((e=>({inviteTarget:e,invitee:(0,Ie().qw)({currentMembersAndGuests:I,inviteTarget:e})}))).filter(H().O9)),[r,I]),P=(0,je().mF)({space:d,spaceUser:c,team:v,invitees:_.map((e=>e.invitee)).filter(H().O9),store:t}),B=(0,xe().A)(d),R=_.map((e=>e.invitee)).filter((e=>void 0!==e&&void 0===e.currentRole&&B&&(0,he().C7)(e.email,B))),L=(0,Ce()._X)({name:"internal_guests",spaceId:g,userId:h,amount:R.length}),D=(0,Ce().P9)({name:"non_admin_members",spaceId:g,userId:h})?"read_and_write":"editor",O=(0,be().r1)({spaceStore:d}),E=(0,s().K8)((()=>{const e=U().Ay.state,t=e.display===U().pP.Invite?e.emailMessage:"";return{inviteFlowId:n.state.flowId,inviteMessage:t,inviteOrigin:"share_menu",shareMenuSessionId:e.sessionId}}),[n]),F=(0,s().K8)((()=>P?_.map((e=>{const{inviteTarget:t,invitee:n}=e,o=null==n?void 0:n.email;let i,s;return"group"===t.type?s={type:"group"}:o?(i=(0,he().CH)(o,B??[]),s=P[o]??{type:"none",reason:"other"}):s={type:"none",reason:"other"},{defaultAddability:s,internalDomain:i,invitee:n,inviteTarget:t}})):[]),[_,P,B]),V=(0,ye().Vi)(L,(()=>{if(!f)return;if(O)return;const e=R[0];if(!e)return;const t=(0,fe().zN)(e.email);return t?(0,T.jsx)(ko,{spaceName:f,domainUrl:t}):void 0})),K=(0,Ae().X)("share_menu_inheritance_banner");return(0,T.jsx)(ve().A,{debugName:"ShareMenuShareTab",capture:!0,onTab:j,children:(0,T.jsxs)("div",{style:A.container,children:[(0,T.jsxs)(Z().Y1,{direction:"vertical",gap:16,padding:M?m?`0 ${Te().u6}px 0px ${Te().u6}px`:`0 ${Te().rL}px 8px ${Te().rL}px`:"0 14px 8px 14px",children:[p.isMobile?(0,T.jsx)(Mo,{store:t,permissionItemArgs:l}):(0,T.jsx)(yo,{blockStore:t,contextualInviteStore:n,defaultAddabilities:P,internalDomains:B,invites:F,inviteTargetsStore:r,metadata:E,spaceRole:D,spaceStore:d,spaceUserStore:c,sudoModeStore:l.sudoModeStore}),V]}),S===U().pP.MainShareMenu&&!M&&(0,T.jsx)(Go,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l}),S===U().pP.MainShareMenu&&M&&(0,T.jsx)(C().Ay,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l,showPermissionInheritanceBanner:K}),S===U().pP.Invite&&!p.isMobile&&(0,T.jsx)(Cn,{store:t,inviteTargetsStore:r,menuListStore:w,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:k}),(0,T.jsx)(ke().A,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,T.jsx)(Fe,{domains:B,spaceId:g,spaceModel:y,userId:h,spaceUserModel:b,teamModel:x,blockStore:t}),whenDisabled:null})]})})}const qo=function(e){const{store:t,sudoModeStore:o}=e,i=(0,s().K8)((()=>o.state.changePermissionsEnabled),[o]),l=(0,s().K8)((()=>o&&o.shouldUserHaveAccessToPrivatePageBlock()&&!o.doesUserAlreadyHaveEditorAccess(t.pointer)&&o.state.privatePageStore),[o,t]),d=(0,a().IS)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.shadow2XS,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:A().Wy.medium,justifyContent:"center",marginTop:8,opacity:i?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:i?"rotate(-90deg)":void 0}})),[i]);return l?(0,T.jsxs)("div",{style:d.container,children:[(0,T.jsx)(m().A,{isMultiline:!0,children:(0,T.jsx)(r().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,T.jsx)("b",{children:t})}}})}),(0,T.jsxs)(ee().A,{size:"lg",disabled:i,style:d.button,onClick:()=>{o.setState({...o.state,changePermissionsEnabled:!0})},children:[(0,n(126553).x)(d.icon),i?(0,T.jsx)(r().sA,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,T.jsx)(r().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function $o(e){const t=(0,s().K8)((()=>U().Ay.state.tab),[]);switch(t){case U().QC.Share:return(0,T.jsx)(Yo,{...e,blockStore:e.store,subscriptionDataStore:ue().subscriptionDataStoreInstance});case U().QC.Publish:return(0,T.jsx)(ge,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,H().HB)(t)}}function Qo(){const e=(0,i().Y0)(),t=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:276},offlineMessageHeadline:{fontWeight:A().Wy.medium},iconStyle:{width:32,height:32,marginBottom:10,fill:e.icon.tertiary}})),[]);return(0,T.jsxs)("div",{style:t.container,children:[de(t.iconStyle),(0,T.jsx)("div",{style:t.offlineMessageHeadline,children:(0,T.jsx)(m().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,T.jsx)(r().sA,{defaultMessage:"You're offline",id:"blockPermissionsSettings.offline.headline"})})}),(0,T.jsx)(m().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,T.jsx)(r().sA,{defaultMessage:"Go online to share and publish",id:"blockPermissionsSettings.offline.prompt"})})]})}const Zo=function(e){const{store:t,permissionItemArgs:o}=e,r=(0,i().Y0)(),l=(0,s().uB)(e.inviteTargetsStore,ce().Ay),d=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]),c=(0,s().O$)(n(227440).e);return(0,T.jsxs)("div",{style:d.container,children:[o.sudoModeStore&&(0,T.jsx)(qo,{store:t,sudoModeStore:o.sudoModeStore}),!r.isMobile&&(0,T.jsx)(pe().aR,{inviteTargetsStore:l,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),c?(0,T.jsx)($o,{inviteTargetsStore:l,...e}):(0,T.jsx)(Qo,{})]})};function Xo(e){const{store:t,sudoModeStore:n,onUpgradeButtonClick:l,location:d}=e,A=(0,i().v3)(),w=(0,i().Y0)();(0,v().fJ)(R().Ns.publishSite),(0,v().fJ)(R().Ns.publishedSiteSettings);const k=(0,s().uB)(e.universalMemberInviteStore,D().A),C=(0,s().K8)((()=>k.state.contextualInviteStore),[k]),I=(0,O().H)(),P=(0,b().r)(),F=(0,x().HI)(),V=(0,s().K8)((()=>(0,N().FI)()),[]),K=(0,s().K8)((()=>E().dR({store:t,environment:A,trustedDomainsStore:I})),[A,t,I]),H=(0,s().K8)((()=>C.state.inviteStage),[C]),z=(0,s().K8)((()=>U().Ay.state.tab),[]),W=(0,a().IS)((e=>({title:{fontSize:V?16:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:V&&w.isMobile?e.surface.page:void 0}})),[w.isMobile,V]),G=(0,o.useMemo)((()=>({onUpgradeButtonClick:l,sudoModeStore:n,location:d})),[l,n,d]),Y=(0,s().K8)((()=>S().default.isVisible(M().n)),[]),q=(0,s().K8)((()=>(0,B().g)()),[]);if(!P)return q?(0,T.jsx)(_,{calculatedPermissions:K,store:t,permissionItemArgs:G,onClose:e.onClose}):null;if(!(w.isMobile||H!==L().d5.share_workspace&&H!==L().d5.request_workspace||Y))return(0,T.jsx)(re,{blockStore:t,spaceStore:P,contextualInviteStore:C});const $=w.isMobile?{menuType:h().gu.Modal,disableHeaderShadow:!0,title:V?(0,T.jsx)(m().A,{isMobile:w.isMobile,style:W.title,children:(0,T.jsx)(r().sA,{defaultMessage:"Share settings",id:"blockPermissionsSettings.mobileShareMenu.titleV2"})}):(0,T.jsx)(m().A,{isMobile:w.isMobile,style:W.title,children:(0,T.jsx)(r().sA,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})}),additionalTopbarContent:(0,T.jsx)(pe().zM,{mostPermissivePublicItem:K.mostPermissivePublicItem}),left:(0,T.jsx)(g().A,{href:(0,y().xS)("guides.sharing"),analyticsFrom:"sharing"}),footer:z===U().QC.Share&&(0,T.jsx)(j().A,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:K,permissionItemArgs:G}),topbarStyle:W.topbarStyle,right:(0,T.jsx)(p().DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:h().gu.Popup,maxHeight:"90vh"};return F?(0,T.jsx)(u().A,{...$,className:f().NXe,children:(0,T.jsx)(c().A,{debugName:"ShareMenuContainer",capture:!0,allowEsc:!0,children:(0,T.jsx)(Jo,{store:t,spaceStore:P,spaceUserStore:F,permissionItemArgs:G,calculatedPermissions:K,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:C})})}):null}function Jo(e){let{store:t,spaceStore:n,spaceUserStore:s,permissionItemArgs:a,calculatedPermissions:r,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:p}=e;const m=(0,i().v3)();return(0,o.useEffect)((()=>{l().IU({preventDismissMobileKeyboard:!0,environment:m}),d().clear({preventDismissMobileKeyboard:!0,environment:m})}),[m]),(0,T.jsx)(Zo,{store:t,spaceStore:n,spaceUserStore:s,permissionItemArgs:a,calculatedPermissions:r,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:p})}},704907:(e,t,n)=>{n.d(t,{A:()=>g});var o=n(296540),i=()=>n(847249),s=()=>n(433847),a=()=>n(959013),r=()=>n(901389),l=()=>n(579627),d=()=>n(247123),c=()=>n(878377),u=()=>n(108944),p=()=>n(125565),m=n(474848);const g=function(e){let{store:t}=e;const g=(0,n(401497).DP)(),f=(0,n(484714).v3)(),h=(0,o.useMemo)((()=>({environment:f,blocks:[t],publicEditMode:void 0})),[f,t]),y=(0,i().K8)((()=>c().Uo6([c().Ezz,c().AU6(c().p2L)])(h)),[h]),v=(0,i().K8)((()=>c().Uo6([c()._mr,c().AU6(c().Km9)])(h)),[h]);if(y){const{device:e}=f;return(0,m.jsx)("div",{style:{backgroundColor:g.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${g.regularDividerColor}`,marginTop:e.isMobile?28:1},children:(0,m.jsxs)(n(704152).A,{disabled:!v,style:{padding:12},onClick:()=>async function(e,t){if(!e.isDefined())return;const n=e.getPermissionItems(),o=u().KA(e),i=o?s().wD(u().E(o)):[],c=s().Cd(e.getModel(),n,i),p={type:"restore",permissionChanges:c},{accept:g}=await r().Gh({message:(0,d().r6)(p),acceptLabel:(0,d().QU)(p),cancelLabel:(0,m.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"}),description:(0,m.jsx)(d().f2,{openState:p})});g&&l().YD({environment:t,store:e})}(t,f),children:[(0,m.jsx)(p().A,{isMultiline:!0,isSmall:!0,children:(0,m.jsx)(a().sA,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),v&&(0,m.jsx)(p().A,{style:{marginTop:6,fontWeight:n(284371).Wy.semibold},children:(0,m.jsx)(a().sA,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})})]})})}return null}},705630:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreButton:()=>T,messages:()=>_});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(589407),l=()=>n(340498),d=()=>n(959013),c=()=>n(741496),u=()=>n(989423);var p=()=>n(778417),m=()=>n(645873);const g=new(m().O2)("topbarMoreMenu",(async()=>await Promise.all([n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(3965),n.e(84341),n.e(80533),n.e(45620),n.e(58221),n.e(44763),n.e(8081),n.e(67183),n.e(64598),n.e(82720),n.e(4253),n.e(86787),n.e(77465),n.e(24593),n.e(80896),n.e(1440),n.e(67378),n.e(58504),n.e(97308),n.e(63996),n.e(20636),n.e(66268),n.e(55717),n.e(7005),n.e(40186),n.e(22585),n.e(73206),n.e(11037),n.e(33235),n.e(91957),n.e(84176),n.e(16357),n.e(75681)]).then(n.bind(n,628302)))),f=(0,m()._h)(g,(e=>e.TopbarMoreMenu));var h=()=>n(494043),y=()=>n(448360),v=()=>n(351360),b=()=>n(816013),x=()=>n(318890),S=()=>n(594607),M=()=>n(953006),A=n(474848);function w(e){const{originRef:t}=e,n=(0,a().IS)((e=>({aiTranslateIcon:{height:18,width:18,fill:e.text.uiBluePrimary}})),[]);return(0,A.jsx)(S().U,{calloutId:"ai_page_translation",children:(0,A.jsx)(M().k,{origin:t,placementToOrigin:"bottom",header:(0,A.jsxs)("div",{style:{display:"flex",fontSize:14,gap:12,paddingLeft:4,paddingRight:4},children:[(0,x().K)(n.aiTranslateIcon),(0,A.jsx)(d().sA,{id:"aiPageTranslationTooltip.header",defaultMessage:"You can always find translation in the top right menu"})]}),showPointer:!1,pointerOffset:6,content:null,onCloseClick:()=>{y().W.reset()},style:{width:300},onPrimaryButtonClick:()=>{y().W.reset()},nextButtonContent:(0,A.jsx)(d().sA,{id:"aiPageTranslationTooltip.dismiss",defaultMessage:"Got it"})})})}var k=()=>n(406699),j=()=>n(612900),C=()=>n(782473);function I(e){let{originRef:t}=e;return(0,A.jsx)(S().U,{calloutId:"wiki_promo",children:(0,A.jsx)(M().k,{origin:t,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{b().r.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:C().Sw}})})}function T(e){let{buttonPopupStore:t,store:n,isLastButton:r,renderOrigin:l}=e;const d=(0,i().v3)(),{device:m}=d,[g,x]=(0,o.useState)(void 0),S=(0,o.useRef)(null),M=(0,o.useCallback)((()=>{b().r.reset(),y().W.reset(),p().IU({environment:d});const e=S.current;e&&x(e.getBoundingClientRect()),function(e){u().vd(e,"open_more_menu")}(d)}),[S,d]),C=(0,s().K8)((()=>b().r.state.showConvertTooltip),[]),T=(0,s().O$)(y().W),_=(0,a().IS)((e=>({mobilePopupStyle:{borderRadius:12,backgroundColor:e.surface.wash}})),[]),P=(0,A.jsxs)(A.Fragment,{children:[C?(0,A.jsx)(I,{originRef:S}):T?(0,A.jsx)(w,{originRef:S}):null,(0,A.jsx)(k().Ay,{popupType:m.isMobile?k().z7.BottomSheet:k().z7.Popup,buttonPopupStore:t,renderOrigin:l||(e=>(0,A.jsx)(R,{ref:S,buttonPopupEvents:e,isLastButton:r})),onClick:M,render:()=>(0,A.jsx)(f,{blockStore:n,onClickOriginRect:g,handleAccept:e=>function(e,t,n){const{mainEditorCurrentBlockStore:o}=v().default.state;if(o){const t=o.getType();var i;if(t)(0,c().N)(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:o.id,block_type:t,is_toggleable:(0,h().Yt)(t,o.getFormat()),collection_id:null===(i=o.getCollectionViewSourceCollectionStore())||void 0===i?void 0:i.id,parent_collection_id:o.getParentCollectionIdUpToTwoLevels(),form_id:o.getFirstFormIdInCollectionViewBlock()})}e.closeParentMenu&&B(t)}(e,t,d),handleDismiss:()=>B(t)}),originGap:m.isElectronWindows?12:8,forceInitialInbound:!0,style:m.isMobile?_.mobilePopupStyle:{width:240,maxHeight:"80vh"}})]}),L=(0,s().K8)((()=>v().default.state.inAppCalloutStore.getCalloutVisibility("ai_page_translation").canShow),[]);return T&&L?(0,A.jsx)(j().u,{shape:"square",borderRadius:6,children:P}):P}const _=(0,d().YK)({actions:{defaultMessage:"Actions",id:"topbar.actions"}});function P(e,t,o){const{device:i}=e;if(!i.isMobile){const{iconButton:{width:e,height:o}}=(0,n(863059).Hh)(t);return{display:"flex",alignItems:"center",justifyContent:"center",width:e,height:o,borderRadius:6}}const s=n(508496).default.checkGate({gateName:"tablet_refresh_gate"}),a=(0,n(573792).aD)(t).iconContainer;return o?{...a,marginLeft:i.isTablet&&s?-6:void 0,marginRight:0}:{...a,marginLeft:i.isTablet&&s?-6:void 0,marginRight:i.isTablet&&s?-6:a.marginRight}}function B(e){e.setState({...e.state,open:!1})}const R=o.forwardRef((function(e,t){let{buttonPopupEvents:o,isLastButton:s}=e;const c=(0,a().DP)(),u=(0,i().v3)(),{device:p}=u,m=(0,d().tz)();return(0,A.jsx)(n(859428).A,{renderTooltip:()=>u.currentUser.isLoggedIn()?(0,A.jsx)(d().sA,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,A.jsx)(d().sA,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:n(962730).W.Bottom,originGap:p.isElectronWindows?10:void 0,delayThreshold:400,render:e=>(0,A.jsx)(n(704152).A,{ref:t,style:P(u,c,s),mobileFeedback:p.isMobile,className:n(38337).ug9,ariaLabel:m.formatMessage(_.actions),...(0,n(553965).A)(o,e),children:p.isMobile?(0,r().L)({height:l().lD.lg,width:l().lD.lg,fill:c.icon.primary}):(0,r().L)({width:l().Ev.lg,height:l().Ev.lg,fill:c.icon.primary})})})}))},712493:(e,t,n)=>{n.r(t),n.d(t,{DummyModal:()=>d});n(296540);var o=()=>n(148307),i=()=>n(959013),s=()=>n(766676),a=n(474848);function r(e){const{messageKey:t}=e,n={id:"",key:t,type:"static",props:{}};return(0,a.jsx)(s().C,{...e,message:n})}const l=(0,i().YK)({title:{id:"dummyModal.title",defaultMessage:"Dummy Modal"},body:{id:"dummyModal.body",defaultMessage:"This is the body for the dummy modal."},primaryButton:{id:"dummyModal.primaryButton",defaultMessage:"Primary"},secondaryButton:{id:"dummyModal.secondaryButton",defaultMessage:"Secondary"},learnMore:{id:"dummyModal.learnMore",defaultMessage:"Learn More"}});function d(){const e=(0,i().tz)();return(0,a.jsx)(r,{messageKey:"dummy_modal",title:e.formatMessage(l.title),body:e.formatMessage(l.body),heroMedia:{src:o().A.images.sites.sitesLaunchModalPng,alt:"Dummy Modal",type:"image"},primary:{text:e.formatMessage(l.primaryButton)},secondary:{text:e.formatMessage(l.secondaryButton)},link:{text:e.formatMessage(l.learnMore),external:!0}})}},715011:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(296540),i=()=>n(959013),s=()=>n(409268),a=n(474848);function r(e){const t=(0,o.useMemo)((()=>(0,s().s)(e.store)),[e.store]);return(0,a.jsx)(i().sA,{id:"pageWordCount.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:t}})}},715392:(e,t,n)=>{n.d(t,{W:()=>i});var o=()=>n(666144);const i=new(n(848776).U)((e=>{let{userId:t,spaceId:n}=e;return`${t}-${n}`}),(async function(e,t){var i;let{userId:s,spaceId:a}=t;const[r,l]=await Promise.all([o().sy({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:n(798880).oo,id:s},userId:s}),o().sy({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:(0,n(848538).i1)({userId:s,spaceId:a}),userId:s})]),d=null===(i=n(351360).default.state.currentSpaceViewStore)||void 0===i||null===(i=i.getModel())||void 0===i?void 0:i.first_joined_space_time,c=null==r?void 0:r.value,u=null==l?void 0:l.value;if(c&&u&&d)return{id:c.id,space_id:u.id,membership_type:u.membership_type,email:c.email,name:c.name,profile_photo:c.profile_photo,onboarding_completed:c.onboarding_completed,first_joined_space_time:d}}));n(604341).exposeDebugValue("UserOnSpaceStore",i)},728051:(e,t,n)=>{n.r(t),n.d(t,{PublicTopbarMoreMenu:()=>ne});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(584262),r=()=>n(179034),l=()=>n(75756),d=n(474848);const c={viewBox:"0 0 20 20",svg:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v3.625h1.25V4.5c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v11a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875v-3.625h-1.25V15.5c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-11a2.125 2.125 0 0 0-2.125-2.125z"}),(0,d.jsx)("path",{d:"M12.442 9.558a.625.625 0 0 1 0 .884l-2.5 2.5a.625.625 0 0 1-.884-.884l1.408-1.408H3.5a.625.625 0 0 1 0-1.25h7.016L9.058 7.942a.625.625 0 1 1 .884-.884z"})]})},u=(0,n(340498).wt)("arrowRightIntoRectangle",c);var p=()=>n(589407),m=()=>n(748054),g=()=>n(864896),f=()=>n(959013),h=()=>n(348337),y=()=>n(575143),v=()=>n(89924),b=()=>n(878377),x=()=>n(492414),S=()=>n(351360),M=()=>n(599364),A=()=>n(416726),w=()=>n(100622);const k=(0,f().YK)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),j=(0,A().Ls)({key:"action report page",displayName:k.reportPageName,analyticsName:k.reportPageName.defaultMessage,validators:[b().sc7,b().Env,b().Kwf,b().AU6(b().kD4)],closeParentMenu:!0,render:e=>(0,d.jsx)(y().A,{...e,style:{color:w().Ay.red},svg:m().M,svgStyle:{fill:w().Ay.red},title:(0,d.jsx)(f().sA,{...k.reportPageName})}),action:e=>{let{blocks:t,environment:o}=e;n(201170).HX()}}),C=(0,f().YK)({signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"},topbarMobileMoreActionsMenu:{id:"action.topBarSiteMoreMobileActions.name",defaultMessage:"More"},search:{id:"topbar.publicPage.searchButton.label",defaultMessage:"Search"},reportFormName:{id:"action.reportForm.name",defaultMessage:"Report form"},viewOriginalPageName:{id:"action.viewOriginalPage.name",defaultMessage:"View original page"}}),I=(0,A().Ls)({key:"log in",displayName:C.signUpOrLogInName,analyticsName:C.signUpOrLogInName.defaultMessage,svg:u,validators:[b().AU6(b().M3g),b().IrU,b().AU6(b().ZVI)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;n(452939).Tv(t),await n(729283).VE(t,{utmContent:"sign_up_or_log_in",nextRoute:n(427704).JZ.login})}}),T=(0,A().Ls)({key:"view original page",displayName:C.viewOriginalPageName,analyticsName:C.viewOriginalPageName.defaultMessage,svg:n(47218).arrowExpandDiagonalBottomLeftToTopRightIcon,validators:[b().ZVI],closeParentMenu:!0,action:e=>{let{blocks:t}=e;const n=(0,x().Ay)({store:t[0],preferPublicLink:!0,pageVisitSource:a().y8.EmbedPublicPageViewOriginal,disableSlug:!0,embedded:!1});window.open(`${n}`,"_blank")}}),_=(0,A().Ls)({key:"report form",displayName:C.reportFormName,analyticsName:C.reportFormName.defaultMessage,svg:m().M,validators:[b().Env,b().kD4],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().Hi(t,n[0].id)}}),P=(0,A().Ls)({key:"ios share link",displayName:C.shareLinkName,analyticsName:C.shareLinkName.defaultMessage,svg:g().Y,validators:[b().vXb,b().wHP,b().un6],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=t[0],i=o.getNavigableBlockStore();if(i){const e=(0,x().Ay)({store:i,scrollToBlockId:i.id===o.id?void 0:o.id,fullyQualified:!0,pageVisitSource:a().y8.NativeShareLink,embedded:!1});n.mobileNative&&n.mobileNative.share(e)}}}),B=(0,A().Ls)({key:"web share link",displayName:C.shareLinkName,analyticsName:C.shareLinkName.defaultMessage,svg:g().Y,validators:[b().vXb,b().rr0],closeParentMenu:!0,action:async e=>{let{blocks:t}=e;const n=t[0],o=n.getNavigableBlockStore();if(o){const e=(0,x().Ay)({store:o,scrollToBlockId:o.id===n.id?void 0:n.id,fullyQualified:!0,pageVisitSource:a().y8.NativeShareLink,embedded:!1});try{await navigator.share({url:e})}catch{}}}}),R=(0,A().Ls)({key:"android share link",displayName:C.shareLinkName,analyticsName:C.shareLinkName.defaultMessage,svg:n(441532).y,validators:[b().vXb,b().wHP,b().m01],closeParentMenu:P.closeParentMenu,action:P.action}),L=(0,A().Fw)({key:"copy link",displayName:A().AY.copyLinkName,analyticsName:A().AY.copyLinkName.defaultMessage,svg:n(742852).w,shortcuts:["copyLinkToBlock"],validators:[b().M3g,b().vXb,b().AU6(b().wHP),b().AU6(b()._fc)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,t,n)=>{let{lazyDependencies:o,...i}=t;const{clipboardActions:s}=o;s&&s.copyLinkToBlock({...i,event:n,callback:e})}}),D=(0,A().Ls)({key:"edit page",displayName:C.editPageName,analyticsName:C.editPageName.defaultMessage,svg:n(105819).pencilLineIcon,validators:[b().vXb,b()._fc,b().Wci,b().AU6(b().V5t),b().FrL],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().T7(t,n[0].id)}}),O=(0,A().Ls)({key:"comment page",displayName:C.commentPageName,analyticsName:C.commentPageName.defaultMessage,svg:n(49621).h,validators:[b().vXb,b()._fc,n(930545).tm,b().AU6(b().M3g),b().FrL],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;h().aL(t,n[0].id)}}),N=(0,A().Ls)({key:"fork page",displayName:C.duplicatePageName,analyticsName:C.duplicatePageName.defaultMessage,svg:n(764781).V,validators:[b().vXb,b().FrL,b()._fc,b().K1R],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:o,environment:i}=e;n(394893).Ul({environment:i,store:t[0],originRect:o})}});function E(e){return(0,A().Ls)({key:"more actions menu",displayName:C.topbarMobileMoreActionsMenu,analyticsName:C.topbarMobileMoreActionsMenu.defaultMessage,svg:p().L,validators:[b().vXb,b().FrL,b()._fc],closeParentMenu:!0,action:e})}const U=(0,A().Ls)({key:"back to my content",displayName:C.backtoNotionName,analyticsName:C.backtoNotionName.defaultMessage,svg:n(426388).S,validators:[b().M3g,b().FrL],closeParentMenu:!0,action:(e,t)=>{let{environment:o}=e;const{currentUserRootStore:i,currentUserSettingsStore:s}=S().default.state;i&&s&&n(426116).t9({environment:o,userRootStore:i,userSettingsStore:s,pageVisitSource:a().y8.SwitchSpace})}}),F=(0,A().Ls)({key:"cookie settings",displayName:l().LS.cookieSettingsLabel,analyticsName:l().LS.cookieSettingsLabel.defaultMessage,validators:[b().AU6(b().ibx)],closeParentMenu:!1,render:e=>(0,d.jsx)(n(455215).A,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:o,...i}=e;return(0,d.jsx)(y().A,{...i,...t,title:n(972435).A.formatMessage(l().LS.cookieSettingsLabel),svg:n(212727).gearIcon})}}),action:()=>{}}),V=(0,A().Ls)({key:"search page",displayName:C.search,analyticsName:C.search.defaultMessage,svg:n(207207).J,validators:[b().vXb,b().FrL,b()._fc,b().Kg6],closeParentMenu:!0,action:e=>{let{environment:t}=e;n(260488)._N({environment:t,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})}});const K=[(0,A().gy)({key:"user",render:e=>(0,d.jsx)(v().A,{...e}),actions:[U,I,T]}),(0,A().gy)({key:"report page actions",render:e=>(0,d.jsx)(v().A,{...e}),actions:[j,_,F]})],H=[(0,A().gy)({key:"report page actions",render:e=>(0,d.jsx)(v().A,{...e}),actions:[j,F]})];var z=()=>n(741496),W=()=>n(435009),G=()=>n(722872),Y=()=>n(494043),q=()=>n(311337),$=()=>n(578872),Q=()=>n(411671),Z=()=>n(630116),X=()=>n(452558),J=()=>n(928600),ee=()=>n(614505),te=()=>n(16006);function ne(e){let{blockStore:t,onDismiss:n,isPublicShareLink:l}=e;const c=(0,i().v3)(),{isMobile:u}=c.device,p=(0,s().K8)((()=>Q().A.getMode(c,t)),[c,t]),m=(0,s().K8)((()=>t.isFormBlock()),[t]),[g,f]=(0,o.useState)(u&&!m?"initialActions":"more"),h={environment:c,blocks:[t],publicEditMode:p,analyticsFrom:"topbar_more_menu"};let b;b=u?{menuType:G().gu.ActionSheet}:{menuType:G().gu.Popup,width:210,maxHeight:"80vh"};const w=(0,o.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=S().default.state;if(t){const n=t.getType();var o;if(n)(0,z().N)(c,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:t.id,block_type:n,is_toggleable:(0,Y().Yt)(n,t.getFormat()),collection_id:null===(o=t.getCollectionStore())||void 0===o?void 0:o.id,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}e.closeParentMenu&&n()}),[c,n]),k=(0,s().K8)((()=>{var e;if(!u)return;const n=t.getSpaceStore();if(!n)return;const o=$().GN(t),i=null==o||null===(e=o.getSiteStore())||void 0===e||null===(e=e.getHeader())||void 0===e?void 0:e.customItems;if(!i)return;return{key:"custom nav",render:e=>(0,d.jsx)(v().A,{...e}),actions:i.filter((e=>"block"===e.type)).map((e=>{const o=Z().Bv.createChildStore(n,{table:r().ev,id:e.blockId}),i=o.getIcon(),s=(0,x().Ay)({store:o,preferPublicLink:!0,pageVisitSource:a().y8.SiteCustomHeader});return{key:e.blockId,analyticsName:e.blockId,displayName:e.blockId,searchName:e.blockId,render:e=>(0,d.jsx)(y().A,{...e,left:i&&(0,d.jsx)(ee().B,{icon:i,store:t,disabled:!0,isEmptyPage:o.isEmptyPage(),size:18,emojiSize:18,disableShrinking:!0}),title:(0,d.jsx)(te().A,{store:o,maxLength:30})}),action:()=>{W().oo({environment:c,url:s})},closeParentMenu:!0}}))}}),[c,u,t]),j=(C=()=>{f("more")},(0,A().gy)({key:"page",render:e=>(0,d.jsx)(v().A,{...e}),actions:[V,N,O,D,L,M().oc,P,R,E(C)]}));var C;const I=function(e){return(0,A().gy)({key:"page",render:e=>(0,d.jsx)(v().A,{...e}),actions:[B,P,R,E(e)]})}((()=>{f("more")})),T=(0,s().K8)((()=>(0,q().y)(c)),[c]);if("initialActions"===g){const e=k?[k,j]:[j];return(0,d.jsx)(J().A,{...b,children:(0,d.jsx)(X().A,{sections:T?[I]:e,onAccept:w,context:h})})}return(0,d.jsx)(J().A,{...b,children:(0,d.jsx)(X().A,{sections:l?H:K,context:h})})}},729609:(e,t,n)=>{n.r(t),n.d(t,{AddOnUpgradeModal:()=>H,isCancellationStage:()=>ae,isConfirmPurchaseStage:()=>se,isLimitReachedStage:()=>ie});n(16280);var o=n(296540),i=()=>n(662303),s=()=>n(484714),a=()=>n(847249),r=()=>n(401497),l=()=>n(148307),d=()=>n(869190),c=()=>n(66913),u=()=>n(738418),p=()=>n(762433),m=()=>n(323063),g=()=>n(786508),f=()=>n(166386),h=()=>n(959013),y=()=>n(100622),v=()=>n(534177),b=()=>n(284371),x=()=>n(901389),S=()=>n(197190),M=()=>n(331542),A=()=>n(204063),w=()=>n(641514),k=()=>n(719147),j=()=>n(836251),C=()=>n(240865),I=()=>n(351360),T=()=>n(57605),_=()=>n(1346),P=()=>n(224701),B=()=>n(601203),R=()=>n(991249),L=n(474848);var D=()=>n(807778),O=()=>n(30858),N=()=>n(134217),E=()=>n(527059),U=()=>n(830140),F=()=>n(981046),V=()=>n(749240),K=()=>n(517492);function H(e){const{data:t}=e,n=(0,N().qc)(t),o=oe(),i=(0,a().O$)(I().AppStoreCurrentSpaceStore),r=(0,E().lh)({spaceId:null==i?void 0:i.id}),l=N().Fq(t),d=(0,s().v3)(),{isOpen:u,addOnFeature:p}=(0,a().K8)((()=>{const{state:e}=U().A;return{isOpen:e.open,addOnFeature:e.addOnFeature}}),[]);return d.device.isMobileNative?(0,L.jsx)(w().A,{innerStyle:o.innerStyle,isOpen:u,onDismiss:()=>_().qB(),render:()=>(0,L.jsx)("div",{style:o.mobileModal,children:(0,L.jsx)("div",{style:o.innerModalPadding,children:(0,L.jsx)(ne,{})})})}):(0,L.jsx)(w().A,{innerStyle:o.innerStyle,isOpen:u,onDismiss:()=>_().qB(),render:()=>(0,L.jsx)("div",{style:se()||ie()&&l&&n?o.largeModal:ae()?o.cancellationModal:o.modal,children:(0,L.jsxs)("div",{style:ae()?o.cancellationInnerModalPadding:o.innerModalPadding,children:[(0,L.jsx)(S().A,{onClick:()=>{_().qB()},style:o.cancelButton,hoveredStyle:o.hovered,children:(0,c().V)(o.closeIcon)}),ie()&&p&&(0,L.jsx)(z,{addOnFeature:p,canPurchaseAddOn:n,isSubscribed:l}),se()&&p&&(0,L.jsx)(W,{addOnFeature:p,canPurchaseAddOn:n}),ae()&&p&&(0,L.jsx)(te,{addOnFeature:p,canPurchaseAddOn:n,data:t,billingData:r})]})})})}function z(e){const{addOnFeature:t,canPurchaseAddOn:n,isSubscribed:o}=e,i=oe(),a=(0,s().v3)();return n&&o?(0,L.jsx)(W,{addOnFeature:t,canPurchaseAddOn:n}):(0,L.jsxs)(L.Fragment,{children:[(0,u().G)(i.icon),(0,L.jsx)(Y,{addOnFeature:t,canPurchaseAddOn:n}),(0,L.jsx)(q,{addOnFeature:t,canPurchaseAddOn:n}),(0,L.jsx)(A().A,{size:"lg",style:i.button,onClick:async()=>n?o?_().Hq(void 0):async function(e,t){await R().K(e,{from:"ai"===t?"ai_plans_page":"plans_page",upsell:{type:"product",product:t,limit:{type:"none"},trialability:"none"}}),_().qB()}(a,t):_().qB(),children:n?(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase"}):(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function W(e){var t;const{addOnFeature:n,canPurchaseAddOn:o}=e,i=(0,s().v3)(),r=oe(),d=(0,a().O$)(V().subscriptionDataStoreInstance),c=(0,a().K8)((()=>U().A.state.open?U().A.state.coupon:null),[]),u=(0,a().O$)(I().AppStoreCurrentSpaceStore),m=(0,E().lh)({spaceId:null==u?void 0:u.id});if(!u)return null;if(i.device.isMobileNative||(0,p().YF)(m))return null;let g;if(!d||"unsubscribed_admin"!==d.type&&"subscribed_admin"!==d.type||(g=d),(0,p().et)(m)){const e=(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return x().f1(e),null}const f=(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator."});if(!(0,N().qc)(d))return x().f1(f),null;const y=null===(t=g)||void 0===t||null===(t=t.customerData)||void 0===t?void 0:t.stripe;if(!y)return null;const b=(0,p().q8)(m)??"month",S=c?function(e){if("ai_fifty_percent"===e)return(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount"});(0,v().HB)(e)}(c):"year"===b?(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount"}):null;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("img",{src:l().A.images.pricing.aiLogoPng,style:r.aiLogo}),(0,L.jsx)(Y,{addOnFeature:n,canPurchaseAddOn:o}),(0,L.jsx)($,{addOnFeature:n}),S?G(S):null,(0,L.jsx)(Q,{addOnFeature:n,interval:b,stripeData:y,spaceStore:u,billingData:m})]})}function G(e){const t=oe();return(0,L.jsx)(S().A,{style:{...t.sharedStyleForDiscountBadge},disabled:!0,children:(0,L.jsx)("div",{style:{...t.innerStyleForDiscountBadge},children:e})})}function Y(e){const{addOnFeature:t,canPurchaseAddOn:n}=e,o=oe();let i;switch(t){case"ai":i=n?(0,L.jsx)(h().sA,{id:"subscriptionUpgradeModal.ai.addOn.title",defaultMessage:"Upgrade to unlimited AI"}):(0,L.jsx)(h().sA,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"You've used up all free AI responses in your plan"});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,v().HB)(t)}return(0,L.jsx)("h3",{style:o.title,children:i})}function q(e){const{addOnFeature:t,canPurchaseAddOn:n}=e;let o;const i=oe();switch(t){case"ai":o=n?(0,L.jsx)(h().sA,{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace"}):(0,L.jsx)(h().sA,{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use."});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,v().HB)(t)}return(0,L.jsx)("p",{style:i.paragraph,children:(0,L.jsx)("div",{style:i.text,children:o})})}function $(e){const{addOnFeature:t}=e;let n;const o=oe();if(!(0,a().O$)(I().AppStoreCurrentSpaceStore))return null;switch(t){case"ai":n=(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.description",defaultMessage:"Generate content, summarize key points, and find info across Notion and your connected apps"});break;case"sites_custom_hostnames":throw new Error("not implemented");default:(0,v().HB)(t)}return(0,L.jsx)("p",{style:o.paragraph,children:(0,L.jsx)("div",{style:o.text,children:n})})}function Q(e){const{addOnFeature:t,interval:n,stripeData:i,spaceStore:r,billingData:l}=e,d=oe(),c=(0,s().v3)(),u=(0,C().V)()??1,y=(0,p().Ry)(l)??"USD",{tax:b,coupon:x}=(0,a().K8)((()=>({tax:U().A.state.open?U().A.state.tax:0,coupon:U().A.state.open?U().A.state.coupon:void 0})),[]),S=(0,a().K8)((()=>F().A.getPrice(c,(e=>e.product===t&&e.billingInterval===n&&e.getCurrencyCode()===y))),[t,c,n,y]),w=(0,a().K8)((()=>F().A.getPrice(c,(e=>e.product===t&&"month"===e.billingInterval&&e.getCurrencyCode()===y))),[t,y,c]);if((0,o.useEffect)((()=>{!async function(){const e=x?(0,f().Pz)((0,g().Pq)(x)):void 0;if(S.result&&i&&null!=l&&l.address){const t=S.result.getCostPerBillingInterval({quantity:u,offer:e}).amount;await B().jO({environment:c,priceForTaxCalculation:t,address:l.address,customerId:(0,p().Rz)(l),vatId:i.vatId})}}()}),[c,i,S,u,x,l]),!S.isLoaded||!w.isLoaded)return(0,L.jsx)(M().A,{});if(!S.result||!w.result)return null;const I=S.result,R=x?(0,f().Pz)((0,g().Pq)(x)):void 0,O=I.getCostPerBillingInterval({quantity:u,offer:R}).withAddedAmount(b),N=w.result,E=N.getMonthlyUnitCost();let V=N.getMonthlyCost({quantity:u});"year"===n&&(V=V.withMultipliedAmount(12));const{addOnCostItem:H,addOnCostItemWithMembers:z}=function(e,t,n,o){switch(e){case"ai":return{addOnCostItem:(0,L.jsx)("div",{children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI",defaultMessage:"<bold>Notion AI</bold>",values:{bold:e=>(0,L.jsx)("b",{children:e})}})}),addOnCostItemWithMembers:(0,L.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI.memberInfo",defaultMessage:"({memberCount, plural, one {{memberCount} member} other {{memberCount} members}} x {price} per month{interval, select, month {} other { x 12 months}})",values:{memberCount:t,interval:n,price:o}})})};case"sites_custom_hostnames":throw new Error("not implemented");default:(0,v().HB)(e)}}(t,u,n,(0,L.jsx)(K().v,{cost:E.toMoneyValue(),trailingZeroDisplay:"stripIfInteger"}));return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("p",{style:d.monthlyCostText,children:[(0,L.jsx)("h3",{style:d.title,children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on"})}),(0,L.jsxs)("div",{style:d.costSectionTitle,children:[(0,L.jsx)("div",{children:H}),(0,L.jsx)("div",{style:d.rightAlign,children:(0,L.jsx)(K().v,{cost:V.toMoneyValue(),trailingZeroDisplay:"auto"})})]}),(0,L.jsx)("div",{style:d.costSection,children:z}),(0,L.jsx)(Z,{cost:I.getCostPerBillingInterval({quantity:u}),fullCost:V}),(0,L.jsx)(X,{price:I,coupon:x,quantity:u}),(0,L.jsxs)("div",{style:d.costSection,children:[(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:"}),(0,L.jsx)("div",{style:d.rightAlign,children:(0,L.jsx)(K().v,{cost:{amount:b,currencyCode:y},trailingZeroDisplay:"auto"})})]}),(0,L.jsxs)("div",{style:d.totalCostSection,children:[(0,L.jsx)("h3",{style:d.title,children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total"})}),(0,L.jsx)("div",{style:d.rightAlign,children:(0,L.jsx)("h3",{style:d.title,children:(0,L.jsx)(K().v,{cost:O.toMoneyValue(),trailingZeroDisplay:"auto"})})})]}),(0,L.jsx)("div",{style:d.perMonth,children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",values:{interval:n}})})]}),(0,L.jsx)(A().A,{size:"lg",style:d.button,onClick:async()=>{const e=await T().A.awaitData(c,{spaceId:r.id});if(!e)throw new Error("Billing data not loaded");const t=(0,p().lQ)(e),n=(0,D().Le)(),o=(0,m().vH)(t,{price:I,quantity:u},{isMay13PackagingChangesEnabled:n});await P().nV({environment:c,spaceStore:r,from:"add_on_upgrade_modal",desiredState:o,inAppOffer:x}),_().qB()},children:(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase"})}),(0,L.jsx)("p",{style:d.termsOfService,children:(0,L.jsx)("div",{style:d.text,children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",values:{br:(0,L.jsx)("br",{}),fairUsePolicies:e=>(0,L.jsx)(k().A,{href:(0,j().xS)("ai.fairUsePolicies"),children:e}),terms:e=>(0,L.jsx)(k().A,{href:(0,j().xS)("ai.terms"),children:e})}})})})]})}function Z(e){const t=oe(),{cost:n,fullCost:o}=e;if(n.amount===o.amount)return null;const i=o.minus(n),s=Math.floor(i.amount/o.amount*100);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{style:t.costSectionTitle,children:[(0,L.jsx)("div",{children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.annual.dynamicDiscountMessage",defaultMessage:"<bold>Annual discount ({discountPercent}%)</bold>",values:{bold:e=>(0,L.jsx)("b",{children:e}),discountPercent:s}})}),(0,L.jsx)("div",{style:t.greenRightAlign,children:(0,L.jsx)(K().v,{cost:i.withMultipliedAmount(-1).toMoneyValue(),trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,L.jsx)("div",{style:t.costSection,children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan"})})]})}function X(e){const t=oe(),{price:n,coupon:o,quantity:i}=e;if(!(0,f().J5)(o))return null;const s=n.getDiscountPerBillingInterval({quantity:i,coupon:o}).withMultipliedAmount(-1);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{style:t.costSectionTitle,children:[(0,L.jsx)("div",{children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",values:{bold:e=>(0,L.jsx)("b",{children:e}),percentage:(0,O().wu)(o)}})}),(0,L.jsx)("div",{style:t.greenRightAlign,children:(0,L.jsx)(K().v,{cost:s,trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,L.jsx)("div",{style:t.costSection,children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months"})})]})}function J(e){const{addOnFeature:t}=e,n=oe(),o=(0,s().v3)();return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{style:n.buttonWithTopPadding,children:(0,L.jsx)(S().A,{style:n.redButton,hoveredStyle:{background:y().Ay.redWithAlpha(.8)},onClick:async()=>{const e=(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.cancellationStage.errorMessage",defaultMessage:"Unable to cancel add-on subscription. Please try again later."}),n=I().default.state.currentSpaceStore;if(!n)return x().f1(e);const i=await T().A.awaitData(o,{spaceId:n.id});if(!i)throw new Error("Billing data not loaded");const s=(0,p().lQ)(i),a=(0,m().gL)(s,t);await P().nV({environment:o,spaceStore:n,from:"add_on_upgrade_modal",desiredState:a}),_().qB()},children:(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal"})})}),(0,L.jsx)("div",{style:n.buttonWithTopPadding,children:(0,L.jsx)(S().A,{style:n.noButton,onClick:()=>_().qB(),children:(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel"})})})]})}function ee(e){var t;const{billingData:n}=e,o=oe(),s=null==n||null===(t=n.subscription)||void 0===t||null===(t=t.currentPeriodEnd)||void 0===t?void 0:t.toMillis();return s?(0,L.jsx)("p",{style:o.paragraph,children:(0,L.jsx)("div",{style:o.text,children:(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",values:{periodEnd:(0,d().W_)(s,"long",i().locale),bold:e=>(0,L.jsx)("b",{children:e})}})})}):null}function te(e){const{addOnFeature:t,canPurchaseAddOn:n,billingData:o,data:i}=e,s=oe();if(!n)return null;let a;switch(t){case"ai":a=(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.midterm.cancellation.title.ai",defaultMessage:"Remove AI at the end of your billing period?"});break;case"sites_custom_hostnames":a=(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.midterm.cancellation.title.sites",defaultMessage:"Remove Custom domains at the end of your billing period?"});break;default:(0,v().HB)(t)}return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("h3",{style:s.cancellationTitle,children:a}),(0,L.jsx)(ee,{billingData:o}),(0,L.jsx)(J,{data:i,addOnFeature:t})]})}function ne(){const e=oe(),t=(0,s().v3)();let n=(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited."});return(t.device.isIOS||t.device.isIpad)&&(n=(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"Unlimited AI cannot be purchased on mobile."})),(0,L.jsxs)(L.Fragment,{children:[(0,u().G)(e.icon),(0,L.jsx)("h3",{style:e.title,children:(0,L.jsx)(h().sA,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"You've used up all free AI responses in your plan"})}),(0,L.jsx)("p",{style:e.paragraph,children:(0,L.jsx)("div",{style:e.text,children:n})}),(0,L.jsx)(A().A,{size:"lg",style:e.button,onClick:()=>_().qB(),children:(0,L.jsx)(h().sA,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function oe(){return(0,r().IS)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.text.secondary},costSectionTitle:{display:"flex",color:e.text.secondary},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.text.secondary,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:y().Ay.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:4,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:b().Wy.medium},closeIcon:{width:14,fill:e.text.secondary},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.text.secondary,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:4},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:4,color:e.text.primary,background:e.accentColors.gray[75],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function ie(){return re("limit_reached")}function se(){return re("confirm_purchase")}function ae(){return re("cancel_plan")}function re(e){const t=U().A.state;if(t.open)return t.stage===e}},731120:(e,t,n)=>{n.d(t,{A:()=>o});class o extends(()=>n(757695))().default{getInitialState(){return{isOpen:!1}}}},736026:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const i=new o},751348:(e,t,n)=>{n.d(t,{n:()=>s});var o=()=>n(847249),i=()=>n(303742);function s(e){return(0,o().K8)((()=>(0,i().o)(e)),[e])}},755170:(e,t,n)=>{n.d(t,{A:()=>y});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(340498),l=()=>n(284371),d=()=>n(859428),c=()=>n(115512),u=()=>n(962730),p=()=>n(665579),m=()=>n(534177),g=n(474848);const f=function(e){let{additionalStyles:t,transitionMs:o,force:i,children:s}=e;const r=(0,n(827912).j)(),l=(0,a().IS)((()=>{let e;switch(i){case"forceShow":e=1;break;case"forceHide":e=0;break;case void 0:e=r?1:0;break;default:(0,m().HB)(i)}return{hoverStyle:{opacity:e,transition:`opacity ${(0,m().O9)(o)?o:200}ms ease-in`,...t}}}),[t,i,r,o]);return(0,g.jsx)("div",{style:l.hoverStyle,children:s})};function h(e){let{icon:t,title:n,tooltip:o,hasRightElement:s,iconContainerStyle:p}=e;const m=(0,i().v3)(),f=(0,a().IS)((e=>({panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,c().ny)(m,"UISmall"),fontWeight:l().Wy.medium,color:e.text.secondary,fill:e.mediumIconColor,flexShrink:0,maxWidth:s?200:"100%"},title:{...l().RC},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:r().Ev.sm,height:r().Ev.sm,marginRight:8,marginTop:1,...p}})),[m,p,s]);return n?(0,g.jsx)(d().A,{renderTooltip:()=>o,disableTooltip:!o,placement:u().W.Top,alignment:u().C.Start,render:e=>(0,g.jsxs)("div",{style:f.panelTitleAndIcon,...e,children:[(0,g.jsx)("div",{style:f.panelIconContainer,children:t}),(0,g.jsx)("span",{style:f.title,children:n})]})}):null}const y=function(e){let{children:t,title:r,icon:l,tooltip:d,iconContainerStyle:c,panelStyle:u,headerStyle:m,rightStyle:y,actions:v,right:b,disableRightFadeIn:x,disableActionsFadeIn:S,hideWrapStyle:M,actionsGap:A,userSelectOverride:w}=e;const k=(0,i().WS)(),j=Boolean(r),C=Boolean(b),I=(0,s().uB)(void 0,n(620090).B),T=(0,s().uB)(void 0,n(1248)._),_=(0,o.useMemo)((()=>({isHoveredOnPanelStore:I,sizeStore:T})),[I,T]),P=(0,o.useCallback)((()=>I.setState(!0)),[I]),B=(0,o.useCallback)((()=>I.setState(!1)),[I]),R=(0,o.useCallback)((e=>{e.width<p().Xy?T.setState("narrow"):T.setState("wide")}),[T]),L=(0,a().IS)((e=>({tile:{userSelect:w??"none",WebkitUserSelect:w??"none"},panel:M?{}:{paddingLeft:12,paddingRight:12,...(0,p().V$)({isPhone:k,theme:e}),...u},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:n(69447).nh,marginLeft:p().Fq,...m},rightActions:{display:"flex",flexDirection:"row",alignItems:"center"},actions:{display:"flex",alignItems:"center",gap:A??6,paddingLeft:6}})),[k,M,u,m,A,w]),D=(j||C)&&(0,g.jsxs)("div",{style:L.headerContainer,children:[(0,g.jsx)(h,{title:r,icon:l,tooltip:d,hasRightElement:C,iconContainerStyle:c}),(C||v)&&(0,g.jsxs)("div",{style:L.rightActions,children:[C&&(0,g.jsx)(f,{force:x?"forceShow":void 0,additionalStyles:y,children:b}),v&&(0,g.jsx)(f,{force:S?"forceShow":void 0,additionalStyles:L.actions,children:v})]})]});return(0,g.jsx)(n(273923).R.Provider,{value:_,children:(0,g.jsxs)("div",{style:L.tile,onMouseEnter:P,onMouseLeave:B,children:[D,(0,g.jsx)(n(828634).EE,{onSizeChange:R,children:(0,g.jsx)("div",{style:L.panel,children:t})})]})})}},756710:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Se});n(296540);var o=()=>n(484714),i=()=>n(847249),s=()=>n(854150),a=()=>n(959013),r=()=>n(496603),l=()=>n(534177),d=()=>n(290625),c=()=>n(89924),u=n(474848);const p=[{key:"block in comment menu primary",render:e=>(0,u.jsx)(c().A,{...e}),actions:[n(254452).z,d().b2,d().qI]}];var m=()=>n(364811),g=()=>n(599364);const f=[{key:"page mention context menu primary",render:e=>(0,u.jsx)(c().A,{...e}),actions:[...n(668491).YO,g().oc,g().ko]}];var h=()=>n(741496),y=()=>n(901265),v=()=>n(186445),b=()=>n(476492),x=()=>n(722872),S=()=>n(836251),M=()=>n(494043),A=()=>n(857437),w=()=>n(691298),k=()=>n(696746),j=(n(581454),()=>n(933152)),C=()=>n(764781),I=()=>n(236262),T=()=>n(637433),_=()=>n(100622),P=()=>n(416726),B=()=>n(896628),R=()=>n(751156),L=()=>n(878377),D=()=>n(972435),O=()=>n(919878);const N=(0,a().YK)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),E=(0,P().fi)({key:"simple table header column",displayName:N.simpleTableHeaderColumn,label:D().A.formatMessage(N.simpleTableHeaderColumn),svg:n(696575).X,validators:[L().p2L,L().AU6(L().wFE),L().xCr,L().z5D],isEnabled:e=>Boolean(e.getFormat().table_block_row_header),action:(e,t,n)=>B().zA({stores:[t],update:{table_block_row_header:!t.getFormat().table_block_row_header},transaction:n})}),U=(0,P().fi)({key:"simple table header row",displayName:N.simpleTableHeaderRow,label:D().A.formatMessage(N.simpleTableHeaderRow),svg:n(464291).p,validators:[L().p2L,L().AU6(L().wFE),L().nRE],isEnabled:e=>{const t=e.getParentBlockStore();return!(null==t||!t.isType("table"))&&Boolean(t.getFormat().table_block_column_header)},action:(e,t,n)=>{const o=t.getParentBlockStore();null!=o&&o.isType("table")&&B().zA({stores:[o],update:{table_block_column_header:!o.getFormat().table_block_column_header},transaction:n})}}),F=(0,P().Ls)({key:"insert column left",displayName:N.simpleTableInsertColumnLeft,analyticsName:N.simpleTableInsertColumnLeft.defaultMessage,svg:n(526278).w,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,canUndo:!0,perform:e=>{O().T4({environment:t,transaction:e})}})}}),V=(0,P().Ls)({key:"insert column right",displayName:N.simpleTableInsertColumnRight,analyticsName:N.simpleTableInsertColumnRight.defaultMessage,svg:n(940563).arrowStraightRightIcon,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,canUndo:!0,perform:e=>{O().sf({environment:t,transaction:e})}})}}),K=(0,P().Fw)({key:"duplicate columns",displayName:P().AY.duplicateName,analyticsName:P().AY.duplicateName.defaultMessage,svg:C().V,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,canUndo:!0,perform:e=>{O().V0({transaction:e})}})}}),H=(0,P().Fw)({key:"delete columns",displayName:P().AY.deleteName,analyticsName:P().AY.deleteName.defaultMessage,svg:I().trashIcon,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Jt9,L().Pqm],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,canUndo:!0,perform:e=>{O().LL({environment:t,transaction:e})}})}}),z=(0,P().Ls)({key:"clear column contents",displayName:N.simpleTableClearContents,analyticsName:N.simpleTableClearContents.defaultMessage,svg:T().Y,validators:[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,canUndo:!0,perform:e=>{O()._D({environment:t,transaction:e})}}),O().wr()}}),W=(0,P().Ls)({key:"insert row above",displayName:N.simpleTableInsertRowAbove,analyticsName:N.simpleTableInsertRowAbove.defaultMessage,svg:n(112282).s,validators:[L().p2L,L().AU6(L().vEP),L().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,canUndo:!0,perform:e=>{O().pW({environment:t,transaction:e})}})}}),G=(0,P().Ls)({key:"insert row below",displayName:N.simpleTableInsertRowBelow,analyticsName:N.simpleTableInsertRowBelow.defaultMessage,svg:n(655923).v,validators:[L().p2L,L().AU6(L().vEP),L().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,canUndo:!0,perform:e=>{O().pc({environment:t,transaction:e})}})}}),Y=(0,P().Fw)({key:"duplicate rows",displayName:P().AY.duplicateName,analyticsName:P().AY.duplicateName.defaultMessage,svg:C().V,validators:[L().p2L,L().AU6(L().vEP),L().Hcy],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t,lazyDependencies:{duplicateActions:n}}=e;R().createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,canUndo:!0,perform:e=>{n&&O().n2({environment:t,transaction:e,duplicateActions:n})}})}}),q=(0,P().Fw)({key:"delete rows",displayName:P().AY.deleteName,analyticsName:P().AY.deleteName.defaultMessage,svg:I().trashIcon,validators:[L().p2L,L().AU6(L().vEP),L().ZLr,L().Hcy],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,canUndo:!0,perform:e=>{O().pf({environment:t,transaction:e})}})}}),$=(0,P().Ls)({key:"clear row contents",displayName:N.simpleTableClearContents,analyticsName:N.simpleTableClearContents.defaultMessage,svg:T().Y,validators:[L().p2L,L().AU6(L().vEP),L().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;R().createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,canUndo:!0,perform:e=>{O()._D({environment:t,transaction:e})}}),O().wr()}}),Q=[L().p2L,L().AU6(L().vEP),L().xCr,L().Pqm],Z=[L().p2L,L().AU6(L().vEP),L().Hcy];function X(e,t,o,i){const s=i||(0,n(27178).qo)(e),a=(0,P().Ls)({key:`color ${o||e}`,displayName:s,analyticsName:s.defaultMessage,fuzzySearchKeywords:(0,P().Mf)(e),validators:"column"===t?Q:Z,action:t=>{let{blocks:n,environment:o}=t;R().createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:o,canUndo:!0,perform:t=>{O().wW(o,e,t)}})},closeParentMenu:!0,render:t=>(0,u.jsx)(n(491073).Ay,{...t,color:e,overrideDisplayName:a.displayName}),nativeImageReference:t=>{let{environment:n}=t;return(0,P().Kg)(n,e,o)}});return a}const J=(0,P().gy)({key:"simple table column background color actions",title:P().AY.backgroundSection,overrideSearchTitle:P().AY.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().AQ.map((e=>X(e,"column")))]}),ee=(0,P().gy)({key:"simple table column text color actions",title:P().AY.colorSection,overrideSearchTitle:P().AY.colorSection,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().N.map((e=>X(e,"column")))]}),te=(0,P().gy)({key:"simple table row background color actions",title:P().AY.backgroundSection,overrideSearchTitle:P().AY.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().AQ.map((e=>X(e,"row")))]}),ne=(0,P().gy)({key:"simple table row text color actions",title:P().AY.colorSection,overrideSearchTitle:P().AY.colorSection,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().N.map((e=>X(e,"row")))]}),oe=(0,P().uk)({key:"set column color",displayName:P().AY.colorName,analyticsName:P().AY.colorName.defaultMessage,svg:j().M,validators:Q,subActions:()=>[{key:0,title:D().A.formatMessage(N.textColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:ee.actions},{key:1,title:D().A.formatMessage(N.backgroundColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:J.actions}]}),ie=(0,P().uk)({key:"set row color",displayName:P().AY.colorName,analyticsName:P().AY.colorName.defaultMessage,svg:j().M,validators:Z,subActions:()=>[{key:0,title:D().A.formatMessage(N.textColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:ne.actions},{key:1,title:D().A.formatMessage(N.backgroundColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:te.actions}]}),se=[(0,P().gy)({key:"column section",render:e=>(0,u.jsx)(c().A,{...e}),actions:[E,oe,F,V,K,z,H]}),(0,P().gy)({key:"row section",render:e=>(0,u.jsx)(c().A,{...e}),actions:[U,ie,W,G,Y,$,q]})];var ae=()=>n(962730),re=()=>n(377586),le=()=>n(351360),de=()=>n(407054),ce=()=>n(630116),ue=()=>n(502438),pe=()=>n(704907),me=()=>n(819493),ge=()=>n(452558),fe=()=>n(419357),he=()=>n(545805),ye=()=>n(928600),ve=()=>n(480095),be=()=>n(897119),xe=()=>n(962036);function Se(){const e=(0,o().Y0)();return e.isMobileNative&&e.isIOS&&e.isPhone?(0,u.jsx)(Me,{}):(0,u.jsx)(Ae,{})}function Me(){const e=(0,i().O$)(de().A);return(0,w().A)({shouldPreserveTextSelection:e.isActive,shouldPreserveBlockSelection:!1,shouldRestoreSelection:!0}),(0,u.jsx)(Ae,{})}function Ae(){const e=(0,o().Y0)(),t=(0,i().O$)(de().A);return(0,u.jsx)(be().Ay,{popupType:e.isPhone?re().n.BottomSheet:re().n.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Ie,placementToOrigin:ae().W.Bottom,alignmentToOrigin:ae().C.Start,originGap:0,preventScaleTransition:!0,render:()=>(0,u.jsx)(we,{}),preventBlockRenderQueueOnEnter:e.isMobile,trapFocus:!0})}function we(){var e;const t=(0,o().v3)(),n=(0,o().WS)(),c=(0,x().Tf)(),g=(0,i().O$)(de().A),v=null===(e=g.stores)||void 0===e?void 0:e[0],S=(0,i().K8)((()=>null==v?void 0:v.isCollectionView()),[v]),w=(0,i().K8)((()=>g.isActive?function(e){switch(e){case"default":return d().JS;case"simple_table":return se;case"page_mention":return f;case"sidebar_outliner":return m().LV;case"comment_media":return p;case"block_in_collection_timeline_view":return d().bH;case"block_in_collection":return d().SH;default:(0,l().HB)(e)}}(null==g?void 0:g.actionSectionGroupKey):[]),[g]),[k,j]=(0,A().$)();if(!g.isActive||!v)return null;const{originBlockRect:C,inputValue:I,publicEditMode:T}=g||{},_={environment:t,blocks:g.stores,originRect:C,publicEditMode:T,analyticsFrom:g.analyticsFrom},P=g.showInput&&(0,u.jsx)(Ce,{inputComboboxProps:k}),B=n?{menuType:x().gu.Modal,title:(0,u.jsx)(a().sA,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:c?void 0:(0,u.jsx)(ve().DoneMenuText,{}),onClickRight:c?void 0:Ie,header:P}:{menuType:x().gu.Popup,width:265,header:P};return(0,u.jsx)(he().A,{debugName:"BlockMenu",capture:!0,onBackspace:r().D_,children:(0,u.jsxs)(ye().A,{...B,children:[(0,u.jsx)(ge().A,{filter:I,context:_,sections:w,onAccept:e=>function(e,t){const n=de().A.state;if(!n.isActive)return;const{stores:o}=ue().default.state,{analyticsFrom:i,collectionContextStore:a}=n,r=o[0];if(r){const n=r.getParentTable(),o=r.getType();if(o&&n){let l;if(n===s().yK){const e=r.getParentId(),{currentSpaceStore:t}=le().default.getState();t&&void 0!==e&&(l=ce().h4.createChildStore(t,{table:s().yK,id:e}))}const d=(0,b().sl)(a)||{};(0,h().N)(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:i,block_id:r.id,block_type:o,parentTeamStore:l,is_toggleable:(0,M().Yt)(o,r.getFormat()),parent_collection_id:r.getParentCollectionIdUpToTwoLevels(),...d})}}e.closeParentMenu&&y().VN()}(e,t),initialFocus:I?0:void 0,comboboxProps:g.showInput?j:void 0,shouldShowBlockTypeTitle:!0}),!I&&(0,u.jsx)(je,{}),!I&&(0,u.jsx)(pe().A,{store:v}),!I&&S&&(0,u.jsx)(ke,{})]})})}function ke(){const[e,t]=(0,i().K8)((()=>{const e=de().A.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,v().sj)(t.id)]}),[]);return e?t?(0,u.jsx)(c().A,{topBorder:!0,children:(0,u.jsx)(xe().A,{title:(0,u.jsx)(a().sA,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:k().hI,analyticsFrom:"block_menu"})}):(0,u.jsx)(c().A,{topBorder:!0,children:(0,u.jsx)(xe().A,{title:(0,u.jsx)(a().sA,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,S().xS)("guides.database"),analyticsFrom:"block_menu"})}):null}function je(){const e=(0,o().v3)(),t=(0,i().O$)(de().A),n=(0,i().K8)((()=>e.currentUser.isLoggedIn()),[e]),s=(0,i().K8)((()=>t.isActive&&1===t.stores.length&&(0,v().sj)(t.stores[0].id)),[t]);return n?!t.isActive||t.stores.length>1||s?null:(0,u.jsx)(me().$,{store:t.stores[0],isPageMoreButton:!1}):null}function Ce(e){const t=(0,a().tz)(),n=(0,o().WS)(),s=(0,i().O$)(de().A);if(!s.isActive||n)return null;const{inputValue:r}=s;return(0,u.jsx)(c().A,{isInput:!0,children:(0,u.jsx)(fe().Ay,{value:r,onChange:Te,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,...e.inputComboboxProps})})}function Ie(){y().VN()}function Te(e){de().A.state.isActive&&de().A.setState({...de().A.state,inputValue:e.target.value})}},761660:(e,t,n)=>{n.d(t,{J:()=>Y});n(16280),n(581454);var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(728396),l=()=>n(251822),d=()=>n(145214),c=()=>n(439264),u=()=>n(218557),p=()=>n(953418),m=()=>n(170253),g=()=>n(978846),f=()=>n(970176),h=()=>n(316397),y=()=>n(933951),v=(n(18107),n(967357),n(898992),n(354520),()=>n(72645)),b=()=>n(155185),x=()=>n(959013),S=()=>n(285790),M=()=>n(859428),A=()=>n(38337),w=()=>n(104129),k=()=>n(962730),j=()=>n(160241),C=()=>n(3197),I=()=>n(937199),T=n(474848);const _=(0,x().YK)({formLayoutAddModule:{id:"addModuleHoverMenu.formLayout.add",defaultMessage:"Add question"},pageLayoutAddModule:{id:"addModuleHoverMenu.pageLayout.add",defaultMessage:"Add"}}),P=32;function B(e){if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");const t=(0,x().tz)(),{layoutStore:n,addModuleHoverMenuStore:o,currentModuleSelection:i}=(0,I().LH)(),r=(0,s().K8)((()=>{if(o.state.isOpen)return o.state.moduleId}),[o]),l=(0,s().K8)((()=>{if(!r)return;const e=w().A.findModuleContainer({layoutStore:n,moduleId:r});return e?e.getNode():void 0}),[r,n]),c=(0,s().K8)((()=>{if(!i||"new_module"===i.type)return!1;const e=n.getModuleById(i.moduleId);return"placeholder"===(null==e?void 0:e.type)}),[i,n]),u=(0,s().K8)((()=>{var t;if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");if("form_conditional_modules"===e.area)return!1;const i=n.getModules()[e.area].filter((e=>(0,b()._)(e))),s=0===i.length||(null===(t=i.at(-1))||void 0===t?void 0:t.id)===r;return o.state.isOpen&&!c&&!s}),[o,r,c,n,e.area]),p=(0,C().t)({area:e.area,afterModuleId:r}),m=(0,j().d)(),g=(0,a().IS)((e=>({bigRoundButton:{...m.button,width:P,height:P,borderTopLeftRadius:"100%",borderTopRightRadius:"100%",borderBottomLeftRadius:"100%",transform:"rotate(-45deg)"},bigRoundButtonHovered:{...m.buttonHovered},bigRoundButtonPressed:{...m.buttonPressed}})),[m]),f="form"===(0,s().K8)((()=>{var e;return null===(e=n.getModel())||void 0===e?void 0:e.getLayoutType()}),[n])?t.formatMessage(_.formLayoutAddModule):t.formatMessage(_.pageLayoutAddModule),h=l?l.offsetLeft-40:void 0,y=l?l.offsetTop+l.offsetHeight-4:void 0;return void 0===h||void 0===y?null:(0,T.jsx)(d().A,{visible:u,animate:{opacity:1,scale:1,transformOrigin:"center right"},initial:{opacity:0,scale:.3,transformOrigin:"center right"},exit:{opacity:0,scale:.3,transformOrigin:"center right"},style:{position:"absolute",left:h,top:y},children:(0,T.jsx)(M().A,{placement:k().W.Left,renderTooltip:()=>f,render:e=>(0,T.jsx)(S().A,{...e,style:g.bigRoundButton,hoveredStyle:g.bigRoundButtonHovered,className:A().kew,pressedStyle:g.bigRoundButtonPressed,onClick:p,icon:v().b,iconStyle:{width:16,height:16,transform:"rotate(45deg)"},isBlue:!0,ariaLabel:f})})})}var R=()=>n(21140),L=()=>n(612900),D=()=>n(645873);const O={BuilderAddModuleButtonEducationTooltip:new(D().O2)("BuilderAddModuleButtonEducationTooltip",(()=>n.e(63538).then(n.bind(n,889989))))},N=(0,D()._h)(O.BuilderAddModuleButtonEducationTooltip,(e=>e.default));var E=()=>n(817942);const U=(0,x().YK)({addPageModule:{id:"pageLayout.builder.addModuleToPage.button.ariaLabel",defaultMessage:"Add page module"},addQuestionModuleTooltip:{id:"pageLayout.builder.addModuleToPage.button.addQuestionModuleTooltip",defaultMessage:"Add question"},addModuleToPanelButton:{id:"pageLayout.builder.addModuleToPanel.button.label",defaultMessage:"Add to panel"}}),F=o.forwardRef((function(e,t){const{area:o}=e,{layoutStore:i}=(0,I().LH)(),r=(0,s().K8)((()=>i.getLayoutType()),[i]),l=(0,x().tz)(),d=(0,j().d)(),c=(0,a().IS)((e=>({bigRoundButton:{...d.button,width:32,height:32,borderRadius:"100%"},bigRoundButtonHovered:{...d.buttonHovered},bigRoundButtonPressed:{...d.buttonPressed},emptyModuleAreaAddButton:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 16px 8px 12px",fontSize:14,lineHeight:"20px",fontWeight:500,background:"light"===e.mode?e.accentColors.uiBlue[100]:e.accentColors.uiBlue[200],color:e.accentColors.uiBlue[600],borderRadius:28,transition:"background 0.2s"},emptyModuleAreaAddButtonHover:{...d.buttonHovered},emptyModuleAreaAddButtonPressed:{...d.buttonPressed}})),[d]),u=(0,C().t)("views_main_tab_modules"===o?{area:o,viewsMainTabId:e.viewsMainTabId}:{area:o});if("form_conditional_modules"===o)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const p=(0,s().K8)((()=>{var t;const n=i.getModules();return("views_main_tab_modules"===o?(null===(t=n[o])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[o]).length>0}),[i,o,e.viewsMainTabId]);return"page_details"!==o||p?(0,T.jsx)(M().A,{renderTooltip:()=>l.formatMessage(U.addQuestionModuleTooltip),disableTooltip:"form"!==r,placement:k().W.Bottom,render:e=>(0,T.jsx)(S().A,{style:c.bigRoundButton,hoveredStyle:c.bigRoundButtonHovered,pressedStyle:c.bigRoundButtonPressed,onClick:u,icon:v().b,iconStyle:{width:16,height:16},isBlue:!0,className:A().kew,ariaLabel:l.formatMessage(U.addPageModule),ref:t,...e})}):(0,T.jsxs)(n(197190).A,{style:c.emptyModuleAreaAddButton,onClick:u,hoveredStyle:c.emptyModuleAreaAddButtonHover,pressedStyle:c.emptyModuleAreaAddButtonPressed,ref:t,children:[(0,n(464699).b)({width:12,marginRight:4}),(0,T.jsx)(x().sA,{...U.addModuleToPanelButton})]})})),V=o.memo((function(e){var t;const{shouldShowTooltip:i}=(0,n(384130).J)(),{area:a}=e,r=i&&"page_main"===a,l=i&&"form_layout_schema"!==a,d=o.useRef(null),{currentModuleSelection:c,layoutStore:u,setModuleSelection:p,isPropertyTypeSearchInputDirtyStore:m}=(0,I().LH)(),g=(0,s().K8)((()=>"existing_module"===(null==c?void 0:c.type)?u.getModuleById(c.moduleId):void 0),[c,u]),f=(0,s().K8)((()=>{var t;if("form_conditional_modules"===a)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const n=u.getModules();return("views_main_tab_modules"===a?(null===(t=n[a])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[a]).length>0}),[u,a,e.viewsMainTabId]),[h,y]=o.useState(!1),v=o.useCallback((()=>{m.state||p(void 0)}),[m,p]);return"new_module"===(null==c?void 0:c.type)&&c.area===e.area?(0,T.jsx)(n(545805).A,{onUndo:v,capture:!0,priority:1,debugName:"AddPageLayoutModuleButton",children:(0,T.jsx)(K,{})}):"placeholder"===(null==g?void 0:g.type)?null:r||l?(0,T.jsxs)(R().Ye,{justifyContent:"center",style:null===(b=e.styles)||void 0===b?void 0:b.buttonContainer,className:E().hg,children:[(0,T.jsx)(L().u,{shape:"page_main"===e.area?"circle":"pill",size:"page_main"===e.area||f?32:34,onDependencyLoaded:()=>y(!0),children:(0,T.jsx)(F,{isEducationCalloutVisible:r,...e,ref:d})}),r&&h&&(0,T.jsx)(N,{buttonRef:d})]}):(0,T.jsx)(R().Ye,{justifyContent:"center",style:null===(t=e.styles)||void 0===t?void 0:t.buttonContainer,className:E().hg,children:(0,T.jsx)(F,{isEducationCalloutVisible:!1,ref:d,...e})});var b}));function K(){const e=(0,a().IS)((e=>({ghostPageModuleContainer:{paddingBottom:12},ghostPageModule:{width:"100%",height:160,background:e.accentColors.uiBlue[75],borderRadius:12,boxShadow:`0px 0px 0px 0px ${e.stroke.uiBlueSecondary}, inset 0px 0px 0px 1px ${e.stroke.uiBlueSecondary}`}})),[]);return(0,T.jsx)("div",{style:e.ghostPageModuleContainer,className:E().hg,children:(0,T.jsx)(L().u,{shape:"square",borderRadius:e.ghostPageModule.borderRadius,width:e.ghostPageModule.width,height:e.ghostPageModule.height,children:(0,T.jsx)("div",{style:e.ghostPageModule})})})}var H=()=>n(496603);const z=12;function W(){const{addModuleHoverMenuStore:e}=(0,I().LH)(),t=(0,h().z)(),n=(0,o.useCallback)((n=>{const o=w().A.getMembersByDOMOrder({filter:e=>"cover"!==e.moduleType&&"form_conditional_modules"!==e.area});let i=null;for(const e of o){const o=e.getNode();if(!o)continue;const s=o.getBoundingClientRect();if(n.clientX>s.right||n.clientX<s.left&&s.left-n.clientX>300)continue;if(n.clientY<=s.bottom&&s.bottom-n.clientY<z||n.clientY>s.bottom&&n.clientY-s.bottom<z+t){i=e;break}}if(i)e.setState({isOpen:!0,moduleId:i.moduleId,menuIsOpen:!1});else{const t=e.getState();t.isOpen&&!t.menuIsOpen&&e.setState({isOpen:!1})}}),[e,t]),i=H().nF(n,30);return(0,o.useEffect)((()=>(window.addEventListener("mousemove",i),()=>{window.removeEventListener("mousemove",i)})),[i]),null}var G=()=>n(940186);function Y(e){const{area:t}=e;if("form_conditional_modules"===t)throw new Error("[Forms Conditional Logic] Can't render builder layout modules for nested form_conditional_modules directly.");const n=(0,i().v3)(),{sessionId:v,layoutStore:b,currentModuleSelection:x,setModuleSelection:S,canEditLayout:M,layoutBuilderModuleSelectionStore:A}=(0,I().LH)(),w=(0,o.useRef)(null),k=(0,y().ub)({layoutStore:b,pageStoreId:void 0}),j=(0,s().K8)((()=>b.isTabbedPageLayout()),[b]),C=(0,h().z)(),{nonMoveableHeaderModules:_,moveableModules:P,nonMoveableFooterModules:R}=(0,s().K8)((()=>{var n;const o="views_main_tab_modules"===t?(null===(n=k[t])||void 0===n?void 0:n[null==e?void 0:e.viewsMainTabId])||[]:k[t];return(0,l().jS)(t,o)}),[t,k,null==e?void 0:e.viewsMainTabId]),L=(0,s().K8)((()=>{const e=A.state;if(null!=e&&e.isDragging){const n=e.draggingModuleInitialArea,o=e.draggingModuleFinalArea;return{isDraggingIntoThisArea:n.area!==t&&o.area===t,isDraggingFromThisAreaToOtherArea:n.area===t&&o.area!==t,isDraggingAnyModuleList:!0,dragArea:o}}return{isDraggingIntoThisArea:!1,isDraggingFromThisAreaToOtherArea:!1,isDraggingAnyModuleList:!1,dragArea:void 0}}),[t,A]),D=P.map((e=>"form_layout_schema"===t?{key:e.id,draggable:"placeholder"!==e.type}:{key:e.id,draggable:!0})),O=(0,o.useMemo)((()=>new(m().A)),[]),N=(0,s().K8)((()=>O.state.isDragging),[O]),U=(0,s().K8)((()=>{var e;return null===(e=b.getModel())||void 0===e?void 0:e.getLayoutType()}),[b]);(0,o.useEffect)((()=>{w.current&&L.isDraggingIntoThisArea&&(0,p().$v)({element:w.current,environment:n,additionalPadding:{top:200,bottom:200}})}),[L.isDraggingIntoThisArea,n]);const F=(0,o.useCallback)((n=>{const o="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:t};S({type:"existing_module",moduleId:n,isDragging:!0,draggingModuleInitialArea:o,draggingModuleFinalArea:o})}),[t,e.viewsMainTabId,S]),K=(0,o.useCallback)((e=>{e&&S({type:"existing_module",moduleId:e,isDragging:!1})}),[S]),H=(0,o.useCallback)((()=>{const e=A.state,t=b.getLayoutType();t&&(0,r().Hc)(t)?S(void 0):null!=e&&e.isDragging&&A.setState({...e,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0})}),[A,S,b]),z=(0,o.useCallback)((e=>{const o=A.state,i=null!=o&&o.isDragging?o.draggingModuleFinalArea:void 0;"form_conditional_modules"!==(null==i?void 0:i.area)&&(null!=e&&e.key&&i&&i.area!==t&&((0,g().E)({environment:n,position:{type:"area_relative",location:"end_moveable",..."views_main_tab_modules"===i.area?{area:i.area,viewId:i.viewsMainTabId}:{area:i.area}},moduleId:e.key,layoutStore:b,sessionId:v}),(0,f().z)({moduleId:e.key,layoutStore:b,environment:n})),H())}),[A,t,H,n,b,v]),Y=(0,o.useCallback)((o=>{let{key:i,endPosition:s,startPosition:a}=o;if(L.isDraggingFromThisAreaToOtherArea)return;const r=_.length,l="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewId:e.viewsMainTabId}:{area:t};(0,g().E)({environment:n,layoutStore:b,position:{type:"absolute",index:r+s,...l},moduleId:i,sessionId:v}),(0,f().z)({moduleId:i,layoutStore:b,environment:n})}),[L.isDraggingFromThisAreaToOtherArea,_.length,t,e.viewsMainTabId,n,b,v]),q=(0,a().IS)((e=>({draggableList:{display:"flex",flexDirection:"column",gap:C,marginBottom:C},addButtonContainer:{paddingTop:"page_in_collection"===U?8:0,marginBottom:"form"===U?0:12,width:"100%"},dropzoneHalo:{background:u().to,height:u().NZ,marginTop:-u().NZ},hiddenModuleStyle:{display:"none"}})),[C,U]),$=(0,o.useCallback)((e=>{const n="existing_module"===(null==x?void 0:x.type)&&x.moduleId===e,o=n&&N;return(0,T.jsx)(G().n,{active:n,pageModuleId:e,isDragging:o,area:t,style:o&&L.isDraggingFromThisAreaToOtherArea?q.hiddenModuleStyle:void 0},e)}),[L.isDraggingFromThisAreaToOtherArea,x,N,q.hiddenModuleStyle,t]),Q=(0,o.useMemo)((()=>_.length?_.map((e=>$(e.id))):null),[_,$]),Z=(0,o.useMemo)((()=>R.length?R.map((e=>$(e.id))):null),[R,$]),X=(0,o.useMemo)((()=>({enter:{opacity:0},animate:{opacity:1},exit:{opacity:0}})),[]),J=(0,o.useMemo)((()=>({buttonContainer:q.addButtonContainer})),[q.addButtonContainer]);if(!b)return null;let ee;return ee=!!M&&(!j||("views_main_tab_modules"===t||"page_details"===t)),(0,T.jsxs)(T.Fragment,{children:[Q,Boolean(D.length)&&(0,T.jsx)(c().Ay,{forceDragKeyIndex:L.isDraggingFromThisAreaToOtherArea?D.length-1:void 0,className:E().hg,store:O,keys:D,direction:"vertical",onDraggingKeyChanged:F,onDrop:(e,t)=>{Y(t)},onDragCancel:H,onDragEnd:z,onClick:K,style:q.draggableList,draggingStyle:{display:void 0},draggingStyleForNonDraggedItems:{display:void 0},renderKey:$,disabled:!M,...j?{}:{hoverCursorStyleOverride:L.isDraggingAnyModuleList?"grabbing":void 0}}),(0,T.jsx)(d().A,{visible:L.isDraggingIntoThisArea,initial:X.enter,animate:X.animate,exit:X.exit,skip:!L.isDraggingAnyModuleList,className:"layout-content",ref:w,style:q.dropzoneHalo}),ee&&(0,T.jsx)(V,{...e,styles:J}),"form"===U&&M&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(W,{}),(0,T.jsx)(B,{area:t})]}),Z]})}},766676:(e,t,n)=>{n.d(t,{C:()=>f});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(543906),r=()=>n(297872),l=()=>n(676007),d=()=>n(404141),c=()=>n(628315),u=()=>n(51367),p=()=>n(131448),m=()=>n(196163),g=n(474848);function f(e){const{message:t}=e,n=(0,i().v3)(),f=(0,s().K8)((()=>!d().A.state.open&&!n.device.isMobile),[n]),h=(0,s().K8)((()=>f&&p().default.isVisible(t.key)),[t,f]);(0,a().A)((()=>{u().DL(n,{callout_key:t.key,placement_key:"Modal"})}),h);const y=(0,o.useCallback)((()=>{u().Sq(n,{callout_key:t.key,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),c().OX(n,t)}),[n,t]),v=(0,o.useCallback)(((e,o)=>()=>{u().Y5(n,{callout_key:t.key,click_type:e,placement_key:"Modal"}),null==o||o()}),[n,t]);let b;var x;e.primary&&(b={...e.primary,onClick:v("primary_cta",null===(x=e.primary)||void 0===x?void 0:x.onClick)});let S;var M;e.secondary&&(S={...e.secondary,onClick:v("secondary_cta",null===(M=e.secondary)||void 0===M?void 0:M.onClick)});let A;var w;e.link&&(A={...e.link,onClick:v("learn_more",null===(w=e.link)||void 0===w?void 0:w.onClick)});return h?(0,g.jsx)(l().A,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:y,render:()=>(0,g.jsx)(r().A,{capture:!0,allowEsc:!0,render:()=>(0,g.jsx)(m().T,{...e,onDismiss:y,primary:b,secondary:S,link:A})})}):null}},775812:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var o=()=>n(496603),i=()=>n(383594),s=()=>n(962730),a=()=>n(377586),r=n(474848);const l=function(){const{isMobile:e,isTablet:t}=(0,n(484714).Y0)(),i=(0,n(847249).O$)(n(969141).A),l=(0,n(963589).X)("mobile_icon_picker_bottom_sheet");return(0,r.jsx)(n(897119).Ay,{popupType:e?l?a().n.BottomSheet:a().n.SlideUp:a().n.Popup,bottomSheetInitialState:t?"full":"half",open:i.isActive,originRect:i.isActive?i.originRect:void 0,originGap:i.isActive?i.originGap:void 0,placementToOrigin:s().W.Bottom,alignmentToOrigin:s().C.Center,preventScaleTransition:!0,onDismiss:d,render:()=>{if(i.isActive)return(0,r.jsx)(n(545805).A,{debugName:"MediaMenu",capture:!0,onUp:o().D_,onDown:o().D_,children:(0,r.jsx)(n(126090).Ay,{...i,onCancel:d})})},trapFocus:!0})};function d(){i().I()}},782473:(e,t,n)=>{n.d(t,{Nu:()=>a,Sw:()=>o,gO:()=>i,j$:()=>s});const o=220,i=24,s=-7,a=-3},788941:(e,t,n)=>{n.d(t,{b:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("pinFilled",{viewBox:"0 0 13 19",svg:(0,o.jsx)("path",{d:"M.102 11.773c0 .665.445 1.102 1.148 1.102h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.39-3.515-4.187L8.46 4c1.14-.648 2.078-1.383 2.484-1.906.203-.266.305-.531.305-.766 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .234.093.5.297.766.406.523 1.343 1.258 2.484 1.906l-.258 3.586C1.422 8.383.102 10.125.102 11.773z"})})},794831:(e,t,n)=>{n.r(t),n.d(t,{GenerateSocialMediaPreviewImageWrapper:()=>u});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(919709),r=()=>n(496603),l=()=>n(6027),d=()=>n(508496),c=()=>n(24157);function u(e){const{store:t}=e;return function(e){const t=(0,i().v3)(),[n,u]=(0,o.useState)("uninitialized"),[p,m,g,f,h]=(0,s().K8)((()=>{var n,o;return e.pathIsDead()||"on"!==d().default.getEligibleGroup({experimentId:"dynamic_social_preview_image",defaultGroup:"unassigned"})||e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:t.currentUser.id})?[!1]:[e.isReady(),a().q4_(e.getTitleValue()),null===(n=e.getIcon())||void 0===n?void 0:n.icon,null===(o=e.getCover())||void 0===o?void 0:o.cover,e.getFormat().page_font]}),[t.currentUser.id,e]);(0,o.useEffect)((()=>{"storeReady"===n?u("generateImage"):p&&u("storeReady")}),[p,m,g,f,h]);const y=(0,o.useMemo)((()=>(0,r().sg)((()=>{u("storeReady"),l().F({environment:t,store:e})}),5e3)),[t,e]);(0,s().K8)((()=>{"generateImage"===n&&(c().default.state,y())}),[n,y])}(t),null}},807926:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const i=new o},816013:(e,t,n)=>{n.d(t,{r:()=>o});const o=n(757695).default.createValue({showConvertTooltip:!1,forceShow:!1},{name:"WikiPromoStore"})},819493:(e,t,n)=>{n.d(t,{$:()=>M,b:()=>A});n(898992),n(908872),n(296540);var o=()=>n(662303),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(764880),l=()=>n(869190),d=()=>n(959013),c=()=>n(777092),u=()=>n(921855),p=()=>n(972435),m=()=>n(963589),g=()=>n(962730),f=()=>n(706965),h=()=>n(678553),y=()=>n(89924),v=()=>n(859428),b=()=>n(125565),x=()=>n(715011),S=n(474848);function M(e){let{isPageMoreButton:t,hideTopBorder:n,store:o,wordCountStores:l,showWordCount:c}=e;const u=(0,s().K8)((()=>A(o)),[o]),{device:m}=(0,i().v3)(),M=(0,s().K8)((()=>m.isPhone),[m]),k=p().A.getIntl(),j=(0,a().IS)((()=>({menuItem:{paddingTop:M?8:n?0:6,paddingBottom:M?8:16}})),[n,M]);return u&&!u.canAccess?null:(0,S.jsx)(y().A,{topBorder:!t&&!n,style:{paddingTop:t?0:8,paddingBottom:t?0:8},children:(0,S.jsx)(h().Ay,{style:u?void 0:j.menuItem,shouldWrapTitle:!0,title:u?(0,S.jsx)(v().A,{placement:g().W.Right,render:e=>(0,S.jsxs)("div",{...e,children:[c&&(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:m.isPhone,isMultiline:!0,style:{marginBottom:4,marginTop:8},children:(0,S.jsx)(d().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,S.jsx)(x().A,{store:o})}})}),l&&(0,S.jsx)(w,{stores:l}),(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:m.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,S.jsx)(d().sA,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:u.lastEditedBy.asActor?(0,r().lR)(k,u.lastEditedBy):void 0}})}),(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:m.isPhone,style:{marginBottom:c?8:0},children:u.lastEditedTime})]}),renderTooltip:()=>(0,S.jsx)(f().A,{store:o,compactFormat:!0})}):void 0,loading:!u})})}function A(e){const t=e.getCreatedByPointer(),n=e.getCreatedTime(),i=e.getLastEditedByPointer(),s=e.getLastEditedTime(),a=p().A.getIntl();if(!e.canRead())return{canAccess:!1};if(t&&n&&s&&i){const r=(0,c().vt)({parentStore:e,pointer:t}),d=(0,l().jE)(n,o().locale,a),u=(0,c().vt)({parentStore:e,pointer:i}),p=(0,l().jE)(s,o().locale,a);if(!u)return;return{canAccess:!0,createdBy:r,createdTime:d,lastEditedBy:u,lastEditedTime:p}}}function w(e){const{stores:t}=e,n=(0,m().X)("selectable_word_count"),o=(0,s().K8)((()=>n?k(t):0),[n,t]);return n?(0,S.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,style:{marginBottom:4},children:(0,S.jsx)(d().sA,{id:"blockMetadataMenuItem.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:o}})}):null}function k(e){return e.reduce(((e,t)=>{const n=(0,u().r4)(t.getTitleValue(),t);return e+(0,u().sQ)(n)+k(t.getContentStores())}),0)}},840071:(e,t,n)=>{n.d(t,{L:()=>r});n(296540);var o=()=>n(84817),i=()=>n(577466),s=()=>n(434663),a=n(474848);function r(e){let{backgroundColor:t,children:n,...r}=e;const l=(0,i().B)(t),d={wrapper:{...l.wrapper,background:t?l.wrapper.background:"initial",height:"100%",padding:"20px 12px"}};return(0,a.jsx)(o().Y1,{style:d.wrapper,align:"center",children:(0,a.jsx)(s().r,{...r,direction:"vertical",overrideSize:()=>48,children:n})})}},843518:(e,t,n)=>{n.d(t,{F:()=>d});n(296540);var o=()=>n(484714),i=()=>n(401497),s=()=>n(175947),a=()=>n(277201),r=()=>n(38337),l=n(474848);function d(e){let{}=e;const{isElectronMac:t}=(0,o().Y0)(),n=function(e){return(0,i().IS)((t=>({container:{display:"flex",justifyContent:"flex-end",alignItems:"center",paddingRight:10,height:(0,s().ek)(e)},unexpand:{borderRadius:4,width:28,height:28},hoveredUnexpand:{fill:t.text.primary,background:t.sidebarItemSelectedBackground}})),[e])}(t);return(0,l.jsx)("div",{style:n.container,className:r().sbV,children:(0,l.jsx)("div",{className:r().qGl,children:(0,l.jsx)(a().I,{style:n.unexpand,hoveredStyle:n.hoveredUnexpand})})})}},848392:(e,t,n)=>{n.d(t,{M:()=>s});n(296540);var o=n(474848);const i={viewBox:"0 0 20 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M8.5 9.31a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"}),(0,o.jsx)("path",{d:"M2.375 6.25c0-1.174.951-2.125 2.125-2.125h11c1.174 0 2.125.951 2.125 2.125v7.5a2.125 2.125 0 0 1-2.125 2.125h-11a2.125 2.125 0 0 1-2.125-2.125zM4.5 5.375a.875.875 0 0 0-.875.875v5.491l1.996-1.995a.625.625 0 0 1 .883 0l1.98 1.98 4.137-4.137a.625.625 0 0 1 .883 0l2.871 2.87V6.25a.875.875 0 0 0-.875-.875zm11.875 6.852-3.312-3.312-4.137 4.136a.625.625 0 0 1-.884 0l-1.98-1.98-2.437 2.438v.241c0 .483.392.875.875.875h11a.875.875 0 0 0 .875-.875z"})]})},s=(0,n(340498).wt)("photo",i)},853306:(e,t,n)=>{n.d(t,{A:()=>M});n(581454);var o=n(296540),i=()=>n(662303),s=()=>n(847249),a=()=>n(401497),r=()=>n(66913),l=()=>n(284371),d=()=>n(115512),c=()=>n(141333),u=()=>n(265665),p=()=>n(484595),m=()=>n(704152),g=()=>n(864943),f=()=>n(204063),h=()=>n(125565),y=n(474848);const v=20;function b(e){var t;let{icon:r,iconStyle:u,title:p,subtitle:m,confirmText:b,confirmTextStyle:M="blue",confirmTextPerRadioOption:A,cancelText:w,radioOptions:k,defaultSelectedRadioOption:j,onDismiss:C,onSelectRadio:I,onConfirm:T,width:_,footer:P}=e;const B=(0,n(484714).v3)(),[R,L]=(0,o.useState)(j??(null===(t=k[0])||void 0===t?void 0:t.key)),D=(0,s().uB)(void 0,n(17090).A),O=(0,s().K8)((()=>null==D?void 0:D.state.elementRef),[D]),N=(0,c().CR)(O),E=(0,c().yE)(O),U=(0,c().o7)(O),F=E>0,V=Math.ceil(E+U)<Math.floor(N),K=(0,o.useCallback)((e=>{e!==R&&(L(e),null==I||I(e))}),[I,R]),H=(0,o.useCallback)((()=>{T(R)}),[T,R]),z=(0,a().IS)((e=>{const t={marginLeft:-20,marginRight:-20,height:1,borderTop:`1px solid ${e.regularDividerColor}`,transition:"opacity 200ms"};return{container:{display:"flex",position:"relative",flexDirection:"column",justifyContent:"center",overflow:"hidden",width:`min(${_??400}px, calc(100vw - 40px))`,maxHeight:"80vh",padding:v,borderRadius:6,alignItems:"stretch"},icon:{width:36,height:36,fill:e.icon.secondary,marginBottom:6,...u},iconContainer:{width:"100%",display:"flex",justifyContent:"center"},title:{fontFamily:l().vc(i().locale).sans,fontSize:17,lineHeight:"22px",fontWeight:l().Wy.medium,textAlign:"center",marginBottom:14},subtitle:{fontFamily:l().vc(i().locale).sans,fontSize:(0,d().ny)(B,"UIRegular"),lineHeight:(0,d().ks)(B,"UIRegular"),fontWeight:l().Wy.regular,marginTop:6,marginBottom:6,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column",gap:8},topDivider:{...t,opacity:F?1:0},bottomDivider:{...t,opacity:V?1:0},scroller:{marginLeft:-20,marginRight:-20,paddingLeft:v,paddingRight:v},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{marginTop:8,justifyContent:"center"},dismissButton:{position:"absolute",top:10,right:10,zIndex:1}}}),[B,u,V,F,_]),W=(null==A?void 0:A[R])??b;return(0,y.jsxs)("div",{style:z.container,children:[(0,y.jsx)("div",{style:z.dismissButton,children:(0,y.jsx)(x,{onClick:C})}),r&&(0,y.jsx)("div",{style:z.iconContainer,children:r(z.icon)}),(0,y.jsx)(h().A,{isMultiline:!0,style:z.title,children:p}),m&&(0,y.jsx)(h().A,{isSmall:!0,style:z.subtitle,isMultiline:!0,children:m}),k.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{style:z.topDivider}),(0,y.jsx)(n(2143).H,{type:n(756279).A.Y,style:z.scroller,store:D,children:(0,y.jsx)("div",{style:z.radioContainer,children:k.map((e=>(0,y.jsx)(S,{radioItem:e,isSelected:e.key===R,onSelectRadio:K},e.key)))})}),(0,y.jsx)("div",{style:z.bottomDivider})]}),(0,y.jsxs)("div",{style:z.actionButtonsContainer,children:["blue"===M?(0,y.jsx)(f().A,{size:"lg",onClick:H,children:W}):"red"===M?(0,y.jsx)(f().A,{size:"lg",onClick:H,isRed:!0,children:W}):(0,y.jsx)(g().A,{size:"lg",onClick:H,children:W}),(0,y.jsx)(g().A,{size:"lg",onClick:C,style:z.cancelButton,children:w??(0,y.jsx)(n(959013).sA,{id:"radioModal.cancel",defaultMessage:"Cancel"})})]}),P]})}function x(e){let{onClick:t}=e;const n=(0,a().IS)((e=>({button:{display:"flex",justifyContent:"center",alignItems:"center",width:24,height:24,borderRadius:"100%",background:e.lightGrayButtonBackground},buttonHovered:{background:e.lightGrayButtonHoveredBackground},buttonPressed:{background:e.lightGrayButtonPressedBackground},closeIcon:{width:16,height:16,fill:e.icon.secondary}})),[]);return(0,y.jsx)(m().A,{style:n.button,hoveredStyle:n.buttonHovered,pressedStyle:n.buttonPressed,onClick:t,children:(0,r().V)(n.closeIcon)})}function S(e){let{radioItem:t,isSelected:n,onSelectRadio:o}=e;const i=(0,a().IS)((e=>({button:{display:"flex",justifyContent:"space-between",gap:10,height:"auto",minHeight:70,borderRadius:8,paddingTop:12,paddingBottom:12,paddingLeft:14,paddingRight:14-p().p,border:void 0,boxShadow:n?`inset 0 0 0 1px ${e.icon.uiBluePrimary}`:`inset 0 0 0 1px ${e.stroke.primary}`},buttonText:{display:"flex",flexDirection:"column",gap:2,...l().RC},optionTitle:{fontWeight:l().Wy.medium},optionSubtitle:{whiteSpace:"break-spaces"}})),[n]);return(0,y.jsxs)(g().A,{size:"lg",onClick:()=>o(t.key),style:i.button,children:[(0,y.jsxs)("div",{style:i.buttonText,children:[(0,y.jsx)(h().A,{style:i.optionTitle,children:(0,y.jsx)(u().j,{children:t.title})}),t.subtitle&&(0,y.jsx)(h().A,{isSmall:!0,isMultiline:!0,style:i.optionSubtitle,children:t.subtitle})]}),(0,y.jsx)(p().A,{isSelected:n})]})}const M=o.memo(b)},867159:(e,t,n)=>{n.d(t,{J8:()=>g,kS:()=>m,p7:()=>p});n(296540);var o=()=>n(484714),i=()=>n(401497),s=()=>n(668725),a=()=>n(959013),r=()=>n(493823),l=()=>n(406699),d=()=>n(74263),c=()=>n(26517),u=n(474848);function p(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(a().sA,{...d().vG[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().aj,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function m(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(a().sA,{...d().Bb[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().qg,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function g(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(a().sA,{...d().PP[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().f3,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function f(e){const t=(0,o().Y0)(),{buttonPopupStore:n,currentVisibilityLabel:a,renderVisibilityLevelsMenu:d,disabled:c}=e,p=(0,i().IS)((e=>({chevronDownIcon:{width:10,marginLeft:4,marginRight:4,fill:e.lightIconColor},currentVisibilityLabel:{color:e.text.secondary,paddingRight:4,height:t.isMobile?32:22}})),[t.isMobile]);return(0,u.jsx)(l().Ay,{popupType:l().z7.Popup,buttonPopupStore:n,renderOrigin:e=>(0,u.jsxs)(r().p,{style:p.currentVisibilityLabel,disabled:c,...e,children:[a,(0,s().b)(p.chevronDownIcon)]}),render:d})}},869120:(e,t,n)=>{n.r(t),n.d(t,{NotionCalendarLaunchModal:()=>R});var o=n(296540),i=()=>n(662303),s=()=>n(484714),a=()=>n(847249),r=()=>n(401497),l=()=>n(237829),d=()=>n(233842),c=()=>n(262462),u=()=>n(959013),p=()=>n(284371),m=()=>n(40970),g=()=>n(755636),f=()=>n(633457),h=()=>n(802790),y=()=>n(296798),v=()=>n(204063),b=()=>n(125565),x=()=>n(687039),S=()=>n(780054),M=()=>n(581495),A=()=>n(836251),w=()=>n(628315),k=()=>n(51367),j=()=>n(218429),C=()=>n(351360),I=()=>n(865241),T=()=>n(645200),_=()=>n(694498),P=()=>n(19606),B=n(474848);function R(){const e=(0,s().v3)(),t=(0,r().IS)((e=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.outlineButtonPressedBackground,width:18,height:18},closeButtonHovered:{background:e.outlineButtonPressedBackground},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:p().Wy.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},learnMoreLink:{display:"flex",alignItems:"center",fontSize:12,color:e.text.secondary,padding:"0 4px",marginLeft:-4},inlineLearnMoreLink:{display:"inline-flex",fontSize:"inherit",marginLeft:0,padding:0},externalLinkIcon:{width:14,height:14,marginLeft:2},inlineExternalLinkIcon:{width:16,height:16},successCheckmark:{width:50,height:50,display:"flex",alignItems:"center",justifyContent:"center"},successCheckmarkIcon:{width:32,height:32,color:e.text.secondary},successTitle:{fontSize:25,fontWeight:p().Wy.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:e.cardBackground},downloadContent:{display:"flex",flexDirection:"column",paddingRight:8},downloadTitle:{fontSize:16,fontWeight:p().Wy.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"},notionCalendarLogoIcon:{width:56,height:58}})),[]);(0,o.useEffect)((()=>{const t=()=>{I().A.state.isVisible&&_().A.state.isConnectingCalendar&&(_().A.setState({isConnectingCalendar:!1}),f().oX({environment:e}))};return I().A.addListener(t),()=>{I().A.removeListener(t)}}),[e]);const n=(0,a().K8)((()=>_().A.state.signupCtaAttribution||"onboardingModalSignIn"),[]),R=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=C().default.state;t&&(k().Sq(e,{callout_key:"notion_calendar_launch_promo",dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),w().a(e,"notion_calendar_launch_promo"),T().MR({environment:e,userSettingsStore:t}),_().A.setState({signupCtaAttribution:void 0}))}),[e]),D=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=C().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),w().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}))}),[e]),O=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=C().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),e.device.isElectron&&w().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.getNotionCalendar",userSettingsStore:t}))}),[e]),N=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=C().default.state;t&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),w().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}))}),[e]),E=(0,a().K8)((()=>C().default.state.currentUserSettingsStore),[]),U=(0,a().K8)((()=>{const e=null==E?void 0:E.getSettings();return null==e?void 0:e.notion_calendar_launch_modal_phase}),[E]),F=()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M().Rz,{onClick:R}),(0,B.jsxs)("div",{style:t.content,children:[(0,B.jsx)("div",{style:t.successCheckmark,children:(0,l().X)(t.successCheckmarkIcon)}),(0,B.jsx)("div",{style:t.successTitle,children:(0,B.jsx)(u().sA,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle"})}),(0,B.jsx)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,B.jsx)(u().sA,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,B.jsxs)("div",{style:t.downloadContainer,children:[(0,B.jsxs)("div",{style:t.downloadContent,children:[(0,B.jsx)("div",{style:t.downloadTitle,children:(0,B.jsx)(u().sA,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,B.jsx)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,B.jsx)(u().sA,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,B.jsx)("div",{style:t.downloadButtonContainer,children:(0,B.jsx)(v().A,{style:t.downloadButton,onClick:()=>{m().Lt(e,{cta:"download"}),g().f({environment:e,url:S().A.calendar.downloadUrl}),N()},children:(0,B.jsx)(u().sA,{...P().z.downloadApp})})})]}),(0,B.jsx)("div",{style:t.notionCalendarLogo,children:(0,d().u)(t.notionCalendarLogoIcon)})]})]})]}),V=()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(x().A,{src:"https://player.vimeo.com/video/900939588?h=187435ef3c",defaultTextTrack:x().V[i().locale]||"en",options:{muted:!0,autoplay:!0,loop:!0,background:!0,playsinline:!0}}),(0,B.jsx)(M().Rz,{style:t.closeButton,hoveredStyle:t.closeButtonHovered,onClick:R}),(0,B.jsxs)("div",{style:t.content,children:[(0,B.jsx)("div",{style:t.title,children:(0,B.jsx)(u().sA,{defaultMessage:"Meet Notion Calendar",id:"notionCalendarLaunchModal.title"})}),(0,B.jsxs)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:[(0,B.jsx)(u().sA,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your calendar events.",id:"notionCalendarLaunchModal.caption"})," "]})]}),(0,B.jsx)(h().A,{size:1,style:t.divider}),(0,B.jsxs)("div",{style:t.footer,children:[(0,B.jsxs)(y().A,{external:!0,href:(0,A().xS)("blog.notionCalendarLaunch"),style:{...t.learnMoreLink,...t.inlineLearnMoreLink},children:[(0,B.jsx)(u().sA,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"}),(0,c().M)({...t.externalLinkIcon,...t.inlineExternalLinkIcon})]}),(0,B.jsx)(P().A,{openCalendarFrom:"onboardingModalOpenCalendar",getNotionCalendarFrom:n,onOpenCalendarClick:()=>{m().be(e,{cta:"open_calendar"}),D()},onGetNotionCalendarClick:()=>{m().be(e,{cta:"get_calendar"}),O()},onDownloadClick:()=>{m().be(e,{cta:"download"}),N()}})]})]});return(0,B.jsx)(j().l,{messageKey:"notion_calendar_launch_promo",desktopRenderInner:()=>(0,B.jsx)(L,{launchModalPhase:U,renderChild:()=>"connected_notion_calendar"===U?F():V()}),desktopInnerStyle:t.container,desktopOnDismiss:R,phoneRenderInner:()=>null})}function L(e){let{launchModalPhase:t,renderChild:n}=e;const i=(0,s().v3)();return(0,o.useEffect)((()=>{"connected_notion_calendar"===t?m().Y8(i):m().aq(i)}),[i,t]),n()}},877263:(e,t,n)=>{n.r(t),n.d(t,{ImportIntoNewPageModal:()=>p,default:()=>m});n(296540);var o=()=>n(847249);const i=(0,n(340498).xh)("docBadgePlus",{default:{loader:()=>n.e(94802).then(n.bind(n,758105))},small:{loader:()=>n.e(94802).then(n.bind(n,424451))},fill:{loader:()=>n.e(94802).then(n.bind(n,528265))},fillSmall:{loader:()=>n.e(94802).then(n.bind(n,301136))}},["IPR","initial page render","recent document","recent page","recents","page history"]);var s=()=>n(959013),a=()=>n(41432),r=()=>n(404141),l=()=>n(7674),d=()=>n(107683),c=n(474848);function u(){a().A.setState({open:!1})}function p(){const e=(0,o().O$)(a().A);return(0,c.jsx)(d().s,{isOpen:e.open,onDismiss:u,onClosed:u,areaConstraint:{width:{type:"fixed",length:300}},render:()=>(0,c.jsx)(l().tf,{header:(0,c.jsx)(l().YA,{iconAndTitle:(0,c.jsx)(l().ZQ,{iconGroup:i,title:(0,c.jsx)(s().sA,{defaultMessage:"Import into new page?",id:"importIntoNewPageModal.title"})}),description:(0,c.jsx)(s().sA,{id:"importIntoNewPageModal.description",defaultMessage:"Since this page already has content, we’ll need to create a new page for you and import contents there."})}),footer:(0,c.jsx)(l().aO,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,c.jsx)(s().sA,{defaultMessage:"Yes, continue",id:"importIntoNewPageModal.importButton"}),onClick:()=>{r().A.setState({open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"collection"}),u()}}],secondaryButtons:[{buttonType:"secondary",label:"Cancel",onClick:u}]})})})}const m=p},887480:(e,t,n)=>{n.d(t,{Ay:()=>i().A,yQ:()=>a});var o=()=>n(645873),i=()=>n(853306);const s=new(o().O2)("radioModalRenderer",(()=>n.e(35818).then(n.bind(n,415995)))),a=(0,o()._h)(s,(e=>e.default))},895469:(e,t,n)=>{n.r(t),n.d(t,{PermissionsInviteWithModal:()=>Z});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(148307),l=()=>n(959013),d=()=>n(534177),c=()=>n(980427),u=()=>n(134696),p=()=>n(701763),m=()=>n(542056),g=()=>n(743260),f=()=>n(299545),h=()=>n(47170),y=()=>n(183804),v=()=>n(406792),b=()=>n(957599),x=()=>n(224701),S=()=>n(991249),M=()=>n(749240),A=()=>n(406699),w=()=>n(433876),k=()=>n(897119),j=()=>n(204063),C=()=>n(100622),I=()=>n(496603),T=()=>n(836251),_=()=>n(640653),P=()=>n(406999),B=()=>n(630116),R=()=>n(527059),L=()=>n(89924),D=()=>n(962036),O=()=>n(912913),N=()=>n(654856),E=()=>n(263919),U=n(474848);function F(e){const{store:t,permissionsInviteStore:r,membersOnly:d,onUpgradeButtonClick:c,upgradeButtonName:u,inviteOrigin:p,onInviteClick:g}=e,h=(0,i().v3)();(0,n(852507).l)((async()=>{await x().Ow(h)}));const y=(0,s().K8)((()=>(0,f().Yu)(t)),[t]),v=(0,o.useCallback)((async()=>{await m().iS({environment:h,permissionsInviteStore:r,from:"share_menu"})}),[h,r]),b=(0,a().IS)((()=>({right:{color:C().Ay.blue}})),[]);return(0,U.jsxs)(n(928600).A,{menuType:n(722872).gu.Modal,title:y?(0,U.jsx)(l().sA,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,U.jsx)(l().sA,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,U.jsx)("div",{style:b.right,children:(0,U.jsx)(l().sA,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,U.jsx)(n(480095).CancelMenuText,{}),onClickLeft:v,onClickRight:g,header:(0,U.jsx)(V,{...e,inviteOrigin:p,onInviteClick:g}),className:n(38337).bFE,children:[(0,U.jsx)(L().A,{title:(0,U.jsx)(l().sA,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:(0,U.jsx)(z,{store:t,onUpgradeButtonClick:c,upgradeButtonName:u,permissionsInviteStore:r})}),(0,U.jsx)("div",{children:(0,U.jsx)(K,{store:t,permissionsInviteStore:r,membersOnly:d})}),(0,U.jsx)(H,{})]})}function V(e){const{store:t,isSubscribed:n,onInviteClick:a,permissionsInviteStore:r,inviteOrigin:l}=e,d=(0,i().v3)(),c=(0,s().K8)((()=>g().LC({environment:d,store:t,isSubscribed:n})),[d,t,n]),p=(0,s().K8)((()=>{const e=r.state.inputFocus;return"invitee"===e||"invitee-popup-closed"===e}),[r]),f=(0,h().O)(),y=(0,R().lI)({spaceId:f}),v=(0,o.useMemo)((()=>I().sg((()=>{u().D2(d,{invite_flow_id:r.state.flowId,billingData:y,invite_origin:l})}),1e3)),[d,r,l,y]),b=(0,o.useCallback)((async e=>{v(),await m().Pp({environment:d,event:e,permissionsInviteStore:r})}),[v,d,r]),x=(0,o.useCallback)((e=>{m().St({targetToRemove:e,permissionsInviteStore:r,defaultRoleForNonBot:c})}),[c,r]);return(0,U.jsx)(N().A,{permissionsInviteStore:r,store:t,handleClickRemoveToken:x,handleInputChange:b,handleInputSubmit:a,origin:"share_modal",defaultRoleForNonBot:c,focus:p,handleFocus:()=>{}})}function K(e){const{store:t,permissionsInviteStore:n,membersOnly:o}=e,i=(0,s().K8)((()=>(0,f()._p)(t)),[t]),a=(0,s().K8)((()=>t instanceof B().Bv&&(0,_().hN)(t.getSpaceStore())),[t]);return(0,U.jsx)(E().A,{permissionsInviteStore:n,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:i,shouldShowGroups:i,sectionRenderLimit:10,membersOnly:o,guestsMustBeRequested:a})}function H(){return(0,U.jsx)(L().A,{topBorder:!0,disableDesktopPadding:!0,children:(0,U.jsx)(D().A,{title:(0,U.jsx)(l().sA,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,T().xS)("guides.invitePerson"),analyticsFrom:"invite_person"})})}function z(e){const t=(0,i().v3)(),{store:n,onUpgradeButtonClick:r,upgradeButtonName:l,permissionsInviteStore:d}=e,{inviteRole:c,table:u}=(0,s().K8)((()=>{const{inviteRole:e}=d.state;return{inviteRole:e,table:n.table}}),[d,n.table]),p=(0,s().K8)((()=>(0,P().qs)(d.state)),[d]),g=(0,s().K8)((()=>(0,f()._p)(n)?n.getType():void 0),[n]),h=(0,s().K8)((()=>(0,f().Yu)(n)&&!n.canAdmin()),[n]),y=(0,o.useCallback)((e=>{m().lf({environment:t,newRole:e,permissionsInviteStore:d})}),[t,d]),v=(0,a().IS)((()=>({button:{display:"flex",whiteSpace:"nowrap",height:26,color:C().Ay.uiGray}})),[]);return p||!c?null:(0,U.jsx)(O().Ay,{disabled:h,role:c,table:u,type:"user_permission",blockType:g,isInvite:!0,onUpgradeButtonClick:r,upgradeButtonName:l,buttonStyle:v.button,isMenuItem:!0,onChange:y})}const W=o.memo(F);var G=()=>n(430102),Y=()=>n(887080),q=()=>n(103448);function $(e){const{store:t,origin:c,sudoModeStore:u,onInviteComplete:p,onInviteClick:y}=e,b=(0,i().v3)(),{isMobile:S}=b.device,A=(0,l().tz)(),k=(0,h().O)(),j=(0,n(714300).l)({spaceId:k}),C=(0,s().uB)(e.permissionsInviteStore,n(986229).A),I=(0,s().K8)((()=>C.state.modalOpen),[C]),T=e.analyticsFrom,_=(0,s().uB)(void 0,n(159026).Ay),P=(0,o.useCallback)((async()=>{const e=v().default.DO_NOT_USE_markLegacy("share_menu.invite_user_lag");await m().kW({environment:b,store:t,sudoModeStore:u,permissionsInviteStore:C,contextualInviteStore:_,onInviteClick:y,onInviteComplete:p,inviteOrigin:T,intl:A}),v().default.DO_NOT_USE_measureLegacy(e,{environment:b})}),[b,t,u,C,_,y,p,T,A]);(0,o.useEffect)((()=>{I&&!(0,d().O9)(M().subscriptionDataStoreInstance.state)&&x().Ow(b)}),[b,I]);const B=(0,s().K8)((()=>Boolean(t.canEditMembership())),[t]),R=(0,s().K8)((()=>B&&(0,f().Yu)(t)&&(0,d().O9)(M().subscriptionDataStoreInstance.state)&&!n(10984).El()),[B,t]),L=(0,s().K8)((()=>function(e){let{store:t,canEditMembership:n,showUpgrade:o}=e;if(!n&&(0,f().Yu)(t))return(0,U.jsx)(l().sA,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."});if(!n)return(0,U.jsx)(l().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."});if(o)return(0,U.jsx)(q().A,{imageURL:r().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,U.jsx)(l().sA,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,U.jsx)(l().sA,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})});return null}({store:t,canEditMembership:B,showUpgrade:R})),[B,R,t]),D=(0,o.useCallback)((()=>async function(e,t,n,o){const i=await(0,g().iQ)({environment:e,permissionsInviteStoreState:n.state,from:o??((0,f().Yu)(t)?"space_share_modal":"page_share_modal")});i||n.reset()}(b,t,C,e.analyticsFrom)),[b,t,C,e.analyticsFrom]),O=(0,o.useCallback)((()=>S?(0,U.jsx)(W,{...e,onInviteClick:P,inviteOrigin:T,permissionsInviteStore:C,billingData:j}):(0,U.jsx)(n(347345).A,{inviteOrigin:T,onInviteClick:P,permissionsInviteStore:C})),[S,e,P,T,C,j]),N=(0,a().IS)((()=>({modal:{display:"flex",alignSelf:"center",top:0}})),[]);return(0,f().Yu)(t)?(0,U.jsx)(w().A,{open:I,onDismiss:D,renderContent:O,modalStyle:N.modal,origin:(0,U.jsx)(n(859428).A,{renderTooltip:()=>L,disableTooltip:B,render:t=>(0,U.jsx)(Q,{permissionsInviteStore:C,tooltipEvents:t,actionEnabled:B,showUpgrade:R,buttonInner:c,...e,...t})})}):(0,U.jsx)(w().A,{open:I,onDismiss:D,renderContent:O,origin:null})}function Q(e){let{tooltipEvents:t,showUpgrade:n,actionEnabled:r,store:d,isSubscribed:m,enableInviteDropdown:f,onInviteClick:h,onInviteComplete:v,upgradeButtonName:x,onUpgradeButtonClick:M,shouldGrow:w,buttonStyle:C,permissionsInviteStore:I,buttonInner:T}=e;const _=(0,i().v3)(),P=(0,s().K8)((()=>b().F.getState().forceImportDropdownOpen),[]),B=(0,a().IS)((()=>({dropdownButton:{flex:w?1:0,...C},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[C,w]),R=(0,o.useCallback)((()=>function(e,t,n,o){(0,g().LH)({environment:e,permissionsInviteStore:o,store:t,renderInShareModal:!1,isSubscribed:n}),p().CW(e,{type:"invite"}),u().vX(e,{type:"invite",from:"settings_modal"})}(_,d,m,I)),[_,d,m,I]),L=(0,o.useCallback)((()=>n?function(e,t,n){S().K(t,{from:e,upsell:{type:"product",product:"plus",limit:{type:"none"},trialability:"none"}}),n&&n(),p().CW(t,{type:"upgrade"})}(x,_,M):R()),[_,R,M,n,x]);if(T)return(0,U.jsx)("div",{onClick:R,children:T});const D=(0,y().A)({onInviteClick:h,onInviteComplete:v,buttonStyle:B.importListButton,buttonContainerStyle:B.importListButtonContainer});return f?(0,U.jsx)(A().Ay,{open:!!P||void 0,popupType:k().nl.Popup,alignmentToOrigin:A().yP.End,placementToOrigin:A().sx.Bottom,render:()=>(0,U.jsx)(Y().A,{importListItems:D}),originGap:12,onClose:()=>{P&&b().F.closeImportDropdown()},renderOrigin:e=>(0,U.jsx)(G().A,{disabled:!r&&!n,style:B.dropdownButton,title:(0,U.jsx)(l().sA,{id:"inviteUserButton.addMemberLabel.dropdown",defaultMessage:"Add members"}),onClick:L,onDropdownClick:()=>{e.onClick(),c().V(_,{source:"add_members_button"})},color:"blue"})}):(0,U.jsx)(j().A,{size:"lg",onClick:L,disabled:!r&&!n,style:B.dropdownButton,...t,children:(0,U.jsx)(l().sA,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})}const Z=o.memo($)},910702:(e,t,n)=>{n.d(t,{zk:()=>k,wm:()=>A,Js:()=>C,H0:()=>T,hk:()=>_});n(296540);var o=()=>n(3284),i=()=>n(919709),s=()=>n(959013),a=()=>n(751156),r=()=>n(67103),l=()=>n(401497),d=()=>n(553965),c=()=>n(962730),u=()=>n(575143),p=()=>n(515918),m=()=>n(859428),g=n(474848);function f(e){let{menuListItemProps:t,title:n,caption:o,icon:i,disabled:s,tooltipText:a,showNewBadge:r}=e;const f=(0,l().IS)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,g.jsx)(m().A,{placement:c().W.Right,disableTooltip:!a,renderTooltip:()=>a,render:e=>(0,g.jsx)(u().A,{...(0,d().A)(t,e),style:f.menuItem,title:n,caption:o,captionStyle:o?f.caption:void 0,svg:i,disabled:s,disabledFeedback:s,right:r&&(0,g.jsx)(p().A,{})})})}var h=()=>n(878377),y=()=>n(37433),v=()=>n(10984),b=()=>n(416726),x=()=>n(843005);const S=(0,s().YK)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}});function M(e,t){return(0,b().Ls)({key:"turn page into team",displayName:t,analyticsName:S.createTeamFromPageFullName.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,render:(e,o)=>{const a=function(e){const{blockStore:t,environment:n}=e;if(!n.currentUser.id)return null;if(0===i().q4_(t.getTitleValue()).length)return(0,g.jsx)(s().sA,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,y().getAccessLevelAndPermissionsForTeamCreatedFromPage)(t).accessLevel&&!(0,v().HO)())return(0,g.jsx)(s().sA,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"});return null}({environment:o.environment,blockStore:o.blocks[0]});return(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(s().sA,{...t}),caption:(0,g.jsx)(s().sA,{...S.createTeamFromPageCaption}),disabled:Boolean(a),tooltipText:a,icon:n(234748).I})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];n(477093).Vs({environment:o,page:i})}})}const A=M([h().Uo6([h().w2Y,h().AU6(h().d2I)])],S.createTeamFromPageFullName),w=M([h().w2Y],S.createTeamFromPageName),k=(0,b().uk)({key:"turn into teamspace or wiki",displayName:x().DZ.turnIntoSection,analyticsName:x().DZ.turnIntoSection.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:[h().w2Y,h().d2I],subActions:()=>[(0,b().gy)({key:"turn into teamspace or wiki",render:e=>(0,g.jsx)(n(89924).A,{...e}),actions:[w,I]})],width:300});function j(e,t){return(0,b().Ls)({key:"turn page into wiki",displayName:t,analyticsName:S.turnPageIntoWikiFullName.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;"bottom_right"===n(508496).default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?n(816013).r.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:o[0]}):a().createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,canUndo:!0,perform:e=>{r().hJ({environment:t,blocks:o,transaction:e,source:"page_menu"})}})},render:e=>{const i=!n(227440).A.state.online;return(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(s().sA,{...t}),disabled:i,icon:o().arrowSquarePathUpDownIcon,tooltipText:i?(0,g.jsx)(s().sA,{...b().AY.unavailableOfflineTooltip}):(0,g.jsx)(s().sA,{...S.turnPageIntoWikiCaption})})}})}const C=j([h().Uo6([h().d2I,h().AU6(h().w2Y)]),h().AU6(h().oy3)],S.turnPageIntoWikiFullName),I=j([h().d2I],S.turnPageIntoWikiName);const T=j([h().d2I,h().AU6(h().oy3)],S.turnPageIntoWikiFullName),_=(0,b().Ls)({key:"undo turn page into wiki",displayName:S.undoTurnPageIntoWikiName,analyticsName:S.undoTurnPageIntoWikiName.defaultMessage,svg:n(454503).arrowUTurnUpLeftIcon,validators:[h().vXb,h().VNy,h().AU6(h().ln6),h().Afv,h().Km9,h().AU6(h().oy3)],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:o}=e;const{accept:l}=await n(901389).Gh({message:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(s().sA,{defaultMessage:'Turn "{pageName}" back into a normal page?',id:"action.undoTurnIntoWiki.message",values:{pageName:i().q4_(o[0].getTitleValue())}})}),description:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(s().sA,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})});l&&a().createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,canUndo:!0,perform:e=>{r().nQ({environment:t,blocks:o,transaction:e,source:"page_menu"})}})}})},926938:(e,t,n)=>{n.d(t,{q:()=>r});var o=()=>n(484714),i=()=>n(187174),s=()=>n(534177),a=()=>n(449506);function r(){const e=(0,o().v3)(),[{status:t,error:n,value:r},l]=(0,i().Yb)((async()=>{const t=await a().callApi({eventName:"getUserOrganizations",environment:e,data:{}});if("success"===t.type)return t.data;if("failed"===t.type)throw t.error;return(0,s().HB)(t)}),[e]);return{organizationsInfo:(null==r?void 0:r.organizationsInfo)??[],loading:"pending"===t||"idle"===t,error:n,refresh:l}}},942906:(e,t,n)=>{n.d(t,{Lj:()=>r,W2:()=>l,xw:()=>a});var o=()=>n(416504),i=()=>n(751156),s=()=>n(755199);function a(e){const{environment:t,userSettingsStore:n}=e,i=n.getSettings(),s=null==i?void 0:i.time_zone,a=(0,o().P)();s!==a&&r({environment:t,userSettingsStore:n,timeZone:a})}function r(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;i().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{s().mJ({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function l(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;i().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{s().mJ({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},946576:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var o=n(296540),i=()=>n(484714),s=()=>n(401497),a=()=>n(75756),r=()=>n(959013),l=()=>n(284371),d=()=>n(673998),c=()=>n(991385),u=()=>n(799089),p=()=>n(455215),m=()=>n(493823),g=()=>n(204063),f=n(474848);function h(){const e=(0,i().v3)().currentUser.id;(0,o.useEffect)((()=>{if(!e)return;(0,c().S)(e);const t=window.setInterval((()=>{(0,c().S)(e)}),n(720665).nD);return()=>{window.clearInterval(t)}}),[e]);const t=(0,n(847249).K8)((()=>u().A.state.open),[]),s=x();return(0,f.jsx)(n(641514).A,{onDismiss:n(496603).lQ,render:()=>(0,f.jsx)("div",{style:s.modal,children:(0,f.jsxs)(n(21140).Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,f.jsx)("img",{style:s.image,src:n(148307).A.images.feedbackThankYouPng}),(0,f.jsx)("div",{style:s.title,children:(0,f.jsx)(r().sA,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,f.jsx)("div",{style:s.description,children:(0,a().Qq)(d().N6,"banner")}),(0,f.jsx)(y,{}),(0,f.jsx)(v,{}),(0,f.jsx)(b,{})]})}),isOpen:t})}function y(){const e=x(),t=(0,i().v3)();return(0,f.jsx)(g().A,{size:"lg",style:e.acceptAllButton,onClick:()=>{d().Vg(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),u().A.setState({open:!1}),d().wB()},children:(0,f.jsx)(r().sA,{...a().LS.acceptAllButtonLabel})})}function v(){const e=x(),t=(0,i().v3)();return(0,f.jsx)(m().p,{size:"lg",isGray:!0,style:e.moreOptionsButton,onClick:()=>{d().Vg(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),u().A.setState({open:!1}),d().wB()},children:(0,f.jsx)(r().sA,{...a().LS.rejectAllButtonLabel})})}function b(){const e=x();return(0,f.jsx)(p().A,{hasDismissButton:!0,onDismiss:()=>{u().A.setState({open:!1})},renderOrigin:t=>(0,f.jsx)(m().p,{...t,size:"lg",isGray:!0,style:e.moreOptionsButton,children:(0,f.jsx)(r().sA,{...a().LS.moreOptionsButtonLabel})})})}function x(){return(0,s().IS)((e=>({modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.text.primary,fontWeight:l().Wy.semibold,fontSize:18},description:{color:e.text.secondary,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}})),[])}const S=o.memo(h)},952305:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});n(296540);var o=()=>n(484714),i=()=>n(847249),s=()=>n(401497),a=()=>n(148307),r=()=>n(959013),l=()=>n(284371),d=()=>n(209660),c=()=>n(963575),u=()=>n(931432),p=()=>n(493823),m=()=>n(676007),g=()=>n(204063),f=n(474848);function h(){const e=(0,o().Y0)(),t=(0,i().K8)((()=>u().A.state.open),[]),n=()=>{u().A.state.open&&u().A.state.onDecline&&u().A.state.onDecline(),u().A.setState({open:!1})},h=()=>{u().A.state.open&&u().A.state.onConfirm(),u().A.setState({open:!1})},y=()=>{n(),d().Ow({currentTab:"connected_apps"})},v=(0,s().IS)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:l().Wy.medium,marginTop:15,marginBottom:20,color:e.text.secondary}})),[]);return(0,f.jsx)(m().A,{open:t,innerStyle:v.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,f.jsxs)("div",{style:v.modalHeaderWrap,children:[(0,f.jsx)("img",{src:a().A.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,f.jsx)("div",{style:v.modalMessage,children:(0,f.jsx)(r().sA,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,f.jsx)("div",{style:v.modalMessage,children:(0,f.jsx)(r().sA,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,f.jsx)(g().A,{size:"lg",onClick:h,children:(0,f.jsx)(r().sA,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),!e.isMobile&&(0,f.jsx)("div",{style:{display:"block",marginTop:c().A.vertical.tiny},children:(0,f.jsx)(p().p,{isGray:!0,size:"xs",showUnderline:!0,onClick:y,children:(0,f.jsx)(r().sA,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]}),onDismiss:n})}},952451:(e,t,n)=>{n.r(t),n.d(t,{CollectionTypedDatabaseMigrationModal:()=>ae});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(66689),l=()=>n(959013),d=()=>n(346705),c=(n(581454),()=>n(148307)),u=n(474848);const p=(0,n(340498).wt)("drawing",{viewBox:"0 0 12 12",svg:(0,u.jsx)("path",{d:"M2.606 9.98a6.714 6.714 0 01-1.162-1.538A6.54 6.54 0 01.8 6.752a5.933 5.933 0 01-.132-1.698c.042-.557.17-1.081.38-1.573.216-.494.512-.932.89-1.313a4.043 4.043 0 011.347-.898A4.761 4.761 0 014.887.928a5.48 5.48 0 011.68.185c.56.15 1.09.381 1.591.694l-.845.83a4.757 4.757 0 00-1.152-.435 4.372 4.372 0 00-1.23-.127c-.41.013-.804.093-1.182.24-.374.146-.71.367-1.006.664a3.09 3.09 0 00-.796 1.352 4.196 4.196 0 00-.117 1.646c.068.576.236 1.14.503 1.694.27.553.63 1.055 1.08 1.504.276.28.564.516.863.708a6 6 0 00.884.469c.287.123.552.22.796.288.247.071.456.127.625.166a.784.784 0 01.4.215c.092.1.136.23.132.39-.006.186-.078.322-.215.41-.136.091-.314.12-.532.088a6.388 6.388 0 01-.698-.151 7.184 7.184 0 01-1.997-.903 6.64 6.64 0 01-1.065-.875zm1.968-1.523L5.8 7.988a3.6 3.6 0 00.874.635c.329.17.669.282 1.02.337.352.055.694.039 1.026-.049a2.03 2.03 0 00.903-.542 1.85 1.85 0 00.537-1.035 2.906 2.906 0 00-.083-1.294 4.542 4.542 0 00-.64-1.348l.826-.82c.341.475.599.962.771 1.46.176.495.27.978.283 1.45.013.472-.055.913-.205 1.323a2.913 2.913 0 01-.678 1.075c-.3.3-.647.52-1.04.664-.391.14-.804.208-1.24.205-.434 0-.867-.064-1.3-.19a5.255 5.255 0 01-1.24-.547 4.715 4.715 0 01-1.04-.855zM5.6 7.48l-1.177.445c-.085.032-.165.014-.24-.054a.21.21 0 01-.053-.244l.459-1.162 4.443-4.439 1.011 1.011L5.6 7.48zm4.819-4.814l-1.01-1.01.468-.47a.716.716 0 01.44-.21.481.481 0 01.414.142l.176.171a.551.551 0 01.171.45.703.703 0 01-.205.453l-.454.474z"})});var m=()=>n(370446),g=()=>n(284371),f=()=>n(972435),h=()=>n(755170),y=()=>n(997415),v=()=>n(854672),b=()=>n(132389),x=()=>n(125565);const S=(0,l().YK)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),M=[{icon:"📅",taskName:f().A.formatMessage(S.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,m().Q)({width:13,fill:"#448361"})},{icon:"📚",taskName:f().A.formatMessage(S.dummyTask2),status:"In Progress",teamspace:"Design",location:p({width:13,fill:"#CB912F"})},{icon:"🎨",taskName:f().A.formatMessage(S.dummyTask3),status:"In Progress",teamspace:"Design",location:p({width:13,fill:"#CB912F"})},{icon:"🛫",taskName:f().A.formatMessage(S.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,m().Q)({width:13,fill:"#448361"})},{icon:"🚧",taskName:f().A.formatMessage(S.dummyTask5),status:"Not Started",teamspace:"Design",location:p({width:13,fill:"#CB912F"})},{icon:"👩‍💻",taskName:f().A.formatMessage(S.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,m().Q)({width:13,fill:"#448361"})}],A={Blocked:"red","In Progress":"blue","Not Started":"gray"};function w(){const e=C();return(0,u.jsx)(h().A,{title:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),tooltip:void 0,icon:(0,u.jsx)("div",{style:{paddingLeft:4},children:(0,u.jsx)(v().A,{type:"app_package_asset",size:18,icon:c().A.images.appPackages.taskDbIconSvg})}),children:(0,u.jsx)("div",{style:e.dummyAssignedToMe,children:(0,u.jsx)(k,{})})})}function k(){const e=M.map(((e,t)=>(0,u.jsx)(j,{row:e},t)));return(0,u.jsx)("div",{style:{display:"flex",marginTop:4,paddingRight:16,flexDirection:"column"},children:e})}function j(e){let{row:t}=e;const n=C();return(0,u.jsxs)("div",{style:n.eachTask,children:[(0,u.jsxs)("div",{style:n.taskName,children:[(0,u.jsx)("span",{style:n.taskIcon,children:t.icon}),(0,u.jsx)(x().A,{style:n.taskTitle,children:t.taskName})]}),(0,u.jsx)("div",{style:n.taskStatus,children:(0,u.jsx)(y().X,{type:"status",value:f().A.formatMessage(S[t.status]),color:A[t.status],groupColor:void 0})}),(0,u.jsx)(b().A,{size:8}),(0,u.jsxs)("div",{style:n.location,children:[(0,u.jsx)("span",{style:n.locationIndicator,children:f().A.formatMessage(S.locationIndicator)}),(0,u.jsx)("div",{style:{...n.locationIcon,..."Design"===t.teamspace?{...n.designTeamspace}:{...n.engTeamspace}},children:t.location})]})]})}function C(){return(0,a().IS)((e=>({dummyAssignedToMe:{width:"60%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:220,display:"flex",...g().RC},taskIcon:{fontSize:14,marginRight:8},taskTitle:{color:e.text.primary,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:130},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.text.secondary,marginRight:4,maxWidth:48,...g().RC},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}n(898992),n(354520),n(803949),n(737550);var I=()=>n(584262),T=()=>n(128914),_=()=>n(743176),P=()=>n(668725),B=()=>n(689094),R=()=>n(100622),L=()=>n(128427),D=()=>n(436572),O=()=>n(751156),N=()=>n(521358),E=()=>n(617254),U=()=>n(313892),F=()=>n(895876),V=()=>n(609429),K=()=>n(722872),H=()=>n(696746),z=()=>n(700250),W=()=>n(666429),G=()=>n(920773),Y=()=>n(760217),q=()=>n(406699),$=()=>n(928600),Q=()=>n(939740),Z=()=>n(204063),X=()=>n(89924),J=()=>n(690197);function ee(e){const{collectionContextStore:t,databaseType:n,containerStyle:c}=e,p=(0,i().v3)(),m=(0,l().tz)(),{isPhone:g,isMobileNative:f}=(0,i().Y0)(),h=(0,s().K8)((()=>g&&f),[g,f]),y=function(e){return(0,a().IS)((t=>({formTitle:{display:"inline-flex"},emojiTitle:{fontSize:36,marginRight:8},perPropertyInstruction:{color:t.text.secondary,fontSize:e?14:12,marginBottom:8},requiredPropertyError:{color:R().Ay.red,fontSize:e?14:12,marginRight:e?8:6},propertyMappingInstructions:{marginTop:6,marginBottom:24,fontSize:e?16:14,fontWeight:e?500:400},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:e?14:10,fill:t.lightIconColor},propertyMappingTitle:{fontSize:e?16:14,color:t.text.tertiary},propertyMappingMenu:{borderRadius:6,border:`1px solid ${t.tableDividerColor}`,boxShadow:"none"},propertyConversionCallout:{display:"flex",alignItems:"center",marginLeft:4,marginTop:3,color:t.text.tertiary},a:{color:"white",cursor:"pointer"},propertyIcon:{fill:t.darkTextColor},buttons:{marginBlockStart:e?"auto":void 0},submitMigrationButton:{display:"flex",height:e?36:32,fontSize:e?16:14},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginLeft:0,width:"100%"},learnMoreButton:{display:"inline-flex",justifyContent:"center",width:"100%",height:26},closeButton:{width:"100%",height:36,marginTop:8,display:"inline-flex",justifyContent:"center",fontSize:16,color:t.text.tertiary}})),[e])}(g),v=(0,a().DP)(),[S,M]=(0,o.useState)(!1),A=(0,s().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),w=(0,s().K8)((()=>U().YH((0,E().appConfigs)(),n)),[n]),k=(0,s().K8)((()=>{if(A&&w)return U().DH(w,A)}),[w,A]),j=(0,o.useCallback)(((e,t)=>{const n=t.type;return U().Kb(e,t,A??{}).map((e=>{let[t,o]=e;return{key:t,title:null==o?void 0:o.name,icon:(0,u.jsx)(_().zB,{size:16,style:y.propertyIcon,theme:v,icon:null==o?void 0:o.icon,type:(null==o?void 0:o.type)||n})}}))}),[v,y.propertyIcon,A]),C=(0,s().K8)((()=>{const e=Object.keys(w||{}).filter((e=>void 0!==(null==w?void 0:w[e])&&e.startsWith("notion://"))),t=Object.fromEntries(e.map((e=>[e,void 0])));return Object.entries(w||{}).forEach((e=>{let[n,o]=e;if(!o)return;const i=null==k?void 0:k[n];if(i)return void(t[n]=i);0===j(n,o).length&&(t[n]=T().Ul)})),t}),[w,k,j]),[ee,oe]=(0,o.useState)(C),ie=(0,o.useMemo)((()=>Object.entries(ee).some((e=>{let[t,n]=e;if(t===r().yx.Status){const e=null==A?void 0:A[n||""];if("checkbox"===(null==e?void 0:e.type)||"select"===(null==e?void 0:e.type))return!0}}))),[A,ee]),se=(0,o.useCallback)((e=>{const t=null==w?void 0:w[e],n={width:16,height:16,marginRight:10};if(!t)return null;const o=[...j(e,t),{key:T().Ul,title:m.formatMessage(te.createNew),icon:(0,B().W)({width:n.width,fill:y.propertyIcon.fill}),type:void 0}],i=ee[e],s=null==A?void 0:A[i||""],a=!i&&S,d=e===r().yx.Status;let c=null;return i===T().Ul?c=(0,B().W)(n):s&&(c=_().LE[null==s?void 0:s.type](n)),(0,u.jsx)(q().Ay,{popupType:g?q().z7.SlideUp:q().z7.Popup,renderOrigin:t=>(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsx)(x().A,{isMultiline:!0,style:y.perPropertyInstruction,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:m.formatMessage(ne[e])}})}),(0,u.jsx)(Y().A,{disabled:1===o.length,disabledFeedback:!0,focused:!1,right:(0,u.jsxs)("div",{style:y.propertyMappingDropdown,children:[a?(0,u.jsx)("span",{style:y.requiredPropertyError,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,P().b)({...y.chevronDownIconEnabled,...a?{fill:R().Ay.red}:{}})]}),rightStyle:{marginRight:g?14:8},title:(0,u.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c,i===T().Ul?m.formatMessage(te.createNew):s?s.name:m.formatMessage(te.select)]}),titleStyle:i?{display:"flex",alignItems:"center"}:y.propertyMappingTitle,itemMarginLeft:8,style:{...y.propertyMappingMenu,...a?{borderColor:R().Ay.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),d&&ie&&(0,u.jsx)(x().A,{isSmall:!0,isMultiline:!0,children:(0,u.jsx)("div",{style:y.propertyConversionCallout,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxSelectMappingInfo",defaultMessage:"This property will be converted to a Status property type."})})})]}),placementToOrigin:z().UV.Bottom,alignmentToOrigin:z().MY.Start,render:t=>{const n=[{key:"propertyOptions",render:e=>(0,u.jsx)(X().A,{...e,topBorder:0!==e.index}),items:o.map((n=>{const o={key:n.key,render:t=>(0,u.jsx)(Y().A,{...t,icon:n.icon,title:n.title,isChecked:ee[e]===n.key}),action:()=>{oe({...ee,[e]:n.key}),M(!1),t.close()}};return o}))}],i=g?{menuType:K().gu.ActionSheet}:{menuType:K().gu.Popup,width:250};return(0,u.jsx)($().A,{...i,children:(0,u.jsx)(Q().Ay,{type:Q().Oh.Vertical,initialFocus:void 0,sections:n})})}},e)}),[w,j,m,y,ee,A,S,ie,g]),ae=(0,o.useCallback)((()=>{var e,o;const i=t.collectionStore(),s=t.collectionViewBlockStore();if(!i||!s)return;const a=(0,H().XH)("main"),c=null==a||null===(e=a.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==a?void 0:a.getRecordModel,pageVisitSource:I().y8.TypedDBConversionToast}),g=(0,H().XH)("myTasks"),f=null==g||null===(o=g.getModel())||void 0===o?void 0:o.getRenderUrl({getRecordModel:null==g?void 0:g.getRecordModel,pageVisitSource:I().y8.TypedDBConversionToast});!function(e){return!Object.values(e).includes(void 0)}(ee)?M(!0):O().createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:p,canUndo:!0,perform:e=>{N().bC({environment:p,collectionViewBlockStore:s,collectionStore:i,databaseType:n,propertyMapping:{...ee},typedPropertySchemas:{...w},transaction:e}),d().A.setState({isModalOpen:!1,collectionContextStore:void 0}),n===r().dC&&(V().e.locallyMutatedTasksDatabase=!0),(0,L().Y)({environment:p,database_type:n,property_mapping:ee,collectionContextStore:t});const o=h?(0,u.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>My tasks</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage.nativePhone",values:{singularType:(0,F().$O)(n),databaseName:i.getName()||m.formatMessage(te.defaultCollectionName),span:e=>(0,u.jsx)("span",{children:e}),a:e=>(0,u.jsx)("a",{style:y.a,href:f,children:e})}}):(0,u.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,F().$O)(n),databaseName:i.getName()||m.formatMessage(te.defaultCollectionName),span:e=>(0,u.jsx)("span",{children:e}),a:e=>(0,u.jsx)("a",{style:y.a,href:c,children:e})}});D().rL({item:{label:o,durationMs:W().LX},undoFunc:()=>{O().createAndCommit({environment:p,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",canUndo:!0,perform:e=>{N().Fr({environment:p,collectionContextStore:t,transaction:e})}})}})}})}),[t,ee,p,n,w,h,m,y.a]);return(0,u.jsxs)("div",{style:c,children:[(0,u.jsxs)("div",{style:y.formTitle,children:[g?(0,u.jsx)("span",{style:y.emojiTitle,children:"📋"}):null,(0,u.jsx)(x().A,{style:y.propertyMappingInstructions,isMultiline:!0,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"Task databases require status, assignee, and due date properties."})})]}),g?(0,u.jsx)(b().A,{size:16}):null,Object.entries(C).map((e=>{let[t,n]=e;return se(t)})),(0,u.jsxs)("div",{style:y.buttons,children:[(0,u.jsx)(Z().A,{style:y.submitMigrationButton,onClick:ae,children:(0,u.jsx)(l().sA,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,F().$O)(n)}})}),g?(0,u.jsx)(G().p,{style:y.closeButton,onClick:()=>d().A.reset(),children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Close",defaultMessage:"Close"})}):(0,u.jsx)(J().A,{title:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,F().$O)(n)}}),analyticsFrom:"set_database_type",href:H().hI,style:y.learnMore,buttonStyle:y.learnMoreButton})]})]})}const te=(0,l().YK)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SelectFieldPlaceholder",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),ne={[r().yx.Status]:te.taskStatus,[r().yx.Assign]:te.taskAssignee,[r().yx.DueDate]:te.taskDueDate};var oe=()=>n(676007),ie=()=>n(754002);const se=32;function ae(){const e=ce(),t=(0,i().Y0)(),n=(0,s().O$)(d().A);return n.isModalOpen?t.isPhone?(0,u.jsx)(ie()._,{fullscreen:!0,innerStyle:e.phoneInner,renderInner:()=>(0,u.jsx)(de,{collectionContextStore:n.collectionContextStore})}):(0,u.jsx)(oe().A,{open:!0,onDismiss:()=>d().A.reset(),innerStyle:e.desktopInner,render:()=>(0,u.jsx)(le,{collectionContextStore:n.collectionContextStore})}):null}const re=450;function le(e){const t=ce();return(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,u.jsxs)("div",{style:t.title,children:[(0,u.jsx)("span",{style:t.emojiTitle,children:"📋"}),(0,u.jsx)(x().A,{isMultiline:!0,style:t.previewTitle,children:(0,u.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,u.jsx)(b().A,{size:36}),(0,u.jsx)(w,{}),(0,u.jsx)(ee,{collectionContextStore:e.collectionContextStore,databaseType:r().dC,containerStyle:t.form})]})}function de(e){const t=ce();return(0,u.jsx)(ee,{collectionContextStore:e.collectionContextStore,databaseType:r().dC,containerStyle:t.phoneForm})}function ce(){return(0,a().IS)((e=>({desktopInner:{width:768,height:re,padding:se},phoneInner:{width:"100%",height:"100%"},title:{display:"flex",maxWidth:"60%",alignItems:"center"},emojiTitle:{fontSize:36,marginRight:16},previewTitle:{color:e.text.primary,width:350,fontSize:17,fontWeight:500},form:{width:"45%",height:re,background:e.surface.wash,position:"absolute",top:-se,right:-se,padding:se,zIndex:1,borderLeft:`1px solid ${e.tableDividerColor}`,overflowY:"auto"},phoneForm:{display:"flex",flexDirection:"column",width:"100%",height:"100%",padding:se}})),[])}},957568:(e,t,n)=>{n.r(t),n.d(t,{createRelationViewsModule:()=>m});var o=()=>n(970013),i=()=>n(206267),s=()=>n(179034),a=()=>n(869558),r=()=>n(183558),l=()=>n(44729),d=()=>n(246826),c=()=>n(751156),u=()=>n(594794),p=()=>n(630116);function m(e){const{environment:t,layoutStore:n,collectionStore:m,relationPropertyId:g}=e,f=m.getSchema(),h=g?f[g]:void 0;if(!h||!(0,o().nC)(h))return;const y=h.collection_pointer;if(!y)return;const v=h.property;if(!v)return;const b=p().md.createChildStore(m,y);if(!b)return;const x=b.getParentBlockStore();if(!x)return;const{performResult:S}=c().createAndCommit({environment:t,perform:e=>{const{inMemoryRecordCache:o}=x,p=d().Wv({environment:t,type:"collection_view",inMemoryRecordCache:o,transaction:e}),m=x.getSpaceId(),g=(0,r().Ay)(),f=(0,u().JH)({environment:t,table:a().Gy,spaceId:m}).id,y=p.pointer,S={id:f,type:"table",parent_id:y.id,parent_table:s().ev,space_id:m,alive:!0,name:h.name,format:{collection_pointer:b.pointer,property_filters:[{id:i().JW(),filter:{property:v,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"current_page_in_related_collection"}}}}}],subitem_display_mode:"disabled",hide_linked_collection_name:!0}};c().applyOperation({store:p,operation:{pointer:p.pointer,path:["view_ids"],command:"listAfter",args:{id:f}},transaction:e}),l().NI({childStore:p,parentStore:n,transaction:e}),d().eC({environment:t,table:a().Gy,value:S,inMemoryRecordCache:o,transaction:e});return{id:g,type:"views",collection_view_block_pointer:{...y,spaceId:m}}},canUndo:!0,userAction:"viewsModuleActions.createRelationViewsModule"});return S}},965731:(e,t,n)=>{n.r(t),n.d(t,{ConfigureViewsMainModuleAddViewButton:()=>h});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(959013),r=()=>n(686526),l=()=>n(760217),d=()=>n(939740),c=()=>n(89924),u=()=>n(962730),p=()=>n(377586),m=()=>n(937199),g=n(474848);const f=(0,a().YK)({relatedToDatabase:{defaultMessage:"Related to {database}",id:"pageLayout.configureViews.relatedToDatabase"},linkExistingDatabase:{defaultMessage:"Link existing database",id:"pageLayout.configureViews.linkAnExistingDatabase"}}),h=o.memo((function(e){const{renderOrigin:t,onClose:a}=e,l=(0,i().v3)(),[d,c]=(0,o.useState)(!1),f=(0,o.useRef)(null),{layoutStore:h}=(0,m().LH)(),b=(0,o.useContext)(m().sf),x=null==b?void 0:b.moduleStateByIdStore,S=(0,s().K8)((()=>{var e;const t=h.getModuleByType("viewsMain");if(t)return null==x||null===(e=x.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[h,x]),M=(0,o.useCallback)(((e,t)=>{S&&((0,n(180762).t)({environment:l,collectionContextStore:S,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),r().Ow({collectionContextStore:S,collectionSettingsStore:S.settingsStore,closeOnEscape:!1}))}),[l,S]),A=(0,s().K8)((()=>{var e;const t=null===(e=h.getParentStore())||void 0===e?void 0:e.getModel();if((null==t?void 0:t.table)===n(519831).Vl)return t}),[h]),w=(0,s().K8)((()=>{const e=null==A?void 0:A.getNormalizedSchema();return Object.entries(e??{}).filter((e=>{let[t,o]=e;return(0,n(534177).O9)(o)&&(0,n(970013).nC)(o)&&o.property}))}),[A]),k=(0,o.useCallback)((()=>{c(!1),null==a||a()}),[a]),j=(0,o.useCallback)((()=>{c(!0)}),[c]),C=(0,o.useMemo)((()=>n(757695).default.createValue({open:!1,stack:[]},{name:"newViewsCreationMenuCollectionSettingsStore"})),[]),I=(0,o.useCallback)((()=>{const e=null==S?void 0:S.viewsModuleContextStore.getViewsModule();e&&r().R8({collectionSettingsStore:C,item:{type:"selectViewsModuleSource",module:e}})}),[null==S?void 0:S.viewsModuleContextStore,C]),T=(0,o.useCallback)((()=>{r().os({collectionSettingsStore:C})}),[C]),_=(0,o.useCallback)((()=>(0,g.jsx)(y,{setIsOpen:c,onClose:a,relations:w,setCurrentViewPointer:M,collectionModel:A,viewsMainModuleCollectionContextStore:S,openViewsCreationPopup:I})),[a,w,M,A,S,I]),P=(0,o.useCallback)((e=>t(e)),[t]);return S&&A?(0,g.jsxs)("div",{ref:f,children:[(0,g.jsx)(n(406699).Ay,{alignmentToOrigin:u().C.Center,popupType:p().n.Popup,onClose:k,onClick:j,open:d,render:_,renderOrigin:P,disablePopup:!0}),(0,g.jsx)(v,{buttonRef:f,viewsMainModuleCollectionContextStore:S,viewsCreationMenuCollectionSettingsStore:C,openViewsCreationPopup:I,closeViewsCreationPopup:T})]}):null})),y=o.memo((function(e){const{setIsOpen:t,onClose:s,relations:r,setCurrentViewPointer:u,collectionModel:p,viewsMainModuleCollectionContextStore:h,openViewsCreationPopup:y}=e,v=(0,i().v3)(),b=(0,n(401497).DP)(),{layoutStore:x,setModuleSelection:S}=(0,m().LH)(),M=(0,o.useMemo)((()=>{if(0!==r.length)return{key:0,items:[],render:e=>(0,g.jsx)(c().A,{...e,title:(0,g.jsx)(a().sA,{...f.relatedToDatabase,values:{database:null==p?void 0:p.getName()}}),children:r.map((e=>{let[t,o]=e;return(0,g.jsx)(l().A,{title:null==o?void 0:o.name,icon:(0,g.jsx)(n(743176).zB,{size:16,theme:b,icon:null==o?void 0:o.icon,type:"relation"}),focused:!1,onClick:()=>{if(!h)return;const{viewsMainModule:e,collectionViewPointer:i}=(0,n(626318).ZX)({environment:v,layoutStore:x,relationPropertyId:(null==o?void 0:o.property)??t,targetCollectionPointer:(null==o?void 0:o.collection_pointer)??(null==p?void 0:p.pointer),viewName:null==o?void 0:o.name,viewIcon:null==o?void 0:o.icon});e&&S({type:"existing_module",moduleId:e.id,isDragging:!1}),i&&(n(908006).default.afterNextFlush((()=>{u(i,null==e?void 0:e.id),null==s||s()})),h&&(0,n(154017).b)({environment:v,view_type:"table",collectionContextStore:h}))}},t)}))})}}),[h,p,v,x,s,r,u,S,b]),A=(0,o.useMemo)((()=>{const e=r.length>0;return{key:1,items:[],render:t=>(0,g.jsx)(c().A,{...t,topBorder:e,children:(0,g.jsx)(l().A,{title:(0,g.jsx)(a().sA,{...f.linkExistingDatabase}),icon:(0,g.jsx)(n(745266).h,{color:"regular",viewType:"table"}),onClick:()=>{y()},focused:!1},"link_existing_database")})}}),[y,r.length]);return(0,g.jsx)(n(928600).A,{menuType:n(722872).gu.Popup,onClick:()=>t(!1),width:270,paddingBottom:2,children:(0,g.jsx)(d().Ay,{initialFocus:void 0,sections:[M,A].filter((e=>void 0!==e)),type:d().Oh.Vertical})})})),v=o.memo((function(e){var t;const{buttonRef:i,viewsMainModuleCollectionContextStore:a,viewsCreationMenuCollectionSettingsStore:r,closeViewsCreationPopup:l}=e,d=(0,s().K8)((()=>r.state.open),[r]),c=(0,o.useCallback)((()=>{l()}),[l]),m=(0,o.useCallback)((()=>(0,g.jsx)(n(851739)._,{context:n(525432).Bd.TopbarFilterPopup,collectionContextStore:a,collectionSettingsStore:r,hideDesktopHeader:!0})),[r,a]);return(0,g.jsx)(n(897119).Ay,{open:d,trapFocus:!0,popupType:p().n.Popup,render:m,originRect:null===(t=i.current)||void 0===t?void 0:t.getBoundingClientRect(),alignmentToOrigin:u().C.Center,placementToOrigin:u().W.Bottom,enableOutsideClickDismiss:!0,originGap:4,onDismiss:c})}))},966711:(e,t,n)=>{n.d(t,{m:()=>s});var o=()=>n(847249),i=()=>n(396301);function s(){return(0,o().K8)((()=>(0,i().VR)()),[])}},971320:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{open:!1}}}const i=new o},975081:(e,t,n)=>{n.r(t),n.d(t,{PageLayoutEditor:()=>oo});var o=n(296540),i=()=>n(484714),s=()=>n(847249),a=()=>n(401497),r=()=>n(387964),l=()=>n(22634),d=()=>n(959013),c=()=>n(534177),u=()=>n(145214),p=()=>n(285790),m=()=>n(2143),g=()=>n(852302),f=()=>n(859428),h=()=>n(21140),y=()=>n(753199),v=()=>n(972435),b=()=>n(962730),x=()=>n(756279),S=()=>n(204521),M=()=>n(524165),A=()=>n(812412),w=()=>n(542371),k=()=>n(263711),j=()=>n(148307),C=()=>n(651124),I=()=>n(390066),T=()=>n(738418),_=()=>n(284371),P=()=>n(334261),B=()=>n(896628),R=()=>n(751156),L=()=>n(115552),D=()=>n(678553),O=()=>n(946548),N=()=>n(867159),E=()=>n(645873);const U={switchFromSimpleToTabbedLayoutActions:new(E().O2)("switchFromSimpleToTabbedLayoutActions",(async()=>n.e(63990).then(n.bind(n,288143)))),switchFromTabbedToSimpleLayoutActions:new(E().O2)("switchFromTabbedToSimpleLayoutActions",(async()=>n.e(61362).then(n.bind(n,434867)))),createRelationViewsModuleActions:new(E().O2)("createRelationViewsModuleActinos",(async()=>Promise.resolve().then(n.bind(n,957568)))),deleteViewsModuleDependenciesActions:new(E().O2)("deleteViewsModuleDependenciesActions",(async()=>Promise.resolve().then(n.bind(n,658616))))};n(944114),n(581454);var F=()=>n(970013),V=()=>n(743176),K=()=>n(340498),H=n(474848);const z=(0,K().wt)("propertyText",{viewBox:"0 0 26 17",svg:(0,H.jsx)("path",{d:"M0.066 16V15.296L1.342 14.79L6.688 1.282L7.436 1.172L8.206 0.952L13.266 14.79L14.762 15.274V16H9.108V15.274L10.978 14.768L9.636 10.918H4.268L2.992 14.504L5.104 15.274V16H0.066ZM6.974 3.372L4.752 9.598H9.174L6.996 3.372H6.974ZM18.5422 16.33C17.3762 16.33 15.9022 15.516 15.9022 13.756C15.9022 11.996 17.1782 11.204 19.4442 10.61L21.7102 10.016V8.872C21.6662 7.178 20.7862 6.298 19.6202 6.298C18.9602 6.298 18.4102 6.584 18.2342 6.694L18.1462 8.872C18.1462 8.872 17.5962 8.938 17.2662 8.938C16.5622 8.938 16.2102 8.586 16.2102 7.992C16.2102 6.98 18.1462 5.374 20.4122 5.374C22.6342 5.374 23.6022 6.386 23.6022 8.564V14.504C23.6022 14.944 23.7122 15.098 24.3282 15.098H25.4282V15.714C25.4282 15.714 24.1522 16.264 23.3382 16.264C22.2162 16.264 21.7542 15.494 21.7542 14.548H21.6882C20.4562 15.714 19.9282 16.33 18.5422 16.33ZM19.7082 14.834C20.7642 14.834 21.4462 14.042 21.7102 13.646V10.742L19.5982 11.446C18.5642 11.798 17.9042 12.216 17.9042 13.14C17.9042 14.262 18.7622 14.834 19.7082 14.834Z"})});var W=()=>n(381138),G=()=>n(760217),Y=()=>n(419357),q=()=>n(939740),$=()=>n(89924),Q=()=>n(175116),Z=()=>n(682146),X=()=>n(937199),J=()=>n(369186),ee=()=>n(183558),te=()=>n(978846);function ne(e){const{propertyId:t,propertyType:n,environment:o,transaction:i,layoutStore:s,collectionStore:a,currentModuleSelection:r,sessionId:l,isPropertyCreation:d}=e,c=s.getModel(),u=a.getModel();if(!c||!u||"new_module"!==(null==r?void 0:r.type))return;const p={id:(0,ee().Ay)(),type:"property",propertyId:t,style:"expanded"};if("person"===n||"created_by"===n||"last_edited_by"===n?p.config={property_person:{style:"compact"}}:"number"===n&&(p.config={property_number:{style:"large"}}),"form_conditional_modules"===r.area)return;const m=(0,J().dI)({collectionModel:u,module:p});return(0,te().UQ)({environment:o,transaction:i,layoutStore:s,position:"views_main_tab_modules"===r.area?{type:"area_relative",area:r.area,viewId:r.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:r.area,location:"end_moveable"},module:m,sessionId:l,isPropertyCreation:d}),p}function oe(){const e=(0,i().v3)(),{layoutStore:t,currentModuleSelection:s,setModuleSelection:a,sessionId:r}=(0,X().LH)(),{collectionStore:l}=(0,X().bi)();return(0,o.useCallback)((o=>{let{propertyType:i,isPropertyCreation:d}=o;const{performResult:c}=R().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.handleCreateNewStandardProperty",environment:e,canUndo:!0,perform:o=>{const a=t.getModel(),c=l.getModel();if(!a||!c||"new_module"!==(null==s?void 0:s.type))return;return ne({propertyId:n(235191).IL({environment:e,collectionStore:l,collectionViewArgs:void 0,propertyName:Z().dC[i],propertyType:i,transaction:o}),propertyType:i,environment:e,transaction:o,layoutStore:t,collectionStore:l,currentModuleSelection:s,sessionId:r,isPropertyCreation:d})}});c&&a({type:"existing_module",moduleId:c.id,isDragging:!1})}),[e,a,t,l,s,r])}function ie(){const e=(0,i().v3)(),{layoutStore:t,currentModuleSelection:n,setModuleSelection:s,sessionId:a}=(0,X().LH)(),{collectionStore:r}=(0,X().bi)();return(0,o.useCallback)((o=>{const{propertyId:i,propertyType:l}=o,{performResult:d}=R().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.AddPropertyAsNewModule",environment:e,canUndo:!0,perform:o=>ne({propertyId:i,propertyType:l,environment:e,transaction:o,layoutStore:t,collectionStore:r,currentModuleSelection:n,sessionId:a,isPropertyCreation:!1})});return d?(s({type:"existing_module",moduleId:d.id,isDragging:!1}),d):null}),[e,s,t,r,n,a])}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520);var se=()=>n(713998),ae=()=>n(778781),re=()=>n(248064);function le(e){return void 0!==e[1]}function de(e){let{propertySortPriority:t,defaultCount:i,moreButtonStyle:a,moreButtonTitleStyle:r,isSearching:l}=e;const{layoutStore:u}=(0,X().LH)(),{collectionStore:p}=(0,X().bi)(),m=(0,re().h)(),g=(0,s().K8)((()=>{const e=u.getModules();return new Set((0,n(36682).Q)(e).filter(ae().gx).map((e=>e.propertyId)))}),[u]),[f,h]=o.useState(!1);return(0,s().K8)((()=>{const e=p.getSchema();if(!u.getModel())return[];const o=(0,c().WP)(e).filter(le).sort(((e,n)=>{const o=e[1],i=n[1];return(t[o.type]??1/0)-(t[i.type]??1/0)})).map((e=>{let[t,o]=e;if(t!==F().rn&&!g.has(t))return(0,F().JY)(o)?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"compact"}:(0,F().AM)(o)?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"large"}:"formula"===o.type?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:(0,n(708685).isNumberFormulaPropertySchema)(o)?"large":"small"}:"file"===o.type?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"landscape"}:{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t}})).filter(c().O9).map((t=>{const o=(0,se()._g)({schema:e,property:t.propertyId});if(o)return{key:t.id,keywords:[o.name,Z().dC[o.type]],render:e=>{let{ref:o,...i}=e;return(0,H.jsx)(n(63667).k,{...i,propertyId:t.propertyId})},action:()=>{m({layoutModule:t})}}})).filter(c().O9),s={keywords:[],key:"use-existing-property-show-more",render:e=>(0,H.jsx)(G().A,{...e,buttonStyle:a,desktopTitleStyle:r,title:f?(0,H.jsx)(d().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,H.jsx)(d().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>h((e=>!e))};return o.length>i&&!l?[...f?o:o.slice(0,i),s]:o}),[m,p,u,g,t,i,f,a,r,l])}var ce=()=>n(478573);function ue(e){const{propertyId:t}=e,{collectionStore:n}=(0,X().bi)(),o=(0,a().DP)(),i=(0,s().K8)((()=>{const e=n.getSchema();return(0,se()._g)({schema:e,property:t})}),[n,t]);return i?(0,H.jsx)(ce().A,{...e,icon:(0,H.jsx)(V().zB,{size:16,theme:o,icon:i.icon,type:i.type}),name:i.name}):null}function pe(){const{layoutStore:e,currentModuleSelection:t}=(0,X().LH)(),{collectionStore:a}=(0,X().bi)(),r=(0,n(963589).X)("collection_view_module"),l=(0,i().v3)(),d=(0,re().h)(),u=(0,o.useCallback)((t=>{const o=(0,n(957568).createRelationViewsModule)({environment:l,collectionStore:a,relationPropertyId:t,layoutStore:e});o&&d({layoutModule:o})}),[d,a,e,l]),p=(0,s().K8)((()=>"new_module"===(null==t?void 0:t.type)&&"page_details"===t.area),[t]);return(0,s().K8)((()=>{if(!r||p)return[];const t=a.getSchema();if(!e.getModel())return[];return Object.keys(t).filter((e=>{const n=null==t?void 0:t[e];return n&&(0,F().nC)(n)&&(0,c().O9)(n.property)})).map((e=>{const n=(0,se()._g)({schema:t,property:e});if(n)return{key:e,keywords:[n.name],render:t=>{let{ref:n,...o}=t;return(0,H.jsx)(ue,{...o,propertyId:e})},action:()=>{u(e)}}})).filter(c().O9)}),[r,p,a,e,u])}const me=(0,d().YK)({addToPage:{id:"AddPageLayoutModuleEditorSidebar.addToPage",defaultMessage:"Add to page"},addToPanel:{id:"AddPageLayoutModuleEditorSidebar.addToPanel",defaultMessage:"Add to panel"},suggestedModulesSectionTitle:{defaultMessage:"Suggested",id:"AddPageLayoutModuleEditorSidebar.suggestedModulesSectionTitle"},existingPropertiesSectionTitle:{defaultMessage:"Use an existing property",id:"AddPageLayoutModuleEditorSidebar.existingPropertiesSectionTitle"},relatedCollectionPropertiesSectionTitle:{defaultMessage:"Add a database view",id:"AddPageLayoutModuleEditorSidebar.relatedCollectionPropertiesSectionTitle"},createNewPropertyModuleSectionTitle:{defaultMessage:"Create new property",id:"AddPageLayoutModuleEditorSidebar.createNewPropertyModuleSectionTitle"},closeAddModulesMenu:{defaultMessage:"Close add modules menu",id:"AddPageLayoutModuleEditorSidebar.closeAddModulesMenu"},searchInputPlaceholder:{defaultMessage:"Search...",id:"AddPageLayoutModuleEditorSidebar.searchInputPlaceholder"},propertyFileCaption:{id:"AddPageLayoutModuleButton.tooltip.files.caption",defaultMessage:"Add images, videos, or files"},propertyAiSummaryCaption:{id:"AddPageLayoutModuleButton.tooltip.aiSummary.caption",defaultMessage:"Use AI to summarize the page"},propertyPersonCaption:{id:"AddPageLayoutModuleButton.tooltip.person.caption",defaultMessage:"Add anyone in your workspace"},propertyTextCaption:{id:"AddPageLayoutModuleButton.tooltip.text.caption",defaultMessage:"Just start writing with plain text"},propertyNumberCaption:{id:"AddPageLayoutModuleButton.tooltip.number.caption",defaultMessage:"Display numbers with rings or bars"}}),ge={file:{icon:j().A.images.layouts.configuration.propertyFilesMediaPreviewJpg,tooltip:{image:j().A.images.layouts.configuration.propertyFilesMediaPreviewLargePng,caption:me.propertyFileCaption}},ai_summary:{icon:j().A.images.layouts.configuration.propertyAiSummaryPreviewPng,tooltip:{image:j().A.images.layouts.configuration.propertyAiSummaryPreviewLargePng,caption:me.propertyAiSummaryCaption}},person:{icon:j().A.images.layouts.configuration.propertyPersonPreviewPng,tooltip:{image:j().A.images.layouts.configuration.propertyPersonPreviewLargePng,caption:me.propertyPersonCaption}},text:{icon:z,tooltip:{image:j().A.images.tooltips.blocks.textPng,caption:me.propertyTextCaption}},number:{icon:j().A.images.layouts.configuration.propertyNumberPreviewPng,tooltip:{image:j().A.images.layouts.configuration.propertyNumberPreviewLargePng,caption:me.propertyNumberCaption}}},fe={file:1,ai_summary:2,number:3,text:4,person:5},he=o.memo((function(){const e=(0,i().v3)(),t=(0,a().DP)(),r=(0,d().tz)(),{currentModuleSelection:l,isPropertyTypeSearchInputDirtyStore:c}=(0,X().LH)(),u=(0,Q().ET)(),p="new_module"===(null==l?void 0:l.type)&&"page_details"===l.area,m=(0,s().K8)((()=>[...(0,Z().xm)({collectionContextStore:u,environment:e}),"ai_summary"].sort(((e,t)=>(fe[e]??1/0)-(fe[t]??1/0)))),[u,e]),g=pe(),[f,y]=(0,o.useState)(!1),[v,b]=(0,o.useState)(),x=(0,o.useCallback)((e=>{c.setState(!0),b(e.target.value)}),[c]);o.useEffect((()=>()=>{c.setState(!1)}),[c]);const S=oe(),M=ie(),A=(0,o.useMemo)((()=>({actionHandler:e=>S({propertyType:e,isPropertyCreation:!0}),tooltip:e=>{const t=ge[e];return null==t?void 0:t.tooltip},renderIcon:e=>{const n=ge[e],o="dark"===t.mode&&null!=n&&n.darkModeIcon?null==n?void 0:n.darkModeIcon:null==n?void 0:n.icon;return o&&"string"!=typeof o?o({width:20,fill:"light"===t.mode?"rgba(79, 79, 79, 1)":(0,V().P0)({theme:t,willShowOnTooltip:!1})}):(0,H.jsx)(V().zB,{size:o?36:16,theme:t,type:e,icon:o,style:{fill:(0,F().hN)(e)?t.aiPurpleColor:void 0}})},propertySettingsPopupProps:e=>"relation"!==e?null:{settingsViewToOpen:{property:void 0,type:"selectRelationSource",formatKey:"page_view_properties"},isPropertyEditComplete:e=>Boolean((0,F().nC)(e)&&e.collection_id),onPropertyEditComplete:t=>{M({propertyId:t,propertyType:e})},rollbackIfEditIncomplete:!0}})),[S,t,M]),w=(0,n(959733).g)(A),k=(0,a().IS)((e=>({sidebarHeading:{fontSize:16,lineHeight:"24px",fontWeight:_().Wy.medium,marginLeft:8,paddingBottom:2},searchInputContainer:{marginTop:8,marginBottom:14,marginLeft:6},searchInput:{background:e.contentBackground},searchInputIcon:{fill:e.mediumIconColor,width:10},moreButton:{marginLeft:0},moreButtonTitle:{margin:0,color:e.text.tertiary,fontSize:12,padding:"0 0 0 6px"},sectionTitle:{padding:"0 0 0 6px"}})),[]),j=(0,s().K8)((()=>{const e=v||f,t={keywords:[],key:"create-new-property-more",render:e=>(0,H.jsx)(G().A,{...e,buttonStyle:k.moreButton,desktopTitleStyle:k.moreButtonTitle,title:f?(0,H.jsx)(d().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,H.jsx)(d().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>y((e=>!e))};return[...m.slice(0,e?void 0:5).map(w),...v?[]:[t]]}),[m,f,w,v,k.moreButton,k.moreButtonTitle]),C=de({propertySortPriority:fe,defaultCount:4,moreButtonStyle:k.moreButton,moreButtonTitleStyle:k.moreButtonTitle,isSearching:Boolean(v)}),I=(0,o.useMemo)((()=>{const e=[];return C.length>0&&e.push({key:"existing-properties",render:e=>(0,H.jsx)($().A,{title:r.formatMessage(me.existingPropertiesSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:C}),e.push({key:"create-new-properties",render:e=>(0,H.jsx)($().A,{title:r.formatMessage(me.createNewPropertyModuleSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:j}),g.length>0&&e.push({key:"related-collection-properties",render:e=>(0,H.jsx)($().A,{title:r.formatMessage(me.relatedCollectionPropertiesSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:g}),e}),[j,C,r,g,k.sectionTitle]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(h().Ye,{style:k.sidebarHeading,alignItems:"center",children:(0,H.jsx)(d().sA,{...p?me.addToPanel:me.addToPage})}),(0,H.jsx)(Y().Ay,{focusInitial:!0,onChange:x,placeholder:r.formatMessage(me.searchInputPlaceholder),showClearButton:!0,value:v||"",style:k.searchInputContainer,inputOuterStyle:k.searchInput,inputLeft:(0,W().q)(k.searchInputIcon),itemMarginLeft:0}),(0,H.jsx)(n(387881).j,{filterQuery:v,initialFocus:0,type:q().Oh.Vertical,sections:I})]})}));var ye=()=>n(435930),ve=(n(803949),()=>n(124672)),be=()=>n(623186),xe=()=>n(171018),Se=(n(430670),n.n(n(844751))),Me=()=>n(757695),Ae=()=>n(591779),we=()=>n(643707),ke=()=>n(135154),je=()=>n(953418);function Ce(e){const{propertyGroups:t,propertyIdsToExclude:n,mergedPropertiesMap:a}=e,r=o.useMemo((()=>Me().default.createValue("")),[]),[l,d]=o.useState([]),[c,u]=o.useState({}),[p,m]=o.useState(null),g=o.useMemo((()=>{let e=t?t.flatMap((e=>e.propertyIds||[])):Object.keys(a);return n&&(e=e.filter((e=>!n.has(e)))),e}),[a,t,n]),f=(0,s().O$)(r),h=(0,Ae().lW)(f,100,((e,t)=>e===t));o.useEffect((()=>{const e=[],t={};if(""!==h)for(const n of g){const o=a[n];o&&null!==Se().match(h,o.name)&&(e.push(n),t[n]=e.length-1)}(l.length!==e.length||e.some(((e,t)=>e!==l[t])))&&(d(e),u(t))}),[g,l,h,a]),o.useEffect((()=>{if(0===l.length)return void m(null);const e=null!==p?l[p]:null;e&&void 0!==c[e]?m(c[e]):m(0)}),[p,l,c]);const y=(0,i().v3)(),v=null!==p?l[p]:null;return o.useEffect((()=>{const e=document.getElementsByClassName(we().wT).item(0);e&&!(0,ke().E)({element:e})&&(0,je().uf)({el:e,environment:y,windowHeight:window.innerHeight,minEdgeDist:16})}),[y,v]),{searchInputValueStore:r,searchMatchesMap:c,searchMatches:l,activeSearchMatchIndex:p,moveToNextSearchMatch:()=>{if(null===p||l.length<=1)return;const e=p+1;m(e<=l.length-1?e:0)},moveToPreviousSearchMatch:()=>{if(null===p||l.length<=1)return;const e=p-1;m(e>=0?e:l.length-1)}}}var Ie=()=>n(530041);function Te(e){let{propertyGroupId:t,pagePropertiesStore:n}=e;const{collectionStore:o}=(0,X().bi)(),i=(0,a().IS)((e=>({button:{color:e.text.secondary,paddingLeft:8,height:34},buttonIcon:{fill:e.icon.secondary,marginRight:8}})),[]);return(0,H.jsx)(Ie().Xt,{style:i.button,iconStyle:i.buttonIcon,collectionStore:o,isInPeekRenderer:!1,propertyGroupId:t,pagePropertiesStore:n})}const _e=o.memo(Te);n(16280);var Pe=()=>n(158359),Be=()=>n(498474),Re=()=>n(957963),Le=()=>n(735384),De=()=>n(919709),Oe=()=>n(496603),Ne=()=>n(493823),Ee=()=>n(406699),Ue=()=>n(57232),Fe=()=>n(805751),Ve=()=>n(623580),Ke=()=>n(928600),He=()=>n(897119),ze=()=>n(204063),We=()=>n(722872),Ge=()=>n(463830),Ye=()=>n(395963);class qe extends Me().default{getInitialState(){return{}}isRenameInputForcedOpenForGroup(e){var t;return(null===(t=this.getState())||void 0===t?void 0:t.forceOpenRenameInputForGroupId)===e}resetForceRenameInputOpen(){const e=this.getState();return this.setState({...e,forceOpenRenameInputForGroupId:void 0})}}const $e=new qe;function Qe(e){const{title:t,propertyGroupId:n,isFirstPropertyGroup:r,isLastPropertyGroup:l,styles:c}=e,u=(0,s().uB)(void 0,Ge().A),p=(0,s().K8)((()=>$e.isRenameInputForcedOpenForGroup(n)),[n]),[m,g]=(0,o.useState)(p);(0,o.useEffect)((()=>{u.setState({...u.state,open:p})}),[u,p]);const f=(0,o.useCallback)((()=>{g(!1),$e.resetForceRenameInputOpen()}),[]),h=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)((n=>{R().createAndCommit({environment:t,perform(t){(0,Ye().Px)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),y=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)((n=>{R().createAndCommit({environment:t,perform(t){(0,Ye().Tk)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),v=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)((n=>{R().createAndCommit({environment:t,perform(t){(0,Ye().QI)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),x=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",padding:"0 2px",...(null==c?void 0:c.container)||{}},titleContainer:{display:"flex",alignItems:"center",marginRight:"auto",paddingLeft:5,borderRadius:4,height:"auto",width:"100%"},label:{fontSize:"12px",lineHeight:"24px",color:e.text.secondary,fontWeight:500,padding:"0 8px 0 5px",display:"block",..._().RC},menuIcon:{width:16,height:16},dragIcon:{fill:e.icon.secondary}})),[c]);return(0,H.jsx)("div",{style:x.container,children:(0,H.jsx)(Ee().Ay,{style:{width:268},onClose:f,popupType:He().nl.Popup,renderOrigin:e=>(0,H.jsxs)(Ne().p,{...e,style:x.titleContainer,children:[(0,H.jsx)(Ue().A,{iconSize:12,iconStyle:x.dragIcon}),(0,H.jsx)("div",{style:x.label,children:t})]}),buttonPopupStore:u,alignmentToOrigin:b().C.Start,render:e=>{return m?(0,H.jsx)(Ze,{propertyGroupId:n,value:t||"",afterSubmit:e.close}):(0,H.jsx)(Ke().A,{menuType:We().gu.Popup,children:(0,H.jsx)(q().Ay,{type:q().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,H.jsx)($().A,{...e}),items:(o=e.close,(0,Oe().oE)([{key:"rename",render:e=>(0,H.jsx)(G().A,{...e,icon:(0,Re().j)(x.menuIcon),title:(0,H.jsx)(d().sA,{defaultMessage:"Rename",id:"ConfigurePropertyGroupModuleGroupHeading.rename"})}),action:()=>{g(!0)}},!r&&{key:"move-up",render:e=>(0,H.jsx)(G().A,{...e,icon:(0,Be().q)(x.menuIcon),title:(0,H.jsx)(d().sA,{defaultMessage:"Move up",id:"ConfigurePropertyGroupModuleGroupHeading.moveUp"})}),action:()=>{y(n),o()}},!l&&{key:"move-down",render:e=>(0,H.jsx)(G().A,{...e,icon:(0,Pe().P)(x.menuIcon),title:(0,H.jsx)(d().sA,{defaultMessage:"Move down",id:"ConfigurePropertyGroupModuleGroupHeading.moveDown"})}),action:()=>{v(n),o()}},{key:"delete",render:e=>(0,H.jsx)(G().A,{...e,icon:(0,Le().I)({width:16,height:16}),title:(0,H.jsx)(d().sA,{defaultMessage:"Delete",id:"ConfigurePropertyGroupModuleGroupHeading.delete"}),caption:(0,H.jsx)(d().sA,{defaultMessage:"No properties will be deleted",id:"ConfigurePropertyGroupModuleGroupHeading.deleteCaption"})}),action:()=>{h(n),o()}}]))}]})});var o}})})}function Ze(e){let{propertyGroupId:t,afterSubmit:n,value:s}=e;const[r,l]=(0,o.useState)(s),c=(0,a().IS)((()=>({container:{display:"flex",padding:"6px"},input:{marginRight:4,flexGrow:1},button:{}})),[]),u=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)();return(0,o.useCallback)(((n,o)=>{const i=e.getNormalizedPropertyGroups();if(void 0===i)throw new Error("Error renaming property group. Collection Does not have property groups.");const s=i.map((e=>e.id===n?{...e,title:o}:e));R().createAndCommit({environment:t,perform(t){B().zA({stores:[e],update:{property_groups:s},transaction:t})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.renameCollectionPropertyGroup"})}),[e,t])}(),p=(0,o.useCallback)((()=>{const e=(0,De().xV3)(r).trim();0!==e.length&&(u(t,e),n())}),[n,u,r,t]),m=(0,o.useCallback)((e=>{l(e.target.value)}),[]);return(0,H.jsx)(Fe().A,{debugName:"ConfigurePropertyGroupHeader",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,H.jsxs)("div",{style:c.container,children:[(0,H.jsx)(Ve().A,{style:c.input,onSubmit:p,selectAll:!0,value:r,onChange:m,focusInitial:!0}),(0,H.jsx)(ze().A,{style:c.button,onClick:p,children:(0,H.jsx)(d().sA,{id:"ConfigurePropertyGroupModuleGroupHeading.updatePropertyGroupTitle",defaultMessage:"Done"})})]})})}var Xe=()=>n(387358),Je=()=>n(439264);n(18107);function et(e){let{sections:t,onDrop:n,renderKey:i,getInvalidDropIndices:s,direction:r}=e;const[l,d]=o.useState({type:"notDragging"}),u=(0,o.useMemo)((()=>{const e={};for(const n of t)e[ot(n.key)]=n;return e}),[t]),p=(0,o.useCallback)((e=>(0,c().O9)(u[ot(e)])),[u]),m=(0,o.useMemo)((()=>t.flatMap((e=>[e.key,...e.items]))),[t]),g=(0,o.useMemo)((()=>m.map(ot)),[m]),f=(0,o.useMemo)((()=>{const e={};for(const t of m)e[ot(t)]=t;return e}),[m]),h=o.useCallback(((e,o)=>{let{key:i}=o;p(i)?n({newSections:nt({orderedSectionKeys:e.filter(p),originalSections:t}),droppedKey:i,isSection:!0}):n({newSections:tt({flattenedKeys:e.map((e=>f[e])),getIsSection:p}),droppedKey:i,isSection:!1})}),[p,n,t,f]),y=o.useCallback((e=>{p(e)?d({type:"draggingSection",key:e}):d({type:"draggingItem",key:e})}),[p]),v=o.useCallback((()=>d({type:"notDragging"})),[]),b=(0,o.useCallback)((e=>{let t;t=p(e)?new Set(m.flatMap(((e,t)=>p(e)?[]:[t]))):new Set([0]);const n=null==s?void 0:s({flattenedKeys:g,...p(e)?{isSection:!0,key:e}:{isSection:!1,key:e}});return n?new Set([...t,...n]):t}),[s,p,m,g]),x=(0,a().IS)((e=>{const t={opacity:1,transition:"opacity 0.2s ease"},n={...t,opacity:.7};return{container:{},undraggedSection:t,draggedSection:n,undraggedItem:{...t,width:"100%"},draggedItem:{...n,width:"100%"},itemInDraggedSection:{...t,opacity:0,width:"100%"}}}),[]),S=(0,o.useMemo)((()=>{const e="draggingSection"===l.type?l.key:void 0,n="draggingItem"===l.type?l.key:void 0,o={};return t.forEach(((t,n)=>{const s=ot(t.key),a=e===s;o[s]=(0,H.jsx)("div",{style:a?x.draggedSection:x.undraggedSection,children:i({key:s,isDraggable:it(t.key),isSection:!0,sectionIndex:n,sectionLength:t.items.length})})})),t.forEach(((t,s)=>{const a=e===ot(t.key);return t.items.forEach(((e,r)=>{const l=n===ot(e),d=t.items.length,c=ot(e);o[c]=(0,H.jsx)("div",{style:l?x.draggedItem:a?x.itemInDraggedSection:x.undraggedItem,children:i({key:ot(e),isDraggable:it(e),isSection:!1,sectionIndex:s,itemIndex:r,sectionLength:d})})}))})),o}),[l,i,t,x.draggedItem,x.draggedSection,x.itemInDraggedSection,x.undraggedItem,x.undraggedSection]);return(0,H.jsx)(Je().Ay,{style:x.container,direction:r,keys:m,renderKey:e=>S[e],onDraggingKeyChanged:y,onDragEnd:v,onDrop:h,getInvalidDropIndices:b})}function tt(e){let{flattenedKeys:t,getIsSection:n}=e;const o=function(e){let{orderedList:t,getIsSection:n}=e;const o=t.findIndex((e=>n(e)));if(-1===o||0===o)return t;return[t[o],...t.slice(0,o),...t.slice(o+1)]}({orderedList:t,getIsSection:n}),i=[];for(const s of o)if(n(s))i.push({key:s,items:[]});else{const e=s,t=i.at(-1);t&&t.items.push(e)}return i}function nt(e){let{orderedSectionKeys:t,originalSections:n}=e;const o={};for(const i of n)o[ot(i.key)]={key:i.key,items:i.items};return t.flatMap((e=>o[e]?[o[e]]:[]))}function ot(e){return"string"==typeof e?e:e.key}function it(e){return"string"==typeof e||(e.draggable??!0)}const st=o.memo(et);function at(e){const{collectionFormat:t,mergedProperties:n,renderPropertyRow:i}=e,{collectionStore:a}=(0,X().bi)(),r=(0,s().K8)((()=>null==n?void 0:n.map((e=>e.property))),[n]),l=(0,o.useCallback)(((e,t)=>i({propertyId:e,rowIndex:t})),[i]),d=(0,be().Od)({collectionStore:a,format:t});return r?(0,H.jsx)(Je().Ay,{keys:r,onDrop:d,direction:"vertical",renderKey:l}):null}function rt(e){const{renderPropertyRow:t,renderPropertyGroupRow:n,renderAddPropertyButton:a}=e,r=(0,i().v3)(),{collectionStore:l}=(0,X().bi)(),d=(0,s().K8)((()=>l.getNormalizedPropertyGroups()??[]),[l]),u=(0,o.useMemo)((()=>Object.fromEntries(d.map((e=>[e.id,e])))),[d]),p=(0,s().K8)((()=>d.map((e=>{var t;return{key:{key:e.id,draggable:!0},items:[...(null===(t=e.propertyIds)||void 0===t?void 0:t.map((e=>({key:e,draggable:!0}))))??[],(0,Xe().Op)(e.id)]}}))),[d]),m=(0,o.useCallback)((e=>{let{flattenedKeys:t,isSection:n}=e;return n?new Set(t.flatMap(((e,t)=>(0,c().O9)(u[e])?[]:[t]))):new Set(t.flatMap(((e,t)=>(0,Xe().k9)(e)?[t+1]:[])))}),[u]),g=(0,o.useCallback)((e=>{var o;return e.isSection?n({groupId:e.key,groupTitle:null===(o=u[e.key])||void 0===o?void 0:o.title,rowIndex:e.sectionIndex}):(0,Xe().k9)(e.key)?a((0,Xe().qB)(e.key)):t({propertyId:e.key,rowIndex:e.sectionIndex})}),[u,a,n,t]),f=(0,o.useCallback)((e=>{const t=e.newSections.map((e=>{var t;const n=e.items.map((e=>"string"==typeof e?e:e.key)).filter((e=>!(0,Xe().k9)(e))),o="string"==typeof e.key?e.key:e.key.key;return{id:o,title:null===(t=u[o])||void 0===t?void 0:t.title,propertyIds:n}}));R().createAndCommit({environment:r,perform(e){(0,Ye().Yf)({collectionStore:l,newGroups:t,transaction:e})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"})}),[l,r,u]);return(0,H.jsx)(st,{direction:"vertical",sections:p,renderKey:g,onDrop:f,getInvalidDropIndices:m})}var lt=()=>n(851979),dt=()=>n(369);const ct=(0,K().wt)("eyelash",{viewBox:"0 0 16 16",svg:(0,H.jsx)("path",{fillRule:"evenodd",d:"M2.1488 5.12366C1.94088 4.76541 1.48191 4.64354 1.12366 4.85145C0.76541 5.05937 0.643537 5.51833 0.851451 5.87659C1.05856 6.23345 1.30425 6.56012 1.58188 6.85746L0.46967 7.96967C0.176777 8.26256 0.176777 8.73744 0.46967 9.03033C0.762563 9.32322 1.23744 9.32322 1.53033 9.03033L2.73804 7.82262C3.18107 8.11266 3.66308 8.35645 4.17017 8.55584L3.30384 10.7217C3.15001 11.1062 3.33707 11.5427 3.72166 11.6966C4.10624 11.8504 4.54272 11.6633 4.69656 11.2787L5.61111 8.99235C6.14972 9.11164 6.70058 9.18864 7.25 9.22519V11.5C7.25 11.9142 7.58579 12.25 8 12.25C8.41421 12.25 8.75 11.9142 8.75 11.5V9.2252C9.29955 9.18866 9.85054 9.11164 10.3893 8.99232L11.3038 11.2787C11.4577 11.6633 11.8942 11.8504 12.2787 11.6966C12.6633 11.5427 12.8504 11.1062 12.6966 10.7217L11.8302 8.55579C12.3372 8.35643 12.8191 8.11269 13.2621 7.82272L14.4697 9.03033C14.7626 9.32322 15.2374 9.32322 15.5303 9.03033C15.8232 8.73744 15.8232 8.26256 15.5303 7.96967L14.4182 6.85759C14.6959 6.56021 14.9417 6.2335 15.1488 5.87659C15.3567 5.51833 15.2348 5.05937 14.8766 4.85145C14.5183 4.64354 14.0594 4.76541 13.8515 5.12366C12.883 6.79244 10.5428 7.75012 8.00012 7.75012C5.45748 7.75012 3.11728 6.79244 2.1488 5.12366Z"})});var ut=()=>n(68350);function pt(e){let{collectionStore:t,pageStore:n,layoutModule:i,pagePropertiesStore:r,propertyId:l,draggable:d,rightButton:c,searchHighlighted:u}=e;const p=(0,s().K8)((()=>n.isNonEditableState()),[n]),{collectionSchema:m,collectionFormat:g,canEditCollection:f}=(0,s().K8)((()=>({collectionSchema:t.getSchema(),collectionFormat:t.getFormat(),canEditCollection:t.canEdit()})),[t]),h=(0,a().IS)((()=>({propertyRowContainer:{width:"100%",minWidth:"100%",display:"grid",alignItems:"center",gridTemplateColumns:"1fr auto",gap:2,paddingLeft:2}})),[]),y=(0,o.useMemo)((()=>({color:"primary",size:"medium",fontWeight:"regular",width:{variant:"fixed",widthDesktop:"100%",widthMobile:"100%"}})),[]),v=Boolean(u),b=Boolean(u&&u.active);return(0,H.jsxs)("div",{style:h.propertyRowContainer,children:[(0,H.jsx)(ut().I,{schema:m,styleVariants:y,format:g,property:l,collectionStore:t,disabled:!1,locked:p,canConfigureCollection:f,isInPeekRenderer:!1,hideDragHandle:!d,showDragHandleAsIcon:!0,dragHandleStyle:{width:16,marginRight:2},blockStore:n,pagePropertiesStore:r,layoutModule:i,forceHighlight:v,forceFocusedHighlight:b}),c?c():null]})}function mt(e){const{propertyId:t,propertyFormat:n,pagePropertiesStore:a,collectionStore:r,pageStore:l,searchHighlighted:c}=e,u=(0,d().tz)(),m=(0,i().v3)(),g=(0,s().K8)((()=>r.getSchema()),[r]),f=(0,s().K8)((()=>(0,I().L)(r.getFormat(),g,void 0,C().jf.Collection)),[r,g]),h=g[t],y=(0,o.useCallback)((e=>{R().createAndCommit({environment:m,userAction:"LayoutBuilder.propertiesConfiguration.toggleVisibility",canUndo:!0,perform:n=>{P().D7({property:t,visibility:e,store:r,format:f,transaction:n})}})}),[f,r,m,t]),v="show"===(null==n?void 0:n.visibility)?lt().h:"hide_if_empty"===(null==n?void 0:n.visibility)?dt().R:ct,x="show"===(null==n?void 0:n.visibility)||"hide_if_empty"===(null==n?void 0:n.visibility);if(!h)return null;return(0,H.jsx)(pt,{pageStore:l,collectionStore:r,propertyId:t,pagePropertiesStore:a,draggable:!0,rightButton:()=>(0,H.jsx)(Ee().Ay,{popupType:He().nl.Popup,renderOrigin:e=>(0,H.jsx)(p().A,{ariaLabel:u.formatMessage(ft.visibilityToggleIconAriaLabel,{propertyName:h.name}),icon:v,isDarkIconColor:x,...e}),alignmentToOrigin:b().C.Start,render:e=>(0,H.jsx)(gt,{parentClose:e.close,setVisibilityOfProperty:y})}),searchHighlighted:c,layoutModule:e.layoutModule})}function gt(e){const{setVisibilityOfProperty:t,parentClose:n}=e,i=(0,o.useMemo)((()=>[{key:0,render:e=>(0,H.jsx)($().A,{...e}),items:[{key:"always_show",render:e=>(0,H.jsx)(G().A,{...e,icon:(0,lt().h)({width:16,height:16}),title:(0,H.jsx)(d().sA,{defaultMessage:"Always show",id:"ConfigurePropertiesPropertyRow.visibility.alwaysShow"})}),action:()=>{t("show"),n()}},{key:"hide_if_empty",render:e=>(0,H.jsx)(G().A,{...e,icon:(0,dt().R)({width:16,height:16}),title:(0,H.jsx)(d().sA,{defaultMessage:"Hide when empty",id:"ConfigurePropertiesPropertyRow.visibility.hide_when_empty"})}),action:()=>{t("hide_if_empty"),n()}},{key:"hide",render:e=>(0,H.jsx)(G().A,{...e,icon:ct({width:16,height:16}),title:(0,H.jsx)(d().sA,{defaultMessage:"Always hide",id:"ConfigurePropertiesPropertyRow.visibility.alwaysHide"})}),action:()=>{t("hide"),n()}}]}]),[n,t]);return(0,H.jsx)(Ke().A,{menuType:We().gu.Popup,children:(0,H.jsx)(q().Ay,{type:q().Oh.Vertical,initialFocus:0,sections:i})})}const ft=(0,d().YK)({visibilityToggleIconAriaLabel:{id:"pageLayout.configureProperties.visibilityToggleIconAriaLabel",defaultMessage:"Toggle the visibility {propertyName}"}}),ht=(0,d().YK)({filterPropertiesInputPlaceholder:{id:"layouts.configurePropertiesModule.filterProperties.input.placeholder",defaultMessage:"Search..."},notFound:{id:"layouts.configurePropertiesModule.filterProperties.input.notFound",defaultMessage:"Not Found"},arrowButtonDownAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonDown.ariaLabel",defaultMessage:"Button to navigate to the next result"},arrowButtonUpAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonUp.ariaLabel",defaultMessage:"Button to navigate to the previous result"}});function yt(e){const{searchInputValueStore:t,activeSearchMatchIndex:n,searchMatches:i,moveToNextSearchMatch:r,moveToPreviousSearchMatch:l}=e,c=(0,s().O$)(t),u=(0,d().tz)(),m=o.useCallback((e=>{"Enter"===e.key?(e.preventDefault(),r()):"ArrowUp"===e.key?l():"ArrowDown"===e.key&&r()}),[r,l]),g=(0,a().IS)((e=>({searchMatchCount:{fontSize:".8rem",color:e.text.tertiary,userSelect:"none",cursor:"default",flexShrink:0,marginRight:4},searchMatchArrowButton:{padding:3,width:void 0,height:void 0,cursor:"pointer"},searchMatchArrowIcon:{width:12,height:12,color:e.icon.secondary,strokeWidth:.4,stroke:"currentcolor"},searchInputIcon:{fill:e.mediumIconColor,width:10},searchInputOuter:{background:e.white}})),[]),f=o.useMemo((()=>{if(""!==c)return(0,H.jsxs)(h().Ye,{alignItems:"center",gap:8,children:[(0,H.jsx)("div",{children:null!==n?`${n+1} of ${i.length}`:u.formatMessage(ht.notFound)}),null!==n&&(0,H.jsxs)(h().Ye,{gap:0,alignItems:"center",children:[(0,H.jsx)(p().A,{icon:Pe().P,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:u.formatMessage(ht.arrowButtonDownAriaLabel),onClick:r}),(0,H.jsx)(p().A,{icon:Be().q,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:u.formatMessage(ht.arrowButtonUpAriaLabel),onClick:l})]})]})}),[c,n,i.length,u,g,r,l]);return(0,H.jsx)(Y().Ay,{focusInitial:!0,itemMarginLeft:0,itemMarginRight:0,onChange:e=>{t.setState(e.target.value.trim())},onKeyDown:m,placeholder:u.formatMessage(ht.filterPropertiesInputPlaceholder),showClearButton:!0,value:c,inputLeft:(0,W().q)(g.searchInputIcon),inputOuterStyle:g.searchInputOuter,inputRightStyle:g.searchMatchCount,inputRight:f})}function vt(e){const{module:t}=e,{layoutStore:n}=(0,X().LH)(),{collectionStore:i,pageStore:r}=(0,X().bi)(),l=(0,s().K8)((()=>n.getModules()),[n]),d=(0,s().K8)((()=>i.getSchema()),[i]),u=(0,s().K8)((()=>(0,I().L)(i.getFormat(),d,void 0,C().jf.Collection)),[i,d]),p=(0,o.useMemo)((()=>new Set((0,ve().q)({modulesByArea:l,collectionSchema:d,collectionFormat:u}))),[u,l,d]),g=(0,o.useMemo)((()=>new(xe().YB)),[]),f=(0,s().K8)((()=>i.getNormalizedPropertyGroups()),[i]),y=(0,s().K8)((()=>{const e={};return null==f||f.forEach(((t,n)=>{e[t.id]=n})),e}),[f]),v=(0,be().z7)({store:r,format:u,schema:d,collectionStore:i}),b=(0,o.useMemo)((()=>{const e={};return v.forEach((t=>e[t.property]=t)),e}),[v]),{searchInputValueStore:S,searchMatches:M,searchMatchesMap:A,activeSearchMatchIndex:w,moveToNextSearchMatch:k,moveToPreviousSearchMatch:j}=Ce({mergedPropertiesMap:b,propertyGroups:f,propertyIdsToExclude:p}),T=(0,o.useCallback)((e=>{let{propertyId:n}=e;if(p.has(n))return null;const o=void 0!==A[n]&&null!==w?{active:n===M[w]}:void 0;return(0,H.jsx)(mt,{propertyId:n,propertyFormat:b[n],collectionStore:i,pagePropertiesStore:g,pageStore:r,searchHighlighted:o,layoutModule:t})}),[w,i,b,t,g,r,p,M,A]),_=(0,o.useCallback)((e=>{let{groupId:t,groupTitle:n}=e;const o=y[t],i=0===o,s=(0,c().O9)(f)&&o===f.length-1,a={container:i?void 0:{marginTop:20}};return(0,H.jsx)(Qe,{title:n,propertyGroupId:t,isFirstPropertyGroup:i,isLastPropertyGroup:s,styles:a})}),[y,f]),P=(0,o.useCallback)((e=>(0,H.jsx)(_e,{propertyGroupId:e,pagePropertiesStore:g})),[g]),B=Boolean(v.length&&v.length>p.size),R=(0,a().IS)((e=>({addPropertyButtonContainer:{marginLeft:2,paddingBottom:8},container:{marginTop:B?4:8,height:"100%",overflow:"visible hidden",marginLeft:-Jt,width:`calc(100% + ${2*Jt}px)`},searchInputContainer:{marginRight:Jt,marginLeft:Jt,flexShrink:0,paddingTop:2,overflow:"visible",marginBottom:14,paddingLeft:6,paddingRight:6},listContainer:{padding:`0 ${Jt}px 56px`}})),[B]);return(0,H.jsxs)(h().wt,{style:R.container,children:[B&&(0,H.jsx)("div",{style:R.searchInputContainer,children:(0,H.jsx)(yt,{searchInputValueStore:S,activeSearchMatchIndex:w,searchMatches:M,moveToNextSearchMatch:k,moveToPreviousSearchMatch:j})}),(0,H.jsx)(m().H,{type:x().A.Y,style:R.listContainer,children:Boolean(f)?(0,H.jsx)(rt,{renderPropertyRow:T,renderPropertyGroupRow:_,renderAddPropertyButton:P}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(at,{collectionFormat:u,mergedProperties:v,renderPropertyRow:T}),(0,H.jsx)("div",{style:R.addPropertyButtonContainer,children:(0,H.jsx)(_e,{pagePropertiesStore:g})})]})})]})}var bt=()=>n(464699),xt=()=>n(115512);const St=(0,d().YK)({addSection:{id:"NewCollectionPropertyGroupButton.label",defaultMessage:"Add section"},newSection:{id:"NewCollectionPropertyGroupButton.newItemName",defaultMessage:"New section"}});function Mt(){const{collectionStore:e}=(0,X().bi)(),t=(0,i().v3)(),n=(0,d().tz)(),s=(0,a().IS)((e=>({button:{fontSize:(0,xt().ny)(t,"UISmall"),color:e.text.secondary,padding:8,fontWeight:_().Wy.medium},icon:{fill:e.icon.secondary,marginRight:4}})),[t]),r=(0,o.useCallback)((()=>{const o=n.formatMessage(St.newSection),{performResult:i}=R().createAndCommit({environment:t,perform:t=>(0,Ye().PA)({collectionStore:e,newGroupTitle:o,transaction:t}),canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"});i&&$e.setState({forceOpenRenameInputForGroupId:i})}),[e,t,n]);return(0,H.jsx)(Ne().p,{icon:bt().b,onClick:r,style:s.button,iconStyle:s.icon,children:(0,H.jsx)(d().sA,{...St.addSection})})}function At(e){const{title:t}=e;return(0,H.jsxs)(h().Ye,{justifyContent:"space-between",children:[t,(0,H.jsx)(Mt,{})]})}var wt=()=>n(686526),kt=()=>n(59400),jt=()=>n(525432);function Ct(e){return(0,H.jsx)("div",{style:{marginLeft:-8,marginRight:-8},children:e.children})}function It(e){let{module:t}=e;const{collectionStore:n}=(0,X().bi)(),i=(0,Q().ET)(),a=(0,s().K8)((()=>n.getSchema()),[n]),r=(0,s().K8)((()=>{if((0,ae().gx)(t))return t}),[t]),l=(0,s().K8)((()=>r&&a[r.propertyId]),[r,a]);if((0,o.useEffect)((()=>{if(r)return wt().Ow({collectionContextStore:i,collectionSettingsStore:i.settingsStore,closeOnEscape:!1}),wt().dP({collectionSettingsStore:i.settingsStore,item:{type:"property",property:r.propertyId,formatKey:void 0}}),()=>{wt().os({collectionSettingsStore:i.settingsStore})}}),[i,r]),!l||!r)return null;const d=(0,H.jsx)("span",{style:{fontSize:16,lineHeight:"24px",fontWeight:_().Wy.medium},children:Z().dC[l.type]});return(0,H.jsx)(Ct,{children:(0,H.jsx)(kt().m$,{collectionContextStore:i,collectionSettingsStore:i.settingsStore,context:jt().Bd.ViewSettings,collectionSettingsPropertyTitleOverride:d,fullHeight:!0})})}n(672577);var Tt=()=>n(487929);function _t(e){let{module:t}=e;const{collectionStore:n,pageStore:o}=(0,X().bi)(),i=(0,a().IS)((e=>({configureContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:12,marginTop:16},configureDescription:{fontSize:_().J.UISmall.desktop,fontWeight:_().Wy.regular,color:e.text.secondary,marginLeft:8}})),[]);return(0,H.jsxs)("div",{style:i.configureContainer,children:[(0,H.jsx)("div",{style:i.configureDescription,children:(0,H.jsx)(d().sA,{defaultMessage:"Relations can be shown as either minimal or responsive page sections",id:"pageLayout.ConfigureRelationsGroupModule.moduleDescription"})}),(0,H.jsx)(Pt,{layoutModule:t,pageStore:o,collectionStore:n})]})}function Pt(e){let{collectionStore:t,pageStore:n,layoutModule:a}=e;const r=(0,i().v3)(),l=(0,o.useMemo)((()=>new(xe().YB)),[]),{collectionPagePropertySections:d}=(0,s().K8)((()=>{const e=t.getSchema(),n=t.getFormat();return{collectionPagePropertySections:(0,Tt().T)({format:n,schema:e,visibilityLevels:["inline","minimal"]})}}),[t]),c=d.map((e=>e.section)),u=(0,o.useCallback)((e=>{if(!d)return;const n=e.map((e=>{const t=d.find((t=>t.section===e));if(!t)throw Error("collection does not have a section corresponding to one of the dropped keys");return t}));R().createAndCommit({userAction:"ConfigureRelationsGroupModule.onDraggablePageSectionsDrop",environment:r,canUndo:!0,perform:e=>{P().LK({environment:r,pageSectionFormats:n,store:t,transaction:e})}})}),[d,t,r]);return d.length?(0,H.jsx)(Je().Ay,{direction:"vertical",keys:c,renderKey:e=>(0,H.jsx)(pt,{pageStore:n,collectionStore:t,propertyId:e,pagePropertiesStore:l,layoutModule:a,draggable:!0}),onDrop:e=>u(e)}):null}var Bt=()=>n(552445),Rt=()=>n(788941),Lt=()=>n(410730),Dt=()=>n(447934),Ot=()=>n(33218);function Nt(e){const{environment:t,layoutModule:n,collectionStore:o,layoutStore:i,propertyId:s}=e,a=o.getSchema(),r=i.getModel(),l=null==r?void 0:r.getPageModuleAreaById(n.id);if(!l||!r||"normalizedTitleWithIcon"!==n.type)return;const{pinnedPropertyIds:d}=function(e,t,n){let o,i=[...t??[]];return i.includes(e)?(i=i.filter((t=>t!==e)),o=!1):(i.push(e),i.length>Lt().U&&(i=(0,se().Vl)(i,n)),o=!0),{isNowPinned:o,pinnedPropertyIds:i}}(s,n.propertyIds,a),c={...n,propertyIds:d};R().createAndCommit({environment:t,perform(e){(0,Dt().HD)({environment:t,transaction:e,property:s,layoutStore:i}),(0,Ot().UQ)({environment:t,transaction:e,layoutStore:i,position:{area:l,moduleId:n.id},updatedModule:c})},canUndo:!0,userAction:"titleWithIconActions.togglePinnedProperty"})}var Et=()=>n(557198);function Ut(e){let{module:t}=e;const{collectionStore:n,pageStore:r}=(0,X().bi)(),l=(0,i().v3)(),{layoutStore:u}=(0,X().LH)(),p=(0,s().K8)((()=>n.getSchema()),[n]),m=(0,s().K8)((()=>(0,I().L)(n.getFormat(),p,void 0,C().jf.Collection)),[n,p]),g=(0,o.useMemo)((()=>new(xe().YB)),[]),y=(0,o.useMemo)((()=>"normalizedTitleWithIcon"!==t.type?[]:(0,se().Vl)(t.propertyIds,p)),[t,p]),v=(0,o.useMemo)((()=>new Set(y)),[y]),x=(0,s().K8)((()=>{var e;return null===(e=m.property_visibility||[])||void 0===e?void 0:e.map((e=>e.property)).filter((e=>!(0,F().NM)(e)&&!v.has(e)))}),[m.property_visibility,v]),S=(0,s().K8)((()=>(0,c().uv)(p)),[p]),M=(0,be().z7)({store:r,format:m,schema:p,collectionStore:n,propertyIds:S}),A=(0,o.useMemo)((()=>{const e={};for(const t of M)e[t.property]=t;return e}),[M]),{searchInputValueStore:w,searchMatches:k,activeSearchMatchIndex:j,moveToNextSearchMatch:T,moveToPreviousSearchMatch:P,searchMatchesMap:B}=Ce({mergedPropertiesMap:A,propertyGroups:void 0,propertyIdsToExclude:void 0}),L=function(e){const t=(0,i().v3)(),{layoutStore:n}=(0,X().LH)();return(0,o.useCallback)((o=>{const i=n.getModel(),s=null==i?void 0:i.getPageModuleAreaById(e.id);if(!s||!i)return;const a={...e,propertyIds:o};R().createAndCommit({environment:t,perform(o){(0,Ot().UQ)({environment:t,transaction:o,layoutStore:n,position:{area:s,moduleId:e.id},updatedModule:a})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handlePinnedPropertyReorderDrop"})}),[t,e,n])}(t),E=(0,a().IS)((e=>{const t={fontSize:_().J.UISmall.desktop,lineHeight:"24px",color:e.text.secondary,fontWeight:500};return{container:{height:"100%",overflow:"visible hidden",gap:14,marginLeft:-Jt,width:`calc(100% + ${2*Jt}px)`},propertySearchInputContainer:{flexShrink:0,margin:`10px ${Jt+6}px 0`},scrollableContainer:{padding:`0 ${Jt}px 56px`,flexGrow:1,overflow:"hidden auto"},pinnedPropertiesLabel:{...t,marginLeft:8},optionsContainer:{marginTop:24},optionsLabel:{...t,marginLeft:6,marginBottom:6},switcherButton:{marginRight:0},addPropertyButton:{color:e.text.secondary,height:34},addPropertyButtonIcon:{color:e.text.secondary}}}),[]),U=y.length?(0,H.jsx)(Je().Ay,{keys:y,onDrop:L,direction:"vertical",renderKey:e=>(0,H.jsx)(Vt,{layoutModule:t,propertyId:e,isPinned:!0,draggable:!0,pinButtonDisabled:!1,pagePropertiesStore:g,searchHighlighted:null!==j&&void 0!==B[e]?{active:e===k[j]}:void 0})}):null,V=y.length>=Lt().U,K=x.map((e=>(0,H.jsx)(Vt,{layoutModule:t,propertyId:e,isPinned:!1,draggable:!1,pinButtonDisabled:V,pagePropertiesStore:g,searchHighlighted:null!==j&&void 0!==B[e]?{active:e===k[j]}:void 0},e))),z=Ft(t),W=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,H.jsx)(Ie().Xt,{...e,style:E.addPropertyButton,iconStyle:E.addPropertyButtonIcon,collectionStore:n,isInPeekRenderer:!1,pagePropertiesStore:g,onPropertyAdded:z,disabled:V})},{backlinksVisibility:G,updateBacklinksVisibility:Y}=(0,Et().Ap)({store:n,format:m}),q=(0,d().tz)(),$=(0,o.useCallback)((()=>{const e="show"===t.propertyLabels||!t.propertyLabels;R().createAndCommit({environment:l,perform(n){var o;const i=null===(o=u.getModel())||void 0===o?void 0:o.getPageModuleAreaById(t.id);i&&(0,Ot().UQ)({environment:l,transaction:n,layoutStore:u,position:{area:i,moduleId:t.id},updatedModule:{...t,propertyLabels:e?"hide":"show"}})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handleShowPropertyLabels"})}),[t,l,u]),Q=(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{style:{...E.pinnedPropertiesLabel},children:(0,H.jsx)(d().sA,{...Kt.pinnedPropertiesLabel})}),U,(0,H.jsx)("div",{style:{marginLeft:2},children:V?(0,H.jsx)(f().A,{placement:b().W.Left,render:e=>W(e),renderTooltip:()=>q.formatMessage(Kt.maxPinnedPropertiesAddPropertyTooltip,{br:(0,H.jsx)("br",{})})}):W()}),K.length>0&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{style:{...E.pinnedPropertiesLabel,marginTop:24},children:(0,H.jsx)(d().sA,{...Kt.unpinnedPropertiesLabel})}),K]})]});return(0,H.jsxs)(h().wt,{style:E.container,children:[(0,H.jsx)("div",{style:E.propertySearchInputContainer,children:(0,H.jsx)(yt,{activeSearchMatchIndex:j,searchMatches:k,moveToNextSearchMatch:T,moveToPreviousSearchMatch:P,searchInputValueStore:w})}),(0,H.jsxs)("div",{style:E.scrollableContainer,children:[Q,(0,H.jsxs)("div",{style:E.optionsContainer,children:[(0,H.jsx)("div",{style:E.optionsLabel,children:(0,H.jsx)(d().sA,{...Kt.optionsLabel})}),(0,H.jsx)(D().Ay,{title:(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.showPropertyLabels",defaultMessage:"Property labels"}),onClick:$,right:(0,H.jsx)(O().A,{on:"show"===t.propertyLabels||void 0===t.propertyLabels}),rightStyle:E.switcherButton}),(0,H.jsx)(D().Ay,{right:(0,H.jsx)(N().p7,{currentVisibility:G,onSelect:Y}),rightStyle:E.switcherButton,title:(0,H.jsx)(d().sA,{...Kt.showBacklinksOption})})]})]})]})}function Ft(e){const{layoutStore:t}=(0,X().LH)(),{collectionStore:n}=(0,X().bi)(),s=(0,i().v3)();return(0,o.useCallback)((o=>{Nt({environment:s,layoutModule:e,collectionStore:n,layoutStore:t,propertyId:o})}),[s,e,n,t])}function Vt(e){let{layoutModule:t,propertyId:n,isPinned:o,pinButtonDisabled:i,...r}=e;const l=(0,d().tz)(),c=(0,a().DP)(),{collectionStore:u,pageStore:m}=(0,X().bi)(),g=(0,s().K8)((()=>u.getSchema()),[u])[n],h=Ft(t);if(!g)return null;const y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,H.jsx)(p().A,{...e,disabled:i,ariaLabel:o?l.formatMessage(Kt.toggleUnpinnedAriaLabel,{propertyName:g.name}):l.formatMessage(Kt.togglePinnedAriaLabel,{propertyName:g.name}),icon:o?Rt().b:Bt().N,iconStyle:{fill:c.icon.primary},onClick:()=>h(n)})};return(0,H.jsx)(pt,{pageStore:m,collectionStore:u,propertyId:n,layoutModule:t,rightButton:()=>i?(0,H.jsx)(f().A,{placement:b().W.Left,render:e=>y(e),renderTooltip:()=>l.formatMessage(Kt.maxPinnedPropertiesTooltip,{br:(0,H.jsx)("br",{})})}):y(),...r})}const Kt=(0,d().YK)({togglePinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.togglePinnedAriaLabel",defaultMessage:"Show {propertyName} as pinned"},toggleUnpinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.toggleUnpinnedAriaLabel",defaultMessage:"Do not show {propertyName} as pinned"},pinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.pinnedPropertiesLabel",defaultMessage:"Pinned properties"},unpinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.unpinnedPropertiesLabel",defaultMessage:"Unpinned properties"},maxPinnedPropertiesTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to pin another."},maxPinnedPropertiesAddPropertyTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesAddPropertyTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to create a new pinned property."},optionsLabel:{id:"pageLayout.configurePinnedProperties.optionsLabel",defaultMessage:"Options"},showBacklinksOption:{id:"pageLayout.configurePinnedProperties.showBacklinksOption",defaultMessage:"Backlinks"}});var Ht=()=>n(180762);const zt=o.memo((function(e){let{module:t}=e;const{moduleStateByIdStore:o}=(0,X().bi)(),i=(0,s().K8)((()=>{var e;return null===(e=o.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[o,t.id]),r=(0,s().K8)((()=>{var e;return null==i||null===(e=i.collectionViewStore())||void 0===e?void 0:e.id}),[i]),l=(0,s().K8)((()=>null==i?void 0:i.settingsStore),[i]),c=(0,a().IS)((()=>({titleWrapper:{...$t,marginBottom:6,display:"flex"},viewsContainer:{marginTop:8,width:"100%",display:"flex",flexDirection:"column"}})),[]),u=(0,s().K8)((()=>{var e;return null==i||null===(e=i.settingsStore)||void 0===e?void 0:e.getState().open}),[i]);return"viewsMain"===t.type&&i&&l&&u?(0,H.jsx)(Ct,{children:(0,H.jsx)(Q().p2.Provider,{value:i,children:(0,H.jsx)(kt().m$,{collectionContextStore:i,collectionSettingsStore:l,context:jt().Bd.ViewSettings})})}):(0,H.jsxs)("div",{children:[(0,H.jsx)("div",{style:c.titleWrapper,children:(0,H.jsx)(d().sA,{...ye().s.viewsMain})}),(0,H.jsxs)("div",{style:c.viewsContainer,children:[(0,H.jsx)(Wt,{collectionContextStore:i,currentViewId:r,module:t}),"viewsMain"===t.type&&(0,H.jsx)(n(965731).ConfigureViewsMainModuleAddViewButton,{renderOrigin:e=>(0,H.jsx)(Ne().p,{icon:n(689094).W,isGray:!0,...e,children:(0,H.jsx)(d().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"})})})]})]})}));function Wt(e){let{collectionContextStore:t,currentViewId:o,module:a}=e;const r=(0,i().v3)(),l=(0,s().K8)((()=>{if(!t)return[];const e=t.collectionViewBlockStore(),n=null==e?void 0:e.getCollectionViewStores();return null==n?void 0:n.map((e=>{var t;return{id:e.id,icon:null===(t=e.getFormat())||void 0===t?void 0:t.collection_view_icon,type:e.getType(),name:e.getName(),pointer:e.pointer}}))}),[t]);return"editor"===a.type?(0,H.jsx)(Ne().p,{children:(0,H.jsx)("div",{style:{fontWeight:600},children:(0,H.jsx)(d().sA,{...ye().s.editor})})},"editor"):l&&t?(0,H.jsx)(H.Fragment,{children:l.map((e=>(0,H.jsx)(Ne().p,{icon:t=>(0,H.jsx)(n(745266).h,{viewIcon:e.icon,viewType:e.type,color:"regular",style:t}),onClick:()=>{(0,Ht().t)({environment:r,collectionContextStore:t,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),wt().Ow({collectionContextStore:t,collectionSettingsStore:t.settingsStore})},children:(0,H.jsx)("div",{style:{fontWeight:e.id===o?600:void 0},children:void 0!==e.type?(0,n(519839).OO)({collectionViewName:e.name,collectionViewType:e.type}):(0,H.jsx)(d().sA,{...Gt.newView})})},e.id)))}):null}const Gt=(0,d().YK)({newView:{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"}});function Yt(e){let{module:t}=e;const{moduleStateByIdStore:n}=(0,X().bi)(),o=(0,s().K8)((()=>{var e;return null===(e=n.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[n,t.id]),i=(0,s().K8)((()=>null==o?void 0:o.settingsStore),[o]);return t&&o&&i?(0,H.jsx)(Ct,{children:(0,H.jsx)(Q().p2.Provider,{value:o,children:(0,H.jsx)(kt().m$,{collectionContextStore:o,collectionSettingsStore:i,context:jt().Bd.ViewSettings})})}):null}function qt(e){let{moduleId:t}=e;const{layoutStore:n}=(0,X().LH)(),o=(0,s().K8)((()=>n.getModuleById(t)),[n,t]),i=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",..."properties"!==(null==o?void 0:o.type)&&"normalizedTitleWithIcon"!==(null==o?void 0:o.type)?{paddingBottom:80}:{height:"100%"}}})),[null==o?void 0:o.type]);return o?(0,H.jsxs)("div",{style:i.container,children:[(r=o,"viewsMain"!==r.type&&"editor"!==r.type&&!(0,ae().gx)(r)&&(0,H.jsx)(Qt,{module:o})),(0,H.jsx)(Zt,{module:o})]}):null;var r}const $t={fontWeight:_().Wy.medium,marginBottom:0,marginLeft:6,fontSize:16,lineHeight:"24px"};function Qt(e){const{module:t}=e,n=(0,H.jsx)("div",{style:$t,children:(0,H.jsx)(d().sA,{...ye().s[t.type]})});return"properties"===t.type?(0,H.jsx)(At,{title:n}):n}function Zt(e){const{module:t}=e;if((0,ae().gx)(t))return(0,H.jsx)(It,{module:t});const{type:n}=t;switch(n){case"properties":return(0,H.jsx)(vt,{module:t});case"normalizedTitleWithIcon":return(0,H.jsx)(Ut,{module:t});case"relationsGroup":return(0,H.jsx)(_t,{module:t});case"views":return(0,H.jsx)(Yt,{module:t});case"viewsMain":case"editor":return(0,H.jsx)(zt,{module:t});case"deleted_property":case"cover":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"transcript":case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":case"recentActivity":case"collaborators":case"teamspaces":return null;default:(0,c().HB)(n)}return null}const Xt=290,Jt=16;function en(){const{currentModuleSelection:e,layoutStore:t,sessionId:n}=(0,X().LH)(),{collectionStore:o,pageStore:i}=(0,X().bi)(),r=(0,s().K8)((()=>{const e=o.getFormat(),t=o.getSchema();return(0,I().L)(e,t,void 0,C().jf.Collection)}),[o]),l=(0,a().IS)((t=>({container:{padding:`8px ${Jt}px ${"existing_module"===(null==e?void 0:e.type)?"0":"24px"}`,minWidth:Xt,width:Xt,maxWidth:Xt},title:{fontSize:16,lineHeight:"24px",fontWeight:_().Wy.medium,margin:"0px 8px 0px 8px"},label:{fontSize:_().J.UISmall.desktop,fontWeight:_().Wy.medium,margin:"24px 8px 6px 8px",color:t.text.secondary},switcherButton:{marginRight:0}})),[e]),c=(0,s().K8)((()=>Boolean(o.getFormat().external_object_id)),[o]);return e?(0,H.jsxs)(m().H,{type:x().A.Y,style:l.container,children:["existing_module"===e.type&&(0,H.jsx)(qt,{moduleId:e.moduleId}),"new_module"===e.type&&(0,H.jsx)(he,{})]}):(0,H.jsxs)("div",{style:l.container,children:[(0,H.jsx)("div",{style:l.title,children:(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.title",defaultMessage:"Page settings"})}),(0,H.jsx)(tn,{collectionStore:o,layoutStore:t,sessionId:n,styles:l}),(0,H.jsx)("div",{style:l.label,children:(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.options",defaultMessage:"Options"})}),(0,H.jsx)(on,{disabled:c,collectionStore:o,normalizedCollectionFormat:r,styles:l}),(0,H.jsx)(nn,{disabled:c,collectionStore:o,normalizedCollectionFormat:r,styles:l}),(0,H.jsx)(sn,{layoutStore:t,styles:l}),(0,H.jsx)(an,{pageStore:i,layoutStore:t,styles:l})]})}function tn(e){const{collectionStore:t,layoutStore:n,sessionId:a,styles:r}=e,l=(0,i().v3)(),u=(0,s().K8)((()=>n.isTabbedPageLayout()),[n]),{value:p}=(0,E().fJ)(U.switchFromSimpleToTabbedLayoutActions),{value:m}=(0,E().fJ)(U.switchFromTabbedToSimpleLayoutActions),g=!p||!m,f=u?"tabbed":"simple",h=(0,o.useMemo)((()=>({available:["simple","tabbed"],appearance:{simple:{label:(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.structure.simple",defaultMessage:"Simple"}),image:{src:j().A.images.layouts.configuration.simplePageLayoutStructurePng,width:112,height:80}},tabbed:{label:(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.structure.tabbed",defaultMessage:"Tabbed"}),image:{src:j().A.images.layouts.configuration.tabbedPageLayoutStructurePng,width:112,height:80}}}})),[]),y=(0,o.useCallback)((async e=>{p&&m&&("simple"===e?m.switchFromTabbedToSimpleLayout({environment:l,layoutStore:n}):"tabbed"===e?await p.switchFromSimpleToTabbedLayout({environment:l,layoutStore:n}):(0,c().HB)(e),(0,S().GF)({environment:l,layoutId:n.id,collectionId:t.id,sessionId:a,structure:e}))}),[p,m,l,n,t.id,a]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{style:r.label,children:(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.structure",defaultMessage:"Structure"})}),(0,H.jsx)(L().A,{disabled:g,options:h,selectedOption:f,onOptionSelected:y,height:"tall"})]})}function nn(e){var t;const{disabled:n,collectionStore:s,normalizedCollectionFormat:a,styles:r}=e,l=(0,i().v3)(),c="section_hide"===(null===(t=a.page_section_visibility)||void 0===t?void 0:t.comments)?"section_hide":"section_show",u=(0,o.useCallback)((e=>{const t=s.getFormat(),n=s.getSchema(),o=(0,I().L)(t,n,void 0,C().jf.Collection);P().OD({environment:l,pageSection:"comments",visibility:e,store:s,format:o})}),[s,l]);return(0,H.jsx)(D().Ay,{title:(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.pageDiscussions",defaultMessage:"Page discussions"}),right:(0,H.jsx)(N().kS,{disabled:n,currentVisibility:c,onSelect:u}),rightStyle:r.switcherButton})}function on(e){var t;const n=(0,i().v3)(),{disabled:s,collectionStore:a,normalizedCollectionFormat:r,styles:l}=e,c="minimal"===(null===(t=r.page_section_visibility)||void 0===t?void 0:t.margin_comments)?"minimal":"inline",u=(0,o.useCallback)((e=>{const t=a.getFormat(),o=a.getSchema(),i=(0,I().L)(t,o,void 0,C().jf.Collection);P().OD({environment:n,pageSection:"margin_comments",visibility:e,store:a,format:i})}),[a,n]);return(0,H.jsx)(D().Ay,{title:(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.inlineComments",defaultMessage:"Inline comments"}),right:(0,H.jsx)(N().J8,{disabled:s,currentVisibility:c,onSelect:u}),rightStyle:l.switcherButton})}function sn(e){const{layoutStore:t,styles:n}=e,a=(0,i().v3)(),r=(0,s().K8)((()=>{var e;return"show"===((null===(e=t.getFormat())||void 0===e?void 0:e.property_icons_visibility)??"show")}),[t]),l=(0,o.useCallback)((()=>{R().createAndCommit({environment:a,userAction:"pageLayoutActions.handleShowPropertyIcons",canUndo:!0,perform:e=>{var n;B().zA({stores:[t],update:{property_icons_visibility:"hide"===(null===(n=t.getFormat())||void 0===n?void 0:n.property_icons_visibility)?"show":"hide"},transaction:e})}})}),[t,a]);return(0,H.jsx)(D().Ay,{title:(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.showPropertyIcons",defaultMessage:"Property icons"}),onClick:l,right:(0,H.jsx)(O().A,{on:r}),rightStyle:n.switcherButton})}function an(e){const{pageStore:t,layoutStore:n,styles:r}=e,l=(0,i().v3)(),c=(0,s().K8)((()=>n.getFormatStore().getKeyValue("page_full_width")),[n]),u=(0,o.useCallback)((()=>{R().createAndCommit({environment:l,userAction:"pageLayoutActions.handleShowFullWidth",canUndo:!0,perform:e=>{const o=!n.getFormatStore().getKeyValue("page_full_width");B().zA({stores:[n],update:{page_full_width:o},transaction:e}),void 0!==t.getFormatStore().getKeyValue("page_full_width")&&B().zA({stores:[t],update:{page_full_width:void 0},transaction:e})}})}),[n,l,t]),p=(0,a().IS)((e=>({icon:{height:14,width:14,color:e.icon.secondary},title:{display:"flex",alignItems:"center",gap:"4px"},tooltip:{maxWidth:240,width:"max-content",overflowWrap:"break-word",textWrap:"wrap"}})),[]);return(0,H.jsx)(D().Ay,{title:(0,H.jsxs)("div",{style:p.title,children:[(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth",defaultMessage:"Full width"}),(0,H.jsx)(f().A,{placement:b().W.Bottom,renderTooltip:()=>(0,H.jsx)(d().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth.tooltip",defaultMessage:"Page width can be overwritten on individual pages."}),render:e=>(0,H.jsx)("div",{...e,children:(0,T().G)(p.icon)}),style:p.tooltip})]}),onClick:u,right:(0,H.jsx)(O().A,{on:Boolean(c)}),rightStyle:r.switcherButton})}var rn=()=>n(761660),ln=()=>n(607810),dn=()=>n(817942),cn=()=>n(604341),un=()=>n(475140),pn=()=>n(179034),mn=()=>n(507807);function gn(e){var t;const{layoutStore:o,tabToFocus:i,moduleStateByIdStore:s,environment:a}=e,r=o.pointer,l=o.getModules(),d=(0,un().EX)(l,(e=>"viewsMain"===e.type));if(!d||!(0,ae().y6)(d.module))return;const{module:u}=d,p=null==s||null===(t=s.get(u.id))||void 0===t?void 0:t.collectionContextStore;if(!p)return;const m=n(148832).B.createChildStore(o,u.collection_view_block_pointer).getCollectionViewStores();let g;"viewId"===(null==i?void 0:i.type)?g=null==m?void 0:m.find((e=>{var t;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id)===i.viewId})):"contentTab"===(null==i?void 0:i.type)?g=null==m?void 0:m.find((e=>{var t;if("page"!==e.getType())return!1;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.id)===r.id})):(0,c().HB)(i),g&&(0,Ht().t)({environment:a,collectionContextStore:p,collectionViewId:g.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}var fn=()=>n(792071),hn=()=>n(763824),yn=()=>n(414360),vn=()=>n(630116);async function bn(e){const{environment:t,layoutStore:n,blockPointer:o}=e,i=vn().Bv.createChildStore(n,o);if(await i.load(),!i.isCollectionView())return;const s=i.getCollectionViewStores();await(0,hn().lX)(s,25,(e=>e.load()));const a=s.filter((e=>"page"===e.getType()));if(a.length<=1)return;const r=n.getModules(),l=(0,un().JO)(r,ae().gp);if(!l||"views_main_tab_modules"!==l.area)return;const d=l.viewId,c=a.find((e=>{var t;const n=null===(t=e.getFormat())||void 0===t?void 0:t.page_layout_pointer;return!!n&&n.views_main_tab_id===d}));if(!c)return;const u=a.filter((e=>e!==c));0!==u.length&&R().createAndCommit({environment:t,userAction:"cleanupDuplicateContentTabsInTabbedCollectionViewBlock",canUndo:!1,perform:e=>{for(const s of u){var t,o;const a=null===(t=s.getFormat())||void 0===t||null===(t=t.page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id;if((0,yn().T)({collectionViewBlockStore:i,collectionViewStore:s,transaction:e}),!a)continue;const r=(null===(o=n.getRawModules())||void 0===o||null===(o=o.views_main_tab_modules)||void 0===o?void 0:o[a])||[];for(const t of r.reverse())R().applyOperation({store:n,transaction:e,operation:fn().N4X.putModuleBeforeOrAfter({pointer:n.pointer,area:"views_main_tab_modules",viewId:d,module:t,direction:"before",beforeOrAfterId:void 0})});R().applyOperation({store:n,transaction:e,operation:fn().N4X.deleteViewTabModulesTab({pointer:n.pointer,viewId:a})})}}})}async function xn(e){const{environment:t,layoutStore:o}=e;await async function(e){const{environment:t,layoutStore:n}=e;if(!n.isTabbedPageLayout())return;const o=n.getBlockChildrenPointers();for(const s of o){var i;null!==(i=n.getModel())&&void 0!==i&&i.isTabbedLayoutCollectionViewBlockPointer(s)&&await bn({environment:t,layoutStore:n,blockPointer:s})}}({environment:t,layoutStore:o}),(0,n(210748).O)({environment:t,layoutStore:o})}const Sn=o.memo((function(e){let{children:t,collectionStore:a,pageStore:r,sessionId:l,layoutBuilderModuleSelectionStore:d}=e;const c=(0,i().v3)(),u=(0,s().K8)((()=>{var e;return null===(e=n(351360).default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),p=(0,s().K8)((()=>a.getSpaceId()),[a]),m=(0,o.useMemo)((()=>(null==r?void 0:r.id)??(0,n(594794).Z1)({environment:c,table:pn().ev,spaceId:p})),[c,null==r?void 0:r.id,p]),g=(0,o.useCallback)((e=>{var t;if(e.operation.pointer.id===m)return!1;if((null===(t=e.operation)||void 0===t||null===(t=t.args)||void 0===t?void 0:t.parent_id)===m)throw new Error("Unexpected operation on temporary page.");return!0}),[m]),f=(0,mn().S)(n(342).oB,{canUndo:!1,shouldPersistOperation:r?void 0:g}),h=(0,s().K8)((()=>{if(r)return r.clone(f.cache);return R().createAndCommit({environment:c,perform(e){const t=n(246826).Wv({environment:c,type:"page",id:m,inMemoryRecordCache:f.cache,transaction:e});return R().applyOperation({store:t,operation:n(134025).op.update({pointer:{id:t.pointer.id,table:pn().ev,spaceId:t.pointer.spaceId},path:[],args:{parent_id:a.id,parent_table:a.table}}),transaction:e}),t},userAction:"PageLayoutEditorContext.createEmptyPageStore",canUndo:!1}).performResult}),[a,f.cache,c,r,m]),y=function(e,t){const a=(0,i().v3)(),r=(0,o.useMemo)((()=>new(n(889097).A)(a)),[a]),l=(0,mn().f)(e,t),d=(0,s().K8)((()=>null==t?void 0:t.getParentBlockStore()),[t]);return(0,o.useEffect)((()=>{r.setContext({type:"collectionPage",collectionViewBlockStore:d,collectionStore:l})}),[r,l,d]),r}(f,a),{unpersistedCollectionStore:v,unpersistedLayoutStore:b,modulesByArea:x}=(0,s().K8)((()=>{const e=y.collectionStore(),t=null==e?void 0:e.getLayoutStore();return{unpersistedCollectionStore:e,unpersistedLayoutStore:t,modulesByArea:null==t?void 0:t.getModules()}}),[y]),[S,M]=(0,o.useState)(void 0);(0,n(543906).A)((()=>{M((0,Oe().mg)(x))}),Boolean(x));const A=(0,s().uB)(void 0,n(731120).A),w=o.useRef(!1);(0,s().K8)((()=>{u&&v&&!b&&(R().createAndCommit({environment:c,perform:e=>Dt().$L({environment:c,transaction:e,collectionStore:v,userId:u}),userAction:"PageLayoutEditorContext.initCollectionLayout",canUndo:!1}),w.current=!0)}),[c,v,b,u]);const k=(0,o.useCallback)((async()=>{if(u&&b)return await xn({environment:c,layoutStore:b}),f.persist("PageLayoutEditorContext.updateLayout")}),[f,c,b,u]),j=(0,o.useCallback)((()=>{f.reset();const e=a.getLayoutStore();return!!e&&(R().createAndCommit({environment:c,perform(t){Ot().gL({environment:c,transaction:t,layoutStore:e,collectionStore:a})},userAction:"PageLayoutEditorContext.resetLayoutToDefault",canUndo:!1}),!0)}),[a,f,c]),C=(0,s().K8)((()=>d.getState()),[d]),I=(0,s().K8)((()=>h.isReady()&&(null==b?void 0:b.isReady())),[b,h]),[T,_]=(0,o.useState)([]),P=(0,o.useMemo)((()=>new(n(265515).G)),[]),B=(0,o.useCallback)((e=>{if(d.setState(e),b&&e&&"existing_module"===e.type&&e.moduleId){const t=null==b?void 0:b.getModules();if(!t)return;const n=(0,un().EX)(t,(t=>t.id===e.moduleId));n&&"views_main_tab_modules"===n.position.area&&gn({tabToFocus:{type:"contentTab"},layoutStore:b,moduleStateByIdStore:P,environment:c})}}),[c,d,P,b]),L=Me().default.createValue(!1),D=(0,o.useMemo)((()=>b&&{layoutStore:b,collectionStore:v,currentModuleSelection:C,setModuleSelection:B,sessionId:l,addModuleHoverMenuStore:A,canEditLayout:!0,isPropertyTypeSearchInputDirtyStore:L,layoutBuilderModuleSelectionStore:d}),[b,v,C,B,l,A,L,d]),O=(0,o.useMemo)((()=>v&&{pageStore:h,hasUnsavedChanges:f.hasChanges,saveChanges:k,moduleIdsMovedFromSidebar:T,setModuleIdsMovedFromSidebar:_,isNewLayout:w.current,initialLayoutModulesByArea:S,resetLayoutToDefault:j,moduleStateByIdStore:P,collectionContextStore:y,collectionStore:v}),[v,h,f.hasChanges,k,T,S,j,P,y]);return I&&b&&D&&O?(0,H.jsx)(Q().RI,{value:y,children:(0,H.jsx)(X().Op.Provider,{value:D,children:(0,H.jsxs)(X().sf.Provider,{value:O,children:[(0,cn().isConsoleEnabled)()&&(0,H.jsx)(Mn,{}),t]})})}):null}));function Mn(){return(0,o.useEffect)((()=>()=>{(0,cn().exposeDebugValue)("baseLayoutEditorContext",void 0),(0,cn().exposeDebugValue)("pageLayoutEditorContext",void 0)}),[]),(0,cn().exposeDebugValue)("baseLayoutEditorContext",(0,X().LH)()),(0,cn().exposeDebugValue)("pageLayoutEditorContext",(0,X().bi)()),null}var An=n.n(n(32485)),wn=()=>n(212050),kn=()=>n(175947),jn=()=>n(901389),Cn=()=>n(614505),In=()=>n(16006),Tn=()=>n(38337),_n=()=>n(948914),Pn=()=>n(668725),Bn=()=>n(245241),Rn=()=>n(331542),Ln=()=>n(64e3),Dn=()=>n(958378),On=()=>n(553965),Nn=()=>n(135599);function En(e){let{collectionStore:t}=e;const n=(0,o.useRef)(null),[i,a]=o.useState(""),{pageStore:r}=(0,X().bi)(),{results:l,isResultsLoading:c}=(0,Nn().W)({query:i,type:Bn().Vz.BlocksInCollection,source:"layout_builder_page_selector",limit:10,collectionId:t.id,options:{disable:!1}}),u=(0,s().K8)((()=>c?[{key:"loading",action:()=>{},render:e=>(0,H.jsx)(Ln().A,{...e,title:(0,H.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,H.jsx)(Rn().A,{})})})}]:0===l.length?[{key:"no_results",action:()=>{},render:e=>(0,H.jsx)(Ln().A,{...e,title:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.pagePicker.noResults",defaultMessage:"No results."})})}]:l.map((e=>{const t=(null==r?void 0:r.id)===e.id;return{key:e.id,render:n=>(0,H.jsx)(Dn().A,{...n,store:e.store,hidePath:!0,isChecked:t}),action:()=>{if(t)return;if(!k().g.state.isOpen||"layout-editor"!==k().g.state.mode)throw new Error("Expected page layout editor to be open.");const n={isOpen:k().g.state.isOpen,mode:"layout-editor",pageStore:e.store,sessionId:k().g.state.sessionId,collectionStore:k().g.state.collectionStore};k().g.setState(n)}}}))),[null==r?void 0:r.id,c,l]),p=(0,H.jsx)($().A,{isInput:!0,style:{paddingBottom:0},desktopTitleStyle:{paddingBottom:0,marginBottom:0},children:(0,H.jsx)(Y().Ay,{ref:n,value:i,placeholder:v().A.formatMessage(Fn.searchPlaceholder),focusAfterAnimation:!0,showClearButton:!0,style:{marginBottom:10},onChange:e=>{a(e.target.value)},focusInitial:l.length>0||void 0})}),m=(0,H.jsx)(Ke().A,{menuType:We().gu.Popup,header:p,width:300,children:(0,H.jsx)(q().Ay,{type:q().Oh.Vertical,style:{marginBottom:0},sections:[{key:"results",items:u,render:e=>(0,H.jsx)($().A,{...e})}],initialFocus:l.length>0?0:void 0})});return(0,H.jsx)(Ee().Ay,{popupType:Ee().z7.Popup,renderOrigin:e=>(0,H.jsx)(Un,{...e,pageStore:r}),originGap:2,render:()=>m,onClose:()=>a("")})}function Un(e){const{pageStore:t,...n}=e,o=(0,a().IS)((e=>({previewButton:{color:e.text.secondary,fontWeight:_().Wy.medium,display:"flex",gap:6,alignItems:"center",justifyContent:"center",padding:"3px 6px",height:void 0,fontSize:12,overflow:"hidden",maxWidth:"100%"},recordTitle:{..._().RC,flexGrow:1},previewLabelContainer:{display:"flex",gap:3,minWidth:0},previewLabel:{flexShrink:0},chevronDownIcon:{flexShrink:0,width:10}})),[]);return(0,H.jsx)(f().A,{placement:b().W.Right,renderTooltip:()=>(0,H.jsx)(d().sA,{defaultMessage:"Choose page to preview",id:"PageLayoutEditorHeader.pagePicker.title"}),render:e=>(0,H.jsxs)(Ne().p,{...(0,On().A)(e,n),style:o.previewButton,children:[(0,H.jsxs)("div",{style:o.previewLabelContainer,children:[(0,H.jsx)("div",{style:o.previewLabel,children:(0,H.jsx)(d().sA,{defaultMessage:"Preview:",id:"PageLayoutEditorHeader.pagePicker.titlePrefix"})}),(0,H.jsx)(In().A,{store:t,style:o.recordTitle})]}),(0,Pn().b)(o.chevronDownIcon)]})})}const Fn=(0,d().YK)({searchPlaceholder:{id:"pageLayoutEditor.pagePicker.searchPlaceholder",defaultMessage:"Search pages..."}});const Vn=function(){const e=(0,d().tz)(),t=(0,i().v3)(),{setModuleSelection:s,currentModuleSelection:r,layoutStore:l,sessionId:c}=(0,X().LH)(),u=void 0===r,p=(0,o.useCallback)((()=>{var e;null==s||s(void 0),(0,S().L3)({environment:t,layoutId:l.id,collectionId:null===(e=l.getCollectionModel())||void 0===e?void 0:e.id,sessionId:c,from:"page_settings_button_click"})}),[s,t,l,c]),m=(0,a().IS)((e=>({button:{...u&&{background:e.state.hover}},icon:{width:K().Ev.default,height:K().Ev.default}})),[u]);return s?(0,H.jsx)(Ne().p,{"aria-label":e.formatMessage({id:"pageLayoutEditorPageSettingsButton.ariaLabel",defaultMessage:"Page settings"}),icon:n(735790).M,iconStyle:m.icon,onClick:p,style:m.button,size:"lg",children:(0,H.jsx)(d().sA,{id:"pageLayoutEditorPageSettingsButton.label",defaultMessage:"Page settings"})}):null},Kn=(0,K().xh)("arrowUTurnUpLeft",{default:{loader:()=>n.e(75152).then(n.bind(n,454503))},small:{loader:()=>n.e(75152).then(n.bind(n,613601))},fill:{loader:()=>n.e(75152).then(n.bind(n,357715))},fillSmall:{loader:()=>n.e(75152).then(n.bind(n,139274))}},["uturn","left","reverse","direction","turn","undo","back"]);var Hn=()=>n(701545),zn=()=>n(112452),Wn=()=>n(7674),Gn=()=>n(107683),Yn=()=>n(430102),qn=()=>n(716108),$n=()=>n(377586);const Qn={id:"pageLayoutAreas.page_main",defaultMessage:"main page",description:"Name for the main area of the page"},Zn={id:"pageLayoutAreas.page_details",defaultMessage:"sidebar",description:"Name for the details sidebar"},Xn={id:"pageLayoutAreas.form_layout_schema",defaultMessage:"form",description:"Name for the form area"},Jn=(0,d().YK)({page_main:Qn,page_layout_schema:Qn,page_details:Zn,page_info_layout_schema:Zn,form_layout_schema:Xn,form_conditional_modules:Xn,views_main_tab_modules:{id:"pageLayoutAreas.views_main_tab_modules",defaultMessage:"views main tab",description:"Name for the views main tab"},person_profile_page_main:{id:"pageLayoutAreas.person_profile_page_main",defaultMessage:"person profile main column",description:"Name for the person profile page main area (primary column)"},person_profile_page_details:{id:"pageLayoutAreas.person_profile_page_details",defaultMessage:"person profile details column",description:"Name for the person profile page details area (secondary column)"},generic:{id:"pageLayoutEditor.generic",defaultMessage:"area"}});function eo(){const{collectionStore:e,hasUnsavedChanges:t,saveChanges:n,isNewLayout:r,initialLayoutModulesByArea:l,resetLayoutToDefault:c}=(0,X().bi)(),{sessionId:u,layoutStore:p}=(0,X().LH)(),m=(0,i().v3)(),g=(0,d().tz)(),[f,y]=(0,o.useState)(!1),v=(0,s().K8)((()=>p.getModules()),[p]),x=(0,a().IS)((e=>({saveButton:{height:32},saveButtonCheckMarkIcon:{width:14,height:14},saveButtonInner:{lineHeight:1.2,fontSize:14,fontWeight:_().Wy.medium},saveButtonRevertItemTitle:{fontSize:_().J.UIRegular.desktop,lineHeight:"20px",color:e.text.primary},saveButtonRevertItemIcon:{width:16,height:16,marginTop:2,fill:e.primaryBlack},saveButtonRevertItem:{margin:"4px",padding:"0 4px 4px"},saveButtonSectionMenuItem:{minWidth:254,padding:0}})),[]),M=(0,o.useCallback)((t=>{Dt().Fv({environment:m}),S().do({environment:m,sessionId:u,collectionId:e.id,existingLayoutId:r?void 0:p.id,layoutSaved:t,context:"layout",initialLayoutModulesByArea:l,finalModulesByArea:v})}),[e.id,m,l,r,p.id,u,v]),A=(0,o.useCallback)((async()=>{if(t){y(!0);try{await n(),M(!0)}catch(e){if(y(!1),!(e instanceof qn().rS))throw e;{const t=e.clientData;if("cannot_move_unmoveable_module"===(null==t?void 0:t.type))jn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeMoved",defaultMessage:"The {moduleType} module cannot be moved."},{moduleType:g.formatMessage(ye().s[t.moduleType]).toLowerCase()}));else if("cannot_remove_undeletable_module"===(null==t?void 0:t.type))jn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeDeleted",defaultMessage:"The {moduleType} module cannot be removed."},{moduleType:g.formatMessage(ye().s[t.moduleType]).toLowerCase()}));else if("unallowed_module_in_area"===(null==t?void 0:t.type)){const e={moduleType:g.formatMessage(ye().s[t.moduleType]).toLowerCase(),area:"page_layout_schema"===t.area?g.formatMessage(Jn.page_main):"page_info_layout_schema"===t.area?g.formatMessage(Jn.page_details):g.formatMessage(Jn.generic)};jn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.unallowedModuleInArea",defaultMessage:"The {moduleType} module is not allowed in {area}."},e))}else{if("multiple_views_main_content_tabs"!==(null==t?void 0:t.type)){const e=g.formatMessage({id:"layoutBuilder.saveButton.error.fallback",defaultMessage:"Something went wrong while saving layout."});return void jn().f1(e)}jn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.multipleViewsMainContentTabs",defaultMessage:"Tabbed layouts may not have multiple content tabs. Please reset your layout to remove the duplicate tab."}))}}}}else M(!1)}),[M,t,g,n]),w=(0,o.useCallback)((()=>{c(),S().kA({environment:m,context:"layout",sessionId:u,collectionId:e.id,layoutId:r?void 0:p.id}),j(!1),M(!0)}),[M,e.id,m,r,p.id,c,u]),[k,j]=o.useState(!1);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(Ee().Ay,{popupType:$n().n.Popup,alignmentToOrigin:b().C.End,originGap:4,render:e=>(0,H.jsx)($().A,{style:x.saveButtonSectionMenuItem,children:(0,H.jsx)(G().A,{onClick:()=>{j(!0),e.close()},focused:!1,itemMarginLeft:0,itemMarginRight:0,style:x.saveButtonRevertItem,body:(0,H.jsxs)(h().Ye,{gap:10,children:[(0,zn()._)(x.saveButtonRevertItemIcon),(0,H.jsxs)(h().wt,{children:[(0,H.jsx)("div",{style:x.saveButtonRevertItemTitle,children:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout",defaultMessage:"Reset to original page layout"})}),(0,H.jsx)("div",{children:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayoutSubtitle",defaultMessage:"No properties will be deleted"})})]})]})})}),renderOrigin:e=>(0,H.jsx)(Yn().A,{style:x.saveButton,mainButtonStyle:x.saveButtonInner,title:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.saveAndClose",defaultMessage:"Apply to all pages"}),color:"blue",onClick:A,disableDropdown:!1,icon:Hn().p,iconStyle:x.saveButtonCheckMarkIcon,onDropdownClick:e.onClick,isLoading:f})}),k&&(0,H.jsx)(Gn().s,{isOpen:!0,showCloseIcon:!0,allowDismissByEscape:!0,onDismiss:()=>j(!1),areaConstraint:{width:{type:"min",length:300}},render:e=>{let{sizeRange:t}=e;return(0,H.jsx)(Wn().tf,{header:(0,H.jsx)(Wn().YA,{iconAndTitle:(0,H.jsx)(Wn().ZQ,{iconGroup:Kn,title:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.title",defaultMessage:"Reset to original page layout?"})}),description:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.subtitle",defaultMessage:"No properties will be deleted."})}),footer:(0,H.jsx)(Wn().aO,{layout:"vertical",primaryButtons:[{buttonType:"destructive",label:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.revertButton",defaultMessage:"Reset"}),onClick:w}],secondaryButtons:[{buttonType:"dismiss",label:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.cancelButton",defaultMessage:"Cancel"})}]}),sizeRange:t})}})]})}function to(){const e=(0,i().v3)(),{device:t}=e,{isElectron:n,isElectronMac:r}=t,{sessionId:l,layoutStore:c}=(0,X().LH)(),{collectionStore:u,hasUnsavedChanges:p,isNewLayout:m,initialLayoutModulesByArea:g}=(0,X().bi)(),f=(0,s().K8)((()=>c.getModules()),[c]),y=(0,s().K8)((()=>!!n&&!_n().A.state.isShowingTabBar),[n]),v=(0,s().K8)((()=>(0,kn().ek)(r)),[r]),b=(0,o.useCallback)((async()=>{S().do({environment:e,sessionId:l,collectionId:u.id,existingLayoutId:m?void 0:c.id,layoutSaved:!1,context:"layout",initialLayoutModulesByArea:g,finalModulesByArea:f});const t=()=>Dt().Fv({environment:e});if(!p)return void t();const{accept:n}=await jn().Gh({message:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.closeConfirmModal.content",defaultMessage:"Discard all layout changes?"}),acceptLabel:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.closeConfirmModal.discard",defaultMessage:"Discard"})});n&&t()}),[e,l,u.id,m,c.id,g,f,p]),x=(0,a().IS)((e=>{const t={pointerEvents:"auto"};return{header:{zIndex:1},headerContent:{display:"flex",position:"relative",margin:"8px 16px 8px 16px"},topbarPlaceholder:{minHeight:v,background:e.onboardingPreviewBackground,borderBottom:`1px solid ${e.stroke.primary}`},sideButtonsContainer:{display:"flex",justifyContent:"space-between",width:"100%",height:"100%",gap:"6px",position:"absolute",left:0,top:0,pointerEvents:"none"},rightButtons:{...t},pageSettingsButtonContainer:{display:"flex",...t},titlePreviewContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexGrow:1,position:"relative",..._().RC},titlePreviewElementContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:400,overflow:"hidden"}}}),[v]);return(0,H.jsxs)("header",{style:x.header,children:[y?(0,H.jsx)("div",{style:x.topbarPlaceholder,className:An()({[Tn().N_7]:!0,[Tn().sbV]:!0})}):null,(0,H.jsxs)("div",{style:x.headerContent,children:[(0,H.jsx)("div",{style:x.titlePreviewContainer,children:(0,H.jsxs)("div",{style:x.titlePreviewElementContainer,children:[(0,H.jsx)(no,{collectionStore:u}),(0,H.jsx)(En,{collectionStore:u})]})}),(0,H.jsxs)(h().Ye,{style:x.sideButtonsContainer,alignItems:"center",justifyContent:"space-between",children:[(0,H.jsx)("div",{style:x.pageSettingsButtonContainer,children:(0,H.jsx)(Vn,{})}),(0,H.jsxs)(h().Ye,{gap:8,alignItems:"center",style:x.rightButtons,children:[(0,H.jsx)(Ne().p,{onClick:b,icon:wn().u,size:"lg",children:(0,H.jsx)(d().sA,{id:"pageLayoutEditor.close",defaultMessage:"Cancel"})}),(0,H.jsx)(eo,{})]})]})]})]})}function no(e){let{collectionStore:t}=e;const n=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,color:e.text.primary,fontWeight:_().Wy.medium,width:"100%",..._().RC}})),[]),o=(0,s().K8)((()=>t.getIcon()),[t]);return(0,H.jsxs)("div",{style:n.container,children:[(0,H.jsx)(Cn().B,{icon:o,size:20,isEmptyPage:!1,disabled:!0}),(0,H.jsx)(In().A,{store:t})]})}function oo(e){const t=(0,a().IS)((e=>({container:{width:"100%",backgroundColor:e.surface.wash,cursor:"default"},innerContainer:{overflowY:"auto",padding:"20px 0 0 24px",height:"100%",marginTop:-20,minWidth:A().ok,zIndex:0,position:"relative"}})),[]),n=(0,s().K8)((()=>k().g.getState()),[]),i=n.isOpen&&"layout-editor"===n.mode?n.initialSelectedModuleId:void 0,r=(0,s().uB)(e.layoutBuilderModuleSelectionStore,w().A),l=n.isOpen&&"layout-editor"===n.mode;return(0,o.useEffect)((()=>{l&&r.setState(i?{type:"existing_module",moduleId:i,isDragging:!1}:void 0)}),[i,l,r]),n.isOpen&&"layout-editor"===n.mode?(0,H.jsxs)(Sn,{...n,layoutBuilderModuleSelectionStore:r,children:[e.debugChildForTestsOnly,(0,H.jsxs)(u().A,{tag:h().wt,initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},config:{duration:650,timingFunction:"ease-in-out"},style:t.container,children:[(0,H.jsx)(to,{}),(0,H.jsxs)(h().Ye,{style:t.innerContainer,children:[(0,H.jsx)(io,{}),(0,H.jsx)(en,{})]})]})]}):null}function io(){const{pageStore:e}=(0,X().bi)(),{setModuleSelection:t,layoutBuilderModuleSelectionStore:n,layoutStore:r,sessionId:l}=(0,X().LH)(),d=(0,i().v3)(),u=(0,s().K8)((()=>{var e;return Boolean(null===(e=n.state)||void 0===e?void 0:e.isDragging)}),[n]),p=(0,s().K8)((()=>{const t=(0,A().dV)(d);switch(t){case"xSmall":case"small":return"layout-editor-narrow";case"medium":case"large":case"xLarge":return e.isFullWidth()?"layout-editor-wide":"layout-editor";default:(0,c().HB)(t)}}),[d,e]),f=(0,s().K8)((()=>(0,M().oQ)(d).totalWidth),[d]),h=(0,s().K8)((()=>Boolean(e.getCover())),[e]),v=(0,a().IS)((e=>({container:{height:"100%",background:e.contentBackground,flexGrow:3,borderRadius:"12px 12px 0 0",boxShadow:"0px 9px 12px 0px rgba(15, 15, 15, 0.1)",borderColor:e.accentColors.gray[75],borderWidth:1,overflowY:"auto",display:"flex",...u?{cursor:"grabbing"}:{}},mainPage:{flex:3,paddingTop:h?void 0:28},sidebarScroller:{borderLeft:`solid 1px ${e.outlineBlueButtonPressedBackground}`,height:"100%"},mainPageContainer:{flex:1,height:"100%"},mainPageScrollContainer:{height:"100%"},sidebar:{padding:`${M().MH}px ${M().uZ}px`,marginBottom:100,flex:1,minWidth:f,maxWidth:f,width:f,transition:"width 0.1s, min-width 0.1s, max-width 0.1s"}})),[u,h,f]),[b,w]=(0,o.useState)(!0);return(0,H.jsxs)("div",{role:"presentation",style:v.container,onClick:e=>{(0,y().SQ)({event:e,context:y().y$.EditorClick,callback:()=>{var e;t(void 0),(0,S().L3)({environment:d,layoutId:r.id,collectionId:null===(e=r.getCollectionModel())||void 0===e?void 0:e.id,sessionId:l,from:"background_click"})}})},children:[(0,H.jsx)(ln().s,{area:"page_main",style:v.mainPageContainer,children:(0,H.jsx)(g().l,{children:(0,H.jsx)(m().H,{type:x().A.Y,style:v.mainPageScrollContainer,children:(0,H.jsx)("div",{style:v.mainPage,children:(0,H.jsx)(dn().Mx,{type:p,children:(0,H.jsx)(rn().J,{area:"page_main"})})})})})}),b&&(0,H.jsx)(ln().s,{area:"page_details",children:(0,H.jsxs)(m().H,{type:x().A.Y,style:v.sidebarScroller,children:[(0,H.jsx)(so,{isSidebarOpen:!0,setIsSidebarOpen:w}),(0,H.jsx)("div",{style:v.sidebar,children:(0,H.jsx)(rn().J,{area:"page_details"})})]})}),!b&&(0,H.jsx)(so,{isSidebarOpen:!1,setIsSidebarOpen:w})]})}function so(e){let{isSidebarOpen:t,setIsSidebarOpen:n}=e;const i=(0,a().IS)((()=>({container:{position:"relative",height:0,zIndex:1},button:{position:"absolute",right:t?void 0:4,left:t?4:void 0,top:4}})),[t]),s=(0,o.useCallback)((()=>{n((e=>!e))}),[n]);return(0,H.jsx)("div",{style:i.container,children:(0,H.jsx)(f().A,{renderTooltip:()=>t?(0,H.jsx)(d().sA,{...ao.hideSidebar}):(0,H.jsx)(d().sA,{...ao.showSidebar}),placement:b().W.Top,render:e=>(0,H.jsx)(p().A,{icon:t?l().O:r().S,...e,onClick:s,style:i.button,ariaLabel:t?v().A.formatMessage(ao.hideSidebar):v().A.formatMessage(ao.showSidebar)})})})}const ao=(0,d().YK)({hideSidebar:{defaultMessage:"Hide sidebar",id:"pageLayout.builder.hideSidebar"},showSidebar:{defaultMessage:"Show sidebar",id:"pageLayout.builder.showSidebar"}})},986229:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().default{getInitialState(){return{modalOpen:!1,tokenQuery:"",inviteTargets:[],inviteRole:"editor",isInviteTargetsEmpty:!0,table:n(179034).ev,flowId:void 0,inputFocus:"invitee",emailMessage:""}}}const i=o},986863:(e,t,n)=>{n.d(t,{u:()=>s});var o=()=>n(645873);const i=new(o().O2)("teamPermissionsInviteWithModal",(async()=>await Promise.all([n.e(75134),n.e(43380),n.e(9304),n.e(96346),n.e(55373),n.e(36192),n.e(44711),n.e(62475),n.e(3151),n.e(16471),n.e(53321),n.e(58550),n.e(98629),n.e(90825),n.e(37353),n.e(29151),n.e(31895),n.e(83647),n.e(22900),n.e(49889),n.e(97727),n.e(85128),n.e(83700),n.e(95555),n.e(58823),n.e(85864),n.e(92845),n.e(71718),n.e(83324),n.e(74562),n.e(38744),n.e(63077),n.e(28271),n.e(17254),n.e(41870),n.e(90966),n.e(42120),n.e(7114),n.e(67435),n.e(92012),n.e(22462),n.e(8184),n.e(4422),n.e(28721),n.e(28866),n.e(21194),n.e(6463),n.e(71993),n.e(1213),n.e(17989),n.e(90625),n.e(59794),n.e(78846),n.e(26483),n.e(43741),n.e(81768),n.e(94387),n.e(82850),n.e(52393),n.e(77692),n.e(75601),n.e(11341),n.e(7060),n.e(82136),n.e(12739),n.e(26090),n.e(73594),n.e(93282),n.e(12341),n.e(50984),n.e(66984),n.e(40828),n.e(26199),n.e(18057),n.e(90978),n.e(56264),n.e(5023),n.e(55927),n.e(61151),n.e(72226),n.e(48199),n.e(67780),n.e(96933),n.e(87598),n.e(23063),n.e(3965),n.e(84341),n.e(80533),n.e(45620),n.e(58221),n.e(44763),n.e(8081),n.e(67183),n.e(64598),n.e(82720),n.e(4253),n.e(86787),n.e(77465),n.e(24593),n.e(80896),n.e(1440),n.e(67378),n.e(58504),n.e(97308),n.e(63996),n.e(20636),n.e(66268),n.e(55717),n.e(7005),n.e(40186),n.e(22585),n.e(73206),n.e(11037),n.e(33235),n.e(91957),n.e(84176),n.e(16357),n.e(75681)]).then(n.bind(n,487443)))),s=(0,o()._h)(i,(e=>e.TeamPermissionsInviteWithModal))},996594:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M,getSpaceViewMenuItems:()=>A});n(944114),n(296540);var o=()=>n(484714),i=()=>n(847249),s=()=>n(959013),a=()=>n(394893),r=()=>n(34542),l=(n(898992),n(354520),()=>n(496603));var d=()=>n(722872),c=()=>n(640653),u=()=>n(719431),p=()=>n(377586),m=()=>n(351360),g=()=>n(520257),f=()=>n(760217),h=()=>n(928600),y=()=>n(939740),v=()=>n(480095),b=()=>n(614505),x=()=>n(89924),S=n(474848);const M=function(){const e=(0,o().v3)(),{device:t}=e,s=(0,i().O$)(g().A);return(0,S.jsx)(n(897119).Ay,{popupType:t.isMobile?p().n.SlideUp:p().n.Popup,open:s.open,render:()=>(0,S.jsx)(w,{}),originGap:8,onDismiss:a().Ew,originRect:s.originRect,enableRounding:!0})};function A(e,t){const{device:n}=e,{currentUserRootStore:o}=m().default.state;if(!o)return[];const{editableStores:i}=function(e){const t=l().hS(e.getSpaceViewStores(),(e=>e.getSpaceId())),n=t.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())})),o=n.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())&&t.canEdit()}));return{total:t.length,loaded:n.length,editable:o.length,editableStores:o}}(o),s=[];for(const a of i){const o=a.getSpaceStore();if(null!=o&&o.isReady()&&o.canEdit()){const i=(0,c().GK)(e,o),l=(0,c().c2)(e,o);s.push({key:a.id,action:async()=>{await r().Fq({environment:e,blockStore:t,spaceStore:o,spaceViewStore:a})},render:e=>(0,S.jsx)(f().A,{title:i,icon:(0,S.jsx)(b().B,{icon:l,isEmptyPage:!1,title:i,size:n.isMobile?24:20,disabled:!0}),...e})})}}return s}function w(){const e=(0,o().v3)(),{device:t}=e,n=(0,i().O$)(g().A),r=(0,i().K8)((()=>m().default.state.currentUserRootStore),[]),l=(0,i().K8)((()=>n.store?A(e,n.store):[]),[e,n]);if(!n.open||!r)return null;const c=[{key:"spaces",render:e=>(0,S.jsx)(x().A,{title:t.isMobile?void 0:(0,S.jsx)(s().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),...e}),items:l},{key:"logout",render:e=>(0,S.jsx)(x().A,{...e,topBorder:!0}),items:[{key:"logout",action:()=>u().logout(e),render:e=>(0,S.jsx)(k,{...e})}]}];let p;return p=t.isMobile?{menuType:d().gu.Modal,title:(0,S.jsx)(s().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:(0,S.jsx)(v().CancelMenuText,{}),onClickRight:a().Ew}:{menuType:d().gu.Popup},(0,S.jsx)(h().A,{...p,children:(0,S.jsx)(y().Ay,{type:y().Oh.Vertical,sections:c,initialFocus:1})})}function k(e){const t=(0,i().K8)((()=>{const{currentUserStore:e}=m().default.state;return(null==e?void 0:e.getEmail())||""}),[]);return(0,S.jsx)(f().A,{caption:(0,S.jsx)(s().sA,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:t}}),...e})}}}]);